(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))r(u);new MutationObserver(u=>{for(const s of u)if(s.type==="childList")for(const w of s.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&r(w)}).observe(document,{childList:!0,subtree:!0});function o(u){const s={};return u.integrity&&(s.integrity=u.integrity),u.referrerpolicy&&(s.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?s.credentials="include":u.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(u){if(u.ep)return;u.ep=!0;const s=o(u);fetch(u.href,s)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(e,n){const o=new Set(e.split(","));return n?r=>o.has(r.toLowerCase()):r=>o.has(r)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),isModelListener=e=>e.startsWith("onUpdate:"),extend$3=Object.assign,remove=(e,n)=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)},hasOwnProperty$d=Object.prototype.hasOwnProperty,hasOwn=(e,n)=>hasOwnProperty$d.call(e,n),isArray$3=Array.isArray,isMap=e=>toTypeString(e)==="[object Map]",isSet=e=>toTypeString(e)==="[object Set]",isDate$1=e=>toTypeString(e)==="[object Date]",isFunction$2=e=>typeof e=="function",isString$3=e=>typeof e=="string",isSymbol$2=e=>typeof e=="symbol",isObject$3=e=>e!==null&&typeof e=="object",isPromise$1=e=>(isObject$3(e)||isFunction$2(e))&&isFunction$2(e.then)&&isFunction$2(e.catch),objectToString$2=Object.prototype.toString,toTypeString=e=>objectToString$2.call(e),toRawType=e=>toTypeString(e).slice(8,-1),isPlainObject$3=e=>toTypeString(e)==="[object Object]",isIntegerKey=e=>isString$3(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=e=>{const n=Object.create(null);return o=>n[o]||(n[o]=e(o))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(e=>e.replace(camelizeRE,(n,o)=>o?o.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(e=>e.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(e=>e.charAt(0).toUpperCase()+e.slice(1)),toHandlerKey=cacheStringFunction(e=>e?`on${capitalize(e)}`:""),hasChanged=(e,n)=>!Object.is(e,n),invokeArrayFns=(e,n)=>{for(let o=0;o<e.length;o++)e[o](n)},def=(e,n,o,r=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:r,value:o})},looseToNumber=e=>{const n=parseFloat(e);return isNaN(n)?e:n},toNumber$1=e=>{const n=isString$3(e)?Number(e):NaN;return isNaN(n)?e:n};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(e){if(isArray$3(e)){const n={};for(let o=0;o<e.length;o++){const r=e[o],u=isString$3(r)?parseStringStyle(r):normalizeStyle(r);if(u)for(const s in u)n[s]=u[s]}return n}else if(isString$3(e)||isObject$3(e))return e}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(e){const n={};return e.replace(styleCommentRE,"").split(listDelimiterRE).forEach(o=>{if(o){const r=o.split(propertyDelimiterRE);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function normalizeClass(e){let n="";if(isString$3(e))n=e;else if(isArray$3(e))for(let o=0;o<e.length;o++){const r=normalizeClass(e[o]);r&&(n+=r+" ")}else if(isObject$3(e))for(const o in e)e[o]&&(n+=o+" ");return n.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(e){return!!e||e===""}function looseCompareArrays(e,n){if(e.length!==n.length)return!1;let o=!0;for(let r=0;o&&r<e.length;r++)o=looseEqual(e[r],n[r]);return o}function looseEqual(e,n){if(e===n)return!0;let o=isDate$1(e),r=isDate$1(n);if(o||r)return o&&r?e.getTime()===n.getTime():!1;if(o=isSymbol$2(e),r=isSymbol$2(n),o||r)return e===n;if(o=isArray$3(e),r=isArray$3(n),o||r)return o&&r?looseCompareArrays(e,n):!1;if(o=isObject$3(e),r=isObject$3(n),o||r){if(!o||!r)return!1;const u=Object.keys(e).length,s=Object.keys(n).length;if(u!==s)return!1;for(const w in e){const m=e.hasOwnProperty(w),v=n.hasOwnProperty(w);if(m&&!v||!m&&v||!looseEqual(e[w],n[w]))return!1}}return String(e)===String(n)}function looseIndexOf(e,n){return e.findIndex(o=>looseEqual(o,n))}const toDisplayString=e=>isString$3(e)?e:e==null?"":isArray$3(e)||isObject$3(e)&&(e.toString===objectToString$2||!isFunction$2(e.toString))?JSON.stringify(e,replacer,2):String(e),replacer=(e,n)=>n&&n.__v_isRef?replacer(e,n.value):isMap(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((o,[r,u],s)=>(o[stringifySymbol(r,s)+" =>"]=u,o),{})}:isSet(n)?{[`Set(${n.size})`]:[...n.values()].map(o=>stringifySymbol(o))}:isSymbol$2(n)?stringifySymbol(n):isObject$3(n)&&!isArray$3(n)&&!isPlainObject$3(n)?String(n):n,stringifySymbol=(e,n="")=>{var o;return isSymbol$2(e)?`Symbol(${(o=e.description)!=null?o:n})`:e};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!n&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const o=activeEffectScope;try{return activeEffectScope=this,n()}finally{activeEffectScope=o}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(n){if(this._active){let o,r;for(o=0,r=this.effects.length;o<r;o++)this.effects[o].stop();for(o=0,r=this.cleanups.length;o<r;o++)this.cleanups[o]();if(this.scopes)for(o=0,r=this.scopes.length;o<r;o++)this.scopes[o].stop(!0);if(!this.detached&&this.parent&&!n){const u=this.parent.scopes.pop();u&&u!==this&&(this.parent.scopes[this.index]=u,u.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(e){return new EffectScope(e)}function recordEffectScope(e,n=activeEffectScope){n&&n.active&&n.effects.push(e)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(e){activeEffectScope&&activeEffectScope.cleanups.push(e)}let activeEffect;class ReactiveEffect{constructor(n,o,r,u){this.fn=n,this.trigger=o,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,u)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let n=0;n<this._depsLength;n++){const o=this.deps[n];if(o.computed&&(triggerComputed(o.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(n){this._dirtyLevel=n?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=shouldTrack,o=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=o,shouldTrack=n}}stop(){this.active&&(preCleanupEffect(this),postCleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function triggerComputed(e){return e.value}function preCleanupEffect(e){e._trackId++,e._depsLength=0}function postCleanupEffect(e){if(e.deps.length>e._depsLength){for(let n=e._depsLength;n<e.deps.length;n++)cleanupDepEffect(e.deps[n],e);e.deps.length=e._depsLength}}function cleanupDepEffect(e,n){const o=e.get(n);o!==void 0&&n._trackId!==o&&(e.delete(n),e.size===0&&e.cleanup())}function effect(e,n){e.effect instanceof ReactiveEffect&&(e=e.effect.fn);const o=new ReactiveEffect(e,NOOP,()=>{o.dirty&&o.run()});n&&(extend$3(o,n),n.scope&&recordEffectScope(o,n.scope)),(!n||!n.lazy)&&o.run();const r=o.run.bind(o);return r.effect=o,r}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const e=trackStack.pop();shouldTrack=e===void 0?!0:e}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(e,n,o){if(n.get(e)!==e._trackId){n.set(e,e._trackId);const r=e.deps[e._depsLength];r!==n?(r&&cleanupDepEffect(r,e),e.deps[e._depsLength++]=n):e._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(e,n,o){pauseScheduling();for(const r of e.keys()){let u;r._dirtyLevel<n&&(u!=null?u:u=e.get(r)===r._trackId)&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=n),r._shouldSchedule&&(u!=null?u:u=e.get(r)===r._trackId)&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&queueEffectSchedulers.push(r.scheduler)))}resetScheduling()}const createDep=(e,n)=>{const o=new Map;return o.cleanup=e,o.computed=n,o},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(e,n,o){if(shouldTrack&&activeEffect){let r=targetMap.get(e);r||targetMap.set(e,r=new Map);let u=r.get(o);u||r.set(o,u=createDep(()=>r.delete(o))),trackEffect(activeEffect,u)}}function trigger$1(e,n,o,r,u,s){const w=targetMap.get(e);if(!w)return;let m=[];if(n==="clear")m=[...w.values()];else if(o==="length"&&isArray$3(e)){const v=Number(r);w.forEach((g,d)=>{(d==="length"||!isSymbol$2(d)&&d>=v)&&m.push(g)})}else switch(o!==void 0&&m.push(w.get(o)),n){case"add":isArray$3(e)?isIntegerKey(o)&&m.push(w.get("length")):(m.push(w.get(ITERATE_KEY)),isMap(e)&&m.push(w.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$3(e)||(m.push(w.get(ITERATE_KEY)),isMap(e)&&m.push(w.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(e)&&m.push(w.get(ITERATE_KEY));break}pauseScheduling();for(const v of m)v&&triggerEffects(v,4);resetScheduling()}function getDepFromReactive(e,n){const o=targetMap.get(e);return o&&o.get(n)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(isSymbol$2)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...o){const r=toRaw(this);for(let s=0,w=this.length;s<w;s++)track(r,"get",s+"");const u=r[n](...o);return u===-1||u===!1?r[n](...o.map(toRaw)):u}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...o){pauseTracking(),pauseScheduling();const r=toRaw(this)[n].apply(this,o);return resetScheduling(),resetTracking(),r}}),e}function hasOwnProperty$c(e){isSymbol$2(e)||(e=String(e));const n=toRaw(this);return track(n,"has",e),n.hasOwnProperty(e)}class BaseReactiveHandler{constructor(n=!1,o=!1){this._isReadonly=n,this._isShallow=o}get(n,o,r){const u=this._isReadonly,s=this._isShallow;if(o==="__v_isReactive")return!u;if(o==="__v_isReadonly")return u;if(o==="__v_isShallow")return s;if(o==="__v_raw")return r===(u?s?shallowReadonlyMap:readonlyMap:s?shallowReactiveMap:reactiveMap).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const w=isArray$3(n);if(!u){if(w&&hasOwn(arrayInstrumentations,o))return Reflect.get(arrayInstrumentations,o,r);if(o==="hasOwnProperty")return hasOwnProperty$c}const m=Reflect.get(n,o,r);return(isSymbol$2(o)?builtInSymbols.has(o):isNonTrackableKeys(o))||(u||track(n,"get",o),s)?m:isRef(m)?w&&isIntegerKey(o)?m:m.value:isObject$3(m)?u?readonly(m):reactive(m):m}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!1,n)}set(n,o,r,u){let s=n[o];if(!this._isShallow){const v=isReadonly(s);if(!isShallow(r)&&!isReadonly(r)&&(s=toRaw(s),r=toRaw(r)),!isArray$3(n)&&isRef(s)&&!isRef(r))return v?!1:(s.value=r,!0)}const w=isArray$3(n)&&isIntegerKey(o)?Number(o)<n.length:hasOwn(n,o),m=Reflect.set(n,o,r,u);return n===toRaw(u)&&(w?hasChanged(r,s)&&trigger$1(n,"set",o,r):trigger$1(n,"add",o,r)),m}deleteProperty(n,o){const r=hasOwn(n,o);n[o];const u=Reflect.deleteProperty(n,o);return u&&r&&trigger$1(n,"delete",o,void 0),u}has(n,o){const r=Reflect.has(n,o);return(!isSymbol$2(o)||!builtInSymbols.has(o))&&track(n,"has",o),r}ownKeys(n){return track(n,"iterate",isArray$3(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!0,n)}set(n,o){return!0}deleteProperty(n,o){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=e=>e,getProto=e=>Reflect.getPrototypeOf(e);function get$2(e,n,o=!1,r=!1){e=e.__v_raw;const u=toRaw(e),s=toRaw(n);o||(hasChanged(n,s)&&track(u,"get",n),track(u,"get",s));const{has:w}=getProto(u),m=r?toShallow:o?toReadonly:toReactive;if(w.call(u,n))return m(e.get(n));if(w.call(u,s))return m(e.get(s));e!==u&&e.get(n)}function has(e,n=!1){const o=this.__v_raw,r=toRaw(o),u=toRaw(e);return n||(hasChanged(e,u)&&track(r,"has",e),track(r,"has",u)),e===u?o.has(e):o.has(e)||o.has(u)}function size$1(e,n=!1){return e=e.__v_raw,!n&&track(toRaw(e),"iterate",ITERATE_KEY),Reflect.get(e,"size",e)}function add(e){e=toRaw(e);const n=toRaw(this);return getProto(n).has.call(n,e)||(n.add(e),trigger$1(n,"add",e,e)),this}function set(e,n){n=toRaw(n);const o=toRaw(this),{has:r,get:u}=getProto(o);let s=r.call(o,e);s||(e=toRaw(e),s=r.call(o,e));const w=u.call(o,e);return o.set(e,n),s?hasChanged(n,w)&&trigger$1(o,"set",e,n):trigger$1(o,"add",e,n),this}function deleteEntry(e){const n=toRaw(this),{has:o,get:r}=getProto(n);let u=o.call(n,e);u||(e=toRaw(e),u=o.call(n,e)),r&&r.call(n,e);const s=n.delete(e);return u&&trigger$1(n,"delete",e,void 0),s}function clear(){const e=toRaw(this),n=e.size!==0,o=e.clear();return n&&trigger$1(e,"clear",void 0,void 0),o}function createForEach(e,n){return function(r,u){const s=this,w=s.__v_raw,m=toRaw(w),v=n?toShallow:e?toReadonly:toReactive;return!e&&track(m,"iterate",ITERATE_KEY),w.forEach((g,d)=>r.call(u,v(g),v(d),s))}}function createIterableMethod(e,n,o){return function(...r){const u=this.__v_raw,s=toRaw(u),w=isMap(s),m=e==="entries"||e===Symbol.iterator&&w,v=e==="keys"&&w,g=u[e](...r),d=o?toShallow:n?toReadonly:toReactive;return!n&&track(s,"iterate",v?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:f,done:y}=g.next();return y?{value:f,done:y}:{value:m?[d(f[0]),d(f[1])]:d(f),done:y}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function createInstrumentations(){const e={get(s){return get$2(this,s)},get size(){return size$1(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},n={get(s){return get$2(this,s,!1,!0)},get size(){return size$1(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},o={get(s){return get$2(this,s,!0)},get size(){return size$1(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},r={get(s){return get$2(this,s,!0,!0)},get size(){return size$1(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=createIterableMethod(s,!1,!1),o[s]=createIterableMethod(s,!0,!1),n[s]=createIterableMethod(s,!1,!0),r[s]=createIterableMethod(s,!0,!0)}),[e,o,n,r]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(e,n){const o=n?e?shallowReadonlyInstrumentations:shallowInstrumentations:e?readonlyInstrumentations:mutableInstrumentations;return(r,u,s)=>u==="__v_isReactive"?!e:u==="__v_isReadonly"?e:u==="__v_raw"?r:Reflect.get(hasOwn(o,u)&&u in r?o:r,u,s)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(e){return e.__v_skip||!Object.isExtensible(e)?0:targetTypeMap(toRawType(e))}function reactive(e){return isReadonly(e)?e:createReactiveObject(e,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(e){return createReactiveObject(e,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(e){return createReactiveObject(e,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(e){return createReactiveObject(e,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(e,n,o,r,u){if(!isObject$3(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const s=u.get(e);if(s)return s;const w=getTargetType(e);if(w===0)return e;const m=new Proxy(e,w===2?r:o);return u.set(e,m),m}function isReactive(e){return isReadonly(e)?isReactive(e.__v_raw):!!(e&&e.__v_isReactive)}function isReadonly(e){return!!(e&&e.__v_isReadonly)}function isShallow(e){return!!(e&&e.__v_isShallow)}function isProxy(e){return e?!!e.__v_raw:!1}function toRaw(e){const n=e&&e.__v_raw;return n?toRaw(n):e}function markRaw(e){return Object.isExtensible(e)&&def(e,"__v_skip",!0),e}const toReactive=e=>isObject$3(e)?reactive(e):e,toReadonly=e=>isObject$3(e)?readonly(e):e;class ComputedRefImpl{constructor(n,o,r,u){this.getter=n,this._setter=o,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>n(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!u,this.__v_isReadonly=r}get value(){const n=toRaw(this);return(!n._cacheable||n.effect.dirty)&&hasChanged(n._value,n._value=n.effect.run())&&triggerRefValue(n,4),trackRefValue(n),n.effect._dirtyLevel>=2&&triggerRefValue(n,2),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function computed$1(e,n,o=!1){let r,u;const s=isFunction$2(e);return s?(r=e,u=NOOP):(r=e.get,u=e.set),new ComputedRefImpl(r,u,s||!u,o)}function trackRefValue(e){var n;shouldTrack&&activeEffect&&(e=toRaw(e),trackEffect(activeEffect,(n=e.dep)!=null?n:e.dep=createDep(()=>e.dep=void 0,e instanceof ComputedRefImpl?e:void 0)))}function triggerRefValue(e,n=4,o){e=toRaw(e);const r=e.dep;r&&triggerEffects(r,n)}function isRef(e){return!!(e&&e.__v_isRef===!0)}function ref(e){return createRef(e,!1)}function shallowRef(e){return createRef(e,!0)}function createRef(e,n){return isRef(e)?e:new RefImpl(e,n)}class RefImpl{constructor(n,o){this.__v_isShallow=o,this.dep=void 0,this.__v_isRef=!0,this._rawValue=o?n:toRaw(n),this._value=o?n:toReactive(n)}get value(){return trackRefValue(this),this._value}set value(n){const o=this.__v_isShallow||isShallow(n)||isReadonly(n);n=o?n:toRaw(n),hasChanged(n,this._rawValue)&&(this._rawValue=n,this._value=o?n:toReactive(n),triggerRefValue(this,4))}}function unref(e){return isRef(e)?e.value:e}const shallowUnwrapHandlers={get:(e,n,o)=>unref(Reflect.get(e,n,o)),set:(e,n,o,r)=>{const u=e[n];return isRef(u)&&!isRef(o)?(u.value=o,!0):Reflect.set(e,n,o,r)}};function proxyRefs(e){return isReactive(e)?e:new Proxy(e,shallowUnwrapHandlers)}function toRefs(e){const n=isArray$3(e)?new Array(e.length):{};for(const o in e)n[o]=propertyToRef(e,o);return n}class ObjectRefImpl{constructor(n,o,r){this._object=n,this._key=o,this._defaultValue=r,this.__v_isRef=!0}get value(){const n=this._object[this._key];return n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(e,n,o){return isRef(e)?e:isFunction$2(e)?new GetterRefImpl(e):isObject$3(e)&&arguments.length>1?propertyToRef(e,n,o):ref(e)}function propertyToRef(e,n,o){const r=e[n];return isRef(r)?r:new ObjectRefImpl(e,n,o)}/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack$1=[];function warn$1$1(e,...n){pauseTracking();const o=stack$1.length?stack$1[stack$1.length-1].component:null,r=o&&o.appContext.config.warnHandler,u=getComponentTrace();if(r)callWithErrorHandling(r,o,11,[e+n.map(s=>{var w,m;return(m=(w=s.toString)==null?void 0:w.call(s))!=null?m:JSON.stringify(s)}).join(""),o&&o.proxy,u.map(({vnode:s})=>`at <${formatComponentName(o,s.type)}>`).join(`
`),u]);else{const s=[`[Vue warn]: ${e}`,...n];u.length&&s.push(`
`,...formatTrace(u)),console.warn(...s)}resetTracking()}function getComponentTrace(){let e=stack$1[stack$1.length-1];if(!e)return[];const n=[];for(;e;){const o=n[0];o&&o.vnode===e?o.recurseCount++:n.push({vnode:e,recurseCount:0});const r=e.component&&e.component.parent;e=r&&r.vnode}return n}function formatTrace(e){const n=[];return e.forEach((o,r)=>{n.push(...r===0?[]:[`
`],...formatTraceEntry(o))}),n}function formatTraceEntry({vnode:e,recurseCount:n}){const o=n>0?`... (${n} recursive calls)`:"",r=e.component?e.component.parent==null:!1,u=` at <${formatComponentName(e.component,e.type,r)}`,s=">"+o;return e.props?[u,...formatProps(e.props),s]:[u+s]}function formatProps(e){const n=[],o=Object.keys(e);return o.slice(0,3).forEach(r=>{n.push(...formatProp(r,e[r]))}),o.length>3&&n.push(" ..."),n}function formatProp(e,n,o){return isString$3(n)?(n=JSON.stringify(n),o?n:[`${e}=${n}`]):typeof n=="number"||typeof n=="boolean"||n==null?o?n:[`${e}=${n}`]:isRef(n)?(n=formatProp(e,toRaw(n.value),!0),o?n:[`${e}=Ref<`,n,">"]):isFunction$2(n)?[`${e}=fn${n.name?`<${n.name}>`:""}`]:(n=toRaw(n),o?n:[`${e}=`,n])}function callWithErrorHandling(e,n,o,r){try{return r?e(...r):e()}catch(u){handleError(u,n,o)}}function callWithAsyncErrorHandling(e,n,o,r){if(isFunction$2(e)){const u=callWithErrorHandling(e,n,o,r);return u&&isPromise$1(u)&&u.catch(s=>{handleError(s,n,o)}),u}if(isArray$3(e)){const u=[];for(let s=0;s<e.length;s++)u.push(callWithAsyncErrorHandling(e[s],n,o,r));return u}}function handleError(e,n,o,r=!0){const u=n?n.vnode:null;if(n){let s=n.parent;const w=n.proxy,m=`https://vuejs.org/error-reference/#runtime-${o}`;for(;s;){const g=s.ec;if(g){for(let d=0;d<g.length;d++)if(g[d](e,w,m)===!1)return}s=s.parent}const v=n.appContext.config.errorHandler;if(v){pauseTracking(),callWithErrorHandling(v,null,10,[e,w,m]),resetTracking();return}}logError(e,o,u,r)}function logError(e,n,o,r=!0){console.error(e)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(e){const n=currentFlushPromise||resolvedPromise;return e?n.then(this?e.bind(this):e):n}function findInsertionIndex(e){let n=flushIndex+1,o=queue.length;for(;n<o;){const r=n+o>>>1,u=queue[r],s=getId(u);s<e||s===e&&u.pre?n=r+1:o=r}return n}function queueJob(e){(!queue.length||!queue.includes(e,isFlushing&&e.allowRecurse?flushIndex+1:flushIndex))&&(e.id==null?queue.push(e):queue.splice(findInsertionIndex(e.id),0,e),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(e){const n=queue.indexOf(e);n>flushIndex&&queue.splice(n,1)}function queuePostFlushCb(e){isArray$3(e)?pendingPostFlushCbs.push(...e):(!activePostFlushCbs||!activePostFlushCbs.includes(e,e.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(e),queueFlush()}function flushPreFlushCbs(e,n,o=isFlushing?flushIndex+1:0){for(;o<queue.length;o++){const r=queue[o];if(r&&r.pre){if(e&&r.id!==e.uid)continue;queue.splice(o,1),o--,r()}}}function flushPostFlushCbs(e){if(pendingPostFlushCbs.length){const n=[...new Set(pendingPostFlushCbs)].sort((o,r)=>getId(o)-getId(r));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...n);return}for(activePostFlushCbs=n,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=e=>e.id==null?1/0:e.id,comparator=(e,n)=>{const o=getId(e)-getId(n);if(o===0){if(e.pre&&!n.pre)return-1;if(n.pre&&!e.pre)return 1}return o};function flushJobs(e){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const n=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const o=queue[flushIndex];o&&o.active!==!1&&callWithErrorHandling(o,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(e,n,...o){if(e.isUnmounted)return;const r=e.vnode.props||EMPTY_OBJ;let u=o;const s=n.startsWith("update:"),w=s&&n.slice(7);if(w&&w in r){const d=`${w==="modelValue"?"model":w}Modifiers`,{number:f,trim:y}=r[d]||EMPTY_OBJ;y&&(u=o.map(x=>isString$3(x)?x.trim():x)),f&&(u=o.map(looseToNumber))}let m,v=r[m=toHandlerKey(n)]||r[m=toHandlerKey(camelize(n))];!v&&s&&(v=r[m=toHandlerKey(hyphenate(n))]),v&&callWithAsyncErrorHandling(v,e,6,u);const g=r[m+"Once"];if(g){if(!e.emitted)e.emitted={};else if(e.emitted[m])return;e.emitted[m]=!0,callWithAsyncErrorHandling(g,e,6,u)}}function normalizeEmitsOptions(e,n,o=!1){const r=n.emitsCache,u=r.get(e);if(u!==void 0)return u;const s=e.emits;let w={},m=!1;if(!isFunction$2(e)){const v=g=>{const d=normalizeEmitsOptions(g,n,!0);d&&(m=!0,extend$3(w,d))};!o&&n.mixins.length&&n.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}return!s&&!m?(isObject$3(e)&&r.set(e,null),null):(isArray$3(s)?s.forEach(v=>w[v]=null):extend$3(w,s),isObject$3(e)&&r.set(e,w),w)}function isEmitListener(e,n){return!e||!isOn(n)?!1:(n=n.slice(2).replace(/Once$/,""),hasOwn(e,n[0].toLowerCase()+n.slice(1))||hasOwn(e,hyphenate(n))||hasOwn(e,n))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(e){const n=currentRenderingInstance;return currentRenderingInstance=e,currentScopeId=e&&e.type.__scopeId||null,n}function pushScopeId(e){currentScopeId=e}function popScopeId(){currentScopeId=null}function withCtx(e,n=currentRenderingInstance,o){if(!n||e._n)return e;const r=(...u)=>{r._d&&setBlockTracking(-1);const s=setCurrentRenderingInstance(n);let w;try{w=e(...u)}finally{setCurrentRenderingInstance(s),r._d&&setBlockTracking(1)}return w};return r._n=!0,r._c=!0,r._d=!0,r}function markAttrsAccessed(){}function renderComponentRoot(e){const{type:n,vnode:o,proxy:r,withProxy:u,propsOptions:[s],slots:w,attrs:m,emit:v,render:g,renderCache:d,props:f,data:y,setupState:x,ctx:k,inheritAttrs:P}=e,S=setCurrentRenderingInstance(e);let E,M;try{if(o.shapeFlag&4){const D=u||r,N=D;E=normalizeVNode(g.call(N,D,d,f,x,y,k)),M=m}else{const D=n;E=normalizeVNode(D.length>1?D(f,{attrs:m,slots:w,emit:v}):D(f,null)),M=n.props?m:getFunctionalFallthrough(m)}}catch(D){blockStack.length=0,handleError(D,e,1),E=createVNode(Comment)}let T=E;if(M&&P!==!1){const D=Object.keys(M),{shapeFlag:N}=T;D.length&&N&7&&(s&&D.some(isModelListener)&&(M=filterModelListeners(M,s)),T=cloneVNode(T,M,!1,!0))}return o.dirs&&(T=cloneVNode(T,null,!1,!0),T.dirs=T.dirs?T.dirs.concat(o.dirs):o.dirs),o.transition&&(T.transition=o.transition),E=T,setCurrentRenderingInstance(S),E}function filterSingleRoot(e,n=!0){let o;for(let r=0;r<e.length;r++){const u=e[r];if(isVNode(u)){if(u.type!==Comment||u.children==="v-if"){if(o)return;o=u}}else return}return o}const getFunctionalFallthrough=e=>{let n;for(const o in e)(o==="class"||o==="style"||isOn(o))&&((n||(n={}))[o]=e[o]);return n},filterModelListeners=(e,n)=>{const o={};for(const r in e)(!isModelListener(r)||!(r.slice(9)in n))&&(o[r]=e[r]);return o};function shouldUpdateComponent(e,n,o){const{props:r,children:u,component:s}=e,{props:w,children:m,patchFlag:v}=n,g=s.emitsOptions;if(n.dirs||n.transition)return!0;if(o&&v>=0){if(v&1024)return!0;if(v&16)return r?hasPropsChanged(r,w,g):!!w;if(v&8){const d=n.dynamicProps;for(let f=0;f<d.length;f++){const y=d[f];if(w[y]!==r[y]&&!isEmitListener(g,y))return!0}}}else return(u||m)&&(!m||!m.$stable)?!0:r===w?!1:r?w?hasPropsChanged(r,w,g):!0:!!w;return!1}function hasPropsChanged(e,n,o){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let u=0;u<r.length;u++){const s=r[u];if(n[s]!==e[s]&&!isEmitListener(o,s))return!0}return!1}function updateHOCHostEl({vnode:e,parent:n},o){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=o,n=n.parent;else break}}const COMPONENTS="components";function resolveComponent(e,n){return resolveAsset(COMPONENTS,e,!0,n)||e}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveAsset(e,n,o=!0,r=!1){const u=currentRenderingInstance||currentInstance;if(u){const s=u.type;if(e===COMPONENTS){const m=getComponentName(s,!1);if(m&&(m===n||m===camelize(n)||m===capitalize(camelize(n))))return s}const w=resolve(u[e]||s[e],n)||resolve(u.appContext[e],n);return!w&&r?s:w}}function resolve(e,n){return e&&(e[n]||e[camelize(n)]||e[capitalize(camelize(n))])}const isSuspense=e=>e.__isSuspense;let suspenseId=0;const SuspenseImpl={name:"Suspense",__isSuspense:!0,process(e,n,o,r,u,s,w,m,v,g){if(e==null)mountSuspense(n,o,r,u,s,w,m,v,g);else{if(s&&s.deps>0&&!e.suspense.isInFallback){n.suspense=e.suspense,n.suspense.vnode=n,n.el=e.el;return}patchSuspense(e,n,o,r,u,w,m,v,g)}},hydrate:hydrateSuspense,create:createSuspenseBoundary,normalize:normalizeSuspenseChildren},Suspense=SuspenseImpl;function triggerEvent(e,n){const o=e.props&&e.props[n];isFunction$2(o)&&o()}function mountSuspense(e,n,o,r,u,s,w,m,v){const{p:g,o:{createElement:d}}=v,f=d("div"),y=e.suspense=createSuspenseBoundary(e,u,r,n,f,o,s,w,m,v);g(null,y.pendingBranch=e.ssContent,f,null,r,y,s,w),y.deps>0?(triggerEvent(e,"onPending"),triggerEvent(e,"onFallback"),g(null,e.ssFallback,n,o,r,null,s,w),setActiveBranch(y,e.ssFallback)):y.resolve(!1,!0)}function patchSuspense(e,n,o,r,u,s,w,m,{p:v,um:g,o:{createElement:d}}){const f=n.suspense=e.suspense;f.vnode=n,n.el=e.el;const y=n.ssContent,x=n.ssFallback,{activeBranch:k,pendingBranch:P,isInFallback:S,isHydrating:E}=f;if(P)f.pendingBranch=y,isSameVNodeType(y,P)?(v(P,y,f.hiddenContainer,null,u,f,s,w,m),f.deps<=0?f.resolve():S&&(E||(v(k,x,o,r,u,null,s,w,m),setActiveBranch(f,x)))):(f.pendingId=suspenseId++,E?(f.isHydrating=!1,f.activeBranch=P):g(P,u,f),f.deps=0,f.effects.length=0,f.hiddenContainer=d("div"),S?(v(null,y,f.hiddenContainer,null,u,f,s,w,m),f.deps<=0?f.resolve():(v(k,x,o,r,u,null,s,w,m),setActiveBranch(f,x))):k&&isSameVNodeType(y,k)?(v(k,y,o,r,u,f,s,w,m),f.resolve(!0)):(v(null,y,f.hiddenContainer,null,u,f,s,w,m),f.deps<=0&&f.resolve()));else if(k&&isSameVNodeType(y,k))v(k,y,o,r,u,f,s,w,m),setActiveBranch(f,y);else if(triggerEvent(n,"onPending"),f.pendingBranch=y,y.shapeFlag&512?f.pendingId=y.component.suspenseId:f.pendingId=suspenseId++,v(null,y,f.hiddenContainer,null,u,f,s,w,m),f.deps<=0)f.resolve();else{const{timeout:M,pendingId:T}=f;M>0?setTimeout(()=>{f.pendingId===T&&f.fallback(x)},M):M===0&&f.fallback(x)}}function createSuspenseBoundary(e,n,o,r,u,s,w,m,v,g,d=!1){const{p:f,m:y,um:x,n:k,o:{parentNode:P,remove:S}}=g;let E;const M=isVNodeSuspensible(e);M&&n&&n.pendingBranch&&(E=n.pendingId,n.deps++);const T=e.props?toNumber$1(e.props.timeout):void 0,D=s,N={vnode:e,parent:n,parentComponent:o,namespace:w,container:r,hiddenContainer:u,deps:0,pendingId:suspenseId++,timeout:typeof T=="number"?T:-1,activeBranch:null,pendingBranch:null,isInFallback:!d,isHydrating:d,isUnmounted:!1,effects:[],resolve(I=!1,O=!1){const{vnode:F,activeBranch:q,pendingBranch:Y,pendingId:_e,effects:ne,parentComponent:ve,container:J}=N;let fe=!1;N.isHydrating?N.isHydrating=!1:I||(fe=q&&Y.transition&&Y.transition.mode==="out-in",fe&&(q.transition.afterLeave=()=>{_e===N.pendingId&&(y(Y,J,s===D?k(q):s,0),queuePostFlushCb(ne))}),q&&(P(q.el)!==N.hiddenContainer&&(s=k(q)),x(q,ve,N,!0)),fe||y(Y,J,s,0)),setActiveBranch(N,Y),N.pendingBranch=null,N.isInFallback=!1;let Z=N.parent,j=!1;for(;Z;){if(Z.pendingBranch){Z.effects.push(...ne),j=!0;break}Z=Z.parent}!j&&!fe&&queuePostFlushCb(ne),N.effects=[],M&&n&&n.pendingBranch&&E===n.pendingId&&(n.deps--,n.deps===0&&!O&&n.resolve()),triggerEvent(F,"onResolve")},fallback(I){if(!N.pendingBranch)return;const{vnode:O,activeBranch:F,parentComponent:q,container:Y,namespace:_e}=N;triggerEvent(O,"onFallback");const ne=k(F),ve=()=>{!N.isInFallback||(f(null,I,Y,ne,q,null,_e,m,v),setActiveBranch(N,I))},J=I.transition&&I.transition.mode==="out-in";J&&(F.transition.afterLeave=ve),N.isInFallback=!0,x(F,q,null,!0),J||ve()},move(I,O,F){N.activeBranch&&y(N.activeBranch,I,O,F),N.container=I},next(){return N.activeBranch&&k(N.activeBranch)},registerDep(I,O){const F=!!N.pendingBranch;F&&N.deps++;const q=I.vnode.el;I.asyncDep.catch(Y=>{handleError(Y,I,0)}).then(Y=>{if(I.isUnmounted||N.isUnmounted||N.pendingId!==I.suspenseId)return;I.asyncResolved=!0;const{vnode:_e}=I;handleSetupResult(I,Y,!1),q&&(_e.el=q);const ne=!q&&I.subTree.el;O(I,_e,P(q||I.subTree.el),q?null:k(I.subTree),N,w,v),ne&&S(ne),updateHOCHostEl(I,_e.el),F&&--N.deps===0&&N.resolve()})},unmount(I,O){N.isUnmounted=!0,N.activeBranch&&x(N.activeBranch,o,I,O),N.pendingBranch&&x(N.pendingBranch,o,I,O)}};return N}function hydrateSuspense(e,n,o,r,u,s,w,m,v){const g=n.suspense=createSuspenseBoundary(n,r,o,e.parentNode,document.createElement("div"),null,u,s,w,m,!0),d=v(e,g.pendingBranch=n.ssContent,o,g,s,w);return g.deps===0&&g.resolve(!1,!0),d}function normalizeSuspenseChildren(e){const{shapeFlag:n,children:o}=e,r=n&32;e.ssContent=normalizeSuspenseSlot(r?o.default:o),e.ssFallback=r?normalizeSuspenseSlot(o.fallback):createVNode(Comment)}function normalizeSuspenseSlot(e){let n;if(isFunction$2(e)){const o=isBlockTreeEnabled&&e._c;o&&(e._d=!1,openBlock()),e=e(),o&&(e._d=!0,n=currentBlock,closeBlock())}return isArray$3(e)&&(e=filterSingleRoot(e)),e=normalizeVNode(e),n&&!e.dynamicChildren&&(e.dynamicChildren=n.filter(o=>o!==e)),e}function queueEffectWithSuspense(e,n){n&&n.pendingBranch?isArray$3(e)?n.effects.push(...e):n.effects.push(e):queuePostFlushCb(e)}function setActiveBranch(e,n){e.activeBranch=n;const{vnode:o,parentComponent:r}=e;let u=n.el;for(;!u&&n.component;)n=n.component.subTree,u=n.el;o.el=u,r&&r.subTree===o&&(r.vnode.el=u,updateHOCHostEl(r,u))}function isVNodeSuspensible(e){const n=e.props&&e.props.suspensible;return n!=null&&n!==!1}const ssrContextKey$1=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey$1);function watchEffect(e,n){return doWatch(e,null,n)}const INITIAL_WATCHER_VALUE={};function watch(e,n,o){return doWatch(e,n,o)}function doWatch(e,n,{immediate:o,deep:r,flush:u,once:s,onTrack:w,onTrigger:m}=EMPTY_OBJ){if(n&&s){const I=n;n=(...O)=>{I(...O),N()}}const v=currentInstance,g=I=>r===!0?I:traverse(I,r===!1?1:void 0);let d,f=!1,y=!1;if(isRef(e)?(d=()=>e.value,f=isShallow(e)):isReactive(e)?(d=()=>g(e),f=!0):isArray$3(e)?(y=!0,f=e.some(I=>isReactive(I)||isShallow(I)),d=()=>e.map(I=>{if(isRef(I))return I.value;if(isReactive(I))return g(I);if(isFunction$2(I))return callWithErrorHandling(I,v,2)})):isFunction$2(e)?n?d=()=>callWithErrorHandling(e,v,2):d=()=>(x&&x(),callWithAsyncErrorHandling(e,v,3,[k])):d=NOOP,n&&r){const I=d;d=()=>traverse(I())}let x,k=I=>{x=T.onStop=()=>{callWithErrorHandling(I,v,4),x=T.onStop=void 0}},P;if(isInSSRComponentSetup)if(k=NOOP,n?o&&callWithAsyncErrorHandling(n,v,3,[d(),y?[]:void 0,k]):d(),u==="sync"){const I=useSSRContext();P=I.__watcherHandles||(I.__watcherHandles=[])}else return NOOP;let S=y?new Array(e.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const E=()=>{if(!(!T.active||!T.dirty))if(n){const I=T.run();(r||f||(y?I.some((O,F)=>hasChanged(O,S[F])):hasChanged(I,S)))&&(x&&x(),callWithAsyncErrorHandling(n,v,3,[I,S===INITIAL_WATCHER_VALUE?void 0:y&&S[0]===INITIAL_WATCHER_VALUE?[]:S,k]),S=I)}else T.run()};E.allowRecurse=!!n;let M;u==="sync"?M=E:u==="post"?M=()=>queuePostRenderEffect(E,v&&v.suspense):(E.pre=!0,v&&(E.id=v.uid),M=()=>queueJob(E));const T=new ReactiveEffect(d,NOOP,M),D=getCurrentScope(),N=()=>{T.stop(),D&&remove(D.effects,T)};return n?o?E():S=T.run():u==="post"?queuePostRenderEffect(T.run.bind(T),v&&v.suspense):T.run(),P&&P.push(N),N}function instanceWatch(e,n,o){const r=this.proxy,u=isString$3(e)?e.includes(".")?createPathGetter(r,e):()=>r[e]:e.bind(r,r);let s;isFunction$2(n)?s=n:(s=n.handler,o=n);const w=setCurrentInstance(this),m=doWatch(u,s.bind(r),o);return w(),m}function createPathGetter(e,n){const o=n.split(".");return()=>{let r=e;for(let u=0;u<o.length&&r;u++)r=r[o[u]];return r}}function traverse(e,n=1/0,o){if(n<=0||!isObject$3(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),n--,isRef(e))traverse(e.value,n,o);else if(isArray$3(e))for(let r=0;r<e.length;r++)traverse(e[r],n,o);else if(isSet(e)||isMap(e))e.forEach(r=>{traverse(r,n,o)});else if(isPlainObject$3(e))for(const r in e)traverse(e[r],n,o);return e}function withDirectives(e,n){if(currentRenderingInstance===null)return e;const o=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,r=e.dirs||(e.dirs=[]);for(let u=0;u<n.length;u++){let[s,w,m,v=EMPTY_OBJ]=n[u];s&&(isFunction$2(s)&&(s={mounted:s,updated:s}),s.deep&&traverse(w),r.push({dir:s,instance:o,value:w,oldValue:void 0,arg:m,modifiers:v}))}return e}function invokeDirectiveHook(e,n,o,r){const u=e.dirs,s=n&&n.dirs;for(let w=0;w<u.length;w++){const m=u[w];s&&(m.oldValue=s[w].value);let v=m.dir[r];v&&(pauseTracking(),callWithAsyncErrorHandling(v,o,8,[e.el,m,e,n]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{e.isMounted=!0}),onBeforeUnmount(()=>{e.isUnmounting=!0}),e}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(e,{slots:n}){const o=getCurrentInstance(),r=useTransitionState();return()=>{const u=n.default&&getTransitionRawChildren(n.default(),!0);if(!u||!u.length)return;let s=u[0];if(u.length>1){for(const y of u)if(y.type!==Comment){s=y;break}}const w=toRaw(e),{mode:m}=w;if(r.isLeaving)return emptyPlaceholder(s);const v=getKeepAliveChild(s);if(!v)return emptyPlaceholder(s);const g=resolveTransitionHooks(v,w,r,o);setTransitionHooks(v,g);const d=o.subTree,f=d&&getKeepAliveChild(d);if(f&&f.type!==Comment&&!isSameVNodeType(v,f)){const y=resolveTransitionHooks(f,w,r,o);if(setTransitionHooks(f,y),m==="out-in"&&v.type!==Comment)return r.isLeaving=!0,y.afterLeave=()=>{r.isLeaving=!1,o.update.active!==!1&&(o.effect.dirty=!0,o.update())},emptyPlaceholder(s);m==="in-out"&&v.type!==Comment&&(y.delayLeave=(x,k,P)=>{const S=getLeavingNodesForType(r,f);S[String(f.key)]=f,x[leaveCbKey]=()=>{k(),x[leaveCbKey]=void 0,delete g.delayedLeave},g.delayedLeave=P})}return s}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(e,n){const{leavingVNodes:o}=e;let r=o.get(n.type);return r||(r=Object.create(null),o.set(n.type,r)),r}function resolveTransitionHooks(e,n,o,r){const{appear:u,mode:s,persisted:w=!1,onBeforeEnter:m,onEnter:v,onAfterEnter:g,onEnterCancelled:d,onBeforeLeave:f,onLeave:y,onAfterLeave:x,onLeaveCancelled:k,onBeforeAppear:P,onAppear:S,onAfterAppear:E,onAppearCancelled:M}=n,T=String(e.key),D=getLeavingNodesForType(o,e),N=(F,q)=>{F&&callWithAsyncErrorHandling(F,r,9,q)},I=(F,q)=>{const Y=q[1];N(F,q),isArray$3(F)?F.every(_e=>_e.length<=1)&&Y():F.length<=1&&Y()},O={mode:s,persisted:w,beforeEnter(F){let q=m;if(!o.isMounted)if(u)q=P||m;else return;F[leaveCbKey]&&F[leaveCbKey](!0);const Y=D[T];Y&&isSameVNodeType(e,Y)&&Y.el[leaveCbKey]&&Y.el[leaveCbKey](),N(q,[F])},enter(F){let q=v,Y=g,_e=d;if(!o.isMounted)if(u)q=S||v,Y=E||g,_e=M||d;else return;let ne=!1;const ve=F[enterCbKey$1]=J=>{ne||(ne=!0,J?N(_e,[F]):N(Y,[F]),O.delayedLeave&&O.delayedLeave(),F[enterCbKey$1]=void 0)};q?I(q,[F,ve]):ve()},leave(F,q){const Y=String(e.key);if(F[enterCbKey$1]&&F[enterCbKey$1](!0),o.isUnmounting)return q();N(f,[F]);let _e=!1;const ne=F[leaveCbKey]=ve=>{_e||(_e=!0,q(),ve?N(k,[F]):N(x,[F]),F[leaveCbKey]=void 0,D[Y]===e&&delete D[Y])};D[Y]=e,y?I(y,[F,ne]):ne()},clone(F){return resolveTransitionHooks(F,n,o,r)}};return O}function emptyPlaceholder(e){if(isKeepAlive(e))return e=cloneVNode(e),e.children=null,e}function getKeepAliveChild(e){if(!isKeepAlive(e))return e;const{shapeFlag:n,children:o}=e;if(o){if(n&16)return o[0];if(n&32&&isFunction$2(o.default))return o.default()}}function setTransitionHooks(e,n){e.shapeFlag&6&&e.component?setTransitionHooks(e.component.subTree,n):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function getTransitionRawChildren(e,n=!1,o){let r=[],u=0;for(let s=0;s<e.length;s++){let w=e[s];const m=o==null?w.key:String(o)+String(w.key!=null?w.key:s);w.type===Fragment?(w.patchFlag&128&&u++,r=r.concat(getTransitionRawChildren(w.children,n,m))):(n||w.type!==Comment)&&r.push(m!=null?cloneVNode(w,{key:m}):w)}if(u>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(e,n){return isFunction$2(e)?(()=>extend$3({name:e.name},n,{setup:e}))():e}const isAsyncWrapper=e=>!!e.type.__asyncLoader,isKeepAlive=e=>e.type.__isKeepAlive;function onActivated(e,n){registerKeepAliveHook(e,"a",n)}function onDeactivated(e,n){registerKeepAliveHook(e,"da",n)}function registerKeepAliveHook(e,n,o=currentInstance){const r=e.__wdc||(e.__wdc=()=>{let u=o;for(;u;){if(u.isDeactivated)return;u=u.parent}return e()});if(injectHook(n,r,o),o){let u=o.parent;for(;u&&u.parent;)isKeepAlive(u.parent.vnode)&&injectToKeepAliveRoot(r,n,o,u),u=u.parent}}function injectToKeepAliveRoot(e,n,o,r){const u=injectHook(n,e,r,!0);onUnmounted(()=>{remove(r[n],u)},o)}function injectHook(e,n,o=currentInstance,r=!1){if(o){const u=o[e]||(o[e]=[]),s=n.__weh||(n.__weh=(...w)=>{if(o.isUnmounted)return;pauseTracking();const m=setCurrentInstance(o),v=callWithAsyncErrorHandling(n,o,e,w);return m(),resetTracking(),v});return r?u.unshift(s):u.push(s),s}}const createHook=e=>(n,o=currentInstance)=>(!isInSSRComponentSetup||e==="sp")&&injectHook(e,(...r)=>n(...r),o),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(e,n=currentInstance){injectHook("ec",e,n)}function renderList(e,n,o,r){let u;const s=o&&o[r];if(isArray$3(e)||isString$3(e)){u=new Array(e.length);for(let w=0,m=e.length;w<m;w++)u[w]=n(e[w],w,void 0,s&&s[w])}else if(typeof e=="number"){u=new Array(e);for(let w=0;w<e;w++)u[w]=n(w+1,w,void 0,s&&s[w])}else if(isObject$3(e))if(e[Symbol.iterator])u=Array.from(e,(w,m)=>n(w,m,void 0,s&&s[m]));else{const w=Object.keys(e);u=new Array(w.length);for(let m=0,v=w.length;m<v;m++){const g=w[m];u[m]=n(e[g],g,m,s&&s[m])}}else u=[];return o&&(o[r]=u),u}function createSlots(e,n){for(let o=0;o<n.length;o++){const r=n[o];if(isArray$3(r))for(let u=0;u<r.length;u++)e[r[u].name]=r[u].fn;else r&&(e[r.name]=r.key?(...u)=>{const s=r.fn(...u);return s&&(s.key=r.key),s}:r.fn)}return e}function renderSlot(e,n,o={},r,u){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return n!=="default"&&(o.name=n),createVNode("slot",o,r&&r());let s=e[n];s&&s._c&&(s._d=!1),openBlock();const w=s&&ensureValidVNode$1(s(o)),m=createBlock(Fragment,{key:o.key||w&&w.key||`_${n}`},w||(r?r():[]),w&&e._===1?64:-2);return!u&&m.scopeId&&(m.slotScopeIds=[m.scopeId+"-s"]),s&&s._c&&(s._d=!0),m}function ensureValidVNode$1(e){return e.some(n=>isVNode(n)?!(n.type===Comment||n.type===Fragment&&!ensureValidVNode$1(n.children)):!0)?e:null}function toHandlers(e,n){const o={};for(const r in e)o[n&&/[A-Z]/.test(r)?`on:${r}`:toHandlerKey(r)]=e[r];return o}const getPublicInstance=e=>e?isStatefulComponent(e)?getExposeProxy(e)||e.proxy:getPublicInstance(e.parent):null,publicPropertiesMap=extend$3(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>getPublicInstance(e.parent),$root:e=>getPublicInstance(e.root),$emit:e=>e.emit,$options:e=>resolveMergedOptions(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,queueJob(e.update)}),$nextTick:e=>e.n||(e.n=nextTick.bind(e.proxy)),$watch:e=>instanceWatch.bind(e)}),hasSetupBinding=(e,n)=>e!==EMPTY_OBJ&&!e.__isScriptSetup&&hasOwn(e,n),PublicInstanceProxyHandlers={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:o,setupState:r,data:u,props:s,accessCache:w,type:m,appContext:v}=e;let g;if(n[0]!=="$"){const x=w[n];if(x!==void 0)switch(x){case 1:return r[n];case 2:return u[n];case 4:return o[n];case 3:return s[n]}else{if(hasSetupBinding(r,n))return w[n]=1,r[n];if(u!==EMPTY_OBJ&&hasOwn(u,n))return w[n]=2,u[n];if((g=e.propsOptions[0])&&hasOwn(g,n))return w[n]=3,s[n];if(o!==EMPTY_OBJ&&hasOwn(o,n))return w[n]=4,o[n];shouldCacheAccess&&(w[n]=0)}}const d=publicPropertiesMap[n];let f,y;if(d)return n==="$attrs"&&track(e.attrs,"get",""),d(e);if((f=m.__cssModules)&&(f=f[n]))return f;if(o!==EMPTY_OBJ&&hasOwn(o,n))return w[n]=4,o[n];if(y=v.config.globalProperties,hasOwn(y,n))return y[n]},set({_:e},n,o){const{data:r,setupState:u,ctx:s}=e;return hasSetupBinding(u,n)?(u[n]=o,!0):r!==EMPTY_OBJ&&hasOwn(r,n)?(r[n]=o,!0):hasOwn(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(s[n]=o,!0)},has({_:{data:e,setupState:n,accessCache:o,ctx:r,appContext:u,propsOptions:s}},w){let m;return!!o[w]||e!==EMPTY_OBJ&&hasOwn(e,w)||hasSetupBinding(n,w)||(m=s[0])&&hasOwn(m,w)||hasOwn(r,w)||hasOwn(publicPropertiesMap,w)||hasOwn(u.config.globalProperties,w)},defineProperty(e,n,o){return o.get!=null?e._.accessCache[n]=0:hasOwn(o,"value")&&this.set(e,n,o.value,null),Reflect.defineProperty(e,n,o)}};function normalizePropsOrEmits(e){return isArray$3(e)?e.reduce((n,o)=>(n[o]=null,n),{}):e}function withAsyncContext(e){const n=getCurrentInstance();let o=e();return unsetCurrentInstance(),isPromise$1(o)&&(o=o.catch(r=>{throw setCurrentInstance(n),r})),[o,()=>setCurrentInstance(n)]}let shouldCacheAccess=!0;function applyOptions(e){const n=resolveMergedOptions(e),o=e.proxy,r=e.ctx;shouldCacheAccess=!1,n.beforeCreate&&callHook$1(n.beforeCreate,e,"bc");const{data:u,computed:s,methods:w,watch:m,provide:v,inject:g,created:d,beforeMount:f,mounted:y,beforeUpdate:x,updated:k,activated:P,deactivated:S,beforeDestroy:E,beforeUnmount:M,destroyed:T,unmounted:D,render:N,renderTracked:I,renderTriggered:O,errorCaptured:F,serverPrefetch:q,expose:Y,inheritAttrs:_e,components:ne,directives:ve,filters:J}=n;if(g&&resolveInjections(g,r,null),w)for(const j in w){const X=w[j];isFunction$2(X)&&(r[j]=X.bind(o))}if(u){const j=u.call(o,o);isObject$3(j)&&(e.data=reactive(j))}if(shouldCacheAccess=!0,s)for(const j in s){const X=s[j],H=isFunction$2(X)?X.bind(o,o):isFunction$2(X.get)?X.get.bind(o,o):NOOP,U=!isFunction$2(X)&&isFunction$2(X.set)?X.set.bind(o):NOOP,te=computed({get:H,set:U});Object.defineProperty(r,j,{enumerable:!0,configurable:!0,get:()=>te.value,set:Q=>te.value=Q})}if(m)for(const j in m)createWatcher(m[j],r,o,j);if(v){const j=isFunction$2(v)?v.call(o):v;Reflect.ownKeys(j).forEach(X=>{provide(X,j[X])})}d&&callHook$1(d,e,"c");function Z(j,X){isArray$3(X)?X.forEach(H=>j(H.bind(o))):X&&j(X.bind(o))}if(Z(onBeforeMount,f),Z(onMounted,y),Z(onBeforeUpdate,x),Z(onUpdated,k),Z(onActivated,P),Z(onDeactivated,S),Z(onErrorCaptured,F),Z(onRenderTracked,I),Z(onRenderTriggered,O),Z(onBeforeUnmount,M),Z(onUnmounted,D),Z(onServerPrefetch,q),isArray$3(Y))if(Y.length){const j=e.exposed||(e.exposed={});Y.forEach(X=>{Object.defineProperty(j,X,{get:()=>o[X],set:H=>o[X]=H})})}else e.exposed||(e.exposed={});N&&e.render===NOOP&&(e.render=N),_e!=null&&(e.inheritAttrs=_e),ne&&(e.components=ne),ve&&(e.directives=ve)}function resolveInjections(e,n,o=NOOP){isArray$3(e)&&(e=normalizeInject(e));for(const r in e){const u=e[r];let s;isObject$3(u)?"default"in u?s=inject(u.from||r,u.default,!0):s=inject(u.from||r):s=inject(u),isRef(s)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:w=>s.value=w}):n[r]=s}}function callHook$1(e,n,o){callWithAsyncErrorHandling(isArray$3(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,o)}function createWatcher(e,n,o,r){const u=r.includes(".")?createPathGetter(o,r):()=>o[r];if(isString$3(e)){const s=n[e];isFunction$2(s)&&watch(u,s)}else if(isFunction$2(e))watch(u,e.bind(o));else if(isObject$3(e))if(isArray$3(e))e.forEach(s=>createWatcher(s,n,o,r));else{const s=isFunction$2(e.handler)?e.handler.bind(o):n[e.handler];isFunction$2(s)&&watch(u,s,e)}}function resolveMergedOptions(e){const n=e.type,{mixins:o,extends:r}=n,{mixins:u,optionsCache:s,config:{optionMergeStrategies:w}}=e.appContext,m=s.get(n);let v;return m?v=m:!u.length&&!o&&!r?v=n:(v={},u.length&&u.forEach(g=>mergeOptions(v,g,w,!0)),mergeOptions(v,n,w)),isObject$3(n)&&s.set(n,v),v}function mergeOptions(e,n,o,r=!1){const{mixins:u,extends:s}=n;s&&mergeOptions(e,s,o,!0),u&&u.forEach(w=>mergeOptions(e,w,o,!0));for(const w in n)if(!(r&&w==="expose")){const m=internalOptionMergeStrats[w]||o&&o[w];e[w]=m?m(e[w],n[w]):n[w]}return e}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(e,n){return n?e?function(){return extend$3(isFunction$2(e)?e.call(this,this):e,isFunction$2(n)?n.call(this,this):n)}:n:e}function mergeInject(e,n){return mergeObjectOptions(normalizeInject(e),normalizeInject(n))}function normalizeInject(e){if(isArray$3(e)){const n={};for(let o=0;o<e.length;o++)n[e[o]]=e[o];return n}return e}function mergeAsArray(e,n){return e?[...new Set([].concat(e,n))]:n}function mergeObjectOptions(e,n){return e?extend$3(Object.create(null),e,n):n}function mergeEmitsOrPropsOptions(e,n){return e?isArray$3(e)&&isArray$3(n)?[...new Set([...e,...n])]:extend$3(Object.create(null),normalizePropsOrEmits(e),normalizePropsOrEmits(n!=null?n:{})):n}function mergeWatchOptions(e,n){if(!e)return n;if(!n)return e;const o=extend$3(Object.create(null),e);for(const r in n)o[r]=mergeAsArray(e[r],n[r]);return o}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(e,n){return function(r,u=null){isFunction$2(r)||(r=extend$3({},r)),u!=null&&!isObject$3(u)&&(u=null);const s=createAppContext(),w=new WeakSet;let m=!1;const v=s.app={_uid:uid$1++,_component:r,_props:u,_container:null,_context:s,_instance:null,version:version$2,get config(){return s.config},set config(g){},use(g,...d){return w.has(g)||(g&&isFunction$2(g.install)?(w.add(g),g.install(v,...d)):isFunction$2(g)&&(w.add(g),g(v,...d))),v},mixin(g){return s.mixins.includes(g)||s.mixins.push(g),v},component(g,d){return d?(s.components[g]=d,v):s.components[g]},directive(g,d){return d?(s.directives[g]=d,v):s.directives[g]},mount(g,d,f){if(!m){const y=createVNode(r,u);return y.appContext=s,f===!0?f="svg":f===!1&&(f=void 0),d&&n?n(y,g):e(y,g,f),m=!0,v._container=g,g.__vue_app__=v,getExposeProxy(y.component)||y.component.proxy}},unmount(){m&&(e(null,v._container),delete v._container.__vue_app__)},provide(g,d){return s.provides[g]=d,v},runWithContext(g){const d=currentApp;currentApp=v;try{return g()}finally{currentApp=d}}};return v}}let currentApp=null;function provide(e,n){if(currentInstance){let o=currentInstance.provides;const r=currentInstance.parent&&currentInstance.parent.provides;r===o&&(o=currentInstance.provides=Object.create(r)),o[e]=n}}function inject(e,n,o=!1){const r=currentInstance||currentRenderingInstance;if(r||currentApp){const u=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:currentApp._context.provides;if(u&&e in u)return u[e];if(arguments.length>1)return o&&isFunction$2(n)?n.call(r&&r.proxy):n}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=e=>Object.getPrototypeOf(e)===internalObjectProto;function initProps(e,n,o,r=!1){const u={},s=createInternalObject();e.propsDefaults=Object.create(null),setFullProps(e,n,u,s);for(const w in e.propsOptions[0])w in u||(u[w]=void 0);o?e.props=r?u:shallowReactive(u):e.type.props?e.props=u:e.props=s,e.attrs=s}function updateProps(e,n,o,r){const{props:u,attrs:s,vnode:{patchFlag:w}}=e,m=toRaw(u),[v]=e.propsOptions;let g=!1;if((r||w>0)&&!(w&16)){if(w&8){const d=e.vnode.dynamicProps;for(let f=0;f<d.length;f++){let y=d[f];if(isEmitListener(e.emitsOptions,y))continue;const x=n[y];if(v)if(hasOwn(s,y))x!==s[y]&&(s[y]=x,g=!0);else{const k=camelize(y);u[k]=resolvePropValue(v,m,k,x,e,!1)}else x!==s[y]&&(s[y]=x,g=!0)}}}else{setFullProps(e,n,u,s)&&(g=!0);let d;for(const f in m)(!n||!hasOwn(n,f)&&((d=hyphenate(f))===f||!hasOwn(n,d)))&&(v?o&&(o[f]!==void 0||o[d]!==void 0)&&(u[f]=resolvePropValue(v,m,f,void 0,e,!0)):delete u[f]);if(s!==m)for(const f in s)(!n||!hasOwn(n,f)&&!0)&&(delete s[f],g=!0)}g&&trigger$1(e.attrs,"set","")}function setFullProps(e,n,o,r){const[u,s]=e.propsOptions;let w=!1,m;if(n)for(let v in n){if(isReservedProp(v))continue;const g=n[v];let d;u&&hasOwn(u,d=camelize(v))?!s||!s.includes(d)?o[d]=g:(m||(m={}))[d]=g:isEmitListener(e.emitsOptions,v)||(!(v in r)||g!==r[v])&&(r[v]=g,w=!0)}if(s){const v=toRaw(o),g=m||EMPTY_OBJ;for(let d=0;d<s.length;d++){const f=s[d];o[f]=resolvePropValue(u,v,f,g[f],e,!hasOwn(g,f))}}return w}function resolvePropValue(e,n,o,r,u,s){const w=e[o];if(w!=null){const m=hasOwn(w,"default");if(m&&r===void 0){const v=w.default;if(w.type!==Function&&!w.skipFactory&&isFunction$2(v)){const{propsDefaults:g}=u;if(o in g)r=g[o];else{const d=setCurrentInstance(u);r=g[o]=v.call(null,n),d()}}else r=v}w[0]&&(s&&!m?r=!1:w[1]&&(r===""||r===hyphenate(o))&&(r=!0))}return r}function normalizePropsOptions(e,n,o=!1){const r=n.propsCache,u=r.get(e);if(u)return u;const s=e.props,w={},m=[];let v=!1;if(!isFunction$2(e)){const d=f=>{v=!0;const[y,x]=normalizePropsOptions(f,n,!0);extend$3(w,y),x&&m.push(...x)};!o&&n.mixins.length&&n.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!s&&!v)return isObject$3(e)&&r.set(e,EMPTY_ARR),EMPTY_ARR;if(isArray$3(s))for(let d=0;d<s.length;d++){const f=camelize(s[d]);validatePropName(f)&&(w[f]=EMPTY_OBJ)}else if(s)for(const d in s){const f=camelize(d);if(validatePropName(f)){const y=s[d],x=w[f]=isArray$3(y)||isFunction$2(y)?{type:y}:extend$3({},y);if(x){const k=getTypeIndex(Boolean,x.type),P=getTypeIndex(String,x.type);x[0]=k>-1,x[1]=P<0||k<P,(k>-1||hasOwn(x,"default"))&&m.push(f)}}}const g=[w,m];return isObject$3(e)&&r.set(e,g),g}function validatePropName(e){return e[0]!=="$"&&!isReservedProp(e)}function getType(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function isSameType(e,n){return getType(e)===getType(n)}function getTypeIndex(e,n){return isArray$3(n)?n.findIndex(o=>isSameType(o,e)):isFunction$2(n)&&isSameType(n,e)?0:-1}const isInternalKey=e=>e[0]==="_"||e==="$stable",normalizeSlotValue=e=>isArray$3(e)?e.map(normalizeVNode):[normalizeVNode(e)],normalizeSlot=(e,n,o)=>{if(n._n)return n;const r=withCtx((...u)=>normalizeSlotValue(n(...u)),o);return r._c=!1,r},normalizeObjectSlots=(e,n,o)=>{const r=e._ctx;for(const u in e){if(isInternalKey(u))continue;const s=e[u];if(isFunction$2(s))n[u]=normalizeSlot(u,s,r);else if(s!=null){const w=normalizeSlotValue(s);n[u]=()=>w}}},normalizeVNodeSlots=(e,n)=>{const o=normalizeSlotValue(n);e.slots.default=()=>o},initSlots=(e,n)=>{const o=e.slots=createInternalObject();if(e.vnode.shapeFlag&32){const r=n._;r?(extend$3(o,n),def(o,"_",r,!0)):normalizeObjectSlots(n,o)}else n&&normalizeVNodeSlots(e,n)},updateSlots=(e,n,o)=>{const{vnode:r,slots:u}=e;let s=!0,w=EMPTY_OBJ;if(r.shapeFlag&32){const m=n._;m?o&&m===1?s=!1:(extend$3(u,n),!o&&m===1&&delete u._):(s=!n.$stable,normalizeObjectSlots(n,u)),w=n}else n&&(normalizeVNodeSlots(e,n),w={default:1});if(s)for(const m in u)!isInternalKey(m)&&w[m]==null&&delete u[m]};function setRef(e,n,o,r,u=!1){if(isArray$3(e)){e.forEach((y,x)=>setRef(y,n&&(isArray$3(n)?n[x]:n),o,r,u));return}if(isAsyncWrapper(r)&&!u)return;const s=r.shapeFlag&4?getExposeProxy(r.component)||r.component.proxy:r.el,w=u?null:s,{i:m,r:v}=e,g=n&&n.r,d=m.refs===EMPTY_OBJ?m.refs={}:m.refs,f=m.setupState;if(g!=null&&g!==v&&(isString$3(g)?(d[g]=null,hasOwn(f,g)&&(f[g]=null)):isRef(g)&&(g.value=null)),isFunction$2(v))callWithErrorHandling(v,m,12,[w,d]);else{const y=isString$3(v),x=isRef(v);if(y||x){const k=()=>{if(e.f){const P=y?hasOwn(f,v)?f[v]:d[v]:v.value;u?isArray$3(P)&&remove(P,s):isArray$3(P)?P.includes(s)||P.push(s):y?(d[v]=[s],hasOwn(f,v)&&(f[v]=d[v])):(v.value=[s],e.k&&(d[e.k]=v.value))}else y?(d[v]=w,hasOwn(f,v)&&(f[v]=w)):x&&(v.value=w,e.k&&(d[e.k]=w))};w?(k.id=-1,queuePostRenderEffect(k,o)):k()}}}function initFeatureFlags(){typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__!="boolean"&&(getGlobalThis().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(e){return baseCreateRenderer(e)}function baseCreateRenderer(e,n){initFeatureFlags();const o=getGlobalThis();o.__VUE__=!0;const{insert:r,remove:u,patchProp:s,createElement:w,createText:m,createComment:v,setText:g,setElementText:d,parentNode:f,nextSibling:y,setScopeId:x=NOOP,insertStaticContent:k}=e,P=(oe,ke,Ce,Ee=null,Be=null,Ve=null,Oe=void 0,je=null,Ge=!!ke.dynamicChildren)=>{if(oe===ke)return;oe&&!isSameVNodeType(oe,ke)&&(Ee=Ae(oe),Q(oe,Be,Ve,!0),oe=null),ke.patchFlag===-2&&(Ge=!1,ke.dynamicChildren=null);const{type:Xe,ref:qe,shapeFlag:Ke}=ke;switch(Xe){case Text$2:S(oe,ke,Ce,Ee);break;case Comment:E(oe,ke,Ce,Ee);break;case Static:oe==null&&M(ke,Ce,Ee,Oe);break;case Fragment:ne(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge);break;default:Ke&1?N(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge):Ke&6?ve(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge):(Ke&64||Ke&128)&&Xe.process(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Ie)}qe!=null&&Be&&setRef(qe,oe&&oe.ref,Ve,ke||oe,!ke)},S=(oe,ke,Ce,Ee)=>{if(oe==null)r(ke.el=m(ke.children),Ce,Ee);else{const Be=ke.el=oe.el;ke.children!==oe.children&&g(Be,ke.children)}},E=(oe,ke,Ce,Ee)=>{oe==null?r(ke.el=v(ke.children||""),Ce,Ee):ke.el=oe.el},M=(oe,ke,Ce,Ee)=>{[oe.el,oe.anchor]=k(oe.children,ke,Ce,Ee,oe.el,oe.anchor)},T=({el:oe,anchor:ke},Ce,Ee)=>{let Be;for(;oe&&oe!==ke;)Be=y(oe),r(oe,Ce,Ee),oe=Be;r(ke,Ce,Ee)},D=({el:oe,anchor:ke})=>{let Ce;for(;oe&&oe!==ke;)Ce=y(oe),u(oe),oe=Ce;u(ke)},N=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge)=>{ke.type==="svg"?Oe="svg":ke.type==="math"&&(Oe="mathml"),oe==null?I(ke,Ce,Ee,Be,Ve,Oe,je,Ge):q(oe,ke,Be,Ve,Oe,je,Ge)},I=(oe,ke,Ce,Ee,Be,Ve,Oe,je)=>{let Ge,Xe;const{props:qe,shapeFlag:Ke,transition:Je,dirs:rt}=oe;if(Ge=oe.el=w(oe.type,Ve,qe&&qe.is,qe),Ke&8?d(Ge,oe.children):Ke&16&&F(oe.children,Ge,null,Ee,Be,resolveChildrenNamespace(oe,Ve),Oe,je),rt&&invokeDirectiveHook(oe,null,Ee,"created"),O(Ge,oe,oe.scopeId,Oe,Ee),qe){for(const vt in qe)vt!=="value"&&!isReservedProp(vt)&&s(Ge,vt,null,qe[vt],Ve,oe.children,Ee,Be,we);"value"in qe&&s(Ge,"value",null,qe.value,Ve),(Xe=qe.onVnodeBeforeMount)&&invokeVNodeHook(Xe,Ee,oe)}rt&&invokeDirectiveHook(oe,null,Ee,"beforeMount");const ht=needTransition(Be,Je);ht&&Je.beforeEnter(Ge),r(Ge,ke,Ce),((Xe=qe&&qe.onVnodeMounted)||ht||rt)&&queuePostRenderEffect(()=>{Xe&&invokeVNodeHook(Xe,Ee,oe),ht&&Je.enter(Ge),rt&&invokeDirectiveHook(oe,null,Ee,"mounted")},Be)},O=(oe,ke,Ce,Ee,Be)=>{if(Ce&&x(oe,Ce),Ee)for(let Ve=0;Ve<Ee.length;Ve++)x(oe,Ee[Ve]);if(Be){let Ve=Be.subTree;if(ke===Ve){const Oe=Be.vnode;O(oe,Oe,Oe.scopeId,Oe.slotScopeIds,Be.parent)}}},F=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge=0)=>{for(let Xe=Ge;Xe<oe.length;Xe++){const qe=oe[Xe]=je?cloneIfMounted(oe[Xe]):normalizeVNode(oe[Xe]);P(null,qe,ke,Ce,Ee,Be,Ve,Oe,je)}},q=(oe,ke,Ce,Ee,Be,Ve,Oe)=>{const je=ke.el=oe.el;let{patchFlag:Ge,dynamicChildren:Xe,dirs:qe}=ke;Ge|=oe.patchFlag&16;const Ke=oe.props||EMPTY_OBJ,Je=ke.props||EMPTY_OBJ;let rt;if(Ce&&toggleRecurse(Ce,!1),(rt=Je.onVnodeBeforeUpdate)&&invokeVNodeHook(rt,Ce,ke,oe),qe&&invokeDirectiveHook(ke,oe,Ce,"beforeUpdate"),Ce&&toggleRecurse(Ce,!0),Xe?Y(oe.dynamicChildren,Xe,je,Ce,Ee,resolveChildrenNamespace(ke,Be),Ve):Oe||X(oe,ke,je,null,Ce,Ee,resolveChildrenNamespace(ke,Be),Ve,!1),Ge>0){if(Ge&16)_e(je,ke,Ke,Je,Ce,Ee,Be);else if(Ge&2&&Ke.class!==Je.class&&s(je,"class",null,Je.class,Be),Ge&4&&s(je,"style",Ke.style,Je.style,Be),Ge&8){const ht=ke.dynamicProps;for(let vt=0;vt<ht.length;vt++){const Ct=ht[vt],kt=Ke[Ct],mt=Je[Ct];(mt!==kt||Ct==="value")&&s(je,Ct,kt,mt,Be,oe.children,Ce,Ee,we)}}Ge&1&&oe.children!==ke.children&&d(je,ke.children)}else!Oe&&Xe==null&&_e(je,ke,Ke,Je,Ce,Ee,Be);((rt=Je.onVnodeUpdated)||qe)&&queuePostRenderEffect(()=>{rt&&invokeVNodeHook(rt,Ce,ke,oe),qe&&invokeDirectiveHook(ke,oe,Ce,"updated")},Ee)},Y=(oe,ke,Ce,Ee,Be,Ve,Oe)=>{for(let je=0;je<ke.length;je++){const Ge=oe[je],Xe=ke[je],qe=Ge.el&&(Ge.type===Fragment||!isSameVNodeType(Ge,Xe)||Ge.shapeFlag&70)?f(Ge.el):Ce;P(Ge,Xe,qe,null,Ee,Be,Ve,Oe,!0)}},_e=(oe,ke,Ce,Ee,Be,Ve,Oe)=>{if(Ce!==Ee){if(Ce!==EMPTY_OBJ)for(const je in Ce)!isReservedProp(je)&&!(je in Ee)&&s(oe,je,Ce[je],null,Oe,ke.children,Be,Ve,we);for(const je in Ee){if(isReservedProp(je))continue;const Ge=Ee[je],Xe=Ce[je];Ge!==Xe&&je!=="value"&&s(oe,je,Xe,Ge,Oe,ke.children,Be,Ve,we)}"value"in Ee&&s(oe,"value",Ce.value,Ee.value,Oe)}},ne=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge)=>{const Xe=ke.el=oe?oe.el:m(""),qe=ke.anchor=oe?oe.anchor:m("");let{patchFlag:Ke,dynamicChildren:Je,slotScopeIds:rt}=ke;rt&&(je=je?je.concat(rt):rt),oe==null?(r(Xe,Ce,Ee),r(qe,Ce,Ee),F(ke.children||[],Ce,qe,Be,Ve,Oe,je,Ge)):Ke>0&&Ke&64&&Je&&oe.dynamicChildren?(Y(oe.dynamicChildren,Je,Ce,Be,Ve,Oe,je),(ke.key!=null||Be&&ke===Be.subTree)&&traverseStaticChildren(oe,ke,!0)):X(oe,ke,Ce,qe,Be,Ve,Oe,je,Ge)},ve=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge)=>{ke.slotScopeIds=je,oe==null?ke.shapeFlag&512?Be.ctx.activate(ke,Ce,Ee,Oe,Ge):J(ke,Ce,Ee,Be,Ve,Oe,Ge):fe(oe,ke,Ge)},J=(oe,ke,Ce,Ee,Be,Ve,Oe)=>{const je=oe.component=createComponentInstance(oe,Ee,Be);if(isKeepAlive(oe)&&(je.ctx.renderer=Ie),setupComponent(je),je.asyncDep){if(Be&&Be.registerDep(je,Z),!oe.el){const Ge=je.subTree=createVNode(Comment);E(null,Ge,ke,Ce)}}else Z(je,oe,ke,Ce,Be,Ve,Oe)},fe=(oe,ke,Ce)=>{const Ee=ke.component=oe.component;if(shouldUpdateComponent(oe,ke,Ce))if(Ee.asyncDep&&!Ee.asyncResolved){j(Ee,ke,Ce);return}else Ee.next=ke,invalidateJob(Ee.update),Ee.effect.dirty=!0,Ee.update();else ke.el=oe.el,Ee.vnode=ke},Z=(oe,ke,Ce,Ee,Be,Ve,Oe)=>{const je=()=>{if(oe.isMounted){let{next:qe,bu:Ke,u:Je,parent:rt,vnode:ht}=oe;{const Vt=locateNonHydratedAsyncRoot(oe);if(Vt){qe&&(qe.el=ht.el,j(oe,qe,Oe)),Vt.asyncDep.then(()=>{oe.isUnmounted||je()});return}}let vt=qe,Ct;toggleRecurse(oe,!1),qe?(qe.el=ht.el,j(oe,qe,Oe)):qe=ht,Ke&&invokeArrayFns(Ke),(Ct=qe.props&&qe.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ct,rt,qe,ht),toggleRecurse(oe,!0);const kt=renderComponentRoot(oe),mt=oe.subTree;oe.subTree=kt,P(mt,kt,f(mt.el),Ae(mt),oe,Be,Ve),qe.el=kt.el,vt===null&&updateHOCHostEl(oe,kt.el),Je&&queuePostRenderEffect(Je,Be),(Ct=qe.props&&qe.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ct,rt,qe,ht),Be)}else{let qe;const{el:Ke,props:Je}=ke,{bm:rt,m:ht,parent:vt}=oe,Ct=isAsyncWrapper(ke);if(toggleRecurse(oe,!1),rt&&invokeArrayFns(rt),!Ct&&(qe=Je&&Je.onVnodeBeforeMount)&&invokeVNodeHook(qe,vt,ke),toggleRecurse(oe,!0),Ke&&le){const kt=()=>{oe.subTree=renderComponentRoot(oe),le(Ke,oe.subTree,oe,Be,null)};Ct?ke.type.__asyncLoader().then(()=>!oe.isUnmounted&&kt()):kt()}else{const kt=oe.subTree=renderComponentRoot(oe);P(null,kt,Ce,Ee,oe,Be,Ve),ke.el=kt.el}if(ht&&queuePostRenderEffect(ht,Be),!Ct&&(qe=Je&&Je.onVnodeMounted)){const kt=ke;queuePostRenderEffect(()=>invokeVNodeHook(qe,vt,kt),Be)}(ke.shapeFlag&256||vt&&isAsyncWrapper(vt.vnode)&&vt.vnode.shapeFlag&256)&&oe.a&&queuePostRenderEffect(oe.a,Be),oe.isMounted=!0,ke=Ce=Ee=null}},Ge=oe.effect=new ReactiveEffect(je,NOOP,()=>queueJob(Xe),oe.scope),Xe=oe.update=()=>{Ge.dirty&&Ge.run()};Xe.id=oe.uid,toggleRecurse(oe,!0),Xe()},j=(oe,ke,Ce)=>{ke.component=oe;const Ee=oe.vnode.props;oe.vnode=ke,oe.next=null,updateProps(oe,ke.props,Ee,Ce),updateSlots(oe,ke.children,Ce),pauseTracking(),flushPreFlushCbs(oe),resetTracking()},X=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge=!1)=>{const Xe=oe&&oe.children,qe=oe?oe.shapeFlag:0,Ke=ke.children,{patchFlag:Je,shapeFlag:rt}=ke;if(Je>0){if(Je&128){U(Xe,Ke,Ce,Ee,Be,Ve,Oe,je,Ge);return}else if(Je&256){H(Xe,Ke,Ce,Ee,Be,Ve,Oe,je,Ge);return}}rt&8?(qe&16&&we(Xe,Be,Ve),Ke!==Xe&&d(Ce,Ke)):qe&16?rt&16?U(Xe,Ke,Ce,Ee,Be,Ve,Oe,je,Ge):we(Xe,Be,Ve,!0):(qe&8&&d(Ce,""),rt&16&&F(Ke,Ce,Ee,Be,Ve,Oe,je,Ge))},H=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge)=>{oe=oe||EMPTY_ARR,ke=ke||EMPTY_ARR;const Xe=oe.length,qe=ke.length,Ke=Math.min(Xe,qe);let Je;for(Je=0;Je<Ke;Je++){const rt=ke[Je]=Ge?cloneIfMounted(ke[Je]):normalizeVNode(ke[Je]);P(oe[Je],rt,Ce,null,Be,Ve,Oe,je,Ge)}Xe>qe?we(oe,Be,Ve,!0,!1,Ke):F(ke,Ce,Ee,Be,Ve,Oe,je,Ge,Ke)},U=(oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge)=>{let Xe=0;const qe=ke.length;let Ke=oe.length-1,Je=qe-1;for(;Xe<=Ke&&Xe<=Je;){const rt=oe[Xe],ht=ke[Xe]=Ge?cloneIfMounted(ke[Xe]):normalizeVNode(ke[Xe]);if(isSameVNodeType(rt,ht))P(rt,ht,Ce,null,Be,Ve,Oe,je,Ge);else break;Xe++}for(;Xe<=Ke&&Xe<=Je;){const rt=oe[Ke],ht=ke[Je]=Ge?cloneIfMounted(ke[Je]):normalizeVNode(ke[Je]);if(isSameVNodeType(rt,ht))P(rt,ht,Ce,null,Be,Ve,Oe,je,Ge);else break;Ke--,Je--}if(Xe>Ke){if(Xe<=Je){const rt=Je+1,ht=rt<qe?ke[rt].el:Ee;for(;Xe<=Je;)P(null,ke[Xe]=Ge?cloneIfMounted(ke[Xe]):normalizeVNode(ke[Xe]),Ce,ht,Be,Ve,Oe,je,Ge),Xe++}}else if(Xe>Je)for(;Xe<=Ke;)Q(oe[Xe],Be,Ve,!0),Xe++;else{const rt=Xe,ht=Xe,vt=new Map;for(Xe=ht;Xe<=Je;Xe++){const tt=ke[Xe]=Ge?cloneIfMounted(ke[Xe]):normalizeVNode(ke[Xe]);tt.key!=null&&vt.set(tt.key,Xe)}let Ct,kt=0;const mt=Je-ht+1;let Vt=!1,bt=0;const ot=new Array(mt);for(Xe=0;Xe<mt;Xe++)ot[Xe]=0;for(Xe=rt;Xe<=Ke;Xe++){const tt=oe[Xe];if(kt>=mt){Q(tt,Be,Ve,!0);continue}let ut;if(tt.key!=null)ut=vt.get(tt.key);else for(Ct=ht;Ct<=Je;Ct++)if(ot[Ct-ht]===0&&isSameVNodeType(tt,ke[Ct])){ut=Ct;break}ut===void 0?Q(tt,Be,Ve,!0):(ot[ut-ht]=Xe+1,ut>=bt?bt=ut:Vt=!0,P(tt,ke[ut],Ce,null,Be,Ve,Oe,je,Ge),kt++)}const gt=Vt?getSequence(ot):EMPTY_ARR;for(Ct=gt.length-1,Xe=mt-1;Xe>=0;Xe--){const tt=ht+Xe,ut=ke[tt],Re=tt+1<qe?ke[tt+1].el:Ee;ot[Xe]===0?P(null,ut,Ce,Re,Be,Ve,Oe,je,Ge):Vt&&(Ct<0||Xe!==gt[Ct]?te(ut,Ce,Re,2):Ct--)}}},te=(oe,ke,Ce,Ee,Be=null)=>{const{el:Ve,type:Oe,transition:je,children:Ge,shapeFlag:Xe}=oe;if(Xe&6){te(oe.component.subTree,ke,Ce,Ee);return}if(Xe&128){oe.suspense.move(ke,Ce,Ee);return}if(Xe&64){Oe.move(oe,ke,Ce,Ie);return}if(Oe===Fragment){r(Ve,ke,Ce);for(let Ke=0;Ke<Ge.length;Ke++)te(Ge[Ke],ke,Ce,Ee);r(oe.anchor,ke,Ce);return}if(Oe===Static){T(oe,ke,Ce);return}if(Ee!==2&&Xe&1&&je)if(Ee===0)je.beforeEnter(Ve),r(Ve,ke,Ce),queuePostRenderEffect(()=>je.enter(Ve),Be);else{const{leave:Ke,delayLeave:Je,afterLeave:rt}=je,ht=()=>r(Ve,ke,Ce),vt=()=>{Ke(Ve,()=>{ht(),rt&&rt()})};Je?Je(Ve,ht,vt):vt()}else r(Ve,ke,Ce)},Q=(oe,ke,Ce,Ee=!1,Be=!1)=>{const{type:Ve,props:Oe,ref:je,children:Ge,dynamicChildren:Xe,shapeFlag:qe,patchFlag:Ke,dirs:Je}=oe;if(je!=null&&setRef(je,null,Ce,oe,!0),qe&256){ke.ctx.deactivate(oe);return}const rt=qe&1&&Je,ht=!isAsyncWrapper(oe);let vt;if(ht&&(vt=Oe&&Oe.onVnodeBeforeUnmount)&&invokeVNodeHook(vt,ke,oe),qe&6)be(oe.component,Ce,Ee);else{if(qe&128){oe.suspense.unmount(Ce,Ee);return}rt&&invokeDirectiveHook(oe,null,ke,"beforeUnmount"),qe&64?oe.type.remove(oe,ke,Ce,Be,Ie,Ee):Xe&&(Ve!==Fragment||Ke>0&&Ke&64)?we(Xe,ke,Ce,!1,!0):(Ve===Fragment&&Ke&384||!Be&&qe&16)&&we(Ge,ke,Ce),Ee&&re(oe)}(ht&&(vt=Oe&&Oe.onVnodeUnmounted)||rt)&&queuePostRenderEffect(()=>{vt&&invokeVNodeHook(vt,ke,oe),rt&&invokeDirectiveHook(oe,null,ke,"unmounted")},Ce)},re=oe=>{const{type:ke,el:Ce,anchor:Ee,transition:Be}=oe;if(ke===Fragment){Pe(Ce,Ee);return}if(ke===Static){D(oe);return}const Ve=()=>{u(Ce),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(oe.shapeFlag&1&&Be&&!Be.persisted){const{leave:Oe,delayLeave:je}=Be,Ge=()=>Oe(Ce,Ve);je?je(oe.el,Ve,Ge):Ge()}else Ve()},Pe=(oe,ke)=>{let Ce;for(;oe!==ke;)Ce=y(oe),u(oe),oe=Ce;u(ke)},be=(oe,ke,Ce)=>{const{bum:Ee,scope:Be,update:Ve,subTree:Oe,um:je}=oe;Ee&&invokeArrayFns(Ee),Be.stop(),Ve&&(Ve.active=!1,Q(Oe,oe,ke,Ce)),je&&queuePostRenderEffect(je,ke),queuePostRenderEffect(()=>{oe.isUnmounted=!0},ke),ke&&ke.pendingBranch&&!ke.isUnmounted&&oe.asyncDep&&!oe.asyncResolved&&oe.suspenseId===ke.pendingId&&(ke.deps--,ke.deps===0&&ke.resolve())},we=(oe,ke,Ce,Ee=!1,Be=!1,Ve=0)=>{for(let Oe=Ve;Oe<oe.length;Oe++)Q(oe[Oe],ke,Ce,Ee,Be)},Ae=oe=>oe.shapeFlag&6?Ae(oe.component.subTree):oe.shapeFlag&128?oe.suspense.next():y(oe.anchor||oe.el);let $e=!1;const Me=(oe,ke,Ce)=>{oe==null?ke._vnode&&Q(ke._vnode,null,null,!0):P(ke._vnode||null,oe,ke,null,null,null,Ce),$e||($e=!0,flushPreFlushCbs(),flushPostFlushCbs(),$e=!1),ke._vnode=oe},Ie={p:P,um:Q,m:te,r:re,mt:J,mc:F,pc:X,pbc:Y,n:Ae,o:e};let Le,le;return n&&([Le,le]=n(Ie)),{render:Me,hydrate:Le,createApp:createAppAPI(Me,Le)}}function resolveChildrenNamespace({type:e,props:n},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:o}function toggleRecurse({effect:e,update:n},o){e.allowRecurse=n.allowRecurse=o}function needTransition(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function traverseStaticChildren(e,n,o=!1){const r=e.children,u=n.children;if(isArray$3(r)&&isArray$3(u))for(let s=0;s<r.length;s++){const w=r[s];let m=u[s];m.shapeFlag&1&&!m.dynamicChildren&&((m.patchFlag<=0||m.patchFlag===32)&&(m=u[s]=cloneIfMounted(u[s]),m.el=w.el),o||traverseStaticChildren(w,m)),m.type===Text$2&&(m.el=w.el)}}function getSequence(e){const n=e.slice(),o=[0];let r,u,s,w,m;const v=e.length;for(r=0;r<v;r++){const g=e[r];if(g!==0){if(u=o[o.length-1],e[u]<g){n[r]=u,o.push(r);continue}for(s=0,w=o.length-1;s<w;)m=s+w>>1,e[o[m]]<g?s=m+1:w=m;g<e[o[s]]&&(s>0&&(n[r]=o[s-1]),o[s]=r)}}for(s=o.length,w=o[s-1];s-- >0;)o[s]=w,w=n[w];return o}function locateNonHydratedAsyncRoot(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:locateNonHydratedAsyncRoot(n)}const isTeleport=e=>e.__isTeleport,isTeleportDisabled=e=>e&&(e.disabled||e.disabled===""),isTargetSVG=e=>typeof SVGElement<"u"&&e instanceof SVGElement,isTargetMathML=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,resolveTarget=(e,n)=>{const o=e&&e.to;return isString$3(o)?n?n(o):null:o},TeleportImpl={name:"Teleport",__isTeleport:!0,process(e,n,o,r,u,s,w,m,v,g){const{mc:d,pc:f,pbc:y,o:{insert:x,querySelector:k,createText:P,createComment:S}}=g,E=isTeleportDisabled(n.props);let{shapeFlag:M,children:T,dynamicChildren:D}=n;if(e==null){const N=n.el=P(""),I=n.anchor=P("");x(N,o,r),x(I,o,r);const O=n.target=resolveTarget(n.props,k),F=n.targetAnchor=P("");O&&(x(F,O),w==="svg"||isTargetSVG(O)?w="svg":(w==="mathml"||isTargetMathML(O))&&(w="mathml"));const q=(Y,_e)=>{M&16&&d(T,Y,_e,u,s,w,m,v)};E?q(o,I):O&&q(O,F)}else{n.el=e.el;const N=n.anchor=e.anchor,I=n.target=e.target,O=n.targetAnchor=e.targetAnchor,F=isTeleportDisabled(e.props),q=F?o:I,Y=F?N:O;if(w==="svg"||isTargetSVG(I)?w="svg":(w==="mathml"||isTargetMathML(I))&&(w="mathml"),D?(y(e.dynamicChildren,D,q,u,s,w,m),traverseStaticChildren(e,n,!0)):v||f(e,n,q,Y,u,s,w,m,!1),E)F?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):moveTeleport(n,o,N,g,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const _e=n.target=resolveTarget(n.props,k);_e&&moveTeleport(n,_e,null,g,0)}else F&&moveTeleport(n,I,O,g,1)}updateCssVars(n)},remove(e,n,o,r,{um:u,o:{remove:s}},w){const{shapeFlag:m,children:v,anchor:g,targetAnchor:d,target:f,props:y}=e;if(f&&s(d),w&&s(g),m&16){const x=w||!isTeleportDisabled(y);for(let k=0;k<v.length;k++){const P=v[k];u(P,n,o,x,!!P.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(e,n,o,{o:{insert:r},m:u},s=2){s===0&&r(e.targetAnchor,n,o);const{el:w,anchor:m,shapeFlag:v,children:g,props:d}=e,f=s===2;if(f&&r(w,n,o),(!f||isTeleportDisabled(d))&&v&16)for(let y=0;y<g.length;y++)u(g[y],n,o,2);f&&r(m,n,o)}function hydrateTeleport(e,n,o,r,u,s,{o:{nextSibling:w,parentNode:m,querySelector:v}},g){const d=n.target=resolveTarget(n.props,v);if(d){const f=d._lpa||d.firstChild;if(n.shapeFlag&16)if(isTeleportDisabled(n.props))n.anchor=g(w(e),n,m(e),o,r,u,s),n.targetAnchor=f;else{n.anchor=w(e);let y=f;for(;y;)if(y=w(y),y&&y.nodeType===8&&y.data==="teleport anchor"){n.targetAnchor=y,d._lpa=n.targetAnchor&&w(n.targetAnchor);break}g(f,n,d,o,r,u,s)}updateCssVars(n)}return n.anchor&&w(n.anchor)}const Teleport=TeleportImpl;function updateCssVars(e){const n=e.ctx;if(n&&n.ut){let o=e.children[0].el;for(;o&&o!==e.targetAnchor;)o.nodeType===1&&o.setAttribute("data-v-owner",n.uid),o=o.nextSibling;n.ut()}}const Fragment=Symbol.for("v-fgt"),Text$2=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(e=!1){blockStack.push(currentBlock=e?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(e){isBlockTreeEnabled+=e}function setupBlock(e){return e.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(e),e}function createElementBlock(e,n,o,r,u,s){return setupBlock(createBaseVNode(e,n,o,r,u,s,!0))}function createBlock(e,n,o,r,u){return setupBlock(createVNode(e,n,o,r,u,!0))}function isVNode(e){return e?e.__v_isVNode===!0:!1}function isSameVNodeType(e,n){return e.type===n.type&&e.key===n.key}const normalizeKey=({key:e})=>e!=null?e:null,normalizeRef=({ref:e,ref_key:n,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?isString$3(e)||isRef(e)||isFunction$2(e)?{i:currentRenderingInstance,r:e,k:n,f:!!o}:e:null);function createBaseVNode(e,n=null,o=null,r=0,u=null,s=e===Fragment?0:1,w=!1,m=!1){const v={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&normalizeKey(n),ref:n&&normalizeRef(n),scopeId:currentScopeId,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:u,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return m?(normalizeChildren(v,o),s&128&&e.normalize(v)):o&&(v.shapeFlag|=isString$3(o)?8:16),isBlockTreeEnabled>0&&!w&&currentBlock&&(v.patchFlag>0||s&6)&&v.patchFlag!==32&&currentBlock.push(v),v}const createVNode=_createVNode;function _createVNode(e,n=null,o=null,r=0,u=null,s=!1){if((!e||e===NULL_DYNAMIC_COMPONENT)&&(e=Comment),isVNode(e)){const m=cloneVNode(e,n,!0);return o&&normalizeChildren(m,o),isBlockTreeEnabled>0&&!s&&currentBlock&&(m.shapeFlag&6?currentBlock[currentBlock.indexOf(e)]=m:currentBlock.push(m)),m.patchFlag|=-2,m}if(isClassComponent(e)&&(e=e.__vccOpts),n){n=guardReactiveProps(n);let{class:m,style:v}=n;m&&!isString$3(m)&&(n.class=normalizeClass(m)),isObject$3(v)&&(isProxy(v)&&!isArray$3(v)&&(v=extend$3({},v)),n.style=normalizeStyle(v))}const w=isString$3(e)?1:isSuspense(e)?128:isTeleport(e)?64:isObject$3(e)?4:isFunction$2(e)?2:0;return createBaseVNode(e,n,o,r,u,w,s,!0)}function guardReactiveProps(e){return e?isProxy(e)||isInternalObject(e)?extend$3({},e):e:null}function cloneVNode(e,n,o=!1,r=!1){const{props:u,ref:s,patchFlag:w,children:m,transition:v}=e,g=n?mergeProps(u||{},n):u,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:g,key:g&&normalizeKey(g),ref:n&&n.ref?o&&s?isArray$3(s)?s.concat(normalizeRef(n)):[s,normalizeRef(n)]:normalizeRef(n):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:m,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==Fragment?w===-1?16:w|16:w,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:v,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&cloneVNode(e.ssContent),ssFallback:e.ssFallback&&cloneVNode(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return v&&r&&(d.transition=v.clone(d)),d}function createTextVNode(e=" ",n=0){return createVNode(Text$2,null,e,n)}function createStaticVNode(e,n){const o=createVNode(Static,null,e);return o.staticCount=n,o}function createCommentVNode(e="",n=!1){return n?(openBlock(),createBlock(Comment,null,e)):createVNode(Comment,null,e)}function normalizeVNode(e){return e==null||typeof e=="boolean"?createVNode(Comment):isArray$3(e)?createVNode(Fragment,null,e.slice()):typeof e=="object"?cloneIfMounted(e):createVNode(Text$2,null,String(e))}function cloneIfMounted(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:cloneVNode(e)}function normalizeChildren(e,n){let o=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(isArray$3(n))o=16;else if(typeof n=="object")if(r&65){const u=n.default;u&&(u._c&&(u._d=!1),normalizeChildren(e,u()),u._c&&(u._d=!0));return}else{o=32;const u=n._;!u&&!isInternalObject(n)?n._ctx=currentRenderingInstance:u===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else isFunction$2(n)?(n={default:n,_ctx:currentRenderingInstance},o=32):(n=String(n),r&64?(o=16,n=[createTextVNode(n)]):o=8);e.children=n,e.shapeFlag|=o}function mergeProps(...e){const n={};for(let o=0;o<e.length;o++){const r=e[o];for(const u in r)if(u==="class")n.class!==r.class&&(n.class=normalizeClass([n.class,r.class]));else if(u==="style")n.style=normalizeStyle([n.style,r.style]);else if(isOn(u)){const s=n[u],w=r[u];w&&s!==w&&!(isArray$3(s)&&s.includes(w))&&(n[u]=s?[].concat(s,w):w)}else u!==""&&(n[u]=r[u])}return n}function invokeVNodeHook(e,n,o,r=null){callWithAsyncErrorHandling(e,n,7,[o,r])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(e,n,o){const r=e.type,u=(n?n.appContext:e.appContext)||emptyAppContext,s={uid:uid++,vnode:e,type:r,parent:n,appContext:u,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(u.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(r,u),emitsOptions:normalizeEmitsOptions(r,u),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:r.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=n?n.root:s,s.emit=emit.bind(null,s),e.ce&&e.ce(s),s}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const e=getGlobalThis(),n=(o,r)=>{let u;return(u=e[o])||(u=e[o]=[]),u.push(r),s=>{u.length>1?u.forEach(w=>w(s)):u[0](s)}};internalSetCurrentInstance=n("__VUE_INSTANCE_SETTERS__",o=>currentInstance=o),setInSSRSetupState=n("__VUE_SSR_SETTERS__",o=>isInSSRComponentSetup=o)}const setCurrentInstance=e=>{const n=currentInstance;return internalSetCurrentInstance(e),e.scope.on(),()=>{e.scope.off(),internalSetCurrentInstance(n)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(e){return e.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(e,n=!1){n&&setInSSRSetupState(n);const{props:o,children:r}=e.vnode,u=isStatefulComponent(e);initProps(e,o,u,n),initSlots(e,r);const s=u?setupStatefulComponent(e,n):void 0;return n&&setInSSRSetupState(!1),s}function setupStatefulComponent(e,n){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,PublicInstanceProxyHandlers);const{setup:r}=o;if(r){const u=e.setupContext=r.length>1?createSetupContext(e):null,s=setCurrentInstance(e);pauseTracking();const w=callWithErrorHandling(r,e,0,[e.props,u]);if(resetTracking(),s(),isPromise$1(w)){if(w.then(unsetCurrentInstance,unsetCurrentInstance),n)return w.then(m=>{handleSetupResult(e,m,n)}).catch(m=>{handleError(m,e,0)});e.asyncDep=w}else handleSetupResult(e,w,n)}else finishComponentSetup(e,n)}function handleSetupResult(e,n,o){isFunction$2(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:isObject$3(n)&&(e.setupState=proxyRefs(n)),finishComponentSetup(e,o)}let compile;function finishComponentSetup(e,n,o){const r=e.type;if(!e.render){if(!n&&compile&&!r.render){const u=r.template||resolveMergedOptions(e).template;if(u){const{isCustomElement:s,compilerOptions:w}=e.appContext.config,{delimiters:m,compilerOptions:v}=r,g=extend$3(extend$3({isCustomElement:s,delimiters:m},w),v);r.render=compile(u,g)}}e.render=r.render||NOOP}{const u=setCurrentInstance(e);pauseTracking();try{applyOptions(e)}finally{resetTracking(),u()}}}const attrsProxyHandlers={get(e,n){return track(e,"get",""),e[n]}};function createSetupContext(e){const n=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,attrsProxyHandlers),slots:e.slots,emit:e.emit,expose:n}}function getExposeProxy(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(proxyRefs(markRaw(e.exposed)),{get(n,o){if(o in n)return n[o];if(o in publicPropertiesMap)return publicPropertiesMap[o](e)},has(n,o){return o in n||o in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=e=>e.replace(classifyRE,n=>n.toUpperCase()).replace(/[-_]/g,"");function getComponentName(e,n=!0){return isFunction$2(e)?e.displayName||e.name:e.name||n&&e.__name}function formatComponentName(e,n,o=!1){let r=getComponentName(n);if(!r&&n.__file){const u=n.__file.match(/([^/\\]+)\.\w+$/);u&&(r=u[1])}if(!r&&e&&e.parent){const u=s=>{for(const w in s)if(s[w]===n)return w};r=u(e.components||e.parent.type.components)||u(e.appContext.components)}return r?classify(r):o?"App":"Anonymous"}function isClassComponent(e){return isFunction$2(e)&&"__vccOpts"in e}const computed=(e,n)=>computed$1(e,n,isInSSRComponentSetup);function h$1(e,n,o){const r=arguments.length;return r===2?isObject$3(n)&&!isArray$3(n)?isVNode(n)?createVNode(e,null,[n]):createVNode(e,n):createVNode(e,null,n):(r>3?o=Array.prototype.slice.call(arguments,2):r===3&&isVNode(o)&&(o=[o]),createVNode(e,n,o))}const version$2="3.4.27";/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(e,n,o)=>{n.insertBefore(e,o||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,o,r)=>{const u=n==="svg"?doc.createElementNS(svgNS,e):n==="mathml"?doc.createElementNS(mathmlNS,e):doc.createElement(e,o?{is:o}:void 0);return e==="select"&&r&&r.multiple!=null&&u.setAttribute("multiple",r.multiple),u},createText:e=>doc.createTextNode(e),createComment:e=>doc.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>doc.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,o,r,u,s){const w=o?o.previousSibling:n.lastChild;if(u&&(u===s||u.nextSibling))for(;n.insertBefore(u.cloneNode(!0),o),!(u===s||!(u=u.nextSibling)););else{templateContainer.innerHTML=r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e;const m=templateContainer.content;if(r==="svg"||r==="mathml"){const v=m.firstChild;for(;v.firstChild;)m.appendChild(v.firstChild);m.removeChild(v)}n.insertBefore(m,o)}return[w?w.nextSibling:n.firstChild,o?o.previousSibling:n.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(e,{slots:n})=>h$1(BaseTransition,resolveTransitionProps(e),n);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$3({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(e,n=[])=>{isArray$3(e)?e.forEach(o=>o(...n)):e&&e(...n)},hasExplicitCallback=e=>e?isArray$3(e)?e.some(n=>n.length>1):e.length>1:!1;function resolveTransitionProps(e){const n={};for(const ne in e)ne in DOMTransitionPropsValidators||(n[ne]=e[ne]);if(e.css===!1)return n;const{name:o="v",type:r,duration:u,enterFromClass:s=`${o}-enter-from`,enterActiveClass:w=`${o}-enter-active`,enterToClass:m=`${o}-enter-to`,appearFromClass:v=s,appearActiveClass:g=w,appearToClass:d=m,leaveFromClass:f=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:x=`${o}-leave-to`}=e,k=normalizeDuration(u),P=k&&k[0],S=k&&k[1],{onBeforeEnter:E,onEnter:M,onEnterCancelled:T,onLeave:D,onLeaveCancelled:N,onBeforeAppear:I=E,onAppear:O=M,onAppearCancelled:F=T}=n,q=(ne,ve,J)=>{removeTransitionClass(ne,ve?d:m),removeTransitionClass(ne,ve?g:w),J&&J()},Y=(ne,ve)=>{ne._isLeaving=!1,removeTransitionClass(ne,f),removeTransitionClass(ne,x),removeTransitionClass(ne,y),ve&&ve()},_e=ne=>(ve,J)=>{const fe=ne?O:M,Z=()=>q(ve,ne,J);callHook(fe,[ve,Z]),nextFrame(()=>{removeTransitionClass(ve,ne?v:s),addTransitionClass(ve,ne?d:m),hasExplicitCallback(fe)||whenTransitionEnds(ve,r,P,Z)})};return extend$3(n,{onBeforeEnter(ne){callHook(E,[ne]),addTransitionClass(ne,s),addTransitionClass(ne,w)},onBeforeAppear(ne){callHook(I,[ne]),addTransitionClass(ne,v),addTransitionClass(ne,g)},onEnter:_e(!1),onAppear:_e(!0),onLeave(ne,ve){ne._isLeaving=!0;const J=()=>Y(ne,ve);addTransitionClass(ne,f),addTransitionClass(ne,y),forceReflow(),nextFrame(()=>{!ne._isLeaving||(removeTransitionClass(ne,f),addTransitionClass(ne,x),hasExplicitCallback(D)||whenTransitionEnds(ne,r,S,J))}),callHook(D,[ne,J])},onEnterCancelled(ne){q(ne,!1),callHook(T,[ne])},onAppearCancelled(ne){q(ne,!0),callHook(F,[ne])},onLeaveCancelled(ne){Y(ne),callHook(N,[ne])}})}function normalizeDuration(e){if(e==null)return null;if(isObject$3(e))return[NumberOf(e.enter),NumberOf(e.leave)];{const n=NumberOf(e);return[n,n]}}function NumberOf(e){return toNumber$1(e)}function addTransitionClass(e,n){n.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[vtcKey]||(e[vtcKey]=new Set)).add(n)}function removeTransitionClass(e,n){n.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const o=e[vtcKey];o&&(o.delete(n),o.size||(e[vtcKey]=void 0))}function nextFrame(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let endId=0;function whenTransitionEnds(e,n,o,r){const u=e._endId=++endId,s=()=>{u===e._endId&&r()};if(o)return setTimeout(s,o);const{type:w,timeout:m,propCount:v}=getTransitionInfo(e,n);if(!w)return r();const g=w+"end";let d=0;const f=()=>{e.removeEventListener(g,y),s()},y=x=>{x.target===e&&++d>=v&&f()};setTimeout(()=>{d<v&&f()},m+1),e.addEventListener(g,y)}function getTransitionInfo(e,n){const o=window.getComputedStyle(e),r=k=>(o[k]||"").split(", "),u=r(`${TRANSITION}Delay`),s=r(`${TRANSITION}Duration`),w=getTimeout(u,s),m=r(`${ANIMATION}Delay`),v=r(`${ANIMATION}Duration`),g=getTimeout(m,v);let d=null,f=0,y=0;n===TRANSITION?w>0&&(d=TRANSITION,f=w,y=s.length):n===ANIMATION?g>0&&(d=ANIMATION,f=g,y=v.length):(f=Math.max(w,g),d=f>0?w>g?TRANSITION:ANIMATION:null,y=d?d===TRANSITION?s.length:v.length:0);const x=d===TRANSITION&&/\b(transform|all)(,|$)/.test(r(`${TRANSITION}Property`).toString());return{type:d,timeout:f,propCount:y,hasTransform:x}}function getTimeout(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((o,r)=>toMs(o)+toMs(e[r])))}function toMs(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(e,n,o){const r=e[vtcKey];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):o?e.setAttribute("class",n):e.className=n}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(e,{value:n},{transition:o}){e[vShowOriginalDisplay]=e.style.display==="none"?"":e.style.display,o&&n?o.beforeEnter(e):setDisplay(e,n)},mounted(e,{value:n},{transition:o}){o&&n&&o.enter(e)},updated(e,{value:n,oldValue:o},{transition:r}){!n!=!o&&(r?n?(r.beforeEnter(e),setDisplay(e,!0),r.enter(e)):r.leave(e,()=>{setDisplay(e,!1)}):setDisplay(e,n))},beforeUnmount(e,{value:n}){setDisplay(e,n)}};function setDisplay(e,n){e.style.display=n?e[vShowOriginalDisplay]:"none",e[vShowHidden]=!n}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(e,n,o){const r=e.style,u=isString$3(o);let s=!1;if(o&&!u){if(n)if(isString$3(n))for(const w of n.split(";")){const m=w.slice(0,w.indexOf(":")).trim();o[m]==null&&setStyle(r,m,"")}else for(const w in n)o[w]==null&&setStyle(r,w,"");for(const w in o)w==="display"&&(s=!0),setStyle(r,w,o[w])}else if(u){if(n!==o){const w=r[CSS_VAR_TEXT];w&&(o+=";"+w),r.cssText=o,s=displayRE.test(o)}}else n&&e.removeAttribute("style");vShowOriginalDisplay in e&&(e[vShowOriginalDisplay]=s?r.display:"",e[vShowHidden]&&(r.display="none"))}const importantRE=/\s*!important$/;function setStyle(e,n,o){if(isArray$3(o))o.forEach(r=>setStyle(e,n,r));else if(o==null&&(o=""),n.startsWith("--"))e.setProperty(n,o);else{const r=autoPrefix(e,n);importantRE.test(o)?e.setProperty(hyphenate(r),o.replace(importantRE,""),"important"):e[r]=o}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(e,n){const o=prefixCache[n];if(o)return o;let r=camelize(n);if(r!=="filter"&&r in e)return prefixCache[n]=r;r=capitalize(r);for(let u=0;u<prefixes.length;u++){const s=prefixes[u]+r;if(s in e)return prefixCache[n]=s}return n}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(e,n,o,r,u){if(r&&n.startsWith("xlink:"))o==null?e.removeAttributeNS(xlinkNS,n.slice(6,n.length)):e.setAttributeNS(xlinkNS,n,o);else{const s=isSpecialBooleanAttr(n);o==null||s&&!includeBooleanAttr(o)?e.removeAttribute(n):e.setAttribute(n,s?"":o)}}function patchDOMProp(e,n,o,r,u,s,w){if(n==="innerHTML"||n==="textContent"){r&&w(r,u,s),e[n]=o==null?"":o;return}const m=e.tagName;if(n==="value"&&m!=="PROGRESS"&&!m.includes("-")){const g=m==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?"":o;(g!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(n),e._value=o;return}let v=!1;if(o===""||o==null){const g=typeof e[n];g==="boolean"?o=includeBooleanAttr(o):o==null&&g==="string"?(o="",v=!0):g==="number"&&(o=0,v=!0)}try{e[n]=o}catch{}v&&e.removeAttribute(n)}function addEventListener(e,n,o,r){e.addEventListener(n,o,r)}function removeEventListener(e,n,o,r){e.removeEventListener(n,o,r)}const veiKey=Symbol("_vei");function patchEvent(e,n,o,r,u=null){const s=e[veiKey]||(e[veiKey]={}),w=s[n];if(r&&w)w.value=r;else{const[m,v]=parseName(n);if(r){const g=s[n]=createInvoker(r,u);addEventListener(e,m,g,v)}else w&&(removeEventListener(e,m,w,v),s[n]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(e){let n;if(optionsModifierRE.test(e)){n={};let r;for(;r=e.match(optionsModifierRE);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):hyphenate(e.slice(2)),n]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(e,n){const o=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=o.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(r,o.value),n,5,[r])};return o.value=e,o.attached=getNow(),o}function patchStopImmediatePropagation(e,n){if(isArray$3(n)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},n.map(r=>u=>!u._stopped&&r&&r(u))}else return n}const isNativeOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,patchProp=(e,n,o,r,u,s,w,m,v)=>{const g=u==="svg";n==="class"?patchClass(e,r,g):n==="style"?patchStyle(e,o,r):isOn(n)?isModelListener(n)||patchEvent(e,n,o,r,w):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):shouldSetAsProp(e,n,r,g))?patchDOMProp(e,n,r,s,w,m,v):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),patchAttr(e,n,r,g))};function shouldSetAsProp(e,n,o,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&isNativeOn(n)&&isFunction$2(o));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const u=e.tagName;if(u==="IMG"||u==="VIDEO"||u==="CANVAS"||u==="SOURCE")return!1}return isNativeOn(n)&&isString$3(o)?!1:n in e}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$3({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(e,{slots:n}){const o=getCurrentInstance(),r=useTransitionState();let u,s;return onUpdated(()=>{if(!u.length)return;const w=e.moveClass||`${e.name||"v"}-move`;if(!hasCSSTransform(u[0].el,o.vnode.el,w))return;u.forEach(callPendingCbs),u.forEach(recordPosition);const m=u.filter(applyTranslation);forceReflow(),m.forEach(v=>{const g=v.el,d=g.style;addTransitionClass(g,w),d.transform=d.webkitTransform=d.transitionDuration="";const f=g[moveCbKey]=y=>{y&&y.target!==g||(!y||/transform$/.test(y.propertyName))&&(g.removeEventListener("transitionend",f),g[moveCbKey]=null,removeTransitionClass(g,w))};g.addEventListener("transitionend",f)})}),()=>{const w=toRaw(e),m=resolveTransitionProps(w);let v=w.tag||Fragment;if(u=[],s)for(let g=0;g<s.length;g++){const d=s[g];d.el&&d.el instanceof Element&&(u.push(d),setTransitionHooks(d,resolveTransitionHooks(d,m,r,o)),positionMap.set(d,d.el.getBoundingClientRect()))}s=n.default?getTransitionRawChildren(n.default()):[];for(let g=0;g<s.length;g++){const d=s[g];d.key!=null&&setTransitionHooks(d,resolveTransitionHooks(d,m,r,o))}return createVNode(v,null,s)}}},removeMode=e=>delete e.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(e){const n=e.el;n[moveCbKey]&&n[moveCbKey](),n[enterCbKey]&&n[enterCbKey]()}function recordPosition(e){newPositionMap.set(e,e.el.getBoundingClientRect())}function applyTranslation(e){const n=positionMap.get(e),o=newPositionMap.get(e),r=n.left-o.left,u=n.top-o.top;if(r||u){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${r}px,${u}px)`,s.transitionDuration="0s",e}}function hasCSSTransform(e,n,o){const r=e.cloneNode(),u=e[vtcKey];u&&u.forEach(m=>{m.split(/\s+/).forEach(v=>v&&r.classList.remove(v))}),o.split(/\s+/).forEach(m=>m&&r.classList.add(m)),r.style.display="none";const s=n.nodeType===1?n:n.parentNode;s.appendChild(r);const{hasTransform:w}=getTransitionInfo(r);return s.removeChild(r),w}const getModelAssigner=e=>{const n=e.props["onUpdate:modelValue"]||!1;return isArray$3(n)?o=>invokeArrayFns(n,o):n};function onCompositionStart(e){e.target.composing=!0}function onCompositionEnd(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(e,{modifiers:{lazy:n,trim:o,number:r}},u){e[assignKey]=getModelAssigner(u);const s=r||u.props&&u.props.type==="number";addEventListener(e,n?"change":"input",w=>{if(w.target.composing)return;let m=e.value;o&&(m=m.trim()),s&&(m=looseToNumber(m)),e[assignKey](m)}),o&&addEventListener(e,"change",()=>{e.value=e.value.trim()}),n||(addEventListener(e,"compositionstart",onCompositionStart),addEventListener(e,"compositionend",onCompositionEnd),addEventListener(e,"change",onCompositionEnd))},mounted(e,{value:n}){e.value=n==null?"":n},beforeUpdate(e,{value:n,modifiers:{lazy:o,trim:r,number:u}},s){if(e[assignKey]=getModelAssigner(s),e.composing)return;const w=(u||e.type==="number")&&!/^0\d/.test(e.value)?looseToNumber(e.value):e.value,m=n==null?"":n;w!==m&&(document.activeElement===e&&e.type!=="range"&&(o||r&&e.value.trim()===m)||(e.value=m))}},vModelCheckbox={deep:!0,created(e,n,o){e[assignKey]=getModelAssigner(o),addEventListener(e,"change",()=>{const r=e._modelValue,u=getValue$1(e),s=e.checked,w=e[assignKey];if(isArray$3(r)){const m=looseIndexOf(r,u),v=m!==-1;if(s&&!v)w(r.concat(u));else if(!s&&v){const g=[...r];g.splice(m,1),w(g)}}else if(isSet(r)){const m=new Set(r);s?m.add(u):m.delete(u),w(m)}else w(getCheckboxValue(e,s))})},mounted:setChecked,beforeUpdate(e,n,o){e[assignKey]=getModelAssigner(o),setChecked(e,n,o)}};function setChecked(e,{value:n,oldValue:o},r){e._modelValue=n,isArray$3(n)?e.checked=looseIndexOf(n,r.props.value)>-1:isSet(n)?e.checked=n.has(r.props.value):n!==o&&(e.checked=looseEqual(n,getCheckboxValue(e,!0)))}const vModelRadio={created(e,{value:n},o){e.checked=looseEqual(n,o.props.value),e[assignKey]=getModelAssigner(o),addEventListener(e,"change",()=>{e[assignKey](getValue$1(e))})},beforeUpdate(e,{value:n,oldValue:o},r){e[assignKey]=getModelAssigner(r),n!==o&&(e.checked=looseEqual(n,r.props.value))}},vModelSelect={deep:!0,created(e,{value:n,modifiers:{number:o}},r){const u=isSet(n);addEventListener(e,"change",()=>{const s=Array.prototype.filter.call(e.options,w=>w.selected).map(w=>o?looseToNumber(getValue$1(w)):getValue$1(w));e[assignKey](e.multiple?u?new Set(s):s:s[0]),e._assigning=!0,nextTick(()=>{e._assigning=!1})}),e[assignKey]=getModelAssigner(r)},mounted(e,{value:n,modifiers:{number:o}}){setSelected(e,n)},beforeUpdate(e,n,o){e[assignKey]=getModelAssigner(o)},updated(e,{value:n,modifiers:{number:o}}){e._assigning||setSelected(e,n)}};function setSelected(e,n,o){const r=e.multiple,u=isArray$3(n);if(!(r&&!u&&!isSet(n))){for(let s=0,w=e.options.length;s<w;s++){const m=e.options[s],v=getValue$1(m);if(r)if(u){const g=typeof v;g==="string"||g==="number"?m.selected=n.some(d=>String(d)===String(v)):m.selected=looseIndexOf(n,v)>-1}else m.selected=n.has(v);else if(looseEqual(getValue$1(m),n)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function getValue$1(e){return"_value"in e?e._value:e.value}function getCheckboxValue(e,n){const o=n?"_trueValue":"_falseValue";return o in e?e[o]:n}const vModelDynamic={created(e,n,o){callModelHook(e,n,o,null,"created")},mounted(e,n,o){callModelHook(e,n,o,null,"mounted")},beforeUpdate(e,n,o,r){callModelHook(e,n,o,r,"beforeUpdate")},updated(e,n,o,r){callModelHook(e,n,o,r,"updated")}};function resolveDynamicModel(e,n){switch(e){case"SELECT":return vModelSelect;case"TEXTAREA":return vModelText;default:switch(n){case"checkbox":return vModelCheckbox;case"radio":return vModelRadio;default:return vModelText}}}function callModelHook(e,n,o,r,u){const w=resolveDynamicModel(e.tagName,o.props&&o.props.type)[u];w&&w(e,n,o,r)}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>systemModifiers.some(o=>e[`${o}Key`]&&!n.includes(o))},withModifiers=(e,n)=>{const o=e._withMods||(e._withMods={}),r=n.join(".");return o[r]||(o[r]=(u,...s)=>{for(let w=0;w<n.length;w++){const m=modifierGuards[n[w]];if(m&&m(u,n))return}return e(u,...s)})},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(e,n)=>{const o=e._withKeys||(e._withKeys={}),r=n.join(".");return o[r]||(o[r]=u=>{if(!("key"in u))return;const s=hyphenate(u.key);if(n.some(w=>w===s||keyNames[w]===s))return e(u)})},rendererOptions=extend$3({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...e)=>{const n=ensureRenderer().createApp(...e),{mount:o}=n;return n.mount=r=>{const u=normalizeContainer(r);if(!u)return;const s=n._component;!isFunction$2(s)&&!s.render&&!s.template&&(s.template=u.innerHTML),u.innerHTML="";const w=o(u,!1,resolveRootNamespace(u));return u instanceof Element&&(u.removeAttribute("v-cloak"),u.setAttribute("data-v-app","")),w},n};function resolveRootNamespace(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function normalizeContainer(e){return isString$3(e)?document.querySelector(e):e}const isString$2=e=>typeof e=="string",defer=()=>{let e,n;const o=new Promise((r,u)=>{e=r,n=u});return o.resolve=e,o.reject=n,o},makeString=e=>e==null?"":""+e,copy$2=(e,n,o)=>{e.forEach(r=>{n[r]&&(o[r]=n[r])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=e=>e&&e.indexOf("###")>-1?e.replace(lastOfPathSeparatorRegExp,"."):e,canNotTraverseDeeper=e=>!e||isString$2(e),getLastOfPath=(e,n,o)=>{const r=isString$2(n)?n.split("."):n;let u=0;for(;u<r.length-1;){if(canNotTraverseDeeper(e))return{};const s=cleanKey(r[u]);!e[s]&&o&&(e[s]=new o),Object.prototype.hasOwnProperty.call(e,s)?e=e[s]:e={},++u}return canNotTraverseDeeper(e)?{}:{obj:e,k:cleanKey(r[u])}},setPath=(e,n,o)=>{const{obj:r,k:u}=getLastOfPath(e,n,Object);if(r!==void 0||n.length===1){r[u]=o;return}let s=n[n.length-1],w=n.slice(0,n.length-1),m=getLastOfPath(e,w,Object);for(;m.obj===void 0&&w.length;)s=`${w[w.length-1]}.${s}`,w=w.slice(0,w.length-1),m=getLastOfPath(e,w,Object),(m==null?void 0:m.obj)&&typeof m.obj[`${m.k}.${s}`]<"u"&&(m.obj=void 0);m.obj[`${m.k}.${s}`]=o},pushPath=(e,n,o,r)=>{const{obj:u,k:s}=getLastOfPath(e,n,Object);u[s]=u[s]||[],u[s].push(o)},getPath$1=(e,n)=>{const{obj:o,k:r}=getLastOfPath(e,n);if(!!o&&!!Object.prototype.hasOwnProperty.call(o,r))return o[r]},getPathWithDefaults=(e,n,o)=>{const r=getPath$1(e,o);return r!==void 0?r:getPath$1(n,o)},deepExtend=(e,n,o)=>{for(const r in n)r!=="__proto__"&&r!=="constructor"&&(r in e?isString$2(e[r])||e[r]instanceof String||isString$2(n[r])||n[r]instanceof String?o&&(e[r]=n[r]):deepExtend(e[r],n[r],o):e[r]=n[r]);return e},regexEscape=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape$1=e=>isString$2(e)?e.replace(/[&<>"'\/]/g,n=>_entityMap[n]):e;class RegExpCache{constructor(n){this.capacity=n,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(n){const o=this.regExpMap.get(n);if(o!==void 0)return o;const r=new RegExp(n);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(n,r),this.regExpQueue.push(n),r}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(e,n,o)=>{n=n||"",o=o||"";const r=chars.filter(w=>n.indexOf(w)<0&&o.indexOf(w)<0);if(r.length===0)return!0;const u=looksLikeObjectPathRegExpCache.getRegExp(`(${r.map(w=>w==="?"?"\\?":w).join("|")})`);let s=!u.test(e);if(!s){const w=e.indexOf(o);w>0&&!u.test(e.substring(0,w))&&(s=!0)}return s},deepFind=(e,n,o=".")=>{if(!e)return;if(e[n])return Object.prototype.hasOwnProperty.call(e,n)?e[n]:void 0;const r=n.split(o);let u=e;for(let s=0;s<r.length;){if(!u||typeof u!="object")return;let w,m="";for(let v=s;v<r.length;++v)if(v!==s&&(m+=o),m+=r[v],w=u[m],w!==void 0){if(["string","number","boolean"].indexOf(typeof w)>-1&&v<r.length-1)continue;s+=v-s+1;break}u=w}return u},getCleanedCode=e=>e==null?void 0:e.replace("_","-"),consoleLogger={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,n){var o,r;(r=(o=console==null?void 0:console[e])==null?void 0:o.apply)==null||r.call(o,console,n)}};class Logger{constructor(n,o={}){this.init(n,o)}init(n,o={}){this.prefix=o.prefix||"i18next:",this.logger=n||consoleLogger,this.options=o,this.debug=o.debug}log(...n){return this.forward(n,"log","",!0)}warn(...n){return this.forward(n,"warn","",!0)}error(...n){return this.forward(n,"error","")}deprecate(...n){return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(n,o,r,u){return u&&!this.debug?null:(isString$2(n[0])&&(n[0]=`${r}${this.prefix} ${n[0]}`),this.logger[o](n))}create(n){return new Logger(this.logger,{prefix:`${this.prefix}:${n}:`,...this.options})}clone(n){return n=n||this.options,n.prefix=n.prefix||this.prefix,new Logger(this.logger,n)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(n,o){return n.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const u=this.observers[r].get(o)||0;this.observers[r].set(o,u+1)}),this}off(n,o){if(!!this.observers[n]){if(!o){delete this.observers[n];return}this.observers[n].delete(o)}}emit(n,...o){this.observers[n]&&Array.from(this.observers[n].entries()).forEach(([u,s])=>{for(let w=0;w<s;w++)u(...o)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([u,s])=>{for(let w=0;w<s;w++)u.apply(u,[n,...o])})}}class ResourceStore extends EventEmitter{constructor(n,o={ns:["translation"],defaultNS:"translation"}){super(),this.data=n||{},this.options=o,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(n){this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}removeNamespaces(n){const o=this.options.ns.indexOf(n);o>-1&&this.options.ns.splice(o,1)}getResource(n,o,r,u={}){var g,d;const s=u.keySeparator!==void 0?u.keySeparator:this.options.keySeparator,w=u.ignoreJSONStructure!==void 0?u.ignoreJSONStructure:this.options.ignoreJSONStructure;let m;n.indexOf(".")>-1?m=n.split("."):(m=[n,o],r&&(Array.isArray(r)?m.push(...r):isString$2(r)&&s?m.push(...r.split(s)):m.push(r)));const v=getPath$1(this.data,m);return!v&&!o&&!r&&n.indexOf(".")>-1&&(n=m[0],o=m[1],r=m.slice(2).join(".")),v||!w||!isString$2(r)?v:deepFind((d=(g=this.data)==null?void 0:g[n])==null?void 0:d[o],r,s)}addResource(n,o,r,u,s={silent:!1}){const w=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let m=[n,o];r&&(m=m.concat(w?r.split(w):r)),n.indexOf(".")>-1&&(m=n.split("."),u=o,o=m[1]),this.addNamespaces(o),setPath(this.data,m,u),s.silent||this.emit("added",n,o,r,u)}addResources(n,o,r,u={silent:!1}){for(const s in r)(isString$2(r[s])||Array.isArray(r[s]))&&this.addResource(n,o,s,r[s],{silent:!0});u.silent||this.emit("added",n,o,r)}addResourceBundle(n,o,r,u,s,w={silent:!1,skipCopy:!1}){let m=[n,o];n.indexOf(".")>-1&&(m=n.split("."),u=r,r=o,o=m[1]),this.addNamespaces(o);let v=getPath$1(this.data,m)||{};w.skipCopy||(r=JSON.parse(JSON.stringify(r))),u?deepExtend(v,r,s):v={...v,...r},setPath(this.data,m,v),w.silent||this.emit("added",n,o,r)}removeResourceBundle(n,o){this.hasResourceBundle(n,o)&&delete this.data[n][o],this.removeNamespaces(o),this.emit("removed",n,o)}hasResourceBundle(n,o){return this.getResource(n,o)!==void 0}getResourceBundle(n,o){return o||(o=this.options.defaultNS),this.getResource(n,o)}getDataByLanguage(n){return this.data[n]}hasLanguageSomeTranslations(n){const o=this.getDataByLanguage(n);return!!(o&&Object.keys(o)||[]).find(u=>o[u]&&Object.keys(o[u]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,n,o,r,u){return e.forEach(s=>{var w,m;n=(m=(w=this.processors[s])==null?void 0:w.process(n,o,r,u))!=null?m:n}),n}};const checkedLoadedFor={},shouldHandleAsObject=e=>!isString$2(e)&&typeof e!="boolean"&&typeof e!="number";class Translator extends EventEmitter{constructor(n,o={}){super(),copy$2(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],n,this),this.options=o,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(n){n&&(this.language=n)}exists(n,o={interpolation:{}}){const r={...o};if(n==null)return!1;const u=this.resolve(n,r);return(u==null?void 0:u.res)!==void 0}extractFromKey(n,o){let r=o.nsSeparator!==void 0?o.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const u=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let s=o.ns||this.options.defaultNS||[];const w=r&&n.indexOf(r)>-1,m=!this.options.userDefinedKeySeparator&&!o.keySeparator&&!this.options.userDefinedNsSeparator&&!o.nsSeparator&&!looksLikeObjectPath(n,r,u);if(w&&!m){const v=n.match(this.interpolator.nestingRegexp);if(v&&v.length>0)return{key:n,namespaces:isString$2(s)?[s]:s};const g=n.split(r);(r!==u||r===u&&this.options.ns.indexOf(g[0])>-1)&&(s=g.shift()),n=g.join(u)}return{key:n,namespaces:isString$2(s)?[s]:s}}translate(n,o,r){let u=typeof o=="object"?{...o}:o;if(typeof u!="object"&&this.options.overloadTranslationOptionHandler&&(u=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(u={...u}),u||(u={}),n==null)return"";Array.isArray(n)||(n=[String(n)]);const s=u.returnDetails!==void 0?u.returnDetails:this.options.returnDetails,w=u.keySeparator!==void 0?u.keySeparator:this.options.keySeparator,{key:m,namespaces:v}=this.extractFromKey(n[n.length-1],u),g=v[v.length-1];let d=u.nsSeparator!==void 0?u.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const f=u.lng||this.language,y=u.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return y?s?{res:`${g}${d}${m}`,usedKey:m,exactUsedKey:m,usedLng:f,usedNS:g,usedParams:this.getUsedParamsDetails(u)}:`${g}${d}${m}`:s?{res:m,usedKey:m,exactUsedKey:m,usedLng:f,usedNS:g,usedParams:this.getUsedParamsDetails(u)}:m;const x=this.resolve(n,u);let k=x==null?void 0:x.res;const P=(x==null?void 0:x.usedKey)||m,S=(x==null?void 0:x.exactUsedKey)||m,E=["[object Number]","[object Function]","[object RegExp]"],M=u.joinArrays!==void 0?u.joinArrays:this.options.joinArrays,T=!this.i18nFormat||this.i18nFormat.handleAsObject,D=u.count!==void 0&&!isString$2(u.count),N=Translator.hasDefaultValue(u),I=D?this.pluralResolver.getSuffix(f,u.count,u):"",O=u.ordinal&&D?this.pluralResolver.getSuffix(f,u.count,{ordinal:!1}):"",F=D&&!u.ordinal&&u.count===0,q=F&&u[`defaultValue${this.options.pluralSeparator}zero`]||u[`defaultValue${I}`]||u[`defaultValue${O}`]||u.defaultValue;let Y=k;T&&!k&&N&&(Y=q);const _e=shouldHandleAsObject(Y),ne=Object.prototype.toString.apply(Y);if(T&&Y&&_e&&E.indexOf(ne)<0&&!(isString$2(M)&&Array.isArray(Y))){if(!u.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const ve=this.options.returnedObjectHandler?this.options.returnedObjectHandler(P,Y,{...u,ns:v}):`key '${m} (${this.language})' returned an object instead of string.`;return s?(x.res=ve,x.usedParams=this.getUsedParamsDetails(u),x):ve}if(w){const ve=Array.isArray(Y),J=ve?[]:{},fe=ve?S:P;for(const Z in Y)if(Object.prototype.hasOwnProperty.call(Y,Z)){const j=`${fe}${w}${Z}`;N&&!k?J[Z]=this.translate(j,{...u,defaultValue:shouldHandleAsObject(q)?q[Z]:void 0,joinArrays:!1,ns:v}):J[Z]=this.translate(j,{...u,joinArrays:!1,ns:v}),J[Z]===j&&(J[Z]=Y[Z])}k=J}}else if(T&&isString$2(M)&&Array.isArray(k))k=k.join(M),k&&(k=this.extendTranslation(k,n,u,r));else{let ve=!1,J=!1;!this.isValidLookup(k)&&N&&(ve=!0,k=q),this.isValidLookup(k)||(J=!0,k=m);const Z=(u.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&J?void 0:k,j=N&&q!==k&&this.options.updateMissing;if(J||ve||j){if(this.logger.log(j?"updateKey":"missingKey",f,g,m,j?q:k),w){const te=this.resolve(m,{...u,keySeparator:!1});te&&te.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let X=[];const H=this.languageUtils.getFallbackCodes(this.options.fallbackLng,u.lng||this.language);if(this.options.saveMissingTo==="fallback"&&H&&H[0])for(let te=0;te<H.length;te++)X.push(H[te]);else this.options.saveMissingTo==="all"?X=this.languageUtils.toResolveHierarchy(u.lng||this.language):X.push(u.lng||this.language);const U=(te,Q,re)=>{var be;const Pe=N&&re!==k?re:Z;this.options.missingKeyHandler?this.options.missingKeyHandler(te,g,Q,Pe,j,u):(be=this.backendConnector)!=null&&be.saveMissing&&this.backendConnector.saveMissing(te,g,Q,Pe,j,u),this.emit("missingKey",te,g,Q,k)};this.options.saveMissing&&(this.options.saveMissingPlurals&&D?X.forEach(te=>{const Q=this.pluralResolver.getSuffixes(te,u);F&&u[`defaultValue${this.options.pluralSeparator}zero`]&&Q.indexOf(`${this.options.pluralSeparator}zero`)<0&&Q.push(`${this.options.pluralSeparator}zero`),Q.forEach(re=>{U([te],m+re,u[`defaultValue${re}`]||q)})}):U(X,m,q))}k=this.extendTranslation(k,n,u,x,r),J&&k===m&&this.options.appendNamespaceToMissingKey&&(k=`${g}${d}${m}`),(J||ve)&&this.options.parseMissingKeyHandler&&(k=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${g}${d}${m}`:m,ve?k:void 0,u))}return s?(x.res=k,x.usedParams=this.getUsedParamsDetails(u),x):k}extendTranslation(n,o,r,u,s){var v,g;if((v=this.i18nFormat)!=null&&v.parse)n=this.i18nFormat.parse(n,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||u.usedLng,u.usedNS,u.usedKey,{resolved:u});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const d=isString$2(n)&&(((g=r==null?void 0:r.interpolation)==null?void 0:g.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const x=n.match(this.interpolator.nestingRegexp);f=x&&x.length}let y=r.replace&&!isString$2(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(y={...this.options.interpolation.defaultVariables,...y}),n=this.interpolator.interpolate(n,y,r.lng||this.language||u.usedLng,r),d){const x=n.match(this.interpolator.nestingRegexp),k=x&&x.length;f<k&&(r.nest=!1)}!r.lng&&u&&u.res&&(r.lng=this.language||u.usedLng),r.nest!==!1&&(n=this.interpolator.nest(n,(...x)=>(s==null?void 0:s[0])===x[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${x[0]} in key: ${o[0]}`),null):this.translate(...x,o),r)),r.interpolation&&this.interpolator.reset()}const w=r.postProcess||this.options.postProcess,m=isString$2(w)?[w]:w;return n!=null&&(m==null?void 0:m.length)&&r.applyPostProcessor!==!1&&(n=postProcessor.handle(m,n,o,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...u,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),n}resolve(n,o={}){let r,u,s,w,m;return isString$2(n)&&(n=[n]),n.forEach(v=>{if(this.isValidLookup(r))return;const g=this.extractFromKey(v,o),d=g.key;u=d;let f=g.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const y=o.count!==void 0&&!isString$2(o.count),x=y&&!o.ordinal&&o.count===0,k=o.context!==void 0&&(isString$2(o.context)||typeof o.context=="number")&&o.context!=="",P=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);f.forEach(S=>{var E,M;this.isValidLookup(r)||(m=S,!checkedLoadedFor[`${P[0]}-${S}`]&&((E=this.utils)==null?void 0:E.hasLoadedNamespace)&&!((M=this.utils)!=null&&M.hasLoadedNamespace(m))&&(checkedLoadedFor[`${P[0]}-${S}`]=!0,this.logger.warn(`key "${u}" for languages "${P.join(", ")}" won't get resolved as namespace "${m}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),P.forEach(T=>{var I;if(this.isValidLookup(r))return;w=T;const D=[d];if((I=this.i18nFormat)!=null&&I.addLookupKeys)this.i18nFormat.addLookupKeys(D,d,T,S,o);else{let O;y&&(O=this.pluralResolver.getSuffix(T,o.count,o));const F=`${this.options.pluralSeparator}zero`,q=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(y&&(D.push(d+O),o.ordinal&&O.indexOf(q)===0&&D.push(d+O.replace(q,this.options.pluralSeparator)),x&&D.push(d+F)),k){const Y=`${d}${this.options.contextSeparator}${o.context}`;D.push(Y),y&&(D.push(Y+O),o.ordinal&&O.indexOf(q)===0&&D.push(Y+O.replace(q,this.options.pluralSeparator)),x&&D.push(Y+F))}}let N;for(;N=D.pop();)this.isValidLookup(r)||(s=N,r=this.getResource(T,S,N,o))}))})}),{res:r,usedKey:u,exactUsedKey:s,usedLng:w,usedNS:m}}isValidLookup(n){return n!==void 0&&!(!this.options.returnNull&&n===null)&&!(!this.options.returnEmptyString&&n==="")}getResource(n,o,r,u={}){var s;return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(n,o,r,u):this.resourceStore.getResource(n,o,r,u)}getUsedParamsDetails(n={}){const o=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=n.replace&&!isString$2(n.replace);let u=r?n.replace:n;if(r&&typeof n.count<"u"&&(u.count=n.count),this.options.interpolation.defaultVariables&&(u={...this.options.interpolation.defaultVariables,...u}),!r){u={...u};for(const s of o)delete u[s]}return u}static hasDefaultValue(n){const o="defaultValue";for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&o===r.substring(0,o.length)&&n[r]!==void 0)return!0;return!1}}class LanguageUtil{constructor(n){this.options=n,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(n){if(n=getCleanedCode(n),!n||n.indexOf("-")<0)return null;const o=n.split("-");return o.length===2||(o.pop(),o[o.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(o.join("-"))}getLanguagePartFromCode(n){if(n=getCleanedCode(n),!n||n.indexOf("-")<0)return n;const o=n.split("-");return this.formatLanguageCode(o[0])}formatLanguageCode(n){if(isString$2(n)&&n.indexOf("-")>-1){let o;try{o=Intl.getCanonicalLocales(n)[0]}catch{}return o&&this.options.lowerCaseLng&&(o=o.toLowerCase()),o||(this.options.lowerCaseLng?n.toLowerCase():n)}return this.options.cleanCode||this.options.lowerCaseLng?n.toLowerCase():n}isSupportedCode(n){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(n=this.getLanguagePartFromCode(n)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(n)>-1}getBestMatchFromCodes(n){if(!n)return null;let o;return n.forEach(r=>{if(o)return;const u=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(u))&&(o=u)}),!o&&this.options.supportedLngs&&n.forEach(r=>{if(o)return;const u=this.getScriptPartFromCode(r);if(this.isSupportedCode(u))return o=u;const s=this.getLanguagePartFromCode(r);if(this.isSupportedCode(s))return o=s;o=this.options.supportedLngs.find(w=>{if(w===s)return w;if(!(w.indexOf("-")<0&&s.indexOf("-")<0)&&(w.indexOf("-")>0&&s.indexOf("-")<0&&w.substring(0,w.indexOf("-"))===s||w.indexOf(s)===0&&s.length>1))return w})}),o||(o=this.getFallbackCodes(this.options.fallbackLng)[0]),o}getFallbackCodes(n,o){if(!n)return[];if(typeof n=="function"&&(n=n(o)),isString$2(n)&&(n=[n]),Array.isArray(n))return n;if(!o)return n.default||[];let r=n[o];return r||(r=n[this.getScriptPartFromCode(o)]),r||(r=n[this.formatLanguageCode(o)]),r||(r=n[this.getLanguagePartFromCode(o)]),r||(r=n.default),r||[]}toResolveHierarchy(n,o){const r=this.getFallbackCodes((o===!1?[]:o)||this.options.fallbackLng||[],n),u=[],s=w=>{!w||(this.isSupportedCode(w)?u.push(w):this.logger.warn(`rejecting language code not found in supportedLngs: ${w}`))};return isString$2(n)&&(n.indexOf("-")>-1||n.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(n)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(n)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(n))):isString$2(n)&&s(this.formatLanguageCode(n)),r.forEach(w=>{u.indexOf(w)<0&&s(this.formatLanguageCode(w))}),u}}const suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},dummyRule={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PluralResolver{constructor(n,o={}){this.languageUtils=n,this.options=o,this.logger=baseLogger.create("pluralResolver"),this.pluralRulesCache={}}addRule(n,o){this.rules[n]=o}clearCache(){this.pluralRulesCache={}}getRule(n,o={}){const r=getCleanedCode(n==="dev"?"en":n),u=o.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:r,type:u});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let w;try{w=new Intl.PluralRules(r,{type:u})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dummyRule;if(!n.match(/-|_/))return dummyRule;const v=this.languageUtils.getLanguagePartFromCode(n);w=this.getRule(v,o)}return this.pluralRulesCache[s]=w,w}needsPlural(n,o={}){let r=this.getRule(n,o);return r||(r=this.getRule("dev",o)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(n,o,r={}){return this.getSuffixes(n,r).map(u=>`${o}${u}`)}getSuffixes(n,o={}){let r=this.getRule(n,o);return r||(r=this.getRule("dev",o)),r?r.resolvedOptions().pluralCategories.sort((u,s)=>suffixesOrder[u]-suffixesOrder[s]).map(u=>`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${u}`):[]}getSuffix(n,o,r={}){const u=this.getRule(n,r);return u?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${u.select(o)}`:(this.logger.warn(`no plural rule found for: ${n}`),this.getSuffix("dev",o,r))}}const deepFindWithDefaults=(e,n,o,r=".",u=!0)=>{let s=getPathWithDefaults(e,n,o);return!s&&u&&isString$2(o)&&(s=deepFind(e,o,r),s===void 0&&(s=deepFind(n,o,r))),s},regexSafe=e=>e.replace(/\$/g,"$$$$");class Interpolator{constructor(n={}){var o;this.logger=baseLogger.create("interpolator"),this.options=n,this.format=((o=n==null?void 0:n.interpolation)==null?void 0:o.format)||(r=>r),this.init(n)}init(n={}){n.interpolation||(n.interpolation={escapeValue:!0});const{escape:o,escapeValue:r,useRawValueToEscape:u,prefix:s,prefixEscaped:w,suffix:m,suffixEscaped:v,formatSeparator:g,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:y,nestingPrefixEscaped:x,nestingSuffix:k,nestingSuffixEscaped:P,nestingOptionsSeparator:S,maxReplaces:E,alwaysFormat:M}=n.interpolation;this.escape=o!==void 0?o:escape$1,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=u!==void 0?u:!1,this.prefix=s?regexEscape(s):w||"{{",this.suffix=m?regexEscape(m):v||"}}",this.formatSeparator=g||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=y?regexEscape(y):x||regexEscape("$t("),this.nestingSuffix=k?regexEscape(k):P||regexEscape(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=E||1e3,this.alwaysFormat=M!==void 0?M:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const n=(o,r)=>(o==null?void 0:o.source)===r?(o.lastIndex=0,o):new RegExp(r,"g");this.regexp=n(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=n(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=n(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(n,o,r,u){var x;let s,w,m;const v=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},g=k=>{if(k.indexOf(this.formatSeparator)<0){const M=deepFindWithDefaults(o,v,k,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(M,void 0,r,{...u,...o,interpolationkey:k}):M}const P=k.split(this.formatSeparator),S=P.shift().trim(),E=P.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(o,v,S,this.options.keySeparator,this.options.ignoreJSONStructure),E,r,{...u,...o,interpolationkey:S})};this.resetRegExp();const d=(u==null?void 0:u.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((x=u==null?void 0:u.interpolation)==null?void 0:x.skipOnVariables)!==void 0?u.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:k=>regexSafe(k)},{regex:this.regexp,safeValue:k=>this.escapeValue?regexSafe(this.escape(k)):regexSafe(k)}].forEach(k=>{for(m=0;s=k.regex.exec(n);){const P=s[1].trim();if(w=g(P),w===void 0)if(typeof d=="function"){const E=d(n,s,u);w=isString$2(E)?E:""}else if(u&&Object.prototype.hasOwnProperty.call(u,P))w="";else if(f){w=s[0];continue}else this.logger.warn(`missed to pass in variable ${P} for interpolating ${n}`),w="";else!isString$2(w)&&!this.useRawValueToEscape&&(w=makeString(w));const S=k.safeValue(w);if(n=n.replace(s[0],S),f?(k.regex.lastIndex+=w.length,k.regex.lastIndex-=s[0].length):k.regex.lastIndex=0,m++,m>=this.maxReplaces)break}}),n}nest(n,o,r={}){let u,s,w;const m=(v,g)=>{var P;const d=this.nestingOptionsSeparator;if(v.indexOf(d)<0)return v;const f=v.split(new RegExp(`${d}[ ]*{`));let y=`{${f[1]}`;v=f[0],y=this.interpolate(y,w);const x=y.match(/'/g),k=y.match(/"/g);(((P=x==null?void 0:x.length)!=null?P:0)%2===0&&!k||k.length%2!==0)&&(y=y.replace(/'/g,'"'));try{w=JSON.parse(y),g&&(w={...g,...w})}catch(S){return this.logger.warn(`failed parsing options string in nesting for key ${v}`,S),`${v}${d}${y}`}return w.defaultValue&&w.defaultValue.indexOf(this.prefix)>-1&&delete w.defaultValue,v};for(;u=this.nestingRegexp.exec(n);){let v=[];w={...r},w=w.replace&&!isString$2(w.replace)?w.replace:w,w.applyPostProcessor=!1,delete w.defaultValue;let g=!1;if(u[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(u[1])){const d=u[1].split(this.formatSeparator).map(f=>f.trim());u[1]=d.shift(),v=d,g=!0}if(s=o(m.call(this,u[1].trim(),w),w),s&&u[0]===n&&!isString$2(s))return s;isString$2(s)||(s=makeString(s)),s||(this.logger.warn(`missed to resolve ${u[1]} for nesting ${n}`),s=""),g&&(s=v.reduce((d,f)=>this.format(d,f,r.lng,{...r,interpolationkey:u[1].trim()}),s.trim())),n=n.replace(u[0],s),this.regexp.lastIndex=0}return n}}const parseFormatStr=e=>{let n=e.toLowerCase().trim();const o={};if(e.indexOf("(")>-1){const r=e.split("(");n=r[0].toLowerCase().trim();const u=r[1].substring(0,r[1].length-1);n==="currency"&&u.indexOf(":")<0?o.currency||(o.currency=u.trim()):n==="relativetime"&&u.indexOf(":")<0?o.range||(o.range=u.trim()):u.split(";").forEach(w=>{if(w){const[m,...v]=w.split(":"),g=v.join(":").trim().replace(/^'+|'+$/g,""),d=m.trim();o[d]||(o[d]=g),g==="false"&&(o[d]=!1),g==="true"&&(o[d]=!0),isNaN(g)||(o[d]=parseInt(g,10))}})}return{formatName:n,formatOptions:o}},createCachedFormatter=e=>{const n={};return(o,r,u)=>{let s=u;u&&u.interpolationkey&&u.formatParams&&u.formatParams[u.interpolationkey]&&u[u.interpolationkey]&&(s={...s,[u.interpolationkey]:void 0});const w=r+JSON.stringify(s);let m=n[w];return m||(m=e(getCleanedCode(r),u),n[w]=m),m(o)}},createNonCachedFormatter=e=>(n,o,r)=>e(getCleanedCode(o),r)(n);class Formatter{constructor(n={}){this.logger=baseLogger.create("formatter"),this.options=n,this.init(n)}init(n,o={interpolation:{}}){this.formatSeparator=o.interpolation.formatSeparator||",";const r=o.cacheInBuiltFormats?createCachedFormatter:createNonCachedFormatter;this.formats={number:r((u,s)=>{const w=new Intl.NumberFormat(u,{...s});return m=>w.format(m)}),currency:r((u,s)=>{const w=new Intl.NumberFormat(u,{...s,style:"currency"});return m=>w.format(m)}),datetime:r((u,s)=>{const w=new Intl.DateTimeFormat(u,{...s});return m=>w.format(m)}),relativetime:r((u,s)=>{const w=new Intl.RelativeTimeFormat(u,{...s});return m=>w.format(m,s.range||"day")}),list:r((u,s)=>{const w=new Intl.ListFormat(u,{...s});return m=>w.format(m)})}}add(n,o){this.formats[n.toLowerCase().trim()]=o}addCached(n,o){this.formats[n.toLowerCase().trim()]=createCachedFormatter(o)}format(n,o,r,u={}){const s=o.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(m=>m.indexOf(")")>-1)){const m=s.findIndex(v=>v.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,m)].join(this.formatSeparator)}return s.reduce((m,v)=>{var f;const{formatName:g,formatOptions:d}=parseFormatStr(v);if(this.formats[g]){let y=m;try{const x=((f=u==null?void 0:u.formatParams)==null?void 0:f[u.interpolationkey])||{},k=x.locale||x.lng||u.locale||u.lng||r;y=this.formats[g](m,k,{...d,...u,...x})}catch(x){this.logger.warn(x)}return y}else this.logger.warn(`there was no format function for ${g}`);return m},n)}}const removePending=(e,n)=>{e.pending[n]!==void 0&&(delete e.pending[n],e.pendingCount--)};class Connector extends EventEmitter{constructor(n,o,r,u={}){var s,w;super(),this.backend=n,this.store=o,this.services=r,this.languageUtils=r.languageUtils,this.options=u,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=u.maxParallelReads||10,this.readingCalls=0,this.maxRetries=u.maxRetries>=0?u.maxRetries:5,this.retryTimeout=u.retryTimeout>=1?u.retryTimeout:350,this.state={},this.queue=[],(w=(s=this.backend)==null?void 0:s.init)==null||w.call(s,r,u.backend,u)}queueLoad(n,o,r,u){const s={},w={},m={},v={};return n.forEach(g=>{let d=!0;o.forEach(f=>{const y=`${g}|${f}`;!r.reload&&this.store.hasResourceBundle(g,f)?this.state[y]=2:this.state[y]<0||(this.state[y]===1?w[y]===void 0&&(w[y]=!0):(this.state[y]=1,d=!1,w[y]===void 0&&(w[y]=!0),s[y]===void 0&&(s[y]=!0),v[f]===void 0&&(v[f]=!0)))}),d||(m[g]=!0)}),(Object.keys(s).length||Object.keys(w).length)&&this.queue.push({pending:w,pendingCount:Object.keys(w).length,loaded:{},errors:[],callback:u}),{toLoad:Object.keys(s),pending:Object.keys(w),toLoadLanguages:Object.keys(m),toLoadNamespaces:Object.keys(v)}}loaded(n,o,r){const u=n.split("|"),s=u[0],w=u[1];o&&this.emit("failedLoading",s,w,o),!o&&r&&this.store.addResourceBundle(s,w,r,void 0,void 0,{skipCopy:!0}),this.state[n]=o?-1:2,o&&r&&(this.state[n]=0);const m={};this.queue.forEach(v=>{pushPath(v.loaded,[s],w),removePending(v,n),o&&v.errors.push(o),v.pendingCount===0&&!v.done&&(Object.keys(v.loaded).forEach(g=>{m[g]||(m[g]={});const d=v.loaded[g];d.length&&d.forEach(f=>{m[g][f]===void 0&&(m[g][f]=!0)})}),v.done=!0,v.errors.length?v.callback(v.errors):v.callback())}),this.emit("loaded",m),this.queue=this.queue.filter(v=>!v.done)}read(n,o,r,u=0,s=this.retryTimeout,w){if(!n.length)return w(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:n,ns:o,fcName:r,tried:u,wait:s,callback:w});return}this.readingCalls++;const m=(g,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(g&&d&&u<this.maxRetries){setTimeout(()=>{this.read.call(this,n,o,r,u+1,s*2,w)},s);return}w(g,d)},v=this.backend[r].bind(this.backend);if(v.length===2){try{const g=v(n,o);g&&typeof g.then=="function"?g.then(d=>m(null,d)).catch(m):m(null,g)}catch(g){m(g)}return}return v(n,o,m)}prepareLoading(n,o,r={},u){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),u&&u();isString$2(n)&&(n=this.languageUtils.toResolveHierarchy(n)),isString$2(o)&&(o=[o]);const s=this.queueLoad(n,o,r,u);if(!s.toLoad.length)return s.pending.length||u(),null;s.toLoad.forEach(w=>{this.loadOne(w)})}load(n,o,r){this.prepareLoading(n,o,{},r)}reload(n,o,r){this.prepareLoading(n,o,{reload:!0},r)}loadOne(n,o=""){const r=n.split("|"),u=r[0],s=r[1];this.read(u,s,"read",void 0,void 0,(w,m)=>{w&&this.logger.warn(`${o}loading namespace ${s} for language ${u} failed`,w),!w&&m&&this.logger.log(`${o}loaded namespace ${s} for language ${u}`,m),this.loaded(n,w,m)})}saveMissing(n,o,r,u,s,w={},m=()=>{}){var v,g,d,f,y;if(((g=(v=this.services)==null?void 0:v.utils)==null?void 0:g.hasLoadedNamespace)&&!((f=(d=this.services)==null?void 0:d.utils)!=null&&f.hasLoadedNamespace(o))){this.logger.warn(`did not save key "${r}" as the namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((y=this.backend)!=null&&y.create){const x={...w,isUpdate:s},k=this.backend.create.bind(this.backend);if(k.length<6)try{let P;k.length===5?P=k(n,o,r,u,x):P=k(n,o,r,u),P&&typeof P.then=="function"?P.then(S=>m(null,S)).catch(m):m(null,P)}catch(P){m(P)}else k(n,o,r,u,m,x)}!n||!n[0]||this.store.addResource(n[0],o,r,u)}}}const get$1=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let n={};if(typeof e[1]=="object"&&(n=e[1]),isString$2(e[1])&&(n.defaultValue=e[1]),isString$2(e[2])&&(n.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const o=e[3]||e[2];Object.keys(o).forEach(r=>{n[r]=o[r]})}return n},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),transformOptions=e=>{var n,o;return isString$2(e.ns)&&(e.ns=[e.ns]),isString$2(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),isString$2(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),((o=(n=e.supportedLngs)==null?void 0:n.indexOf)==null?void 0:o.call(n,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e},noop$2=()=>{},bindMemberFunctions=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(o=>{typeof e[o]=="function"&&(e[o]=e[o].bind(e))})};class I18n extends EventEmitter{constructor(n={},o){if(super(),this.options=transformOptions(n),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),o&&!this.isInitialized&&!n.isClone){if(!this.options.initAsync)return this.init(n,o),this;setTimeout(()=>{this.init(n,o)},0)}}init(n={},o){this.isInitializing=!0,typeof n=="function"&&(o=n,n={}),n.defaultNS==null&&n.ns&&(isString$2(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const r=get$1();this.options={...r,...this.options,...transformOptions(n)},this.options.interpolation={...r.interpolation,...this.options.interpolation},n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const u=g=>g?typeof g=="function"?new g:g:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(u(this.modules.logger),this.options):baseLogger.init(null,this.options);let g;this.modules.formatter?g=this.modules.formatter:g=Formatter;const d=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const f=this.services;f.logger=baseLogger,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new PluralResolver(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),g&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(f.formatter=u(g),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new Interpolator(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Connector(u(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(y,...x)=>{this.emit(y,...x)}),this.modules.languageDetector&&(f.languageDetector=u(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=u(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",(y,...x)=>{this.emit(y,...x)}),this.modules.external.forEach(y=>{y.init&&y.init(this)})}if(this.format=this.options.interpolation.format,o||(o=noop$2),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const g=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);g.length>0&&g[0]!=="dev"&&(this.options.lng=g[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(g=>{this[g]=(...d)=>this.store[g](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(g=>{this[g]=(...d)=>(this.store[g](...d),this)});const m=defer(),v=()=>{const g=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),m.resolve(f),o(d,f)};if(this.languages&&!this.isInitialized)return g(null,this.t.bind(this));this.changeLanguage(this.options.lng,g)};return this.options.resources||!this.options.initAsync?v():setTimeout(v,0),m}loadResources(n,o=noop$2){var s,w;let r=o;const u=isString$2(n)?n:this.language;if(typeof n=="function"&&(r=n),!this.options.resources||this.options.partialBundledLanguages){if((u==null?void 0:u.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const m=[],v=g=>{if(!g||g==="cimode")return;this.services.languageUtils.toResolveHierarchy(g).forEach(f=>{f!=="cimode"&&m.indexOf(f)<0&&m.push(f)})};u?v(u):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>v(d)),(w=(s=this.options.preload)==null?void 0:s.forEach)==null||w.call(s,g=>v(g)),this.services.backendConnector.load(m,this.options.ns,g=>{!g&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(g)})}else r(null)}reloadResources(n,o,r){const u=defer();return typeof n=="function"&&(r=n,n=void 0),typeof o=="function"&&(r=o,o=void 0),n||(n=this.languages),o||(o=this.options.ns),r||(r=noop$2),this.services.backendConnector.reload(n,o,s=>{u.resolve(),r(s)}),u}use(n){if(!n)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!n.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return n.type==="backend"&&(this.modules.backend=n),(n.type==="logger"||n.log&&n.warn&&n.error)&&(this.modules.logger=n),n.type==="languageDetector"&&(this.modules.languageDetector=n),n.type==="i18nFormat"&&(this.modules.i18nFormat=n),n.type==="postProcessor"&&postProcessor.addPostProcessor(n),n.type==="formatter"&&(this.modules.formatter=n),n.type==="3rdParty"&&this.modules.external.push(n),this}setResolvedLanguage(n){if(!(!n||!this.languages)&&!(["cimode","dev"].indexOf(n)>-1)){for(let o=0;o<this.languages.length;o++){const r=this.languages[o];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(n)<0&&this.store.hasLanguageSomeTranslations(n)&&(this.resolvedLanguage=n,this.languages.unshift(n))}}changeLanguage(n,o){this.isLanguageChangingTo=n;const r=defer();this.emit("languageChanging",n);const u=m=>{this.language=m,this.languages=this.services.languageUtils.toResolveHierarchy(m),this.resolvedLanguage=void 0,this.setResolvedLanguage(m)},s=(m,v)=>{v?this.isLanguageChangingTo===n&&(u(v),this.translator.changeLanguage(v),this.isLanguageChangingTo=void 0,this.emit("languageChanged",v),this.logger.log("languageChanged",v)):this.isLanguageChangingTo=void 0,r.resolve((...g)=>this.t(...g)),o&&o(m,(...g)=>this.t(...g))},w=m=>{var d,f;!n&&!m&&this.services.languageDetector&&(m=[]);const v=isString$2(m)?m:m&&m[0],g=this.store.hasLanguageSomeTranslations(v)?v:this.services.languageUtils.getBestMatchFromCodes(isString$2(m)?[m]:m);g&&(this.language||u(g),this.translator.language||this.translator.changeLanguage(g),(f=(d=this.services.languageDetector)==null?void 0:d.cacheUserLanguage)==null||f.call(d,g)),this.loadResources(g,y=>{s(y,g)})};return!n&&this.services.languageDetector&&!this.services.languageDetector.async?w(this.services.languageDetector.detect()):!n&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(w):this.services.languageDetector.detect(w):w(n),r}getFixedT(n,o,r){const u=(s,w,...m)=>{let v;typeof w!="object"?v=this.options.overloadTranslationOptionHandler([s,w].concat(m)):v={...w},v.lng=v.lng||u.lng,v.lngs=v.lngs||u.lngs,v.ns=v.ns||u.ns,v.keyPrefix!==""&&(v.keyPrefix=v.keyPrefix||r||u.keyPrefix);const g=this.options.keySeparator||".";let d;return v.keyPrefix&&Array.isArray(s)?d=s.map(f=>`${v.keyPrefix}${g}${f}`):d=v.keyPrefix?`${v.keyPrefix}${g}${s}`:s,this.t(d,v)};return isString$2(n)?u.lng=n:u.lngs=n,u.ns=o,u.keyPrefix=r,u}t(...n){var o;return(o=this.translator)==null?void 0:o.translate(...n)}exists(...n){var o;return(o=this.translator)==null?void 0:o.exists(...n)}setDefaultNamespace(n){this.options.defaultNS=n}hasLoadedNamespace(n,o={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=o.lng||this.resolvedLanguage||this.languages[0],u=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const w=(m,v)=>{const g=this.services.backendConnector.state[`${m}|${v}`];return g===-1||g===0||g===2};if(o.precheck){const m=o.precheck(this,w);if(m!==void 0)return m}return!!(this.hasResourceBundle(r,n)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||w(r,n)&&(!u||w(s,n)))}loadNamespaces(n,o){const r=defer();return this.options.ns?(isString$2(n)&&(n=[n]),n.forEach(u=>{this.options.ns.indexOf(u)<0&&this.options.ns.push(u)}),this.loadResources(u=>{r.resolve(),o&&o(u)}),r):(o&&o(),Promise.resolve())}loadLanguages(n,o){const r=defer();isString$2(n)&&(n=[n]);const u=this.options.preload||[],s=n.filter(w=>u.indexOf(w)<0&&this.services.languageUtils.isSupportedCode(w));return s.length?(this.options.preload=u.concat(s),this.loadResources(w=>{r.resolve(),o&&o(w)}),r):(o&&o(),Promise.resolve())}dir(n){var u,s;if(n||(n=this.resolvedLanguage||(((u=this.languages)==null?void 0:u.length)>0?this.languages[0]:this.language)),!n)return"rtl";const o=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((s=this.services)==null?void 0:s.languageUtils)||new LanguageUtil(get$1());return o.indexOf(r.getLanguagePartFromCode(n))>-1||n.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(n={},o){return new I18n(n,o)}cloneInstance(n={},o=noop$2){const r=n.forkResourceStore;r&&delete n.forkResourceStore;const u={...this.options,...n,isClone:!0},s=new I18n(u);if((n.debug!==void 0||n.prefix!==void 0)&&(s.logger=s.logger.clone(n)),["store","services","language"].forEach(m=>{s[m]=this[m]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r){const m=Object.keys(this.store.data).reduce((v,g)=>(v[g]={...this.store.data[g]},v[g]=Object.keys(v[g]).reduce((d,f)=>(d[f]={...v[g][f]},d),v[g]),v),{});s.store=new ResourceStore(m,u),s.services.resourceStore=s.store}return s.translator=new Translator(s.services,u),s.translator.on("*",(m,...v)=>{s.emit(m,...v)}),s.init(u,o),s.translator.options=u,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance$1=I18n.createInstance();instance$1.createInstance=I18n.createInstance;instance$1.createInstance;instance$1.dir;instance$1.init;instance$1.loadResources;instance$1.reloadResources;instance$1.use;instance$1.changeLanguage;instance$1.getFixedT;instance$1.t;instance$1.exists;instance$1.setDefaultNamespace;instance$1.hasLoadedNamespace;instance$1.loadNamespaces;instance$1.loadLanguages;var INJECTION_KEY=Symbol();function install(e,{i18next:n,rerenderOn:o=["languageChanged","loaded","added","removed"],slotStart:r="{",slotEnd:u="}"}){const s=shallowRef(new Date),w=()=>nextTick(()=>{s.value=new Date}),m=()=>s.value;o.forEach(d=>{var f;switch(d){case"added":case"removed":(f=n.store)==null||f.on(d,w);break;default:n.on(d,w);break}}),e.component("i18next",TranslationComponent);const v=()=>n.isInitialized;e.config.globalProperties.$t=withAccessRecording(n.t.bind(n),m,v);const g=new Proxy(n,{get(d,f){return m(),Reflect.get(d,f)}});e.config.globalProperties.$i18next=g,e.provide(INJECTION_KEY,{i18next:g,slotPattern:slotNamePattern(r,u),withAccessRecording(d,f){return withAccessRecording(d,m,f)}})}function useTranslation(e,n){const{i18next:o,withAccessRecording:r}=getContext();let u;return n!=null&&n.lng?u=o.getFixedT(n.lng,e,n==null?void 0:n.keyPrefix):u=o.getFixedT(null,e!=null?e:null,n==null?void 0:n.keyPrefix),{i18next:o,t:r(u,ensureTranslationsLoaded(o,e))}}function ensureTranslationsLoaded(e,n=[]){let o;return()=>{if(o===void 0)if(e.isInitialized){const u=(typeof n=="string"?[n]:n).filter(s=>!e.hasLoadedNamespace(s));u.length?(o=!1,e.loadNamespaces(u).then(()=>o=!0)):o=!0}else return!1;return o}}function withAccessRecording(e,n,o){return new Proxy(e,{apply:function(r,u,s){return n(),o()?Reflect.apply(r,u,s):""}})}function getContext(){const e=inject(INJECTION_KEY);if(!e)throw new Error("i18next-vue: Make sure to register the i18next-vue plugin using app.use(...).");return e}function slotNamePattern(e,n){const o=`${e}\\s*([a-z0-9\\-]+)\\s*${n}`;return new RegExp(o,"gi")}var TranslationComponent=defineComponent({props:{translation:{type:String,required:!0}},setup(e,{slots:n}){const{slotPattern:o}=getContext();return()=>{const r=e.translation,u=[];let s,w=0;for(;(s=o.exec(r))!==null;){u.push(r.substring(w,s.index));const m=n[s[1]];m?u.push(...m()):u.push(s[0]),w=o.lastIndex}return u.push(r.substring(w)),u}}});function _typeof$4(e){return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof$4(e)}function hasXMLHttpRequest(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":_typeof$4(XMLHttpRequest))==="object"}function isPromise(e){return!!e&&typeof e.then=="function"}function makePromise(e){return isPromise(e)?e:Promise.resolve(e)}const scriptRel="modulepreload",assetsURL=function(e,n){return new URL(e,n).href},seen={},__vitePreload=function(n,o,r){if(!o||o.length===0)return n();const u=document.getElementsByTagName("link");return Promise.all(o.map(s=>{if(s=assetsURL(s,r),s in seen)return;seen[s]=!0;const w=s.endsWith(".css"),m=w?'[rel="stylesheet"]':"";if(!!r)for(let d=u.length-1;d>=0;d--){const f=u[d];if(f.href===s&&(!w||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${m}`))return;const g=document.createElement("link");if(g.rel=w?"stylesheet":scriptRel,w||(g.as="script",g.crossOrigin=""),g.href=s,document.head.appendChild(g),w)return new Promise((d,f)=>{g.addEventListener("load",d),g.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>n())};function ownKeys$3(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),o.push.apply(o,r)}return o}function _objectSpread$1(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$3(Object(o),!0).forEach(function(r){_defineProperty$3(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys$3(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function _defineProperty$3(e,n,o){return(n=_toPropertyKey$2(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function _toPropertyKey$2(e){var n=_toPrimitive$2(e,"string");return _typeof$3(n)=="symbol"?n:n+""}function _toPrimitive$2(e,n){if(_typeof$3(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,n||"default");if(_typeof$3(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function _typeof$3(e){return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof$3(e)}var fetchApi=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?fetchApi=global.fetch:typeof window<"u"&&window.fetch&&(fetchApi=window.fetch);var XmlHttpRequestApi;hasXMLHttpRequest()&&(typeof global<"u"&&global.XMLHttpRequest?XmlHttpRequestApi=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(XmlHttpRequestApi=window.XMLHttpRequest));var ActiveXObjectApi;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?ActiveXObjectApi=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(ActiveXObjectApi=window.ActiveXObject));typeof fetchApi!="function"&&(fetchApi=void 0);if(!fetchApi&&!XmlHttpRequestApi&&!ActiveXObjectApi)try{__vitePreload(()=>import("./browser-ponyfill.3be28249.js").then(e=>e.b),[],import.meta.url).then(function(e){fetchApi=e.default}).catch(function(){})}catch{}var addQueryString=function(n,o){if(o&&_typeof$3(o)==="object"){var r="";for(var u in o)r+="&"+encodeURIComponent(u)+"="+encodeURIComponent(o[u]);if(!r)return n;n=n+(n.indexOf("?")!==-1?"&":"?")+r.slice(1)}return n},fetchIt=function(n,o,r,u){var s=function(v){if(!v.ok)return r(v.statusText||"Error",{status:v.status});v.text().then(function(g){r(null,{status:v.status,data:g})}).catch(r)};if(u){var w=u(n,o);if(w instanceof Promise){w.then(s).catch(r);return}}typeof fetch=="function"?fetch(n,o).then(s).catch(r):fetchApi(n,o).then(s).catch(r)},omitFetchOptions=!1,requestWithFetch=function(n,o,r,u){n.queryStringParams&&(o=addQueryString(o,n.queryStringParams));var s=_objectSpread$1({},typeof n.customHeaders=="function"?n.customHeaders():n.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(s["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),r&&(s["Content-Type"]="application/json");var w=typeof n.requestOptions=="function"?n.requestOptions(r):n.requestOptions,m=_objectSpread$1({method:r?"POST":"GET",body:r?n.stringify(r):void 0,headers:s},omitFetchOptions?{}:w),v=typeof n.alternateFetch=="function"&&n.alternateFetch.length>=1?n.alternateFetch:void 0;try{fetchIt(o,m,u,v)}catch(g){if(!w||Object.keys(w).length===0||!g.message||g.message.indexOf("not implemented")<0)return u(g);try{Object.keys(w).forEach(function(d){delete m[d]}),fetchIt(o,m,u,v),omitFetchOptions=!0}catch(d){u(d)}}},requestWithXmlHttpRequest$1=function(n,o,r,u){r&&_typeof$3(r)==="object"&&(r=addQueryString("",r).slice(1)),n.queryStringParams&&(o=addQueryString(o,n.queryStringParams));try{var s=XmlHttpRequestApi?new XmlHttpRequestApi:new ActiveXObjectApi("MSXML2.XMLHTTP.3.0");s.open(r?"POST":"GET",o,1),n.crossDomain||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.withCredentials=!!n.withCredentials,r&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.overrideMimeType&&s.overrideMimeType("application/json");var w=n.customHeaders;if(w=typeof w=="function"?w():w,w)for(var m in w)s.setRequestHeader(m,w[m]);s.onreadystatechange=function(){s.readyState>3&&u(s.status>=400?s.statusText:null,{status:s.status,data:s.responseText})},s.send(r)}catch(v){console&&console.log(v)}},request=function(n,o,r,u){if(typeof r=="function"&&(u=r,r=void 0),u=u||function(){},fetchApi&&o.indexOf("file:")!==0)return requestWithFetch(n,o,r,u);if(hasXMLHttpRequest()||typeof ActiveXObject=="function")return requestWithXmlHttpRequest$1(n,o,r,u);u(new Error("No fetch and no xhr implementation found!"))};function _typeof$2(e){return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof$2(e)}function ownKeys$2(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),o.push.apply(o,r)}return o}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$2(Object(o),!0).forEach(function(r){_defineProperty$2(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys$2(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function _classCallCheck$1(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey$1(r.key),r)}}function _createClass$1(e,n,o){return n&&_defineProperties$1(e.prototype,n),o&&_defineProperties$1(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$2(e,n,o){return(n=_toPropertyKey$1(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function _toPropertyKey$1(e){var n=_toPrimitive$1(e,"string");return _typeof$2(n)=="symbol"?n:n+""}function _toPrimitive$1(e,n){if(_typeof$2(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,n||"default");if(_typeof$2(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var getDefaults=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(o){return JSON.parse(o)},stringify:JSON.stringify,parsePayload:function(o,r,u){return _defineProperty$2({},r,u||"")},parseLoadPayload:function(o,r){},request,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Backend=function(){function e(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classCallCheck$1(this,e),this.services=n,this.options=o,this.allOptions=r,this.type="backend",this.init(n,o,r)}return _createClass$1(e,[{key:"init",value:function(o){var r=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=o,this.options=_objectSpread(_objectSpread(_objectSpread({},getDefaults()),this.options||{}),u),this.allOptions=s,this.services&&this.options.reloadInterval){var w=setInterval(function(){return r.reload()},this.options.reloadInterval);_typeof$2(w)==="object"&&typeof w.unref=="function"&&w.unref()}}},{key:"readMulti",value:function(o,r,u){this._readAny(o,o,r,r,u)}},{key:"read",value:function(o,r,u){this._readAny([o],o,[r],r,u)}},{key:"_readAny",value:function(o,r,u,s,w){var m=this,v=this.options.loadPath;typeof this.options.loadPath=="function"&&(v=this.options.loadPath(o,u)),v=makePromise(v),v.then(function(g){if(!g)return w(null,{});var d=m.services.interpolator.interpolate(g,{lng:o.join("+"),ns:u.join("+")});m.loadUrl(d,w,r,s)})}},{key:"loadUrl",value:function(o,r,u,s){var w=this,m=typeof u=="string"?[u]:u,v=typeof s=="string"?[s]:s,g=this.options.parseLoadPayload(m,v);this.options.request(this.options,o,g,function(d,f){if(f&&(f.status>=500&&f.status<600||!f.status))return r("failed loading "+o+"; status code: "+f.status,!0);if(f&&f.status>=400&&f.status<500)return r("failed loading "+o+"; status code: "+f.status,!1);if(!f&&d&&d.message){var y=d.message.toLowerCase(),x=["failed","fetch","network","load"].find(function(S){return y.indexOf(S)>-1});if(x)return r("failed loading "+o+": "+d.message,!0)}if(d)return r(d,!1);var k,P;try{typeof f.data=="string"?k=w.options.parse(f.data,u,s):k=f.data}catch{P="failed parsing "+o+" to json"}if(P)return r(P,!1);r(null,k)})}},{key:"create",value:function(o,r,u,s,w){var m=this;if(!!this.options.addPath){typeof o=="string"&&(o=[o]);var v=this.options.parsePayload(r,u,s),g=0,d=[],f=[];o.forEach(function(y){var x=m.options.addPath;typeof m.options.addPath=="function"&&(x=m.options.addPath(y,r));var k=m.services.interpolator.interpolate(x,{lng:y,ns:r});m.options.request(m.options,k,v,function(P,S){g+=1,d.push(P),f.push(S),g===o.length&&typeof w=="function"&&w(d,f)})})}}},{key:"reload",value:function(){var o=this,r=this.services,u=r.backendConnector,s=r.languageUtils,w=r.logger,m=u.language;if(!(m&&m.toLowerCase()==="cimode")){var v=[],g=function(f){var y=s.toResolveHierarchy(f);y.forEach(function(x){v.indexOf(x)<0&&v.push(x)})};g(m),this.allOptions.preload&&this.allOptions.preload.forEach(function(d){return g(d)}),v.forEach(function(d){o.allOptions.ns.forEach(function(f){u.read(d,f,"read",null,null,function(y,x){y&&w.warn("loading namespace ".concat(f," for language ").concat(d," failed"),y),!y&&x&&w.log("loaded namespace ".concat(f," for language ").concat(d),x),u.loaded("".concat(d,"|").concat(f),y,x)})})})}}}])}();Backend.type="backend";const requestWithXmlHttpRequest=(e,n,o,r)=>{try{const u=new XMLHttpRequest;u.open("GET",n,1),e.crossDomain||u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.withCredentials=!!e.withCredentials,o&&u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.overrideMimeType&&u.overrideMimeType("application/json");let s=e.customHeaders;if(s=typeof s=="function"?s():s,s)for(const w in s)u.setRequestHeader(w,s[w]);u.onreadystatechange=()=>{u.readyState>3&&r(u.status>=400?u.statusText:null,{status:u.status||200,data:u.responseText})},u.send(o)}catch(u){console.warn(u)}};let language=window.localStorage.getItem("language")||window.localStorage.getItem("currentLanguage")||"en";const i18nextPromise=instance$1.use(Backend).init({load:"currentOnly",returnObjects:!0,lng:language,fallbackLng:"en",ns:["translation"],defaultNS:"translation",backend:{loadPath:"./locales/{{ns}}-{{lng}}.json",request:requestWithXmlHttpRequest}});function i18n(e){return e.use(install,{i18next:instance$1}),e}function plugin$1(e){let n=".",o="__",r="--",u;if(e){let k=e.blockPrefix;k&&(n=k),k=e.elementPrefix,k&&(o=k),k=e.modifierPrefix,k&&(r=k)}const s={install(k){u=k.c;const P=k.context;P.bem={},P.bem.b=null,P.bem.els=null}};function w(k){let P,S;return{before(E){P=E.bem.b,S=E.bem.els,E.bem.els=null},after(E){E.bem.b=P,E.bem.els=S},$({context:E,props:M}){return k=typeof k=="string"?k:k({context:E,props:M}),E.bem.b=k,`${(M==null?void 0:M.bPrefix)||n}${E.bem.b}`}}}function m(k){let P;return{before(S){P=S.bem.els},after(S){S.bem.els=P},$({context:S,props:E}){return k=typeof k=="string"?k:k({context:S,props:E}),S.bem.els=k.split(",").map(M=>M.trim()),S.bem.els.map(M=>`${(E==null?void 0:E.bPrefix)||n}${S.bem.b}${o}${M}`).join(", ")}}}function v(k){return{$({context:P,props:S}){k=typeof k=="string"?k:k({context:P,props:S});const E=k.split(",").map(D=>D.trim());function M(D){return E.map(N=>`&${(S==null?void 0:S.bPrefix)||n}${P.bem.b}${D!==void 0?`${o}${D}`:""}${r}${N}`).join(", ")}const T=P.bem.els;return T!==null?M(T[0]):M()}}}function g(k){return{$({context:P,props:S}){k=typeof k=="string"?k:k({context:P,props:S});const E=P.bem.els;return`&:not(${(S==null?void 0:S.bPrefix)||n}${P.bem.b}${E!==null&&E.length>0?`${o}${E[0]}`:""}${r}${k})`}}}return Object.assign(s,{cB:(...k)=>u(w(k[0]),k[1],k[2]),cE:(...k)=>u(m(k[0]),k[1],k[2]),cM:(...k)=>u(v(k[0]),k[1],k[2]),cNotM:(...k)=>u(g(k[0]),k[1],k[2])}),s}function ampCount(e){let n=0;for(let o=0;o<e.length;++o)e[o]==="&"&&++n;return n}const separatorRegex=/\s*,(?![^(]*\))\s*/g,extraSpaceRegex=/\s+/g;function resolveSelectorWithAmp(e,n){const o=[];return n.split(separatorRegex).forEach(r=>{let u=ampCount(r);if(u){if(u===1){e.forEach(w=>{o.push(r.replace("&",w))});return}}else{e.forEach(w=>{o.push((w&&w+" ")+r)});return}let s=[r];for(;u--;){const w=[];s.forEach(m=>{e.forEach(v=>{w.push(m.replace("&",v))})}),s=w}s.forEach(w=>o.push(w))}),o}function resolveSelector(e,n){const o=[];return n.split(separatorRegex).forEach(r=>{e.forEach(u=>{o.push((u&&u+" ")+r)})}),o}function parseSelectorPath(e){let n=[""];return e.forEach(o=>{o=o&&o.trim(),o&&(o.includes("&")?n=resolveSelectorWithAmp(n,o):n=resolveSelector(n,o))}),n.join(", ").replace(extraSpaceRegex," ")}function removeElement(e){if(!e)return;const n=e.parentElement;n&&n.removeChild(e)}function queryElement(e,n){return(n!=null?n:document.head).querySelector(`style[cssr-id="${e}"]`)}function createElement$1(e){const n=document.createElement("style");return n.setAttribute("cssr-id",e),n}function isMediaOrSupports(e){return e?/^\s*@(s|m)/.test(e):!1}const kebabRegex=/[A-Z]/g;function kebabCase(e){return e.replace(kebabRegex,n=>"-"+n.toLowerCase())}function unwrapProperty(e,n="  "){return typeof e=="object"&&e!==null?` {
`+Object.entries(e).map(o=>n+`  ${kebabCase(o[0])}: ${o[1]};`).join(`
`)+`
`+n+"}":`: ${e};`}function unwrapProperties(e,n,o){return typeof e=="function"?e({context:n.context,props:o}):e}function createStyle(e,n,o,r){if(!n)return"";const u=unwrapProperties(n,o,r);if(!u)return"";if(typeof u=="string")return`${e} {
${u}
}`;const s=Object.keys(u);if(s.length===0)return o.config.keepEmptyBlock?e+` {
}`:"";const w=e?[e+" {"]:[];return s.forEach(m=>{const v=u[m];if(m==="raw"){w.push(`
`+v+`
`);return}m=kebabCase(m),v!=null&&w.push(`  ${m}${unwrapProperty(v)}`)}),e&&w.push("}"),w.join(`
`)}function loopCNodeListWithCallback(e,n,o){!e||e.forEach(r=>{if(Array.isArray(r))loopCNodeListWithCallback(r,n,o);else if(typeof r=="function"){const u=r(n);Array.isArray(u)?loopCNodeListWithCallback(u,n,o):u&&o(u)}else r&&o(r)})}function traverseCNode(e,n,o,r,u){const s=e.$;let w="";if(!s||typeof s=="string")isMediaOrSupports(s)?w=s:n.push(s);else if(typeof s=="function"){const g=s({context:r.context,props:u});isMediaOrSupports(g)?w=g:n.push(g)}else if(s.before&&s.before(r.context),!s.$||typeof s.$=="string")isMediaOrSupports(s.$)?w=s.$:n.push(s.$);else if(s.$){const g=s.$({context:r.context,props:u});isMediaOrSupports(g)?w=g:n.push(g)}const m=parseSelectorPath(n),v=createStyle(m,e.props,r,u);w?o.push(`${w} {`):v.length&&o.push(v),e.children&&loopCNodeListWithCallback(e.children,{context:r.context,props:u},g=>{if(typeof g=="string"){const d=createStyle(m,{raw:g},r,u);o.push(d)}else traverseCNode(g,n,o,r,u)}),n.pop(),w&&o.push("}"),s&&s.after&&s.after(r.context)}function render$1(e,n,o){const r=[];return traverseCNode(e,[],r,n,o),r.join(`

`)}function murmur2(e){for(var n=0,o,r=0,u=e.length;u>=4;++r,u-=4)o=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,n=(o&65535)*1540483477+((o>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(u){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function unmount(e,n,o,r){const{els:u}=n;if(o===void 0)u.forEach(removeElement),n.els=[];else{const s=queryElement(o,r);s&&u.includes(s)&&(removeElement(s),n.els=u.filter(w=>w!==s))}}function addElementToList(e,n){e.push(n)}function mount(e,n,o,r,u,s,w,m,v){let g;if(o===void 0&&(g=n.render(r),o=murmur2(g)),v){v.adapter(o,g!=null?g:n.render(r));return}m===void 0&&(m=document.head);const d=queryElement(o,m);if(d!==null&&!s)return d;const f=d!=null?d:createElement$1(o);if(g===void 0&&(g=n.render(r)),f.textContent=g,d!==null)return d;if(w){const y=m.querySelector(`meta[name="${w}"]`);if(y)return m.insertBefore(f,y),addElementToList(n.els,f),f}return u?m.insertBefore(f,m.querySelector("style, link")):m.appendChild(f),addElementToList(n.els,f),f}function wrappedRender(e){return render$1(this,this.instance,e)}function wrappedMount(e={}){const{id:n,ssr:o,props:r,head:u=!1,force:s=!1,anchorMetaName:w,parent:m}=e;return mount(this.instance,this,n,r,u,s,w,m,o)}function wrappedUnmount(e={}){const{id:n,parent:o}=e;unmount(this.instance,this,n,o)}const createCNode=function(e,n,o,r){return{instance:e,$:n,props:o,children:r,els:[],render:wrappedRender,mount:wrappedMount,unmount:wrappedUnmount}},c$2=function(e,n,o,r){return Array.isArray(n)?createCNode(e,{$:null},null,n):Array.isArray(o)?createCNode(e,n,null,o):Array.isArray(r)?createCNode(e,n,o,r):createCNode(e,n,o,null)};function CssRender(e={}){const n={c:(...o)=>c$2(n,...o),use:(o,...r)=>o.install(n,...r),find:queryElement,context:{},config:e};return n}function exists(e,n){if(e===void 0)return!1;if(n){const{context:{ids:o}}=n;return o.has(e)}return queryElement(e)!==null}const namespace="n",prefix$1=`.${namespace}-`,elementPrefix="__",modifierPrefix="--",cssr=CssRender(),plugin=plugin$1({blockPrefix:prefix$1,elementPrefix,modifierPrefix});cssr.use(plugin);const{c:c$1,find:find$1}=cssr,{cB,cE,cM,cNotM}=plugin;function insideModal(e){return c$1(({props:{bPrefix:n}})=>`${n||prefix$1}modal, ${n||prefix$1}drawer`,[e])}function insidePopover(e){return c$1(({props:{bPrefix:n}})=>`${n||prefix$1}popover`,[e])}function asModal(e){return c$1(({props:{bPrefix:n}})=>`&${n||prefix$1}modal`,e)}const cCB=(...e)=>c$1(">",[cB(...e)]);function createKey(e,n){return e+(n==="default"?"":n.replace(/^[a-z]/,o=>o.toUpperCase()))}let onceCbs=[];const paramsMap=new WeakMap;function flushOnceCallbacks(){onceCbs.forEach(e=>e(...paramsMap.get(e))),onceCbs=[]}function beforeNextFrameOnce(e,...n){paramsMap.set(e,n),!onceCbs.includes(e)&&onceCbs.push(e)===1&&requestAnimationFrame(flushOnceCallbacks)}function happensIn(e,n){let{target:o}=e;for(;o;){if(o.dataset&&o.dataset[n]!==void 0)return!0;o=o.parentElement}return!1}function getPreciseEventTarget(e){return e.composedPath()[0]||null}function depx(e){return typeof e=="string"?e.endsWith("px")?Number(e.slice(0,e.length-2)):Number(e):e}function pxfy(e){if(e!=null)return typeof e=="number"?`${e}px`:e.endsWith("px")?e:`${e}px`}function getMargin(e,n){const o=e.trim().split(/\s+/g),r={top:o[0]};switch(o.length){case 1:r.right=o[0],r.bottom=o[0],r.left=o[0];break;case 2:r.right=o[1],r.left=o[1],r.bottom=o[0];break;case 3:r.right=o[1],r.bottom=o[2],r.left=o[1];break;case 4:r.right=o[1],r.bottom=o[2],r.left=o[3];break;default:throw new Error("[seemly/getMargin]:"+e+" is not a valid value.")}return n===void 0?r:r[n]}const colors={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"};function hsl2hsv(e,n,o){n/=100,o/=100;const r=n*Math.min(o,1-o)+o;return[e,r?(2-2*o/r)*100:0,r*100]}function hsv2hsl(e,n,o){n/=100,o/=100;const r=o-o*n/2,u=Math.min(r,1-r);return[e,u?(o-r)/u*100:0,r*100]}function hsv2rgb(e,n,o){n/=100,o/=100;let r=(u,s=(u+e/60)%6)=>o-o*n*Math.max(Math.min(s,4-s,1),0);return[r(5)*255,r(3)*255,r(1)*255]}function rgb2hsv(e,n,o){e/=255,n/=255,o/=255;let r=Math.max(e,n,o),u=r-Math.min(e,n,o),s=u&&(r==e?(n-o)/u:r==n?2+(o-e)/u:4+(e-n)/u);return[60*(s<0?s+6:s),r&&u/r*100,r*100]}function rgb2hsl(e,n,o){e/=255,n/=255,o/=255;let r=Math.max(e,n,o),u=r-Math.min(e,n,o),s=1-Math.abs(r+r-u-1),w=u&&(r==e?(n-o)/u:r==n?2+(o-e)/u:4+(e-n)/u);return[60*(w<0?w+6:w),s?u/s*100:0,(r+r-u)*50]}function hsl2rgb(e,n,o){n/=100,o/=100;let r=n*Math.min(o,1-o),u=(s,w=(s+e/30)%12)=>o-r*Math.max(Math.min(w-3,9-w,1),-1);return[u(0)*255,u(8)*255,u(4)*255]}const prefix="^\\s*",suffix="\\s*$",percent="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))%\\s*",float="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",hex="([0-9A-Fa-f])",dhex="([0-9A-Fa-f]{2})",hslRegex=new RegExp(`${prefix}hsl\\s*\\(${float},${percent},${percent}\\)${suffix}`),hsvRegex=new RegExp(`${prefix}hsv\\s*\\(${float},${percent},${percent}\\)${suffix}`),hslaRegex=new RegExp(`${prefix}hsla\\s*\\(${float},${percent},${percent},${float}\\)${suffix}`),hsvaRegex=new RegExp(`${prefix}hsva\\s*\\(${float},${percent},${percent},${float}\\)${suffix}`),rgbRegex=new RegExp(`${prefix}rgb\\s*\\(${float},${float},${float}\\)${suffix}`),rgbaRegex=new RegExp(`${prefix}rgba\\s*\\(${float},${float},${float},${float}\\)${suffix}`),sHexRegex=new RegExp(`${prefix}#${hex}${hex}${hex}${suffix}`),hexRegex=new RegExp(`${prefix}#${dhex}${dhex}${dhex}${suffix}`),sHexaRegex=new RegExp(`${prefix}#${hex}${hex}${hex}${hex}${suffix}`),hexaRegex=new RegExp(`${prefix}#${dhex}${dhex}${dhex}${dhex}${suffix}`);function parseHex(e){return parseInt(e,16)}function hsla(e){try{let n;if(n=hslaRegex.exec(e))return[roundDeg(n[1]),roundPercent(n[5]),roundPercent(n[9]),roundAlpha(n[13])];if(n=hslRegex.exec(e))return[roundDeg(n[1]),roundPercent(n[5]),roundPercent(n[9]),1];throw new Error(`[seemly/hsla]: Invalid color value ${e}.`)}catch(n){throw n}}function hsva(e){try{let n;if(n=hsvaRegex.exec(e))return[roundDeg(n[1]),roundPercent(n[5]),roundPercent(n[9]),roundAlpha(n[13])];if(n=hsvRegex.exec(e))return[roundDeg(n[1]),roundPercent(n[5]),roundPercent(n[9]),1];throw new Error(`[seemly/hsva]: Invalid color value ${e}.`)}catch(n){throw n}}function rgba(e){try{let n;if(n=hexRegex.exec(e))return[parseHex(n[1]),parseHex(n[2]),parseHex(n[3]),1];if(n=rgbRegex.exec(e))return[roundChannel(n[1]),roundChannel(n[5]),roundChannel(n[9]),1];if(n=rgbaRegex.exec(e))return[roundChannel(n[1]),roundChannel(n[5]),roundChannel(n[9]),roundAlpha(n[13])];if(n=sHexRegex.exec(e))return[parseHex(n[1]+n[1]),parseHex(n[2]+n[2]),parseHex(n[3]+n[3]),1];if(n=hexaRegex.exec(e))return[parseHex(n[1]),parseHex(n[2]),parseHex(n[3]),roundAlpha(parseHex(n[4])/255)];if(n=sHexaRegex.exec(e))return[parseHex(n[1]+n[1]),parseHex(n[2]+n[2]),parseHex(n[3]+n[3]),roundAlpha(parseHex(n[4]+n[4])/255)];if(e in colors)return rgba(colors[e]);throw new Error(`[seemly/rgba]: Invalid color value ${e}.`)}catch(n){throw n}}function normalizeAlpha$1(e){return e>1?1:e<0?0:e}function stringifyRgb(e,n,o){return`rgb(${roundChannel(e)}, ${roundChannel(n)}, ${roundChannel(o)})`}function stringifyRgba(e,n,o,r){return`rgba(${roundChannel(e)}, ${roundChannel(n)}, ${roundChannel(o)}, ${normalizeAlpha$1(r)})`}function compositeChannel(e,n,o,r,u){return roundChannel((e*n*(1-r)+o*r)/u)}function composite(e,n){Array.isArray(e)||(e=rgba(e)),Array.isArray(n)||(n=rgba(n));const o=e[3],r=n[3],u=roundAlpha(o+r-o*r);return stringifyRgba(compositeChannel(e[0],o,n[0],r,u),compositeChannel(e[1],o,n[1],r,u),compositeChannel(e[2],o,n[2],r,u),u)}function changeColor(e,n){const[o,r,u,s=1]=Array.isArray(e)?e:rgba(e);return n.alpha?stringifyRgba(o,r,u,n.alpha):stringifyRgba(o,r,u,s)}function scaleColor(e,n){const[o,r,u,s=1]=Array.isArray(e)?e:rgba(e),{lightness:w=1,alpha:m=1}=n;return toRgbaString([o*w,r*w,u*w,s*m])}function roundAlpha(e){const n=Math.round(Number(e)*100)/100;return n>1?1:n<0?0:n}function roundDeg(e){const n=Math.round(Number(e));return n>=360||n<0?0:n}function roundChannel(e){const n=Math.round(Number(e));return n>255?255:n<0?0:n}function roundPercent(e){const n=Math.round(Number(e));return n>100?100:n<0?0:n}function toRgbString(e){const[n,o,r]=Array.isArray(e)?e:rgba(e);return stringifyRgb(n,o,r)}function toRgbaString(e){const[n,o,r]=e;return 3 in e?`rgba(${roundChannel(n)}, ${roundChannel(o)}, ${roundChannel(r)}, ${roundAlpha(e[3])})`:`rgba(${roundChannel(n)}, ${roundChannel(o)}, ${roundChannel(r)}, 1)`}function toHsvString(e){return`hsv(${roundDeg(e[0])}, ${roundPercent(e[1])}%, ${roundPercent(e[2])}%)`}function toHsvaString(e){const[n,o,r]=e;return 3 in e?`hsva(${roundDeg(n)}, ${roundPercent(o)}%, ${roundPercent(r)}%, ${roundAlpha(e[3])})`:`hsva(${roundDeg(n)}, ${roundPercent(o)}%, ${roundPercent(r)}%, 1)`}function toHslString(e){return`hsl(${roundDeg(e[0])}, ${roundPercent(e[1])}%, ${roundPercent(e[2])}%)`}function toHslaString(e){const[n,o,r]=e;return 3 in e?`hsla(${roundDeg(n)}, ${roundPercent(o)}%, ${roundPercent(r)}%, ${roundAlpha(e[3])})`:`hsla(${roundDeg(n)}, ${roundPercent(o)}%, ${roundPercent(r)}%, 1)`}function toHexaString(e){if(typeof e=="string"){let r;if(r=hexRegex.exec(e))return`${r[0]}FF`;if(r=hexaRegex.exec(e))return r[0];if(r=sHexRegex.exec(e))return`#${r[1]}${r[1]}${r[2]}${r[2]}${r[3]}${r[3]}FF`;if(r=sHexaRegex.exec(e))return`#${r[1]}${r[1]}${r[2]}${r[2]}${r[3]}${r[3]}${r[4]}${r[4]}`;throw new Error(`[seemly/toHexString]: Invalid hex value ${e}.`)}const n=`#${e.slice(0,3).map(r=>roundChannel(r).toString(16).toUpperCase().padStart(2,"0")).join("")}`,o=e.length===3?"FF":roundChannel(e[3]*255).toString(16).padStart(2,"0").toUpperCase();return n+o}function toHexString(e){if(typeof e=="string"){let n;if(n=hexRegex.exec(e))return n[0];if(n=hexaRegex.exec(e))return n[0].slice(0,7);if(n=sHexRegex.exec(e)||sHexaRegex.exec(e))return`#${n[1]}${n[1]}${n[2]}${n[2]}${n[3]}${n[3]}`;throw new Error(`[seemly/toHexString]: Invalid hex value ${e}.`)}return`#${e.slice(0,3).map(n=>roundChannel(n).toString(16).toUpperCase().padStart(2,"0")).join("")}`}function createId(e=8){return Math.random().toString(16).slice(2,2+e)}function getEventTarget(e){return e.composedPath()[0]}const traps={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function createTrapHandler(e,n,o){if(e==="mousemoveoutside"){const r=u=>{n.contains(getEventTarget(u))||o(u)};return{mousemove:r,touchstart:r}}else if(e==="clickoutside"){let r=!1;const u=w=>{r=!n.contains(getEventTarget(w))},s=w=>{!r||n.contains(getEventTarget(w))||o(w)};return{mousedown:u,mouseup:s,touchstart:u,touchend:s}}return console.error(`[evtd/create-trap-handler]: name \`${e}\` is invalid. This could be a bug of evtd.`),{}}function ensureTrapHandlers(e,n,o){const r=traps[e];let u=r.get(n);u===void 0&&r.set(n,u=new WeakMap);let s=u.get(o);return s===void 0&&u.set(o,s=createTrapHandler(e,n,o)),s}function trapOn(e,n,o,r){if(e==="mousemoveoutside"||e==="clickoutside"){const u=ensureTrapHandlers(e,n,o);return Object.keys(u).forEach(s=>{on$1(s,document,u[s],r)}),!0}return!1}function trapOff(e,n,o,r){if(e==="mousemoveoutside"||e==="clickoutside"){const u=ensureTrapHandlers(e,n,o);return Object.keys(u).forEach(s=>{off$1(s,document,u[s],r)}),!0}return!1}function createDelegate(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const e=new WeakMap,n=new WeakMap;function o(){e.set(this,!0)}function r(){e.set(this,!0),n.set(this,!0)}function u(O,F,q){const Y=O[F];return O[F]=function(){return q.apply(O,arguments),Y.apply(O,arguments)},O}function s(O,F){O[F]=Event.prototype[F]}const w=new WeakMap,m=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function v(){var O;return(O=w.get(this))!==null&&O!==void 0?O:null}function g(O,F){m!==void 0&&Object.defineProperty(O,"currentTarget",{configurable:!0,enumerable:!0,get:F!=null?F:m.get})}const d={bubble:{},capture:{}},f={};function y(){const O=function(F){const{type:q,eventPhase:Y,bubbles:_e}=F,ne=getEventTarget(F);if(Y===2)return;const ve=Y===1?"capture":"bubble";let J=ne;const fe=[];for(;J===null&&(J=window),fe.push(J),J!==window;)J=J.parentNode||null;const Z=d.capture[q],j=d.bubble[q];if(u(F,"stopPropagation",o),u(F,"stopImmediatePropagation",r),g(F,v),ve==="capture"){if(Z===void 0)return;for(let X=fe.length-1;X>=0&&!e.has(F);--X){const H=fe[X],U=Z.get(H);if(U!==void 0){w.set(F,H);for(const te of U){if(n.has(F))break;te(F)}}if(X===0&&!_e&&j!==void 0){const te=j.get(H);if(te!==void 0)for(const Q of te){if(n.has(F))break;Q(F)}}}}else if(ve==="bubble"){if(j===void 0)return;for(let X=0;X<fe.length&&!e.has(F);++X){const H=fe[X],U=j.get(H);if(U!==void 0){w.set(F,H);for(const te of U){if(n.has(F))break;te(F)}}}}s(F,"stopPropagation"),s(F,"stopImmediatePropagation"),g(F)};return O.displayName="evtdUnifiedHandler",O}function x(){const O=function(F){const{type:q,eventPhase:Y}=F;if(Y!==2)return;const _e=f[q];_e!==void 0&&_e.forEach(ne=>ne(F))};return O.displayName="evtdUnifiedWindowEventHandler",O}const k=y(),P=x();function S(O,F){const q=d[O];return q[F]===void 0&&(q[F]=new Map,window.addEventListener(F,k,O==="capture")),q[F]}function E(O){return f[O]===void 0&&(f[O]=new Set,window.addEventListener(O,P)),f[O]}function M(O,F){let q=O.get(F);return q===void 0&&O.set(F,q=new Set),q}function T(O,F,q,Y){const _e=d[F][q];if(_e!==void 0){const ne=_e.get(O);if(ne!==void 0&&ne.has(Y))return!0}return!1}function D(O,F){const q=f[O];return!!(q!==void 0&&q.has(F))}function N(O,F,q,Y){let _e;if(typeof Y=="object"&&Y.once===!0?_e=Z=>{I(O,F,_e,Y),q(Z)}:_e=q,trapOn(O,F,_e,Y))return;const ve=Y===!0||typeof Y=="object"&&Y.capture===!0?"capture":"bubble",J=S(ve,O),fe=M(J,F);if(fe.has(_e)||fe.add(_e),F===window){const Z=E(O);Z.has(_e)||Z.add(_e)}}function I(O,F,q,Y){if(trapOff(O,F,q,Y))return;const ne=Y===!0||typeof Y=="object"&&Y.capture===!0,ve=ne?"capture":"bubble",J=S(ve,O),fe=M(J,F);if(F===window&&!T(F,ne?"bubble":"capture",O,q)&&D(O,q)){const j=f[O];j.delete(q),j.size===0&&(window.removeEventListener(O,P),f[O]=void 0)}fe.has(q)&&fe.delete(q),fe.size===0&&J.delete(F),J.size===0&&(window.removeEventListener(O,k,ve==="capture"),d[ve][O]=void 0)}return{on:N,off:I}}const{on:on$1,off:off$1}=createDelegate();function useFalseUntilTruthy(e){const n=ref(!!e.value);if(n.value)return readonly(n);const o=watch(e,r=>{r&&(n.value=!0,o())});return readonly(n)}function useMemo(e){const n=computed(e),o=ref(n.value);return watch(n,r=>{o.value=r}),typeof e=="function"?o:{__v_isRef:!0,get value(){return o.value},set value(r){e.set(r)}}}function hasInstance(){return getCurrentInstance()!==null}const isBrowser$2=typeof window<"u";let fontsReady,isFontReady;const init$1=()=>{var e,n;fontsReady=isBrowser$2?(n=(e=document)===null||e===void 0?void 0:e.fonts)===null||n===void 0?void 0:n.ready:void 0,isFontReady=!1,fontsReady!==void 0?fontsReady.then(()=>{isFontReady=!0}):isFontReady=!0};init$1();function onFontsReady(e){if(isFontReady)return;let n=!1;onMounted(()=>{isFontReady||fontsReady==null||fontsReady.then(()=>{n||e()})}),onBeforeUnmount(()=>{n=!0})}const mousePositionRef=ref(null);function clickHandler(e){if(e.clientX>0||e.clientY>0)mousePositionRef.value={x:e.clientX,y:e.clientY};else{const{target:n}=e;if(n instanceof Element){const{left:o,top:r,width:u,height:s}=n.getBoundingClientRect();o>0||r>0?mousePositionRef.value={x:o+u/2,y:r+s/2}:mousePositionRef.value={x:0,y:0}}else mousePositionRef.value=null}}let usedCount$1=0,managable$1=!0;function useClickPosition(){if(!isBrowser$2)return readonly(ref(null));usedCount$1===0&&on$1("click",document,clickHandler,!0);const e=()=>{usedCount$1+=1};return managable$1&&(managable$1=hasInstance())?(onBeforeMount(e),onBeforeUnmount(()=>{usedCount$1-=1,usedCount$1===0&&off$1("click",document,clickHandler,!0)})):e(),readonly(mousePositionRef)}const clickedTimeRef=ref(void 0);let usedCount=0;function handleClick(){clickedTimeRef.value=Date.now()}let managable=!0;function useClicked(e){if(!isBrowser$2)return readonly(ref(!1));const n=ref(!1);let o=null;function r(){o!==null&&window.clearTimeout(o)}function u(){r(),n.value=!0,o=window.setTimeout(()=>{n.value=!1},e)}usedCount===0&&on$1("click",window,handleClick,!0);const s=()=>{usedCount+=1,on$1("click",window,u,!0)};return managable&&(managable=hasInstance())?(onBeforeMount(s),onBeforeUnmount(()=>{usedCount-=1,usedCount===0&&off$1("click",window,handleClick,!0),off$1("click",window,u,!0),r()})):s(),readonly(n)}function useMergedState(e,n){return watch(e,o=>{o!==void 0&&(n.value=o)}),computed(()=>e.value===void 0?n.value:e.value)}function isMounted(){const e=ref(!1);return onMounted(()=>{e.value=!0}),readonly(e)}function useCompitable(e,n){return computed(()=>{for(const o of n)if(e[o]!==void 0)return e[o];return e[n[n.length-1]]})}const isIos=(typeof window>"u"?!1:/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;function useIsIos(){return isIos}function createInjectionKey(e){return e}const internalSelectionMenuInjectionKey="n-internal-select-menu",internalSelectionMenuBodyInjectionKey="n-internal-select-menu-body",drawerBodyInjectionKey="n-drawer-body",modalBodyInjectionKey="n-modal-body",modalProviderInjectionKey$1="n-modal-provider",modalInjectionKey="n-modal",popoverBodyInjectionKey="n-popover-body",teleportDisabled="__disabled__";function useAdjustedTo(e){const n=inject(modalBodyInjectionKey,null),o=inject(drawerBodyInjectionKey,null),r=inject(popoverBodyInjectionKey,null),u=inject(internalSelectionMenuBodyInjectionKey,null),s=ref();if(typeof document<"u"){s.value=document.fullscreenElement;const w=()=>{s.value=document.fullscreenElement};onMounted(()=>{on$1("fullscreenchange",document,w)}),onBeforeUnmount(()=>{off$1("fullscreenchange",document,w)})}return useMemo(()=>{var w;const{to:m}=e;return m!==void 0?m===!1?teleportDisabled:m===!0?s.value||"body":m:n!=null&&n.value?(w=n.value.$el)!==null&&w!==void 0?w:n.value:o!=null&&o.value?o.value:r!=null&&r.value?r.value:u!=null&&u.value?u.value:m!=null?m:s.value||"body"})}useAdjustedTo.tdkey=teleportDisabled;useAdjustedTo.propTo={type:[String,Object,Boolean],default:void 0};const isBrowser$1=typeof document<"u"&&typeof window<"u",isComposingRef=ref(!1);function compositionStartHandler(){isComposingRef.value=!0}function compositionEndHandler(){isComposingRef.value=!1}let mountedCount=0;function useIsComposing(){return isBrowser$1&&(onBeforeMount(()=>{mountedCount||(window.addEventListener("compositionstart",compositionStartHandler),window.addEventListener("compositionend",compositionEndHandler)),mountedCount++}),onBeforeUnmount(()=>{mountedCount<=1?(window.removeEventListener("compositionstart",compositionStartHandler),window.removeEventListener("compositionend",compositionEndHandler),mountedCount=0):mountedCount--})),isComposingRef}let lockCount=0,originalMarginRight="",originalOverflow="",originalOverflowX="",originalOverflowY="";const lockHtmlScrollRightCompensationRef=ref("0px");function useLockHtmlScroll(e){if(typeof document>"u")return;const n=document.documentElement;let o,r=!1;const u=()=>{n.style.marginRight=originalMarginRight,n.style.overflow=originalOverflow,n.style.overflowX=originalOverflowX,n.style.overflowY=originalOverflowY,lockHtmlScrollRightCompensationRef.value="0px"};onMounted(()=>{o=watch(e,s=>{if(s){if(!lockCount){const w=window.innerWidth-n.offsetWidth;w>0&&(originalMarginRight=n.style.marginRight,n.style.marginRight=`${w}px`,lockHtmlScrollRightCompensationRef.value=`${w}px`),originalOverflow=n.style.overflow,originalOverflowX=n.style.overflowX,originalOverflowY=n.style.overflowY,n.style.overflow="hidden",n.style.overflowX="hidden",n.style.overflowY="hidden"}r=!0,lockCount++}else lockCount--,lockCount||u(),r=!1},{immediate:!0})}),onBeforeUnmount(()=>{o==null||o(),r&&(lockCount--,lockCount||u(),r=!1)})}function useReactivated(e){const n={isDeactivated:!1};let o=!1;return onActivated(()=>{if(n.isDeactivated=!1,!o){o=!0;return}e()}),onDeactivated(()=>{n.isDeactivated=!0,o||(o=!0)}),n}function getSlot(e,n,o="default"){const r=n[o];if(r===void 0)throw new Error(`[vueuc/${e}]: slot[${o}] is empty.`);return r()}function flatten$2(e,n=!0,o=[]){return e.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&o.push(createTextVNode(String(r)));return}if(Array.isArray(r)){flatten$2(r,n,o);return}if(r.type===Fragment){if(r.children===null)return;Array.isArray(r.children)&&flatten$2(r.children,n,o)}else r.type!==Comment&&o.push(r)}}),o}function getFirstVNode(e,n,o="default"){const r=n[o];if(r===void 0)throw new Error(`[vueuc/${e}]: slot[${o}] is empty.`);const u=flatten$2(r());if(u.length===1)return u[0];throw new Error(`[vueuc/${e}]: slot[${o}] should have exactly one child.`)}let viewMeasurer=null;function ensureViewBoundingRect(){if(viewMeasurer===null&&(viewMeasurer=document.getElementById("v-binder-view-measurer"),viewMeasurer===null)){viewMeasurer=document.createElement("div"),viewMeasurer.id="v-binder-view-measurer";const{style:e}=viewMeasurer;e.position="fixed",e.left="0",e.right="0",e.top="0",e.bottom="0",e.pointerEvents="none",e.visibility="hidden",document.body.appendChild(viewMeasurer)}return viewMeasurer.getBoundingClientRect()}function getPointRect(e,n){const o=ensureViewBoundingRect();return{top:n,left:e,height:0,width:0,right:o.width-e,bottom:o.height-n}}function getRect$1(e){const n=e.getBoundingClientRect(),o=ensureViewBoundingRect();return{left:n.left-o.left,top:n.top-o.top,bottom:o.height+o.top-n.bottom,right:o.width+o.left-n.right,width:n.width,height:n.height}}function getParentNode(e){return e.nodeType===9?null:e.parentNode}function getScrollParent(e){if(e===null)return null;const n=getParentNode(e);if(n===null)return null;if(n.nodeType===9)return document;if(n.nodeType===1){const{overflow:o,overflowX:r,overflowY:u}=getComputedStyle(n);if(/(auto|scroll|overlay)/.test(o+u+r))return n}return getScrollParent(n)}const Binder=defineComponent({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(e){var n;provide("VBinder",(n=getCurrentInstance())===null||n===void 0?void 0:n.proxy);const o=inject("VBinder",null),r=ref(null),u=E=>{r.value=E,o&&e.syncTargetWithParent&&o.setTargetRef(E)};let s=[];const w=()=>{let E=r.value;for(;E=getScrollParent(E),E!==null;)s.push(E);for(const M of s)on$1("scroll",M,f,!0)},m=()=>{for(const E of s)off$1("scroll",E,f,!0);s=[]},v=new Set,g=E=>{v.size===0&&w(),v.has(E)||v.add(E)},d=E=>{v.has(E)&&v.delete(E),v.size===0&&m()},f=()=>{beforeNextFrameOnce(y)},y=()=>{v.forEach(E=>E())},x=new Set,k=E=>{x.size===0&&on$1("resize",window,S),x.has(E)||x.add(E)},P=E=>{x.has(E)&&x.delete(E),x.size===0&&off$1("resize",window,S)},S=()=>{x.forEach(E=>E())};return onBeforeUnmount(()=>{off$1("resize",window,S),m()}),{targetRef:r,setTargetRef:u,addScrollListener:g,removeScrollListener:d,addResizeListener:k,removeResizeListener:P}},render(){return getSlot("binder",this.$slots)}}),VBinder=Binder,VTarget=defineComponent({name:"Target",setup(){const{setTargetRef:e,syncTarget:n}=inject("VBinder");return{syncTarget:n,setTargetDirective:{mounted:e,updated:e}}},render(){const{syncTarget:e,setTargetDirective:n}=this;return e?withDirectives(getFirstVNode("follower",this.$slots),[[n]]):getFirstVNode("follower",this.$slots)}}),ctxKey$1="@@mmoContext",mousemoveoutside={mounted(e,{value:n}){e[ctxKey$1]={handler:void 0},typeof n=="function"&&(e[ctxKey$1].handler=n,on$1("mousemoveoutside",e,n))},updated(e,{value:n}){const o=e[ctxKey$1];typeof n=="function"?o.handler?o.handler!==n&&(off$1("mousemoveoutside",e,o.handler),o.handler=n,on$1("mousemoveoutside",e,n)):(e[ctxKey$1].handler=n,on$1("mousemoveoutside",e,n)):o.handler&&(off$1("mousemoveoutside",e,o.handler),o.handler=void 0)},unmounted(e){const{handler:n}=e[ctxKey$1];n&&off$1("mousemoveoutside",e,n),e[ctxKey$1].handler=void 0}},mousemoveoutside$1=mousemoveoutside,ctxKey="@@coContext",clickoutside={mounted(e,{value:n,modifiers:o}){e[ctxKey]={handler:void 0},typeof n=="function"&&(e[ctxKey].handler=n,on$1("clickoutside",e,n,{capture:o.capture}))},updated(e,{value:n,modifiers:o}){const r=e[ctxKey];typeof n=="function"?r.handler?r.handler!==n&&(off$1("clickoutside",e,r.handler,{capture:o.capture}),r.handler=n,on$1("clickoutside",e,n,{capture:o.capture})):(e[ctxKey].handler=n,on$1("clickoutside",e,n,{capture:o.capture})):r.handler&&(off$1("clickoutside",e,r.handler,{capture:o.capture}),r.handler=void 0)},unmounted(e,{modifiers:n}){const{handler:o}=e[ctxKey];o&&off$1("clickoutside",e,o,{capture:n.capture}),e[ctxKey].handler=void 0}},clickoutside$1=clickoutside;function warn$2(e,n){console.error(`[vdirs/${e}]: ${n}`)}class ZIndexManager{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(n,o){const{elementZIndex:r}=this;if(o!==void 0){n.style.zIndex=`${o}`,r.delete(n);return}const{nextZIndex:u}=this;r.has(n)&&r.get(n)+1===this.nextZIndex||(n.style.zIndex=`${u}`,r.set(n,u),this.nextZIndex=u+1,this.squashState())}unregister(n,o){const{elementZIndex:r}=this;r.has(n)?r.delete(n):o===void 0&&warn$2("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:n}=this;n||(this.nextZIndex=2e3),this.nextZIndex-n>2500&&this.rearrange()}rearrange(){const n=Array.from(this.elementZIndex.entries());n.sort((o,r)=>o[1]-r[1]),this.nextZIndex=2e3,n.forEach(o=>{const r=o[0],u=this.nextZIndex++;`${u}`!==r.style.zIndex&&(r.style.zIndex=`${u}`)})}}const zIndexManager=new ZIndexManager,ctx="@@ziContext",zindexable={mounted(e,n){const{value:o={}}=n,{zIndex:r,enabled:u}=o;e[ctx]={enabled:!!u,initialized:!1},u&&(zIndexManager.ensureZIndex(e,r),e[ctx].initialized=!0)},updated(e,n){const{value:o={}}=n,{zIndex:r,enabled:u}=o,s=e[ctx].enabled;u&&!s&&(zIndexManager.ensureZIndex(e,r),e[ctx].initialized=!0),e[ctx].enabled=!!u},unmounted(e,n){if(!e[ctx].initialized)return;const{value:o={}}=n,{zIndex:r}=o;zIndexManager.unregister(e,r)}},zindexable$1=zindexable,ssrContextKey="@css-render/vue3-ssr";function createStyleString(e,n){return`<style cssr-id="${e}">
${n}
</style>`}function ssrAdapter(e,n,o){const{styles:r,ids:u}=o;u.has(e)||r!==null&&(u.add(e),r.push(createStyleString(e,n)))}const isBrowser=typeof document<"u";function useSsrAdapter(){if(isBrowser)return;const e=inject(ssrContextKey,null);if(e!==null)return{adapter:(n,o)=>ssrAdapter(n,o,e),context:e}}function warn$1(e,n){console.error(`[vueuc/${e}]: ${n}`)}const{c}=CssRender(),cssrAnchorMetaName$1="vueuc-style";function lowBit(e){return e&-e}class FinweckTree{constructor(n,o){this.l=n,this.min=o;const r=new Array(n+1);for(let u=0;u<n+1;++u)r[u]=0;this.ft=r}add(n,o){if(o===0)return;const{l:r,ft:u}=this;for(n+=1;n<=r;)u[n]+=o,n+=lowBit(n)}get(n){return this.sum(n+1)-this.sum(n)}sum(n){if(n===void 0&&(n=this.l),n<=0)return 0;const{ft:o,min:r,l:u}=this;if(n>u)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let s=n*r;for(;n>0;)s+=o[n],n-=lowBit(n);return s}getBound(n){let o=0,r=this.l;for(;r>o;){const u=Math.floor((o+r)/2),s=this.sum(u);if(s>n){r=u;continue}else if(s<n){if(o===u)return this.sum(o+1)<=n?o+1:u;o=u}else return u}return o}}function resolveTo(e){return typeof e=="string"?document.querySelector(e):e()}const LazyTeleport=defineComponent({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(e){return{showTeleport:useFalseUntilTruthy(toRef(e,"show")),mergedTo:computed(()=>{const{to:n}=e;return n!=null?n:"body"})}},render(){return this.showTeleport?this.disabled?getSlot("lazy-teleport",this.$slots):h$1(Teleport,{disabled:this.disabled,to:this.mergedTo},getSlot("lazy-teleport",this.$slots)):null}}),oppositionPositions={top:"bottom",bottom:"top",left:"right",right:"left"},oppositeAligns={start:"end",center:"center",end:"start"},propToCompare={top:"height",bottom:"height",left:"width",right:"width"},transformOrigins={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},overlapTransformOrigin={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},oppositeAlignCssPositionProps={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},keepOffsetDirection={top:!0,bottom:!1,left:!0,right:!1},cssPositionToOppositeAlign={top:"end",bottom:"start",left:"end",right:"start"};function getPlacementAndOffsetOfFollower(e,n,o,r,u,s){if(!u||s)return{placement:e,top:0,left:0};const[w,m]=e.split("-");let v=m!=null?m:"center",g={top:0,left:0};const d=(x,k,P)=>{let S=0,E=0;const M=o[x]-n[k]-n[x];return M>0&&r&&(P?E=keepOffsetDirection[k]?M:-M:S=keepOffsetDirection[k]?M:-M),{left:S,top:E}},f=w==="left"||w==="right";if(v!=="center"){const x=oppositeAlignCssPositionProps[e],k=oppositionPositions[x],P=propToCompare[x];if(o[P]>n[P]){if(n[x]+n[P]<o[P]){const S=(o[P]-n[P])/2;n[x]<S||n[k]<S?n[x]<n[k]?(v=oppositeAligns[m],g=d(P,k,f)):g=d(P,x,f):v="center"}}else o[P]<n[P]&&n[k]<0&&n[x]>n[k]&&(v=oppositeAligns[m])}else{const x=w==="bottom"||w==="top"?"left":"top",k=oppositionPositions[x],P=propToCompare[x],S=(o[P]-n[P])/2;(n[x]<S||n[k]<S)&&(n[x]>n[k]?(v=cssPositionToOppositeAlign[x],g=d(P,x,f)):(v=cssPositionToOppositeAlign[k],g=d(P,k,f)))}let y=w;return n[w]<o[propToCompare[w]]&&n[w]<n[oppositionPositions[w]]&&(y=oppositionPositions[w]),{placement:v!=="center"?`${y}-${v}`:y,left:g.left,top:g.top}}function getProperTransformOrigin(e,n){return n?overlapTransformOrigin[e]:transformOrigins[e]}function getOffset(e,n,o,r,u,s){if(s)switch(e){case"bottom-start":return{top:`${Math.round(o.top-n.top+o.height)}px`,left:`${Math.round(o.left-n.left)}px`,transform:"translateY(-100%)"};case"bottom-end":return{top:`${Math.round(o.top-n.top+o.height)}px`,left:`${Math.round(o.left-n.left+o.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":return{top:`${Math.round(o.top-n.top)}px`,left:`${Math.round(o.left-n.left)}px`,transform:""};case"top-end":return{top:`${Math.round(o.top-n.top)}px`,left:`${Math.round(o.left-n.left+o.width)}px`,transform:"translateX(-100%)"};case"right-start":return{top:`${Math.round(o.top-n.top)}px`,left:`${Math.round(o.left-n.left+o.width)}px`,transform:"translateX(-100%)"};case"right-end":return{top:`${Math.round(o.top-n.top+o.height)}px`,left:`${Math.round(o.left-n.left+o.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"left-start":return{top:`${Math.round(o.top-n.top)}px`,left:`${Math.round(o.left-n.left)}px`,transform:""};case"left-end":return{top:`${Math.round(o.top-n.top+o.height)}px`,left:`${Math.round(o.left-n.left)}px`,transform:"translateY(-100%)"};case"top":return{top:`${Math.round(o.top-n.top)}px`,left:`${Math.round(o.left-n.left+o.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(o.top-n.top+o.height/2)}px`,left:`${Math.round(o.left-n.left+o.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(o.top-n.top+o.height/2)}px`,left:`${Math.round(o.left-n.left)}px`,transform:"translateY(-50%)"};case"bottom":default:return{top:`${Math.round(o.top-n.top+o.height)}px`,left:`${Math.round(o.left-n.left+o.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(e){case"bottom-start":return{top:`${Math.round(o.top-n.top+o.height+r)}px`,left:`${Math.round(o.left-n.left+u)}px`,transform:""};case"bottom-end":return{top:`${Math.round(o.top-n.top+o.height+r)}px`,left:`${Math.round(o.left-n.left+o.width+u)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(o.top-n.top+r)}px`,left:`${Math.round(o.left-n.left+u)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(o.top-n.top+r)}px`,left:`${Math.round(o.left-n.left+o.width+u)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(o.top-n.top+r)}px`,left:`${Math.round(o.left-n.left+o.width+u)}px`,transform:""};case"right-end":return{top:`${Math.round(o.top-n.top+o.height+r)}px`,left:`${Math.round(o.left-n.left+o.width+u)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(o.top-n.top+r)}px`,left:`${Math.round(o.left-n.left+u)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(o.top-n.top+o.height+r)}px`,left:`${Math.round(o.left-n.left+u)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(o.top-n.top+r)}px`,left:`${Math.round(o.left-n.left+o.width/2+u)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(o.top-n.top+o.height/2+r)}px`,left:`${Math.round(o.left-n.left+o.width+u)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(o.top-n.top+o.height/2+r)}px`,left:`${Math.round(o.left-n.left+u)}px`,transform:"translateY(-50%) translateX(-100%)"};case"bottom":default:return{top:`${Math.round(o.top-n.top+o.height+r)}px`,left:`${Math.round(o.left-n.left+o.width/2+u)}px`,transform:"translateX(-50%)"}}}const style$r=c([c(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),c(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[c("> *",{pointerEvents:"all"})])]),VFollower=defineComponent({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(e){const n=inject("VBinder"),o=useMemo(()=>e.enabled!==void 0?e.enabled:e.show),r=ref(null),u=ref(null),s=()=>{const{syncTrigger:y}=e;y.includes("scroll")&&n.addScrollListener(v),y.includes("resize")&&n.addResizeListener(v)},w=()=>{n.removeScrollListener(v),n.removeResizeListener(v)};onMounted(()=>{o.value&&(v(),s())});const m=useSsrAdapter();style$r.mount({id:"vueuc/binder",head:!0,anchorMetaName:cssrAnchorMetaName$1,ssr:m}),onBeforeUnmount(()=>{w()}),onFontsReady(()=>{o.value&&v()});const v=()=>{if(!o.value)return;const y=r.value;if(y===null)return;const x=n.targetRef,{x:k,y:P,overlap:S}=e,E=k!==void 0&&P!==void 0?getPointRect(k,P):getRect$1(x);y.style.setProperty("--v-target-width",`${Math.round(E.width)}px`),y.style.setProperty("--v-target-height",`${Math.round(E.height)}px`);const{width:M,minWidth:T,placement:D,internalShift:N,flip:I}=e;y.setAttribute("v-placement",D),S?y.setAttribute("v-overlap",""):y.removeAttribute("v-overlap");const{style:O}=y;M==="target"?O.width=`${E.width}px`:M!==void 0?O.width=M:O.width="",T==="target"?O.minWidth=`${E.width}px`:T!==void 0?O.minWidth=T:O.minWidth="";const F=getRect$1(y),q=getRect$1(u.value),{left:Y,top:_e,placement:ne}=getPlacementAndOffsetOfFollower(D,E,F,N,I,S),ve=getProperTransformOrigin(ne,S),{left:J,top:fe,transform:Z}=getOffset(ne,q,E,_e,Y,S);y.setAttribute("v-placement",ne),y.style.setProperty("--v-offset-left",`${Math.round(Y)}px`),y.style.setProperty("--v-offset-top",`${Math.round(_e)}px`),y.style.transform=`translateX(${J}) translateY(${fe}) ${Z}`,y.style.setProperty("--v-transform-origin",ve),y.style.transformOrigin=ve};watch(o,y=>{y?(s(),g()):w()});const g=()=>{nextTick().then(v).catch(y=>console.error(y))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(y=>{watch(toRef(e,y),v)}),["teleportDisabled"].forEach(y=>{watch(toRef(e,y),g)}),watch(toRef(e,"syncTrigger"),y=>{y.includes("resize")?n.addResizeListener(v):n.removeResizeListener(v),y.includes("scroll")?n.addScrollListener(v):n.removeScrollListener(v)});const d=isMounted(),f=useMemo(()=>{const{to:y}=e;if(y!==void 0)return y;d.value});return{VBinder:n,mergedEnabled:o,offsetContainerRef:u,followerRef:r,mergedTo:f,syncPosition:v}},render(){return h$1(LazyTeleport,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var e,n;const o=h$1("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[h$1("div",{class:"v-binder-follower-content",ref:"followerRef"},(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e))]);return this.zindexable?withDirectives(o,[[zindexable$1,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):o}})}});var resizeObservers=[],hasActiveObservations=function(){return resizeObservers.some(function(e){return e.activeTargets.length>0})},hasSkippedObservations=function(){return resizeObservers.some(function(e){return e.skippedTargets.length>0})},msg="ResizeObserver loop completed with undelivered notifications.",deliverResizeLoopError=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:msg}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=msg),window.dispatchEvent(e)},ResizeObserverBoxOptions;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(ResizeObserverBoxOptions||(ResizeObserverBoxOptions={}));var freeze=function(e){return Object.freeze(e)},ResizeObserverSize=function(){function e(n,o){this.inlineSize=n,this.blockSize=o,freeze(this)}return e}(),DOMRectReadOnly=function(){function e(n,o,r,u){return this.x=n,this.y=o,this.width=r,this.height=u,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,freeze(this)}return e.prototype.toJSON=function(){var n=this,o=n.x,r=n.y,u=n.top,s=n.right,w=n.bottom,m=n.left,v=n.width,g=n.height;return{x:o,y:r,top:u,right:s,bottom:w,left:m,width:v,height:g}},e.fromRect=function(n){return new e(n.x,n.y,n.width,n.height)},e}(),isSVG=function(e){return e instanceof SVGElement&&"getBBox"in e},isHidden=function(e){if(isSVG(e)){var n=e.getBBox(),o=n.width,r=n.height;return!o&&!r}var u=e,s=u.offsetWidth,w=u.offsetHeight;return!(s||w||e.getClientRects().length)},isElement=function(e){var n;if(e instanceof Element)return!0;var o=(n=e==null?void 0:e.ownerDocument)===null||n===void 0?void 0:n.defaultView;return!!(o&&e instanceof o.Element)},isReplacedElement=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},global$1=typeof window<"u"?window:{},cache=new WeakMap,scrollRegexp=/auto|scroll/,verticalRegexp=/^tb|vertical/,IE=/msie|trident/i.test(global$1.navigator&&global$1.navigator.userAgent),parseDimension=function(e){return parseFloat(e||"0")},size=function(e,n,o){return e===void 0&&(e=0),n===void 0&&(n=0),o===void 0&&(o=!1),new ResizeObserverSize((o?n:e)||0,(o?e:n)||0)},zeroBoxes=freeze({devicePixelContentBoxSize:size(),borderBoxSize:size(),contentBoxSize:size(),contentRect:new DOMRectReadOnly(0,0,0,0)}),calculateBoxSizes=function(e,n){if(n===void 0&&(n=!1),cache.has(e)&&!n)return cache.get(e);if(isHidden(e))return cache.set(e,zeroBoxes),zeroBoxes;var o=getComputedStyle(e),r=isSVG(e)&&e.ownerSVGElement&&e.getBBox(),u=!IE&&o.boxSizing==="border-box",s=verticalRegexp.test(o.writingMode||""),w=!r&&scrollRegexp.test(o.overflowY||""),m=!r&&scrollRegexp.test(o.overflowX||""),v=r?0:parseDimension(o.paddingTop),g=r?0:parseDimension(o.paddingRight),d=r?0:parseDimension(o.paddingBottom),f=r?0:parseDimension(o.paddingLeft),y=r?0:parseDimension(o.borderTopWidth),x=r?0:parseDimension(o.borderRightWidth),k=r?0:parseDimension(o.borderBottomWidth),P=r?0:parseDimension(o.borderLeftWidth),S=f+g,E=v+d,M=P+x,T=y+k,D=m?e.offsetHeight-T-e.clientHeight:0,N=w?e.offsetWidth-M-e.clientWidth:0,I=u?S+M:0,O=u?E+T:0,F=r?r.width:parseDimension(o.width)-I-N,q=r?r.height:parseDimension(o.height)-O-D,Y=F+S+N+M,_e=q+E+D+T,ne=freeze({devicePixelContentBoxSize:size(Math.round(F*devicePixelRatio),Math.round(q*devicePixelRatio),s),borderBoxSize:size(Y,_e,s),contentBoxSize:size(F,q,s),contentRect:new DOMRectReadOnly(f,v,F,q)});return cache.set(e,ne),ne},calculateBoxSize=function(e,n,o){var r=calculateBoxSizes(e,o),u=r.borderBoxSize,s=r.contentBoxSize,w=r.devicePixelContentBoxSize;switch(n){case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:return w;case ResizeObserverBoxOptions.BORDER_BOX:return u;default:return s}},ResizeObserverEntry=function(){function e(n){var o=calculateBoxSizes(n);this.target=n,this.contentRect=o.contentRect,this.borderBoxSize=freeze([o.borderBoxSize]),this.contentBoxSize=freeze([o.contentBoxSize]),this.devicePixelContentBoxSize=freeze([o.devicePixelContentBoxSize])}return e}(),calculateDepthForNode=function(e){if(isHidden(e))return 1/0;for(var n=0,o=e.parentNode;o;)n+=1,o=o.parentNode;return n},broadcastActiveObservations=function(){var e=1/0,n=[];resizeObservers.forEach(function(w){if(w.activeTargets.length!==0){var m=[];w.activeTargets.forEach(function(g){var d=new ResizeObserverEntry(g.target),f=calculateDepthForNode(g.target);m.push(d),g.lastReportedSize=calculateBoxSize(g.target,g.observedBox),f<e&&(e=f)}),n.push(function(){w.callback.call(w.observer,m,w.observer)}),w.activeTargets.splice(0,w.activeTargets.length)}});for(var o=0,r=n;o<r.length;o++){var u=r[o];u()}return e},gatherActiveObservationsAtDepth=function(e){resizeObservers.forEach(function(o){o.activeTargets.splice(0,o.activeTargets.length),o.skippedTargets.splice(0,o.skippedTargets.length),o.observationTargets.forEach(function(u){u.isActive()&&(calculateDepthForNode(u.target)>e?o.activeTargets.push(u):o.skippedTargets.push(u))})})},process$1=function(){var e=0;for(gatherActiveObservationsAtDepth(e);hasActiveObservations();)e=broadcastActiveObservations(),gatherActiveObservationsAtDepth(e);return hasSkippedObservations()&&deliverResizeLoopError(),e>0},trigger,callbacks=[],notify=function(){return callbacks.splice(0).forEach(function(e){return e()})},queueMicroTask=function(e){if(!trigger){var n=0,o=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return notify()}).observe(o,r),trigger=function(){o.textContent="".concat(n?n--:n++)}}callbacks.push(e),trigger()},queueResizeObserver=function(e){queueMicroTask(function(){requestAnimationFrame(e)})},watching=0,isWatching=function(){return!!watching},CATCH_PERIOD=250,observerConfig={attributes:!0,characterData:!0,childList:!0,subtree:!0},events=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],time=function(e){return e===void 0&&(e=0),Date.now()+e},scheduled=!1,Scheduler=function(){function e(){var n=this;this.stopped=!0,this.listener=function(){return n.schedule()}}return e.prototype.run=function(n){var o=this;if(n===void 0&&(n=CATCH_PERIOD),!scheduled){scheduled=!0;var r=time(n);queueResizeObserver(function(){var u=!1;try{u=process$1()}finally{if(scheduled=!1,n=r-time(),!isWatching())return;u?o.run(1e3):n>0?o.run(n):o.start()}})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var n=this,o=function(){return n.observer&&n.observer.observe(document.body,observerConfig)};document.body?o():global$1.addEventListener("DOMContentLoaded",o)},e.prototype.start=function(){var n=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),events.forEach(function(o){return global$1.addEventListener(o,n.listener,!0)}))},e.prototype.stop=function(){var n=this;this.stopped||(this.observer&&this.observer.disconnect(),events.forEach(function(o){return global$1.removeEventListener(o,n.listener,!0)}),this.stopped=!0)},e}(),scheduler=new Scheduler,updateCount=function(e){!watching&&e>0&&scheduler.start(),watching+=e,!watching&&scheduler.stop()},skipNotifyOnElement=function(e){return!isSVG(e)&&!isReplacedElement(e)&&getComputedStyle(e).display==="inline"},ResizeObservation=function(){function e(n,o){this.target=n,this.observedBox=o||ResizeObserverBoxOptions.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var n=calculateBoxSize(this.target,this.observedBox,!0);return skipNotifyOnElement(this.target)&&(this.lastReportedSize=n),this.lastReportedSize.inlineSize!==n.inlineSize||this.lastReportedSize.blockSize!==n.blockSize},e}(),ResizeObserverDetail=function(){function e(n,o){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=n,this.callback=o}return e}(),observerMap=new WeakMap,getObservationIndex=function(e,n){for(var o=0;o<e.length;o+=1)if(e[o].target===n)return o;return-1},ResizeObserverController=function(){function e(){}return e.connect=function(n,o){var r=new ResizeObserverDetail(n,o);observerMap.set(n,r)},e.observe=function(n,o,r){var u=observerMap.get(n),s=u.observationTargets.length===0;getObservationIndex(u.observationTargets,o)<0&&(s&&resizeObservers.push(u),u.observationTargets.push(new ResizeObservation(o,r&&r.box)),updateCount(1),scheduler.schedule())},e.unobserve=function(n,o){var r=observerMap.get(n),u=getObservationIndex(r.observationTargets,o),s=r.observationTargets.length===1;u>=0&&(s&&resizeObservers.splice(resizeObservers.indexOf(r),1),r.observationTargets.splice(u,1),updateCount(-1))},e.disconnect=function(n){var o=this,r=observerMap.get(n);r.observationTargets.slice().forEach(function(u){return o.unobserve(n,u.target)}),r.activeTargets.splice(0,r.activeTargets.length)},e}(),ResizeObserver$1=function(){function e(n){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof n!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ResizeObserverController.connect(this,n)}return e.prototype.observe=function(n,o){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(n))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController.observe(this,n,o)},e.prototype.unobserve=function(n){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(n))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController.unobserve(this,n)},e.prototype.disconnect=function(){ResizeObserverController.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();class ResizeObserverDelegate{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new(typeof window<"u"&&window.ResizeObserver||ResizeObserver$1)(this.handleResize),this.elHandlersMap=new Map}handleResize(n){for(const o of n){const r=this.elHandlersMap.get(o.target);r!==void 0&&r(o)}}registerHandler(n,o){this.elHandlersMap.set(n,o),this.observer.observe(n)}unregisterHandler(n){!this.elHandlersMap.has(n)||(this.elHandlersMap.delete(n),this.observer.unobserve(n))}}const resizeObserverManager=new ResizeObserverDelegate,VResizeObserver=defineComponent({name:"ResizeObserver",props:{onResize:Function},setup(e){let n=!1;const o=getCurrentInstance().proxy;function r(u){const{onResize:s}=e;s!==void 0&&s(u)}onMounted(()=>{const u=o.$el;if(u===void 0){warn$1("resize-observer","$el does not exist.");return}if(u.nextElementSibling!==u.nextSibling&&u.nodeType===3&&u.nodeValue!==""){warn$1("resize-observer","$el can not be observed (it may be a text node).");return}u.nextElementSibling!==null&&(resizeObserverManager.registerHandler(u.nextElementSibling,r),n=!0)}),onBeforeUnmount(()=>{n&&resizeObserverManager.unregisterHandler(o.$el.nextElementSibling)})},render(){return renderSlot(this.$slots,"default")}});let maybeTouch;function ensureMaybeTouch(){return typeof document>"u"?!1:(maybeTouch===void 0&&("matchMedia"in window?maybeTouch=window.matchMedia("(pointer:coarse)").matches:maybeTouch=!1),maybeTouch)}let wheelScale;function ensureWheelScale(){return typeof document>"u"?1:(wheelScale===void 0&&(wheelScale="chrome"in window?window.devicePixelRatio:1),wheelScale)}const xScrollInjextionKey="VVirtualListXScroll";function setupXScroll({columnsRef:e,renderColRef:n,renderItemWithColsRef:o}){const r=ref(0),u=ref(0),s=computed(()=>{const g=e.value;if(g.length===0)return null;const d=new FinweckTree(g.length,0);return g.forEach((f,y)=>{d.add(y,f.width)}),d}),w=useMemo(()=>{const g=s.value;return g!==null?Math.max(g.getBound(u.value)-1,0):0}),m=g=>{const d=s.value;return d!==null?d.sum(g):0},v=useMemo(()=>{const g=s.value;return g!==null?Math.min(g.getBound(u.value+r.value)+1,e.value.length-1):0});return provide(xScrollInjextionKey,{startIndexRef:w,endIndexRef:v,columnsRef:e,renderColRef:n,renderItemWithColsRef:o,getLeft:m}),{listWidthRef:r,scrollLeftRef:u}}const VirtualListRow=defineComponent({name:"VirtualListRow",props:{index:{type:Number,required:!0},item:{type:Object,required:!0}},setup(){const{startIndexRef:e,endIndexRef:n,columnsRef:o,getLeft:r,renderColRef:u,renderItemWithColsRef:s}=inject(xScrollInjextionKey);return{startIndex:e,endIndex:n,columns:o,renderCol:u,renderItemWithCols:s,getLeft:r}},render(){const{startIndex:e,endIndex:n,columns:o,renderCol:r,renderItemWithCols:u,getLeft:s,item:w}=this;if(u!=null)return u({itemIndex:this.index,startColIndex:e,endColIndex:n,allColumns:o,item:w,getLeft:s});if(r!=null){const m=[];for(let v=e;v<=n;++v){const g=o[v];m.push(r({column:g,left:s(v),item:w}))}return m}return null}}),styles=c(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[c("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[c("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),VVirtualList=defineComponent({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},renderCol:Function,renderItemWithCols:Function,items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(e){const n=useSsrAdapter();styles.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:cssrAnchorMetaName$1,ssr:n}),onMounted(()=>{const{defaultScrollIndex:ve,defaultScrollKey:J}=e;ve!=null?S({index:ve}):J!=null&&S({key:J})});let o=!1,r=!1;onActivated(()=>{if(o=!1,!r){r=!0;return}S({top:x.value,left:w.value})}),onDeactivated(()=>{o=!0,r||(r=!0)});const u=useMemo(()=>{if(e.renderCol==null&&e.renderItemWithCols==null||e.columns.length===0)return;let ve=0;return e.columns.forEach(J=>{ve+=J.width}),ve}),s=computed(()=>{const ve=new Map,{keyField:J}=e;return e.items.forEach((fe,Z)=>{ve.set(fe[J],Z)}),ve}),{scrollLeftRef:w,listWidthRef:m}=setupXScroll({columnsRef:toRef(e,"columns"),renderColRef:toRef(e,"renderCol"),renderItemWithColsRef:toRef(e,"renderItemWithCols")}),v=ref(null),g=ref(void 0),d=new Map,f=computed(()=>{const{items:ve,itemSize:J,keyField:fe}=e,Z=new FinweckTree(ve.length,J);return ve.forEach((j,X)=>{const H=j[fe],U=d.get(H);U!==void 0&&Z.add(X,U)}),Z}),y=ref(0),x=ref(0),k=useMemo(()=>Math.max(f.value.getBound(x.value-depx(e.paddingTop))-1,0)),P=computed(()=>{const{value:ve}=g;if(ve===void 0)return[];const{items:J,itemSize:fe}=e,Z=k.value,j=Math.min(Z+Math.ceil(ve/fe+1),J.length-1),X=[];for(let H=Z;H<=j;++H)X.push(J[H]);return X}),S=(ve,J)=>{if(typeof ve=="number"){D(ve,J,"auto");return}const{left:fe,top:Z,index:j,key:X,position:H,behavior:U,debounce:te=!0}=ve;if(fe!==void 0||Z!==void 0)D(fe,Z,U);else if(j!==void 0)T(j,U,te);else if(X!==void 0){const Q=s.value.get(X);Q!==void 0&&T(Q,U,te)}else H==="bottom"?D(0,Number.MAX_SAFE_INTEGER,U):H==="top"&&D(0,0,U)};let E,M=null;function T(ve,J,fe){const{value:Z}=f,j=Z.sum(ve)+depx(e.paddingTop);if(!fe)v.value.scrollTo({left:0,top:j,behavior:J});else{E=ve,M!==null&&window.clearTimeout(M),M=window.setTimeout(()=>{E=void 0,M=null},16);const{scrollTop:X,offsetHeight:H}=v.value;if(j>X){const U=Z.get(ve);j+U<=X+H||v.value.scrollTo({left:0,top:j+U-H,behavior:J})}else v.value.scrollTo({left:0,top:j,behavior:J})}}function D(ve,J,fe){v.value.scrollTo({left:ve,top:J,behavior:fe})}function N(ve,J){var fe,Z,j;if(o||e.ignoreItemResize||ne(J.target))return;const{value:X}=f,H=s.value.get(ve),U=X.get(H),te=(j=(Z=(fe=J.borderBoxSize)===null||fe===void 0?void 0:fe[0])===null||Z===void 0?void 0:Z.blockSize)!==null&&j!==void 0?j:J.contentRect.height;if(te===U)return;te-e.itemSize===0?d.delete(ve):d.set(ve,te-e.itemSize);const re=te-U;if(re===0)return;X.add(H,re);const Pe=v.value;if(Pe!=null){if(E===void 0){const be=X.sum(H);Pe.scrollTop>be&&Pe.scrollBy(0,re)}else if(H<E)Pe.scrollBy(0,re);else if(H===E){const be=X.sum(H);te+be>Pe.scrollTop+Pe.offsetHeight&&Pe.scrollBy(0,re)}_e()}y.value++}const I=!ensureMaybeTouch();let O=!1;function F(ve){var J;(J=e.onScroll)===null||J===void 0||J.call(e,ve),(!I||!O)&&_e()}function q(ve){var J;if((J=e.onWheel)===null||J===void 0||J.call(e,ve),I){const fe=v.value;if(fe!=null){if(ve.deltaX===0&&(fe.scrollTop===0&&ve.deltaY<=0||fe.scrollTop+fe.offsetHeight>=fe.scrollHeight&&ve.deltaY>=0))return;ve.preventDefault(),fe.scrollTop+=ve.deltaY/ensureWheelScale(),fe.scrollLeft+=ve.deltaX/ensureWheelScale(),_e(),O=!0,beforeNextFrameOnce(()=>{O=!1})}}}function Y(ve){if(o||ne(ve.target))return;if(e.renderCol==null&&e.renderItemWithCols==null){if(ve.contentRect.height===g.value)return}else if(ve.contentRect.height===g.value&&ve.contentRect.width===m.value)return;g.value=ve.contentRect.height,m.value=ve.contentRect.width;const{onResize:J}=e;J!==void 0&&J(ve)}function _e(){const{value:ve}=v;ve!=null&&(x.value=ve.scrollTop,w.value=ve.scrollLeft)}function ne(ve){let J=ve;for(;J!==null;){if(J.style.display==="none")return!0;J=J.parentElement}return!1}return{listHeight:g,listStyle:{overflow:"auto"},keyToIndex:s,itemsStyle:computed(()=>{const{itemResizable:ve}=e,J=pxfy(f.value.sum());return y.value,[e.itemsStyle,{boxSizing:"content-box",width:pxfy(u.value),height:ve?"":J,minHeight:ve?J:"",paddingTop:pxfy(e.paddingTop),paddingBottom:pxfy(e.paddingBottom)}]}),visibleItemsStyle:computed(()=>(y.value,{transform:`translateY(${pxfy(f.value.sum(k.value))})`})),viewportItems:P,listElRef:v,itemsElRef:ref(null),scrollTo:S,handleListResize:Y,handleListScroll:F,handleListWheel:q,handleItemResize:N}},render(){const{itemResizable:e,keyField:n,keyToIndex:o,visibleItemsTag:r}=this;return h$1(VResizeObserver,{onResize:this.handleListResize},{default:()=>{var u,s;return h$1("div",mergeProps(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[this.items.length!==0?h$1("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[h$1(r,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>{const{renderCol:w,renderItemWithCols:m}=this;return this.viewportItems.map(v=>{const g=v[n],d=o.get(g),f=w!=null?h$1(VirtualListRow,{index:d,item:v}):void 0,y=m!=null?h$1(VirtualListRow,{index:d,item:v}):void 0,x=this.$slots.default({item:v,renderedCols:f,renderedItemWithCols:y,index:d})[0];return e?h$1(VResizeObserver,{key:g,onResize:k=>this.handleItemResize(g,k)},{default:()=>x}):(x.key=g,x)})}})]):(s=(u=this.$slots).empty)===null||s===void 0?void 0:s.call(u)])}})}}),hiddenAttr="v-hidden",style$q=c("[v-hidden]",{display:"none!important"}),VOverflow=defineComponent({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(e,{slots:n}){const o=ref(null),r=ref(null);function u(w){const{value:m}=o,{getCounter:v,getTail:g}=e;let d;if(v!==void 0?d=v():d=r.value,!m||!d)return;d.hasAttribute(hiddenAttr)&&d.removeAttribute(hiddenAttr);const{children:f}=m;if(w.showAllItemsBeforeCalculate)for(const T of f)T.hasAttribute(hiddenAttr)&&T.removeAttribute(hiddenAttr);const y=m.offsetWidth,x=[],k=n.tail?g==null?void 0:g():null;let P=k?k.offsetWidth:0,S=!1;const E=m.children.length-(n.tail?1:0);for(let T=0;T<E-1;++T){if(T<0)continue;const D=f[T];if(S){D.hasAttribute(hiddenAttr)||D.setAttribute(hiddenAttr,"");continue}else D.hasAttribute(hiddenAttr)&&D.removeAttribute(hiddenAttr);const N=D.offsetWidth;if(P+=N,x[T]=N,P>y){const{updateCounter:I}=e;for(let O=T;O>=0;--O){const F=E-1-O;I!==void 0?I(F):d.textContent=`${F}`;const q=d.offsetWidth;if(P-=x[O],P+q<=y||O===0){S=!0,T=O-1,k&&(T===-1?(k.style.maxWidth=`${y-q}px`,k.style.boxSizing="border-box"):k.style.maxWidth="");const{onUpdateCount:Y}=e;Y&&Y(F);break}}}}const{onUpdateOverflow:M}=e;S?M!==void 0&&M(!0):(M!==void 0&&M(!1),d.setAttribute(hiddenAttr,""))}const s=useSsrAdapter();return style$q.mount({id:"vueuc/overflow",head:!0,anchorMetaName:cssrAnchorMetaName$1,ssr:s}),onMounted(()=>u({showAllItemsBeforeCalculate:!1})),{selfRef:o,counterRef:r,sync:u}},render(){const{$slots:e}=this;return nextTick(()=>this.sync({showAllItemsBeforeCalculate:!1})),h$1("div",{class:"v-overflow",ref:"selfRef"},[renderSlot(e,"default"),e.counter?e.counter():h$1("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function isHTMLElement(e){return e instanceof HTMLElement}function focusFirstDescendant(e){for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];if(isHTMLElement(o)&&(attemptFocus(o)||focusFirstDescendant(o)))return!0}return!1}function focusLastDescendant(e){for(let n=e.childNodes.length-1;n>=0;n--){const o=e.childNodes[n];if(isHTMLElement(o)&&(attemptFocus(o)||focusLastDescendant(o)))return!0}return!1}function attemptFocus(e){if(!isFocusable(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function isFocusable(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let stack=[];const FocusTrap=defineComponent({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const n=createId(),o=ref(null),r=ref(null);let u=!1,s=!1;const w=typeof document>"u"?null:document.activeElement;function m(){return stack[stack.length-1]===n}function v(S){var E;S.code==="Escape"&&m()&&((E=e.onEsc)===null||E===void 0||E.call(e,S))}onMounted(()=>{watch(()=>e.active,S=>{S?(f(),on$1("keydown",document,v)):(off$1("keydown",document,v),u&&y())},{immediate:!0})}),onBeforeUnmount(()=>{off$1("keydown",document,v),u&&y()});function g(S){if(!s&&m()){const E=d();if(E===null||E.contains(getPreciseEventTarget(S)))return;x("first")}}function d(){const S=o.value;if(S===null)return null;let E=S;for(;E=E.nextSibling,!(E===null||E instanceof Element&&E.tagName==="DIV"););return E}function f(){var S;if(!e.disabled){if(stack.push(n),e.autoFocus){const{initialFocusTo:E}=e;E===void 0?x("first"):(S=resolveTo(E))===null||S===void 0||S.focus({preventScroll:!0})}u=!0,document.addEventListener("focus",g,!0)}}function y(){var S;if(e.disabled||(document.removeEventListener("focus",g,!0),stack=stack.filter(M=>M!==n),m()))return;const{finalFocusTo:E}=e;E!==void 0?(S=resolveTo(E))===null||S===void 0||S.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&w instanceof HTMLElement&&(s=!0,w.focus({preventScroll:!0}),s=!1)}function x(S){if(!!m()&&e.active){const E=o.value,M=r.value;if(E!==null&&M!==null){const T=d();if(T==null||T===M){s=!0,E.focus({preventScroll:!0}),s=!1;return}s=!0;const D=S==="first"?focusFirstDescendant(T):focusLastDescendant(T);s=!1,D||(s=!0,E.focus({preventScroll:!0}),s=!1)}}}function k(S){if(s)return;const E=d();E!==null&&(S.relatedTarget!==null&&E.contains(S.relatedTarget)?x("last"):x("first"))}function P(S){s||(S.relatedTarget!==null&&S.relatedTarget===o.value?x("last"):x("first"))}return{focusableStartRef:o,focusableEndRef:r,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:k,handleEndFocus:P}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:n,focusableStyle:o}=this;return h$1(Fragment,null,[h$1("div",{"aria-hidden":"true",tabindex:n?"0":"-1",ref:"focusableStartRef",style:o,onFocus:this.handleStartFocus}),e(),h$1("div",{"aria-hidden":"true",style:o,ref:"focusableEndRef",tabindex:n?"0":"-1",onFocus:this.handleEndFocus})])}});function useOnResize(e,n){n&&(onMounted(()=>{const{value:o}=e;o&&resizeObserverManager.registerHandler(o,n)}),watch(e,(o,r)=>{r&&resizeObserverManager.unregisterHandler(r)},{deep:!1}),onBeforeUnmount(()=>{const{value:o}=e;o&&resizeObserverManager.unregisterHandler(o)}))}function color2Class(e){return e.replace(/#|\(|\)|,|\s|\./g,"_")}const pureNumberRegex=/^(\d|\.)+$/,numberRegex=/(\d|\.)+/;function formatLength(e,{c:n=1,offset:o=0,attachPx:r=!0}={}){if(typeof e=="number"){const u=(e+o)*n;return u===0?"0":`${u}px`}else if(typeof e=="string")if(pureNumberRegex.test(e)){const u=(Number(e)+o)*n;return r?u===0?"0":`${u}px`:`${u}`}else{const u=numberRegex.exec(e);return u?e.replace(numberRegex,String((Number(u[0])+o)*n)):e}return e}function rtlInset(e){const{left:n,right:o,top:r,bottom:u}=getMargin(e);return`${r} ${n} ${u} ${o}`}let _isJsdom;function isJsdom(){return _isJsdom===void 0&&(_isJsdom=navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),_isJsdom}const eventSet=new WeakSet;function markEventEffectPerformed(e){eventSet.add(e)}function eventEffectNotPerformed(e){return!eventSet.has(e)}function getTitleAttribute(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}}function warn(e,n){console.error(`[naive/${e}]: ${n}`)}function throwError(e,n){throw new Error(`[naive/${e}]: ${n}`)}function call(e,...n){if(Array.isArray(e))e.forEach(o=>call(o,...n));else return e(...n)}function createRefSetter(e){return n=>{n?e.value=n.$el:e.value=null}}function flatten$1(e,n=!0,o=[]){return e.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&o.push(createTextVNode(String(r)));return}if(Array.isArray(r)){flatten$1(r,n,o);return}if(r.type===Fragment){if(r.children===null)return;Array.isArray(r.children)&&flatten$1(r.children,n,o)}else{if(r.type===Comment&&n)return;o.push(r)}}}),o}function getFirstSlotVNode(e,n="default",o=void 0){const r=e[n];if(!r)return warn("getFirstSlotVNode",`slot[${n}] is empty`),null;const u=flatten$1(r(o));return u.length===1?u[0]:(warn("getFirstSlotVNode",`slot[${n}] should have exactly one child`),null)}function getFirstSlotVNodeWithTypedProps(e,n,o){if(!n)return null;const r=flatten$1(n(o));return r.length===1?r[0]:(warn("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}function keep(e,n=[],o){const r={};return n.forEach(u=>{r[u]=e[u]}),Object.assign(r,o)}function keysOf(e){return Object.keys(e)}function mergeEventHandlers(e){const n=e.filter(o=>o!==void 0);if(n.length!==0)return n.length===1?n[0]:o=>{e.forEach(r=>{r&&r(o)})}}function omit(e,n=[],o){const r={};return Object.getOwnPropertyNames(e).forEach(s=>{n.includes(s)||(r[s]=e[s])}),Object.assign(r,o)}function render(e,...n){return typeof e=="function"?e(...n):typeof e=="string"?createTextVNode(e):typeof e=="number"?createTextVNode(String(e)):null}function ensureValidVNode(e){return e.some(n=>isVNode(n)?!(n.type===Comment||n.type===Fragment&&!ensureValidVNode(n.children)):!0)?e:null}function resolveSlot(e,n){return e&&ensureValidVNode(e())||n()}function resolveSlotWithTypedProps(e,n,o){return e&&ensureValidVNode(e(n))||o(n)}function resolveWrappedSlot(e,n){const o=e&&ensureValidVNode(e());return n(o||null)}function isSlotEmpty(e){return!(e&&ensureValidVNode(e()))}const Wrapper=defineComponent({render(){var e,n;return(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e)}}),configProviderInjectionKey="n-config-provider",defaultClsPrefix="n";function useConfig(e={},n={defaultBordered:!0}){const o=inject(configProviderInjectionKey,null);return{inlineThemeDisabled:o==null?void 0:o.inlineThemeDisabled,mergedRtlRef:o==null?void 0:o.mergedRtlRef,mergedComponentPropsRef:o==null?void 0:o.mergedComponentPropsRef,mergedBreakpointsRef:o==null?void 0:o.mergedBreakpointsRef,mergedBorderedRef:computed(()=>{var r,u;const{bordered:s}=e;return s!==void 0?s:(u=(r=o==null?void 0:o.mergedBorderedRef.value)!==null&&r!==void 0?r:n.defaultBordered)!==null&&u!==void 0?u:!0}),mergedClsPrefixRef:o?o.mergedClsPrefixRef:shallowRef(defaultClsPrefix),namespaceRef:computed(()=>o==null?void 0:o.mergedNamespaceRef.value)}}function useThemeClass(e,n,o,r){o||throwError("useThemeClass","cssVarsRef is not passed");const u=inject(configProviderInjectionKey,null),s=u==null?void 0:u.mergedThemeHashRef,w=u==null?void 0:u.styleMountTarget,m=ref(""),v=useSsrAdapter();let g;const d=`__${e}`,f=()=>{let y=d;const x=n?n.value:void 0,k=s==null?void 0:s.value;k&&(y+=`-${k}`),x&&(y+=`-${x}`);const{themeOverrides:P,builtinThemeOverrides:S}=r;P&&(y+=`-${murmur2(JSON.stringify(P))}`),S&&(y+=`-${murmur2(JSON.stringify(S))}`),m.value=y,g=()=>{const E=o.value;let M="";for(const T in E)M+=`${T}: ${E[T]};`;c$1(`.${y}`,M).mount({id:y,ssr:v,parent:w}),g=void 0}};return watchEffect(()=>{f()}),{themeClass:m,onRender:()=>{g==null||g()}}}const formItemInjectionKey="n-form-item";function useFormItem(e,{defaultSize:n="medium",mergedSize:o,mergedDisabled:r}={}){const u=inject(formItemInjectionKey,null);provide(formItemInjectionKey,null);const s=computed(o?()=>o(u):()=>{const{size:v}=e;if(v)return v;if(u){const{mergedSize:g}=u;if(g.value!==void 0)return g.value}return n}),w=computed(r?()=>r(u):()=>{const{disabled:v}=e;return v!==void 0?v:u?u.disabled.value:!1}),m=computed(()=>{const{status:v}=e;return v||(u==null?void 0:u.mergedValidationStatus.value)});return onBeforeUnmount(()=>{u&&u.restoreValidation()}),{mergedSizeRef:s,mergedDisabledRef:w,mergedStatusRef:m,nTriggerFormBlur(){u&&u.handleContentBlur()},nTriggerFormChange(){u&&u.handleContentChange()},nTriggerFormFocus(){u&&u.handleContentFocus()},nTriggerFormInput(){u&&u.handleContentInput()}}}const enUS$1={name:"en-US",global:{undo:"Undo",redo:"Redo",confirm:"Confirm",clear:"Clear"},Popconfirm:{positiveText:"Confirm",negativeText:"Cancel"},Cascader:{placeholder:"Please Select",loading:"Loading",loadingRequiredMessage:e=>`Please load all ${e}'s descendants before checking it.`},Time:{dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss"},DatePicker:{yearFormat:"yyyy",monthFormat:"MMM",dayFormat:"eeeeee",yearTypeFormat:"yyyy",monthTypeFormat:"yyyy-MM",dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss",quarterFormat:"yyyy-qqq",weekFormat:"YYYY-w",clear:"Clear",now:"Now",confirm:"Confirm",selectTime:"Select Time",selectDate:"Select Date",datePlaceholder:"Select Date",datetimePlaceholder:"Select Date and Time",monthPlaceholder:"Select Month",yearPlaceholder:"Select Year",quarterPlaceholder:"Select Quarter",weekPlaceholder:"Select Week",startDatePlaceholder:"Start Date",endDatePlaceholder:"End Date",startDatetimePlaceholder:"Start Date and Time",endDatetimePlaceholder:"End Date and Time",startMonthPlaceholder:"Start Month",endMonthPlaceholder:"End Month",monthBeforeYear:!0,firstDayOfWeek:6,today:"Today"},DataTable:{checkTableAll:"Select all in the table",uncheckTableAll:"Unselect all in the table",confirm:"Confirm",clear:"Clear"},LegacyTransfer:{sourceTitle:"Source",targetTitle:"Target"},Transfer:{selectAll:"Select all",unselectAll:"Unselect all",clearAll:"Clear",total:e=>`Total ${e} items`,selected:e=>`${e} items selected`},Empty:{description:"No Data"},Select:{placeholder:"Please Select"},TimePicker:{placeholder:"Select Time",positiveText:"OK",negativeText:"Cancel",now:"Now",clear:"Clear"},Pagination:{goto:"Goto",selectionSuffix:"page"},DynamicTags:{add:"Add"},Log:{loading:"Loading"},Input:{placeholder:"Please Input"},InputNumber:{placeholder:"Please Input"},DynamicInput:{create:"Create"},ThemeEditor:{title:"Theme Editor",clearAllVars:"Clear All Variables",clearSearch:"Clear Search",filterCompName:"Filter Component Name",filterVarName:"Filter Variable Name",import:"Import",export:"Export",restore:"Reset to Default"},Image:{tipPrevious:"Previous picture (\u2190)",tipNext:"Next picture (\u2192)",tipCounterclockwise:"Counterclockwise",tipClockwise:"Clockwise",tipZoomOut:"Zoom out",tipZoomIn:"Zoom in",tipDownload:"Download",tipClose:"Close (Esc)",tipOriginalSize:"Zoom to original size"}},enUS$2=enUS$1;function buildFormatLongFn(e){return(n={})=>{const o=n.width?String(n.width):e.defaultWidth;return e.formats[o]||e.formats[e.defaultWidth]}}function buildLocalizeFn(e){return(n,o)=>{const r=o!=null&&o.context?String(o.context):"standalone";let u;if(r==="formatting"&&e.formattingValues){const w=e.defaultFormattingWidth||e.defaultWidth,m=o!=null&&o.width?String(o.width):w;u=e.formattingValues[m]||e.formattingValues[w]}else{const w=e.defaultWidth,m=o!=null&&o.width?String(o.width):e.defaultWidth;u=e.values[m]||e.values[w]}const s=e.argumentCallback?e.argumentCallback(n):n;return u[s]}}function buildMatchFn(e){return(n,o={})=>{const r=o.width,u=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=n.match(u);if(!s)return null;const w=s[0],m=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(m)?findIndex(m,f=>f.test(w)):findKey(m,f=>f.test(w));let g;g=e.valueCallback?e.valueCallback(v):v,g=o.valueCallback?o.valueCallback(g):g;const d=n.slice(w.length);return{value:g,rest:d}}}function findKey(e,n){for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return o}function findIndex(e,n){for(let o=0;o<e.length;o++)if(n(e[o]))return o}function buildMatchPatternFn(e){return(n,o={})=>{const r=n.match(e.matchPattern);if(!r)return null;const u=r[0],s=n.match(e.parsePattern);if(!s)return null;let w=e.valueCallback?e.valueCallback(s[0]):s[0];w=o.valueCallback?o.valueCallback(w):w;const m=n.slice(u.length);return{value:w,rest:m}}}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(e,n,o)=>{let r;const u=formatDistanceLocale[e];return typeof u=="string"?r=u:n===1?r=u.one:r=u.other.replace("{{count}}",n.toString()),o!=null&&o.addSuffix?o.comparison&&o.comparison>0?"in "+r:r+" ago":r},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(e,n,o,r)=>formatRelativeLocale[e],eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(e,n)=>{const o=Number(e),r=o%100;if(r>20||r<10)switch(r%10){case 1:return o+"st";case 2:return o+"nd";case 3:return o+"rd"}return o+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:e=>e-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})},matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:e=>parseInt(e,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}},dateEnUs={name:"en-US",locale:enUS},dateEnUS=dateEnUs;var freeGlobal$1=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$2=freeGlobal$1;var freeSelf$1=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal$2||freeSelf$1||Function("return this")();const root$2=root$1;var Symbol$1=root$2.Symbol;const Symbol$2=Symbol$1;var objectProto$f=Object.prototype,hasOwnProperty$b=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(e){var n=hasOwnProperty$b.call(e,symToStringTag$1),o=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var r=!0}catch{}var u=nativeObjectToString$1.call(e);return r&&(n?e[symToStringTag$1]=o:delete e[symToStringTag$1]),u}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString$1(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(e){return e==null?e===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString$1(e)}function isObjectLike$1(e){return e!=null&&typeof e=="object"}var symbolTag$2="[object Symbol]";function isSymbol$1(e){return typeof e=="symbol"||isObjectLike$1(e)&&baseGetTag(e)==symbolTag$2}function arrayMap(e,n){for(var o=-1,r=e==null?0:e.length,u=Array(r);++o<r;)u[o]=n(e[o],o,e);return u}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$1=1/0,symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if(typeof e=="string")return e;if(isArray$2(e))return arrayMap(e,baseToString)+"";if(isSymbol$1(e))return symbolToString?symbolToString.call(e):"";var n=e+"";return n=="0"&&1/e==-INFINITY$1?"-0":n}function isObject$2(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function identity$1(e){return e}var asyncTag="[object AsyncFunction]",funcTag$1="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(e){if(!isObject$2(e))return!1;var n=baseGetTag(e);return n==funcTag$1||n==genTag||n==asyncTag||n==proxyTag}var coreJsData=root$2["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(e!=null){try{return funcToString$2.call(e)}catch{}try{return e+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$a=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$a).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!isObject$2(e)||isMasked(e))return!1;var n=isFunction$1(e)?reIsNative:reIsHostCtor;return n.test(toSource(e))}function getValue(e,n){return e==null?void 0:e[n]}function getNative(e,n){var o=getValue(e,n);return baseIsNative(o)?o:void 0}var WeakMap$1=getNative(root$2,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function e(){}return function(n){if(!isObject$2(n))return{};if(objectCreate)return objectCreate(n);e.prototype=n;var o=new e;return e.prototype=void 0,o}}();const baseCreate$1=baseCreate;function apply(e,n,o){switch(o.length){case 0:return e.call(n);case 1:return e.call(n,o[0]);case 2:return e.call(n,o[0],o[1]);case 3:return e.call(n,o[0],o[1],o[2])}return e.apply(n,o)}function copyArray(e,n){var o=-1,r=e.length;for(n||(n=Array(r));++o<r;)n[o]=e[o];return n}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var n=0,o=0;return function(){var r=nativeNow(),u=HOT_SPAN-(r-o);if(o=r,u>0){if(++n>=HOT_COUNT)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch{}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(e,n){return defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant(n),writable:!0})}:identity$1;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,n){var o=typeof e;return n=n==null?MAX_SAFE_INTEGER$1:n,!!n&&(o=="number"||o!="symbol"&&reIsUint.test(e))&&e>-1&&e%1==0&&e<n}function baseAssignValue(e,n,o){n=="__proto__"&&defineProperty$1?defineProperty$1(e,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[n]=o}function eq(e,n){return e===n||e!==e&&n!==n}var objectProto$c=Object.prototype,hasOwnProperty$9=objectProto$c.hasOwnProperty;function assignValue(e,n,o){var r=e[n];(!(hasOwnProperty$9.call(e,n)&&eq(r,o))||o===void 0&&!(n in e))&&baseAssignValue(e,n,o)}function copyObject(e,n,o,r){var u=!o;o||(o={});for(var s=-1,w=n.length;++s<w;){var m=n[s],v=r?r(o[m],e[m],m,o,e):void 0;v===void 0&&(v=e[m]),u?baseAssignValue(o,m,v):assignValue(o,m,v)}return o}var nativeMax$1=Math.max;function overRest(e,n,o){return n=nativeMax$1(n===void 0?e.length-1:n,0),function(){for(var r=arguments,u=-1,s=nativeMax$1(r.length-n,0),w=Array(s);++u<s;)w[u]=r[n+u];u=-1;for(var m=Array(n+1);++u<n;)m[u]=r[u];return m[n]=o(w),apply(e,this,m)}}function baseRest(e,n){return setToString$1(overRest(e,n,identity$1),e+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction$1(e)}function isIterateeCall(e,n,o){if(!isObject$2(o))return!1;var r=typeof n;return(r=="number"?isArrayLike(o)&&isIndex(n,o.length):r=="string"&&n in o)?eq(o[n],e):!1}function createAssigner(e){return baseRest(function(n,o){var r=-1,u=o.length,s=u>1?o[u-1]:void 0,w=u>2?o[2]:void 0;for(s=e.length>3&&typeof s=="function"?(u--,s):void 0,w&&isIterateeCall(o[0],o[1],w)&&(s=u<3?void 0:s,u=1),n=Object(n);++r<u;){var m=o[r];m&&e(n,m,r,s)}return n})}var objectProto$b=Object.prototype;function isPrototype(e){var n=e&&e.constructor,o=typeof n=="function"&&n.prototype||objectProto$b;return e===o}function baseTimes(e,n){for(var o=-1,r=Array(e);++o<e;)r[o]=n(o);return r}var argsTag$2="[object Arguments]";function baseIsArguments(e){return isObjectLike$1(e)&&baseGetTag(e)==argsTag$2}var objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike$1(e)&&hasOwnProperty$8.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")};const isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$2.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse;const isBuffer$2=isBuffer$1;var argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$3="[object Object]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",weakMapTag$1="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$1]=typedArrayTags[boolTag$1]=typedArrayTags[dataViewTag$2]=typedArrayTags[dateTag$1]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag]=typedArrayTags[mapTag$2]=typedArrayTags[numberTag$1]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$1]=typedArrayTags[setTag$2]=typedArrayTags[stringTag$1]=typedArrayTags[weakMapTag$1]=!1;function baseIsTypedArray(e){return isObjectLike$1(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(e){return function(n){return e(n)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$2.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;const isTypedArray$2=isTypedArray$1;var objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function arrayLikeKeys(e,n){var o=isArray$2(e),r=!o&&isArguments$1(e),u=!o&&!r&&isBuffer$2(e),s=!o&&!r&&!u&&isTypedArray$2(e),w=o||r||u||s,m=w?baseTimes(e.length,String):[],v=m.length;for(var g in e)(n||hasOwnProperty$7.call(e,g))&&!(w&&(g=="length"||u&&(g=="offset"||g=="parent")||s&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||isIndex(g,v)))&&m.push(g);return m}function overArg(e,n){return function(o){return e(n(o))}}var nativeKeys=overArg(Object.keys,Object);const nativeKeys$1=nativeKeys;var objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys$1(e);var n=[];for(var o in Object(e))hasOwnProperty$6.call(e,o)&&o!="constructor"&&n.push(o);return n}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function nativeKeysIn(e){var n=[];if(e!=null)for(var o in Object(e))n.push(o);return n}var objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function baseKeysIn(e){if(!isObject$2(e))return nativeKeysIn(e);var n=isPrototype(e),o=[];for(var r in e)r=="constructor"&&(n||!hasOwnProperty$5.call(e,r))||o.push(r);return o}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,n){if(isArray$2(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||isSymbol$1(e)?!0:reIsPlainProp.test(e)||!reIsDeepProp.test(e)||n!=null&&e in Object(n)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function hashGet(e){var n=this.__data__;if(nativeCreate$1){var o=n[e];return o===HASH_UNDEFINED$2?void 0:o}return hasOwnProperty$4.call(n,e)?n[e]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty;function hashHas(e){var n=this.__data__;return nativeCreate$1?n[e]!==void 0:hasOwnProperty$3.call(n,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,n){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=nativeCreate$1&&n===void 0?HASH_UNDEFINED$1:n,this}function Hash(e){var n=-1,o=e==null?0:e.length;for(this.clear();++n<o;){var r=e[n];this.set(r[0],r[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,n){for(var o=e.length;o--;)if(eq(e[o][0],n))return o;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var n=this.__data__,o=assocIndexOf(n,e);if(o<0)return!1;var r=n.length-1;return o==r?n.pop():splice.call(n,o,1),--this.size,!0}function listCacheGet(e){var n=this.__data__,o=assocIndexOf(n,e);return o<0?void 0:n[o][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,n){var o=this.__data__,r=assocIndexOf(o,e);return r<0?(++this.size,o.push([e,n])):o[r][1]=n,this}function ListCache(e){var n=-1,o=e==null?0:e.length;for(this.clear();++n<o;){var r=e[n];this.set(r[0],r[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$2,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function getMapData(e,n){var o=e.__data__;return isKeyable(n)?o[typeof n=="string"?"string":"hash"]:o.map}function mapCacheDelete(e){var n=getMapData(this,e).delete(e);return this.size-=n?1:0,n}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,n){var o=getMapData(this,e),r=o.size;return o.set(e,n),this.size+=o.size==r?0:1,this}function MapCache(e){var n=-1,o=e==null?0:e.length;for(this.clear();++n<o;){var r=e[n];this.set(r[0],r[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new TypeError(FUNC_ERROR_TEXT$1);var o=function(){var r=arguments,u=n?n.apply(this,r):r[0],s=o.cache;if(s.has(u))return s.get(u);var w=e.apply(this,r);return o.cache=s.set(u,w)||s,w};return o.cache=new(memoize.Cache||MapCache),o}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var n=memoize(e,function(r){return o.size===MAX_MEMOIZE_SIZE&&o.clear(),r}),o=n.cache;return n}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(rePropName,function(o,r,u,s){n.push(u?s.replace(reEscapeChar,"$1"):r||o)}),n});const stringToPath$1=stringToPath;function toString$1(e){return e==null?"":baseToString(e)}function castPath(e,n){return isArray$2(e)?e:isKey(e,n)?[e]:stringToPath$1(toString$1(e))}var INFINITY=1/0;function toKey(e){if(typeof e=="string"||isSymbol$1(e))return e;var n=e+"";return n=="0"&&1/e==-INFINITY?"-0":n}function baseGet(e,n){n=castPath(n,e);for(var o=0,r=n.length;e!=null&&o<r;)e=e[toKey(n[o++])];return o&&o==r?e:void 0}function get(e,n,o){var r=e==null?void 0:baseGet(e,n);return r===void 0?o:r}function arrayPush(e,n){for(var o=-1,r=n.length,u=e.length;++o<r;)e[u+o]=n[o];return e}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;var objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$2=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$2(e){if(!isObjectLike$1(e)||baseGetTag(e)!=objectTag$2)return!1;var n=getPrototype$1(e);if(n===null)return!0;var o=hasOwnProperty$2.call(n,"constructor")&&n.constructor;return typeof o=="function"&&o instanceof o&&funcToString.call(o)==objectCtorString}function baseSlice(e,n,o){var r=-1,u=e.length;n<0&&(n=-n>u?0:u+n),o=o>u?u:o,o<0&&(o+=u),u=n>o?0:o-n>>>0,n>>>=0;for(var s=Array(u);++r<u;)s[r]=e[r+n];return s}function castSlice(e,n,o){var r=e.length;return o=o===void 0?r:o,!n&&o>=r?e:baseSlice(e,n,o)}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsVarRange$1="\\ufe0e\\ufe0f",rsZWJ$1="\\u200d",reHasUnicode=RegExp("["+rsZWJ$1+rsAstralRange$1+rsComboRange$1+rsVarRange$1+"]");function hasUnicode(e){return reHasUnicode.test(e)}function asciiToArray(e){return e.split("")}var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange+"]",rsCombo="["+rsComboRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeToArray(e){return e.match(reUnicode)||[]}function stringToArray(e){return hasUnicode(e)?unicodeToArray(e):asciiToArray(e)}function createCaseFirst(e){return function(n){n=toString$1(n);var o=hasUnicode(n)?stringToArray(n):void 0,r=o?o[0]:n.charAt(0),u=o?castSlice(o,1).join(""):n.slice(1);return r[e]()+u}}var upperFirst=createCaseFirst("toUpperCase");const upperFirst$1=upperFirst;function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var n=this.__data__,o=n.delete(e);return this.size=n.size,o}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE=200;function stackSet(e,n){var o=this.__data__;if(o instanceof ListCache){var r=o.__data__;if(!Map$2||r.length<LARGE_ARRAY_SIZE-1)return r.push([e,n]),this.size=++o.size,this;o=this.__data__=new MapCache(r)}return o.set(e,n),this.size=o.size,this}function Stack(e){var n=this.__data__=new ListCache(e);this.size=n.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$2.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(e,n){if(n)return e.slice();var o=e.length,r=allocUnsafe?allocUnsafe(o):new e.constructor(o);return e.copy(r),r}function arrayFilter(e,n){for(var o=-1,r=e==null?0:e.length,u=0,s=[];++o<r;){var w=e[o];n(w,o,e)&&(s[u++]=w)}return s}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return e==null?[]:(e=Object(e),arrayFilter(nativeGetSymbols(e),function(n){return propertyIsEnumerable.call(e,n)}))}:stubArray;const getSymbols$1=getSymbols;function baseGetAllKeys(e,n,o){var r=n(e);return isArray$2(e)?r:arrayPush(r,o(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols$1)}var DataView$1=getNative(root$2,"DataView");const DataView$2=DataView$1;var Promise$1=getNative(root$2,"Promise");const Promise$2=Promise$1;var Set$1=getNative(root$2,"Set");const Set$2=Set$1;var mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=toSource(DataView$2),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$2),getTag=baseGetTag;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$1||Map$2&&getTag(new Map$2)!=mapTag$1||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$1||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag)&&(getTag=function(e){var n=baseGetTag(e),o=n==objectTag$1?e.constructor:void 0,r=o?toSource(o):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag}return n});const getTag$1=getTag;var Uint8Array$1=root$2.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(e){var n=new e.constructor(e.byteLength);return new Uint8Array$2(n).set(new Uint8Array$2(e)),n}function cloneTypedArray(e,n){var o=n?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function initCloneObject(e){return typeof e.constructor=="function"&&!isPrototype(e)?baseCreate$1(getPrototype$1(e)):{}}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var n=-1,o=e==null?0:e.length;for(this.__data__=new MapCache;++n<o;)this.add(e[n])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(e,n){for(var o=-1,r=e==null?0:e.length;++o<r;)if(n(e[o],o,e))return!0;return!1}function cacheHas(e,n){return e.has(n)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,n,o,r,u,s){var w=o&COMPARE_PARTIAL_FLAG$5,m=e.length,v=n.length;if(m!=v&&!(w&&v>m))return!1;var g=s.get(e),d=s.get(n);if(g&&d)return g==n&&d==e;var f=-1,y=!0,x=o&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(s.set(e,n),s.set(n,e);++f<m;){var k=e[f],P=n[f];if(r)var S=w?r(P,k,f,n,e,s):r(k,P,f,e,n,s);if(S!==void 0){if(S)continue;y=!1;break}if(x){if(!arraySome(n,function(E,M){if(!cacheHas(x,M)&&(k===E||u(k,E,o,r,s)))return x.push(M)})){y=!1;break}}else if(!(k===P||u(k,P,o,r,s))){y=!1;break}}return s.delete(e),s.delete(n),y}function mapToArray(e){var n=-1,o=Array(e.size);return e.forEach(function(r,u){o[++n]=[u,r]}),o}function setToArray(e){var n=-1,o=Array(e.size);return e.forEach(function(r){o[++n]=r}),o}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,n,o,r,u,s,w){switch(o){case dataViewTag:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case arrayBufferTag:return!(e.byteLength!=n.byteLength||!s(new Uint8Array$2(e),new Uint8Array$2(n)));case boolTag:case dateTag:case numberTag:return eq(+e,+n);case errorTag:return e.name==n.name&&e.message==n.message;case regexpTag:case stringTag:return e==n+"";case mapTag:var m=mapToArray;case setTag:var v=r&COMPARE_PARTIAL_FLAG$4;if(m||(m=setToArray),e.size!=n.size&&!v)return!1;var g=w.get(e);if(g)return g==n;r|=COMPARE_UNORDERED_FLAG$2,w.set(e,n);var d=equalArrays(m(e),m(n),r,u,s,w);return w.delete(e),d;case symbolTag$1:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(n)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$2=Object.prototype,hasOwnProperty$1=objectProto$2.hasOwnProperty;function equalObjects(e,n,o,r,u,s){var w=o&COMPARE_PARTIAL_FLAG$3,m=getAllKeys(e),v=m.length,g=getAllKeys(n),d=g.length;if(v!=d&&!w)return!1;for(var f=v;f--;){var y=m[f];if(!(w?y in n:hasOwnProperty$1.call(n,y)))return!1}var x=s.get(e),k=s.get(n);if(x&&k)return x==n&&k==e;var P=!0;s.set(e,n),s.set(n,e);for(var S=w;++f<v;){y=m[f];var E=e[y],M=n[y];if(r)var T=w?r(M,E,y,n,e,s):r(E,M,y,e,n,s);if(!(T===void 0?E===M||u(E,M,o,r,s):T)){P=!1;break}S||(S=y=="constructor")}if(P&&!S){var D=e.constructor,N=n.constructor;D!=N&&"constructor"in e&&"constructor"in n&&!(typeof D=="function"&&D instanceof D&&typeof N=="function"&&N instanceof N)&&(P=!1)}return s.delete(e),s.delete(n),P}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$1=Object.prototype,hasOwnProperty=objectProto$1.hasOwnProperty;function baseIsEqualDeep(e,n,o,r,u,s){var w=isArray$2(e),m=isArray$2(n),v=w?arrayTag:getTag$1(e),g=m?arrayTag:getTag$1(n);v=v==argsTag?objectTag:v,g=g==argsTag?objectTag:g;var d=v==objectTag,f=g==objectTag,y=v==g;if(y&&isBuffer$2(e)){if(!isBuffer$2(n))return!1;w=!0,d=!1}if(y&&!d)return s||(s=new Stack),w||isTypedArray$2(e)?equalArrays(e,n,o,r,u,s):equalByTag(e,n,v,o,r,u,s);if(!(o&COMPARE_PARTIAL_FLAG$2)){var x=d&&hasOwnProperty.call(e,"__wrapped__"),k=f&&hasOwnProperty.call(n,"__wrapped__");if(x||k){var P=x?e.value():e,S=k?n.value():n;return s||(s=new Stack),u(P,S,o,r,s)}}return y?(s||(s=new Stack),equalObjects(e,n,o,r,u,s)):!1}function baseIsEqual(e,n,o,r,u){return e===n?!0:e==null||n==null||!isObjectLike$1(e)&&!isObjectLike$1(n)?e!==e&&n!==n:baseIsEqualDeep(e,n,o,r,baseIsEqual,u)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,n,o,r){var u=o.length,s=u,w=!r;if(e==null)return!s;for(e=Object(e);u--;){var m=o[u];if(w&&m[2]?m[1]!==e[m[0]]:!(m[0]in e))return!1}for(;++u<s;){m=o[u];var v=m[0],g=e[v],d=m[1];if(w&&m[2]){if(g===void 0&&!(v in e))return!1}else{var f=new Stack;if(r)var y=r(g,d,v,e,n,f);if(!(y===void 0?baseIsEqual(d,g,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,r,f):y))return!1}}return!0}function isStrictComparable(e){return e===e&&!isObject$2(e)}function getMatchData(e){for(var n=keys(e),o=n.length;o--;){var r=n[o],u=e[r];n[o]=[r,u,isStrictComparable(u)]}return n}function matchesStrictComparable(e,n){return function(o){return o==null?!1:o[e]===n&&(n!==void 0||e in Object(o))}}function baseMatches(e){var n=getMatchData(e);return n.length==1&&n[0][2]?matchesStrictComparable(n[0][0],n[0][1]):function(o){return o===e||baseIsMatch(o,e,n)}}function baseHasIn(e,n){return e!=null&&n in Object(e)}function hasPath(e,n,o){n=castPath(n,e);for(var r=-1,u=n.length,s=!1;++r<u;){var w=toKey(n[r]);if(!(s=e!=null&&o(e,w)))break;e=e[w]}return s||++r!=u?s:(u=e==null?0:e.length,!!u&&isLength(u)&&isIndex(w,u)&&(isArray$2(e)||isArguments$1(e)))}function hasIn(e,n){return e!=null&&hasPath(e,n,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(e,n){return isKey(e)&&isStrictComparable(n)?matchesStrictComparable(toKey(e),n):function(o){var r=get(o,e);return r===void 0&&r===n?hasIn(o,e):baseIsEqual(n,r,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(e){return function(n){return n==null?void 0:n[e]}}function basePropertyDeep(e){return function(n){return baseGet(n,e)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return typeof e=="function"?e:e==null?identity$1:typeof e=="object"?isArray$2(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function createBaseFor(e){return function(n,o,r){for(var u=-1,s=Object(n),w=r(n),m=w.length;m--;){var v=w[e?m:++u];if(o(s[v],v,s)===!1)break}return n}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(e,n){return e&&baseFor$1(e,n,keys)}function createBaseEach(e,n){return function(o,r){if(o==null)return o;if(!isArrayLike(o))return e(o,r);for(var u=o.length,s=n?u:-1,w=Object(o);(n?s--:++s<u)&&r(w[s],s,w)!==!1;);return o}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;function assignMergeValue(e,n,o){(o!==void 0&&!eq(e[n],o)||o===void 0&&!(n in e))&&baseAssignValue(e,n,o)}function isArrayLikeObject(e){return isObjectLike$1(e)&&isArrayLike(e)}function safeGet(e,n){if(!(n==="constructor"&&typeof e[n]=="function")&&n!="__proto__")return e[n]}function toPlainObject(e){return copyObject(e,keysIn(e))}function baseMergeDeep(e,n,o,r,u,s,w){var m=safeGet(e,o),v=safeGet(n,o),g=w.get(v);if(g){assignMergeValue(e,o,g);return}var d=s?s(m,v,o+"",e,n,w):void 0,f=d===void 0;if(f){var y=isArray$2(v),x=!y&&isBuffer$2(v),k=!y&&!x&&isTypedArray$2(v);d=v,y||x||k?isArray$2(m)?d=m:isArrayLikeObject(m)?d=copyArray(m):x?(f=!1,d=cloneBuffer(v,!0)):k?(f=!1,d=cloneTypedArray(v,!0)):d=[]:isPlainObject$2(v)||isArguments$1(v)?(d=m,isArguments$1(m)?d=toPlainObject(m):(!isObject$2(m)||isFunction$1(m))&&(d=initCloneObject(v))):f=!1}f&&(w.set(v,d),u(d,v,r,s,w),w.delete(v)),assignMergeValue(e,o,d)}function baseMerge(e,n,o,r,u){e!==n&&baseFor$1(n,function(s,w){if(u||(u=new Stack),isObject$2(s))baseMergeDeep(e,n,w,o,baseMerge,r,u);else{var m=r?r(safeGet(e,w),s,w+"",e,n,u):void 0;m===void 0&&(m=s),assignMergeValue(e,w,m)}},keysIn)}function baseMap(e,n){var o=-1,r=isArrayLike(e)?Array(e.length):[];return baseEach$1(e,function(u,s,w){r[++o]=n(u,s,w)}),r}function map(e,n){var o=isArray$2(e)?arrayMap:baseMap;return o(e,baseIteratee(n))}var merge$2=createAssigner(function(e,n,o){baseMerge(e,n,o)});const merge$3=merge$2;function useLocale(e){const{mergedLocaleRef:n,mergedDateLocaleRef:o}=inject(configProviderInjectionKey,null)||{},r=computed(()=>{var s,w;return(w=(s=n==null?void 0:n.value)===null||s===void 0?void 0:s[e])!==null&&w!==void 0?w:enUS$2[e]});return{dateLocaleRef:computed(()=>{var s;return(s=o==null?void 0:o.value)!==null&&s!==void 0?s:dateEnUS}),localeRef:r}}const cssrAnchorMetaName="naive-ui-style";function useRtl(e,n,o){if(!n)return;const r=useSsrAdapter(),u=computed(()=>{const{value:m}=n;if(!m)return;const v=m[e];if(!!v)return v}),s=inject(configProviderInjectionKey,null),w=()=>{watchEffect(()=>{const{value:m}=o,v=`${m}${e}Rtl`;if(exists(v,r))return;const{value:g}=u;!g||g.style.mount({id:v,head:!0,anchorMetaName:cssrAnchorMetaName,props:{bPrefix:m?`.${m}-`:void 0},ssr:r,parent:s==null?void 0:s.styleMountTarget})})};return r?w():onBeforeMount(w),u}const commonVariables$8={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize,fontFamily,lineHeight}=commonVariables$8,globalStyle=c$1("body",`
 margin: 0;
 font-size: ${fontSize};
 font-family: ${fontFamily};
 line-height: ${lineHeight};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[c$1("input",`
 font-family: inherit;
 font-size: inherit;
 `)]);function useStyle(e,n,o){if(!n)return;const r=useSsrAdapter(),u=inject(configProviderInjectionKey,null),s=()=>{const w=o.value;n.mount({id:w===void 0?e:w+e,head:!0,anchorMetaName:cssrAnchorMetaName,props:{bPrefix:w?`.${w}-`:void 0},ssr:r,parent:u==null?void 0:u.styleMountTarget}),u!=null&&u.preflightStyleDisabled||globalStyle.mount({id:"n-global",head:!0,anchorMetaName:cssrAnchorMetaName,ssr:r,parent:u==null?void 0:u.styleMountTarget})};r?s():onBeforeMount(s)}function createTheme(e){return e}function useTheme(e,n,o,r,u,s){const w=useSsrAdapter(),m=inject(configProviderInjectionKey,null);if(o){const g=()=>{const d=s==null?void 0:s.value;o.mount({id:d===void 0?n:d+n,head:!0,props:{bPrefix:d?`.${d}-`:void 0},anchorMetaName:cssrAnchorMetaName,ssr:w,parent:m==null?void 0:m.styleMountTarget}),m!=null&&m.preflightStyleDisabled||globalStyle.mount({id:"n-global",head:!0,anchorMetaName:cssrAnchorMetaName,ssr:w,parent:m==null?void 0:m.styleMountTarget})};w?g():onBeforeMount(g)}return computed(()=>{var g;const{theme:{common:d,self:f,peers:y={}}={},themeOverrides:x={},builtinThemeOverrides:k={}}=u,{common:P,peers:S}=x,{common:E=void 0,[e]:{common:M=void 0,self:T=void 0,peers:D={}}={}}=(m==null?void 0:m.mergedThemeRef.value)||{},{common:N=void 0,[e]:I={}}=(m==null?void 0:m.mergedThemeOverridesRef.value)||{},{common:O,peers:F={}}=I,q=merge$3({},d||M||E||r.common,N,O,P),Y=merge$3((g=f||T||r.self)===null||g===void 0?void 0:g(q),k,I,x);return{common:q,self:Y,peers:merge$3({},r.peers,D,y),peerOverrides:merge$3({},k.peers,F,S)}})}useTheme.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const style$p=cB("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[c$1("svg",`
 height: 1em;
 width: 1em;
 `)]),NBaseIcon=defineComponent({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(e){useStyle("-base-icon",style$p,toRef(e,"clsPrefix"))},render(){return h$1("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),NIconSwitchTransition=defineComponent({name:"BaseIconSwitchTransition",setup(e,{slots:n}){const o=isMounted();return()=>h$1(Transition,{name:"icon-switch-transition",appear:o.value},n)}}),AddIcon=defineComponent({name:"Add",render(){return h$1("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h$1("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}});function replaceable(e,n){const o=defineComponent({render(){return n()}});return defineComponent({name:upperFirst$1(e),setup(){var r;const u=(r=inject(configProviderInjectionKey,null))===null||r===void 0?void 0:r.mergedIconsRef;return()=>{var s;const w=(s=u==null?void 0:u.value)===null||s===void 0?void 0:s[e];return w?w():h$1(o,null)}}})}const FinishedIcon=defineComponent({name:"Checkmark",render(){return h$1("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},h$1("g",{fill:"none"},h$1("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}}),ChevronDownIcon=defineComponent({name:"ChevronDown",render(){return h$1("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h$1("path",{d:"M3.14645 5.64645C3.34171 5.45118 3.65829 5.45118 3.85355 5.64645L8 9.79289L12.1464 5.64645C12.3417 5.45118 12.6583 5.45118 12.8536 5.64645C13.0488 5.84171 13.0488 6.15829 12.8536 6.35355L8.35355 10.8536C8.15829 11.0488 7.84171 11.0488 7.64645 10.8536L3.14645 6.35355C2.95118 6.15829 2.95118 5.84171 3.14645 5.64645Z",fill:"currentColor"}))}}),ClearIcon=replaceable("clear",()=>h$1("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},h$1("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},h$1("g",{fill:"currentColor","fill-rule":"nonzero"},h$1("path",{d:"M8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,4.6862915 4.6862915,2 8,2 Z M6.5343055,5.83859116 C6.33943736,5.70359511 6.07001296,5.72288026 5.89644661,5.89644661 L5.89644661,5.89644661 L5.83859116,5.9656945 C5.70359511,6.16056264 5.72288026,6.42998704 5.89644661,6.60355339 L5.89644661,6.60355339 L7.293,8 L5.89644661,9.39644661 L5.83859116,9.4656945 C5.70359511,9.66056264 5.72288026,9.92998704 5.89644661,10.1035534 L5.89644661,10.1035534 L5.9656945,10.1614088 C6.16056264,10.2964049 6.42998704,10.2771197 6.60355339,10.1035534 L6.60355339,10.1035534 L8,8.707 L9.39644661,10.1035534 L9.4656945,10.1614088 C9.66056264,10.2964049 9.92998704,10.2771197 10.1035534,10.1035534 L10.1035534,10.1035534 L10.1614088,10.0343055 C10.2964049,9.83943736 10.2771197,9.57001296 10.1035534,9.39644661 L10.1035534,9.39644661 L8.707,8 L10.1035534,6.60355339 L10.1614088,6.5343055 C10.2964049,6.33943736 10.2771197,6.07001296 10.1035534,5.89644661 L10.1035534,5.89644661 L10.0343055,5.83859116 C9.83943736,5.70359511 9.57001296,5.72288026 9.39644661,5.89644661 L9.39644661,5.89644661 L8,7.293 L6.60355339,5.89644661 Z"}))))),ErrorIcon$1=replaceable("close",()=>h$1("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},h$1("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},h$1("g",{fill:"currentColor","fill-rule":"nonzero"},h$1("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),EmptyIcon=defineComponent({name:"Empty",render(){return h$1("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h$1("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),h$1("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}}),ErrorIcon=replaceable("error",()=>h$1("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},h$1("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},h$1("g",{"fill-rule":"nonzero"},h$1("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),EyeIcon=defineComponent({name:"Eye",render(){return h$1("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h$1("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),h$1("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),EyeOffIcon=defineComponent({name:"EyeOff",render(){return h$1("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h$1("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),h$1("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),h$1("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),h$1("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),h$1("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),InfoIcon=replaceable("info",()=>h$1("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},h$1("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},h$1("g",{"fill-rule":"nonzero"},h$1("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),RemoveIcon=defineComponent({name:"Remove",render(){return h$1("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h$1("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}}),SuccessIcon=replaceable("success",()=>h$1("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},h$1("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},h$1("g",{"fill-rule":"nonzero"},h$1("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),WarningIcon=replaceable("warning",()=>h$1("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},h$1("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},h$1("g",{"fill-rule":"nonzero"},h$1("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),{cubicBezierEaseInOut:cubicBezierEaseInOut$3}=commonVariables$8;function iconSwitchTransition({originalTransform:e="",left:n=0,top:o=0,transition:r=`all .3s ${cubicBezierEaseInOut$3} !important`}={}){return[c$1("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:`${e} scale(0.75)`,left:n,top:o,opacity:0}),c$1("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${e}`,left:n,top:o,opacity:1}),c$1("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:n,top:o,transition:r})]}const style$o=cB("base-clear",`
 flex-shrink: 0;
 height: 1em;
 width: 1em;
 position: relative;
`,[c$1(">",[cE("clear",`
 font-size: var(--n-clear-size);
 height: 1em;
 width: 1em;
 cursor: pointer;
 color: var(--n-clear-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 `,[c$1("&:hover",`
 color: var(--n-clear-color-hover)!important;
 `),c$1("&:active",`
 color: var(--n-clear-color-pressed)!important;
 `)]),cE("placeholder",`
 display: flex;
 `),cE("clear, placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[iconSwitchTransition({originalTransform:"translateX(-50%) translateY(-50%)",left:"50%",top:"50%"})])])]),NBaseClear=defineComponent({name:"BaseClear",props:{clsPrefix:{type:String,required:!0},show:Boolean,onClear:Function},setup(e){return useStyle("-base-clear",style$o,toRef(e,"clsPrefix")),{handleMouseDown(n){n.preventDefault()}}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-base-clear`},h$1(NIconSwitchTransition,null,{default:()=>{var n,o;return this.show?h$1("div",{key:"dismiss",class:`${e}-base-clear__clear`,onClick:this.onClear,onMousedown:this.handleMouseDown,"data-clear":!0},resolveSlot(this.$slots.icon,()=>[h$1(NBaseIcon,{clsPrefix:e},{default:()=>h$1(ClearIcon,null)})])):h$1("div",{key:"icon",class:`${e}-base-clear__placeholder`},(o=(n=this.$slots).placeholder)===null||o===void 0?void 0:o.call(n))}}))}}),style$n=cB("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[cM("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),c$1("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),cNotM("disabled",[c$1("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),c$1("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),c$1("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),c$1("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),c$1("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),cM("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),cM("round",[c$1("&::before",`
 border-radius: 50%;
 `)])]),NBaseClose=defineComponent({name:"BaseClose",props:{isButtonTag:{type:Boolean,default:!0},clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(e){return useStyle("-base-close",style$n,toRef(e,"clsPrefix")),()=>{const{clsPrefix:n,disabled:o,absolute:r,round:u,isButtonTag:s}=e;return h$1(s?"button":"div",{type:s?"button":void 0,tabindex:o||!e.focusable?-1:0,"aria-disabled":o,"aria-label":"close",role:s?void 0:"button",disabled:o,class:[`${n}-base-close`,r&&`${n}-base-close--absolute`,o&&`${n}-base-close--disabled`,u&&`${n}-base-close--round`],onMousedown:m=>{e.focusable||m.preventDefault()},onClick:e.onClick},h$1(NBaseIcon,{clsPrefix:n},{default:()=>h$1(ErrorIcon$1,null)}))}}}),NFadeInExpandTransition=defineComponent({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(e,{slots:n}){function o(m){e.width?m.style.maxWidth=`${m.offsetWidth}px`:m.style.maxHeight=`${m.offsetHeight}px`,m.offsetWidth}function r(m){e.width?m.style.maxWidth="0":m.style.maxHeight="0",m.offsetWidth;const{onLeave:v}=e;v&&v()}function u(m){e.width?m.style.maxWidth="":m.style.maxHeight="";const{onAfterLeave:v}=e;v&&v()}function s(m){if(m.style.transition="none",e.width){const v=m.offsetWidth;m.style.maxWidth="0",m.offsetWidth,m.style.transition="",m.style.maxWidth=`${v}px`}else if(e.reverse)m.style.maxHeight=`${m.offsetHeight}px`,m.offsetHeight,m.style.transition="",m.style.maxHeight="0";else{const v=m.offsetHeight;m.style.maxHeight="0",m.offsetWidth,m.style.transition="",m.style.maxHeight=`${v}px`}m.offsetWidth}function w(m){var v;e.width?m.style.maxWidth="":e.reverse||(m.style.maxHeight=""),(v=e.onAfterEnter)===null||v===void 0||v.call(e)}return()=>{const{group:m,width:v,appear:g,mode:d}=e,f=m?TransitionGroup:Transition,y={name:v?"fade-in-width-expand-transition":"fade-in-height-expand-transition",appear:g,onEnter:s,onAfterEnter:w,onBeforeLeave:o,onLeave:r,onAfterLeave:u};return m||(y.mode=d),h$1(f,y,n)}}}),FocusDetector=defineComponent({props:{onFocus:Function,onBlur:Function},setup(e){return()=>h$1("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})}}),style$m=c$1([c$1("@keyframes rotator",`
 0% {
 -webkit-transform: rotate(0deg);
 transform: rotate(0deg);
 }
 100% {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }`),cB("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[cE("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[iconSwitchTransition()]),cE("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[iconSwitchTransition({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),cE("container",`
 animation: rotator 3s linear infinite both;
 `,[cE("icon",`
 height: 1em;
 width: 1em;
 `)])])]),duration="1.6s",exposedLoadingProps={strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0}},NBaseLoading=defineComponent({name:"BaseLoading",props:Object.assign({clsPrefix:{type:String,required:!0},show:{type:Boolean,default:!0},scale:{type:Number,default:1},radius:{type:Number,default:100}},exposedLoadingProps),setup(e){useStyle("-base-loading",style$m,toRef(e,"clsPrefix"))},render(){const{clsPrefix:e,radius:n,strokeWidth:o,stroke:r,scale:u}=this,s=n/u;return h$1("div",{class:`${e}-base-loading`,role:"img","aria-label":"loading"},h$1(NIconSwitchTransition,null,{default:()=>this.show?h$1("div",{key:"icon",class:`${e}-base-loading__transition-wrapper`},h$1("div",{class:`${e}-base-loading__container`},h$1("svg",{class:`${e}-base-loading__icon`,viewBox:`0 0 ${2*s} ${2*s}`,xmlns:"http://www.w3.org/2000/svg",style:{color:r}},h$1("g",null,h$1("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${s} ${s};270 ${s} ${s}`,begin:"0s",dur:duration,fill:"freeze",repeatCount:"indefinite"}),h$1("circle",{class:`${e}-base-loading__icon`,fill:"none",stroke:"currentColor","stroke-width":o,"stroke-linecap":"round",cx:s,cy:s,r:n-o/2,"stroke-dasharray":5.67*n,"stroke-dashoffset":18.48*n},h$1("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${s} ${s};135 ${s} ${s};450 ${s} ${s}`,begin:"0s",dur:duration,fill:"freeze",repeatCount:"indefinite"}),h$1("animate",{attributeName:"stroke-dashoffset",values:`${5.67*n};${1.42*n};${5.67*n}`,begin:"0s",dur:duration,fill:"freeze",repeatCount:"indefinite"})))))):h$1("div",{key:"placeholder",class:`${e}-base-loading__placeholder`},this.$slots)}))}}),{cubicBezierEaseInOut:cubicBezierEaseInOut$2}=commonVariables$8;function fadeInTransition({name:e="fade-in",enterDuration:n="0.2s",leaveDuration:o="0.2s",enterCubicBezier:r=cubicBezierEaseInOut$2,leaveCubicBezier:u=cubicBezierEaseInOut$2}={}){return[c$1(`&.${e}-transition-enter-active`,{transition:`all ${n} ${r}!important`}),c$1(`&.${e}-transition-leave-active`,{transition:`all ${o} ${u}!important`}),c$1(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0}),c$1(`&.${e}-transition-leave-from, &.${e}-transition-enter-to`,{opacity:1})]}const base={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},baseBackgroundRgb=rgba(base.neutralBase),baseInvertBackgroundRgb=rgba(base.neutralInvertBase),overlayPrefix=`rgba(${baseInvertBackgroundRgb.slice(0,3).join(", ")}, `;function overlay(e){return`${overlayPrefix+String(e)})`}function neutral(e){const n=Array.from(baseInvertBackgroundRgb);return n[3]=Number(e),composite(baseBackgroundRgb,n)}const derived=Object.assign(Object.assign({name:"common"},commonVariables$8),{baseColor:base.neutralBase,primaryColor:base.primaryDefault,primaryColorHover:base.primaryHover,primaryColorPressed:base.primaryActive,primaryColorSuppl:base.primarySuppl,infoColor:base.infoDefault,infoColorHover:base.infoHover,infoColorPressed:base.infoActive,infoColorSuppl:base.infoSuppl,successColor:base.successDefault,successColorHover:base.successHover,successColorPressed:base.successActive,successColorSuppl:base.successSuppl,warningColor:base.warningDefault,warningColorHover:base.warningHover,warningColorPressed:base.warningActive,warningColorSuppl:base.warningSuppl,errorColor:base.errorDefault,errorColorHover:base.errorHover,errorColorPressed:base.errorActive,errorColorSuppl:base.errorSuppl,textColorBase:base.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:neutral(base.alpha4),placeholderColor:neutral(base.alpha4),placeholderColorDisabled:neutral(base.alpha5),iconColor:neutral(base.alpha4),iconColorHover:scaleColor(neutral(base.alpha4),{lightness:.75}),iconColorPressed:scaleColor(neutral(base.alpha4),{lightness:.9}),iconColorDisabled:neutral(base.alpha5),opacity1:base.alpha1,opacity2:base.alpha2,opacity3:base.alpha3,opacity4:base.alpha4,opacity5:base.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:neutral(Number(base.alphaClose)),closeIconColorHover:neutral(Number(base.alphaClose)),closeIconColorPressed:neutral(Number(base.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:neutral(base.alpha4),clearColorHover:scaleColor(neutral(base.alpha4),{lightness:.75}),clearColorPressed:scaleColor(neutral(base.alpha4),{lightness:.9}),scrollbarColor:overlay(base.alphaScrollbar),scrollbarColorHover:overlay(base.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:neutral(base.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:base.neutralPopover,tableColor:base.neutralCard,cardColor:base.neutralCard,modalColor:base.neutralModal,bodyColor:base.neutralBody,tagColor:"#eee",avatarColor:neutral(base.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:neutral(base.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:base.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),commonLight=derived,commonVars$5={railInsetHorizontalBottom:"auto 2px 4px 2px",railInsetHorizontalTop:"4px 2px auto 2px",railInsetVerticalRight:"2px 4px 2px auto",railInsetVerticalLeft:"2px auto 2px 4px",railColor:"transparent"};function self$l(e){const{scrollbarColor:n,scrollbarColorHover:o,scrollbarHeight:r,scrollbarWidth:u,scrollbarBorderRadius:s}=e;return Object.assign(Object.assign({},commonVars$5),{height:r,width:u,borderRadius:s,color:n,colorHover:o})}const scrollbarLight={name:"Scrollbar",common:commonLight,self:self$l},scrollbarLight$1=scrollbarLight,style$l=cB("scrollbar",`
 overflow: hidden;
 position: relative;
 z-index: auto;
 height: 100%;
 width: 100%;
`,[c$1(">",[cB("scrollbar-container",`
 width: 100%;
 overflow: scroll;
 height: 100%;
 min-height: inherit;
 max-height: inherit;
 scrollbar-width: none;
 `,[c$1("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),c$1(">",[cB("scrollbar-content",`
 box-sizing: border-box;
 min-width: 100%;
 `)])])]),c$1(">, +",[cB("scrollbar-rail",`
 position: absolute;
 pointer-events: none;
 user-select: none;
 background: var(--n-scrollbar-rail-color);
 -webkit-user-select: none;
 `,[cM("horizontal",`
 height: var(--n-scrollbar-height);
 `,[c$1(">",[cE("scrollbar",`
 height: var(--n-scrollbar-height);
 border-radius: var(--n-scrollbar-border-radius);
 right: 0;
 `)])]),cM("horizontal--top",`
 top: var(--n-scrollbar-rail-top-horizontal-top); 
 right: var(--n-scrollbar-rail-right-horizontal-top); 
 bottom: var(--n-scrollbar-rail-bottom-horizontal-top); 
 left: var(--n-scrollbar-rail-left-horizontal-top); 
 `),cM("horizontal--bottom",`
 top: var(--n-scrollbar-rail-top-horizontal-bottom); 
 right: var(--n-scrollbar-rail-right-horizontal-bottom); 
 bottom: var(--n-scrollbar-rail-bottom-horizontal-bottom); 
 left: var(--n-scrollbar-rail-left-horizontal-bottom); 
 `),cM("vertical",`
 width: var(--n-scrollbar-width);
 `,[c$1(">",[cE("scrollbar",`
 width: var(--n-scrollbar-width);
 border-radius: var(--n-scrollbar-border-radius);
 bottom: 0;
 `)])]),cM("vertical--left",`
 top: var(--n-scrollbar-rail-top-vertical-left); 
 right: var(--n-scrollbar-rail-right-vertical-left); 
 bottom: var(--n-scrollbar-rail-bottom-vertical-left); 
 left: var(--n-scrollbar-rail-left-vertical-left); 
 `),cM("vertical--right",`
 top: var(--n-scrollbar-rail-top-vertical-right); 
 right: var(--n-scrollbar-rail-right-vertical-right); 
 bottom: var(--n-scrollbar-rail-bottom-vertical-right); 
 left: var(--n-scrollbar-rail-left-vertical-right); 
 `),cM("disabled",[c$1(">",[cE("scrollbar","pointer-events: none;")])]),c$1(">",[cE("scrollbar",`
 z-index: 1;
 position: absolute;
 cursor: pointer;
 pointer-events: all;
 background-color: var(--n-scrollbar-color);
 transition: background-color .2s var(--n-scrollbar-bezier);
 `,[fadeInTransition(),c$1("&:hover","background-color: var(--n-scrollbar-color-hover);")])])])])]),scrollbarProps=Object.assign(Object.assign({},useTheme.props),{duration:{type:Number,default:0},scrollable:{type:Boolean,default:!0},xScrollable:Boolean,trigger:{type:String,default:"hover"},useUnifiedContainer:Boolean,triggerDisplayManually:Boolean,container:Function,content:Function,containerClass:String,containerStyle:[String,Object],contentClass:[String,Array],contentStyle:[String,Object],horizontalRailStyle:[String,Object],verticalRailStyle:[String,Object],onScroll:Function,onWheel:Function,onResize:Function,internalOnUpdateScrollLeft:Function,internalHoistYRail:Boolean,yPlacement:{type:String,default:"right"},xPlacement:{type:String,default:"bottom"}}),Scrollbar=defineComponent({name:"Scrollbar",props:scrollbarProps,inheritAttrs:!1,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:o,mergedRtlRef:r}=useConfig(e),u=useRtl("Scrollbar",r,n),s=ref(null),w=ref(null),m=ref(null),v=ref(null),g=ref(null),d=ref(null),f=ref(null),y=ref(null),x=ref(null),k=ref(null),P=ref(null),S=ref(0),E=ref(0),M=ref(!1),T=ref(!1);let D=!1,N=!1,I,O,F=0,q=0,Y=0,_e=0;const ne=useIsIos(),ve=useTheme("Scrollbar","-scrollbar",style$l,scrollbarLight$1,e,n),J=computed(()=>{const{value:tt}=y,{value:ut}=d,{value:Re}=k;return tt===null||ut===null||Re===null?0:Math.min(tt,Re*tt/ut+depx(ve.value.self.width)*1.5)}),fe=computed(()=>`${J.value}px`),Z=computed(()=>{const{value:tt}=x,{value:ut}=f,{value:Re}=P;return tt===null||ut===null||Re===null?0:Re*tt/ut+depx(ve.value.self.height)*1.5}),j=computed(()=>`${Z.value}px`),X=computed(()=>{const{value:tt}=y,{value:ut}=S,{value:Re}=d,{value:Te}=k;if(tt===null||Re===null||Te===null)return 0;{const He=Re-tt;return He?ut/He*(Te-J.value):0}}),H=computed(()=>`${X.value}px`),U=computed(()=>{const{value:tt}=x,{value:ut}=E,{value:Re}=f,{value:Te}=P;if(tt===null||Re===null||Te===null)return 0;{const He=Re-tt;return He?ut/He*(Te-Z.value):0}}),te=computed(()=>`${U.value}px`),Q=computed(()=>{const{value:tt}=y,{value:ut}=d;return tt!==null&&ut!==null&&ut>tt}),re=computed(()=>{const{value:tt}=x,{value:ut}=f;return tt!==null&&ut!==null&&ut>tt}),Pe=computed(()=>{const{trigger:tt}=e;return tt==="none"||M.value}),be=computed(()=>{const{trigger:tt}=e;return tt==="none"||T.value}),we=computed(()=>{const{container:tt}=e;return tt?tt():w.value}),Ae=computed(()=>{const{content:tt}=e;return tt?tt():m.value}),$e=(tt,ut)=>{if(!e.scrollable)return;if(typeof tt=="number"){oe(tt,ut!=null?ut:0,0,!1,"auto");return}const{left:Re,top:Te,index:He,elSize:Fe,position:ze,behavior:We,el:Ue,debounce:et=!0}=tt;(Re!==void 0||Te!==void 0)&&oe(Re!=null?Re:0,Te!=null?Te:0,0,!1,We),Ue!==void 0?oe(0,Ue.offsetTop,Ue.offsetHeight,et,We):He!==void 0&&Fe!==void 0?oe(0,He*Fe,Fe,et,We):ze==="bottom"?oe(0,Number.MAX_SAFE_INTEGER,0,!1,We):ze==="top"&&oe(0,0,0,!1,We)},Me=useReactivated(()=>{e.container||$e({top:S.value,left:E.value})}),Ie=()=>{Me.isDeactivated||Je()},Le=tt=>{if(Me.isDeactivated)return;const{onResize:ut}=e;ut&&ut(tt),Je()},le=(tt,ut)=>{if(!e.scrollable)return;const{value:Re}=we;!Re||(typeof tt=="object"?Re.scrollBy(tt):Re.scrollBy(tt,ut||0))};function oe(tt,ut,Re,Te,He){const{value:Fe}=we;if(!!Fe){if(Te){const{scrollTop:ze,offsetHeight:We}=Fe;if(ut>ze){ut+Re<=ze+We||Fe.scrollTo({left:tt,top:ut+Re-We,behavior:He});return}}Fe.scrollTo({left:tt,top:ut,behavior:He})}}function ke(){Oe(),je(),Je()}function Ce(){Ee()}function Ee(){Be(),Ve()}function Be(){O!==void 0&&window.clearTimeout(O),O=window.setTimeout(()=>{T.value=!1},e.duration)}function Ve(){I!==void 0&&window.clearTimeout(I),I=window.setTimeout(()=>{M.value=!1},e.duration)}function Oe(){I!==void 0&&window.clearTimeout(I),M.value=!0}function je(){O!==void 0&&window.clearTimeout(O),T.value=!0}function Ge(tt){const{onScroll:ut}=e;ut&&ut(tt),Xe()}function Xe(){const{value:tt}=we;tt&&(S.value=tt.scrollTop,E.value=tt.scrollLeft*(u!=null&&u.value?-1:1))}function qe(){const{value:tt}=Ae;tt&&(d.value=tt.offsetHeight,f.value=tt.offsetWidth);const{value:ut}=we;ut&&(y.value=ut.offsetHeight,x.value=ut.offsetWidth);const{value:Re}=g,{value:Te}=v;Re&&(P.value=Re.offsetWidth),Te&&(k.value=Te.offsetHeight)}function Ke(){const{value:tt}=we;tt&&(S.value=tt.scrollTop,E.value=tt.scrollLeft*(u!=null&&u.value?-1:1),y.value=tt.offsetHeight,x.value=tt.offsetWidth,d.value=tt.scrollHeight,f.value=tt.scrollWidth);const{value:ut}=g,{value:Re}=v;ut&&(P.value=ut.offsetWidth),Re&&(k.value=Re.offsetHeight)}function Je(){!e.scrollable||(e.useUnifiedContainer?Ke():(qe(),Xe()))}function rt(tt){var ut;return!(!((ut=s.value)===null||ut===void 0)&&ut.contains(getPreciseEventTarget(tt)))}function ht(tt){tt.preventDefault(),tt.stopPropagation(),N=!0,on$1("mousemove",window,vt,!0),on$1("mouseup",window,Ct,!0),q=E.value,Y=u!=null&&u.value?window.innerWidth-tt.clientX:tt.clientX}function vt(tt){if(!N)return;I!==void 0&&window.clearTimeout(I),O!==void 0&&window.clearTimeout(O);const{value:ut}=x,{value:Re}=f,{value:Te}=Z;if(ut===null||Re===null)return;const Fe=(u!=null&&u.value?window.innerWidth-tt.clientX-Y:tt.clientX-Y)*(Re-ut)/(ut-Te),ze=Re-ut;let We=q+Fe;We=Math.min(ze,We),We=Math.max(We,0);const{value:Ue}=we;if(Ue){Ue.scrollLeft=We*(u!=null&&u.value?-1:1);const{internalOnUpdateScrollLeft:et}=e;et&&et(We)}}function Ct(tt){tt.preventDefault(),tt.stopPropagation(),off$1("mousemove",window,vt,!0),off$1("mouseup",window,Ct,!0),N=!1,Je(),rt(tt)&&Ee()}function kt(tt){tt.preventDefault(),tt.stopPropagation(),D=!0,on$1("mousemove",window,mt,!0),on$1("mouseup",window,Vt,!0),F=S.value,_e=tt.clientY}function mt(tt){if(!D)return;I!==void 0&&window.clearTimeout(I),O!==void 0&&window.clearTimeout(O);const{value:ut}=y,{value:Re}=d,{value:Te}=J;if(ut===null||Re===null)return;const Fe=(tt.clientY-_e)*(Re-ut)/(ut-Te),ze=Re-ut;let We=F+Fe;We=Math.min(ze,We),We=Math.max(We,0);const{value:Ue}=we;Ue&&(Ue.scrollTop=We)}function Vt(tt){tt.preventDefault(),tt.stopPropagation(),off$1("mousemove",window,mt,!0),off$1("mouseup",window,Vt,!0),D=!1,Je(),rt(tt)&&Ee()}watchEffect(()=>{const{value:tt}=re,{value:ut}=Q,{value:Re}=n,{value:Te}=g,{value:He}=v;Te&&(tt?Te.classList.remove(`${Re}-scrollbar-rail--disabled`):Te.classList.add(`${Re}-scrollbar-rail--disabled`)),He&&(ut?He.classList.remove(`${Re}-scrollbar-rail--disabled`):He.classList.add(`${Re}-scrollbar-rail--disabled`))}),onMounted(()=>{e.container||Je()}),onBeforeUnmount(()=>{I!==void 0&&window.clearTimeout(I),O!==void 0&&window.clearTimeout(O),off$1("mousemove",window,mt,!0),off$1("mouseup",window,Vt,!0)});const bt=computed(()=>{const{common:{cubicBezierEaseInOut:tt},self:{color:ut,colorHover:Re,height:Te,width:He,borderRadius:Fe,railInsetHorizontalTop:ze,railInsetHorizontalBottom:We,railInsetVerticalRight:Ue,railInsetVerticalLeft:et,railColor:it}}=ve.value,{top:nt,right:dt,bottom:xt,left:yt}=getMargin(ze),{top:Bt,right:Pt,bottom:Tt,left:ct}=getMargin(We),{top:wt,right:St,bottom:Ft,left:Gt}=getMargin(u!=null&&u.value?rtlInset(Ue):Ue),{top:jt,right:Ut,bottom:Jt,left:un}=getMargin(u!=null&&u.value?rtlInset(et):et);return{"--n-scrollbar-bezier":tt,"--n-scrollbar-color":ut,"--n-scrollbar-color-hover":Re,"--n-scrollbar-border-radius":Fe,"--n-scrollbar-width":He,"--n-scrollbar-height":Te,"--n-scrollbar-rail-top-horizontal-top":nt,"--n-scrollbar-rail-right-horizontal-top":dt,"--n-scrollbar-rail-bottom-horizontal-top":xt,"--n-scrollbar-rail-left-horizontal-top":yt,"--n-scrollbar-rail-top-horizontal-bottom":Bt,"--n-scrollbar-rail-right-horizontal-bottom":Pt,"--n-scrollbar-rail-bottom-horizontal-bottom":Tt,"--n-scrollbar-rail-left-horizontal-bottom":ct,"--n-scrollbar-rail-top-vertical-right":wt,"--n-scrollbar-rail-right-vertical-right":St,"--n-scrollbar-rail-bottom-vertical-right":Ft,"--n-scrollbar-rail-left-vertical-right":Gt,"--n-scrollbar-rail-top-vertical-left":jt,"--n-scrollbar-rail-right-vertical-left":Ut,"--n-scrollbar-rail-bottom-vertical-left":Jt,"--n-scrollbar-rail-left-vertical-left":un,"--n-scrollbar-rail-color":it}}),ot=o?useThemeClass("scrollbar",void 0,bt,e):void 0;return Object.assign(Object.assign({},{scrollTo:$e,scrollBy:le,sync:Je,syncUnifiedContainer:Ke,handleMouseEnterWrapper:ke,handleMouseLeaveWrapper:Ce}),{mergedClsPrefix:n,rtlEnabled:u,containerScrollTop:S,wrapperRef:s,containerRef:w,contentRef:m,yRailRef:v,xRailRef:g,needYBar:Q,needXBar:re,yBarSizePx:fe,xBarSizePx:j,yBarTopPx:H,xBarLeftPx:te,isShowXBar:Pe,isShowYBar:be,isIos:ne,handleScroll:Ge,handleContentResize:Ie,handleContainerResize:Le,handleYScrollMouseDown:kt,handleXScrollMouseDown:ht,cssVars:o?void 0:bt,themeClass:ot==null?void 0:ot.themeClass,onRender:ot==null?void 0:ot.onRender})},render(){var e;const{$slots:n,mergedClsPrefix:o,triggerDisplayManually:r,rtlEnabled:u,internalHoistYRail:s,yPlacement:w,xPlacement:m,xScrollable:v}=this;if(!this.scrollable)return(e=n.default)===null||e===void 0?void 0:e.call(n);const g=this.trigger==="none",d=(x,k)=>h$1("div",{ref:"yRailRef",class:[`${o}-scrollbar-rail`,`${o}-scrollbar-rail--vertical`,`${o}-scrollbar-rail--vertical--${w}`,x],"data-scrollbar-rail":!0,style:[k||"",this.verticalRailStyle],"aria-hidden":!0},h$1(g?Wrapper:Transition,g?null:{name:"fade-in-transition"},{default:()=>this.needYBar&&this.isShowYBar&&!this.isIos?h$1("div",{class:`${o}-scrollbar-rail__scrollbar`,style:{height:this.yBarSizePx,top:this.yBarTopPx},onMousedown:this.handleYScrollMouseDown}):null})),f=()=>{var x,k;return(x=this.onRender)===null||x===void 0||x.call(this),h$1("div",mergeProps(this.$attrs,{role:"none",ref:"wrapperRef",class:[`${o}-scrollbar`,this.themeClass,u&&`${o}-scrollbar--rtl`],style:this.cssVars,onMouseenter:r?void 0:this.handleMouseEnterWrapper,onMouseleave:r?void 0:this.handleMouseLeaveWrapper}),[this.container?(k=n.default)===null||k===void 0?void 0:k.call(n):h$1("div",{role:"none",ref:"containerRef",class:[`${o}-scrollbar-container`,this.containerClass],style:this.containerStyle,onScroll:this.handleScroll,onWheel:this.onWheel},h$1(VResizeObserver,{onResize:this.handleContentResize},{default:()=>h$1("div",{ref:"contentRef",role:"none",style:[{width:this.xScrollable?"fit-content":null},this.contentStyle],class:[`${o}-scrollbar-content`,this.contentClass]},n)})),s?null:d(void 0,void 0),v&&h$1("div",{ref:"xRailRef",class:[`${o}-scrollbar-rail`,`${o}-scrollbar-rail--horizontal`,`${o}-scrollbar-rail--horizontal--${m}`],style:this.horizontalRailStyle,"data-scrollbar-rail":!0,"aria-hidden":!0},h$1(g?Wrapper:Transition,g?null:{name:"fade-in-transition"},{default:()=>this.needXBar&&this.isShowXBar&&!this.isIos?h$1("div",{class:`${o}-scrollbar-rail__scrollbar`,style:{width:this.xBarSizePx,right:u?this.xBarLeftPx:void 0,left:u?void 0:this.xBarLeftPx},onMousedown:this.handleXScrollMouseDown}):null}))])},y=this.container?f():h$1(VResizeObserver,{onResize:this.handleContainerResize},{default:f});return s?h$1(Fragment,null,y,d(this.themeClass,this.cssVars)):y}}),NScrollbar=Scrollbar,XScrollbar=Scrollbar;function toArray$1(e){return Array.isArray(e)?e:[e]}const TRAVERSE_COMMAND={STOP:"STOP"};function traverseWithCb(e,n){const o=n(e);e.children!==void 0&&o!==TRAVERSE_COMMAND.STOP&&e.children.forEach(r=>traverseWithCb(r,n))}function getNonLeafKeys(e,n={}){const{preserveGroup:o=!1}=n,r=[],u=o?w=>{w.isLeaf||(r.push(w.key),s(w.children))}:w=>{w.isLeaf||(w.isGroup||r.push(w.key),s(w.children))};function s(w){w.forEach(u)}return s(e),r}function isLeaf(e,n){const{isLeaf:o}=e;return o!==void 0?o:!n(e)}function defaultGetChildren(e){return e.children}function defaultGetKey(e){return e.key}function isIgnored(){return!1}function isShallowLoaded(e,n){const{isLeaf:o}=e;return!(o===!1&&!Array.isArray(n(e)))}function isDisabled(e){return e.disabled===!0}function isExpilicitlyNotLoaded(e,n){return e.isLeaf===!1&&!Array.isArray(n(e))}function unwrapCheckedKeys(e){var n;return e==null?[]:Array.isArray(e)?e:(n=e.checkedKeys)!==null&&n!==void 0?n:[]}function unwrapIndeterminateKeys(e){var n;return e==null||Array.isArray(e)?[]:(n=e.indeterminateKeys)!==null&&n!==void 0?n:[]}function merge$1(e,n){const o=new Set(e);return n.forEach(r=>{o.has(r)||o.add(r)}),Array.from(o)}function minus(e,n){const o=new Set(e);return n.forEach(r=>{o.has(r)&&o.delete(r)}),Array.from(o)}function isGroup(e){return(e==null?void 0:e.type)==="group"}function createIndexGetter(e){const n=new Map;return e.forEach((o,r)=>{n.set(o.key,r)}),o=>{var r;return(r=n.get(o))!==null&&r!==void 0?r:null}}class SubtreeNotLoadedError extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function getExtendedCheckedKeySetAfterCheck(e,n,o,r){return getExtendedCheckedKeySet(n.concat(e),o,r,!1)}function getAvailableAscendantNodeSet(e,n){const o=new Set;return e.forEach(r=>{const u=n.treeNodeMap.get(r);if(u!==void 0){let s=u.parent;for(;s!==null&&!(s.disabled||o.has(s.key));)o.add(s.key),s=s.parent}}),o}function getExtendedCheckedKeySetAfterUncheck(e,n,o,r){const u=getExtendedCheckedKeySet(n,o,r,!1),s=getExtendedCheckedKeySet(e,o,r,!0),w=getAvailableAscendantNodeSet(e,o),m=[];return u.forEach(v=>{(s.has(v)||w.has(v))&&m.push(v)}),m.forEach(v=>u.delete(v)),u}function getCheckedKeys(e,n){const{checkedKeys:o,keysToCheck:r,keysToUncheck:u,indeterminateKeys:s,cascade:w,leafOnly:m,checkStrategy:v,allowNotLoaded:g}=e;if(!w)return r!==void 0?{checkedKeys:merge$1(o,r),indeterminateKeys:Array.from(s)}:u!==void 0?{checkedKeys:minus(o,u),indeterminateKeys:Array.from(s)}:{checkedKeys:Array.from(o),indeterminateKeys:Array.from(s)};const{levelTreeNodeMap:d}=n;let f;u!==void 0?f=getExtendedCheckedKeySetAfterUncheck(u,o,n,g):r!==void 0?f=getExtendedCheckedKeySetAfterCheck(r,o,n,g):f=getExtendedCheckedKeySet(o,n,g,!1);const y=v==="parent",x=v==="child"||m,k=f,P=new Set,S=Math.max.apply(null,Array.from(d.keys()));for(let E=S;E>=0;E-=1){const M=E===0,T=d.get(E);for(const D of T){if(D.isLeaf)continue;const{key:N,shallowLoaded:I}=D;if(x&&I&&D.children.forEach(Y=>{!Y.disabled&&!Y.isLeaf&&Y.shallowLoaded&&k.has(Y.key)&&k.delete(Y.key)}),D.disabled||!I)continue;let O=!0,F=!1,q=!0;for(const Y of D.children){const _e=Y.key;if(!Y.disabled){if(q&&(q=!1),k.has(_e))F=!0;else if(P.has(_e)){F=!0,O=!1;break}else if(O=!1,F)break}}O&&!q?(y&&D.children.forEach(Y=>{!Y.disabled&&k.has(Y.key)&&k.delete(Y.key)}),k.add(N)):F&&P.add(N),M&&x&&k.has(N)&&k.delete(N)}}return{checkedKeys:Array.from(k),indeterminateKeys:Array.from(P)}}function getExtendedCheckedKeySet(e,n,o,r){const{treeNodeMap:u,getChildren:s}=n,w=new Set,m=new Set(e);return e.forEach(v=>{const g=u.get(v);g!==void 0&&traverseWithCb(g,d=>{if(d.disabled)return TRAVERSE_COMMAND.STOP;const{key:f}=d;if(!w.has(f)&&(w.add(f),m.add(f),isExpilicitlyNotLoaded(d.rawNode,s))){if(r)return TRAVERSE_COMMAND.STOP;if(!o)throw new SubtreeNotLoadedError}})}),m}function getPath(e,{includeGroup:n=!1,includeSelf:o=!0},r){var u;const s=r.treeNodeMap;let w=e==null?null:(u=s.get(e))!==null&&u!==void 0?u:null;const m={keyPath:[],treeNodePath:[],treeNode:w};if(w!=null&&w.ignored)return m.treeNode=null,m;for(;w;)!w.ignored&&(n||!w.isGroup)&&m.treeNodePath.push(w),w=w.parent;return m.treeNodePath.reverse(),o||m.treeNodePath.pop(),m.keyPath=m.treeNodePath.map(v=>v.key),m}function getFirstAvailableNode(e){if(e.length===0)return null;const n=e[0];return n.isGroup||n.ignored||n.disabled?n.getNext():n}function rawGetNext(e,n){const o=e.siblings,r=o.length,{index:u}=e;return n?o[(u+1)%r]:u===o.length-1?null:o[u+1]}function move(e,n,{loop:o=!1,includeDisabled:r=!1}={}){const u=n==="prev"?rawGetPrev:rawGetNext,s={reverse:n==="prev"};let w=!1,m=null;function v(g){if(g!==null){if(g===e){if(!w)w=!0;else if(!e.disabled&&!e.isGroup){m=e;return}}else if((!g.disabled||r)&&!g.ignored&&!g.isGroup){m=g;return}if(g.isGroup){const d=getChild$1(g,s);d!==null?m=d:v(u(g,o))}else{const d=u(g,!1);if(d!==null)v(d);else{const f=rawGetParent(g);f!=null&&f.isGroup?v(u(f,o)):o&&v(u(g,!0))}}}}return v(e),m}function rawGetPrev(e,n){const o=e.siblings,r=o.length,{index:u}=e;return n?o[(u-1+r)%r]:u===0?null:o[u-1]}function rawGetParent(e){return e.parent}function getChild$1(e,n={}){const{reverse:o=!1}=n,{children:r}=e;if(r){const{length:u}=r,s=o?u-1:0,w=o?-1:u,m=o?-1:1;for(let v=s;v!==w;v+=m){const g=r[v];if(!g.disabled&&!g.ignored)if(g.isGroup){const d=getChild$1(g,n);if(d!==null)return d}else return g}}return null}const moveMethods={getChild(){return this.ignored?null:getChild$1(this)},getParent(){const{parent:e}=this;return e!=null&&e.isGroup?e.getParent():e},getNext(e={}){return move(this,"next",e)},getPrev(e={}){return move(this,"prev",e)}};function flatten(e,n){const o=n?new Set(n):void 0,r=[];function u(s){s.forEach(w=>{r.push(w),!(w.isLeaf||!w.children||w.ignored)&&(w.isGroup||o===void 0||o.has(w.key))&&u(w.children)})}return u(e),r}function contains(e,n){const o=e.key;for(;n;){if(n.key===o)return!0;n=n.parent}return!1}function createTreeNodes(e,n,o,r,u,s=null,w=0){const m=[];return e.forEach((v,g)=>{var d;const f=Object.create(r);if(f.rawNode=v,f.siblings=m,f.level=w,f.index=g,f.isFirstChild=g===0,f.isLastChild=g+1===e.length,f.parent=s,!f.ignored){const y=u(v);Array.isArray(y)&&(f.children=createTreeNodes(y,n,o,r,u,f,w+1))}m.push(f),n.set(f.key,f),o.has(w)||o.set(w,[]),(d=o.get(w))===null||d===void 0||d.push(f)}),m}function createTreeMate(e,n={}){var o;const r=new Map,u=new Map,{getDisabled:s=isDisabled,getIgnored:w=isIgnored,getIsGroup:m=isGroup,getKey:v=defaultGetKey}=n,g=(o=n.getChildren)!==null&&o!==void 0?o:defaultGetChildren,d=n.ignoreEmptyChildren?D=>{const N=g(D);return Array.isArray(N)?N.length?N:null:N}:g,f=Object.assign({get key(){return v(this.rawNode)},get disabled(){return s(this.rawNode)},get isGroup(){return m(this.rawNode)},get isLeaf(){return isLeaf(this.rawNode,d)},get shallowLoaded(){return isShallowLoaded(this.rawNode,d)},get ignored(){return w(this.rawNode)},contains(D){return contains(this,D)}},moveMethods),y=createTreeNodes(e,r,u,f,d);function x(D){if(D==null)return null;const N=r.get(D);return N&&!N.isGroup&&!N.ignored?N:null}function k(D){if(D==null)return null;const N=r.get(D);return N&&!N.ignored?N:null}function P(D,N){const I=k(D);return I?I.getPrev(N):null}function S(D,N){const I=k(D);return I?I.getNext(N):null}function E(D){const N=k(D);return N?N.getParent():null}function M(D){const N=k(D);return N?N.getChild():null}const T={treeNodes:y,treeNodeMap:r,levelTreeNodeMap:u,maxLevel:Math.max(...u.keys()),getChildren:d,getFlattenedNodes(D){return flatten(y,D)},getNode:x,getPrev:P,getNext:S,getParent:E,getChild:M,getFirstAvailableNode(){return getFirstAvailableNode(y)},getPath(D,N={}){return getPath(D,N,T)},getCheckedKeys(D,N={}){const{cascade:I=!0,leafOnly:O=!1,checkStrategy:F="all",allowNotLoaded:q=!1}=N;return getCheckedKeys({checkedKeys:unwrapCheckedKeys(D),indeterminateKeys:unwrapIndeterminateKeys(D),cascade:I,leafOnly:O,checkStrategy:F,allowNotLoaded:q},T)},check(D,N,I={}){const{cascade:O=!0,leafOnly:F=!1,checkStrategy:q="all",allowNotLoaded:Y=!1}=I;return getCheckedKeys({checkedKeys:unwrapCheckedKeys(N),indeterminateKeys:unwrapIndeterminateKeys(N),keysToCheck:D==null?[]:toArray$1(D),cascade:O,leafOnly:F,checkStrategy:q,allowNotLoaded:Y},T)},uncheck(D,N,I={}){const{cascade:O=!0,leafOnly:F=!1,checkStrategy:q="all",allowNotLoaded:Y=!1}=I;return getCheckedKeys({checkedKeys:unwrapCheckedKeys(N),indeterminateKeys:unwrapIndeterminateKeys(N),keysToUncheck:D==null?[]:toArray$1(D),cascade:O,leafOnly:F,checkStrategy:q,allowNotLoaded:Y},T)},getNonLeafKeys(D={}){return getNonLeafKeys(y,D)}};return T}const commonVars$4={iconSizeTiny:"28px",iconSizeSmall:"34px",iconSizeMedium:"40px",iconSizeLarge:"46px",iconSizeHuge:"52px"};function self$k(e){const{textColorDisabled:n,iconColor:o,textColor2:r,fontSizeTiny:u,fontSizeSmall:s,fontSizeMedium:w,fontSizeLarge:m,fontSizeHuge:v}=e;return Object.assign(Object.assign({},commonVars$4),{fontSizeTiny:u,fontSizeSmall:s,fontSizeMedium:w,fontSizeLarge:m,fontSizeHuge:v,textColor:n,iconColor:o,extraTextColor:r})}const emptyLight={name:"Empty",common:commonLight,self:self$k},emptyLight$1=emptyLight,style$k=cB("empty",`
 display: flex;
 flex-direction: column;
 align-items: center;
 font-size: var(--n-font-size);
`,[cE("icon",`
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 line-height: var(--n-icon-size);
 color: var(--n-icon-color);
 transition:
 color .3s var(--n-bezier);
 `,[c$1("+",[cE("description",`
 margin-top: 8px;
 `)])]),cE("description",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),cE("extra",`
 text-align: center;
 transition: color .3s var(--n-bezier);
 margin-top: 12px;
 color: var(--n-extra-text-color);
 `)]),emptyProps=Object.assign(Object.assign({},useTheme.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),NEmpty=defineComponent({name:"Empty",props:emptyProps,slots:Object,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:o,mergedComponentPropsRef:r}=useConfig(e),u=useTheme("Empty","-empty",style$k,emptyLight$1,e,n),{localeRef:s}=useLocale("Empty"),w=computed(()=>{var d,f,y;return(d=e.description)!==null&&d!==void 0?d:(y=(f=r==null?void 0:r.value)===null||f===void 0?void 0:f.Empty)===null||y===void 0?void 0:y.description}),m=computed(()=>{var d,f;return((f=(d=r==null?void 0:r.value)===null||d===void 0?void 0:d.Empty)===null||f===void 0?void 0:f.renderIcon)||(()=>h$1(EmptyIcon,null))}),v=computed(()=>{const{size:d}=e,{common:{cubicBezierEaseInOut:f},self:{[createKey("iconSize",d)]:y,[createKey("fontSize",d)]:x,textColor:k,iconColor:P,extraTextColor:S}}=u.value;return{"--n-icon-size":y,"--n-font-size":x,"--n-bezier":f,"--n-text-color":k,"--n-icon-color":P,"--n-extra-text-color":S}}),g=o?useThemeClass("empty",computed(()=>{let d="";const{size:f}=e;return d+=f[0],d}),v,e):void 0;return{mergedClsPrefix:n,mergedRenderIcon:m,localizedDescription:computed(()=>w.value||s.value.description),cssVars:o?void 0:v,themeClass:g==null?void 0:g.themeClass,onRender:g==null?void 0:g.onRender}},render(){const{$slots:e,mergedClsPrefix:n,onRender:o}=this;return o==null||o(),h$1("div",{class:[`${n}-empty`,this.themeClass],style:this.cssVars},this.showIcon?h$1("div",{class:`${n}-empty__icon`},e.icon?e.icon():h$1(NBaseIcon,{clsPrefix:n},{default:this.mergedRenderIcon})):null,this.showDescription?h$1("div",{class:`${n}-empty__description`},e.default?e.default():this.localizedDescription):null,e.extra?h$1("div",{class:`${n}-empty__extra`},e.extra()):null)}}),commonVariables$7={height:"calc(var(--n-option-height) * 7.6)",paddingTiny:"4px 0",paddingSmall:"4px 0",paddingMedium:"4px 0",paddingLarge:"4px 0",paddingHuge:"4px 0",optionPaddingTiny:"0 12px",optionPaddingSmall:"0 12px",optionPaddingMedium:"0 12px",optionPaddingLarge:"0 12px",optionPaddingHuge:"0 12px",loadingSize:"18px"};function self$j(e){const{borderRadius:n,popoverColor:o,textColor3:r,dividerColor:u,textColor2:s,primaryColorPressed:w,textColorDisabled:m,primaryColor:v,opacityDisabled:g,hoverColor:d,fontSizeTiny:f,fontSizeSmall:y,fontSizeMedium:x,fontSizeLarge:k,fontSizeHuge:P,heightTiny:S,heightSmall:E,heightMedium:M,heightLarge:T,heightHuge:D}=e;return Object.assign(Object.assign({},commonVariables$7),{optionFontSizeTiny:f,optionFontSizeSmall:y,optionFontSizeMedium:x,optionFontSizeLarge:k,optionFontSizeHuge:P,optionHeightTiny:S,optionHeightSmall:E,optionHeightMedium:M,optionHeightLarge:T,optionHeightHuge:D,borderRadius:n,color:o,groupHeaderTextColor:r,actionDividerColor:u,optionTextColor:s,optionTextColorPressed:w,optionTextColorDisabled:m,optionTextColorActive:v,optionOpacityDisabled:g,optionCheckColor:v,optionColorPending:d,optionColorActive:"rgba(0, 0, 0, 0)",optionColorActivePending:d,actionTextColor:s,loadingColor:v})}const internalSelectMenuLight={name:"InternalSelectMenu",common:commonLight,peers:{Scrollbar:scrollbarLight$1,Empty:emptyLight$1},self:self$j},internalSelectMenuLight$1=internalSelectMenuLight,NSelectGroupHeader=defineComponent({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:n,labelFieldRef:o,nodePropsRef:r}=inject(internalSelectionMenuInjectionKey);return{labelField:o,nodeProps:r,renderLabel:e,renderOption:n}},render(){const{clsPrefix:e,renderLabel:n,renderOption:o,nodeProps:r,tmNode:{rawNode:u}}=this,s=r==null?void 0:r(u),w=n?n(u,!1):render(u[this.labelField],u,!1),m=h$1("div",Object.assign({},s,{class:[`${e}-base-select-group-header`,s==null?void 0:s.class]}),w);return u.render?u.render({node:m,option:u}):o?o({node:m,option:u,selected:!1}):m}});function renderCheckMark(e,n){return h$1(Transition,{name:"fade-in-scale-up-transition"},{default:()=>e?h$1(NBaseIcon,{clsPrefix:n,class:`${n}-base-select-option__check`},{default:()=>h$1(FinishedIcon)}):null})}const NSelectOption=defineComponent({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:n,pendingTmNodeRef:o,multipleRef:r,valueSetRef:u,renderLabelRef:s,renderOptionRef:w,labelFieldRef:m,valueFieldRef:v,showCheckmarkRef:g,nodePropsRef:d,handleOptionClick:f,handleOptionMouseEnter:y}=inject(internalSelectionMenuInjectionKey),x=useMemo(()=>{const{value:E}=o;return E?e.tmNode.key===E.key:!1});function k(E){const{tmNode:M}=e;M.disabled||f(E,M)}function P(E){const{tmNode:M}=e;M.disabled||y(E,M)}function S(E){const{tmNode:M}=e,{value:T}=x;M.disabled||T||y(E,M)}return{multiple:r,isGrouped:useMemo(()=>{const{tmNode:E}=e,{parent:M}=E;return M&&M.rawNode.type==="group"}),showCheckmark:g,nodeProps:d,isPending:x,isSelected:useMemo(()=>{const{value:E}=n,{value:M}=r;if(E===null)return!1;const T=e.tmNode.rawNode[v.value];if(M){const{value:D}=u;return D.has(T)}else return E===T}),labelField:m,renderLabel:s,renderOption:w,handleMouseMove:S,handleMouseEnter:P,handleClick:k}},render(){const{clsPrefix:e,tmNode:{rawNode:n},isSelected:o,isPending:r,isGrouped:u,showCheckmark:s,nodeProps:w,renderOption:m,renderLabel:v,handleClick:g,handleMouseEnter:d,handleMouseMove:f}=this,y=renderCheckMark(o,e),x=v?[v(n,o),s&&y]:[render(n[this.labelField],n,o),s&&y],k=w==null?void 0:w(n),P=h$1("div",Object.assign({},k,{class:[`${e}-base-select-option`,n.class,k==null?void 0:k.class,{[`${e}-base-select-option--disabled`]:n.disabled,[`${e}-base-select-option--selected`]:o,[`${e}-base-select-option--grouped`]:u,[`${e}-base-select-option--pending`]:r,[`${e}-base-select-option--show-checkmark`]:s}],style:[(k==null?void 0:k.style)||"",n.style||""],onClick:mergeEventHandlers([g,k==null?void 0:k.onClick]),onMouseenter:mergeEventHandlers([d,k==null?void 0:k.onMouseenter]),onMousemove:mergeEventHandlers([f,k==null?void 0:k.onMousemove])}),h$1("div",{class:`${e}-base-select-option__content`},x));return n.render?n.render({node:P,option:n,selected:o}):m?m({node:P,option:n,selected:o}):P}}),{cubicBezierEaseIn:cubicBezierEaseIn$1,cubicBezierEaseOut:cubicBezierEaseOut$1}=commonVariables$8;function fadeInScaleUpTransition({transformOrigin:e="inherit",duration:n=".2s",enterScale:o=".9",originalTransform:r="",originalTransition:u=""}={}){return[c$1("&.fade-in-scale-up-transition-leave-active",{transformOrigin:e,transition:`opacity ${n} ${cubicBezierEaseIn$1}, transform ${n} ${cubicBezierEaseIn$1} ${u&&`,${u}`}`}),c$1("&.fade-in-scale-up-transition-enter-active",{transformOrigin:e,transition:`opacity ${n} ${cubicBezierEaseOut$1}, transform ${n} ${cubicBezierEaseOut$1} ${u&&`,${u}`}`}),c$1("&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to",{opacity:0,transform:`${r} scale(${o})`}),c$1("&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to",{opacity:1,transform:`${r} scale(1)`})]}const style$j=cB("base-select-menu",`
 line-height: 1.5;
 outline: none;
 z-index: 0;
 position: relative;
 border-radius: var(--n-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-color);
`,[cB("scrollbar",`
 max-height: var(--n-height);
 `),cB("virtual-list",`
 max-height: var(--n-height);
 `),cB("base-select-option",`
 min-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 display: flex;
 align-items: center;
 `,[cE("content",`
 z-index: 1;
 white-space: nowrap;
 text-overflow: ellipsis;
 overflow: hidden;
 `)]),cB("base-select-group-header",`
 min-height: var(--n-option-height);
 font-size: .93em;
 display: flex;
 align-items: center;
 `),cB("base-select-menu-option-wrapper",`
 position: relative;
 width: 100%;
 `),cE("loading, empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),cE("loading",`
 color: var(--n-loading-color);
 font-size: var(--n-loading-size);
 `),cE("header",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),cE("action",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),cB("base-select-group-header",`
 position: relative;
 cursor: default;
 padding: var(--n-option-padding);
 color: var(--n-group-header-text-color);
 `),cB("base-select-option",`
 cursor: pointer;
 position: relative;
 padding: var(--n-option-padding);
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 box-sizing: border-box;
 color: var(--n-option-text-color);
 opacity: 1;
 `,[cM("show-checkmark",`
 padding-right: calc(var(--n-option-padding-right) + 20px);
 `),c$1("&::before",`
 content: "";
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),c$1("&:active",`
 color: var(--n-option-text-color-pressed);
 `),cM("grouped",`
 padding-left: calc(var(--n-option-padding-left) * 1.5);
 `),cM("pending",[c$1("&::before",`
 background-color: var(--n-option-color-pending);
 `)]),cM("selected",`
 color: var(--n-option-text-color-active);
 `,[c$1("&::before",`
 background-color: var(--n-option-color-active);
 `),cM("pending",[c$1("&::before",`
 background-color: var(--n-option-color-active-pending);
 `)])]),cM("disabled",`
 cursor: not-allowed;
 `,[cNotM("selected",`
 color: var(--n-option-text-color-disabled);
 `),cM("selected",`
 opacity: var(--n-option-opacity-disabled);
 `)]),cE("check",`
 font-size: 16px;
 position: absolute;
 right: calc(var(--n-option-padding-right) - 4px);
 top: calc(50% - 7px);
 color: var(--n-option-check-color);
 transition: color .3s var(--n-bezier);
 `,[fadeInScaleUpTransition({enterScale:"0.5"})])])]),NInternalSelectMenu=defineComponent({name:"InternalSelectMenu",props:Object.assign(Object.assign({},useTheme.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(e){const{mergedClsPrefixRef:n,mergedRtlRef:o}=useConfig(e),r=useRtl("InternalSelectMenu",o,n),u=useTheme("InternalSelectMenu","-internal-select-menu",style$j,internalSelectMenuLight$1,e,toRef(e,"clsPrefix")),s=ref(null),w=ref(null),m=ref(null),v=computed(()=>e.treeMate.getFlattenedNodes()),g=computed(()=>createIndexGetter(v.value)),d=ref(null);function f(){const{treeMate:Q}=e;let re=null;const{value:Pe}=e;Pe===null?re=Q.getFirstAvailableNode():(e.multiple?re=Q.getNode((Pe||[])[(Pe||[]).length-1]):re=Q.getNode(Pe),(!re||re.disabled)&&(re=Q.getFirstAvailableNode())),J(re||null)}function y(){const{value:Q}=d;Q&&!e.treeMate.getNode(Q.key)&&(d.value=null)}let x;watch(()=>e.show,Q=>{Q?x=watch(()=>e.treeMate,()=>{e.resetMenuOnOptionsChange?(e.autoPending?f():y(),nextTick(fe)):y()},{immediate:!0}):x==null||x()},{immediate:!0}),onBeforeUnmount(()=>{x==null||x()});const k=computed(()=>depx(u.value.self[createKey("optionHeight",e.size)])),P=computed(()=>getMargin(u.value.self[createKey("padding",e.size)])),S=computed(()=>e.multiple&&Array.isArray(e.value)?new Set(e.value):new Set),E=computed(()=>{const Q=v.value;return Q&&Q.length===0});function M(Q){const{onToggle:re}=e;re&&re(Q)}function T(Q){const{onScroll:re}=e;re&&re(Q)}function D(Q){var re;(re=m.value)===null||re===void 0||re.sync(),T(Q)}function N(){var Q;(Q=m.value)===null||Q===void 0||Q.sync()}function I(){const{value:Q}=d;return Q||null}function O(Q,re){re.disabled||J(re,!1)}function F(Q,re){re.disabled||M(re)}function q(Q){var re;happensIn(Q,"action")||(re=e.onKeyup)===null||re===void 0||re.call(e,Q)}function Y(Q){var re;happensIn(Q,"action")||(re=e.onKeydown)===null||re===void 0||re.call(e,Q)}function _e(Q){var re;(re=e.onMousedown)===null||re===void 0||re.call(e,Q),!e.focusable&&Q.preventDefault()}function ne(){const{value:Q}=d;Q&&J(Q.getNext({loop:!0}),!0)}function ve(){const{value:Q}=d;Q&&J(Q.getPrev({loop:!0}),!0)}function J(Q,re=!1){d.value=Q,re&&fe()}function fe(){var Q,re;const Pe=d.value;if(!Pe)return;const be=g.value(Pe.key);be!==null&&(e.virtualScroll?(Q=w.value)===null||Q===void 0||Q.scrollTo({index:be}):(re=m.value)===null||re===void 0||re.scrollTo({index:be,elSize:k.value}))}function Z(Q){var re,Pe;!((re=s.value)===null||re===void 0)&&re.contains(Q.target)&&((Pe=e.onFocus)===null||Pe===void 0||Pe.call(e,Q))}function j(Q){var re,Pe;!((re=s.value)===null||re===void 0)&&re.contains(Q.relatedTarget)||(Pe=e.onBlur)===null||Pe===void 0||Pe.call(e,Q)}provide(internalSelectionMenuInjectionKey,{handleOptionMouseEnter:O,handleOptionClick:F,valueSetRef:S,pendingTmNodeRef:d,nodePropsRef:toRef(e,"nodeProps"),showCheckmarkRef:toRef(e,"showCheckmark"),multipleRef:toRef(e,"multiple"),valueRef:toRef(e,"value"),renderLabelRef:toRef(e,"renderLabel"),renderOptionRef:toRef(e,"renderOption"),labelFieldRef:toRef(e,"labelField"),valueFieldRef:toRef(e,"valueField")}),provide(internalSelectionMenuBodyInjectionKey,s),onMounted(()=>{const{value:Q}=m;Q&&Q.sync()});const X=computed(()=>{const{size:Q}=e,{common:{cubicBezierEaseInOut:re},self:{height:Pe,borderRadius:be,color:we,groupHeaderTextColor:Ae,actionDividerColor:$e,optionTextColorPressed:Me,optionTextColor:Ie,optionTextColorDisabled:Le,optionTextColorActive:le,optionOpacityDisabled:oe,optionCheckColor:ke,actionTextColor:Ce,optionColorPending:Ee,optionColorActive:Be,loadingColor:Ve,loadingSize:Oe,optionColorActivePending:je,[createKey("optionFontSize",Q)]:Ge,[createKey("optionHeight",Q)]:Xe,[createKey("optionPadding",Q)]:qe}}=u.value;return{"--n-height":Pe,"--n-action-divider-color":$e,"--n-action-text-color":Ce,"--n-bezier":re,"--n-border-radius":be,"--n-color":we,"--n-option-font-size":Ge,"--n-group-header-text-color":Ae,"--n-option-check-color":ke,"--n-option-color-pending":Ee,"--n-option-color-active":Be,"--n-option-color-active-pending":je,"--n-option-height":Xe,"--n-option-opacity-disabled":oe,"--n-option-text-color":Ie,"--n-option-text-color-active":le,"--n-option-text-color-disabled":Le,"--n-option-text-color-pressed":Me,"--n-option-padding":qe,"--n-option-padding-left":getMargin(qe,"left"),"--n-option-padding-right":getMargin(qe,"right"),"--n-loading-color":Ve,"--n-loading-size":Oe}}),{inlineThemeDisabled:H}=e,U=H?useThemeClass("internal-select-menu",computed(()=>e.size[0]),X,e):void 0,te={selfRef:s,next:ne,prev:ve,getPendingTmNode:I};return useOnResize(s,e.onResize),Object.assign({mergedTheme:u,mergedClsPrefix:n,rtlEnabled:r,virtualListRef:w,scrollbarRef:m,itemSize:k,padding:P,flattenedNodes:v,empty:E,virtualListContainer(){const{value:Q}=w;return Q==null?void 0:Q.listElRef},virtualListContent(){const{value:Q}=w;return Q==null?void 0:Q.itemsElRef},doScroll:T,handleFocusin:Z,handleFocusout:j,handleKeyUp:q,handleKeyDown:Y,handleMouseDown:_e,handleVirtualListResize:N,handleVirtualListScroll:D,cssVars:H?void 0:X,themeClass:U==null?void 0:U.themeClass,onRender:U==null?void 0:U.onRender},te)},render(){const{$slots:e,virtualScroll:n,clsPrefix:o,mergedTheme:r,themeClass:u,onRender:s}=this;return s==null||s(),h$1("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${o}-base-select-menu`,this.rtlEnabled&&`${o}-base-select-menu--rtl`,u,this.multiple&&`${o}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},resolveWrappedSlot(e.header,w=>w&&h$1("div",{class:`${o}-base-select-menu__header`,"data-header":!0,key:"header"},w)),this.loading?h$1("div",{class:`${o}-base-select-menu__loading`},h$1(NBaseLoading,{clsPrefix:o,strokeWidth:20})):this.empty?h$1("div",{class:`${o}-base-select-menu__empty`,"data-empty":!0},resolveSlot(e.empty,()=>[h$1(NEmpty,{theme:r.peers.Empty,themeOverrides:r.peerOverrides.Empty,size:this.size})])):h$1(NScrollbar,{ref:"scrollbarRef",theme:r.peers.Scrollbar,themeOverrides:r.peerOverrides.Scrollbar,scrollable:this.scrollable,container:n?this.virtualListContainer:void 0,content:n?this.virtualListContent:void 0,onScroll:n?void 0:this.doScroll},{default:()=>n?h$1(VVirtualList,{ref:"virtualListRef",class:`${o}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:w})=>w.isGroup?h$1(NSelectGroupHeader,{key:w.key,clsPrefix:o,tmNode:w}):w.ignored?null:h$1(NSelectOption,{clsPrefix:o,key:w.key,tmNode:w})}):h$1("div",{class:`${o}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map(w=>w.isGroup?h$1(NSelectGroupHeader,{key:w.key,clsPrefix:o,tmNode:w}):h$1(NSelectOption,{clsPrefix:o,key:w.key,tmNode:w})))}),resolveWrappedSlot(e.action,w=>w&&[h$1("div",{class:`${o}-base-select-menu__action`,"data-action":!0,key:"action"},w),h$1(FocusDetector,{onFocus:this.onTabOut,key:"focus-detector"})]))}}),commonVariables$6={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"};function self$i(e){const{boxShadow2:n,popoverColor:o,textColor2:r,borderRadius:u,fontSize:s,dividerColor:w}=e;return Object.assign(Object.assign({},commonVariables$6),{fontSize:s,borderRadius:u,color:o,dividerColor:w,textColor:r,boxShadow:n})}const popoverLight={name:"Popover",common:commonLight,self:self$i},popoverLight$1=popoverLight,oppositePlacement={top:"bottom",bottom:"top",left:"right",right:"left"},arrowSize="var(--n-arrow-height) * 1.414",style$i=c$1([cB("popover",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 position: relative;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 box-shadow: var(--n-box-shadow);
 word-break: break-word;
 `,[c$1(">",[cB("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),cNotM("raw",`
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 `,[cNotM("scrollable",[cNotM("show-header-or-footer","padding: var(--n-padding);")])]),cE("header",`
 padding: var(--n-padding);
 border-bottom: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),cE("footer",`
 padding: var(--n-padding);
 border-top: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),cM("scrollable, show-header-or-footer",[cE("content",`
 padding: var(--n-padding);
 `)])]),cB("popover-shared",`
 transform-origin: inherit;
 `,[cB("popover-arrow-wrapper",`
 position: absolute;
 overflow: hidden;
 pointer-events: none;
 `,[cB("popover-arrow",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 display: block;
 width: calc(${arrowSize});
 height: calc(${arrowSize});
 box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);
 transform: rotate(45deg);
 background-color: var(--n-color);
 pointer-events: all;
 `)]),c$1("&.popover-transition-enter-from, &.popover-transition-leave-to",`
 opacity: 0;
 transform: scale(.85);
 `),c$1("&.popover-transition-enter-to, &.popover-transition-leave-from",`
 transform: scale(1);
 opacity: 1;
 `),c$1("&.popover-transition-enter-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-out),
 transform .15s var(--n-bezier-ease-out);
 `),c$1("&.popover-transition-leave-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-in),
 transform .15s var(--n-bezier-ease-in);
 `)]),placementStyle("top-start",`
 top: calc(${arrowSize} / -2);
 left: calc(${getArrowOffset("top-start")} - var(--v-offset-left));
 `),placementStyle("top",`
 top: calc(${arrowSize} / -2);
 transform: translateX(calc(${arrowSize} / -2)) rotate(45deg);
 left: 50%;
 `),placementStyle("top-end",`
 top: calc(${arrowSize} / -2);
 right: calc(${getArrowOffset("top-end")} + var(--v-offset-left));
 `),placementStyle("bottom-start",`
 bottom: calc(${arrowSize} / -2);
 left: calc(${getArrowOffset("bottom-start")} - var(--v-offset-left));
 `),placementStyle("bottom",`
 bottom: calc(${arrowSize} / -2);
 transform: translateX(calc(${arrowSize} / -2)) rotate(45deg);
 left: 50%;
 `),placementStyle("bottom-end",`
 bottom: calc(${arrowSize} / -2);
 right: calc(${getArrowOffset("bottom-end")} + var(--v-offset-left));
 `),placementStyle("left-start",`
 left: calc(${arrowSize} / -2);
 top: calc(${getArrowOffset("left-start")} - var(--v-offset-top));
 `),placementStyle("left",`
 left: calc(${arrowSize} / -2);
 transform: translateY(calc(${arrowSize} / -2)) rotate(45deg);
 top: 50%;
 `),placementStyle("left-end",`
 left: calc(${arrowSize} / -2);
 bottom: calc(${getArrowOffset("left-end")} + var(--v-offset-top));
 `),placementStyle("right-start",`
 right: calc(${arrowSize} / -2);
 top: calc(${getArrowOffset("right-start")} - var(--v-offset-top));
 `),placementStyle("right",`
 right: calc(${arrowSize} / -2);
 transform: translateY(calc(${arrowSize} / -2)) rotate(45deg);
 top: 50%;
 `),placementStyle("right-end",`
 right: calc(${arrowSize} / -2);
 bottom: calc(${getArrowOffset("right-end")} + var(--v-offset-top));
 `),...map({top:["right-start","left-start"],right:["top-end","bottom-end"],bottom:["right-end","left-end"],left:["top-start","bottom-start"]},(e,n)=>{const o=["right","left"].includes(n),r=o?"width":"height";return e.map(u=>{const s=u.split("-")[1]==="end",m=`calc((${`var(--v-target-${r}, 0px)`} - ${arrowSize}) / 2)`,v=getArrowOffset(u);return c$1(`[v-placement="${u}"] >`,[cB("popover-shared",[cM("center-arrow",[cB("popover-arrow",`${n}: calc(max(${m}, ${v}) ${s?"+":"-"} var(--v-offset-${o?"left":"top"}));`)])])])})})]);function getArrowOffset(e){return["top","bottom"].includes(e.split("-")[0])?"var(--n-arrow-offset)":"var(--n-arrow-offset-vertical)"}function placementStyle(e,n){const o=e.split("-")[0],r=["top","bottom"].includes(o)?"height: var(--n-space-arrow);":"width: var(--n-space-arrow);";return c$1(`[v-placement="${e}"] >`,[cB("popover-shared",`
 margin-${oppositePlacement[o]}: var(--n-space);
 `,[cM("show-arrow",`
 margin-${oppositePlacement[o]}: var(--n-space-arrow);
 `),cM("overlap",`
 margin: 0;
 `),cCB("popover-arrow-wrapper",`
 right: 0;
 left: 0;
 top: 0;
 bottom: 0;
 ${o}: 100%;
 ${oppositePlacement[o]}: auto;
 ${r}
 `,[cB("popover-arrow",n)])])])}const popoverBodyProps=Object.assign(Object.assign({},useTheme.props),{to:useAdjustedTo.propTo,show:Boolean,trigger:String,showArrow:Boolean,delay:Number,duration:Number,raw:Boolean,arrowPointToCenter:Boolean,arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],displayDirective:String,x:Number,y:Number,flip:Boolean,overlap:Boolean,placement:String,width:[Number,String],keepAliveOnHover:Boolean,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],internalDeactivateImmediately:Boolean,animated:Boolean,onClickoutside:Function,internalTrapFocus:Boolean,internalOnAfterLeave:Function,minWidth:Number,maxWidth:Number});function renderArrow({arrowClass:e,arrowStyle:n,arrowWrapperClass:o,arrowWrapperStyle:r,clsPrefix:u}){return h$1("div",{key:"__popover-arrow__",style:r,class:[`${u}-popover-arrow-wrapper`,o]},h$1("div",{class:[`${u}-popover-arrow`,e],style:n}))}const NPopoverBody=defineComponent({name:"PopoverBody",inheritAttrs:!1,props:popoverBodyProps,setup(e,{slots:n,attrs:o}){const{namespaceRef:r,mergedClsPrefixRef:u,inlineThemeDisabled:s}=useConfig(e),w=useTheme("Popover","-popover",style$i,popoverLight$1,e,u),m=ref(null),v=inject("NPopover"),g=ref(null),d=ref(e.show),f=ref(!1);watchEffect(()=>{const{show:O}=e;O&&!isJsdom()&&!e.internalDeactivateImmediately&&(f.value=!0)});const y=computed(()=>{const{trigger:O,onClickoutside:F}=e,q=[],{positionManuallyRef:{value:Y}}=v;return Y||(O==="click"&&!F&&q.push([clickoutside$1,D,void 0,{capture:!0}]),O==="hover"&&q.push([mousemoveoutside$1,T])),F&&q.push([clickoutside$1,D,void 0,{capture:!0}]),(e.displayDirective==="show"||e.animated&&f.value)&&q.push([vShow,e.show]),q}),x=computed(()=>{const{common:{cubicBezierEaseInOut:O,cubicBezierEaseIn:F,cubicBezierEaseOut:q},self:{space:Y,spaceArrow:_e,padding:ne,fontSize:ve,textColor:J,dividerColor:fe,color:Z,boxShadow:j,borderRadius:X,arrowHeight:H,arrowOffset:U,arrowOffsetVertical:te}}=w.value;return{"--n-box-shadow":j,"--n-bezier":O,"--n-bezier-ease-in":F,"--n-bezier-ease-out":q,"--n-font-size":ve,"--n-text-color":J,"--n-color":Z,"--n-divider-color":fe,"--n-border-radius":X,"--n-arrow-height":H,"--n-arrow-offset":U,"--n-arrow-offset-vertical":te,"--n-padding":ne,"--n-space":Y,"--n-space-arrow":_e}}),k=computed(()=>{const O=e.width==="trigger"?void 0:formatLength(e.width),F=[];O&&F.push({width:O});const{maxWidth:q,minWidth:Y}=e;return q&&F.push({maxWidth:formatLength(q)}),Y&&F.push({maxWidth:formatLength(Y)}),s||F.push(x.value),F}),P=s?useThemeClass("popover",void 0,x,e):void 0;v.setBodyInstance({syncPosition:S}),onBeforeUnmount(()=>{v.setBodyInstance(null)}),watch(toRef(e,"show"),O=>{e.animated||(O?d.value=!0:d.value=!1)});function S(){var O;(O=m.value)===null||O===void 0||O.syncPosition()}function E(O){e.trigger==="hover"&&e.keepAliveOnHover&&e.show&&v.handleMouseEnter(O)}function M(O){e.trigger==="hover"&&e.keepAliveOnHover&&v.handleMouseLeave(O)}function T(O){e.trigger==="hover"&&!N().contains(getPreciseEventTarget(O))&&v.handleMouseMoveOutside(O)}function D(O){(e.trigger==="click"&&!N().contains(getPreciseEventTarget(O))||e.onClickoutside)&&v.handleClickOutside(O)}function N(){return v.getTriggerElement()}provide(popoverBodyInjectionKey,g),provide(drawerBodyInjectionKey,null),provide(modalBodyInjectionKey,null);function I(){if(P==null||P.onRender(),!(e.displayDirective==="show"||e.show||e.animated&&f.value))return null;let F;const q=v.internalRenderBodyRef.value,{value:Y}=u;if(q)F=q([`${Y}-popover-shared`,P==null?void 0:P.themeClass.value,e.overlap&&`${Y}-popover-shared--overlap`,e.showArrow&&`${Y}-popover-shared--show-arrow`,e.arrowPointToCenter&&`${Y}-popover-shared--center-arrow`],g,k.value,E,M);else{const{value:_e}=v.extraClassRef,{internalTrapFocus:ne}=e,ve=!isSlotEmpty(n.header)||!isSlotEmpty(n.footer),J=()=>{var fe,Z;const j=ve?h$1(Fragment,null,resolveWrappedSlot(n.header,U=>U?h$1("div",{class:[`${Y}-popover__header`,e.headerClass],style:e.headerStyle},U):null),resolveWrappedSlot(n.default,U=>U?h$1("div",{class:[`${Y}-popover__content`,e.contentClass],style:e.contentStyle},n):null),resolveWrappedSlot(n.footer,U=>U?h$1("div",{class:[`${Y}-popover__footer`,e.footerClass],style:e.footerStyle},U):null)):e.scrollable?(fe=n.default)===null||fe===void 0?void 0:fe.call(n):h$1("div",{class:[`${Y}-popover__content`,e.contentClass],style:e.contentStyle},n),X=e.scrollable?h$1(XScrollbar,{contentClass:ve?void 0:`${Y}-popover__content ${(Z=e.contentClass)!==null&&Z!==void 0?Z:""}`,contentStyle:ve?void 0:e.contentStyle},{default:()=>j}):j,H=e.showArrow?renderArrow({arrowClass:e.arrowClass,arrowStyle:e.arrowStyle,arrowWrapperClass:e.arrowWrapperClass,arrowWrapperStyle:e.arrowWrapperStyle,clsPrefix:Y}):null;return[X,H]};F=h$1("div",mergeProps({class:[`${Y}-popover`,`${Y}-popover-shared`,P==null?void 0:P.themeClass.value,_e.map(fe=>`${Y}-${fe}`),{[`${Y}-popover--scrollable`]:e.scrollable,[`${Y}-popover--show-header-or-footer`]:ve,[`${Y}-popover--raw`]:e.raw,[`${Y}-popover-shared--overlap`]:e.overlap,[`${Y}-popover-shared--show-arrow`]:e.showArrow,[`${Y}-popover-shared--center-arrow`]:e.arrowPointToCenter}],ref:g,style:k.value,onKeydown:v.handleKeydown,onMouseenter:E,onMouseleave:M},o),ne?h$1(FocusTrap,{active:e.show,autoFocus:!0},{default:J}):J())}return withDirectives(F,y.value)}return{displayed:f,namespace:r,isMounted:v.isMountedRef,zIndex:v.zIndexRef,followerRef:m,adjustedTo:useAdjustedTo(e),followerEnabled:d,renderContentNode:I}},render(){return h$1(VFollower,{ref:"followerRef",zIndex:this.zIndex,show:this.show,enabled:this.followerEnabled,to:this.adjustedTo,x:this.x,y:this.y,flip:this.flip,placement:this.placement,containerClass:this.namespace,overlap:this.overlap,width:this.width==="trigger"?"target":void 0,teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey},{default:()=>this.animated?h$1(Transition,{name:"popover-transition",appear:this.isMounted,onEnter:()=>{this.followerEnabled=!0},onAfterLeave:()=>{var e;(e=this.internalOnAfterLeave)===null||e===void 0||e.call(this),this.followerEnabled=!1,this.displayed=!1}},{default:this.renderContentNode}):this.renderContentNode()})}}),bodyPropKeys=Object.keys(popoverBodyProps),triggerEventMap={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"],manual:[],nested:["onFocus","onBlur","onMouseenter","onMouseleave","onClick"]};function appendEvents(e,n,o){triggerEventMap[n].forEach(r=>{e.props?e.props=Object.assign({},e.props):e.props={};const u=e.props[r],s=o[r];u?e.props[r]=(...w)=>{u(...w),s(...w)}:e.props[r]=s})}const popoverBaseProps={show:{type:Boolean,default:void 0},defaultShow:Boolean,showArrow:{type:Boolean,default:!0},trigger:{type:String,default:"hover"},delay:{type:Number,default:100},duration:{type:Number,default:100},raw:Boolean,placement:{type:String,default:"top"},x:Number,y:Number,arrowPointToCenter:Boolean,disabled:Boolean,getDisabled:Function,displayDirective:{type:String,default:"if"},arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],flip:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},width:{type:[Number,String],default:void 0},overlap:Boolean,keepAliveOnHover:{type:Boolean,default:!0},zIndex:Number,to:useAdjustedTo.propTo,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],onClickoutside:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],internalDeactivateImmediately:Boolean,internalSyncTargetWithParent:Boolean,internalInheritedEventHandlers:{type:Array,default:()=>[]},internalTrapFocus:Boolean,internalExtraClass:{type:Array,default:()=>[]},onShow:[Function,Array],onHide:[Function,Array],arrow:{type:Boolean,default:void 0},minWidth:Number,maxWidth:Number},popoverProps=Object.assign(Object.assign(Object.assign({},useTheme.props),popoverBaseProps),{internalOnAfterLeave:Function,internalRenderBody:Function}),NPopover=defineComponent({name:"Popover",inheritAttrs:!1,props:popoverProps,slots:Object,__popover__:!0,setup(e){const n=isMounted(),o=ref(null),r=computed(()=>e.show),u=ref(e.defaultShow),s=useMergedState(r,u),w=useMemo(()=>e.disabled?!1:s.value),m=()=>{if(e.disabled)return!0;const{getDisabled:fe}=e;return!!(fe!=null&&fe())},v=()=>m()?!1:s.value,g=useCompitable(e,["arrow","showArrow"]),d=computed(()=>e.overlap?!1:g.value);let f=null;const y=ref(null),x=ref(null),k=useMemo(()=>e.x!==void 0&&e.y!==void 0);function P(fe){const{"onUpdate:show":Z,onUpdateShow:j,onShow:X,onHide:H}=e;u.value=fe,Z&&call(Z,fe),j&&call(j,fe),fe&&X&&call(X,!0),fe&&H&&call(H,!1)}function S(){f&&f.syncPosition()}function E(){const{value:fe}=y;fe&&(window.clearTimeout(fe),y.value=null)}function M(){const{value:fe}=x;fe&&(window.clearTimeout(fe),x.value=null)}function T(){const fe=m();if(e.trigger==="focus"&&!fe){if(v())return;P(!0)}}function D(){const fe=m();if(e.trigger==="focus"&&!fe){if(!v())return;P(!1)}}function N(){const fe=m();if(e.trigger==="hover"&&!fe){if(M(),y.value!==null||v())return;const Z=()=>{P(!0),y.value=null},{delay:j}=e;j===0?Z():y.value=window.setTimeout(Z,j)}}function I(){const fe=m();if(e.trigger==="hover"&&!fe){if(E(),x.value!==null||!v())return;const Z=()=>{P(!1),x.value=null},{duration:j}=e;j===0?Z():x.value=window.setTimeout(Z,j)}}function O(){I()}function F(fe){var Z;!v()||(e.trigger==="click"&&(E(),M(),P(!1)),(Z=e.onClickoutside)===null||Z===void 0||Z.call(e,fe))}function q(){if(e.trigger==="click"&&!m()){E(),M();const fe=!v();P(fe)}}function Y(fe){!e.internalTrapFocus||fe.key==="Escape"&&(E(),M(),P(!1))}function _e(fe){u.value=fe}function ne(){var fe;return(fe=o.value)===null||fe===void 0?void 0:fe.targetRef}function ve(fe){f=fe}return provide("NPopover",{getTriggerElement:ne,handleKeydown:Y,handleMouseEnter:N,handleMouseLeave:I,handleClickOutside:F,handleMouseMoveOutside:O,setBodyInstance:ve,positionManuallyRef:k,isMountedRef:n,zIndexRef:toRef(e,"zIndex"),extraClassRef:toRef(e,"internalExtraClass"),internalRenderBodyRef:toRef(e,"internalRenderBody")}),watchEffect(()=>{s.value&&m()&&P(!1)}),{binderInstRef:o,positionManually:k,mergedShowConsideringDisabledProp:w,uncontrolledShow:u,mergedShowArrow:d,getMergedShow:v,setShow:_e,handleClick:q,handleMouseEnter:N,handleMouseLeave:I,handleFocus:T,handleBlur:D,syncPosition:S}},render(){var e;const{positionManually:n,$slots:o}=this;let r,u=!1;if(!n&&(r=getFirstSlotVNode(o,"trigger"),r)){r=cloneVNode(r),r=r.type===Text$2?h$1("span",[r]):r;const s={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur};if(!((e=r.type)===null||e===void 0)&&e.__popover__)u=!0,r.props||(r.props={internalSyncTargetWithParent:!0,internalInheritedEventHandlers:[]}),r.props.internalSyncTargetWithParent=!0,r.props.internalInheritedEventHandlers?r.props.internalInheritedEventHandlers=[s,...r.props.internalInheritedEventHandlers]:r.props.internalInheritedEventHandlers=[s];else{const{internalInheritedEventHandlers:w}=this,m=[s,...w],v={onBlur:g=>{m.forEach(d=>{d.onBlur(g)})},onFocus:g=>{m.forEach(d=>{d.onFocus(g)})},onClick:g=>{m.forEach(d=>{d.onClick(g)})},onMouseenter:g=>{m.forEach(d=>{d.onMouseenter(g)})},onMouseleave:g=>{m.forEach(d=>{d.onMouseleave(g)})}};appendEvents(r,w?"nested":n?"manual":this.trigger,v)}}return h$1(VBinder,{ref:"binderInstRef",syncTarget:!u,syncTargetWithParent:this.internalSyncTargetWithParent},{default:()=>{this.mergedShowConsideringDisabledProp;const s=this.getMergedShow();return[this.internalTrapFocus&&s?withDirectives(h$1("div",{style:{position:"fixed",top:0,right:0,bottom:0,left:0}}),[[zindexable$1,{enabled:s,zIndex:this.zIndex}]]):null,n?null:h$1(VTarget,null,{default:()=>r}),h$1(NPopoverBody,keep(this.$props,bodyPropKeys,Object.assign(Object.assign({},this.$attrs),{showArrow:this.mergedShowArrow,show:s})),{default:()=>{var w,m;return(m=(w=this.$slots).default)===null||m===void 0?void 0:m.call(w)},header:()=>{var w,m;return(m=(w=this.$slots).header)===null||m===void 0?void 0:m.call(w)},footer:()=>{var w,m;return(m=(w=this.$slots).footer)===null||m===void 0?void 0:m.call(w)}})]}})}}),commonVariables$5={closeIconSizeTiny:"12px",closeIconSizeSmall:"12px",closeIconSizeMedium:"14px",closeIconSizeLarge:"14px",closeSizeTiny:"16px",closeSizeSmall:"16px",closeSizeMedium:"18px",closeSizeLarge:"18px",padding:"0 7px",closeMargin:"0 0 0 4px"};function self$h(e){const{textColor2:n,primaryColorHover:o,primaryColorPressed:r,primaryColor:u,infoColor:s,successColor:w,warningColor:m,errorColor:v,baseColor:g,borderColor:d,opacityDisabled:f,tagColor:y,closeIconColor:x,closeIconColorHover:k,closeIconColorPressed:P,borderRadiusSmall:S,fontSizeMini:E,fontSizeTiny:M,fontSizeSmall:T,fontSizeMedium:D,heightMini:N,heightTiny:I,heightSmall:O,heightMedium:F,closeColorHover:q,closeColorPressed:Y,buttonColor2Hover:_e,buttonColor2Pressed:ne,fontWeightStrong:ve}=e;return Object.assign(Object.assign({},commonVariables$5),{closeBorderRadius:S,heightTiny:N,heightSmall:I,heightMedium:O,heightLarge:F,borderRadius:S,opacityDisabled:f,fontSizeTiny:E,fontSizeSmall:M,fontSizeMedium:T,fontSizeLarge:D,fontWeightStrong:ve,textColorCheckable:n,textColorHoverCheckable:n,textColorPressedCheckable:n,textColorChecked:g,colorCheckable:"#0000",colorHoverCheckable:_e,colorPressedCheckable:ne,colorChecked:u,colorCheckedHover:o,colorCheckedPressed:r,border:`1px solid ${d}`,textColor:n,color:y,colorBordered:"rgb(250, 250, 252)",closeIconColor:x,closeIconColorHover:k,closeIconColorPressed:P,closeColorHover:q,closeColorPressed:Y,borderPrimary:`1px solid ${changeColor(u,{alpha:.3})}`,textColorPrimary:u,colorPrimary:changeColor(u,{alpha:.12}),colorBorderedPrimary:changeColor(u,{alpha:.1}),closeIconColorPrimary:u,closeIconColorHoverPrimary:u,closeIconColorPressedPrimary:u,closeColorHoverPrimary:changeColor(u,{alpha:.12}),closeColorPressedPrimary:changeColor(u,{alpha:.18}),borderInfo:`1px solid ${changeColor(s,{alpha:.3})}`,textColorInfo:s,colorInfo:changeColor(s,{alpha:.12}),colorBorderedInfo:changeColor(s,{alpha:.1}),closeIconColorInfo:s,closeIconColorHoverInfo:s,closeIconColorPressedInfo:s,closeColorHoverInfo:changeColor(s,{alpha:.12}),closeColorPressedInfo:changeColor(s,{alpha:.18}),borderSuccess:`1px solid ${changeColor(w,{alpha:.3})}`,textColorSuccess:w,colorSuccess:changeColor(w,{alpha:.12}),colorBorderedSuccess:changeColor(w,{alpha:.1}),closeIconColorSuccess:w,closeIconColorHoverSuccess:w,closeIconColorPressedSuccess:w,closeColorHoverSuccess:changeColor(w,{alpha:.12}),closeColorPressedSuccess:changeColor(w,{alpha:.18}),borderWarning:`1px solid ${changeColor(m,{alpha:.35})}`,textColorWarning:m,colorWarning:changeColor(m,{alpha:.15}),colorBorderedWarning:changeColor(m,{alpha:.12}),closeIconColorWarning:m,closeIconColorHoverWarning:m,closeIconColorPressedWarning:m,closeColorHoverWarning:changeColor(m,{alpha:.12}),closeColorPressedWarning:changeColor(m,{alpha:.18}),borderError:`1px solid ${changeColor(v,{alpha:.23})}`,textColorError:v,colorError:changeColor(v,{alpha:.1}),colorBorderedError:changeColor(v,{alpha:.08}),closeIconColorError:v,closeIconColorHoverError:v,closeIconColorPressedError:v,closeColorHoverError:changeColor(v,{alpha:.12}),closeColorPressedError:changeColor(v,{alpha:.18})})}const tagLight={name:"Tag",common:commonLight,self:self$h},tagLight$1=tagLight,commonProps={color:Object,type:{type:String,default:"default"},round:Boolean,size:{type:String,default:"medium"},closable:Boolean,disabled:{type:Boolean,default:void 0}},style$h=cB("tag",`
 --n-close-margin: var(--n-close-margin-top) var(--n-close-margin-right) var(--n-close-margin-bottom) var(--n-close-margin-left);
 white-space: nowrap;
 position: relative;
 box-sizing: border-box;
 cursor: default;
 display: inline-flex;
 align-items: center;
 flex-wrap: nowrap;
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 line-height: 1;
 height: var(--n-height);
 font-size: var(--n-font-size);
`,[cM("strong",`
 font-weight: var(--n-font-weight-strong);
 `),cE("border",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-border);
 transition: border-color .3s var(--n-bezier);
 `),cE("icon",`
 display: flex;
 margin: 0 4px 0 0;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 font-size: var(--n-avatar-size-override);
 `),cE("avatar",`
 display: flex;
 margin: 0 6px 0 0;
 `),cE("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),cM("round",`
 padding: 0 calc(var(--n-height) / 3);
 border-radius: calc(var(--n-height) / 2);
 `,[cE("icon",`
 margin: 0 4px 0 calc((var(--n-height) - 8px) / -2);
 `),cE("avatar",`
 margin: 0 6px 0 calc((var(--n-height) - 8px) / -2);
 `),cM("closable",`
 padding: 0 calc(var(--n-height) / 4) 0 calc(var(--n-height) / 3);
 `)]),cM("icon, avatar",[cM("round",`
 padding: 0 calc(var(--n-height) / 3) 0 calc(var(--n-height) / 2);
 `)]),cM("disabled",`
 cursor: not-allowed !important;
 opacity: var(--n-opacity-disabled);
 `),cM("checkable",`
 cursor: pointer;
 box-shadow: none;
 color: var(--n-text-color-checkable);
 background-color: var(--n-color-checkable);
 `,[cNotM("disabled",[c$1("&:hover","background-color: var(--n-color-hover-checkable);",[cNotM("checked","color: var(--n-text-color-hover-checkable);")]),c$1("&:active","background-color: var(--n-color-pressed-checkable);",[cNotM("checked","color: var(--n-text-color-pressed-checkable);")])]),cM("checked",`
 color: var(--n-text-color-checked);
 background-color: var(--n-color-checked);
 `,[cNotM("disabled",[c$1("&:hover","background-color: var(--n-color-checked-hover);"),c$1("&:active","background-color: var(--n-color-checked-pressed);")])])])]),tagProps=Object.assign(Object.assign(Object.assign({},useTheme.props),commonProps),{bordered:{type:Boolean,default:void 0},checked:Boolean,checkable:Boolean,strong:Boolean,triggerClickOnClose:Boolean,onClose:[Array,Function],onMouseenter:Function,onMouseleave:Function,"onUpdate:checked":Function,onUpdateChecked:Function,internalCloseFocusable:{type:Boolean,default:!0},internalCloseIsButtonTag:{type:Boolean,default:!0},onCheckedChange:Function}),tagInjectionKey="n-tag",NTag=defineComponent({name:"Tag",props:tagProps,slots:Object,setup(e){const n=ref(null),{mergedBorderedRef:o,mergedClsPrefixRef:r,inlineThemeDisabled:u,mergedRtlRef:s}=useConfig(e),w=useTheme("Tag","-tag",style$h,tagLight$1,e,r);provide(tagInjectionKey,{roundRef:toRef(e,"round")});function m(){if(!e.disabled&&e.checkable){const{checked:x,onCheckedChange:k,onUpdateChecked:P,"onUpdate:checked":S}=e;P&&P(!x),S&&S(!x),k&&k(!x)}}function v(x){if(e.triggerClickOnClose||x.stopPropagation(),!e.disabled){const{onClose:k}=e;k&&call(k,x)}}const g={setTextContent(x){const{value:k}=n;k&&(k.textContent=x)}},d=useRtl("Tag",s,r),f=computed(()=>{const{type:x,size:k,color:{color:P,textColor:S}={}}=e,{common:{cubicBezierEaseInOut:E},self:{padding:M,closeMargin:T,borderRadius:D,opacityDisabled:N,textColorCheckable:I,textColorHoverCheckable:O,textColorPressedCheckable:F,textColorChecked:q,colorCheckable:Y,colorHoverCheckable:_e,colorPressedCheckable:ne,colorChecked:ve,colorCheckedHover:J,colorCheckedPressed:fe,closeBorderRadius:Z,fontWeightStrong:j,[createKey("colorBordered",x)]:X,[createKey("closeSize",k)]:H,[createKey("closeIconSize",k)]:U,[createKey("fontSize",k)]:te,[createKey("height",k)]:Q,[createKey("color",x)]:re,[createKey("textColor",x)]:Pe,[createKey("border",x)]:be,[createKey("closeIconColor",x)]:we,[createKey("closeIconColorHover",x)]:Ae,[createKey("closeIconColorPressed",x)]:$e,[createKey("closeColorHover",x)]:Me,[createKey("closeColorPressed",x)]:Ie}}=w.value,Le=getMargin(T);return{"--n-font-weight-strong":j,"--n-avatar-size-override":`calc(${Q} - 8px)`,"--n-bezier":E,"--n-border-radius":D,"--n-border":be,"--n-close-icon-size":U,"--n-close-color-pressed":Ie,"--n-close-color-hover":Me,"--n-close-border-radius":Z,"--n-close-icon-color":we,"--n-close-icon-color-hover":Ae,"--n-close-icon-color-pressed":$e,"--n-close-icon-color-disabled":we,"--n-close-margin-top":Le.top,"--n-close-margin-right":Le.right,"--n-close-margin-bottom":Le.bottom,"--n-close-margin-left":Le.left,"--n-close-size":H,"--n-color":P||(o.value?X:re),"--n-color-checkable":Y,"--n-color-checked":ve,"--n-color-checked-hover":J,"--n-color-checked-pressed":fe,"--n-color-hover-checkable":_e,"--n-color-pressed-checkable":ne,"--n-font-size":te,"--n-height":Q,"--n-opacity-disabled":N,"--n-padding":M,"--n-text-color":S||Pe,"--n-text-color-checkable":I,"--n-text-color-checked":q,"--n-text-color-hover-checkable":O,"--n-text-color-pressed-checkable":F}}),y=u?useThemeClass("tag",computed(()=>{let x="";const{type:k,size:P,color:{color:S,textColor:E}={}}=e;return x+=k[0],x+=P[0],S&&(x+=`a${color2Class(S)}`),E&&(x+=`b${color2Class(E)}`),o.value&&(x+="c"),x}),f,e):void 0;return Object.assign(Object.assign({},g),{rtlEnabled:d,mergedClsPrefix:r,contentRef:n,mergedBordered:o,handleClick:m,handleCloseClick:v,cssVars:u?void 0:f,themeClass:y==null?void 0:y.themeClass,onRender:y==null?void 0:y.onRender})},render(){var e,n;const{mergedClsPrefix:o,rtlEnabled:r,closable:u,color:{borderColor:s}={},round:w,onRender:m,$slots:v}=this;m==null||m();const g=resolveWrappedSlot(v.avatar,f=>f&&h$1("div",{class:`${o}-tag__avatar`},f)),d=resolveWrappedSlot(v.icon,f=>f&&h$1("div",{class:`${o}-tag__icon`},f));return h$1("div",{class:[`${o}-tag`,this.themeClass,{[`${o}-tag--rtl`]:r,[`${o}-tag--strong`]:this.strong,[`${o}-tag--disabled`]:this.disabled,[`${o}-tag--checkable`]:this.checkable,[`${o}-tag--checked`]:this.checkable&&this.checked,[`${o}-tag--round`]:w,[`${o}-tag--avatar`]:g,[`${o}-tag--icon`]:d,[`${o}-tag--closable`]:u}],style:this.cssVars,onClick:this.handleClick,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},d||g,h$1("span",{class:`${o}-tag__content`,ref:"contentRef"},(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e)),!this.checkable&&u?h$1(NBaseClose,{clsPrefix:o,class:`${o}-tag__close`,disabled:this.disabled,onClick:this.handleCloseClick,focusable:this.internalCloseFocusable,round:w,isButtonTag:this.internalCloseIsButtonTag,absolute:!0}):null,!this.checkable&&this.mergedBordered?h$1("div",{class:`${o}-tag__border`,style:{borderColor:s}}):null)}}),NBaseSuffix=defineComponent({name:"InternalSelectionSuffix",props:{clsPrefix:{type:String,required:!0},showArrow:{type:Boolean,default:void 0},showClear:{type:Boolean,default:void 0},loading:{type:Boolean,default:!1},onClear:Function},setup(e,{slots:n}){return()=>{const{clsPrefix:o}=e;return h$1(NBaseLoading,{clsPrefix:o,class:`${o}-base-suffix`,strokeWidth:24,scale:.85,show:e.loading},{default:()=>e.showArrow?h$1(NBaseClear,{clsPrefix:o,show:e.showClear,onClear:e.onClear},{placeholder:()=>h$1(NBaseIcon,{clsPrefix:o,class:`${o}-base-suffix__arrow`},{default:()=>resolveSlot(n.default,()=>[h$1(ChevronDownIcon,null)])})}):null})}}}),commonVariables$4={paddingSingle:"0 26px 0 12px",paddingMultiple:"3px 26px 0 12px",clearSize:"16px",arrowSize:"16px"};function self$g(e){const{borderRadius:n,textColor2:o,textColorDisabled:r,inputColor:u,inputColorDisabled:s,primaryColor:w,primaryColorHover:m,warningColor:v,warningColorHover:g,errorColor:d,errorColorHover:f,borderColor:y,iconColor:x,iconColorDisabled:k,clearColor:P,clearColorHover:S,clearColorPressed:E,placeholderColor:M,placeholderColorDisabled:T,fontSizeTiny:D,fontSizeSmall:N,fontSizeMedium:I,fontSizeLarge:O,heightTiny:F,heightSmall:q,heightMedium:Y,heightLarge:_e,fontWeight:ne}=e;return Object.assign(Object.assign({},commonVariables$4),{fontSizeTiny:D,fontSizeSmall:N,fontSizeMedium:I,fontSizeLarge:O,heightTiny:F,heightSmall:q,heightMedium:Y,heightLarge:_e,borderRadius:n,fontWeight:ne,textColor:o,textColorDisabled:r,placeholderColor:M,placeholderColorDisabled:T,color:u,colorDisabled:s,colorActive:u,border:`1px solid ${y}`,borderHover:`1px solid ${m}`,borderActive:`1px solid ${w}`,borderFocus:`1px solid ${m}`,boxShadowHover:"none",boxShadowActive:`0 0 0 2px ${changeColor(w,{alpha:.2})}`,boxShadowFocus:`0 0 0 2px ${changeColor(w,{alpha:.2})}`,caretColor:w,arrowColor:x,arrowColorDisabled:k,loadingColor:w,borderWarning:`1px solid ${v}`,borderHoverWarning:`1px solid ${g}`,borderActiveWarning:`1px solid ${v}`,borderFocusWarning:`1px solid ${g}`,boxShadowHoverWarning:"none",boxShadowActiveWarning:`0 0 0 2px ${changeColor(v,{alpha:.2})}`,boxShadowFocusWarning:`0 0 0 2px ${changeColor(v,{alpha:.2})}`,colorActiveWarning:u,caretColorWarning:v,borderError:`1px solid ${d}`,borderHoverError:`1px solid ${f}`,borderActiveError:`1px solid ${d}`,borderFocusError:`1px solid ${f}`,boxShadowHoverError:"none",boxShadowActiveError:`0 0 0 2px ${changeColor(d,{alpha:.2})}`,boxShadowFocusError:`0 0 0 2px ${changeColor(d,{alpha:.2})}`,colorActiveError:u,caretColorError:d,clearColor:P,clearColorHover:S,clearColorPressed:E})}const internalSelectionLight={name:"InternalSelection",common:commonLight,peers:{Popover:popoverLight$1},self:self$g},internalSelectionLight$1=internalSelectionLight,style$g=c$1([cB("base-selection",`
 --n-padding-single: var(--n-padding-single-top) var(--n-padding-single-right) var(--n-padding-single-bottom) var(--n-padding-single-left);
 --n-padding-multiple: var(--n-padding-multiple-top) var(--n-padding-multiple-right) var(--n-padding-multiple-bottom) var(--n-padding-multiple-left);
 position: relative;
 z-index: auto;
 box-shadow: none;
 width: 100%;
 max-width: 100%;
 display: inline-block;
 vertical-align: bottom;
 border-radius: var(--n-border-radius);
 min-height: var(--n-height);
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[cB("base-loading",`
 color: var(--n-loading-color);
 `),cB("base-selection-tags","min-height: var(--n-height);"),cE("border, state-border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border: var(--n-border);
 border-radius: inherit;
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),cE("state-border",`
 z-index: 1;
 border-color: #0000;
 `),cB("base-suffix",`
 cursor: pointer;
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 right: 10px;
 `,[cE("arrow",`
 font-size: var(--n-arrow-size);
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 `)]),cB("base-selection-overlay",`
 display: flex;
 align-items: center;
 white-space: nowrap;
 pointer-events: none;
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 padding: var(--n-padding-single);
 transition: color .3s var(--n-bezier);
 `,[cE("wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),cB("base-selection-placeholder",`
 color: var(--n-placeholder-color);
 `,[cE("inner",`
 max-width: 100%;
 overflow: hidden;
 `)]),cB("base-selection-tags",`
 cursor: pointer;
 outline: none;
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 display: flex;
 padding: var(--n-padding-multiple);
 flex-wrap: wrap;
 align-items: center;
 width: 100%;
 vertical-align: bottom;
 background-color: var(--n-color);
 border-radius: inherit;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),cB("base-selection-label",`
 height: var(--n-height);
 display: inline-flex;
 width: 100%;
 vertical-align: bottom;
 cursor: pointer;
 outline: none;
 z-index: auto;
 box-sizing: border-box;
 position: relative;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: inherit;
 background-color: var(--n-color);
 align-items: center;
 `,[cB("base-selection-input",`
 font-size: inherit;
 line-height: inherit;
 outline: none;
 cursor: pointer;
 box-sizing: border-box;
 border:none;
 width: 100%;
 padding: var(--n-padding-single);
 background-color: #0000;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 caret-color: var(--n-caret-color);
 `,[cE("content",`
 text-overflow: ellipsis;
 overflow: hidden;
 white-space: nowrap; 
 `)]),cE("render-label",`
 color: var(--n-text-color);
 `)]),cNotM("disabled",[c$1("&:hover",[cE("state-border",`
 box-shadow: var(--n-box-shadow-hover);
 border: var(--n-border-hover);
 `)]),cM("focus",[cE("state-border",`
 box-shadow: var(--n-box-shadow-focus);
 border: var(--n-border-focus);
 `)]),cM("active",[cE("state-border",`
 box-shadow: var(--n-box-shadow-active);
 border: var(--n-border-active);
 `),cB("base-selection-label","background-color: var(--n-color-active);"),cB("base-selection-tags","background-color: var(--n-color-active);")])]),cM("disabled","cursor: not-allowed;",[cE("arrow",`
 color: var(--n-arrow-color-disabled);
 `),cB("base-selection-label",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[cB("base-selection-input",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 `),cE("render-label",`
 color: var(--n-text-color-disabled);
 `)]),cB("base-selection-tags",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `),cB("base-selection-placeholder",`
 cursor: not-allowed;
 color: var(--n-placeholder-color-disabled);
 `)]),cB("base-selection-input-tag",`
 height: calc(var(--n-height) - 6px);
 line-height: calc(var(--n-height) - 6px);
 outline: none;
 display: none;
 position: relative;
 margin-bottom: 3px;
 max-width: 100%;
 vertical-align: bottom;
 `,[cE("input",`
 font-size: inherit;
 font-family: inherit;
 min-width: 1px;
 padding: 0;
 background-color: #0000;
 outline: none;
 border: none;
 max-width: 100%;
 overflow: hidden;
 width: 1em;
 line-height: inherit;
 cursor: pointer;
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 `),cE("mirror",`
 position: absolute;
 left: 0;
 top: 0;
 white-space: pre;
 visibility: hidden;
 user-select: none;
 -webkit-user-select: none;
 opacity: 0;
 `)]),["warning","error"].map(e=>cM(`${e}-status`,[cE("state-border",`border: var(--n-border-${e});`),cNotM("disabled",[c$1("&:hover",[cE("state-border",`
 box-shadow: var(--n-box-shadow-hover-${e});
 border: var(--n-border-hover-${e});
 `)]),cM("active",[cE("state-border",`
 box-shadow: var(--n-box-shadow-active-${e});
 border: var(--n-border-active-${e});
 `),cB("base-selection-label",`background-color: var(--n-color-active-${e});`),cB("base-selection-tags",`background-color: var(--n-color-active-${e});`)]),cM("focus",[cE("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),cB("base-selection-popover",`
 margin-bottom: -3px;
 display: flex;
 flex-wrap: wrap;
 margin-right: -8px;
 `),cB("base-selection-tag-wrapper",`
 max-width: 100%;
 display: inline-flex;
 padding: 0 7px 3px 0;
 `,[c$1("&:last-child","padding-right: 0;"),cB("tag",`
 font-size: 14px;
 max-width: 100%;
 `,[cE("content",`
 line-height: 1.25;
 text-overflow: ellipsis;
 overflow: hidden;
 `)])])]),NInternalSelection=defineComponent({name:"InternalSelection",props:Object.assign(Object.assign({},useTheme.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(e){const{mergedClsPrefixRef:n,mergedRtlRef:o}=useConfig(e),r=useRtl("InternalSelection",o,n),u=ref(null),s=ref(null),w=ref(null),m=ref(null),v=ref(null),g=ref(null),d=ref(null),f=ref(null),y=ref(null),x=ref(null),k=ref(!1),P=ref(!1),S=ref(!1),E=useTheme("InternalSelection","-internal-selection",style$g,internalSelectionLight$1,e,toRef(e,"clsPrefix")),M=computed(()=>e.clearable&&!e.disabled&&(S.value||e.active)),T=computed(()=>e.selectedOption?e.renderTag?e.renderTag({option:e.selectedOption,handleClose:()=>{}}):e.renderLabel?e.renderLabel(e.selectedOption,!0):render(e.selectedOption[e.labelField],e.selectedOption,!0):e.placeholder),D=computed(()=>{const Ke=e.selectedOption;if(!!Ke)return Ke[e.labelField]}),N=computed(()=>e.multiple?!!(Array.isArray(e.selectedOptions)&&e.selectedOptions.length):e.selectedOption!==null);function I(){var Ke;const{value:Je}=u;if(Je){const{value:rt}=s;rt&&(rt.style.width=`${Je.offsetWidth}px`,e.maxTagCount!=="responsive"&&((Ke=y.value)===null||Ke===void 0||Ke.sync({showAllItemsBeforeCalculate:!1})))}}function O(){const{value:Ke}=x;Ke&&(Ke.style.display="none")}function F(){const{value:Ke}=x;Ke&&(Ke.style.display="inline-block")}watch(toRef(e,"active"),Ke=>{Ke||O()}),watch(toRef(e,"pattern"),()=>{e.multiple&&nextTick(I)});function q(Ke){const{onFocus:Je}=e;Je&&Je(Ke)}function Y(Ke){const{onBlur:Je}=e;Je&&Je(Ke)}function _e(Ke){const{onDeleteOption:Je}=e;Je&&Je(Ke)}function ne(Ke){const{onClear:Je}=e;Je&&Je(Ke)}function ve(Ke){const{onPatternInput:Je}=e;Je&&Je(Ke)}function J(Ke){var Je;(!Ke.relatedTarget||!(!((Je=w.value)===null||Je===void 0)&&Je.contains(Ke.relatedTarget)))&&q(Ke)}function fe(Ke){var Je;!((Je=w.value)===null||Je===void 0)&&Je.contains(Ke.relatedTarget)||Y(Ke)}function Z(Ke){ne(Ke)}function j(){S.value=!0}function X(){S.value=!1}function H(Ke){!e.active||!e.filterable||Ke.target!==s.value&&Ke.preventDefault()}function U(Ke){_e(Ke)}const te=ref(!1);function Q(Ke){if(Ke.key==="Backspace"&&!te.value&&!e.pattern.length){const{selectedOptions:Je}=e;Je!=null&&Je.length&&U(Je[Je.length-1])}}let re=null;function Pe(Ke){const{value:Je}=u;if(Je){const rt=Ke.target.value;Je.textContent=rt,I()}e.ignoreComposition&&te.value?re=Ke:ve(Ke)}function be(){te.value=!0}function we(){te.value=!1,e.ignoreComposition&&ve(re),re=null}function Ae(Ke){var Je;P.value=!0,(Je=e.onPatternFocus)===null||Je===void 0||Je.call(e,Ke)}function $e(Ke){var Je;P.value=!1,(Je=e.onPatternBlur)===null||Je===void 0||Je.call(e,Ke)}function Me(){var Ke,Je;if(e.filterable)P.value=!1,(Ke=g.value)===null||Ke===void 0||Ke.blur(),(Je=s.value)===null||Je===void 0||Je.blur();else if(e.multiple){const{value:rt}=m;rt==null||rt.blur()}else{const{value:rt}=v;rt==null||rt.blur()}}function Ie(){var Ke,Je,rt;e.filterable?(P.value=!1,(Ke=g.value)===null||Ke===void 0||Ke.focus()):e.multiple?(Je=m.value)===null||Je===void 0||Je.focus():(rt=v.value)===null||rt===void 0||rt.focus()}function Le(){const{value:Ke}=s;Ke&&(F(),Ke.focus())}function le(){const{value:Ke}=s;Ke&&Ke.blur()}function oe(Ke){const{value:Je}=d;Je&&Je.setTextContent(`+${Ke}`)}function ke(){const{value:Ke}=f;return Ke}function Ce(){return s.value}let Ee=null;function Be(){Ee!==null&&window.clearTimeout(Ee)}function Ve(){e.active||(Be(),Ee=window.setTimeout(()=>{N.value&&(k.value=!0)},100))}function Oe(){Be()}function je(Ke){Ke||(Be(),k.value=!1)}watch(N,Ke=>{Ke||(k.value=!1)}),onMounted(()=>{watchEffect(()=>{const Ke=g.value;!Ke||(e.disabled?Ke.removeAttribute("tabindex"):Ke.tabIndex=P.value?-1:0)})}),useOnResize(w,e.onResize);const{inlineThemeDisabled:Ge}=e,Xe=computed(()=>{const{size:Ke}=e,{common:{cubicBezierEaseInOut:Je},self:{fontWeight:rt,borderRadius:ht,color:vt,placeholderColor:Ct,textColor:kt,paddingSingle:mt,paddingMultiple:Vt,caretColor:bt,colorDisabled:ot,textColorDisabled:gt,placeholderColorDisabled:tt,colorActive:ut,boxShadowFocus:Re,boxShadowActive:Te,boxShadowHover:He,border:Fe,borderFocus:ze,borderHover:We,borderActive:Ue,arrowColor:et,arrowColorDisabled:it,loadingColor:nt,colorActiveWarning:dt,boxShadowFocusWarning:xt,boxShadowActiveWarning:yt,boxShadowHoverWarning:Bt,borderWarning:Pt,borderFocusWarning:Tt,borderHoverWarning:ct,borderActiveWarning:wt,colorActiveError:St,boxShadowFocusError:Ft,boxShadowActiveError:Gt,boxShadowHoverError:jt,borderError:Ut,borderFocusError:Jt,borderHoverError:un,borderActiveError:nn,clearColor:Zt,clearColorHover:en,clearColorPressed:Cn,clearSize:$n,arrowSize:Rn,[createKey("height",Ke)]:Nn,[createKey("fontSize",Ke)]:zn}}=E.value,_i=getMargin(mt),$i=getMargin(Vt);return{"--n-bezier":Je,"--n-border":Fe,"--n-border-active":Ue,"--n-border-focus":ze,"--n-border-hover":We,"--n-border-radius":ht,"--n-box-shadow-active":Te,"--n-box-shadow-focus":Re,"--n-box-shadow-hover":He,"--n-caret-color":bt,"--n-color":vt,"--n-color-active":ut,"--n-color-disabled":ot,"--n-font-size":zn,"--n-height":Nn,"--n-padding-single-top":_i.top,"--n-padding-multiple-top":$i.top,"--n-padding-single-right":_i.right,"--n-padding-multiple-right":$i.right,"--n-padding-single-left":_i.left,"--n-padding-multiple-left":$i.left,"--n-padding-single-bottom":_i.bottom,"--n-padding-multiple-bottom":$i.bottom,"--n-placeholder-color":Ct,"--n-placeholder-color-disabled":tt,"--n-text-color":kt,"--n-text-color-disabled":gt,"--n-arrow-color":et,"--n-arrow-color-disabled":it,"--n-loading-color":nt,"--n-color-active-warning":dt,"--n-box-shadow-focus-warning":xt,"--n-box-shadow-active-warning":yt,"--n-box-shadow-hover-warning":Bt,"--n-border-warning":Pt,"--n-border-focus-warning":Tt,"--n-border-hover-warning":ct,"--n-border-active-warning":wt,"--n-color-active-error":St,"--n-box-shadow-focus-error":Ft,"--n-box-shadow-active-error":Gt,"--n-box-shadow-hover-error":jt,"--n-border-error":Ut,"--n-border-focus-error":Jt,"--n-border-hover-error":un,"--n-border-active-error":nn,"--n-clear-size":$n,"--n-clear-color":Zt,"--n-clear-color-hover":en,"--n-clear-color-pressed":Cn,"--n-arrow-size":Rn,"--n-font-weight":rt}}),qe=Ge?useThemeClass("internal-selection",computed(()=>e.size[0]),Xe,e):void 0;return{mergedTheme:E,mergedClearable:M,mergedClsPrefix:n,rtlEnabled:r,patternInputFocused:P,filterablePlaceholder:T,label:D,selected:N,showTagsPanel:k,isComposing:te,counterRef:d,counterWrapperRef:f,patternInputMirrorRef:u,patternInputRef:s,selfRef:w,multipleElRef:m,singleElRef:v,patternInputWrapperRef:g,overflowRef:y,inputTagElRef:x,handleMouseDown:H,handleFocusin:J,handleClear:Z,handleMouseEnter:j,handleMouseLeave:X,handleDeleteOption:U,handlePatternKeyDown:Q,handlePatternInputInput:Pe,handlePatternInputBlur:$e,handlePatternInputFocus:Ae,handleMouseEnterCounter:Ve,handleMouseLeaveCounter:Oe,handleFocusout:fe,handleCompositionEnd:we,handleCompositionStart:be,onPopoverUpdateShow:je,focus:Ie,focusInput:Le,blur:Me,blurInput:le,updateCounter:oe,getCounter:ke,getTail:Ce,renderLabel:e.renderLabel,cssVars:Ge?void 0:Xe,themeClass:qe==null?void 0:qe.themeClass,onRender:qe==null?void 0:qe.onRender}},render(){const{status:e,multiple:n,size:o,disabled:r,filterable:u,maxTagCount:s,bordered:w,clsPrefix:m,ellipsisTagPopoverProps:v,onRender:g,renderTag:d,renderLabel:f}=this;g==null||g();const y=s==="responsive",x=typeof s=="number",k=y||x,P=h$1(Wrapper,null,{default:()=>h$1(NBaseSuffix,{clsPrefix:m,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var E,M;return(M=(E=this.$slots).arrow)===null||M===void 0?void 0:M.call(E)}})});let S;if(n){const{labelField:E}=this,M=ve=>h$1("div",{class:`${m}-base-selection-tag-wrapper`,key:ve.value},d?d({option:ve,handleClose:()=>{this.handleDeleteOption(ve)}}):h$1(NTag,{size:o,closable:!ve.disabled,disabled:r,onClose:()=>{this.handleDeleteOption(ve)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>f?f(ve,!0):render(ve[E],ve,!0)})),T=()=>(x?this.selectedOptions.slice(0,s):this.selectedOptions).map(M),D=u?h$1("div",{class:`${m}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},h$1("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:r,value:this.pattern,autofocus:this.autofocus,class:`${m}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),h$1("span",{ref:"patternInputMirrorRef",class:`${m}-base-selection-input-tag__mirror`},this.pattern)):null,N=y?()=>h$1("div",{class:`${m}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},h$1(NTag,{size:o,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:r})):void 0;let I;if(x){const ve=this.selectedOptions.length-s;ve>0&&(I=h$1("div",{class:`${m}-base-selection-tag-wrapper`,key:"__counter__"},h$1(NTag,{size:o,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:r},{default:()=>`+${ve}`})))}const O=y?u?h$1(VOverflow,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:T,counter:N,tail:()=>D}):h$1(VOverflow,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:T,counter:N}):x&&I?T().concat(I):T(),F=k?()=>h$1("div",{class:`${m}-base-selection-popover`},y?T():this.selectedOptions.map(M)):void 0,q=k?Object.assign({show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover},v):null,_e=(this.selected?!1:this.active?!this.pattern&&!this.isComposing:!0)?h$1("div",{class:`${m}-base-selection-placeholder ${m}-base-selection-overlay`},h$1("div",{class:`${m}-base-selection-placeholder__inner`},this.placeholder)):null,ne=u?h$1("div",{ref:"patternInputWrapperRef",class:`${m}-base-selection-tags`},O,y?null:D,P):h$1("div",{ref:"multipleElRef",class:`${m}-base-selection-tags`,tabindex:r?void 0:0},O,P);S=h$1(Fragment,null,k?h$1(NPopover,Object.assign({},q,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>ne,default:F}):ne,_e)}else if(u){const E=this.pattern||this.isComposing,M=this.active?!E:!this.selected,T=this.active?!1:this.selected;S=h$1("div",{ref:"patternInputWrapperRef",class:`${m}-base-selection-label`,title:this.patternInputFocused?void 0:getTitleAttribute(this.label)},h$1("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${m}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:r,disabled:r,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),T?h$1("div",{class:`${m}-base-selection-label__render-label ${m}-base-selection-overlay`,key:"input"},h$1("div",{class:`${m}-base-selection-overlay__wrapper`},d?d({option:this.selectedOption,handleClose:()=>{}}):f?f(this.selectedOption,!0):render(this.label,this.selectedOption,!0))):null,M?h$1("div",{class:`${m}-base-selection-placeholder ${m}-base-selection-overlay`,key:"placeholder"},h$1("div",{class:`${m}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,P)}else S=h$1("div",{ref:"singleElRef",class:`${m}-base-selection-label`,tabindex:this.disabled?void 0:0},this.label!==void 0?h$1("div",{class:`${m}-base-selection-input`,title:getTitleAttribute(this.label),key:"input"},h$1("div",{class:`${m}-base-selection-input__content`},d?d({option:this.selectedOption,handleClose:()=>{}}):f?f(this.selectedOption,!0):render(this.label,this.selectedOption,!0))):h$1("div",{class:`${m}-base-selection-placeholder ${m}-base-selection-overlay`,key:"placeholder"},h$1("div",{class:`${m}-base-selection-placeholder__inner`},this.placeholder)),P);return h$1("div",{ref:"selfRef",class:[`${m}-base-selection`,this.rtlEnabled&&`${m}-base-selection--rtl`,this.themeClass,e&&`${m}-base-selection--${e}-status`,{[`${m}-base-selection--active`]:this.active,[`${m}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${m}-base-selection--disabled`]:this.disabled,[`${m}-base-selection--multiple`]:this.multiple,[`${m}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},S,w?h$1("div",{class:`${m}-base-selection__border`}):null,w?h$1("div",{class:`${m}-base-selection__state-border`}):null)}}),{cubicBezierEaseInOut:cubicBezierEaseInOut$1}=commonVariables$8;function fadeInWidthExpandTransition({duration:e=".2s",delay:n=".1s"}={}){return[c$1("&.fade-in-width-expand-transition-leave-from, &.fade-in-width-expand-transition-enter-to",{opacity:1}),c$1("&.fade-in-width-expand-transition-leave-to, &.fade-in-width-expand-transition-enter-from",`
 opacity: 0!important;
 margin-left: 0!important;
 margin-right: 0!important;
 `),c$1("&.fade-in-width-expand-transition-leave-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${cubicBezierEaseInOut$1},
 max-width ${e} ${cubicBezierEaseInOut$1} ${n},
 margin-left ${e} ${cubicBezierEaseInOut$1} ${n},
 margin-right ${e} ${cubicBezierEaseInOut$1} ${n};
 `),c$1("&.fade-in-width-expand-transition-enter-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${cubicBezierEaseInOut$1} ${n},
 max-width ${e} ${cubicBezierEaseInOut$1},
 margin-left ${e} ${cubicBezierEaseInOut$1},
 margin-right ${e} ${cubicBezierEaseInOut$1};
 `)]}const style$f=cB("base-wave",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
`),NBaseWave=defineComponent({name:"BaseWave",props:{clsPrefix:{type:String,required:!0}},setup(e){useStyle("-base-wave",style$f,toRef(e,"clsPrefix"));const n=ref(null),o=ref(!1);let r=null;return onBeforeUnmount(()=>{r!==null&&window.clearTimeout(r)}),{active:o,selfRef:n,play(){r!==null&&(window.clearTimeout(r),o.value=!1,r=null),nextTick(()=>{var u;(u=n.value)===null||u===void 0||u.offsetHeight,o.value=!0,r=window.setTimeout(()=>{o.value=!1,r=null},1e3)})}}},render(){const{clsPrefix:e}=this;return h$1("div",{ref:"selfRef","aria-hidden":!0,class:[`${e}-base-wave`,this.active&&`${e}-base-wave--active`]})}}),{cubicBezierEaseInOut,cubicBezierEaseOut,cubicBezierEaseIn}=commonVariables$8;function fadeInHeightExpandTransition({overflow:e="hidden",duration:n=".3s",originalTransition:o="",leavingDelay:r="0s",foldPadding:u=!1,enterToProps:s=void 0,leaveToProps:w=void 0,reverse:m=!1}={}){const v=m?"leave":"enter",g=m?"enter":"leave";return[c$1(`&.fade-in-height-expand-transition-${g}-from,
 &.fade-in-height-expand-transition-${v}-to`,Object.assign(Object.assign({},s),{opacity:1})),c$1(`&.fade-in-height-expand-transition-${g}-to,
 &.fade-in-height-expand-transition-${v}-from`,Object.assign(Object.assign({},w),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:u?"0 !important":void 0,paddingBottom:u?"0 !important":void 0})),c$1(`&.fade-in-height-expand-transition-${g}-active`,`
 overflow: ${e};
 transition:
 max-height ${n} ${cubicBezierEaseInOut} ${r},
 opacity ${n} ${cubicBezierEaseOut} ${r},
 margin-top ${n} ${cubicBezierEaseInOut} ${r},
 margin-bottom ${n} ${cubicBezierEaseInOut} ${r},
 padding-top ${n} ${cubicBezierEaseInOut} ${r},
 padding-bottom ${n} ${cubicBezierEaseInOut} ${r}
 ${o?`,${o}`:""}
 `),c$1(`&.fade-in-height-expand-transition-${v}-active`,`
 overflow: ${e};
 transition:
 max-height ${n} ${cubicBezierEaseInOut},
 opacity ${n} ${cubicBezierEaseIn},
 margin-top ${n} ${cubicBezierEaseInOut},
 margin-bottom ${n} ${cubicBezierEaseInOut},
 padding-top ${n} ${cubicBezierEaseInOut},
 padding-bottom ${n} ${cubicBezierEaseInOut}
 ${o?`,${o}`:""}
 `)]}const isChrome=isBrowser$1&&"chrome"in window;isBrowser$1&&navigator.userAgent.includes("Firefox");const isSafari=isBrowser$1&&navigator.userAgent.includes("Safari")&&!isChrome,commonVariables$3={paddingTiny:"0 8px",paddingSmall:"0 10px",paddingMedium:"0 12px",paddingLarge:"0 14px",clearSize:"16px"};function self$f(e){const{textColor2:n,textColor3:o,textColorDisabled:r,primaryColor:u,primaryColorHover:s,inputColor:w,inputColorDisabled:m,borderColor:v,warningColor:g,warningColorHover:d,errorColor:f,errorColorHover:y,borderRadius:x,lineHeight:k,fontSizeTiny:P,fontSizeSmall:S,fontSizeMedium:E,fontSizeLarge:M,heightTiny:T,heightSmall:D,heightMedium:N,heightLarge:I,actionColor:O,clearColor:F,clearColorHover:q,clearColorPressed:Y,placeholderColor:_e,placeholderColorDisabled:ne,iconColor:ve,iconColorDisabled:J,iconColorHover:fe,iconColorPressed:Z,fontWeight:j}=e;return Object.assign(Object.assign({},commonVariables$3),{fontWeight:j,countTextColorDisabled:r,countTextColor:o,heightTiny:T,heightSmall:D,heightMedium:N,heightLarge:I,fontSizeTiny:P,fontSizeSmall:S,fontSizeMedium:E,fontSizeLarge:M,lineHeight:k,lineHeightTextarea:k,borderRadius:x,iconSize:"16px",groupLabelColor:O,groupLabelTextColor:n,textColor:n,textColorDisabled:r,textDecorationColor:n,caretColor:u,placeholderColor:_e,placeholderColorDisabled:ne,color:w,colorDisabled:m,colorFocus:w,groupLabelBorder:`1px solid ${v}`,border:`1px solid ${v}`,borderHover:`1px solid ${s}`,borderDisabled:`1px solid ${v}`,borderFocus:`1px solid ${s}`,boxShadowFocus:`0 0 0 2px ${changeColor(u,{alpha:.2})}`,loadingColor:u,loadingColorWarning:g,borderWarning:`1px solid ${g}`,borderHoverWarning:`1px solid ${d}`,colorFocusWarning:w,borderFocusWarning:`1px solid ${d}`,boxShadowFocusWarning:`0 0 0 2px ${changeColor(g,{alpha:.2})}`,caretColorWarning:g,loadingColorError:f,borderError:`1px solid ${f}`,borderHoverError:`1px solid ${y}`,colorFocusError:w,borderFocusError:`1px solid ${y}`,boxShadowFocusError:`0 0 0 2px ${changeColor(f,{alpha:.2})}`,caretColorError:f,clearColor:F,clearColorHover:q,clearColorPressed:Y,iconColor:ve,iconColorDisabled:J,iconColorHover:fe,iconColorPressed:Z,suffixTextColor:n})}const inputLight={name:"Input",common:commonLight,self:self$f},inputLight$1=inputLight,inputInjectionKey="n-input",style$e=cB("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[cE("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),cE("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),cE("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[c$1("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),c$1("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),c$1("&:-webkit-autofill ~",[cE("placeholder","display: none;")])]),cM("round",[cNotM("textarea","border-radius: calc(var(--n-height) / 2);")]),cE("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[c$1("span",`
 width: 100%;
 display: inline-block;
 `)]),cM("textarea",[cE("placeholder","overflow: visible;")]),cNotM("autosize","width: 100%;"),cM("autosize",[cE("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),cB("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),cE("input-mirror",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),cE("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[c$1("&[type=password]::-ms-reveal","display: none;"),c$1("+",[cE("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),cNotM("textarea",[cE("placeholder","white-space: nowrap;")]),cE("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `),cM("textarea","width: 100%;",[cB("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),cM("resizable",[cB("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),cE("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 scroll-padding-block-end: var(--n-padding-vertical);
 `),cE("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),cM("pair",[cE("input-el, placeholder","text-align: center;"),cE("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[cB("icon",`
 color: var(--n-icon-color);
 `),cB("base-icon",`
 color: var(--n-icon-color);
 `)])]),cM("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[cE("border","border: var(--n-border-disabled);"),cE("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),cE("placeholder","color: var(--n-placeholder-color-disabled);"),cE("separator","color: var(--n-text-color-disabled);",[cB("icon",`
 color: var(--n-icon-color-disabled);
 `),cB("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),cB("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),cE("suffix, prefix","color: var(--n-text-color-disabled);",[cB("icon",`
 color: var(--n-icon-color-disabled);
 `),cB("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),cNotM("disabled",[cE("eye",`
 color: var(--n-icon-color);
 cursor: pointer;
 `,[c$1("&:hover",`
 color: var(--n-icon-color-hover);
 `),c$1("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),c$1("&:hover",[cE("state-border","border: var(--n-border-hover);")]),cM("focus","background-color: var(--n-color-focus);",[cE("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),cE("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),cE("state-border",`
 border-color: #0000;
 z-index: 1;
 `),cE("prefix","margin-right: 4px;"),cE("suffix",`
 margin-left: 4px;
 `),cE("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[cB("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),cB("base-clear",`
 font-size: var(--n-icon-size);
 `,[cE("placeholder",[cB("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),c$1(">",[cB("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),cB("base-icon",`
 font-size: var(--n-icon-size);
 `)]),cB("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(e=>cM(`${e}-status`,[cNotM("disabled",[cB("base-loading",`
 color: var(--n-loading-color-${e})
 `),cE("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${e});
 `),cE("state-border",`
 border: var(--n-border-${e});
 `),c$1("&:hover",[cE("state-border",`
 border: var(--n-border-hover-${e});
 `)]),c$1("&:focus",`
 background-color: var(--n-color-focus-${e});
 `,[cE("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)]),cM("focus",`
 background-color: var(--n-color-focus-${e});
 `,[cE("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),safariStyle=cB("input",[cM("disabled",[cE("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]);function len(e){let n=0;for(const o of e)n++;return n}function isEmptyInputValue(e){return e===""||e==null}function useCursor(e){const n=ref(null);function o(){const{value:s}=e;if(!(s!=null&&s.focus)){u();return}const{selectionStart:w,selectionEnd:m,value:v}=s;if(w==null||m==null){u();return}n.value={start:w,end:m,beforeText:v.slice(0,w),afterText:v.slice(m)}}function r(){var s;const{value:w}=n,{value:m}=e;if(!w||!m)return;const{value:v}=m,{start:g,beforeText:d,afterText:f}=w;let y=v.length;if(v.endsWith(f))y=v.length-f.length;else if(v.startsWith(d))y=d.length;else{const x=d[g-1],k=v.indexOf(x,g-1);k!==-1&&(y=k+1)}(s=m.setSelectionRange)===null||s===void 0||s.call(m,y,y)}function u(){n.value=null}return watch(e,u),{recordCursor:o,restoreCursor:r}}const WordCount=defineComponent({name:"InputWordCount",setup(e,{slots:n}){const{mergedValueRef:o,maxlengthRef:r,mergedClsPrefixRef:u,countGraphemesRef:s}=inject(inputInjectionKey),w=computed(()=>{const{value:m}=o;return m===null||Array.isArray(m)?0:(s.value||len)(m)});return()=>{const{value:m}=r,{value:v}=o;return h$1("span",{class:`${u.value}-input-word-count`},resolveSlotWithTypedProps(n.default,{value:v===null||Array.isArray(v)?"":v},()=>[m===void 0?w.value:`${w.value} / ${m}`]))}}}),inputProps=Object.assign(Object.assign({},useTheme.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:[Function,Array],onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:{type:Boolean,default:!0},showPasswordToggle:Boolean}),NInput=defineComponent({name:"Input",props:inputProps,slots:Object,setup(e){const{mergedClsPrefixRef:n,mergedBorderedRef:o,inlineThemeDisabled:r,mergedRtlRef:u}=useConfig(e),s=useTheme("Input","-input",style$e,inputLight$1,e,n);isSafari&&useStyle("-input-safari",safariStyle,n);const w=ref(null),m=ref(null),v=ref(null),g=ref(null),d=ref(null),f=ref(null),y=ref(null),x=useCursor(y),k=ref(null),{localeRef:P}=useLocale("Input"),S=ref(e.defaultValue),E=toRef(e,"value"),M=useMergedState(E,S),T=useFormItem(e),{mergedSizeRef:D,mergedDisabledRef:N,mergedStatusRef:I}=T,O=ref(!1),F=ref(!1),q=ref(!1),Y=ref(!1);let _e=null;const ne=computed(()=>{const{placeholder:ct,pair:wt}=e;return wt?Array.isArray(ct)?ct:ct===void 0?["",""]:[ct,ct]:ct===void 0?[P.value.placeholder]:[ct]}),ve=computed(()=>{const{value:ct}=q,{value:wt}=M,{value:St}=ne;return!ct&&(isEmptyInputValue(wt)||Array.isArray(wt)&&isEmptyInputValue(wt[0]))&&St[0]}),J=computed(()=>{const{value:ct}=q,{value:wt}=M,{value:St}=ne;return!ct&&St[1]&&(isEmptyInputValue(wt)||Array.isArray(wt)&&isEmptyInputValue(wt[1]))}),fe=useMemo(()=>e.internalForceFocus||O.value),Z=useMemo(()=>{if(N.value||e.readonly||!e.clearable||!fe.value&&!F.value)return!1;const{value:ct}=M,{value:wt}=fe;return e.pair?!!(Array.isArray(ct)&&(ct[0]||ct[1]))&&(F.value||wt):!!ct&&(F.value||wt)}),j=computed(()=>{const{showPasswordOn:ct}=e;if(ct)return ct;if(e.showPasswordToggle)return"click"}),X=ref(!1),H=computed(()=>{const{textDecoration:ct}=e;return ct?Array.isArray(ct)?ct.map(wt=>({textDecoration:wt})):[{textDecoration:ct}]:["",""]}),U=ref(void 0),te=()=>{var ct,wt;if(e.type==="textarea"){const{autosize:St}=e;if(St&&(U.value=(wt=(ct=k.value)===null||ct===void 0?void 0:ct.$el)===null||wt===void 0?void 0:wt.offsetWidth),!m.value||typeof St=="boolean")return;const{paddingTop:Ft,paddingBottom:Gt,lineHeight:jt}=window.getComputedStyle(m.value),Ut=Number(Ft.slice(0,-2)),Jt=Number(Gt.slice(0,-2)),un=Number(jt.slice(0,-2)),{value:nn}=v;if(!nn)return;if(St.minRows){const Zt=Math.max(St.minRows,1),en=`${Ut+Jt+un*Zt}px`;nn.style.minHeight=en}if(St.maxRows){const Zt=`${Ut+Jt+un*St.maxRows}px`;nn.style.maxHeight=Zt}}},Q=computed(()=>{const{maxlength:ct}=e;return ct===void 0?void 0:Number(ct)});onMounted(()=>{const{value:ct}=M;Array.isArray(ct)||Ue(ct)});const re=getCurrentInstance().proxy;function Pe(ct,wt){const{onUpdateValue:St,"onUpdate:value":Ft,onInput:Gt}=e,{nTriggerFormInput:jt}=T;St&&call(St,ct,wt),Ft&&call(Ft,ct,wt),Gt&&call(Gt,ct,wt),S.value=ct,jt()}function be(ct,wt){const{onChange:St}=e,{nTriggerFormChange:Ft}=T;St&&call(St,ct,wt),S.value=ct,Ft()}function we(ct){const{onBlur:wt}=e,{nTriggerFormBlur:St}=T;wt&&call(wt,ct),St()}function Ae(ct){const{onFocus:wt}=e,{nTriggerFormFocus:St}=T;wt&&call(wt,ct),St()}function $e(ct){const{onClear:wt}=e;wt&&call(wt,ct)}function Me(ct){const{onInputBlur:wt}=e;wt&&call(wt,ct)}function Ie(ct){const{onInputFocus:wt}=e;wt&&call(wt,ct)}function Le(){const{onDeactivate:ct}=e;ct&&call(ct)}function le(){const{onActivate:ct}=e;ct&&call(ct)}function oe(ct){const{onClick:wt}=e;wt&&call(wt,ct)}function ke(ct){const{onWrapperFocus:wt}=e;wt&&call(wt,ct)}function Ce(ct){const{onWrapperBlur:wt}=e;wt&&call(wt,ct)}function Ee(){q.value=!0}function Be(ct){q.value=!1,ct.target===f.value?Ve(ct,1):Ve(ct,0)}function Ve(ct,wt=0,St="input"){const Ft=ct.target.value;if(Ue(Ft),ct instanceof InputEvent&&!ct.isComposing&&(q.value=!1),e.type==="textarea"){const{value:jt}=k;jt&&jt.syncUnifiedContainer()}if(_e=Ft,q.value)return;x.recordCursor();const Gt=Oe(Ft);if(Gt)if(!e.pair)St==="input"?Pe(Ft,{source:wt}):be(Ft,{source:wt});else{let{value:jt}=M;Array.isArray(jt)?jt=[jt[0],jt[1]]:jt=["",""],jt[wt]=Ft,St==="input"?Pe(jt,{source:wt}):be(jt,{source:wt})}re.$forceUpdate(),Gt||nextTick(x.restoreCursor)}function Oe(ct){const{countGraphemes:wt,maxlength:St,minlength:Ft}=e;if(wt){let jt;if(St!==void 0&&(jt===void 0&&(jt=wt(ct)),jt>Number(St))||Ft!==void 0&&(jt===void 0&&(jt=wt(ct)),jt<Number(St)))return!1}const{allowInput:Gt}=e;return typeof Gt=="function"?Gt(ct):!0}function je(ct){Me(ct),ct.relatedTarget===w.value&&Le(),ct.relatedTarget!==null&&(ct.relatedTarget===d.value||ct.relatedTarget===f.value||ct.relatedTarget===m.value)||(Y.value=!1),Ke(ct,"blur"),y.value=null}function Ge(ct,wt){Ie(ct),O.value=!0,Y.value=!0,le(),Ke(ct,"focus"),wt===0?y.value=d.value:wt===1?y.value=f.value:wt===2&&(y.value=m.value)}function Xe(ct){e.passivelyActivated&&(Ce(ct),Ke(ct,"blur"))}function qe(ct){e.passivelyActivated&&(O.value=!0,ke(ct),Ke(ct,"focus"))}function Ke(ct,wt){ct.relatedTarget!==null&&(ct.relatedTarget===d.value||ct.relatedTarget===f.value||ct.relatedTarget===m.value||ct.relatedTarget===w.value)||(wt==="focus"?(Ae(ct),O.value=!0):wt==="blur"&&(we(ct),O.value=!1))}function Je(ct,wt){Ve(ct,wt,"change")}function rt(ct){oe(ct)}function ht(ct){$e(ct),vt()}function vt(){e.pair?(Pe(["",""],{source:"clear"}),be(["",""],{source:"clear"})):(Pe("",{source:"clear"}),be("",{source:"clear"}))}function Ct(ct){const{onMousedown:wt}=e;wt&&wt(ct);const{tagName:St}=ct.target;if(St!=="INPUT"&&St!=="TEXTAREA"){if(e.resizable){const{value:Ft}=w;if(Ft){const{left:Gt,top:jt,width:Ut,height:Jt}=Ft.getBoundingClientRect(),un=14;if(Gt+Ut-un<ct.clientX&&ct.clientX<Gt+Ut&&jt+Jt-un<ct.clientY&&ct.clientY<jt+Jt)return}}ct.preventDefault(),O.value||Re()}}function kt(){var ct;F.value=!0,e.type==="textarea"&&((ct=k.value)===null||ct===void 0||ct.handleMouseEnterWrapper())}function mt(){var ct;F.value=!1,e.type==="textarea"&&((ct=k.value)===null||ct===void 0||ct.handleMouseLeaveWrapper())}function Vt(){N.value||j.value==="click"&&(X.value=!X.value)}function bt(ct){if(N.value)return;ct.preventDefault();const wt=Ft=>{Ft.preventDefault(),off$1("mouseup",document,wt)};if(on$1("mouseup",document,wt),j.value!=="mousedown")return;X.value=!0;const St=()=>{X.value=!1,off$1("mouseup",document,St)};on$1("mouseup",document,St)}function ot(ct){e.onKeyup&&call(e.onKeyup,ct)}function gt(ct){switch(e.onKeydown&&call(e.onKeydown,ct),ct.key){case"Escape":ut();break;case"Enter":tt(ct);break}}function tt(ct){var wt,St;if(e.passivelyActivated){const{value:Ft}=Y;if(Ft){e.internalDeactivateOnEnter&&ut();return}ct.preventDefault(),e.type==="textarea"?(wt=m.value)===null||wt===void 0||wt.focus():(St=d.value)===null||St===void 0||St.focus()}}function ut(){e.passivelyActivated&&(Y.value=!1,nextTick(()=>{var ct;(ct=w.value)===null||ct===void 0||ct.focus()}))}function Re(){var ct,wt,St;N.value||(e.passivelyActivated?(ct=w.value)===null||ct===void 0||ct.focus():((wt=m.value)===null||wt===void 0||wt.focus(),(St=d.value)===null||St===void 0||St.focus()))}function Te(){var ct;!((ct=w.value)===null||ct===void 0)&&ct.contains(document.activeElement)&&document.activeElement.blur()}function He(){var ct,wt;(ct=m.value)===null||ct===void 0||ct.select(),(wt=d.value)===null||wt===void 0||wt.select()}function Fe(){N.value||(m.value?m.value.focus():d.value&&d.value.focus())}function ze(){const{value:ct}=w;(ct==null?void 0:ct.contains(document.activeElement))&&ct!==document.activeElement&&ut()}function We(ct){if(e.type==="textarea"){const{value:wt}=m;wt==null||wt.scrollTo(ct)}else{const{value:wt}=d;wt==null||wt.scrollTo(ct)}}function Ue(ct){const{type:wt,pair:St,autosize:Ft}=e;if(!St&&Ft)if(wt==="textarea"){const{value:Gt}=v;Gt&&(Gt.textContent=`${ct!=null?ct:""}\r
`)}else{const{value:Gt}=g;Gt&&(ct?Gt.textContent=ct:Gt.innerHTML="&nbsp;")}}function et(){te()}const it=ref({top:"0"});function nt(ct){var wt;const{scrollTop:St}=ct.target;it.value.top=`${-St}px`,(wt=k.value)===null||wt===void 0||wt.syncUnifiedContainer()}let dt=null;watchEffect(()=>{const{autosize:ct,type:wt}=e;ct&&wt==="textarea"?dt=watch(M,St=>{!Array.isArray(St)&&St!==_e&&Ue(St)}):dt==null||dt()});let xt=null;watchEffect(()=>{e.type==="textarea"?xt=watch(M,ct=>{var wt;!Array.isArray(ct)&&ct!==_e&&((wt=k.value)===null||wt===void 0||wt.syncUnifiedContainer())}):xt==null||xt()}),provide(inputInjectionKey,{mergedValueRef:M,maxlengthRef:Q,mergedClsPrefixRef:n,countGraphemesRef:toRef(e,"countGraphemes")});const yt={wrapperElRef:w,inputElRef:d,textareaElRef:m,isCompositing:q,clear:vt,focus:Re,blur:Te,select:He,deactivate:ze,activate:Fe,scrollTo:We},Bt=useRtl("Input",u,n),Pt=computed(()=>{const{value:ct}=D,{common:{cubicBezierEaseInOut:wt},self:{color:St,borderRadius:Ft,textColor:Gt,caretColor:jt,caretColorError:Ut,caretColorWarning:Jt,textDecorationColor:un,border:nn,borderDisabled:Zt,borderHover:en,borderFocus:Cn,placeholderColor:$n,placeholderColorDisabled:Rn,lineHeightTextarea:Nn,colorDisabled:zn,colorFocus:_i,textColorDisabled:$i,boxShadowFocus:Bo,iconSize:Ar,colorFocusWarning:Mr,boxShadowFocusWarning:$r,borderWarning:Tr,borderFocusWarning:En,borderHoverWarning:kn,colorFocusError:Xo,boxShadowFocusError:na,borderError:ia,borderFocusError:Br,borderHoverError:oa,clearSize:Wn,clearColor:Di,clearColorHover:zi,clearColorPressed:co,iconColor:Wi,iconColorDisabled:Zn,suffixTextColor:oi,countTextColor:Ko,countTextColorDisabled:Vo,iconColorHover:Zo,iconColorPressed:uo,loadingColor:ho,loadingColorError:ei,loadingColorWarning:ra,fontWeight:si,[createKey("padding",ct)]:Jo,[createKey("fontSize",ct)]:Qi,[createKey("height",ct)]:Ni}}=s.value,{left:Lo,right:Qo}=getMargin(Jo);return{"--n-bezier":wt,"--n-count-text-color":Ko,"--n-count-text-color-disabled":Vo,"--n-color":St,"--n-font-size":Qi,"--n-font-weight":si,"--n-border-radius":Ft,"--n-height":Ni,"--n-padding-left":Lo,"--n-padding-right":Qo,"--n-text-color":Gt,"--n-caret-color":jt,"--n-text-decoration-color":un,"--n-border":nn,"--n-border-disabled":Zt,"--n-border-hover":en,"--n-border-focus":Cn,"--n-placeholder-color":$n,"--n-placeholder-color-disabled":Rn,"--n-icon-size":Ar,"--n-line-height-textarea":Nn,"--n-color-disabled":zn,"--n-color-focus":_i,"--n-text-color-disabled":$i,"--n-box-shadow-focus":Bo,"--n-loading-color":ho,"--n-caret-color-warning":Jt,"--n-color-focus-warning":Mr,"--n-box-shadow-focus-warning":$r,"--n-border-warning":Tr,"--n-border-focus-warning":En,"--n-border-hover-warning":kn,"--n-loading-color-warning":ra,"--n-caret-color-error":Ut,"--n-color-focus-error":Xo,"--n-box-shadow-focus-error":na,"--n-border-error":ia,"--n-border-focus-error":Br,"--n-border-hover-error":oa,"--n-loading-color-error":ei,"--n-clear-color":Di,"--n-clear-size":Wn,"--n-clear-color-hover":zi,"--n-clear-color-pressed":co,"--n-icon-color":Wi,"--n-icon-color-hover":Zo,"--n-icon-color-pressed":uo,"--n-icon-color-disabled":Zn,"--n-suffix-text-color":oi}}),Tt=r?useThemeClass("input",computed(()=>{const{value:ct}=D;return ct[0]}),Pt,e):void 0;return Object.assign(Object.assign({},yt),{wrapperElRef:w,inputElRef:d,inputMirrorElRef:g,inputEl2Ref:f,textareaElRef:m,textareaMirrorElRef:v,textareaScrollbarInstRef:k,rtlEnabled:Bt,uncontrolledValue:S,mergedValue:M,passwordVisible:X,mergedPlaceholder:ne,showPlaceholder1:ve,showPlaceholder2:J,mergedFocus:fe,isComposing:q,activated:Y,showClearButton:Z,mergedSize:D,mergedDisabled:N,textDecorationStyle:H,mergedClsPrefix:n,mergedBordered:o,mergedShowPasswordOn:j,placeholderStyle:it,mergedStatus:I,textAreaScrollContainerWidth:U,handleTextAreaScroll:nt,handleCompositionStart:Ee,handleCompositionEnd:Be,handleInput:Ve,handleInputBlur:je,handleInputFocus:Ge,handleWrapperBlur:Xe,handleWrapperFocus:qe,handleMouseEnter:kt,handleMouseLeave:mt,handleMouseDown:Ct,handleChange:Je,handleClick:rt,handleClear:ht,handlePasswordToggleClick:Vt,handlePasswordToggleMousedown:bt,handleWrapperKeydown:gt,handleWrapperKeyup:ot,handleTextAreaMirrorResize:et,getTextareaScrollContainer:()=>m.value,mergedTheme:s,cssVars:r?void 0:Pt,themeClass:Tt==null?void 0:Tt.themeClass,onRender:Tt==null?void 0:Tt.onRender})},render(){var e,n;const{mergedClsPrefix:o,mergedStatus:r,themeClass:u,type:s,countGraphemes:w,onRender:m}=this,v=this.$slots;return m==null||m(),h$1("div",{ref:"wrapperElRef",class:[`${o}-input`,u,r&&`${o}-input--${r}-status`,{[`${o}-input--rtl`]:this.rtlEnabled,[`${o}-input--disabled`]:this.mergedDisabled,[`${o}-input--textarea`]:s==="textarea",[`${o}-input--resizable`]:this.resizable&&!this.autosize,[`${o}-input--autosize`]:this.autosize,[`${o}-input--round`]:this.round&&s!=="textarea",[`${o}-input--pair`]:this.pair,[`${o}-input--focus`]:this.mergedFocus,[`${o}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.handleWrapperKeyup,onKeydown:this.handleWrapperKeydown},h$1("div",{class:`${o}-input-wrapper`},resolveWrappedSlot(v.prefix,g=>g&&h$1("div",{class:`${o}-input__prefix`},g)),s==="textarea"?h$1(NScrollbar,{ref:"textareaScrollbarInstRef",class:`${o}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var g,d;const{textAreaScrollContainerWidth:f}=this,y={width:this.autosize&&f&&`${f}px`};return h$1(Fragment,null,h$1("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${o}-input__textarea-el`,(g=this.inputProps)===null||g===void 0?void 0:g.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:w?void 0:this.maxlength,minlength:w?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(d=this.inputProps)===null||d===void 0?void 0:d.style,y],onBlur:this.handleInputBlur,onFocus:x=>{this.handleInputFocus(x,2)},onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?h$1("div",{class:`${o}-input__placeholder`,style:[this.placeholderStyle,y],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?h$1(VResizeObserver,{onResize:this.handleTextAreaMirrorResize},{default:()=>h$1("div",{ref:"textareaMirrorElRef",class:`${o}-input__textarea-mirror`,key:"mirror"})}):null)}}):h$1("div",{class:`${o}-input__input`},h$1("input",Object.assign({type:s==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":s},this.inputProps,{ref:"inputElRef",class:[`${o}-input__input-el`,(e=this.inputProps)===null||e===void 0?void 0:e.class],style:[this.textDecorationStyle[0],(n=this.inputProps)===null||n===void 0?void 0:n.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:w?void 0:this.maxlength,minlength:w?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:g=>{this.handleInputFocus(g,0)},onInput:g=>{this.handleInput(g,0)},onChange:g=>{this.handleChange(g,0)}})),this.showPlaceholder1?h$1("div",{class:`${o}-input__placeholder`},h$1("span",null,this.mergedPlaceholder[0])):null,this.autosize?h$1("div",{class:`${o}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"},"\xA0"):null),!this.pair&&resolveWrappedSlot(v.suffix,g=>g||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?h$1("div",{class:`${o}-input__suffix`},[resolveWrappedSlot(v["clear-icon-placeholder"],d=>(this.clearable||d)&&h$1(NBaseClear,{clsPrefix:o,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>d,icon:()=>{var f,y;return(y=(f=this.$slots)["clear-icon"])===null||y===void 0?void 0:y.call(f)}})),this.internalLoadingBeforeSuffix?null:g,this.loading!==void 0?h$1(NBaseSuffix,{clsPrefix:o,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?g:null,this.showCount&&this.type!=="textarea"?h$1(WordCount,null,{default:d=>{var f;const{renderCount:y}=this;return y?y(d):(f=v.count)===null||f===void 0?void 0:f.call(v,d)}}):null,this.mergedShowPasswordOn&&this.type==="password"?h$1("div",{class:`${o}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?resolveSlot(v["password-visible-icon"],()=>[h$1(NBaseIcon,{clsPrefix:o},{default:()=>h$1(EyeIcon,null)})]):resolveSlot(v["password-invisible-icon"],()=>[h$1(NBaseIcon,{clsPrefix:o},{default:()=>h$1(EyeOffIcon,null)})])):null]):null)),this.pair?h$1("span",{class:`${o}-input__separator`},resolveSlot(v.separator,()=>[this.separator])):null,this.pair?h$1("div",{class:`${o}-input-wrapper`},h$1("div",{class:`${o}-input__input`},h$1("input",{ref:"inputEl2Ref",type:this.type,class:`${o}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:w?void 0:this.maxlength,minlength:w?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:g=>{this.handleInputFocus(g,1)},onInput:g=>{this.handleInput(g,1)},onChange:g=>{this.handleChange(g,1)}}),this.showPlaceholder2?h$1("div",{class:`${o}-input__placeholder`},h$1("span",null,this.mergedPlaceholder[1])):null),resolveWrappedSlot(v.suffix,g=>(this.clearable||g)&&h$1("div",{class:`${o}-input__suffix`},[this.clearable&&h$1(NBaseClear,{clsPrefix:o,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var d;return(d=v["clear-icon"])===null||d===void 0?void 0:d.call(v)},placeholder:()=>{var d;return(d=v["clear-icon-placeholder"])===null||d===void 0?void 0:d.call(v)}}),g]))):null,this.mergedBordered?h$1("div",{class:`${o}-input__border`}):null,this.mergedBordered?h$1("div",{class:`${o}-input__state-border`}):null,this.showCount&&s==="textarea"?h$1(WordCount,null,{default:g=>{var d;const{renderCount:f}=this;return f?f(g):(d=v.count)===null||d===void 0?void 0:d.call(v,g)}}):null)}}),style$d=cB("input-group",`
 display: inline-flex;
 width: 100%;
 flex-wrap: nowrap;
 vertical-align: bottom;
`,[c$1(">",[cB("input",[c$1("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),c$1("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 margin-left: -1px!important;
 `)]),cB("button",[c$1("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[cE("state-border, border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)]),c$1("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[cE("state-border, border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])]),c$1("*",[c$1("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[c$1(">",[cB("input",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),cB("base-selection",[cB("base-selection-label",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),cB("base-selection-tags",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),cE("box-shadow, border, state-border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)])])]),c$1("&:not(:first-child)",`
 margin-left: -1px!important;
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[c$1(">",[cB("input",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),cB("base-selection",[cB("base-selection-label",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),cB("base-selection-tags",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),cE("box-shadow, border, state-border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])])])])])]),inputGroupProps={},NInputGroup=defineComponent({name:"InputGroup",props:inputGroupProps,setup(e){const{mergedClsPrefixRef:n}=useConfig(e);return useStyle("-input-group",style$d,n),{mergedClsPrefix:n}},render(){const{mergedClsPrefix:e}=this;return h$1("div",{class:`${e}-input-group`},this.$slots)}});function getIsGroup(e){return e.type==="group"}function getIgnored(e){return e.type==="ignored"}function patternMatched(e,n){try{return!!(1+n.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch{return!1}}function createTmOptions(e,n){return{getIsGroup,getIgnored,getKey(r){return getIsGroup(r)?r.name||r.key||"key-required":r[e]},getChildren(r){return r[n]}}}function filterOptions(e,n,o,r){if(!n)return e;function u(s){if(!Array.isArray(s))return[];const w=[];for(const m of s)if(getIsGroup(m)){const v=u(m[r]);v.length&&w.push(Object.assign({},m,{[r]:v}))}else{if(getIgnored(m))continue;n(o,m)&&w.push(m)}return w}return u(e)}function createValOptMap(e,n,o){const r=new Map;return e.forEach(u=>{getIsGroup(u)?u[o].forEach(s=>{r.set(s[n],s)}):r.set(u[n],u)}),r}function createHoverColor(e){return composite(e,[255,255,255,.16])}function createPressedColor(e){return composite(e,[0,0,0,.12])}const buttonGroupInjectionKey="n-button-group",commonVariables$2={paddingTiny:"0 6px",paddingSmall:"0 10px",paddingMedium:"0 14px",paddingLarge:"0 18px",paddingRoundTiny:"0 10px",paddingRoundSmall:"0 14px",paddingRoundMedium:"0 18px",paddingRoundLarge:"0 22px",iconMarginTiny:"6px",iconMarginSmall:"6px",iconMarginMedium:"6px",iconMarginLarge:"6px",iconSizeTiny:"14px",iconSizeSmall:"18px",iconSizeMedium:"18px",iconSizeLarge:"20px",rippleDuration:".6s"};function self$e(e){const{heightTiny:n,heightSmall:o,heightMedium:r,heightLarge:u,borderRadius:s,fontSizeTiny:w,fontSizeSmall:m,fontSizeMedium:v,fontSizeLarge:g,opacityDisabled:d,textColor2:f,textColor3:y,primaryColorHover:x,primaryColorPressed:k,borderColor:P,primaryColor:S,baseColor:E,infoColor:M,infoColorHover:T,infoColorPressed:D,successColor:N,successColorHover:I,successColorPressed:O,warningColor:F,warningColorHover:q,warningColorPressed:Y,errorColor:_e,errorColorHover:ne,errorColorPressed:ve,fontWeight:J,buttonColor2:fe,buttonColor2Hover:Z,buttonColor2Pressed:j,fontWeightStrong:X}=e;return Object.assign(Object.assign({},commonVariables$2),{heightTiny:n,heightSmall:o,heightMedium:r,heightLarge:u,borderRadiusTiny:s,borderRadiusSmall:s,borderRadiusMedium:s,borderRadiusLarge:s,fontSizeTiny:w,fontSizeSmall:m,fontSizeMedium:v,fontSizeLarge:g,opacityDisabled:d,colorOpacitySecondary:"0.16",colorOpacitySecondaryHover:"0.22",colorOpacitySecondaryPressed:"0.28",colorSecondary:fe,colorSecondaryHover:Z,colorSecondaryPressed:j,colorTertiary:fe,colorTertiaryHover:Z,colorTertiaryPressed:j,colorQuaternary:"#0000",colorQuaternaryHover:Z,colorQuaternaryPressed:j,color:"#0000",colorHover:"#0000",colorPressed:"#0000",colorFocus:"#0000",colorDisabled:"#0000",textColor:f,textColorTertiary:y,textColorHover:x,textColorPressed:k,textColorFocus:x,textColorDisabled:f,textColorText:f,textColorTextHover:x,textColorTextPressed:k,textColorTextFocus:x,textColorTextDisabled:f,textColorGhost:f,textColorGhostHover:x,textColorGhostPressed:k,textColorGhostFocus:x,textColorGhostDisabled:f,border:`1px solid ${P}`,borderHover:`1px solid ${x}`,borderPressed:`1px solid ${k}`,borderFocus:`1px solid ${x}`,borderDisabled:`1px solid ${P}`,rippleColor:S,colorPrimary:S,colorHoverPrimary:x,colorPressedPrimary:k,colorFocusPrimary:x,colorDisabledPrimary:S,textColorPrimary:E,textColorHoverPrimary:E,textColorPressedPrimary:E,textColorFocusPrimary:E,textColorDisabledPrimary:E,textColorTextPrimary:S,textColorTextHoverPrimary:x,textColorTextPressedPrimary:k,textColorTextFocusPrimary:x,textColorTextDisabledPrimary:f,textColorGhostPrimary:S,textColorGhostHoverPrimary:x,textColorGhostPressedPrimary:k,textColorGhostFocusPrimary:x,textColorGhostDisabledPrimary:S,borderPrimary:`1px solid ${S}`,borderHoverPrimary:`1px solid ${x}`,borderPressedPrimary:`1px solid ${k}`,borderFocusPrimary:`1px solid ${x}`,borderDisabledPrimary:`1px solid ${S}`,rippleColorPrimary:S,colorInfo:M,colorHoverInfo:T,colorPressedInfo:D,colorFocusInfo:T,colorDisabledInfo:M,textColorInfo:E,textColorHoverInfo:E,textColorPressedInfo:E,textColorFocusInfo:E,textColorDisabledInfo:E,textColorTextInfo:M,textColorTextHoverInfo:T,textColorTextPressedInfo:D,textColorTextFocusInfo:T,textColorTextDisabledInfo:f,textColorGhostInfo:M,textColorGhostHoverInfo:T,textColorGhostPressedInfo:D,textColorGhostFocusInfo:T,textColorGhostDisabledInfo:M,borderInfo:`1px solid ${M}`,borderHoverInfo:`1px solid ${T}`,borderPressedInfo:`1px solid ${D}`,borderFocusInfo:`1px solid ${T}`,borderDisabledInfo:`1px solid ${M}`,rippleColorInfo:M,colorSuccess:N,colorHoverSuccess:I,colorPressedSuccess:O,colorFocusSuccess:I,colorDisabledSuccess:N,textColorSuccess:E,textColorHoverSuccess:E,textColorPressedSuccess:E,textColorFocusSuccess:E,textColorDisabledSuccess:E,textColorTextSuccess:N,textColorTextHoverSuccess:I,textColorTextPressedSuccess:O,textColorTextFocusSuccess:I,textColorTextDisabledSuccess:f,textColorGhostSuccess:N,textColorGhostHoverSuccess:I,textColorGhostPressedSuccess:O,textColorGhostFocusSuccess:I,textColorGhostDisabledSuccess:N,borderSuccess:`1px solid ${N}`,borderHoverSuccess:`1px solid ${I}`,borderPressedSuccess:`1px solid ${O}`,borderFocusSuccess:`1px solid ${I}`,borderDisabledSuccess:`1px solid ${N}`,rippleColorSuccess:N,colorWarning:F,colorHoverWarning:q,colorPressedWarning:Y,colorFocusWarning:q,colorDisabledWarning:F,textColorWarning:E,textColorHoverWarning:E,textColorPressedWarning:E,textColorFocusWarning:E,textColorDisabledWarning:E,textColorTextWarning:F,textColorTextHoverWarning:q,textColorTextPressedWarning:Y,textColorTextFocusWarning:q,textColorTextDisabledWarning:f,textColorGhostWarning:F,textColorGhostHoverWarning:q,textColorGhostPressedWarning:Y,textColorGhostFocusWarning:q,textColorGhostDisabledWarning:F,borderWarning:`1px solid ${F}`,borderHoverWarning:`1px solid ${q}`,borderPressedWarning:`1px solid ${Y}`,borderFocusWarning:`1px solid ${q}`,borderDisabledWarning:`1px solid ${F}`,rippleColorWarning:F,colorError:_e,colorHoverError:ne,colorPressedError:ve,colorFocusError:ne,colorDisabledError:_e,textColorError:E,textColorHoverError:E,textColorPressedError:E,textColorFocusError:E,textColorDisabledError:E,textColorTextError:_e,textColorTextHoverError:ne,textColorTextPressedError:ve,textColorTextFocusError:ne,textColorTextDisabledError:f,textColorGhostError:_e,textColorGhostHoverError:ne,textColorGhostPressedError:ve,textColorGhostFocusError:ne,textColorGhostDisabledError:_e,borderError:`1px solid ${_e}`,borderHoverError:`1px solid ${ne}`,borderPressedError:`1px solid ${ve}`,borderFocusError:`1px solid ${ne}`,borderDisabledError:`1px solid ${_e}`,rippleColorError:_e,waveOpacity:"0.6",fontWeight:J,fontWeightStrong:X})}const buttonLight={name:"Button",common:commonLight,self:self$e},buttonLight$1=buttonLight,style$c=c$1([cB("button",`
 margin: 0;
 font-weight: var(--n-font-weight);
 line-height: 1;
 font-family: inherit;
 padding: var(--n-padding);
 height: var(--n-height);
 font-size: var(--n-font-size);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 width: var(--n-width);
 white-space: nowrap;
 outline: none;
 position: relative;
 z-index: auto;
 border: none;
 display: inline-flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 align-items: center;
 justify-content: center;
 user-select: none;
 -webkit-user-select: none;
 text-align: center;
 cursor: pointer;
 text-decoration: none;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[cM("color",[cE("border",{borderColor:"var(--n-border-color)"}),cM("disabled",[cE("border",{borderColor:"var(--n-border-color-disabled)"})]),cNotM("disabled",[c$1("&:focus",[cE("state-border",{borderColor:"var(--n-border-color-focus)"})]),c$1("&:hover",[cE("state-border",{borderColor:"var(--n-border-color-hover)"})]),c$1("&:active",[cE("state-border",{borderColor:"var(--n-border-color-pressed)"})]),cM("pressed",[cE("state-border",{borderColor:"var(--n-border-color-pressed)"})])])]),cM("disabled",{backgroundColor:"var(--n-color-disabled)",color:"var(--n-text-color-disabled)"},[cE("border",{border:"var(--n-border-disabled)"})]),cNotM("disabled",[c$1("&:focus",{backgroundColor:"var(--n-color-focus)",color:"var(--n-text-color-focus)"},[cE("state-border",{border:"var(--n-border-focus)"})]),c$1("&:hover",{backgroundColor:"var(--n-color-hover)",color:"var(--n-text-color-hover)"},[cE("state-border",{border:"var(--n-border-hover)"})]),c$1("&:active",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[cE("state-border",{border:"var(--n-border-pressed)"})]),cM("pressed",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[cE("state-border",{border:"var(--n-border-pressed)"})])]),cM("loading","cursor: wait;"),cB("base-wave",`
 pointer-events: none;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 animation-iteration-count: 1;
 animation-duration: var(--n-ripple-duration);
 animation-timing-function: var(--n-bezier-ease-out), var(--n-bezier-ease-out);
 `,[cM("active",{zIndex:1,animationName:"button-wave-spread, button-wave-opacity"})]),isBrowser$1&&"MozBoxSizing"in document.createElement("div").style?c$1("&::moz-focus-inner",{border:0}):null,cE("border, state-border",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 border-radius: inherit;
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 `),cE("border",{border:"var(--n-border)"}),cE("state-border",{border:"var(--n-border)",borderColor:"#0000",zIndex:1}),cE("icon",`
 margin: var(--n-icon-margin);
 margin-left: 0;
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 max-width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 position: relative;
 flex-shrink: 0;
 `,[cB("icon-slot",`
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 `,[iconSwitchTransition({top:"50%",originalTransform:"translateY(-50%)"})]),fadeInWidthExpandTransition()]),cE("content",`
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 min-width: 0;
 `,[c$1("~",[cE("icon",{margin:"var(--n-icon-margin)",marginRight:0})])]),cM("block",`
 display: flex;
 width: 100%;
 `),cM("dashed",[cE("border, state-border",{borderStyle:"dashed !important"})]),cM("disabled",{cursor:"not-allowed",opacity:"var(--n-opacity-disabled)"})]),c$1("@keyframes button-wave-spread",{from:{boxShadow:"0 0 0.5px 0 var(--n-ripple-color)"},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)"}}),c$1("@keyframes button-wave-opacity",{from:{opacity:"var(--n-wave-opacity)"},to:{opacity:0}})]),buttonProps=Object.assign(Object.assign({},useTheme.props),{color:String,textColor:String,text:Boolean,block:Boolean,loading:Boolean,disabled:Boolean,circle:Boolean,size:String,ghost:Boolean,round:Boolean,secondary:Boolean,tertiary:Boolean,quaternary:Boolean,strong:Boolean,focusable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},tag:{type:String,default:"button"},type:{type:String,default:"default"},dashed:Boolean,renderIcon:Function,iconPlacement:{type:String,default:"left"},attrType:{type:String,default:"button"},bordered:{type:Boolean,default:!0},onClick:[Function,Array],nativeFocusBehavior:{type:Boolean,default:!isSafari}}),Button=defineComponent({name:"Button",props:buttonProps,slots:Object,setup(e){const n=ref(null),o=ref(null),r=ref(!1),u=useMemo(()=>!e.quaternary&&!e.tertiary&&!e.secondary&&!e.text&&(!e.color||e.ghost||e.dashed)&&e.bordered),s=inject(buttonGroupInjectionKey,{}),{mergedSizeRef:w}=useFormItem({},{defaultSize:"medium",mergedSize:D=>{const{size:N}=e;if(N)return N;const{size:I}=s;if(I)return I;const{mergedSize:O}=D||{};return O?O.value:"medium"}}),m=computed(()=>e.focusable&&!e.disabled),v=D=>{var N;m.value||D.preventDefault(),!e.nativeFocusBehavior&&(D.preventDefault(),!e.disabled&&m.value&&((N=n.value)===null||N===void 0||N.focus({preventScroll:!0})))},g=D=>{var N;if(!e.disabled&&!e.loading){const{onClick:I}=e;I&&call(I,D),e.text||(N=o.value)===null||N===void 0||N.play()}},d=D=>{switch(D.key){case"Enter":if(!e.keyboard)return;r.value=!1}},f=D=>{switch(D.key){case"Enter":if(!e.keyboard||e.loading){D.preventDefault();return}r.value=!0}},y=()=>{r.value=!1},{inlineThemeDisabled:x,mergedClsPrefixRef:k,mergedRtlRef:P}=useConfig(e),S=useTheme("Button","-button",style$c,buttonLight$1,e,k),E=useRtl("Button",P,k),M=computed(()=>{const D=S.value,{common:{cubicBezierEaseInOut:N,cubicBezierEaseOut:I},self:O}=D,{rippleDuration:F,opacityDisabled:q,fontWeight:Y,fontWeightStrong:_e}=O,ne=w.value,{dashed:ve,type:J,ghost:fe,text:Z,color:j,round:X,circle:H,textColor:U,secondary:te,tertiary:Q,quaternary:re,strong:Pe}=e,be={"--n-font-weight":Pe?_e:Y};let we={"--n-color":"initial","--n-color-hover":"initial","--n-color-pressed":"initial","--n-color-focus":"initial","--n-color-disabled":"initial","--n-ripple-color":"initial","--n-text-color":"initial","--n-text-color-hover":"initial","--n-text-color-pressed":"initial","--n-text-color-focus":"initial","--n-text-color-disabled":"initial"};const Ae=J==="tertiary",$e=J==="default",Me=Ae?"default":J;if(Z){const je=U||j;we={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":"#0000","--n-text-color":je||O[createKey("textColorText",Me)],"--n-text-color-hover":je?createHoverColor(je):O[createKey("textColorTextHover",Me)],"--n-text-color-pressed":je?createPressedColor(je):O[createKey("textColorTextPressed",Me)],"--n-text-color-focus":je?createHoverColor(je):O[createKey("textColorTextHover",Me)],"--n-text-color-disabled":je||O[createKey("textColorTextDisabled",Me)]}}else if(fe||ve){const je=U||j;we={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":j||O[createKey("rippleColor",Me)],"--n-text-color":je||O[createKey("textColorGhost",Me)],"--n-text-color-hover":je?createHoverColor(je):O[createKey("textColorGhostHover",Me)],"--n-text-color-pressed":je?createPressedColor(je):O[createKey("textColorGhostPressed",Me)],"--n-text-color-focus":je?createHoverColor(je):O[createKey("textColorGhostHover",Me)],"--n-text-color-disabled":je||O[createKey("textColorGhostDisabled",Me)]}}else if(te){const je=$e?O.textColor:Ae?O.textColorTertiary:O[createKey("color",Me)],Ge=j||je,Xe=J!=="default"&&J!=="tertiary";we={"--n-color":Xe?changeColor(Ge,{alpha:Number(O.colorOpacitySecondary)}):O.colorSecondary,"--n-color-hover":Xe?changeColor(Ge,{alpha:Number(O.colorOpacitySecondaryHover)}):O.colorSecondaryHover,"--n-color-pressed":Xe?changeColor(Ge,{alpha:Number(O.colorOpacitySecondaryPressed)}):O.colorSecondaryPressed,"--n-color-focus":Xe?changeColor(Ge,{alpha:Number(O.colorOpacitySecondaryHover)}):O.colorSecondaryHover,"--n-color-disabled":O.colorSecondary,"--n-ripple-color":"#0000","--n-text-color":Ge,"--n-text-color-hover":Ge,"--n-text-color-pressed":Ge,"--n-text-color-focus":Ge,"--n-text-color-disabled":Ge}}else if(Q||re){const je=$e?O.textColor:Ae?O.textColorTertiary:O[createKey("color",Me)],Ge=j||je;Q?(we["--n-color"]=O.colorTertiary,we["--n-color-hover"]=O.colorTertiaryHover,we["--n-color-pressed"]=O.colorTertiaryPressed,we["--n-color-focus"]=O.colorSecondaryHover,we["--n-color-disabled"]=O.colorTertiary):(we["--n-color"]=O.colorQuaternary,we["--n-color-hover"]=O.colorQuaternaryHover,we["--n-color-pressed"]=O.colorQuaternaryPressed,we["--n-color-focus"]=O.colorQuaternaryHover,we["--n-color-disabled"]=O.colorQuaternary),we["--n-ripple-color"]="#0000",we["--n-text-color"]=Ge,we["--n-text-color-hover"]=Ge,we["--n-text-color-pressed"]=Ge,we["--n-text-color-focus"]=Ge,we["--n-text-color-disabled"]=Ge}else we={"--n-color":j||O[createKey("color",Me)],"--n-color-hover":j?createHoverColor(j):O[createKey("colorHover",Me)],"--n-color-pressed":j?createPressedColor(j):O[createKey("colorPressed",Me)],"--n-color-focus":j?createHoverColor(j):O[createKey("colorFocus",Me)],"--n-color-disabled":j||O[createKey("colorDisabled",Me)],"--n-ripple-color":j||O[createKey("rippleColor",Me)],"--n-text-color":U||(j?O.textColorPrimary:Ae?O.textColorTertiary:O[createKey("textColor",Me)]),"--n-text-color-hover":U||(j?O.textColorHoverPrimary:O[createKey("textColorHover",Me)]),"--n-text-color-pressed":U||(j?O.textColorPressedPrimary:O[createKey("textColorPressed",Me)]),"--n-text-color-focus":U||(j?O.textColorFocusPrimary:O[createKey("textColorFocus",Me)]),"--n-text-color-disabled":U||(j?O.textColorDisabledPrimary:O[createKey("textColorDisabled",Me)])};let Ie={"--n-border":"initial","--n-border-hover":"initial","--n-border-pressed":"initial","--n-border-focus":"initial","--n-border-disabled":"initial"};Z?Ie={"--n-border":"none","--n-border-hover":"none","--n-border-pressed":"none","--n-border-focus":"none","--n-border-disabled":"none"}:Ie={"--n-border":O[createKey("border",Me)],"--n-border-hover":O[createKey("borderHover",Me)],"--n-border-pressed":O[createKey("borderPressed",Me)],"--n-border-focus":O[createKey("borderFocus",Me)],"--n-border-disabled":O[createKey("borderDisabled",Me)]};const{[createKey("height",ne)]:Le,[createKey("fontSize",ne)]:le,[createKey("padding",ne)]:oe,[createKey("paddingRound",ne)]:ke,[createKey("iconSize",ne)]:Ce,[createKey("borderRadius",ne)]:Ee,[createKey("iconMargin",ne)]:Be,waveOpacity:Ve}=O,Oe={"--n-width":H&&!Z?Le:"initial","--n-height":Z?"initial":Le,"--n-font-size":le,"--n-padding":H||Z?"initial":X?ke:oe,"--n-icon-size":Ce,"--n-icon-margin":Be,"--n-border-radius":Z?"initial":H||X?Le:Ee};return Object.assign(Object.assign(Object.assign(Object.assign({"--n-bezier":N,"--n-bezier-ease-out":I,"--n-ripple-duration":F,"--n-opacity-disabled":q,"--n-wave-opacity":Ve},be),we),Ie),Oe)}),T=x?useThemeClass("button",computed(()=>{let D="";const{dashed:N,type:I,ghost:O,text:F,color:q,round:Y,circle:_e,textColor:ne,secondary:ve,tertiary:J,quaternary:fe,strong:Z}=e;N&&(D+="a"),O&&(D+="b"),F&&(D+="c"),Y&&(D+="d"),_e&&(D+="e"),ve&&(D+="f"),J&&(D+="g"),fe&&(D+="h"),Z&&(D+="i"),q&&(D+=`j${color2Class(q)}`),ne&&(D+=`k${color2Class(ne)}`);const{value:j}=w;return D+=`l${j[0]}`,D+=`m${I[0]}`,D}),M,e):void 0;return{selfElRef:n,waveElRef:o,mergedClsPrefix:k,mergedFocusable:m,mergedSize:w,showBorder:u,enterPressed:r,rtlEnabled:E,handleMousedown:v,handleKeydown:f,handleBlur:y,handleKeyup:d,handleClick:g,customColorCssVars:computed(()=>{const{color:D}=e;if(!D)return null;const N=createHoverColor(D);return{"--n-border-color":D,"--n-border-color-hover":N,"--n-border-color-pressed":createPressedColor(D),"--n-border-color-focus":N,"--n-border-color-disabled":D}}),cssVars:x?void 0:M,themeClass:T==null?void 0:T.themeClass,onRender:T==null?void 0:T.onRender}},render(){const{mergedClsPrefix:e,tag:n,onRender:o}=this;o==null||o();const r=resolveWrappedSlot(this.$slots.default,u=>u&&h$1("span",{class:`${e}-button__content`},u));return h$1(n,{ref:"selfElRef",class:[this.themeClass,`${e}-button`,`${e}-button--${this.type}-type`,`${e}-button--${this.mergedSize}-type`,this.rtlEnabled&&`${e}-button--rtl`,this.disabled&&`${e}-button--disabled`,this.block&&`${e}-button--block`,this.enterPressed&&`${e}-button--pressed`,!this.text&&this.dashed&&`${e}-button--dashed`,this.color&&`${e}-button--color`,this.secondary&&`${e}-button--secondary`,this.loading&&`${e}-button--loading`,this.ghost&&`${e}-button--ghost`],tabindex:this.mergedFocusable?0:-1,type:this.attrType,style:this.cssVars,disabled:this.disabled,onClick:this.handleClick,onBlur:this.handleBlur,onMousedown:this.handleMousedown,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},this.iconPlacement==="right"&&r,h$1(NFadeInExpandTransition,{width:!0},{default:()=>resolveWrappedSlot(this.$slots.icon,u=>(this.loading||this.renderIcon||u)&&h$1("span",{class:`${e}-button__icon`,style:{margin:isSlotEmpty(this.$slots.default)?"0":""}},h$1(NIconSwitchTransition,null,{default:()=>this.loading?h$1(NBaseLoading,{clsPrefix:e,key:"loading",class:`${e}-icon-slot`,strokeWidth:20}):h$1("div",{key:"icon",class:`${e}-icon-slot`,role:"none"},this.renderIcon?this.renderIcon():u)})))}),this.iconPlacement==="left"&&r,this.text?null:h$1(NBaseWave,{ref:"waveElRef",clsPrefix:e}),this.showBorder?h$1("div",{"aria-hidden":!0,class:`${e}-button__border`,style:this.customColorCssVars}):null,this.showBorder?h$1("div",{"aria-hidden":!0,class:`${e}-button__state-border`,style:this.customColorCssVars}):null)}}),NButton=Button,XButton=Button,commonVariables$1={paddingSmall:"12px 16px 12px",paddingMedium:"19px 24px 20px",paddingLarge:"23px 32px 24px",paddingHuge:"27px 40px 28px",titleFontSizeSmall:"16px",titleFontSizeMedium:"18px",titleFontSizeLarge:"18px",titleFontSizeHuge:"18px",closeIconSize:"18px",closeSize:"22px"};function self$d(e){const{primaryColor:n,borderRadius:o,lineHeight:r,fontSize:u,cardColor:s,textColor2:w,textColor1:m,dividerColor:v,fontWeightStrong:g,closeIconColor:d,closeIconColorHover:f,closeIconColorPressed:y,closeColorHover:x,closeColorPressed:k,modalColor:P,boxShadow1:S,popoverColor:E,actionColor:M}=e;return Object.assign(Object.assign({},commonVariables$1),{lineHeight:r,color:s,colorModal:P,colorPopover:E,colorTarget:n,colorEmbedded:M,colorEmbeddedModal:M,colorEmbeddedPopover:M,textColor:w,titleTextColor:m,borderColor:v,actionColor:M,titleFontWeight:g,closeColorHover:x,closeColorPressed:k,closeBorderRadius:o,closeIconColor:d,closeIconColorHover:f,closeIconColorPressed:y,fontSizeSmall:u,fontSizeMedium:u,fontSizeLarge:u,fontSizeHuge:u,boxShadow:S,borderRadius:o})}const cardLight={name:"Card",common:commonLight,self:self$d},cardLight$1=cardLight,style$b=c$1([cB("card",`
 font-size: var(--n-font-size);
 line-height: var(--n-line-height);
 display: flex;
 flex-direction: column;
 width: 100%;
 box-sizing: border-box;
 position: relative;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 color: var(--n-text-color);
 word-break: break-word;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[asModal({background:"var(--n-color-modal)"}),cM("hoverable",[c$1("&:hover","box-shadow: var(--n-box-shadow);")]),cM("content-segmented",[c$1(">",[cE("content",{paddingTop:"var(--n-padding-bottom)"})])]),cM("content-soft-segmented",[c$1(">",[cE("content",`
 margin: 0 var(--n-padding-left);
 padding: var(--n-padding-bottom) 0;
 `)])]),cM("footer-segmented",[c$1(">",[cE("footer",{paddingTop:"var(--n-padding-bottom)"})])]),cM("footer-soft-segmented",[c$1(">",[cE("footer",`
 padding: var(--n-padding-bottom) 0;
 margin: 0 var(--n-padding-left);
 `)])]),c$1(">",[cB("card-header",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 padding:
 var(--n-padding-top)
 var(--n-padding-left)
 var(--n-padding-bottom)
 var(--n-padding-left);
 `,[cE("main",`
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 min-width: 0;
 color: var(--n-title-text-color);
 `),cE("extra",`
 display: flex;
 align-items: center;
 font-size: var(--n-font-size);
 font-weight: 400;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),cE("close",`
 margin: 0 0 0 8px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),cE("action",`
 box-sizing: border-box;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 background-clip: padding-box;
 background-color: var(--n-action-color);
 `),cE("content","flex: 1; min-width: 0;"),cE("content, footer",`
 box-sizing: border-box;
 padding: 0 var(--n-padding-left) var(--n-padding-bottom) var(--n-padding-left);
 font-size: var(--n-font-size);
 `,[c$1("&:first-child",{paddingTop:"var(--n-padding-bottom)"})]),cE("action",`
 background-color: var(--n-action-color);
 padding: var(--n-padding-bottom) var(--n-padding-left);
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `)]),cB("card-cover",`
 overflow: hidden;
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 `,[c$1("img",`
 display: block;
 width: 100%;
 `)]),cM("bordered",`
 border: 1px solid var(--n-border-color);
 `,[c$1("&:target","border-color: var(--n-color-target);")]),cM("action-segmented",[c$1(">",[cE("action",[c$1("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),cM("content-segmented, content-soft-segmented",[c$1(">",[cE("content",{transition:"border-color 0.3s var(--n-bezier)"},[c$1("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),cM("footer-segmented, footer-soft-segmented",[c$1(">",[cE("footer",{transition:"border-color 0.3s var(--n-bezier)"},[c$1("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),cM("embedded",`
 background-color: var(--n-color-embedded);
 `)]),insideModal(cB("card",`
 background: var(--n-color-modal);
 `,[cM("embedded",`
 background-color: var(--n-color-embedded-modal);
 `)])),insidePopover(cB("card",`
 background: var(--n-color-popover);
 `,[cM("embedded",`
 background-color: var(--n-color-embedded-popover);
 `)]))]),cardBaseProps={title:[String,Function],contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],headerExtraClass:String,headerExtraStyle:[Object,String],footerClass:String,footerStyle:[Object,String],embedded:Boolean,segmented:{type:[Boolean,Object],default:!1},size:{type:String,default:"medium"},bordered:{type:Boolean,default:!0},closable:Boolean,hoverable:Boolean,role:String,onClose:[Function,Array],tag:{type:String,default:"div"},cover:Function,content:[String,Function],footer:Function,action:Function,headerExtra:Function},cardBasePropKeys=keysOf(cardBaseProps),cardProps=Object.assign(Object.assign({},useTheme.props),cardBaseProps),NCard=defineComponent({name:"Card",props:cardProps,slots:Object,setup(e){const n=()=>{const{onClose:g}=e;g&&call(g)},{inlineThemeDisabled:o,mergedClsPrefixRef:r,mergedRtlRef:u}=useConfig(e),s=useTheme("Card","-card",style$b,cardLight$1,e,r),w=useRtl("Card",u,r),m=computed(()=>{const{size:g}=e,{self:{color:d,colorModal:f,colorTarget:y,textColor:x,titleTextColor:k,titleFontWeight:P,borderColor:S,actionColor:E,borderRadius:M,lineHeight:T,closeIconColor:D,closeIconColorHover:N,closeIconColorPressed:I,closeColorHover:O,closeColorPressed:F,closeBorderRadius:q,closeIconSize:Y,closeSize:_e,boxShadow:ne,colorPopover:ve,colorEmbedded:J,colorEmbeddedModal:fe,colorEmbeddedPopover:Z,[createKey("padding",g)]:j,[createKey("fontSize",g)]:X,[createKey("titleFontSize",g)]:H},common:{cubicBezierEaseInOut:U}}=s.value,{top:te,left:Q,bottom:re}=getMargin(j);return{"--n-bezier":U,"--n-border-radius":M,"--n-color":d,"--n-color-modal":f,"--n-color-popover":ve,"--n-color-embedded":J,"--n-color-embedded-modal":fe,"--n-color-embedded-popover":Z,"--n-color-target":y,"--n-text-color":x,"--n-line-height":T,"--n-action-color":E,"--n-title-text-color":k,"--n-title-font-weight":P,"--n-close-icon-color":D,"--n-close-icon-color-hover":N,"--n-close-icon-color-pressed":I,"--n-close-color-hover":O,"--n-close-color-pressed":F,"--n-border-color":S,"--n-box-shadow":ne,"--n-padding-top":te,"--n-padding-bottom":re,"--n-padding-left":Q,"--n-font-size":X,"--n-title-font-size":H,"--n-close-size":_e,"--n-close-icon-size":Y,"--n-close-border-radius":q}}),v=o?useThemeClass("card",computed(()=>e.size[0]),m,e):void 0;return{rtlEnabled:w,mergedClsPrefix:r,mergedTheme:s,handleCloseClick:n,cssVars:o?void 0:m,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender}},render(){const{segmented:e,bordered:n,hoverable:o,mergedClsPrefix:r,rtlEnabled:u,onRender:s,embedded:w,tag:m,$slots:v}=this;return s==null||s(),h$1(m,{class:[`${r}-card`,this.themeClass,w&&`${r}-card--embedded`,{[`${r}-card--rtl`]:u,[`${r}-card--content${typeof e!="boolean"&&e.content==="soft"?"-soft":""}-segmented`]:e===!0||e!==!1&&e.content,[`${r}-card--footer${typeof e!="boolean"&&e.footer==="soft"?"-soft":""}-segmented`]:e===!0||e!==!1&&e.footer,[`${r}-card--action-segmented`]:e===!0||e!==!1&&e.action,[`${r}-card--bordered`]:n,[`${r}-card--hoverable`]:o}],style:this.cssVars,role:this.role},resolveWrappedSlot(v.cover,g=>{const d=this.cover?ensureValidVNode([this.cover()]):g;return d&&h$1("div",{class:`${r}-card-cover`,role:"none"},d)}),resolveWrappedSlot(v.header,g=>{const{title:d}=this,f=d?ensureValidVNode(typeof d=="function"?[d()]:[d]):g;return f||this.closable?h$1("div",{class:[`${r}-card-header`,this.headerClass],style:this.headerStyle,role:"heading"},h$1("div",{class:`${r}-card-header__main`,role:"heading"},f),resolveWrappedSlot(v["header-extra"],y=>{const x=this.headerExtra?ensureValidVNode([this.headerExtra()]):y;return x&&h$1("div",{class:[`${r}-card-header__extra`,this.headerExtraClass],style:this.headerExtraStyle},x)}),this.closable&&h$1(NBaseClose,{clsPrefix:r,class:`${r}-card-header__close`,onClick:this.handleCloseClick,absolute:!0})):null}),resolveWrappedSlot(v.default,g=>{const{content:d}=this,f=d?ensureValidVNode(typeof d=="function"?[d()]:[d]):g;return f&&h$1("div",{class:[`${r}-card__content`,this.contentClass],style:this.contentStyle,role:"none"},f)}),resolveWrappedSlot(v.footer,g=>{const d=this.footer?ensureValidVNode([this.footer()]):g;return d&&h$1("div",{class:[`${r}-card__footer`,this.footerClass],style:this.footerStyle,role:"none"},d)}),resolveWrappedSlot(v.action,g=>{const d=this.action?ensureValidVNode([this.action()]):g;return d&&h$1("div",{class:`${r}-card__action`,role:"none"},d)}))}});function self$c(e){const{fontSize:n,boxShadow2:o,popoverColor:r,textColor2:u,borderRadius:s,borderColor:w,heightSmall:m,heightMedium:v,heightLarge:g,fontSizeSmall:d,fontSizeMedium:f,fontSizeLarge:y,dividerColor:x}=e;return{panelFontSize:n,boxShadow:o,color:r,textColor:u,borderRadius:s,border:`1px solid ${w}`,heightSmall:m,heightMedium:v,heightLarge:g,fontSizeSmall:d,fontSizeMedium:f,fontSizeLarge:y,dividerColor:x}}const colorPickerLight={name:"ColorPicker",common:commonLight,peers:{Input:inputLight$1,Button:buttonLight$1},self:self$c},colorPickerLight$1=colorPickerLight;function deriveDefaultValue(e,n){switch(e[0]){case"hex":return n?"#000000FF":"#000000";case"rgb":return n?"rgba(0, 0, 0, 1)":"rgb(0, 0, 0)";case"hsl":return n?"hsla(0, 0%, 0%, 1)":"hsl(0, 0%, 0%)";case"hsv":return n?"hsva(0, 0%, 0%, 1)":"hsv(0, 0%, 0%)"}return"#000000"}function getModeFromValue(e){return e===null?null:/^ *#/.test(e)?"hex":e.includes("rgb")?"rgb":e.includes("hsl")?"hsl":e.includes("hsv")?"hsv":null}function normalizeHue(e){return e=Math.round(e),e>=360?359:e<0?0:e}function normalizeAlpha(e){return e=Math.round(e*100)/100,e>1?1:e<0?0:e}const convert={rgb:{hex(e){return toHexaString(rgba(e))},hsl(e){const[n,o,r,u]=rgba(e);return toHslaString([...rgb2hsl(n,o,r),u])},hsv(e){const[n,o,r,u]=rgba(e);return toHsvaString([...rgb2hsv(n,o,r),u])}},hex:{rgb(e){return toRgbaString(rgba(e))},hsl(e){const[n,o,r,u]=rgba(e);return toHslaString([...rgb2hsl(n,o,r),u])},hsv(e){const[n,o,r,u]=rgba(e);return toHsvaString([...rgb2hsv(n,o,r),u])}},hsl:{hex(e){const[n,o,r,u]=hsla(e);return toHexaString([...hsl2rgb(n,o,r),u])},rgb(e){const[n,o,r,u]=hsla(e);return toRgbaString([...hsl2rgb(n,o,r),u])},hsv(e){const[n,o,r,u]=hsla(e);return toHsvaString([...hsl2hsv(n,o,r),u])}},hsv:{hex(e){const[n,o,r,u]=hsva(e);return toHexaString([...hsv2rgb(n,o,r),u])},rgb(e){const[n,o,r,u]=hsva(e);return toRgbaString([...hsv2rgb(n,o,r),u])},hsl(e){const[n,o,r,u]=hsva(e);return toHslaString([...hsv2hsl(n,o,r),u])}}};function convertColor$1(e,n,o){return o=o||getModeFromValue(e),o?o===n?e:convert[o][n](e):null}const HANDLE_SIZE$2="12px",HANDLE_SIZE_NUM$1=12,RADIUS$2="6px",AlphaSlider=defineComponent({name:"AlphaSlider",props:{clsPrefix:{type:String,required:!0},rgba:{type:Array,default:null},alpha:{type:Number,default:0},onUpdateAlpha:{type:Function,required:!0},onComplete:Function},setup(e){const n=ref(null);function o(s){!n.value||!e.rgba||(on$1("mousemove",document,r),on$1("mouseup",document,u),r(s))}function r(s){const{value:w}=n;if(!w)return;const{width:m,left:v}=w.getBoundingClientRect(),g=(s.clientX-v)/(m-HANDLE_SIZE_NUM$1);e.onUpdateAlpha(normalizeAlpha(g))}function u(){var s;off$1("mousemove",document,r),off$1("mouseup",document,u),(s=e.onComplete)===null||s===void 0||s.call(e)}return{railRef:n,railBackgroundImage:computed(()=>{const{rgba:s}=e;return s?`linear-gradient(to right, rgba(${s[0]}, ${s[1]}, ${s[2]}, 0) 0%, rgba(${s[0]}, ${s[1]}, ${s[2]}, 1) 100%)`:""}),handleMouseDown:o}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-color-picker-slider`,ref:"railRef",style:{height:HANDLE_SIZE$2,borderRadius:RADIUS$2},onMousedown:this.handleMouseDown},h$1("div",{style:{borderRadius:RADIUS$2,position:"absolute",left:0,right:0,top:0,bottom:0,overflow:"hidden"}},h$1("div",{class:`${e}-color-picker-checkboard`}),h$1("div",{class:`${e}-color-picker-slider__image`,style:{backgroundImage:this.railBackgroundImage}})),this.rgba&&h$1("div",{style:{position:"absolute",left:RADIUS$2,right:RADIUS$2,top:0,bottom:0}},h$1("div",{class:`${e}-color-picker-handle`,style:{left:`calc(${this.alpha*100}% - ${RADIUS$2})`,borderRadius:RADIUS$2,width:HANDLE_SIZE$2,height:HANDLE_SIZE$2}},h$1("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:toRgbaString(this.rgba),borderRadius:RADIUS$2,width:HANDLE_SIZE$2,height:HANDLE_SIZE$2}}))))}}),colorPickerInjectionKey="n-color-picker";function normalizeRgbUnit(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(Number.parseInt(e),255)):!1}function normalizeHueUnit(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(Number.parseInt(e),360)):!1}function normalizeSlvUnit(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(Number.parseInt(e),100)):!1}function normalizeHexaUnit(e){const n=e.trim();return/^#[0-9a-fA-F]+$/.test(n)?[4,5,7,9].includes(n.length):!1}function normalizeAlphaUnit(e){return/^\d{1,3}\.?\d*%$/.test(e.trim())?Math.max(0,Math.min(Number.parseInt(e)/100,100)):!1}const inputThemeOverrides={paddingSmall:"0 4px"},ColorInputUnit=defineComponent({name:"ColorInputUnit",props:{label:{type:String,required:!0},value:{type:[Number,String],default:null},showAlpha:Boolean,onUpdateValue:{type:Function,required:!0}},setup(e){const n=ref(""),{themeRef:o}=inject(colorPickerInjectionKey,null);watchEffect(()=>{n.value=r()});function r(){const{value:w}=e;if(w===null)return"";const{label:m}=e;return m==="HEX"?w:m==="A"?`${Math.floor(w*100)}%`:String(Math.floor(w))}function u(w){n.value=w}function s(w){let m,v;switch(e.label){case"HEX":v=normalizeHexaUnit(w),v&&e.onUpdateValue(w),n.value=r();break;case"H":m=normalizeHueUnit(w),m===!1?n.value=r():e.onUpdateValue(m);break;case"S":case"L":case"V":m=normalizeSlvUnit(w),m===!1?n.value=r():e.onUpdateValue(m);break;case"A":m=normalizeAlphaUnit(w),m===!1?n.value=r():e.onUpdateValue(m);break;case"R":case"G":case"B":m=normalizeRgbUnit(w),m===!1?n.value=r():e.onUpdateValue(m);break}}return{mergedTheme:o,inputValue:n,handleInputChange:s,handleInputUpdateValue:u}},render(){const{mergedTheme:e}=this;return h$1(NInput,{size:"small",placeholder:this.label,theme:e.peers.Input,themeOverrides:e.peerOverrides.Input,builtinThemeOverrides:inputThemeOverrides,value:this.inputValue,onUpdateValue:this.handleInputUpdateValue,onChange:this.handleInputChange,style:this.label==="A"?"flex-grow: 1.25;":""})}}),ColorInput=defineComponent({name:"ColorInput",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},modes:{type:Array,required:!0},showAlpha:{type:Boolean,required:!0},value:{type:String,default:null},valueArr:{type:Array,default:null},onUpdateValue:{type:Function,required:!0},onUpdateMode:{type:Function,required:!0}},setup(e){return{handleUnitUpdateValue(n,o){const{showAlpha:r}=e;if(e.mode==="hex"){e.onUpdateValue((r?toHexaString:toHexString)(o));return}let u;switch(e.valueArr===null?u=[0,0,0,0]:u=Array.from(e.valueArr),e.mode){case"hsv":u[n]=o,e.onUpdateValue((r?toHsvaString:toHsvString)(u));break;case"rgb":u[n]=o,e.onUpdateValue((r?toRgbaString:toRgbString)(u));break;case"hsl":u[n]=o,e.onUpdateValue((r?toHslaString:toHslString)(u));break}}}},render(){const{clsPrefix:e,modes:n}=this;return h$1("div",{class:`${e}-color-picker-input`},h$1("div",{class:`${e}-color-picker-input__mode`,onClick:this.onUpdateMode,style:{cursor:n.length===1?"":"pointer"}},this.mode.toUpperCase()+(this.showAlpha?"A":"")),h$1(NInputGroup,null,{default:()=>{const{mode:o,valueArr:r,showAlpha:u}=this;if(o==="hex"){let s=null;try{s=r===null?null:(u?toHexaString:toHexString)(r)}catch{}return h$1(ColorInputUnit,{label:"HEX",showAlpha:u,value:s,onUpdateValue:w=>{this.handleUnitUpdateValue(0,w)}})}return(o+(u?"a":"")).split("").map((s,w)=>h$1(ColorInputUnit,{label:s.toUpperCase(),value:r===null?null:r[w],onUpdateValue:m=>{this.handleUnitUpdateValue(w,m)}}))}}))}});function normalizeColor(e,n){if(n==="hsv"){const[o,r,u,s]=hsva(e);return toRgbaString([...hsv2rgb(o,r,u),s])}return e}function getHexFromName(e){const n=document.createElement("canvas").getContext("2d");return n?(n.fillStyle=e,n.fillStyle):"#000000"}const ColorPickerSwatches=defineComponent({name:"ColorPickerSwatches",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},swatches:{type:Array,required:!0},onUpdateColor:{type:Function,required:!0}},setup(e){const n=computed(()=>e.swatches.map(s=>{const w=getModeFromValue(s);return{value:s,mode:w,legalValue:normalizeColor(s,w)}}));function o(s){const{mode:w}=e;let{value:m,mode:v}=s;return v||(v="hex",/^[a-zA-Z]+$/.test(m)?m=getHexFromName(m):(warn("color-picker",`color ${m} in swatches is invalid.`),m="#000000")),v===w?m:convertColor$1(m,w,v)}function r(s){e.onUpdateColor(o(s))}function u(s,w){s.key==="Enter"&&r(w)}return{parsedSwatchesRef:n,handleSwatchSelect:r,handleSwatchKeyDown:u}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-color-picker-swatches`},this.parsedSwatchesRef.map(n=>h$1("div",{class:`${e}-color-picker-swatch`,tabindex:0,onClick:()=>{this.handleSwatchSelect(n)},onKeydown:o=>{this.handleSwatchKeyDown(o,n)}},h$1("div",{class:`${e}-color-picker-swatch__fill`,style:{background:n.legalValue}}))))}}),ColorPickerTrigger=defineComponent({name:"ColorPickerTrigger",slots:Object,props:{clsPrefix:{type:String,required:!0},value:{type:String,default:null},hsla:{type:Array,default:null},disabled:Boolean,onClick:Function},setup(e){const{colorPickerSlots:n,renderLabelRef:o}=inject(colorPickerInjectionKey,null);return()=>{const{hsla:r,value:u,clsPrefix:s,onClick:w,disabled:m}=e,v=n.label||o.value;return h$1("div",{class:[`${s}-color-picker-trigger`,m&&`${s}-color-picker-trigger--disabled`],onClick:m?void 0:w},h$1("div",{class:`${s}-color-picker-trigger__fill`},h$1("div",{class:`${s}-color-picker-checkboard`}),h$1("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:r?toHslaString(r):""}}),u&&r?h$1("div",{class:`${s}-color-picker-trigger__value`,style:{color:r[2]>50||r[3]<.5?"black":"white"}},v?v(u):u):null))}}}),ColorPreview=defineComponent({name:"ColorPreview",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},color:{type:String,default:null,validator:e=>{const n=getModeFromValue(e);return Boolean(!e||n&&n!=="hsv")}},onUpdateColor:{type:Function,required:!0}},setup(e){function n(o){var r;const u=o.target.value;(r=e.onUpdateColor)===null||r===void 0||r.call(e,convertColor$1(u.toUpperCase(),e.mode,"hex")),o.stopPropagation()}return{handleChange:n}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-color-picker-preview__preview`},h$1("span",{class:`${e}-color-picker-preview__fill`,style:{background:this.color||"#000000"}}),h$1("input",{class:`${e}-color-picker-preview__input`,type:"color",value:this.color,onChange:this.handleChange}))}}),HANDLE_SIZE$1="12px",HANDLE_SIZE_NUM=12,RADIUS$1="6px",RADIUS_NUM=6,GRADIENT="linear-gradient(90deg,red,#ff0 16.66%,#0f0 33.33%,#0ff 50%,#00f 66.66%,#f0f 83.33%,red)",HueSlider=defineComponent({name:"HueSlider",props:{clsPrefix:{type:String,required:!0},hue:{type:Number,required:!0},onUpdateHue:{type:Function,required:!0},onComplete:Function},setup(e){const n=ref(null);function o(s){!n.value||(on$1("mousemove",document,r),on$1("mouseup",document,u),r(s))}function r(s){const{value:w}=n;if(!w)return;const{width:m,left:v}=w.getBoundingClientRect(),g=normalizeHue((s.clientX-v-RADIUS_NUM)/(m-HANDLE_SIZE_NUM)*360);e.onUpdateHue(g)}function u(){var s;off$1("mousemove",document,r),off$1("mouseup",document,u),(s=e.onComplete)===null||s===void 0||s.call(e)}return{railRef:n,handleMouseDown:o}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-color-picker-slider`,style:{height:HANDLE_SIZE$1,borderRadius:RADIUS$1}},h$1("div",{ref:"railRef",style:{boxShadow:"inset 0 0 2px 0 rgba(0, 0, 0, .24)",boxSizing:"border-box",backgroundImage:GRADIENT,height:HANDLE_SIZE$1,borderRadius:RADIUS$1,position:"relative"},onMousedown:this.handleMouseDown},h$1("div",{style:{position:"absolute",left:RADIUS$1,right:RADIUS$1,top:0,bottom:0}},h$1("div",{class:`${e}-color-picker-handle`,style:{left:`calc((${this.hue}%) / 359 * 100 - ${RADIUS$1})`,borderRadius:RADIUS$1,width:HANDLE_SIZE$1,height:HANDLE_SIZE$1}},h$1("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:`hsl(${this.hue}, 100%, 50%)`,borderRadius:RADIUS$1,width:HANDLE_SIZE$1,height:HANDLE_SIZE$1}})))))}}),HANDLE_SIZE="12px",RADIUS="6px",Pallete=defineComponent({name:"Pallete",props:{clsPrefix:{type:String,required:!0},rgba:{type:Array,default:null},displayedHue:{type:Number,required:!0},displayedSv:{type:Array,required:!0},onUpdateSV:{type:Function,required:!0},onComplete:Function},setup(e){const n=ref(null);function o(s){!n.value||(on$1("mousemove",document,r),on$1("mouseup",document,u),r(s))}function r(s){const{value:w}=n;if(!w)return;const{width:m,height:v,left:g,bottom:d}=w.getBoundingClientRect(),f=(d-s.clientY)/v,y=(s.clientX-g)/m,x=100*(y>1?1:y<0?0:y),k=100*(f>1?1:f<0?0:f);e.onUpdateSV(x,k)}function u(){var s;off$1("mousemove",document,r),off$1("mouseup",document,u),(s=e.onComplete)===null||s===void 0||s.call(e)}return{palleteRef:n,handleColor:computed(()=>{const{rgba:s}=e;return s?`rgb(${s[0]}, ${s[1]}, ${s[2]})`:""}),handleMouseDown:o}},render(){const{clsPrefix:e}=this;return h$1("div",{class:`${e}-color-picker-pallete`,onMousedown:this.handleMouseDown,ref:"palleteRef"},h$1("div",{class:`${e}-color-picker-pallete__layer`,style:{backgroundImage:`linear-gradient(90deg, white, hsl(${this.displayedHue}, 100%, 50%))`}}),h$1("div",{class:`${e}-color-picker-pallete__layer ${e}-color-picker-pallete__layer--shadowed`,style:{backgroundImage:"linear-gradient(180deg, rgba(0, 0, 0, 0%), rgba(0, 0, 0, 100%))"}}),this.rgba&&h$1("div",{class:`${e}-color-picker-handle`,style:{width:HANDLE_SIZE,height:HANDLE_SIZE,borderRadius:RADIUS,left:`calc(${this.displayedSv[0]}% - ${RADIUS})`,bottom:`calc(${this.displayedSv[1]}% - ${RADIUS})`}},h$1("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:this.handleColor,borderRadius:RADIUS,width:HANDLE_SIZE,height:HANDLE_SIZE}})))}}),style$a=c$1([cB("color-picker",`
 display: inline-block;
 box-sizing: border-box;
 height: var(--n-height);
 font-size: var(--n-font-size);
 width: 100%;
 position: relative;
 `),cB("color-picker-panel",`
 margin: 4px 0;
 width: 240px;
 font-size: var(--n-panel-font-size);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 `,[fadeInScaleUpTransition(),cB("input",`
 text-align: center;
 `)]),cB("color-picker-checkboard",`
 background: white; 
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[c$1("&::after",`
 background-image: linear-gradient(45deg, #DDD 25%, #0000 25%), linear-gradient(-45deg, #DDD 25%, #0000 25%), linear-gradient(45deg, #0000 75%, #DDD 75%), linear-gradient(-45deg, #0000 75%, #DDD 75%);
 background-size: 12px 12px;
 background-position: 0 0, 0 6px, 6px -6px, -6px 0px;
 background-repeat: repeat;
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),cB("color-picker-slider",`
 margin-bottom: 8px;
 position: relative;
 box-sizing: border-box;
 `,[cE("image",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `),c$1("&::after",`
 content: "";
 position: absolute;
 border-radius: inherit;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 box-shadow: inset 0 0 2px 0 rgba(0, 0, 0, .24);
 pointer-events: none;
 `)]),cB("color-picker-handle",`
 z-index: 1;
 box-shadow: 0 0 2px 0 rgba(0, 0, 0, .45);
 position: absolute;
 background-color: white;
 overflow: hidden;
 `,[cE("fill",`
 box-sizing: border-box;
 border: 2px solid white;
 `)]),cB("color-picker-pallete",`
 height: 180px;
 position: relative;
 margin-bottom: 8px;
 cursor: crosshair;
 `,[cE("layer",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[cM("shadowed",`
 box-shadow: inset 0 0 2px 0 rgba(0, 0, 0, .24);
 `)])]),cB("color-picker-preview",`
 display: flex;
 `,[cE("sliders",`
 flex: 1 0 auto;
 `),cE("preview",`
 position: relative;
 height: 30px;
 width: 30px;
 margin: 0 0 8px 6px;
 border-radius: 50%;
 box-shadow: rgba(0, 0, 0, .15) 0px 0px 0px 1px inset;
 overflow: hidden;
 `),cE("fill",`
 display: block;
 width: 30px;
 height: 30px;
 `),cE("input",`
 position: absolute;
 top: 0;
 left: 0;
 width: 30px;
 height: 30px;
 opacity: 0;
 z-index: 1;
 `)]),cB("color-picker-input",`
 display: flex;
 align-items: center;
 `,[cB("input",`
 flex-grow: 1;
 flex-basis: 0;
 `),cE("mode",`
 width: 72px;
 text-align: center;
 `)]),cB("color-picker-control",`
 padding: 12px;
 `),cB("color-picker-action",`
 display: flex;
 margin-top: -4px;
 border-top: 1px solid var(--n-divider-color);
 padding: 8px 12px;
 justify-content: flex-end;
 `,[cB("button","margin-left: 8px;")]),cB("color-picker-trigger",`
 border: var(--n-border);
 height: 100%;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 cursor: pointer;
 `,[cE("value",`
 white-space: nowrap;
 position: relative;
 `),cE("fill",`
 border-radius: var(--n-border-radius);
 position: absolute;
 display: flex;
 align-items: center;
 justify-content: center;
 left: 4px;
 right: 4px;
 top: 4px;
 bottom: 4px;
 `),cM("disabled","cursor: not-allowed"),cB("color-picker-checkboard",`
 border-radius: var(--n-border-radius);
 `,[c$1("&::after",`
 --n-block-size: calc((var(--n-height) - 8px) / 3);
 background-size: calc(var(--n-block-size) * 2) calc(var(--n-block-size) * 2);
 background-position: 0 0, 0 var(--n-block-size), var(--n-block-size) calc(-1 * var(--n-block-size)), calc(-1 * var(--n-block-size)) 0px; 
 `)])]),cB("color-picker-swatches",`
 display: grid;
 grid-gap: 8px;
 flex-wrap: wrap;
 position: relative;
 grid-template-columns: repeat(auto-fill, 18px);
 margin-top: 10px;
 `,[cB("color-picker-swatch",`
 width: 18px;
 height: 18px;
 background-image: linear-gradient(45deg, #DDD 25%, #0000 25%), linear-gradient(-45deg, #DDD 25%, #0000 25%), linear-gradient(45deg, #0000 75%, #DDD 75%), linear-gradient(-45deg, #0000 75%, #DDD 75%);
 background-size: 8px 8px;
 background-position: 0px 0, 0px 4px, 4px -4px, -4px 0px;
 background-repeat: repeat;
 `,[cE("fill",`
 position: relative;
 width: 100%;
 height: 100%;
 border-radius: 3px;
 box-shadow: rgba(0, 0, 0, .15) 0px 0px 0px 1px inset;
 cursor: pointer;
 `),c$1("&:focus",`
 outline: none;
 `,[cE("fill",[c$1("&::after",`
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 background: inherit;
 filter: blur(2px);
 content: "";
 `)])])])])]),colorPickerProps=Object.assign(Object.assign({},useTheme.props),{value:String,show:{type:Boolean,default:void 0},defaultShow:Boolean,defaultValue:String,modes:{type:Array,default:()=>["rgb","hex","hsl"]},placement:{type:String,default:"bottom-start"},to:useAdjustedTo.propTo,showAlpha:{type:Boolean,default:!0},showPreview:Boolean,swatches:Array,disabled:{type:Boolean,default:void 0},actions:{type:Array,default:null},internalActions:Array,size:String,renderLabel:Function,onComplete:Function,onConfirm:Function,onClear:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array]}),NColorPicker=defineComponent({name:"ColorPicker",props:colorPickerProps,slots:Object,setup(e,{slots:n}){const o=ref(null);let r=null;const u=useFormItem(e),{mergedSizeRef:s,mergedDisabledRef:w}=u,{localeRef:m}=useLocale("global"),{mergedClsPrefixRef:v,namespaceRef:g,inlineThemeDisabled:d}=useConfig(e),f=useTheme("ColorPicker","-color-picker",style$a,colorPickerLight$1,e,v);provide(colorPickerInjectionKey,{themeRef:f,renderLabelRef:toRef(e,"renderLabel"),colorPickerSlots:n});const y=ref(e.defaultShow),x=useMergedState(toRef(e,"show"),y);function k(Ve){const{onUpdateShow:Oe,"onUpdate:show":je}=e;Oe&&call(Oe,Ve),je&&call(je,Ve),y.value=Ve}const{defaultValue:P}=e,S=ref(P===void 0?deriveDefaultValue(e.modes,e.showAlpha):P),E=useMergedState(toRef(e,"value"),S),M=ref([E.value]),T=ref(0),D=computed(()=>getModeFromValue(E.value)),{modes:N}=e,I=ref(getModeFromValue(E.value)||N[0]||"rgb");function O(){const{modes:Ve}=e,{value:Oe}=I,je=Ve.findIndex(Ge=>Ge===Oe);~je?I.value=Ve[(je+1)%Ve.length]:I.value="rgb"}let F,q,Y,_e,ne,ve,J,fe;const Z=computed(()=>{const{value:Ve}=E;if(!Ve)return null;switch(D.value){case"hsv":return hsva(Ve);case"hsl":return[F,q,Y,fe]=hsla(Ve),[...hsl2hsv(F,q,Y),fe];case"rgb":case"hex":return[ne,ve,J,fe]=rgba(Ve),[...rgb2hsv(ne,ve,J),fe]}}),j=computed(()=>{const{value:Ve}=E;if(!Ve)return null;switch(D.value){case"rgb":case"hex":return rgba(Ve);case"hsv":return[F,q,_e,fe]=hsva(Ve),[...hsv2rgb(F,q,_e),fe];case"hsl":return[F,q,Y,fe]=hsla(Ve),[...hsl2rgb(F,q,Y),fe]}}),X=computed(()=>{const{value:Ve}=E;if(!Ve)return null;switch(D.value){case"hsl":return hsla(Ve);case"hsv":return[F,q,_e,fe]=hsva(Ve),[...hsv2hsl(F,q,_e),fe];case"rgb":case"hex":return[ne,ve,J,fe]=rgba(Ve),[...rgb2hsl(ne,ve,J),fe]}}),H=computed(()=>{switch(I.value){case"rgb":case"hex":return j.value;case"hsv":return Z.value;case"hsl":return X.value}}),U=ref(0),te=ref(1),Q=ref([0,0]);function re(Ve,Oe){const{value:je}=Z,Ge=U.value,Xe=je?je[3]:1;Q.value=[Ve,Oe];const{showAlpha:qe}=e;switch(I.value){case"hsv":we((qe?toHsvaString:toHsvString)([Ge,Ve,Oe,Xe]),"cursor");break;case"hsl":we((qe?toHslaString:toHslString)([...hsv2hsl(Ge,Ve,Oe),Xe]),"cursor");break;case"rgb":we((qe?toRgbaString:toRgbString)([...hsv2rgb(Ge,Ve,Oe),Xe]),"cursor");break;case"hex":we((qe?toHexaString:toHexString)([...hsv2rgb(Ge,Ve,Oe),Xe]),"cursor");break}}function Pe(Ve){U.value=Ve;const{value:Oe}=Z;if(!Oe)return;const[,je,Ge,Xe]=Oe,{showAlpha:qe}=e;switch(I.value){case"hsv":we((qe?toHsvaString:toHsvString)([Ve,je,Ge,Xe]),"cursor");break;case"rgb":we((qe?toRgbaString:toRgbString)([...hsv2rgb(Ve,je,Ge),Xe]),"cursor");break;case"hex":we((qe?toHexaString:toHexString)([...hsv2rgb(Ve,je,Ge),Xe]),"cursor");break;case"hsl":we((qe?toHslaString:toHslString)([...hsv2hsl(Ve,je,Ge),Xe]),"cursor");break}}function be(Ve){switch(I.value){case"hsv":[F,q,_e]=Z.value,we(toHsvaString([F,q,_e,Ve]),"cursor");break;case"rgb":[ne,ve,J]=j.value,we(toRgbaString([ne,ve,J,Ve]),"cursor");break;case"hex":[ne,ve,J]=j.value,we(toHexaString([ne,ve,J,Ve]),"cursor");break;case"hsl":[F,q,Y]=X.value,we(toHslaString([F,q,Y,Ve]),"cursor");break}te.value=Ve}function we(Ve,Oe){Oe==="cursor"?r=Ve:r=null;const{nTriggerFormChange:je,nTriggerFormInput:Ge}=u,{onUpdateValue:Xe,"onUpdate:value":qe}=e;Xe&&call(Xe,Ve),qe&&call(qe,Ve),je(),Ge(),S.value=Ve}function Ae(Ve){we(Ve,"input"),nextTick($e)}function $e(Ve=!0){const{value:Oe}=E;if(Oe){const{nTriggerFormChange:je,nTriggerFormInput:Ge}=u,{onComplete:Xe}=e;Xe&&Xe(Oe);const{value:qe}=M,{value:Ke}=T;Ve&&(qe.splice(Ke+1,qe.length,Oe),T.value=Ke+1),je(),Ge()}}function Me(){const{value:Ve}=T;Ve-1<0||(we(M.value[Ve-1],"input"),$e(!1),T.value=Ve-1)}function Ie(){const{value:Ve}=T;Ve<0||Ve+1>=M.value.length||(we(M.value[Ve+1],"input"),$e(!1),T.value=Ve+1)}function Le(){we(null,"input");const{onClear:Ve}=e;Ve&&Ve(),k(!1)}function le(){const{value:Ve}=E,{onConfirm:Oe}=e;Oe&&Oe(Ve),k(!1)}const oe=computed(()=>T.value>=1),ke=computed(()=>{const{value:Ve}=M;return Ve.length>1&&T.value<Ve.length-1});watch(x,Ve=>{Ve||(M.value=[E.value],T.value=0)}),watchEffect(()=>{if(!(r&&r===E.value)){const{value:Ve}=Z;Ve&&(U.value=Ve[0],te.value=Ve[3],Q.value=[Ve[1],Ve[2]])}r=null});const Ce=computed(()=>{const{value:Ve}=s,{common:{cubicBezierEaseInOut:Oe},self:{textColor:je,color:Ge,panelFontSize:Xe,boxShadow:qe,border:Ke,borderRadius:Je,dividerColor:rt,[createKey("height",Ve)]:ht,[createKey("fontSize",Ve)]:vt}}=f.value;return{"--n-bezier":Oe,"--n-text-color":je,"--n-color":Ge,"--n-panel-font-size":Xe,"--n-font-size":vt,"--n-box-shadow":qe,"--n-border":Ke,"--n-border-radius":Je,"--n-height":ht,"--n-divider-color":rt}}),Ee=d?useThemeClass("color-picker",computed(()=>s.value[0]),Ce,e):void 0;function Be(){var Ve;const{value:Oe}=j,{value:je}=U,{internalActions:Ge,modes:Xe,actions:qe}=e,{value:Ke}=f,{value:Je}=v;return h$1("div",{class:[`${Je}-color-picker-panel`,Ee==null?void 0:Ee.themeClass.value],onDragstart:rt=>{rt.preventDefault()},style:d?void 0:Ce.value},h$1("div",{class:`${Je}-color-picker-control`},h$1(Pallete,{clsPrefix:Je,rgba:Oe,displayedHue:je,displayedSv:Q.value,onUpdateSV:re,onComplete:$e}),h$1("div",{class:`${Je}-color-picker-preview`},h$1("div",{class:`${Je}-color-picker-preview__sliders`},h$1(HueSlider,{clsPrefix:Je,hue:je,onUpdateHue:Pe,onComplete:$e}),e.showAlpha?h$1(AlphaSlider,{clsPrefix:Je,rgba:Oe,alpha:te.value,onUpdateAlpha:be,onComplete:$e}):null),e.showPreview?h$1(ColorPreview,{clsPrefix:Je,mode:I.value,color:j.value&&toHexString(j.value),onUpdateColor:rt=>{we(rt,"input")}}):null),h$1(ColorInput,{clsPrefix:Je,showAlpha:e.showAlpha,mode:I.value,modes:Xe,onUpdateMode:O,value:E.value,valueArr:H.value,onUpdateValue:Ae}),((Ve=e.swatches)===null||Ve===void 0?void 0:Ve.length)&&h$1(ColorPickerSwatches,{clsPrefix:Je,mode:I.value,swatches:e.swatches,onUpdateColor:rt=>{we(rt,"input")}})),qe!=null&&qe.length?h$1("div",{class:`${Je}-color-picker-action`},qe.includes("confirm")&&h$1(NButton,{size:"small",onClick:le,theme:Ke.peers.Button,themeOverrides:Ke.peerOverrides.Button},{default:()=>m.value.confirm}),qe.includes("clear")&&h$1(NButton,{size:"small",onClick:Le,disabled:!E.value,theme:Ke.peers.Button,themeOverrides:Ke.peerOverrides.Button},{default:()=>m.value.clear})):null,n.action?h$1("div",{class:`${Je}-color-picker-action`},{default:n.action}):Ge?h$1("div",{class:`${Je}-color-picker-action`},Ge.includes("undo")&&h$1(NButton,{size:"small",onClick:Me,disabled:!oe.value,theme:Ke.peers.Button,themeOverrides:Ke.peerOverrides.Button},{default:()=>m.value.undo}),Ge.includes("redo")&&h$1(NButton,{size:"small",onClick:Ie,disabled:!ke.value,theme:Ke.peers.Button,themeOverrides:Ke.peerOverrides.Button},{default:()=>m.value.redo})):null)}return{mergedClsPrefix:v,namespace:g,selfRef:o,hsla:X,rgba:j,mergedShow:x,mergedDisabled:w,isMounted:isMounted(),adjustedTo:useAdjustedTo(e),mergedValue:E,handleTriggerClick(){k(!0)},handleClickOutside(Ve){var Oe;!((Oe=o.value)===null||Oe===void 0)&&Oe.contains(getPreciseEventTarget(Ve))||k(!1)},renderPanel:Be,cssVars:d?void 0:Ce,themeClass:Ee==null?void 0:Ee.themeClass,onRender:Ee==null?void 0:Ee.onRender}},render(){const{mergedClsPrefix:e,onRender:n}=this;return n==null||n(),h$1("div",{class:[this.themeClass,`${e}-color-picker`],ref:"selfRef",style:this.cssVars},h$1(VBinder,null,{default:()=>[h$1(VTarget,null,{default:()=>h$1(ColorPickerTrigger,{clsPrefix:e,value:this.mergedValue,hsla:this.hsla,disabled:this.mergedDisabled,onClick:this.handleTriggerClick})}),h$1(VFollower,{placement:this.placement,show:this.mergedShow,containerClass:this.namespace,teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey,to:this.adjustedTo},{default:()=>h$1(Transition,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.mergedShow?withDirectives(this.renderPanel(),[[clickoutside$1,this.handleClickOutside,void 0,{capture:!0}]]):null})})]}))}}),configProviderProps={abstract:Boolean,bordered:{type:Boolean,default:void 0},clsPrefix:String,locale:Object,dateLocale:Object,namespace:String,rtl:Array,tag:{type:String,default:"div"},hljs:Object,katex:Object,theme:Object,themeOverrides:Object,componentOptions:Object,icons:Object,breakpoints:Object,preflightStyleDisabled:Boolean,styleMountTarget:Object,inlineThemeDisabled:{type:Boolean,default:void 0},as:{type:String,validator:()=>(warn("config-provider","`as` is deprecated, please use `tag` instead."),!0),default:void 0}},NConfigProvider=defineComponent({name:"ConfigProvider",alias:["App"],props:configProviderProps,setup(e){const n=inject(configProviderInjectionKey,null),o=computed(()=>{const{theme:P}=e;if(P===null)return;const S=n==null?void 0:n.mergedThemeRef.value;return P===void 0?S:S===void 0?P:Object.assign({},S,P)}),r=computed(()=>{const{themeOverrides:P}=e;if(P!==null){if(P===void 0)return n==null?void 0:n.mergedThemeOverridesRef.value;{const S=n==null?void 0:n.mergedThemeOverridesRef.value;return S===void 0?P:merge$3({},S,P)}}}),u=useMemo(()=>{const{namespace:P}=e;return P===void 0?n==null?void 0:n.mergedNamespaceRef.value:P}),s=useMemo(()=>{const{bordered:P}=e;return P===void 0?n==null?void 0:n.mergedBorderedRef.value:P}),w=computed(()=>{const{icons:P}=e;return P===void 0?n==null?void 0:n.mergedIconsRef.value:P}),m=computed(()=>{const{componentOptions:P}=e;return P!==void 0?P:n==null?void 0:n.mergedComponentPropsRef.value}),v=computed(()=>{const{clsPrefix:P}=e;return P!==void 0?P:n?n.mergedClsPrefixRef.value:defaultClsPrefix}),g=computed(()=>{var P;const{rtl:S}=e;if(S===void 0)return n==null?void 0:n.mergedRtlRef.value;const E={};for(const M of S)E[M.name]=markRaw(M),(P=M.peers)===null||P===void 0||P.forEach(T=>{T.name in E||(E[T.name]=markRaw(T))});return E}),d=computed(()=>e.breakpoints||(n==null?void 0:n.mergedBreakpointsRef.value)),f=e.inlineThemeDisabled||(n==null?void 0:n.inlineThemeDisabled),y=e.preflightStyleDisabled||(n==null?void 0:n.preflightStyleDisabled),x=e.styleMountTarget||(n==null?void 0:n.styleMountTarget),k=computed(()=>{const{value:P}=o,{value:S}=r,E=S&&Object.keys(S).length!==0,M=P==null?void 0:P.name;return M?E?`${M}-${murmur2(JSON.stringify(r.value))}`:M:E?murmur2(JSON.stringify(r.value)):""});return provide(configProviderInjectionKey,{mergedThemeHashRef:k,mergedBreakpointsRef:d,mergedRtlRef:g,mergedIconsRef:w,mergedComponentPropsRef:m,mergedBorderedRef:s,mergedNamespaceRef:u,mergedClsPrefixRef:v,mergedLocaleRef:computed(()=>{const{locale:P}=e;if(P!==null)return P===void 0?n==null?void 0:n.mergedLocaleRef.value:P}),mergedDateLocaleRef:computed(()=>{const{dateLocale:P}=e;if(P!==null)return P===void 0?n==null?void 0:n.mergedDateLocaleRef.value:P}),mergedHljsRef:computed(()=>{const{hljs:P}=e;return P===void 0?n==null?void 0:n.mergedHljsRef.value:P}),mergedKatexRef:computed(()=>{const{katex:P}=e;return P===void 0?n==null?void 0:n.mergedKatexRef.value:P}),mergedThemeRef:o,mergedThemeOverridesRef:r,inlineThemeDisabled:f||!1,preflightStyleDisabled:y||!1,styleMountTarget:x}),{mergedClsPrefix:v,mergedBordered:s,mergedNamespace:u,mergedTheme:o,mergedThemeOverrides:r}},render(){var e,n,o,r;return this.abstract?(r=(o=this.$slots).default)===null||r===void 0?void 0:r.call(o):h$1(this.as||this.tag,{class:`${this.mergedClsPrefix||defaultClsPrefix}-config-provider`},(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e))}});function self$b(e){const{boxShadow2:n}=e;return{menuBoxShadow:n}}const popselectLight={name:"Popselect",common:commonLight,peers:{Popover:popoverLight$1,InternalSelectMenu:internalSelectMenuLight$1},self:self$b},popselectLight$1=popselectLight,popselectInjectionKey="n-popselect",style$9=cB("popselect-menu",`
 box-shadow: var(--n-menu-box-shadow);
`),panelProps={multiple:Boolean,value:{type:[String,Number,Array],default:null},cancelable:Boolean,options:{type:Array,default:()=>[]},size:{type:String,default:"medium"},scrollable:Boolean,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onMouseenter:Function,onMouseleave:Function,renderLabel:Function,showCheckmark:{type:Boolean,default:void 0},nodeProps:Function,virtualScroll:Boolean,onChange:[Function,Array]},panelPropKeys=keysOf(panelProps),NPopselectPanel=defineComponent({name:"PopselectPanel",props:panelProps,setup(e){const n=inject(popselectInjectionKey),{mergedClsPrefixRef:o,inlineThemeDisabled:r}=useConfig(e),u=useTheme("Popselect","-pop-select",style$9,popselectLight$1,n.props,o),s=computed(()=>createTreeMate(e.options,createTmOptions("value","children")));function w(y,x){const{onUpdateValue:k,"onUpdate:value":P,onChange:S}=e;k&&call(k,y,x),P&&call(P,y,x),S&&call(S,y,x)}function m(y){g(y.key)}function v(y){!happensIn(y,"action")&&!happensIn(y,"empty")&&!happensIn(y,"header")&&y.preventDefault()}function g(y){const{value:{getNode:x}}=s;if(e.multiple)if(Array.isArray(e.value)){const k=[],P=[];let S=!0;e.value.forEach(E=>{if(E===y){S=!1;return}const M=x(E);M&&(k.push(M.key),P.push(M.rawNode))}),S&&(k.push(y),P.push(x(y).rawNode)),w(k,P)}else{const k=x(y);k&&w([y],[k.rawNode])}else if(e.value===y&&e.cancelable)w(null,null);else{const k=x(y);k&&w(y,k.rawNode);const{"onUpdate:show":P,onUpdateShow:S}=n.props;P&&call(P,!1),S&&call(S,!1),n.setShow(!1)}nextTick(()=>{n.syncPosition()})}watch(toRef(e,"options"),()=>{nextTick(()=>{n.syncPosition()})});const d=computed(()=>{const{self:{menuBoxShadow:y}}=u.value;return{"--n-menu-box-shadow":y}}),f=r?useThemeClass("select",void 0,d,n.props):void 0;return{mergedTheme:n.mergedThemeRef,mergedClsPrefix:o,treeMate:s,handleToggle:m,handleMenuMousedown:v,cssVars:r?void 0:d,themeClass:f==null?void 0:f.themeClass,onRender:f==null?void 0:f.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),h$1(NInternalSelectMenu,{clsPrefix:this.mergedClsPrefix,focusable:!0,nodeProps:this.nodeProps,class:[`${this.mergedClsPrefix}-popselect-menu`,this.themeClass],style:this.cssVars,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,multiple:this.multiple,treeMate:this.treeMate,size:this.size,value:this.value,virtualScroll:this.virtualScroll,scrollable:this.scrollable,renderLabel:this.renderLabel,onToggle:this.handleToggle,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseenter,onMousedown:this.handleMenuMousedown,showCheckmark:this.showCheckmark},{header:()=>{var n,o;return((o=(n=this.$slots).header)===null||o===void 0?void 0:o.call(n))||[]},action:()=>{var n,o;return((o=(n=this.$slots).action)===null||o===void 0?void 0:o.call(n))||[]},empty:()=>{var n,o;return((o=(n=this.$slots).empty)===null||o===void 0?void 0:o.call(n))||[]}})}}),popselectProps=Object.assign(Object.assign(Object.assign(Object.assign({},useTheme.props),omit(popoverBaseProps,["showArrow","arrow"])),{placement:Object.assign(Object.assign({},popoverBaseProps.placement),{default:"bottom"}),trigger:{type:String,default:"hover"}}),panelProps),NPopselect=defineComponent({name:"Popselect",props:popselectProps,slots:Object,inheritAttrs:!1,__popover__:!0,setup(e){const{mergedClsPrefixRef:n}=useConfig(e),o=useTheme("Popselect","-popselect",void 0,popselectLight$1,e,n),r=ref(null);function u(){var m;(m=r.value)===null||m===void 0||m.syncPosition()}function s(m){var v;(v=r.value)===null||v===void 0||v.setShow(m)}return provide(popselectInjectionKey,{props:e,mergedThemeRef:o,syncPosition:u,setShow:s}),Object.assign(Object.assign({},{syncPosition:u,setShow:s}),{popoverInstRef:r,mergedTheme:o})},render(){const{mergedTheme:e}=this,n={theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:{padding:"0"},ref:"popoverInstRef",internalRenderBody:(o,r,u,s,w)=>{const{$attrs:m}=this;return h$1(NPopselectPanel,Object.assign({},m,{class:[m.class,o],style:[m.style,...u]},keep(this.$props,panelPropKeys),{ref:createRefSetter(r),onMouseenter:mergeEventHandlers([s,m.onMouseenter]),onMouseleave:mergeEventHandlers([w,m.onMouseleave])}),{header:()=>{var v,g;return(g=(v=this.$slots).header)===null||g===void 0?void 0:g.call(v)},action:()=>{var v,g;return(g=(v=this.$slots).action)===null||g===void 0?void 0:g.call(v)},empty:()=>{var v,g;return(g=(v=this.$slots).empty)===null||g===void 0?void 0:g.call(v)}})}};return h$1(NPopover,Object.assign({},omit(this.$props,panelPropKeys),n,{internalDeactivateImmediately:!0}),{trigger:()=>{var o,r;return(r=(o=this.$slots).default)===null||r===void 0?void 0:r.call(o)}})}});function self$a(e){const{boxShadow2:n}=e;return{menuBoxShadow:n}}const selectLight={name:"Select",common:commonLight,peers:{InternalSelection:internalSelectionLight$1,InternalSelectMenu:internalSelectMenuLight$1},self:self$a},selectLight$1=selectLight,style$8=c$1([cB("select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 font-weight: var(--n-font-weight);
 `),cB("select-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[fadeInScaleUpTransition({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),selectProps=Object.assign(Object.assign({},useTheme.props),{to:useAdjustedTo.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,menuSize:{type:String},filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],ellipsisTagPopoverProps:Object,consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),NSelect=defineComponent({name:"Select",props:selectProps,slots:Object,setup(e){const{mergedClsPrefixRef:n,mergedBorderedRef:o,namespaceRef:r,inlineThemeDisabled:u}=useConfig(e),s=useTheme("Select","-select",style$8,selectLight$1,e,n),w=ref(e.defaultValue),m=toRef(e,"value"),v=useMergedState(m,w),g=ref(!1),d=ref(""),f=useCompitable(e,["items","options"]),y=ref([]),x=ref([]),k=computed(()=>x.value.concat(y.value).concat(f.value)),P=computed(()=>{const{filter:tt}=e;if(tt)return tt;const{labelField:ut,valueField:Re}=e;return(Te,He)=>{if(!He)return!1;const Fe=He[ut];if(typeof Fe=="string")return patternMatched(Te,Fe);const ze=He[Re];return typeof ze=="string"?patternMatched(Te,ze):typeof ze=="number"?patternMatched(Te,String(ze)):!1}}),S=computed(()=>{if(e.remote)return f.value;{const{value:tt}=k,{value:ut}=d;return!ut.length||!e.filterable?tt:filterOptions(tt,P.value,ut,e.childrenField)}}),E=computed(()=>{const{valueField:tt,childrenField:ut}=e,Re=createTmOptions(tt,ut);return createTreeMate(S.value,Re)}),M=computed(()=>createValOptMap(k.value,e.valueField,e.childrenField)),T=ref(!1),D=useMergedState(toRef(e,"show"),T),N=ref(null),I=ref(null),O=ref(null),{localeRef:F}=useLocale("Select"),q=computed(()=>{var tt;return(tt=e.placeholder)!==null&&tt!==void 0?tt:F.value.placeholder}),Y=[],_e=ref(new Map),ne=computed(()=>{const{fallbackOption:tt}=e;if(tt===void 0){const{labelField:ut,valueField:Re}=e;return Te=>({[ut]:String(Te),[Re]:Te})}return tt===!1?!1:ut=>Object.assign(tt(ut),{value:ut})});function ve(tt){const ut=e.remote,{value:Re}=_e,{value:Te}=M,{value:He}=ne,Fe=[];return tt.forEach(ze=>{if(Te.has(ze))Fe.push(Te.get(ze));else if(ut&&Re.has(ze))Fe.push(Re.get(ze));else if(He){const We=He(ze);We&&Fe.push(We)}}),Fe}const J=computed(()=>{if(e.multiple){const{value:tt}=v;return Array.isArray(tt)?ve(tt):[]}return null}),fe=computed(()=>{const{value:tt}=v;return!e.multiple&&!Array.isArray(tt)?tt===null?null:ve([tt])[0]||null:null}),Z=useFormItem(e),{mergedSizeRef:j,mergedDisabledRef:X,mergedStatusRef:H}=Z;function U(tt,ut){const{onChange:Re,"onUpdate:value":Te,onUpdateValue:He}=e,{nTriggerFormChange:Fe,nTriggerFormInput:ze}=Z;Re&&call(Re,tt,ut),He&&call(He,tt,ut),Te&&call(Te,tt,ut),w.value=tt,Fe(),ze()}function te(tt){const{onBlur:ut}=e,{nTriggerFormBlur:Re}=Z;ut&&call(ut,tt),Re()}function Q(){const{onClear:tt}=e;tt&&call(tt)}function re(tt){const{onFocus:ut,showOnFocus:Re}=e,{nTriggerFormFocus:Te}=Z;ut&&call(ut,tt),Te(),Re&&$e()}function Pe(tt){const{onSearch:ut}=e;ut&&call(ut,tt)}function be(tt){const{onScroll:ut}=e;ut&&call(ut,tt)}function we(){var tt;const{remote:ut,multiple:Re}=e;if(ut){const{value:Te}=_e;if(Re){const{valueField:He}=e;(tt=J.value)===null||tt===void 0||tt.forEach(Fe=>{Te.set(Fe[He],Fe)})}else{const He=fe.value;He&&Te.set(He[e.valueField],He)}}}function Ae(tt){const{onUpdateShow:ut,"onUpdate:show":Re}=e;ut&&call(ut,tt),Re&&call(Re,tt),T.value=tt}function $e(){X.value||(Ae(!0),T.value=!0,e.filterable&&mt())}function Me(){Ae(!1)}function Ie(){d.value="",x.value=Y}const Le=ref(!1);function le(){e.filterable&&(Le.value=!0)}function oe(){e.filterable&&(Le.value=!1,D.value||Ie())}function ke(){X.value||(D.value?e.filterable?mt():Me():$e())}function Ce(tt){var ut,Re;!((Re=(ut=O.value)===null||ut===void 0?void 0:ut.selfRef)===null||Re===void 0)&&Re.contains(tt.relatedTarget)||(g.value=!1,te(tt),Me())}function Ee(tt){re(tt),g.value=!0}function Be(){g.value=!0}function Ve(tt){var ut;!((ut=N.value)===null||ut===void 0)&&ut.$el.contains(tt.relatedTarget)||(g.value=!1,te(tt),Me())}function Oe(){var tt;(tt=N.value)===null||tt===void 0||tt.focus(),Me()}function je(tt){var ut;D.value&&(!((ut=N.value)===null||ut===void 0)&&ut.$el.contains(getPreciseEventTarget(tt))||Me())}function Ge(tt){if(!Array.isArray(tt))return[];if(ne.value)return Array.from(tt);{const{remote:ut}=e,{value:Re}=M;if(ut){const{value:Te}=_e;return tt.filter(He=>Re.has(He)||Te.has(He))}else return tt.filter(Te=>Re.has(Te))}}function Xe(tt){qe(tt.rawNode)}function qe(tt){if(X.value)return;const{tag:ut,remote:Re,clearFilterAfterSelect:Te,valueField:He}=e;if(ut&&!Re){const{value:Fe}=x,ze=Fe[0]||null;if(ze){const We=y.value;We.length?We.push(ze):y.value=[ze],x.value=Y}}if(Re&&_e.value.set(tt[He],tt),e.multiple){const Fe=Ge(v.value),ze=Fe.findIndex(We=>We===tt[He]);if(~ze){if(Fe.splice(ze,1),ut&&!Re){const We=Ke(tt[He]);~We&&(y.value.splice(We,1),Te&&(d.value=""))}}else Fe.push(tt[He]),Te&&(d.value="");U(Fe,ve(Fe))}else{if(ut&&!Re){const Fe=Ke(tt[He]);~Fe?y.value=[y.value[Fe]]:y.value=Y}kt(),Me(),U(tt[He],tt)}}function Ke(tt){return y.value.findIndex(Re=>Re[e.valueField]===tt)}function Je(tt){D.value||$e();const{value:ut}=tt.target;d.value=ut;const{tag:Re,remote:Te}=e;if(Pe(ut),Re&&!Te){if(!ut){x.value=Y;return}const{onCreate:He}=e,Fe=He?He(ut):{[e.labelField]:ut,[e.valueField]:ut},{valueField:ze,labelField:We}=e;f.value.some(Ue=>Ue[ze]===Fe[ze]||Ue[We]===Fe[We])||y.value.some(Ue=>Ue[ze]===Fe[ze]||Ue[We]===Fe[We])?x.value=Y:x.value=[Fe]}}function rt(tt){tt.stopPropagation();const{multiple:ut}=e;!ut&&e.filterable&&Me(),Q(),ut?U([],[]):U(null,null)}function ht(tt){!happensIn(tt,"action")&&!happensIn(tt,"empty")&&!happensIn(tt,"header")&&tt.preventDefault()}function vt(tt){be(tt)}function Ct(tt){var ut,Re,Te,He,Fe;if(!e.keyboard){tt.preventDefault();return}switch(tt.key){case" ":if(e.filterable)break;tt.preventDefault();case"Enter":if(!(!((ut=N.value)===null||ut===void 0)&&ut.isComposing)){if(D.value){const ze=(Re=O.value)===null||Re===void 0?void 0:Re.getPendingTmNode();ze?Xe(ze):e.filterable||(Me(),kt())}else if($e(),e.tag&&Le.value){const ze=x.value[0];if(ze){const We=ze[e.valueField],{value:Ue}=v;e.multiple&&Array.isArray(Ue)&&Ue.includes(We)||qe(ze)}}}tt.preventDefault();break;case"ArrowUp":if(tt.preventDefault(),e.loading)return;D.value&&((Te=O.value)===null||Te===void 0||Te.prev());break;case"ArrowDown":if(tt.preventDefault(),e.loading)return;D.value?(He=O.value)===null||He===void 0||He.next():$e();break;case"Escape":D.value&&(markEventEffectPerformed(tt),Me()),(Fe=N.value)===null||Fe===void 0||Fe.focus();break}}function kt(){var tt;(tt=N.value)===null||tt===void 0||tt.focus()}function mt(){var tt;(tt=N.value)===null||tt===void 0||tt.focusInput()}function Vt(){var tt;!D.value||(tt=I.value)===null||tt===void 0||tt.syncPosition()}we(),watch(toRef(e,"options"),we);const bt={focus:()=>{var tt;(tt=N.value)===null||tt===void 0||tt.focus()},focusInput:()=>{var tt;(tt=N.value)===null||tt===void 0||tt.focusInput()},blur:()=>{var tt;(tt=N.value)===null||tt===void 0||tt.blur()},blurInput:()=>{var tt;(tt=N.value)===null||tt===void 0||tt.blurInput()}},ot=computed(()=>{const{self:{menuBoxShadow:tt}}=s.value;return{"--n-menu-box-shadow":tt}}),gt=u?useThemeClass("select",void 0,ot,e):void 0;return Object.assign(Object.assign({},bt),{mergedStatus:H,mergedClsPrefix:n,mergedBordered:o,namespace:r,treeMate:E,isMounted:isMounted(),triggerRef:N,menuRef:O,pattern:d,uncontrolledShow:T,mergedShow:D,adjustedTo:useAdjustedTo(e),uncontrolledValue:w,mergedValue:v,followerRef:I,localizedPlaceholder:q,selectedOption:fe,selectedOptions:J,mergedSize:j,mergedDisabled:X,focused:g,activeWithoutMenuOpen:Le,inlineThemeDisabled:u,onTriggerInputFocus:le,onTriggerInputBlur:oe,handleTriggerOrMenuResize:Vt,handleMenuFocus:Be,handleMenuBlur:Ve,handleMenuTabOut:Oe,handleTriggerClick:ke,handleToggle:Xe,handleDeleteOption:qe,handlePatternInput:Je,handleClear:rt,handleTriggerBlur:Ce,handleTriggerFocus:Ee,handleKeydown:Ct,handleMenuAfterLeave:Ie,handleMenuClickOutside:je,handleMenuScroll:vt,handleMenuKeydown:Ct,handleMenuMousedown:ht,mergedTheme:s,cssVars:u?void 0:ot,themeClass:gt==null?void 0:gt.themeClass,onRender:gt==null?void 0:gt.onRender})},render(){return h$1("div",{class:`${this.mergedClsPrefix}-select`},h$1(VBinder,null,{default:()=>[h$1(VTarget,null,{default:()=>h$1(NInternalSelection,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var e,n;return[(n=(e=this.$slots).arrow)===null||n===void 0?void 0:n.call(e)]}})}),h$1(VFollower,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>h$1(Transition,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var e,n,o;return this.mergedShow||this.displayDirective==="show"?((e=this.onRender)===null||e===void 0||e.call(this),withDirectives(h$1(NInternalSelectMenu,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,(n=this.menuProps)===null||n===void 0?void 0:n.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:this.menuSize,renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[(o=this.menuProps)===null||o===void 0?void 0:o.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var r,u;return[(u=(r=this.$slots).empty)===null||u===void 0?void 0:u.call(r)]},header:()=>{var r,u;return[(u=(r=this.$slots).header)===null||u===void 0?void 0:u.call(r)]},action:()=>{var r,u;return[(u=(r=this.$slots).action)===null||u===void 0?void 0:u.call(r)]}}),this.displayDirective==="show"?[[vShow,this.mergedShow],[clickoutside$1,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[clickoutside$1,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),commonVars$3={padding:"8px 14px"};function self$9(e){const{borderRadius:n,boxShadow2:o,baseColor:r}=e;return Object.assign(Object.assign({},commonVars$3),{borderRadius:n,boxShadow:o,color:composite(r,"rgba(0, 0, 0, .85)"),textColor:r})}const tooltipLight={name:"Tooltip",common:commonLight,peers:{Popover:popoverLight$1},self:self$9},tooltipLight$1=tooltipLight,tooltipProps=Object.assign(Object.assign({},popoverBaseProps),useTheme.props),NTooltip=defineComponent({name:"Tooltip",props:tooltipProps,slots:Object,__popover__:!0,setup(e){const{mergedClsPrefixRef:n}=useConfig(e),o=useTheme("Tooltip","-tooltip",void 0,tooltipLight$1,e,n),r=ref(null);return Object.assign(Object.assign({},{syncPosition(){r.value.syncPosition()},setShow(s){r.value.setShow(s)}}),{popoverRef:r,mergedTheme:o,popoverThemeOverrides:computed(()=>o.value.self)})},render(){const{mergedTheme:e,internalExtraClass:n}=this;return h$1(NPopover,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:n.concat("tooltip"),ref:"popoverRef"}),this.$slots)}}),dialogProviderInjectionKey="n-dialog-provider",dialogApiInjectionKey="n-dialog-api",dialogReactiveListInjectionKey="n-dialog-reactive-list";function useDialog(){const e=inject(dialogApiInjectionKey,null);return e===null&&throwError("use-dialog","No outer <n-dialog-provider /> founded."),e}const commonVars$2={titleFontSize:"18px",padding:"16px 28px 20px 28px",iconSize:"28px",actionSpace:"12px",contentMargin:"8px 0 16px 0",iconMargin:"0 4px 0 0",iconMarginIconTop:"4px 0 8px 0",closeSize:"22px",closeIconSize:"18px",closeMargin:"20px 26px 0 0",closeMarginIconTop:"10px 16px 0 0"};function self$8(e){const{textColor1:n,textColor2:o,modalColor:r,closeIconColor:u,closeIconColorHover:s,closeIconColorPressed:w,closeColorHover:m,closeColorPressed:v,infoColor:g,successColor:d,warningColor:f,errorColor:y,primaryColor:x,dividerColor:k,borderRadius:P,fontWeightStrong:S,lineHeight:E,fontSize:M}=e;return Object.assign(Object.assign({},commonVars$2),{fontSize:M,lineHeight:E,border:`1px solid ${k}`,titleTextColor:n,textColor:o,color:r,closeColorHover:m,closeColorPressed:v,closeIconColor:u,closeIconColorHover:s,closeIconColorPressed:w,closeBorderRadius:P,iconColor:x,iconColorInfo:g,iconColorSuccess:d,iconColorWarning:f,iconColorError:y,borderRadius:P,titleFontWeight:S})}const dialogLight={name:"Dialog",common:commonLight,peers:{Button:buttonLight$1},self:self$8},dialogLight$1=dialogLight,dialogProps={icon:Function,type:{type:String,default:"default"},title:[String,Function],closable:{type:Boolean,default:!0},negativeText:String,positiveText:String,positiveButtonProps:Object,negativeButtonProps:Object,content:[String,Function],action:Function,showIcon:{type:Boolean,default:!0},loading:Boolean,bordered:Boolean,iconPlacement:String,titleClass:[String,Array],titleStyle:[String,Object],contentClass:[String,Array],contentStyle:[String,Object],actionClass:[String,Array],actionStyle:[String,Object],onPositiveClick:Function,onNegativeClick:Function,onClose:Function},dialogPropKeys=keysOf(dialogProps),style$7=c$1([cB("dialog",`
 --n-icon-margin: var(--n-icon-margin-top) var(--n-icon-margin-right) var(--n-icon-margin-bottom) var(--n-icon-margin-left);
 word-break: break-word;
 line-height: var(--n-line-height);
 position: relative;
 background: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 margin: auto;
 border-radius: var(--n-border-radius);
 padding: var(--n-padding);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `,[cE("icon",{color:"var(--n-icon-color)"}),cM("bordered",{border:"var(--n-border)"}),cM("icon-top",[cE("close",{margin:"var(--n-close-margin)"}),cE("icon",{margin:"var(--n-icon-margin)"}),cE("content",{textAlign:"center"}),cE("title",{justifyContent:"center"}),cE("action",{justifyContent:"center"})]),cM("icon-left",[cE("icon",{margin:"var(--n-icon-margin)"}),cM("closable",[cE("title",`
 padding-right: calc(var(--n-close-size) + 6px);
 `)])]),cE("close",`
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 z-index: 1;
 `),cE("content",`
 font-size: var(--n-font-size);
 margin: var(--n-content-margin);
 position: relative;
 word-break: break-word;
 `,[cM("last","margin-bottom: 0;")]),cE("action",`
 display: flex;
 justify-content: flex-end;
 `,[c$1("> *:not(:last-child)",`
 margin-right: var(--n-action-space);
 `)]),cE("icon",`
 font-size: var(--n-icon-size);
 transition: color .3s var(--n-bezier);
 `),cE("title",`
 transition: color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),cB("dialog-icon-container",`
 display: flex;
 justify-content: center;
 `)]),insideModal(cB("dialog",`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)),cB("dialog",[asModal(`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)])]),iconRenderMap$2={default:()=>h$1(InfoIcon,null),info:()=>h$1(InfoIcon,null),success:()=>h$1(SuccessIcon,null),warning:()=>h$1(WarningIcon,null),error:()=>h$1(ErrorIcon,null)},NDialog=defineComponent({name:"Dialog",alias:["NimbusConfirmCard","Confirm"],props:Object.assign(Object.assign({},useTheme.props),dialogProps),slots:Object,setup(e){const{mergedComponentPropsRef:n,mergedClsPrefixRef:o,inlineThemeDisabled:r,mergedRtlRef:u}=useConfig(e),s=useRtl("Dialog",u,o),w=computed(()=>{var x,k;const{iconPlacement:P}=e;return P||((k=(x=n==null?void 0:n.value)===null||x===void 0?void 0:x.Dialog)===null||k===void 0?void 0:k.iconPlacement)||"left"});function m(x){const{onPositiveClick:k}=e;k&&k(x)}function v(x){const{onNegativeClick:k}=e;k&&k(x)}function g(){const{onClose:x}=e;x&&x()}const d=useTheme("Dialog","-dialog",style$7,dialogLight$1,e,o),f=computed(()=>{const{type:x}=e,k=w.value,{common:{cubicBezierEaseInOut:P},self:{fontSize:S,lineHeight:E,border:M,titleTextColor:T,textColor:D,color:N,closeBorderRadius:I,closeColorHover:O,closeColorPressed:F,closeIconColor:q,closeIconColorHover:Y,closeIconColorPressed:_e,closeIconSize:ne,borderRadius:ve,titleFontWeight:J,titleFontSize:fe,padding:Z,iconSize:j,actionSpace:X,contentMargin:H,closeSize:U,[k==="top"?"iconMarginIconTop":"iconMargin"]:te,[k==="top"?"closeMarginIconTop":"closeMargin"]:Q,[createKey("iconColor",x)]:re}}=d.value,Pe=getMargin(te);return{"--n-font-size":S,"--n-icon-color":re,"--n-bezier":P,"--n-close-margin":Q,"--n-icon-margin-top":Pe.top,"--n-icon-margin-right":Pe.right,"--n-icon-margin-bottom":Pe.bottom,"--n-icon-margin-left":Pe.left,"--n-icon-size":j,"--n-close-size":U,"--n-close-icon-size":ne,"--n-close-border-radius":I,"--n-close-color-hover":O,"--n-close-color-pressed":F,"--n-close-icon-color":q,"--n-close-icon-color-hover":Y,"--n-close-icon-color-pressed":_e,"--n-color":N,"--n-text-color":D,"--n-border-radius":ve,"--n-padding":Z,"--n-line-height":E,"--n-border":M,"--n-content-margin":H,"--n-title-font-size":fe,"--n-title-font-weight":J,"--n-title-text-color":T,"--n-action-space":X}}),y=r?useThemeClass("dialog",computed(()=>`${e.type[0]}${w.value[0]}`),f,e):void 0;return{mergedClsPrefix:o,rtlEnabled:s,mergedIconPlacement:w,mergedTheme:d,handlePositiveClick:m,handleNegativeClick:v,handleCloseClick:g,cssVars:r?void 0:f,themeClass:y==null?void 0:y.themeClass,onRender:y==null?void 0:y.onRender}},render(){var e;const{bordered:n,mergedIconPlacement:o,cssVars:r,closable:u,showIcon:s,title:w,content:m,action:v,negativeText:g,positiveText:d,positiveButtonProps:f,negativeButtonProps:y,handlePositiveClick:x,handleNegativeClick:k,mergedTheme:P,loading:S,type:E,mergedClsPrefix:M}=this;(e=this.onRender)===null||e===void 0||e.call(this);const T=s?h$1(NBaseIcon,{clsPrefix:M,class:`${M}-dialog__icon`},{default:()=>resolveWrappedSlot(this.$slots.icon,N=>N||(this.icon?render(this.icon):iconRenderMap$2[this.type]()))}):null,D=resolveWrappedSlot(this.$slots.action,N=>N||d||g||v?h$1("div",{class:[`${M}-dialog__action`,this.actionClass],style:this.actionStyle},N||(v?[render(v)]:[this.negativeText&&h$1(NButton,Object.assign({theme:P.peers.Button,themeOverrides:P.peerOverrides.Button,ghost:!0,size:"small",onClick:k},y),{default:()=>render(this.negativeText)}),this.positiveText&&h$1(NButton,Object.assign({theme:P.peers.Button,themeOverrides:P.peerOverrides.Button,size:"small",type:E==="default"?"primary":E,disabled:S,loading:S,onClick:x},f),{default:()=>render(this.positiveText)})])):null);return h$1("div",{class:[`${M}-dialog`,this.themeClass,this.closable&&`${M}-dialog--closable`,`${M}-dialog--icon-${o}`,n&&`${M}-dialog--bordered`,this.rtlEnabled&&`${M}-dialog--rtl`],style:r,role:"dialog"},u?resolveWrappedSlot(this.$slots.close,N=>{const I=[`${M}-dialog__close`,this.rtlEnabled&&`${M}-dialog--rtl`];return N?h$1("div",{class:I},N):h$1(NBaseClose,{clsPrefix:M,class:I,onClick:this.handleCloseClick})}):null,s&&o==="top"?h$1("div",{class:`${M}-dialog-icon-container`},T):null,h$1("div",{class:[`${M}-dialog__title`,this.titleClass],style:this.titleStyle},s&&o==="left"?T:null,resolveSlot(this.$slots.header,()=>[render(w)])),h$1("div",{class:[`${M}-dialog__content`,D?"":`${M}-dialog__content--last`,this.contentClass],style:this.contentStyle},resolveSlot(this.$slots.default,()=>[render(m)])),D)}});function self$7(e){const{modalColor:n,textColor2:o,boxShadow3:r}=e;return{color:n,textColor:o,boxShadow:r}}const modalLight={name:"Modal",common:commonLight,peers:{Scrollbar:scrollbarLight$1,Dialog:dialogLight$1,Card:cardLight$1},self:self$7},modalLight$1=modalLight,modalProviderInjectionKey="n-modal-provider",modalApiInjectionKey="n-modal-api",modalReactiveListInjectionKey="n-modal-reactive-list";function useModal(){const e=inject(modalApiInjectionKey,null);return e===null&&throwError("use-modal","No outer <n-modal-provider /> founded."),e}const DRAGGABLE_CLASS="n-draggable";function useDragModal(e,n){let o;const r=computed(()=>e.value!==!1),u=computed(()=>r.value?DRAGGABLE_CLASS:""),s=computed(()=>{const v=e.value;return v===!0||v===!1?!0:v?v.bounds!=="none":!0});function w(v){const g=v.querySelector(`.${DRAGGABLE_CLASS}`);if(!g||!u.value)return;let d=0,f=0,y=0,x=0,k=0,P=0,S;function E(D){D.preventDefault(),S=D;const{x:N,y:I,right:O,bottom:F}=v.getBoundingClientRect();f=N,x=I,d=window.innerWidth-O,y=window.innerHeight-F;const{left:q,top:Y}=v.style;k=+Y.slice(0,-2),P=+q.slice(0,-2)}function M(D){if(!S)return;const{clientX:N,clientY:I}=S;let O=D.clientX-N,F=D.clientY-I;s.value&&(O>d?O=d:-O>f&&(O=-f),F>y?F=y:-F>x&&(F=-x));const q=O+P,Y=F+k;v.style.top=`${Y}px`,v.style.left=`${q}px`}function T(){S=void 0,n.onEnd(v)}on$1("mousedown",g,E),on$1("mousemove",window,M),on$1("mouseup",window,T),o=()=>{off$1("mousedown",g,E),on$1("mousemove",window,M),on$1("mouseup",window,T)}}function m(){o&&(o(),o=void 0)}return onUnmounted(m),{stopDrag:m,startDrag:w,draggableRef:r,draggableClassRef:u}}const presetProps=Object.assign(Object.assign({},cardBaseProps),dialogProps),presetPropsKeys=keysOf(presetProps),NModalBodyWrapper=defineComponent({name:"ModalBody",inheritAttrs:!1,slots:Object,props:Object.assign(Object.assign({show:{type:Boolean,required:!0},preset:String,displayDirective:{type:String,required:!0},trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},blockScroll:Boolean,draggable:{type:[Boolean,Object],default:!1}},presetProps),{renderMask:Function,onClickoutside:Function,onBeforeLeave:{type:Function,required:!0},onAfterLeave:{type:Function,required:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0},onClose:{type:Function,required:!0},onAfterEnter:Function,onEsc:Function}),setup(e){const n=ref(null),o=ref(null),r=ref(e.show),u=ref(null),s=ref(null),w=inject(modalInjectionKey);let m=null;watch(toRef(e,"show"),F=>{F&&(m=w.getMousePosition())},{immediate:!0});const{stopDrag:v,startDrag:g,draggableRef:d,draggableClassRef:f}=useDragModal(toRef(e,"draggable"),{onEnd:F=>{P(F)}}),y=computed(()=>normalizeClass([e.titleClass,f.value])),x=computed(()=>normalizeClass([e.headerClass,f.value]));watch(toRef(e,"show"),F=>{F&&(r.value=!0)}),useLockHtmlScroll(computed(()=>e.blockScroll&&r.value));function k(){if(w.transformOriginRef.value==="center")return"";const{value:F}=u,{value:q}=s;if(F===null||q===null)return"";if(o.value){const Y=o.value.containerScrollTop;return`${F}px ${q+Y}px`}return""}function P(F){if(w.transformOriginRef.value==="center"||!m||!o.value)return;const q=o.value.containerScrollTop,{offsetLeft:Y,offsetTop:_e}=F,ne=m.y,ve=m.x;u.value=-(Y-ve),s.value=-(_e-ne-q),F.style.transformOrigin=k()}function S(F){nextTick(()=>{P(F)})}function E(F){F.style.transformOrigin=k(),e.onBeforeLeave()}function M(F){const q=F;d.value&&g(q),e.onAfterEnter&&e.onAfterEnter(q)}function T(){r.value=!1,u.value=null,s.value=null,v(),e.onAfterLeave()}function D(){const{onClose:F}=e;F&&F()}function N(){e.onNegativeClick()}function I(){e.onPositiveClick()}const O=ref(null);return watch(O,F=>{F&&nextTick(()=>{const q=F.el;q&&n.value!==q&&(n.value=q)})}),provide(modalBodyInjectionKey,n),provide(drawerBodyInjectionKey,null),provide(popoverBodyInjectionKey,null),{mergedTheme:w.mergedThemeRef,appear:w.appearRef,isMounted:w.isMountedRef,mergedClsPrefix:w.mergedClsPrefixRef,bodyRef:n,scrollbarRef:o,draggableClass:f,displayed:r,childNodeRef:O,cardHeaderClass:x,dialogTitleClass:y,handlePositiveClick:I,handleNegativeClick:N,handleCloseClick:D,handleAfterEnter:M,handleAfterLeave:T,handleBeforeLeave:E,handleEnter:S}},render(){const{$slots:e,$attrs:n,handleEnter:o,handleAfterEnter:r,handleAfterLeave:u,handleBeforeLeave:s,preset:w,mergedClsPrefix:m}=this;let v=null;if(!w){if(v=getFirstSlotVNodeWithTypedProps("default",e.default,{draggableClass:this.draggableClass}),!v){warn("modal","default slot is empty");return}v=cloneVNode(v),v.props=mergeProps({class:`${m}-modal`},n,v.props||{})}return this.displayDirective==="show"||this.displayed||this.show?withDirectives(h$1("div",{role:"none",class:`${m}-modal-body-wrapper`},h$1(NScrollbar,{ref:"scrollbarRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:`${m}-modal-scroll-content`},{default:()=>{var g;return[(g=this.renderMask)===null||g===void 0?void 0:g.call(this),h$1(FocusTrap,{disabled:!this.trapFocus,active:this.show,onEsc:this.onEsc,autoFocus:this.autoFocus},{default:()=>{var d;return h$1(Transition,{name:"fade-in-scale-up-transition",appear:(d=this.appear)!==null&&d!==void 0?d:this.isMounted,onEnter:o,onAfterEnter:r,onAfterLeave:u,onBeforeLeave:s},{default:()=>{const f=[[vShow,this.show]],{onClickoutside:y}=this;return y&&f.push([clickoutside$1,this.onClickoutside,void 0,{capture:!0}]),withDirectives(this.preset==="confirm"||this.preset==="dialog"?h$1(NDialog,Object.assign({},this.$attrs,{class:[`${m}-modal`,this.$attrs.class],ref:"bodyRef",theme:this.mergedTheme.peers.Dialog,themeOverrides:this.mergedTheme.peerOverrides.Dialog},keep(this.$props,dialogPropKeys),{titleClass:this.dialogTitleClass,"aria-modal":"true"}),e):this.preset==="card"?h$1(NCard,Object.assign({},this.$attrs,{ref:"bodyRef",class:[`${m}-modal`,this.$attrs.class],theme:this.mergedTheme.peers.Card,themeOverrides:this.mergedTheme.peerOverrides.Card},keep(this.$props,cardBasePropKeys),{headerClass:this.cardHeaderClass,"aria-modal":"true",role:"dialog"}),e):this.childNodeRef=v,f)}})}})]}})),[[vShow,this.displayDirective==="if"||this.displayed||this.show]]):null}}),style$6=c$1([cB("modal-container",`
 position: fixed;
 left: 0;
 top: 0;
 height: 0;
 width: 0;
 display: flex;
 `),cB("modal-mask",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 background-color: rgba(0, 0, 0, .4);
 `,[fadeInTransition({enterDuration:".25s",leaveDuration:".25s",enterCubicBezier:"var(--n-bezier-ease-out)",leaveCubicBezier:"var(--n-bezier-ease-out)"})]),cB("modal-body-wrapper",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: visible;
 `,[cB("modal-scroll-content",`
 min-height: 100%;
 display: flex;
 position: relative;
 `)]),cB("modal",`
 position: relative;
 align-self: center;
 color: var(--n-text-color);
 margin: auto;
 box-shadow: var(--n-box-shadow);
 `,[fadeInScaleUpTransition({duration:".25s",enterScale:".5"}),c$1(`.${DRAGGABLE_CLASS}`,`
 cursor: move;
 user-select: none;
 `)])]),modalProps=Object.assign(Object.assign(Object.assign(Object.assign({},useTheme.props),{show:Boolean,unstableShowMask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},preset:String,to:[String,Object],displayDirective:{type:String,default:"if"},transformOrigin:{type:String,default:"mouse"},zIndex:Number,autoFocus:{type:Boolean,default:!0},trapFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0}}),presetProps),{draggable:[Boolean,Object],onEsc:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onBeforeLeave:Function,onAfterLeave:Function,onClose:Function,onPositiveClick:Function,onNegativeClick:Function,onMaskClick:Function,internalDialog:Boolean,internalModal:Boolean,internalAppear:{type:Boolean,default:void 0},overlayStyle:[String,Object],onBeforeHide:Function,onAfterHide:Function,onHide:Function}),NModal=defineComponent({name:"Modal",inheritAttrs:!1,props:modalProps,slots:Object,setup(e){const n=ref(null),{mergedClsPrefixRef:o,namespaceRef:r,inlineThemeDisabled:u}=useConfig(e),s=useTheme("Modal","-modal",style$6,modalLight$1,e,o),w=useClicked(64),m=useClickPosition(),v=isMounted(),g=e.internalDialog?inject(dialogProviderInjectionKey,null):null,d=e.internalModal?inject(modalProviderInjectionKey$1,null):null,f=useIsComposing();function y(I){const{onUpdateShow:O,"onUpdate:show":F,onHide:q}=e;O&&call(O,I),F&&call(F,I),q&&!I&&q(I)}function x(){const{onClose:I}=e;I?Promise.resolve(I()).then(O=>{O!==!1&&y(!1)}):y(!1)}function k(){const{onPositiveClick:I}=e;I?Promise.resolve(I()).then(O=>{O!==!1&&y(!1)}):y(!1)}function P(){const{onNegativeClick:I}=e;I?Promise.resolve(I()).then(O=>{O!==!1&&y(!1)}):y(!1)}function S(){const{onBeforeLeave:I,onBeforeHide:O}=e;I&&call(I),O&&O()}function E(){const{onAfterLeave:I,onAfterHide:O}=e;I&&call(I),O&&O()}function M(I){var O;const{onMaskClick:F}=e;F&&F(I),e.maskClosable&&!((O=n.value)===null||O===void 0)&&O.contains(getPreciseEventTarget(I))&&y(!1)}function T(I){var O;(O=e.onEsc)===null||O===void 0||O.call(e),e.show&&e.closeOnEsc&&eventEffectNotPerformed(I)&&(f.value||y(!1))}provide(modalInjectionKey,{getMousePosition:()=>{const I=g||d;if(I){const{clickedRef:O,clickedPositionRef:F}=I;if(O.value&&F.value)return F.value}return w.value?m.value:null},mergedClsPrefixRef:o,mergedThemeRef:s,isMountedRef:v,appearRef:toRef(e,"internalAppear"),transformOriginRef:toRef(e,"transformOrigin")});const D=computed(()=>{const{common:{cubicBezierEaseOut:I},self:{boxShadow:O,color:F,textColor:q}}=s.value;return{"--n-bezier-ease-out":I,"--n-box-shadow":O,"--n-color":F,"--n-text-color":q}}),N=u?useThemeClass("theme-class",void 0,D,e):void 0;return{mergedClsPrefix:o,namespace:r,isMounted:v,containerRef:n,presetProps:computed(()=>keep(e,presetPropsKeys)),handleEsc:T,handleAfterLeave:E,handleClickoutside:M,handleBeforeLeave:S,doUpdateShow:y,handleNegativeClick:P,handlePositiveClick:k,handleCloseClick:x,cssVars:u?void 0:D,themeClass:N==null?void 0:N.themeClass,onRender:N==null?void 0:N.onRender}},render(){const{mergedClsPrefix:e}=this;return h$1(LazyTeleport,{to:this.to,show:this.show},{default:()=>{var n;(n=this.onRender)===null||n===void 0||n.call(this);const{unstableShowMask:o}=this;return withDirectives(h$1("div",{role:"none",ref:"containerRef",class:[`${e}-modal-container`,this.themeClass,this.namespace],style:this.cssVars},h$1(NModalBodyWrapper,Object.assign({style:this.overlayStyle},this.$attrs,{ref:"bodyWrapper",displayDirective:this.displayDirective,show:this.show,preset:this.preset,autoFocus:this.autoFocus,trapFocus:this.trapFocus,draggable:this.draggable,blockScroll:this.blockScroll},this.presetProps,{onEsc:this.handleEsc,onClose:this.handleCloseClick,onNegativeClick:this.handleNegativeClick,onPositiveClick:this.handlePositiveClick,onBeforeLeave:this.handleBeforeLeave,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave,onClickoutside:o?void 0:this.handleClickoutside,renderMask:o?()=>{var r;return h$1(Transition,{name:"fade-in-transition",key:"mask",appear:(r=this.internalAppear)!==null&&r!==void 0?r:this.isMounted},{default:()=>this.show?h$1("div",{"aria-hidden":!0,ref:"containerRef",class:`${e}-modal-mask`,onClick:this.handleClickoutside}):null})}:void 0}),this.$slots)),[[zindexable$1,{zIndex:this.zIndex,enabled:this.show}]])}})}}),exposedDialogEnvProps=Object.assign(Object.assign({},dialogProps),{onAfterEnter:Function,onAfterLeave:Function,transformOrigin:String,blockScroll:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},internalStyle:[String,Object],maskClosable:{type:Boolean,default:!0},onPositiveClick:Function,onNegativeClick:Function,onClose:Function,onMaskClick:Function,draggable:[Boolean,Object]}),NDialogEnvironment=defineComponent({name:"DialogEnvironment",props:Object.assign(Object.assign({},exposedDialogEnvProps),{internalKey:{type:String,required:!0},to:[String,Object],onInternalAfterLeave:{type:Function,required:!0}}),setup(e){const n=ref(!0);function o(){const{onInternalAfterLeave:d,internalKey:f,onAfterLeave:y}=e;d&&d(f),y&&y()}function r(d){const{onPositiveClick:f}=e;f?Promise.resolve(f(d)).then(y=>{y!==!1&&v()}):v()}function u(d){const{onNegativeClick:f}=e;f?Promise.resolve(f(d)).then(y=>{y!==!1&&v()}):v()}function s(){const{onClose:d}=e;d?Promise.resolve(d()).then(f=>{f!==!1&&v()}):v()}function w(d){const{onMaskClick:f,maskClosable:y}=e;f&&(f(d),y&&v())}function m(){const{onEsc:d}=e;d&&d()}function v(){n.value=!1}function g(d){n.value=d}return{show:n,hide:v,handleUpdateShow:g,handleAfterLeave:o,handleCloseClick:s,handleNegativeClick:u,handlePositiveClick:r,handleMaskClick:w,handleEsc:m}},render(){const{handlePositiveClick:e,handleUpdateShow:n,handleNegativeClick:o,handleCloseClick:r,handleAfterLeave:u,handleMaskClick:s,handleEsc:w,to:m,maskClosable:v,show:g}=this;return h$1(NModal,{show:g,onUpdateShow:n,onMaskClick:s,onEsc:w,to:m,maskClosable:v,onAfterEnter:this.onAfterEnter,onAfterLeave:u,closeOnEsc:this.closeOnEsc,blockScroll:this.blockScroll,autoFocus:this.autoFocus,transformOrigin:this.transformOrigin,draggable:this.draggable,internalAppear:!0,internalDialog:!0},{default:({draggableClass:d})=>h$1(NDialog,Object.assign({},keep(this.$props,dialogPropKeys),{titleClass:normalizeClass([this.titleClass,d]),style:this.internalStyle,onClose:r,onNegativeClick:o,onPositiveClick:e}))})}}),dialogProviderProps={injectionKey:String,to:[String,Object]},NDialogProvider=defineComponent({name:"DialogProvider",props:dialogProviderProps,setup(){const e=ref([]),n={};function o(m={}){const v=createId(),g=reactive(Object.assign(Object.assign({},m),{key:v,destroy:()=>{var d;(d=n[`n-dialog-${v}`])===null||d===void 0||d.hide()}}));return e.value.push(g),g}const r=["info","success","warning","error"].map(m=>v=>o(Object.assign(Object.assign({},v),{type:m})));function u(m){const{value:v}=e;v.splice(v.findIndex(g=>g.key===m),1)}function s(){Object.values(n).forEach(m=>{m==null||m.hide()})}const w={create:o,destroyAll:s,info:r[0],success:r[1],warning:r[2],error:r[3]};return provide(dialogApiInjectionKey,w),provide(dialogProviderInjectionKey,{clickedRef:useClicked(64),clickedPositionRef:useClickPosition()}),provide(dialogReactiveListInjectionKey,e),Object.assign(Object.assign({},w),{dialogList:e,dialogInstRefs:n,handleAfterLeave:u})},render(){var e,n;return h$1(Fragment,null,[this.dialogList.map(o=>h$1(NDialogEnvironment,omit(o,["destroy","style"],{internalStyle:o.style,to:this.to,ref:r=>{r===null?delete this.dialogInstRefs[`n-dialog-${o.key}`]:this.dialogInstRefs[`n-dialog-${o.key}`]=r},internalKey:o.key,onInternalAfterLeave:this.handleAfterLeave}))),(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e)])}}),loadingBarProviderInjectionKey="n-loading-bar",loadingBarApiInjectionKey="n-loading-bar-api";function self$6(e){const{primaryColor:n,errorColor:o}=e;return{colorError:o,colorLoading:n,height:"2px"}}const loadingBarLight={name:"LoadingBar",common:commonLight,self:self$6},loadingBarLight$1=loadingBarLight,style$5=cB("loading-bar-container",`
 z-index: 5999;
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 height: 2px;
`,[fadeInTransition({enterDuration:"0.3s",leaveDuration:"0.8s"}),cB("loading-bar",`
 width: 100%;
 transition:
 max-width 4s linear,
 background .2s linear;
 height: var(--n-height);
 `,[cM("starting",`
 background: var(--n-color-loading);
 `),cM("finishing",`
 background: var(--n-color-loading);
 transition:
 max-width .2s linear,
 background .2s linear;
 `),cM("error",`
 background: var(--n-color-error);
 transition:
 max-width .2s linear,
 background .2s linear;
 `)])]);var __awaiter$1=globalThis&&globalThis.__awaiter||function(e,n,o,r){function u(s){return s instanceof o?s:new o(function(w){w(s)})}return new(o||(o=Promise))(function(s,w){function m(d){try{g(r.next(d))}catch(f){w(f)}}function v(d){try{g(r.throw(d))}catch(f){w(f)}}function g(d){d.done?s(d.value):u(d.value).then(m,v)}g((r=r.apply(e,n||[])).next())})};function createClassName(e,n){return`${n}-loading-bar ${n}-loading-bar--${e}`}const NLoadingBar=defineComponent({name:"LoadingBar",props:{containerClass:String,containerStyle:[String,Object]},setup(){const{inlineThemeDisabled:e}=useConfig(),{props:n,mergedClsPrefixRef:o}=inject(loadingBarProviderInjectionKey),r=ref(null),u=ref(!1),s=ref(!1),w=ref(!1),m=ref(!1);let v=!1;const g=ref(!1),d=computed(()=>{const{loadingBarStyle:N}=n;return N?N[g.value?"error":"loading"]:""});function f(){return __awaiter$1(this,void 0,void 0,function*(){u.value=!1,w.value=!1,v=!1,g.value=!1,m.value=!0,yield nextTick(),m.value=!1})}function y(){return __awaiter$1(this,arguments,void 0,function*(N=0,I=80,O="starting"){if(s.value=!0,yield f(),v)return;w.value=!0,yield nextTick();const F=r.value;!F||(F.style.maxWidth=`${N}%`,F.style.transition="none",F.offsetWidth,F.className=createClassName(O,o.value),F.style.transition="",F.style.maxWidth=`${I}%`)})}function x(){return __awaiter$1(this,void 0,void 0,function*(){if(v||g.value)return;s.value&&(yield nextTick()),v=!0;const N=r.value;!N||(N.className=createClassName("finishing",o.value),N.style.maxWidth="100%",N.offsetWidth,w.value=!1)})}function k(){if(!(v||g.value))if(!w.value)y(100,100,"error").then(()=>{g.value=!0;const N=r.value;!N||(N.className=createClassName("error",o.value),N.offsetWidth,w.value=!1)});else{g.value=!0;const N=r.value;if(!N)return;N.className=createClassName("error",o.value),N.style.maxWidth="100%",N.offsetWidth,w.value=!1}}function P(){u.value=!0}function S(){u.value=!1}function E(){return __awaiter$1(this,void 0,void 0,function*(){yield f()})}const M=useTheme("LoadingBar","-loading-bar",style$5,loadingBarLight$1,n,o),T=computed(()=>{const{self:{height:N,colorError:I,colorLoading:O}}=M.value;return{"--n-height":N,"--n-color-loading":O,"--n-color-error":I}}),D=e?useThemeClass("loading-bar",void 0,T,n):void 0;return{mergedClsPrefix:o,loadingBarRef:r,started:s,loading:w,entering:u,transitionDisabled:m,start:y,error:k,finish:x,handleEnter:P,handleAfterEnter:S,handleAfterLeave:E,mergedLoadingBarStyle:d,cssVars:e?void 0:T,themeClass:D==null?void 0:D.themeClass,onRender:D==null?void 0:D.onRender}},render(){if(!this.started)return null;const{mergedClsPrefix:e}=this;return h$1(Transition,{name:"fade-in-transition",appear:!0,onEnter:this.handleEnter,onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave,css:!this.transitionDisabled},{default:()=>{var n;return(n=this.onRender)===null||n===void 0||n.call(this),withDirectives(h$1("div",{class:[`${e}-loading-bar-container`,this.themeClass,this.containerClass],style:this.containerStyle},h$1("div",{ref:"loadingBarRef",class:[`${e}-loading-bar`],style:[this.cssVars,this.mergedLoadingBarStyle]})),[[vShow,this.loading||!this.loading&&this.entering]])}})}}),loadingBarProviderProps=Object.assign(Object.assign({},useTheme.props),{to:{type:[String,Object,Boolean],default:void 0},containerClass:String,containerStyle:[String,Object],loadingBarStyle:{type:Object}}),NLoadingBarProvider=defineComponent({name:"LoadingBarProvider",props:loadingBarProviderProps,setup(e){const n=isMounted(),o=ref(null),r={start(){var s;n.value?(s=o.value)===null||s===void 0||s.start():nextTick(()=>{var w;(w=o.value)===null||w===void 0||w.start()})},error(){var s;n.value?(s=o.value)===null||s===void 0||s.error():nextTick(()=>{var w;(w=o.value)===null||w===void 0||w.error()})},finish(){var s;n.value?(s=o.value)===null||s===void 0||s.finish():nextTick(()=>{var w;(w=o.value)===null||w===void 0||w.finish()})}},{mergedClsPrefixRef:u}=useConfig(e);return provide(loadingBarApiInjectionKey,r),provide(loadingBarProviderInjectionKey,{props:e,mergedClsPrefixRef:u}),Object.assign(r,{loadingBarRef:o})},render(){var e,n;return h$1(Fragment,null,h$1(Teleport,{disabled:this.to===!1,to:this.to||"body"},h$1(NLoadingBar,{ref:"loadingBarRef",containerStyle:this.containerStyle,containerClass:this.containerClass})),(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e))}});function useLoadingBar(){const e=inject(loadingBarApiInjectionKey,null);return e===null&&throwError("use-loading-bar","No outer <n-loading-bar-provider /> founded."),e}const messageApiInjectionKey="n-message-api",messageProviderInjectionKey="n-message-provider",commonVariables={margin:"0 0 8px 0",padding:"10px 20px",maxWidth:"720px",minWidth:"420px",iconMargin:"0 10px 0 0",closeMargin:"0 0 0 10px",closeSize:"20px",closeIconSize:"16px",iconSize:"20px",fontSize:"14px"};function self$5(e){const{textColor2:n,closeIconColor:o,closeIconColorHover:r,closeIconColorPressed:u,infoColor:s,successColor:w,errorColor:m,warningColor:v,popoverColor:g,boxShadow2:d,primaryColor:f,lineHeight:y,borderRadius:x,closeColorHover:k,closeColorPressed:P}=e;return Object.assign(Object.assign({},commonVariables),{closeBorderRadius:x,textColor:n,textColorInfo:n,textColorSuccess:n,textColorError:n,textColorWarning:n,textColorLoading:n,color:g,colorInfo:g,colorSuccess:g,colorError:g,colorWarning:g,colorLoading:g,boxShadow:d,boxShadowInfo:d,boxShadowSuccess:d,boxShadowError:d,boxShadowWarning:d,boxShadowLoading:d,iconColor:n,iconColorInfo:s,iconColorSuccess:w,iconColorWarning:v,iconColorError:m,iconColorLoading:f,closeColorHover:k,closeColorPressed:P,closeIconColor:o,closeIconColorHover:r,closeIconColorPressed:u,closeColorHoverInfo:k,closeColorPressedInfo:P,closeIconColorInfo:o,closeIconColorHoverInfo:r,closeIconColorPressedInfo:u,closeColorHoverSuccess:k,closeColorPressedSuccess:P,closeIconColorSuccess:o,closeIconColorHoverSuccess:r,closeIconColorPressedSuccess:u,closeColorHoverError:k,closeColorPressedError:P,closeIconColorError:o,closeIconColorHoverError:r,closeIconColorPressedError:u,closeColorHoverWarning:k,closeColorPressedWarning:P,closeIconColorWarning:o,closeIconColorHoverWarning:r,closeIconColorPressedWarning:u,closeColorHoverLoading:k,closeColorPressedLoading:P,closeIconColorLoading:o,closeIconColorHoverLoading:r,closeIconColorPressedLoading:u,loadingColor:f,lineHeight:y,borderRadius:x})}const messageLight={name:"Message",common:commonLight,self:self$5},messageLight$1=messageLight,messageProps={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},style$4=c$1([cB("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[fadeInHeightExpandTransition({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),cB("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[cE("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),cE("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(e=>cM(`${e}-type`,[c$1("> *",`
 color: var(--n-icon-color-${e});
 transition: color .3s var(--n-bezier);
 `)])),c$1("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[iconSwitchTransition()])]),cE("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[c$1("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),c$1("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),cB("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[cM("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),cM("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),cM("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),cM("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),cM("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),cM("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),iconRenderMap$1={info:()=>h$1(InfoIcon,null),success:()=>h$1(SuccessIcon,null),warning:()=>h$1(WarningIcon,null),error:()=>h$1(ErrorIcon,null),default:()=>null},NMessage=defineComponent({name:"Message",props:Object.assign(Object.assign({},messageProps),{render:Function}),setup(e){const{inlineThemeDisabled:n,mergedRtlRef:o}=useConfig(e),{props:r,mergedClsPrefixRef:u}=inject(messageProviderInjectionKey),s=useRtl("Message",o,u),w=useTheme("Message","-message",style$4,messageLight$1,r,u),m=computed(()=>{const{type:g}=e,{common:{cubicBezierEaseInOut:d},self:{padding:f,margin:y,maxWidth:x,iconMargin:k,closeMargin:P,closeSize:S,iconSize:E,fontSize:M,lineHeight:T,borderRadius:D,iconColorInfo:N,iconColorSuccess:I,iconColorWarning:O,iconColorError:F,iconColorLoading:q,closeIconSize:Y,closeBorderRadius:_e,[createKey("textColor",g)]:ne,[createKey("boxShadow",g)]:ve,[createKey("color",g)]:J,[createKey("closeColorHover",g)]:fe,[createKey("closeColorPressed",g)]:Z,[createKey("closeIconColor",g)]:j,[createKey("closeIconColorPressed",g)]:X,[createKey("closeIconColorHover",g)]:H}}=w.value;return{"--n-bezier":d,"--n-margin":y,"--n-padding":f,"--n-max-width":x,"--n-font-size":M,"--n-icon-margin":k,"--n-icon-size":E,"--n-close-icon-size":Y,"--n-close-border-radius":_e,"--n-close-size":S,"--n-close-margin":P,"--n-text-color":ne,"--n-color":J,"--n-box-shadow":ve,"--n-icon-color-info":N,"--n-icon-color-success":I,"--n-icon-color-warning":O,"--n-icon-color-error":F,"--n-icon-color-loading":q,"--n-close-color-hover":fe,"--n-close-color-pressed":Z,"--n-close-icon-color":j,"--n-close-icon-color-pressed":X,"--n-close-icon-color-hover":H,"--n-line-height":T,"--n-border-radius":D}}),v=n?useThemeClass("message",computed(()=>e.type[0]),m,{}):void 0;return{mergedClsPrefix:u,rtlEnabled:s,messageProviderProps:r,handleClose(){var g;(g=e.onClose)===null||g===void 0||g.call(e)},cssVars:n?void 0:m,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender,placement:r.placement}},render(){const{render:e,type:n,closable:o,content:r,mergedClsPrefix:u,cssVars:s,themeClass:w,onRender:m,icon:v,handleClose:g,showIcon:d}=this;m==null||m();let f;return h$1("div",{class:[`${u}-message-wrapper`,w],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},s]},e?e(this.$props):h$1("div",{class:[`${u}-message ${u}-message--${n}-type`,this.rtlEnabled&&`${u}-message--rtl`]},(f=createIconVNode(v,n,u))&&d?h$1("div",{class:`${u}-message__icon ${u}-message__icon--${n}-type`},h$1(NIconSwitchTransition,null,{default:()=>f})):null,h$1("div",{class:`${u}-message__content`},render(r)),o?h$1(NBaseClose,{clsPrefix:u,class:`${u}-message__close`,onClick:g,absolute:!0}):null))}});function createIconVNode(e,n,o){if(typeof e=="function")return e();{const r=n==="loading"?h$1(NBaseLoading,{clsPrefix:o,strokeWidth:24,scale:.85}):iconRenderMap$1[n]();return r?h$1(NBaseIcon,{clsPrefix:o,key:n},{default:()=>r}):null}}const MessageEnvironment=defineComponent({name:"MessageEnvironment",props:Object.assign(Object.assign({},messageProps),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(e){let n=null;const o=ref(!0);onMounted(()=>{r()});function r(){const{duration:d}=e;d&&(n=window.setTimeout(w,d))}function u(d){d.currentTarget===d.target&&n!==null&&(window.clearTimeout(n),n=null)}function s(d){d.currentTarget===d.target&&r()}function w(){const{onHide:d}=e;o.value=!1,n&&(window.clearTimeout(n),n=null),d&&d()}function m(){const{onClose:d}=e;d&&d(),w()}function v(){const{onAfterLeave:d,onInternalAfterLeave:f,onAfterHide:y,internalKey:x}=e;d&&d(),f&&f(x),y&&y()}function g(){w()}return{show:o,hide:w,handleClose:m,handleAfterLeave:v,handleMouseleave:s,handleMouseenter:u,deactivate:g}},render(){return h$1(NFadeInExpandTransition,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?h$1(NMessage,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),messageProviderProps=Object.assign(Object.assign({},useTheme.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerClass:String,containerStyle:[String,Object]}),NMessageProvider=defineComponent({name:"MessageProvider",props:messageProviderProps,setup(e){const{mergedClsPrefixRef:n}=useConfig(e),o=ref([]),r=ref({}),u={create(v,g){return s(v,Object.assign({type:"default"},g))},info(v,g){return s(v,Object.assign(Object.assign({},g),{type:"info"}))},success(v,g){return s(v,Object.assign(Object.assign({},g),{type:"success"}))},warning(v,g){return s(v,Object.assign(Object.assign({},g),{type:"warning"}))},error(v,g){return s(v,Object.assign(Object.assign({},g),{type:"error"}))},loading(v,g){return s(v,Object.assign(Object.assign({},g),{type:"loading"}))},destroyAll:m};provide(messageProviderInjectionKey,{props:e,mergedClsPrefixRef:n}),provide(messageApiInjectionKey,u);function s(v,g){const d=createId(),f=reactive(Object.assign(Object.assign({},g),{content:v,key:d,destroy:()=>{var x;(x=r.value[d])===null||x===void 0||x.hide()}})),{max:y}=e;return y&&o.value.length>=y&&o.value.shift(),o.value.push(f),f}function w(v){o.value.splice(o.value.findIndex(g=>g.key===v),1),delete r.value[v]}function m(){Object.values(r.value).forEach(v=>{v.hide()})}return Object.assign({mergedClsPrefix:n,messageRefs:r,messageList:o,handleAfterLeave:w},u)},render(){var e,n,o;return h$1(Fragment,null,(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e),this.messageList.length?h$1(Teleport,{to:(o=this.to)!==null&&o!==void 0?o:"body"},h$1("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`,this.containerClass],key:"message-container",style:this.containerStyle},this.messageList.map(r=>h$1(MessageEnvironment,Object.assign({ref:u=>{u&&(this.messageRefs[r.key]=u)},internalKey:r.key,onInternalAfterLeave:this.handleAfterLeave},omit(r,["destroy"],void 0),{duration:r.duration===void 0?this.duration:r.duration,keepAliveOnHover:r.keepAliveOnHover===void 0?this.keepAliveOnHover:r.keepAliveOnHover,closable:r.closable===void 0?this.closable:r.closable}))))):null)}});function useMessage(){const e=inject(messageApiInjectionKey,null);return e===null&&throwError("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}const NModalEnvironment=defineComponent({name:"ModalEnvironment",props:Object.assign(Object.assign({},modalProps),{internalKey:{type:String,required:!0},onInternalAfterLeave:{type:Function,required:!0}}),setup(e){const n=ref(!0);function o(){const{onInternalAfterLeave:d,internalKey:f,onAfterLeave:y}=e;d&&d(f),y&&y()}function r(){const{onPositiveClick:d}=e;d?Promise.resolve(d()).then(f=>{f!==!1&&v()}):v()}function u(){const{onNegativeClick:d}=e;d?Promise.resolve(d()).then(f=>{f!==!1&&v()}):v()}function s(){const{onClose:d}=e;d?Promise.resolve(d()).then(f=>{f!==!1&&v()}):v()}function w(d){const{onMaskClick:f,maskClosable:y}=e;f&&(f(d),y&&v())}function m(){const{onEsc:d}=e;d&&d()}function v(){n.value=!1}function g(d){n.value=d}return{show:n,hide:v,handleUpdateShow:g,handleAfterLeave:o,handleCloseClick:s,handleNegativeClick:u,handlePositiveClick:r,handleMaskClick:w,handleEsc:m}},render(){const{handleUpdateShow:e,handleAfterLeave:n,handleMaskClick:o,handleEsc:r,show:u}=this;return h$1(NModal,Object.assign({},this.$props,{show:u,onUpdateShow:e,onMaskClick:o,onEsc:r,onAfterLeave:n,internalAppear:!0,internalModal:!0}))}}),modalProviderProps={to:[String,Object]},NModalProvider=defineComponent({name:"ModalProvider",props:modalProviderProps,setup(){const e=ref([]),n={};function o(w={}){const m=createId(),v=reactive(Object.assign(Object.assign({},w),{key:m,destroy:()=>{var g;(g=n[`n-modal-${m}`])===null||g===void 0||g.hide()}}));return e.value.push(v),v}function r(w){const{value:m}=e;m.splice(m.findIndex(v=>v.key===w),1)}function u(){Object.values(n).forEach(w=>{w==null||w.hide()})}const s={create:o,destroyAll:u};return provide(modalApiInjectionKey,s),provide(modalProviderInjectionKey,{clickedRef:useClicked(64),clickedPositionRef:useClickPosition()}),provide(modalReactiveListInjectionKey,e),Object.assign(Object.assign({},s),{modalList:e,modalInstRefs:n,handleAfterLeave:r})},render(){var e,n;return h$1(Fragment,null,[this.modalList.map(o=>{var r;return h$1(NModalEnvironment,omit(o,["destroy"],{to:(r=o.to)!==null&&r!==void 0?r:this.to,ref:u=>{u===null?delete this.modalInstRefs[`n-modal-${o.key}`]:this.modalInstRefs[`n-modal-${o.key}`]=u},internalKey:o.key,onInternalAfterLeave:this.handleAfterLeave}))}),(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e)])}}),commonVars$1={closeMargin:"16px 12px",closeSize:"20px",closeIconSize:"16px",width:"365px",padding:"16px",titleFontSize:"16px",metaFontSize:"12px",descriptionFontSize:"12px"};function self$4(e){const{textColor2:n,successColor:o,infoColor:r,warningColor:u,errorColor:s,popoverColor:w,closeIconColor:m,closeIconColorHover:v,closeIconColorPressed:g,closeColorHover:d,closeColorPressed:f,textColor1:y,textColor3:x,borderRadius:k,fontWeightStrong:P,boxShadow2:S,lineHeight:E,fontSize:M}=e;return Object.assign(Object.assign({},commonVars$1),{borderRadius:k,lineHeight:E,fontSize:M,headerFontWeight:P,iconColor:n,iconColorSuccess:o,iconColorInfo:r,iconColorWarning:u,iconColorError:s,color:w,textColor:n,closeIconColor:m,closeIconColorHover:v,closeIconColorPressed:g,closeBorderRadius:k,closeColorHover:d,closeColorPressed:f,headerTextColor:y,descriptionTextColor:x,actionTextColor:n,boxShadow:S})}const notificationLight={name:"Notification",common:commonLight,peers:{Scrollbar:scrollbarLight$1},self:self$4},notificationLight$1=notificationLight,notificationProviderInjectionKey="n-notification-provider",NotificationContainer=defineComponent({name:"NotificationContainer",props:{scrollable:{type:Boolean,required:!0},placement:{type:String,required:!0}},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:n,wipTransitionCountRef:o}=inject(notificationProviderInjectionKey),r=ref(null);return watchEffect(()=>{var u,s;o.value>0?(u=r==null?void 0:r.value)===null||u===void 0||u.classList.add("transitioning"):(s=r==null?void 0:r.value)===null||s===void 0||s.classList.remove("transitioning")}),{selfRef:r,mergedTheme:e,mergedClsPrefix:n,transitioning:o}},render(){const{$slots:e,scrollable:n,mergedClsPrefix:o,mergedTheme:r,placement:u}=this;return h$1("div",{ref:"selfRef",class:[`${o}-notification-container`,n&&`${o}-notification-container--scrollable`,`${o}-notification-container--${u}`]},n?h$1(NScrollbar,{theme:r.peers.Scrollbar,themeOverrides:r.peerOverrides.Scrollbar,contentStyle:{overflow:"hidden"}},e):e)}}),iconRenderMap={info:()=>h$1(InfoIcon,null),success:()=>h$1(SuccessIcon,null),warning:()=>h$1(WarningIcon,null),error:()=>h$1(ErrorIcon,null),default:()=>null},notificationProps={closable:{type:Boolean,default:!0},type:{type:String,default:"default"},avatar:Function,title:[String,Function],description:[String,Function],content:[String,Function],meta:[String,Function],action:[String,Function],onClose:{type:Function,required:!0},keepAliveOnHover:Boolean,onMouseenter:Function,onMouseleave:Function},notificationPropKeys=keysOf(notificationProps),Notification=defineComponent({name:"Notification",props:notificationProps,setup(e){const{mergedClsPrefixRef:n,mergedThemeRef:o,props:r}=inject(notificationProviderInjectionKey),{inlineThemeDisabled:u,mergedRtlRef:s}=useConfig(),w=useRtl("Notification",s,n),m=computed(()=>{const{type:g}=e,{self:{color:d,textColor:f,closeIconColor:y,closeIconColorHover:x,closeIconColorPressed:k,headerTextColor:P,descriptionTextColor:S,actionTextColor:E,borderRadius:M,headerFontWeight:T,boxShadow:D,lineHeight:N,fontSize:I,closeMargin:O,closeSize:F,width:q,padding:Y,closeIconSize:_e,closeBorderRadius:ne,closeColorHover:ve,closeColorPressed:J,titleFontSize:fe,metaFontSize:Z,descriptionFontSize:j,[createKey("iconColor",g)]:X},common:{cubicBezierEaseOut:H,cubicBezierEaseIn:U,cubicBezierEaseInOut:te}}=o.value,{left:Q,right:re,top:Pe,bottom:be}=getMargin(Y);return{"--n-color":d,"--n-font-size":I,"--n-text-color":f,"--n-description-text-color":S,"--n-action-text-color":E,"--n-title-text-color":P,"--n-title-font-weight":T,"--n-bezier":te,"--n-bezier-ease-out":H,"--n-bezier-ease-in":U,"--n-border-radius":M,"--n-box-shadow":D,"--n-close-border-radius":ne,"--n-close-color-hover":ve,"--n-close-color-pressed":J,"--n-close-icon-color":y,"--n-close-icon-color-hover":x,"--n-close-icon-color-pressed":k,"--n-line-height":N,"--n-icon-color":X,"--n-close-margin":O,"--n-close-size":F,"--n-close-icon-size":_e,"--n-width":q,"--n-padding-left":Q,"--n-padding-right":re,"--n-padding-top":Pe,"--n-padding-bottom":be,"--n-title-font-size":fe,"--n-meta-font-size":Z,"--n-description-font-size":j}}),v=u?useThemeClass("notification",computed(()=>e.type[0]),m,r):void 0;return{mergedClsPrefix:n,showAvatar:computed(()=>e.avatar||e.type!=="default"),handleCloseClick(){e.onClose()},rtlEnabled:w,cssVars:u?void 0:m,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender}},render(){var e;const{mergedClsPrefix:n}=this;return(e=this.onRender)===null||e===void 0||e.call(this),h$1("div",{class:[`${n}-notification-wrapper`,this.themeClass],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:this.cssVars},h$1("div",{class:[`${n}-notification`,this.rtlEnabled&&`${n}-notification--rtl`,this.themeClass,{[`${n}-notification--closable`]:this.closable,[`${n}-notification--show-avatar`]:this.showAvatar}],style:this.cssVars},this.showAvatar?h$1("div",{class:`${n}-notification__avatar`},this.avatar?render(this.avatar):this.type!=="default"?h$1(NBaseIcon,{clsPrefix:n},{default:()=>iconRenderMap[this.type]()}):null):null,this.closable?h$1(NBaseClose,{clsPrefix:n,class:`${n}-notification__close`,onClick:this.handleCloseClick}):null,h$1("div",{ref:"bodyRef",class:`${n}-notification-main`},this.title?h$1("div",{class:`${n}-notification-main__header`},render(this.title)):null,this.description?h$1("div",{class:`${n}-notification-main__description`},render(this.description)):null,this.content?h$1("pre",{class:`${n}-notification-main__content`},render(this.content)):null,this.meta||this.action?h$1("div",{class:`${n}-notification-main-footer`},this.meta?h$1("div",{class:`${n}-notification-main-footer__meta`},render(this.meta)):null,this.action?h$1("div",{class:`${n}-notification-main-footer__action`},render(this.action)):null):null)))}}),notificationEnvOptions=Object.assign(Object.assign({},notificationProps),{duration:Number,onClose:Function,onLeave:Function,onAfterEnter:Function,onAfterLeave:Function,onHide:Function,onAfterShow:Function,onAfterHide:Function}),NotificationEnvironment=defineComponent({name:"NotificationEnvironment",props:Object.assign(Object.assign({},notificationEnvOptions),{internalKey:{type:String,required:!0},onInternalAfterLeave:{type:Function,required:!0}}),setup(e){const{wipTransitionCountRef:n}=inject(notificationProviderInjectionKey),o=ref(!0);let r=null;function u(){o.value=!1,r&&window.clearTimeout(r)}function s(k){n.value++,nextTick(()=>{k.style.height=`${k.offsetHeight}px`,k.style.maxHeight="0",k.style.transition="none",k.offsetHeight,k.style.transition="",k.style.maxHeight=k.style.height})}function w(k){n.value--,k.style.height="",k.style.maxHeight="";const{onAfterEnter:P,onAfterShow:S}=e;P&&P(),S&&S()}function m(k){n.value++,k.style.maxHeight=`${k.offsetHeight}px`,k.style.height=`${k.offsetHeight}px`,k.offsetHeight}function v(k){const{onHide:P}=e;P&&P(),k.style.maxHeight="0",k.offsetHeight}function g(){n.value--;const{onAfterLeave:k,onInternalAfterLeave:P,onAfterHide:S,internalKey:E}=e;k&&k(),P(E),S&&S()}function d(){const{duration:k}=e;k&&(r=window.setTimeout(u,k))}function f(k){k.currentTarget===k.target&&r!==null&&(window.clearTimeout(r),r=null)}function y(k){k.currentTarget===k.target&&d()}function x(){const{onClose:k}=e;k?Promise.resolve(k()).then(P=>{P!==!1&&u()}):u()}return onMounted(()=>{e.duration&&(r=window.setTimeout(u,e.duration))}),{show:o,hide:u,handleClose:x,handleAfterLeave:g,handleLeave:v,handleBeforeLeave:m,handleAfterEnter:w,handleBeforeEnter:s,handleMouseenter:f,handleMouseleave:y}},render(){return h$1(Transition,{name:"notification-transition",appear:!0,onBeforeEnter:this.handleBeforeEnter,onAfterEnter:this.handleAfterEnter,onBeforeLeave:this.handleBeforeLeave,onLeave:this.handleLeave,onAfterLeave:this.handleAfterLeave},{default:()=>this.show?h$1(Notification,Object.assign({},keep(this.$props,notificationPropKeys),{onClose:this.handleClose,onMouseenter:this.duration&&this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.duration&&this.keepAliveOnHover?this.handleMouseleave:void 0})):null})}}),style$3=c$1([cB("notification-container",`
 z-index: 4000;
 position: fixed;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: flex-end;
 `,[c$1(">",[cB("scrollbar",`
 width: initial;
 overflow: visible;
 height: -moz-fit-content !important;
 height: fit-content !important;
 max-height: 100vh !important;
 `,[c$1(">",[cB("scrollbar-container",`
 height: -moz-fit-content !important;
 height: fit-content !important;
 max-height: 100vh !important;
 `,[cB("scrollbar-content",`
 padding-top: 12px;
 padding-bottom: 33px;
 `)])])])]),cM("top, top-right, top-left",`
 top: 12px;
 `,[c$1("&.transitioning >",[cB("scrollbar",[c$1(">",[cB("scrollbar-container",`
 min-height: 100vh !important;
 `)])])])]),cM("bottom, bottom-right, bottom-left",`
 bottom: 12px;
 `,[c$1(">",[cB("scrollbar",[c$1(">",[cB("scrollbar-container",[cB("scrollbar-content",`
 padding-bottom: 12px;
 `)])])])]),cB("notification-wrapper",`
 display: flex;
 align-items: flex-end;
 margin-bottom: 0;
 margin-top: 12px;
 `)]),cM("top, bottom",`
 left: 50%;
 transform: translateX(-50%);
 `,[cB("notification-wrapper",[c$1("&.notification-transition-enter-from, &.notification-transition-leave-to",`
 transform: scale(0.85);
 `),c$1("&.notification-transition-leave-from, &.notification-transition-enter-to",`
 transform: scale(1);
 `)])]),cM("top",[cB("notification-wrapper",`
 transform-origin: top center;
 `)]),cM("bottom",[cB("notification-wrapper",`
 transform-origin: bottom center;
 `)]),cM("top-right, bottom-right",[cB("notification",`
 margin-left: 28px;
 margin-right: 16px;
 `)]),cM("top-left, bottom-left",[cB("notification",`
 margin-left: 16px;
 margin-right: 28px;
 `)]),cM("top-right",`
 right: 0;
 `,[placementTransformStyle("top-right")]),cM("top-left",`
 left: 0;
 `,[placementTransformStyle("top-left")]),cM("bottom-right",`
 right: 0;
 `,[placementTransformStyle("bottom-right")]),cM("bottom-left",`
 left: 0;
 `,[placementTransformStyle("bottom-left")]),cM("scrollable",[cM("top-right",`
 top: 0;
 `),cM("top-left",`
 top: 0;
 `),cM("bottom-right",`
 bottom: 0;
 `),cM("bottom-left",`
 bottom: 0;
 `)]),cB("notification-wrapper",`
 margin-bottom: 12px;
 `,[c$1("&.notification-transition-enter-from, &.notification-transition-leave-to",`
 opacity: 0;
 margin-top: 0 !important;
 margin-bottom: 0 !important;
 `),c$1("&.notification-transition-leave-from, &.notification-transition-enter-to",`
 opacity: 1;
 `),c$1("&.notification-transition-leave-active",`
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier-ease-in),
 max-height .3s var(--n-bezier),
 margin-top .3s linear,
 margin-bottom .3s linear,
 box-shadow .3s var(--n-bezier);
 `),c$1("&.notification-transition-enter-active",`
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier-ease-out),
 max-height .3s var(--n-bezier),
 margin-top .3s linear,
 margin-bottom .3s linear,
 box-shadow .3s var(--n-bezier);
 `)]),cB("notification",`
 background-color: var(--n-color);
 color: var(--n-text-color);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 font-family: inherit;
 font-size: var(--n-font-size);
 font-weight: 400;
 position: relative;
 display: flex;
 overflow: hidden;
 flex-shrink: 0;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 width: var(--n-width);
 max-width: calc(100vw - 16px - 16px);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 box-sizing: border-box;
 opacity: 1;
 `,[cE("avatar",[cB("icon",`
 color: var(--n-icon-color);
 `),cB("base-icon",`
 color: var(--n-icon-color);
 `)]),cM("show-avatar",[cB("notification-main",`
 margin-left: 40px;
 width: calc(100% - 40px); 
 `)]),cM("closable",[cB("notification-main",[c$1("> *:first-child",`
 padding-right: 20px;
 `)]),cE("close",`
 position: absolute;
 top: 0;
 right: 0;
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),cE("avatar",`
 position: absolute;
 top: var(--n-padding-top);
 left: var(--n-padding-left);
 width: 28px;
 height: 28px;
 font-size: 28px;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[cB("icon","transition: color .3s var(--n-bezier);")]),cB("notification-main",`
 padding-top: var(--n-padding-top);
 padding-bottom: var(--n-padding-bottom);
 box-sizing: border-box;
 display: flex;
 flex-direction: column;
 margin-left: 8px;
 width: calc(100% - 8px);
 `,[cB("notification-main-footer",`
 display: flex;
 align-items: center;
 justify-content: space-between;
 margin-top: 12px;
 `,[cE("meta",`
 font-size: var(--n-meta-font-size);
 transition: color .3s var(--n-bezier-ease-out);
 color: var(--n-description-text-color);
 `),cE("action",`
 cursor: pointer;
 transition: color .3s var(--n-bezier-ease-out);
 color: var(--n-action-text-color);
 `)]),cE("header",`
 font-weight: var(--n-title-font-weight);
 font-size: var(--n-title-font-size);
 transition: color .3s var(--n-bezier-ease-out);
 color: var(--n-title-text-color);
 `),cE("description",`
 margin-top: 8px;
 font-size: var(--n-description-font-size);
 white-space: pre-wrap;
 word-wrap: break-word;
 transition: color .3s var(--n-bezier-ease-out);
 color: var(--n-description-text-color);
 `),cE("content",`
 line-height: var(--n-line-height);
 margin: 12px 0 0 0;
 font-family: inherit;
 white-space: pre-wrap;
 word-wrap: break-word;
 transition: color .3s var(--n-bezier-ease-out);
 color: var(--n-text-color);
 `,[c$1("&:first-child","margin: 0;")])])])])]);function placementTransformStyle(e){const o=e.split("-")[1]==="left"?"calc(-100%)":"calc(100%)",r="0";return cB("notification-wrapper",[c$1("&.notification-transition-enter-from, &.notification-transition-leave-to",`
 transform: translate(${o}, 0);
 `),c$1("&.notification-transition-leave-from, &.notification-transition-enter-to",`
 transform: translate(${r}, 0);
 `)])}const notificationApiInjectionKey="n-notification-api",notificationProviderProps=Object.assign(Object.assign({},useTheme.props),{containerClass:String,containerStyle:[String,Object],to:[String,Object],scrollable:{type:Boolean,default:!0},max:Number,placement:{type:String,default:"top-right"},keepAliveOnHover:Boolean}),NNotificationProvider=defineComponent({name:"NotificationProvider",props:notificationProviderProps,setup(e){const{mergedClsPrefixRef:n}=useConfig(e),o=ref([]),r={},u=new Set;function s(x){const k=createId(),P=()=>{u.add(k),r[k]&&r[k].hide()},S=reactive(Object.assign(Object.assign({},x),{key:k,destroy:P,hide:P,deactivate:P})),{max:E}=e;if(E&&o.value.length-u.size>=E){let M=!1,T=0;for(const D of o.value){if(!u.has(D.key)){r[D.key]&&(D.destroy(),M=!0);break}T++}M||o.value.splice(T,1)}return o.value.push(S),S}const w=["info","success","warning","error"].map(x=>k=>s(Object.assign(Object.assign({},k),{type:x})));function m(x){u.delete(x),o.value.splice(o.value.findIndex(k=>k.key===x),1)}const v=useTheme("Notification","-notification",style$3,notificationLight$1,e,n),g={create:s,info:w[0],success:w[1],warning:w[2],error:w[3],open:f,destroyAll:y},d=ref(0);provide(notificationApiInjectionKey,g),provide(notificationProviderInjectionKey,{props:e,mergedClsPrefixRef:n,mergedThemeRef:v,wipTransitionCountRef:d});function f(x){return s(x)}function y(){Object.values(o.value).forEach(x=>{x.hide()})}return Object.assign({mergedClsPrefix:n,notificationList:o,notificationRefs:r,handleAfterLeave:m},g)},render(){var e,n,o;const{placement:r}=this;return h$1(Fragment,null,(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e),this.notificationList.length?h$1(Teleport,{to:(o=this.to)!==null&&o!==void 0?o:"body"},h$1(NotificationContainer,{class:this.containerClass,style:this.containerStyle,scrollable:this.scrollable&&r!=="top"&&r!=="bottom",placement:r},{default:()=>this.notificationList.map(u=>h$1(NotificationEnvironment,Object.assign({ref:s=>{const w=u.key;s===null?delete this.notificationRefs[w]:this.notificationRefs[w]=s}},omit(u,["destroy","hide","deactivate"]),{internalKey:u.key,onInternalAfterLeave:this.handleAfterLeave,keepAliveOnHover:u.keepAliveOnHover===void 0?this.keepAliveOnHover:u.keepAliveOnHover})))})):null)}});function useNotification(){const e=inject(notificationApiInjectionKey,null);return e===null&&throwError("use-notification","No outer `n-notification-provider` found."),e}const NInjectionExtractor=defineComponent({name:"InjectionExtractor",props:{onSetup:Function},setup(e,{slots:n}){var o;return(o=e.onSetup)===null||o===void 0||o.call(e),()=>{var r;return(r=n.default)===null||r===void 0?void 0:r.call(n)}}}),injectionFactoryMap={message:useMessage,notification:useNotification,loadingBar:useLoadingBar,dialog:useDialog,modal:useModal};function createDiscreteApp({providersAndProps:e,configProviderProps:n}){let o=createApp(u);const r={app:o};function u(){return h$1(NConfigProvider,unref(n),{default:()=>e.map(({type:m,Provider:v,props:g})=>h$1(v,unref(g),{default:()=>h$1(NInjectionExtractor,{onSetup:()=>r[m]=injectionFactoryMap[m]()})}))})}let s;return isBrowser$1&&(s=document.createElement("div"),document.body.appendChild(s),o.mount(s)),Object.assign({unmount:()=>{var m;if(o===null||s===null){warn("discrete","unmount call no need because discrete app has been unmounted");return}o.unmount(),(m=s.parentNode)===null||m===void 0||m.removeChild(s),s=null,o=null}},r)}function createDiscreteApi(e,{configProviderProps:n,messageProviderProps:o,dialogProviderProps:r,notificationProviderProps:u,loadingBarProviderProps:s,modalProviderProps:w}={}){const m=[];return e.forEach(g=>{switch(g){case"message":m.push({type:g,Provider:NMessageProvider,props:o});break;case"notification":m.push({type:g,Provider:NNotificationProvider,props:u});break;case"dialog":m.push({type:g,Provider:NDialogProvider,props:r});break;case"loadingBar":m.push({type:g,Provider:NLoadingBarProvider,props:s});break;case"modal":m.push({type:g,Provider:NModalProvider,props:w})}}),createDiscreteApp({providersAndProps:m,configProviderProps:n})}function self$3(e){const{textColorDisabled:n}=e;return{iconColorDisabled:n}}const inputNumberLight={name:"InputNumber",common:commonLight,peers:{Button:buttonLight$1,Input:inputLight$1},self:self$3},inputNumberLight$1=inputNumberLight,sizeVariables={railHeight:"4px",railWidthVertical:"4px",handleSize:"18px",dotHeight:"8px",dotWidth:"8px",dotBorderRadius:"4px"};function self$2(e){const n="rgba(0, 0, 0, .85)",o="0 2px 8px 0 rgba(0, 0, 0, 0.12)",{railColor:r,primaryColor:u,baseColor:s,cardColor:w,modalColor:m,popoverColor:v,borderRadius:g,fontSize:d,opacityDisabled:f}=e;return Object.assign(Object.assign({},sizeVariables),{fontSize:d,markFontSize:d,railColor:r,railColorHover:r,fillColor:u,fillColorHover:u,opacityDisabled:f,handleColor:"#FFF",dotColor:w,dotColorModal:m,dotColorPopover:v,handleBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",handleBoxShadowHover:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",handleBoxShadowActive:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",handleBoxShadowFocus:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",indicatorColor:n,indicatorBoxShadow:o,indicatorTextColor:s,indicatorBorderRadius:g,dotBorder:`2px solid ${r}`,dotBorderActive:`2px solid ${u}`,dotBoxShadow:""})}const sliderLight={name:"Slider",common:commonLight,self:self$2},sliderLight$1=sliderLight,commonVars={buttonHeightSmall:"14px",buttonHeightMedium:"18px",buttonHeightLarge:"22px",buttonWidthSmall:"14px",buttonWidthMedium:"18px",buttonWidthLarge:"22px",buttonWidthPressedSmall:"20px",buttonWidthPressedMedium:"24px",buttonWidthPressedLarge:"28px",railHeightSmall:"18px",railHeightMedium:"22px",railHeightLarge:"26px",railWidthSmall:"32px",railWidthMedium:"40px",railWidthLarge:"48px"};function self$1(e){const{primaryColor:n,opacityDisabled:o,borderRadius:r,textColor3:u}=e,s="rgba(0, 0, 0, .14)";return Object.assign(Object.assign({},commonVars),{iconColor:u,textColor:"white",loadingColor:n,opacityDisabled:o,railColor:s,railColorActive:n,buttonBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",buttonColor:"#FFF",railBorderRadiusSmall:r,railBorderRadiusMedium:r,railBorderRadiusLarge:r,buttonBorderRadiusSmall:r,buttonBorderRadiusMedium:r,buttonBorderRadiusLarge:r,boxShadowFocus:`0 0 0 2px ${changeColor(n,{alpha:.2})}`})}const switchLight={name:"Switch",common:commonLight,self:self$1},switchLight$1=switchLight,style$2=c$1([cB("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `),cB("input-number-prefix",`
 display: inline-block;
 margin-left: 10px;
 `)]);function parse(e){return e==null||typeof e=="string"&&e.trim()===""?null:Number(e)}function isWipValue(e){return e.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(e)||/^-?\d*$/.test(e))||e==="-"||e==="-0"}function validator$2(e){return e==null?!0:!Number.isNaN(e)}function format$2(e,n){return typeof e!="number"?"":n===void 0?String(e):e.toFixed(n)}function parseNumber(e){if(e===null)return null;if(typeof e=="number")return e;{const n=Number(e);return Number.isNaN(n)?null:n}}const HOLDING_CHANGE_THRESHOLD=800,HOLDING_CHANGE_INTERVAL=100,inputNumberProps=Object.assign(Object.assign({},useTheme.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},buttonPlacement:{type:String,default:"right"},inputProps:Object,readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},round:{type:Boolean,default:void 0},parse:Function,format:Function,precision:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]}),NInputNumber=defineComponent({name:"InputNumber",props:inputNumberProps,slots:Object,setup(e){const{mergedBorderedRef:n,mergedClsPrefixRef:o,mergedRtlRef:r}=useConfig(e),u=useTheme("InputNumber","-input-number",style$2,inputNumberLight$1,e,o),{localeRef:s}=useLocale("InputNumber"),w=useFormItem(e),{mergedSizeRef:m,mergedDisabledRef:v,mergedStatusRef:g}=w,d=ref(null),f=ref(null),y=ref(null),x=ref(e.defaultValue),k=toRef(e,"value"),P=useMergedState(k,x),S=ref(""),E=Be=>{const Ve=String(Be).split(".")[1];return Ve?Ve.length:0},M=Be=>{const Ve=[e.min,e.max,e.step,Be].map(Oe=>Oe===void 0?0:E(Oe));return Math.max(...Ve)},T=useMemo(()=>{const{placeholder:Be}=e;return Be!==void 0?Be:s.value.placeholder}),D=useMemo(()=>{const Be=parseNumber(e.step);return Be!==null?Be===0?1:Math.abs(Be):1}),N=useMemo(()=>{const Be=parseNumber(e.min);return Be!==null?Be:null}),I=useMemo(()=>{const Be=parseNumber(e.max);return Be!==null?Be:null}),O=()=>{const{value:Be}=P;if(validator$2(Be)){const{format:Ve,precision:Oe}=e;Ve?S.value=Ve(Be):Be===null||Oe===void 0||E(Be)>Oe?S.value=format$2(Be,void 0):S.value=format$2(Be,Oe)}else S.value=String(Be)};O();const F=Be=>{const{value:Ve}=P;if(Be===Ve){O();return}const{"onUpdate:value":Oe,onUpdateValue:je,onChange:Ge}=e,{nTriggerFormInput:Xe,nTriggerFormChange:qe}=w;Ge&&call(Ge,Be),je&&call(je,Be),Oe&&call(Oe,Be),x.value=Be,Xe(),qe()},q=({offset:Be,doUpdateIfValid:Ve,fixPrecision:Oe,isInputing:je})=>{const{value:Ge}=S;if(je&&isWipValue(Ge))return!1;const Xe=(e.parse||parse)(Ge);if(Xe===null)return Ve&&F(null),null;if(validator$2(Xe)){const qe=E(Xe),{precision:Ke}=e;if(Ke!==void 0&&Ke<qe&&!Oe)return!1;let Je=Number.parseFloat((Xe+Be).toFixed(Ke!=null?Ke:M(Xe)));if(validator$2(Je)){const{value:rt}=I,{value:ht}=N;if(rt!==null&&Je>rt){if(!Ve||je)return!1;Je=rt}if(ht!==null&&Je<ht){if(!Ve||je)return!1;Je=ht}return e.validator&&!e.validator(Je)?!1:(Ve&&F(Je),Je)}}return!1},Y=useMemo(()=>q({offset:0,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})===!1),_e=useMemo(()=>{const{value:Be}=P;if(e.validator&&Be===null)return!1;const{value:Ve}=D;return q({offset:-Ve,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1}),ne=useMemo(()=>{const{value:Be}=P;if(e.validator&&Be===null)return!1;const{value:Ve}=D;return q({offset:+Ve,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1});function ve(Be){const{onFocus:Ve}=e,{nTriggerFormFocus:Oe}=w;Ve&&call(Ve,Be),Oe()}function J(Be){var Ve,Oe;if(Be.target===((Ve=d.value)===null||Ve===void 0?void 0:Ve.wrapperElRef))return;const je=q({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0});if(je!==!1){const qe=(Oe=d.value)===null||Oe===void 0?void 0:Oe.inputElRef;qe&&(qe.value=String(je||"")),P.value===je&&O()}else O();const{onBlur:Ge}=e,{nTriggerFormBlur:Xe}=w;Ge&&call(Ge,Be),Xe(),nextTick(()=>{O()})}function fe(Be){const{onClear:Ve}=e;Ve&&call(Ve,Be)}function Z(){const{value:Be}=ne;if(!Be){$e();return}const{value:Ve}=P;if(Ve===null)e.validator||F(U());else{const{value:Oe}=D;q({offset:Oe,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}function j(){const{value:Be}=_e;if(!Be){we();return}const{value:Ve}=P;if(Ve===null)e.validator||F(U());else{const{value:Oe}=D;q({offset:-Oe,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}const X=ve,H=J;function U(){if(e.validator)return null;const{value:Be}=N,{value:Ve}=I;return Be!==null?Math.max(0,Be):Ve!==null?Math.min(0,Ve):0}function te(Be){fe(Be),F(null)}function Q(Be){var Ve,Oe,je;!((Ve=y.value)===null||Ve===void 0)&&Ve.$el.contains(Be.target)&&Be.preventDefault(),!((Oe=f.value)===null||Oe===void 0)&&Oe.$el.contains(Be.target)&&Be.preventDefault(),(je=d.value)===null||je===void 0||je.activate()}let re=null,Pe=null,be=null;function we(){be&&(window.clearTimeout(be),be=null),re&&(window.clearInterval(re),re=null)}let Ae=null;function $e(){Ae&&(window.clearTimeout(Ae),Ae=null),Pe&&(window.clearInterval(Pe),Pe=null)}function Me(){we(),be=window.setTimeout(()=>{re=window.setInterval(()=>{j()},HOLDING_CHANGE_INTERVAL)},HOLDING_CHANGE_THRESHOLD),on$1("mouseup",document,we,{once:!0})}function Ie(){$e(),Ae=window.setTimeout(()=>{Pe=window.setInterval(()=>{Z()},HOLDING_CHANGE_INTERVAL)},HOLDING_CHANGE_THRESHOLD),on$1("mouseup",document,$e,{once:!0})}const Le=()=>{Pe||Z()},le=()=>{re||j()};function oe(Be){var Ve,Oe;if(Be.key==="Enter"){if(Be.target===((Ve=d.value)===null||Ve===void 0?void 0:Ve.wrapperElRef))return;q({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&((Oe=d.value)===null||Oe===void 0||Oe.deactivate())}else if(Be.key==="ArrowUp"){if(!ne.value||e.keyboard.ArrowUp===!1)return;Be.preventDefault(),q({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&Z()}else if(Be.key==="ArrowDown"){if(!_e.value||e.keyboard.ArrowDown===!1)return;Be.preventDefault(),q({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&j()}}function ke(Be){S.value=Be,e.updateValueOnInput&&!e.format&&!e.parse&&e.precision===void 0&&q({offset:0,doUpdateIfValid:!0,isInputing:!0,fixPrecision:!1})}watch(P,()=>{O()});const Ce={focus:()=>{var Be;return(Be=d.value)===null||Be===void 0?void 0:Be.focus()},blur:()=>{var Be;return(Be=d.value)===null||Be===void 0?void 0:Be.blur()},select:()=>{var Be;return(Be=d.value)===null||Be===void 0?void 0:Be.select()}},Ee=useRtl("InputNumber",r,o);return Object.assign(Object.assign({},Ce),{rtlEnabled:Ee,inputInstRef:d,minusButtonInstRef:f,addButtonInstRef:y,mergedClsPrefix:o,mergedBordered:n,uncontrolledValue:x,mergedValue:P,mergedPlaceholder:T,displayedValueInvalid:Y,mergedSize:m,mergedDisabled:v,displayedValue:S,addable:ne,minusable:_e,mergedStatus:g,handleFocus:X,handleBlur:H,handleClear:te,handleMouseDown:Q,handleAddClick:Le,handleMinusClick:le,handleAddMousedown:Ie,handleMinusMousedown:Me,handleKeyDown:oe,handleUpdateDisplayedValue:ke,mergedTheme:u,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:computed(()=>{const{self:{iconColorDisabled:Be}}=u.value,[Ve,Oe,je,Ge]=rgba(Be);return{textColorTextDisabled:`rgb(${Ve}, ${Oe}, ${je})`,opacityDisabled:`${Ge}`}})})},render(){const{mergedClsPrefix:e,$slots:n}=this,o=()=>h$1(XButton,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{icon:()=>resolveSlot(n["minus-icon"],()=>[h$1(NBaseIcon,{clsPrefix:e},{default:()=>h$1(RemoveIcon,null)})])}),r=()=>h$1(XButton,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{icon:()=>resolveSlot(n["add-icon"],()=>[h$1(NBaseIcon,{clsPrefix:e},{default:()=>h$1(AddIcon,null)})])});return h$1("div",{class:[`${e}-input-number`,this.rtlEnabled&&`${e}-input-number--rtl`]},h$1(NInput,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,round:this.round,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,inputProps:this.inputProps,internalLoadingBeforeSuffix:!0},{prefix:()=>{var u;return this.showButton&&this.buttonPlacement==="both"?[o(),resolveWrappedSlot(n.prefix,s=>s?h$1("span",{class:`${e}-input-number-prefix`},s):null)]:(u=n.prefix)===null||u===void 0?void 0:u.call(n)},suffix:()=>{var u;return this.showButton?[resolveWrappedSlot(n.suffix,s=>s?h$1("span",{class:`${e}-input-number-suffix`},s):null),this.buttonPlacement==="right"?o():null,r()]:(u=n.suffix)===null||u===void 0?void 0:u.call(n)}}))}}),style$1=c$1([cB("slider",`
 display: block;
 padding: calc((var(--n-handle-size) - var(--n-rail-height)) / 2) 0;
 position: relative;
 z-index: 0;
 width: 100%;
 cursor: pointer;
 user-select: none;
 -webkit-user-select: none;
 `,[cM("reverse",[cB("slider-handles",[cB("slider-handle-wrapper",`
 transform: translate(50%, -50%);
 `)]),cB("slider-dots",[cB("slider-dot",`
 transform: translateX(50%, -50%);
 `)]),cM("vertical",[cB("slider-handles",[cB("slider-handle-wrapper",`
 transform: translate(-50%, -50%);
 `)]),cB("slider-marks",[cB("slider-mark",`
 transform: translateY(calc(-50% + var(--n-dot-height) / 2));
 `)]),cB("slider-dots",[cB("slider-dot",`
 transform: translateX(-50%) translateY(0);
 `)])])]),cM("vertical",`
 box-sizing: content-box;
 padding: 0 calc((var(--n-handle-size) - var(--n-rail-height)) / 2);
 width: var(--n-rail-width-vertical);
 height: 100%;
 `,[cB("slider-handles",`
 top: calc(var(--n-handle-size) / 2);
 right: 0;
 bottom: calc(var(--n-handle-size) / 2);
 left: 0;
 `,[cB("slider-handle-wrapper",`
 top: unset;
 left: 50%;
 transform: translate(-50%, 50%);
 `)]),cB("slider-rail",`
 height: 100%;
 `,[cE("fill",`
 top: unset;
 right: 0;
 bottom: unset;
 left: 0;
 `)]),cM("with-mark",`
 width: var(--n-rail-width-vertical);
 margin: 0 32px 0 8px;
 `),cB("slider-marks",`
 top: calc(var(--n-handle-size) / 2);
 right: unset;
 bottom: calc(var(--n-handle-size) / 2);
 left: 22px;
 font-size: var(--n-mark-font-size);
 `,[cB("slider-mark",`
 transform: translateY(50%);
 white-space: nowrap;
 `)]),cB("slider-dots",`
 top: calc(var(--n-handle-size) / 2);
 right: unset;
 bottom: calc(var(--n-handle-size) / 2);
 left: 50%;
 `,[cB("slider-dot",`
 transform: translateX(-50%) translateY(50%);
 `)])]),cM("disabled",`
 cursor: not-allowed;
 opacity: var(--n-opacity-disabled);
 `,[cB("slider-handle",`
 cursor: not-allowed;
 `)]),cM("with-mark",`
 width: 100%;
 margin: 8px 0 32px 0;
 `),c$1("&:hover",[cB("slider-rail",{backgroundColor:"var(--n-rail-color-hover)"},[cE("fill",{backgroundColor:"var(--n-fill-color-hover)"})]),cB("slider-handle",{boxShadow:"var(--n-handle-box-shadow-hover)"})]),cM("active",[cB("slider-rail",{backgroundColor:"var(--n-rail-color-hover)"},[cE("fill",{backgroundColor:"var(--n-fill-color-hover)"})]),cB("slider-handle",{boxShadow:"var(--n-handle-box-shadow-hover)"})]),cB("slider-marks",`
 position: absolute;
 top: 18px;
 left: calc(var(--n-handle-size) / 2);
 right: calc(var(--n-handle-size) / 2);
 `,[cB("slider-mark",`
 position: absolute;
 transform: translateX(-50%);
 white-space: nowrap;
 `)]),cB("slider-rail",`
 width: 100%;
 position: relative;
 height: var(--n-rail-height);
 background-color: var(--n-rail-color);
 transition: background-color .3s var(--n-bezier);
 border-radius: calc(var(--n-rail-height) / 2);
 `,[cE("fill",`
 position: absolute;
 top: 0;
 bottom: 0;
 border-radius: calc(var(--n-rail-height) / 2);
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-fill-color);
 `)]),cB("slider-handles",`
 position: absolute;
 top: 0;
 right: calc(var(--n-handle-size) / 2);
 bottom: 0;
 left: calc(var(--n-handle-size) / 2);
 `,[cB("slider-handle-wrapper",`
 outline: none;
 position: absolute;
 top: 50%;
 transform: translate(-50%, -50%);
 cursor: pointer;
 display: flex;
 `,[cB("slider-handle",`
 height: var(--n-handle-size);
 width: var(--n-handle-size);
 border-radius: 50%;
 overflow: hidden;
 transition: box-shadow .2s var(--n-bezier), background-color .3s var(--n-bezier);
 background-color: var(--n-handle-color);
 box-shadow: var(--n-handle-box-shadow);
 `,[c$1("&:hover",`
 box-shadow: var(--n-handle-box-shadow-hover);
 `)]),c$1("&:focus",[cB("slider-handle",`
 box-shadow: var(--n-handle-box-shadow-focus);
 `,[c$1("&:hover",`
 box-shadow: var(--n-handle-box-shadow-active);
 `)])])])]),cB("slider-dots",`
 position: absolute;
 top: 50%;
 left: calc(var(--n-handle-size) / 2);
 right: calc(var(--n-handle-size) / 2);
 `,[cM("transition-disabled",[cB("slider-dot","transition: none;")]),cB("slider-dot",`
 transition:
 border-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 transform: translate(-50%, -50%);
 height: var(--n-dot-height);
 width: var(--n-dot-width);
 border-radius: var(--n-dot-border-radius);
 overflow: hidden;
 box-sizing: border-box;
 border: var(--n-dot-border);
 background-color: var(--n-dot-color);
 `,[cM("active","border: var(--n-dot-border-active);")])])]),cB("slider-handle-indicator",`
 font-size: var(--n-font-size);
 padding: 6px 10px;
 border-radius: var(--n-indicator-border-radius);
 color: var(--n-indicator-text-color);
 background-color: var(--n-indicator-color);
 box-shadow: var(--n-indicator-box-shadow);
 `,[fadeInScaleUpTransition()]),cB("slider-handle-indicator",`
 font-size: var(--n-font-size);
 padding: 6px 10px;
 border-radius: var(--n-indicator-border-radius);
 color: var(--n-indicator-text-color);
 background-color: var(--n-indicator-color);
 box-shadow: var(--n-indicator-box-shadow);
 `,[cM("top",`
 margin-bottom: 12px;
 `),cM("right",`
 margin-left: 12px;
 `),cM("bottom",`
 margin-top: 12px;
 `),cM("left",`
 margin-right: 12px;
 `),fadeInScaleUpTransition()]),insideModal(cB("slider",[cB("slider-dot","background-color: var(--n-dot-color-modal);")])),insidePopover(cB("slider",[cB("slider-dot","background-color: var(--n-dot-color-popover);")]))]);function isTouchEvent(e){return window.TouchEvent&&e instanceof window.TouchEvent}function useRefs(){const e=new Map,n=o=>r=>{e.set(o,r)};return onBeforeUpdate(()=>{e.clear()}),[e,n]}const eventButtonLeft=0,sliderProps=Object.assign(Object.assign({},useTheme.props),{to:useAdjustedTo.propTo,defaultValue:{type:[Number,Array],default:0},marks:Object,disabled:{type:Boolean,default:void 0},formatTooltip:Function,keyboard:{type:Boolean,default:!0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:[Number,String],default:1},range:Boolean,value:[Number,Array],placement:String,showTooltip:{type:Boolean,default:void 0},tooltip:{type:Boolean,default:!0},vertical:Boolean,reverse:Boolean,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onDragstart:[Function],onDragend:[Function]}),NSlider=defineComponent({name:"Slider",props:sliderProps,slots:Object,setup(e){const{mergedClsPrefixRef:n,namespaceRef:o,inlineThemeDisabled:r}=useConfig(e),u=useTheme("Slider","-slider",style$1,sliderLight$1,e,n),s=ref(null),[w,m]=useRefs(),[v,g]=useRefs(),d=ref(new Set),f=useFormItem(e),{mergedDisabledRef:y}=f,x=computed(()=>{const{step:qe}=e;if(Number(qe)<=0||qe==="mark")return 0;const Ke=qe.toString();let Je=0;return Ke.includes(".")&&(Je=Ke.length-Ke.indexOf(".")-1),Je}),k=ref(e.defaultValue),P=toRef(e,"value"),S=useMergedState(P,k),E=computed(()=>{const{value:qe}=S;return(e.range?qe:[qe]).map(Q)}),M=computed(()=>E.value.length>2),T=computed(()=>e.placement===void 0?e.vertical?"right":"top":e.placement),D=computed(()=>{const{marks:qe}=e;return qe?Object.keys(qe).map(Number.parseFloat):null}),N=ref(-1),I=ref(-1),O=ref(-1),F=ref(!1),q=ref(!1),Y=computed(()=>{const{vertical:qe,reverse:Ke}=e;return qe?Ke?"top":"bottom":Ke?"right":"left"}),_e=computed(()=>{if(M.value)return;const qe=E.value,Ke=re(e.range?Math.min(...qe):e.min),Je=re(e.range?Math.max(...qe):qe[0]),{value:rt}=Y;return e.vertical?{[rt]:`${Ke}%`,height:`${Je-Ke}%`}:{[rt]:`${Ke}%`,width:`${Je-Ke}%`}}),ne=computed(()=>{const qe=[],{marks:Ke}=e;if(Ke){const Je=E.value.slice();Je.sort((kt,mt)=>kt-mt);const{value:rt}=Y,{value:ht}=M,{range:vt}=e,Ct=ht?()=>!1:kt=>vt?kt>=Je[0]&&kt<=Je[Je.length-1]:kt<=Je[0];for(const kt of Object.keys(Ke)){const mt=Number(kt);qe.push({active:Ct(mt),key:mt,label:Ke[kt],style:{[rt]:`${re(mt)}%`}})}}return qe});function ve(qe,Ke){const Je=re(qe),{value:rt}=Y;return{[rt]:`${Je}%`,zIndex:Ke===N.value?1:0}}function J(qe){return e.showTooltip||O.value===qe||N.value===qe&&F.value}function fe(qe){return F.value?!(N.value===qe&&I.value===qe):!0}function Z(qe){var Ke;~qe&&(N.value=qe,(Ke=w.get(qe))===null||Ke===void 0||Ke.focus())}function j(){v.forEach((qe,Ke)=>{J(Ke)&&qe.syncPosition()})}function X(qe){const{"onUpdate:value":Ke,onUpdateValue:Je}=e,{nTriggerFormInput:rt,nTriggerFormChange:ht}=f;Je&&call(Je,qe),Ke&&call(Ke,qe),k.value=qe,rt(),ht()}function H(qe){const{range:Ke}=e;if(Ke){if(Array.isArray(qe)){const{value:Je}=E;qe.join()!==Je.join()&&X(qe)}}else Array.isArray(qe)||E.value[0]!==qe&&X(qe)}function U(qe,Ke){if(e.range){const Je=E.value.slice();Je.splice(Ke,1,qe),H(Je)}else H(qe)}function te(qe,Ke,Je){const rt=Je!==void 0;Je||(Je=qe-Ke>0?1:-1);const ht=D.value||[],{step:vt}=e;if(vt==="mark"){const mt=we(qe,ht.concat(Ke),rt?Je:void 0);return mt?mt.value:Ke}if(vt<=0)return Ke;const{value:Ct}=x;let kt;if(rt){const mt=Number((Ke/vt).toFixed(Ct)),Vt=Math.floor(mt),bt=mt>Vt?Vt:Vt-1,ot=mt<Vt?Vt:Vt+1;kt=we(Ke,[Number((bt*vt).toFixed(Ct)),Number((ot*vt).toFixed(Ct)),...ht],Je)}else{const mt=be(qe);kt=we(qe,[...ht,mt])}return kt?Q(kt.value):Ke}function Q(qe){return Math.min(e.max,Math.max(e.min,qe))}function re(qe){const{max:Ke,min:Je}=e;return(qe-Je)/(Ke-Je)*100}function Pe(qe){const{max:Ke,min:Je}=e;return Je+(Ke-Je)*qe}function be(qe){const{step:Ke,min:Je}=e;if(Number(Ke)<=0||Ke==="mark")return qe;const rt=Math.round((qe-Je)/Ke)*Ke+Je;return Number(rt.toFixed(x.value))}function we(qe,Ke=D.value,Je){if(!(Ke!=null&&Ke.length))return null;let rt=null,ht=-1;for(;++ht<Ke.length;){const vt=Ke[ht]-qe,Ct=Math.abs(vt);(Je===void 0||vt*Je>0)&&(rt===null||Ct<rt.distance)&&(rt={index:ht,distance:Ct,value:Ke[ht]})}return rt}function Ae(qe){const Ke=s.value;if(!Ke)return;const Je=isTouchEvent(qe)?qe.touches[0]:qe,rt=Ke.getBoundingClientRect();let ht;return e.vertical?ht=(rt.bottom-Je.clientY)/rt.height:ht=(Je.clientX-rt.left)/rt.width,e.reverse&&(ht=1-ht),Pe(ht)}function $e(qe){if(y.value||!e.keyboard)return;const{vertical:Ke,reverse:Je}=e;switch(qe.key){case"ArrowUp":qe.preventDefault(),Me(Ke&&Je?-1:1);break;case"ArrowRight":qe.preventDefault(),Me(!Ke&&Je?-1:1);break;case"ArrowDown":qe.preventDefault(),Me(Ke&&Je?1:-1);break;case"ArrowLeft":qe.preventDefault(),Me(!Ke&&Je?1:-1);break}}function Me(qe){const Ke=N.value;if(Ke===-1)return;const{step:Je}=e,rt=E.value[Ke],ht=Number(Je)<=0||Je==="mark"?rt:rt+Je*qe;U(te(ht,rt,qe>0?1:-1),Ke)}function Ie(qe){var Ke,Je;if(y.value||!isTouchEvent(qe)&&qe.button!==eventButtonLeft)return;const rt=Ae(qe);if(rt===void 0)return;const ht=E.value.slice(),vt=e.range?(Je=(Ke=we(rt,ht))===null||Ke===void 0?void 0:Ke.index)!==null&&Je!==void 0?Je:-1:0;vt!==-1&&(qe.preventDefault(),Z(vt),Le(),U(te(rt,E.value[vt]),vt))}function Le(){F.value||(F.value=!0,e.onDragstart&&call(e.onDragstart),on$1("touchend",document,ke),on$1("mouseup",document,ke),on$1("touchmove",document,oe),on$1("mousemove",document,oe))}function le(){F.value&&(F.value=!1,e.onDragend&&call(e.onDragend),off$1("touchend",document,ke),off$1("mouseup",document,ke),off$1("touchmove",document,oe),off$1("mousemove",document,oe))}function oe(qe){const{value:Ke}=N;if(!F.value||Ke===-1){le();return}const Je=Ae(qe);Je!==void 0&&U(te(Je,E.value[Ke]),Ke)}function ke(){le()}function Ce(qe){N.value=qe,y.value||(O.value=qe)}function Ee(qe){N.value===qe&&(N.value=-1,le()),O.value===qe&&(O.value=-1)}function Be(qe){O.value=qe}function Ve(qe){O.value===qe&&(O.value=-1)}watch(N,(qe,Ke)=>void nextTick(()=>I.value=Ke)),watch(S,()=>{if(e.marks){if(q.value)return;q.value=!0,nextTick(()=>{q.value=!1})}nextTick(j)}),onBeforeUnmount(()=>{le()});const Oe=computed(()=>{const{self:{markFontSize:qe,railColor:Ke,railColorHover:Je,fillColor:rt,fillColorHover:ht,handleColor:vt,opacityDisabled:Ct,dotColor:kt,dotColorModal:mt,handleBoxShadow:Vt,handleBoxShadowHover:bt,handleBoxShadowActive:ot,handleBoxShadowFocus:gt,dotBorder:tt,dotBoxShadow:ut,railHeight:Re,railWidthVertical:Te,handleSize:He,dotHeight:Fe,dotWidth:ze,dotBorderRadius:We,fontSize:Ue,dotBorderActive:et,dotColorPopover:it},common:{cubicBezierEaseInOut:nt}}=u.value;return{"--n-bezier":nt,"--n-dot-border":tt,"--n-dot-border-active":et,"--n-dot-border-radius":We,"--n-dot-box-shadow":ut,"--n-dot-color":kt,"--n-dot-color-modal":mt,"--n-dot-color-popover":it,"--n-dot-height":Fe,"--n-dot-width":ze,"--n-fill-color":rt,"--n-fill-color-hover":ht,"--n-font-size":Ue,"--n-handle-box-shadow":Vt,"--n-handle-box-shadow-active":ot,"--n-handle-box-shadow-focus":gt,"--n-handle-box-shadow-hover":bt,"--n-handle-color":vt,"--n-handle-size":He,"--n-opacity-disabled":Ct,"--n-rail-color":Ke,"--n-rail-color-hover":Je,"--n-rail-height":Re,"--n-rail-width-vertical":Te,"--n-mark-font-size":qe}}),je=r?useThemeClass("slider",void 0,Oe,e):void 0,Ge=computed(()=>{const{self:{fontSize:qe,indicatorColor:Ke,indicatorBoxShadow:Je,indicatorTextColor:rt,indicatorBorderRadius:ht}}=u.value;return{"--n-font-size":qe,"--n-indicator-border-radius":ht,"--n-indicator-box-shadow":Je,"--n-indicator-color":Ke,"--n-indicator-text-color":rt}}),Xe=r?useThemeClass("slider-indicator",void 0,Ge,e):void 0;return{mergedClsPrefix:n,namespace:o,uncontrolledValue:k,mergedValue:S,mergedDisabled:y,mergedPlacement:T,isMounted:isMounted(),adjustedTo:useAdjustedTo(e),dotTransitionDisabled:q,markInfos:ne,isShowTooltip:J,shouldKeepTooltipTransition:fe,handleRailRef:s,setHandleRefs:m,setFollowerRefs:g,fillStyle:_e,getHandleStyle:ve,activeIndex:N,arrifiedValues:E,followerEnabledIndexSet:d,handleRailMouseDown:Ie,handleHandleFocus:Ce,handleHandleBlur:Ee,handleHandleMouseEnter:Be,handleHandleMouseLeave:Ve,handleRailKeyDown:$e,indicatorCssVars:r?void 0:Ge,indicatorThemeClass:Xe==null?void 0:Xe.themeClass,indicatorOnRender:Xe==null?void 0:Xe.onRender,cssVars:r?void 0:Oe,themeClass:je==null?void 0:je.themeClass,onRender:je==null?void 0:je.onRender}},render(){var e;const{mergedClsPrefix:n,themeClass:o,formatTooltip:r}=this;return(e=this.onRender)===null||e===void 0||e.call(this),h$1("div",{class:[`${n}-slider`,o,{[`${n}-slider--disabled`]:this.mergedDisabled,[`${n}-slider--active`]:this.activeIndex!==-1,[`${n}-slider--with-mark`]:this.marks,[`${n}-slider--vertical`]:this.vertical,[`${n}-slider--reverse`]:this.reverse}],style:this.cssVars,onKeydown:this.handleRailKeyDown,onMousedown:this.handleRailMouseDown,onTouchstart:this.handleRailMouseDown},h$1("div",{class:`${n}-slider-rail`},h$1("div",{class:`${n}-slider-rail__fill`,style:this.fillStyle}),this.marks?h$1("div",{class:[`${n}-slider-dots`,this.dotTransitionDisabled&&`${n}-slider-dots--transition-disabled`]},this.markInfos.map(u=>h$1("div",{key:u.key,class:[`${n}-slider-dot`,{[`${n}-slider-dot--active`]:u.active}],style:u.style}))):null,h$1("div",{ref:"handleRailRef",class:`${n}-slider-handles`},this.arrifiedValues.map((u,s)=>{const w=this.isShowTooltip(s);return h$1(VBinder,null,{default:()=>[h$1(VTarget,null,{default:()=>h$1("div",{ref:this.setHandleRefs(s),class:`${n}-slider-handle-wrapper`,tabindex:this.mergedDisabled?-1:0,role:"slider","aria-valuenow":u,"aria-valuemin":this.min,"aria-valuemax":this.max,"aria-orientation":this.vertical?"vertical":"horizontal","aria-disabled":this.disabled,style:this.getHandleStyle(u,s),onFocus:()=>{this.handleHandleFocus(s)},onBlur:()=>{this.handleHandleBlur(s)},onMouseenter:()=>{this.handleHandleMouseEnter(s)},onMouseleave:()=>{this.handleHandleMouseLeave(s)}},resolveSlot(this.$slots.thumb,()=>[h$1("div",{class:`${n}-slider-handle`})]))}),this.tooltip&&h$1(VFollower,{ref:this.setFollowerRefs(s),show:w,to:this.adjustedTo,enabled:this.showTooltip&&!this.range||this.followerEnabledIndexSet.has(s),teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey,placement:this.mergedPlacement,containerClass:this.namespace},{default:()=>h$1(Transition,{name:"fade-in-scale-up-transition",appear:this.isMounted,css:this.shouldKeepTooltipTransition(s),onEnter:()=>{this.followerEnabledIndexSet.add(s)},onAfterLeave:()=>{this.followerEnabledIndexSet.delete(s)}},{default:()=>{var m;return w?((m=this.indicatorOnRender)===null||m===void 0||m.call(this),h$1("div",{class:[`${n}-slider-handle-indicator`,this.indicatorThemeClass,`${n}-slider-handle-indicator--${this.mergedPlacement}`],style:this.indicatorCssVars},typeof r=="function"?r(u):u)):null}})})]})})),this.marks?h$1("div",{class:`${n}-slider-marks`},this.markInfos.map(u=>h$1("div",{key:u.key,class:`${n}-slider-mark`,style:u.style},typeof u.label=="function"?u.label():u.label))):null))}}),style=cB("switch",`
 height: var(--n-height);
 min-width: var(--n-width);
 vertical-align: middle;
 user-select: none;
 -webkit-user-select: none;
 display: inline-flex;
 outline: none;
 justify-content: center;
 align-items: center;
`,[cE("children-placeholder",`
 height: var(--n-rail-height);
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: none;
 visibility: hidden;
 `),cE("rail-placeholder",`
 display: flex;
 flex-wrap: none;
 `),cE("button-placeholder",`
 width: calc(1.75 * var(--n-rail-height));
 height: var(--n-rail-height);
 `),cB("base-loading",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 font-size: calc(var(--n-button-width) - 4px);
 color: var(--n-loading-color);
 transition: color .3s var(--n-bezier);
 `,[iconSwitchTransition({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),cE("checked, unchecked",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 box-sizing: border-box;
 position: absolute;
 white-space: nowrap;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 line-height: 1;
 `),cE("checked",`
 right: 0;
 padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),cE("unchecked",`
 left: 0;
 justify-content: flex-end;
 padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),c$1("&:focus",[cE("rail",`
 box-shadow: var(--n-box-shadow-focus);
 `)]),cM("round",[cE("rail","border-radius: calc(var(--n-rail-height) / 2);",[cE("button","border-radius: calc(var(--n-button-height) / 2);")])]),cNotM("disabled",[cNotM("icon",[cM("rubber-band",[cM("pressed",[cE("rail",[cE("button","max-width: var(--n-button-width-pressed);")])]),cE("rail",[c$1("&:active",[cE("button","max-width: var(--n-button-width-pressed);")])]),cM("active",[cM("pressed",[cE("rail",[cE("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),cE("rail",[c$1("&:active",[cE("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),cM("active",[cE("rail",[cE("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),cE("rail",`
 overflow: hidden;
 height: var(--n-rail-height);
 min-width: var(--n-rail-width);
 border-radius: var(--n-rail-border-radius);
 cursor: pointer;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[cE("button-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 font-size: calc(var(--n-button-height) - 4px);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 line-height: 1;
 `,[iconSwitchTransition()]),cE("button",`
 align-items: center; 
 top: var(--n-offset);
 left: var(--n-offset);
 height: var(--n-button-height);
 width: var(--n-button-width-pressed);
 max-width: var(--n-button-width);
 border-radius: var(--n-button-border-radius);
 background-color: var(--n-button-color);
 box-shadow: var(--n-button-box-shadow);
 box-sizing: border-box;
 cursor: inherit;
 content: "";
 position: absolute;
 transition:
 background-color .3s var(--n-bezier),
 left .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `)]),cM("active",[cE("rail","background-color: var(--n-rail-color-active);")]),cM("loading",[cE("rail",`
 cursor: wait;
 `)]),cM("disabled",[cE("rail",`
 cursor: not-allowed;
 opacity: .5;
 `)])]),switchProps=Object.assign(Object.assign({},useTheme.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let supportCssMax;const NSwitch=defineComponent({name:"Switch",props:switchProps,slots:Object,setup(e){supportCssMax===void 0&&(typeof CSS<"u"?typeof CSS.supports<"u"?supportCssMax=CSS.supports("width","max(1px)"):supportCssMax=!1:supportCssMax=!0);const{mergedClsPrefixRef:n,inlineThemeDisabled:o}=useConfig(e),r=useTheme("Switch","-switch",style,switchLight$1,e,n),u=useFormItem(e),{mergedSizeRef:s,mergedDisabledRef:w}=u,m=ref(e.defaultValue),v=toRef(e,"value"),g=useMergedState(v,m),d=computed(()=>g.value===e.checkedValue),f=ref(!1),y=ref(!1),x=computed(()=>{const{railStyle:F}=e;if(!!F)return F({focused:y.value,checked:d.value})});function k(F){const{"onUpdate:value":q,onChange:Y,onUpdateValue:_e}=e,{nTriggerFormInput:ne,nTriggerFormChange:ve}=u;q&&call(q,F),_e&&call(_e,F),Y&&call(Y,F),m.value=F,ne(),ve()}function P(){const{nTriggerFormFocus:F}=u;F()}function S(){const{nTriggerFormBlur:F}=u;F()}function E(){e.loading||w.value||(g.value!==e.checkedValue?k(e.checkedValue):k(e.uncheckedValue))}function M(){y.value=!0,P()}function T(){y.value=!1,S(),f.value=!1}function D(F){e.loading||w.value||F.key===" "&&(g.value!==e.checkedValue?k(e.checkedValue):k(e.uncheckedValue),f.value=!1)}function N(F){e.loading||w.value||F.key===" "&&(F.preventDefault(),f.value=!0)}const I=computed(()=>{const{value:F}=s,{self:{opacityDisabled:q,railColor:Y,railColorActive:_e,buttonBoxShadow:ne,buttonColor:ve,boxShadowFocus:J,loadingColor:fe,textColor:Z,iconColor:j,[createKey("buttonHeight",F)]:X,[createKey("buttonWidth",F)]:H,[createKey("buttonWidthPressed",F)]:U,[createKey("railHeight",F)]:te,[createKey("railWidth",F)]:Q,[createKey("railBorderRadius",F)]:re,[createKey("buttonBorderRadius",F)]:Pe},common:{cubicBezierEaseInOut:be}}=r.value;let we,Ae,$e;return supportCssMax?(we=`calc((${te} - ${X}) / 2)`,Ae=`max(${te}, ${X})`,$e=`max(${Q}, calc(${Q} + ${X} - ${te}))`):(we=pxfy((depx(te)-depx(X))/2),Ae=pxfy(Math.max(depx(te),depx(X))),$e=depx(te)>depx(X)?Q:pxfy(depx(Q)+depx(X)-depx(te))),{"--n-bezier":be,"--n-button-border-radius":Pe,"--n-button-box-shadow":ne,"--n-button-color":ve,"--n-button-width":H,"--n-button-width-pressed":U,"--n-button-height":X,"--n-height":Ae,"--n-offset":we,"--n-opacity-disabled":q,"--n-rail-border-radius":re,"--n-rail-color":Y,"--n-rail-color-active":_e,"--n-rail-height":te,"--n-rail-width":Q,"--n-width":$e,"--n-box-shadow-focus":J,"--n-loading-color":fe,"--n-text-color":Z,"--n-icon-color":j}}),O=o?useThemeClass("switch",computed(()=>s.value[0]),I,e):void 0;return{handleClick:E,handleBlur:T,handleFocus:M,handleKeyup:D,handleKeydown:N,mergedRailStyle:x,pressed:f,mergedClsPrefix:n,mergedValue:g,checked:d,mergedDisabled:w,cssVars:o?void 0:I,themeClass:O==null?void 0:O.themeClass,onRender:O==null?void 0:O.onRender}},render(){const{mergedClsPrefix:e,mergedDisabled:n,checked:o,mergedRailStyle:r,onRender:u,$slots:s}=this;u==null||u();const{checked:w,unchecked:m,icon:v,"checked-icon":g,"unchecked-icon":d}=s,f=!(isSlotEmpty(v)&&isSlotEmpty(g)&&isSlotEmpty(d));return h$1("div",{role:"switch","aria-checked":o,class:[`${e}-switch`,this.themeClass,f&&`${e}-switch--icon`,o&&`${e}-switch--active`,n&&`${e}-switch--disabled`,this.round&&`${e}-switch--round`,this.loading&&`${e}-switch--loading`,this.pressed&&`${e}-switch--pressed`,this.rubberBand&&`${e}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},h$1("div",{class:`${e}-switch__rail`,"aria-hidden":"true",style:r},resolveWrappedSlot(w,y=>resolveWrappedSlot(m,x=>y||x?h$1("div",{"aria-hidden":!0,class:`${e}-switch__children-placeholder`},h$1("div",{class:`${e}-switch__rail-placeholder`},h$1("div",{class:`${e}-switch__button-placeholder`}),y),h$1("div",{class:`${e}-switch__rail-placeholder`},h$1("div",{class:`${e}-switch__button-placeholder`}),x)):null)),h$1("div",{class:`${e}-switch__button`},resolveWrappedSlot(v,y=>resolveWrappedSlot(g,x=>resolveWrappedSlot(d,k=>h$1(NIconSwitchTransition,null,{default:()=>this.loading?h$1(NBaseLoading,{key:"loading",clsPrefix:e,strokeWidth:20}):this.checked&&(x||y)?h$1("div",{class:`${e}-switch__button-icon`,key:x?"checked-icon":"icon"},x||y):!this.checked&&(k||y)?h$1("div",{class:`${e}-switch__button-icon`,key:k?"unchecked-icon":"icon"},k||y):null})))),resolveWrappedSlot(w,y=>y&&h$1("div",{key:"checked",class:`${e}-switch__checked`},y)),resolveWrappedSlot(m,y=>y&&h$1("div",{key:"unchecked",class:`${e}-switch__unchecked`},y)))))}}),_export_sfc=(e,n)=>{const o=e.__vccOpts||e;for(const[r,u]of n)o[r]=u;return o},{message}=createDiscreteApi(["message"]);window.$message=message;const _sfc_main$4L=defineComponent({});function _sfc_render$32(e,n,o,r,u,s){return openBlock(),createElementBlock("div")}const __unplugin_components_19$1=_export_sfc(_sfc_main$4L,[["render",_sfc_render$32]]),_sfc_main$4K={},_hoisted_1$4l={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$46=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.4697 3.46967L17.5304 4.53033L3.53039 18.5303L2.46973 17.4697L16.4697 3.46967Z",fill:"currentColor"},null,-1),_hoisted_3$3I=[_hoisted_2$46];function _sfc_render$31(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4l,_hoisted_3$3I)}const __unplugin_components_14$3=_export_sfc(_sfc_main$4K,[["render",_sfc_render$31]]),_sfc_main$4J={},_hoisted_1$4k={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$45=createBaseVNode("rect",{x:"2",y:"4",width:"16",height:"12",rx:"1",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$3H=[_hoisted_2$45];function _sfc_render$30(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4k,_hoisted_3$3H)}const __unplugin_components_9$5=_export_sfc(_sfc_main$4J,[["render",_sfc_render$30]]),_sfc_main$4I={},_hoisted_1$4j={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$44=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 4V3H3.00079V4H16ZM16 8V7H0.000976562V8H16ZM16 11V12H6.00061V11H16Z",fill:"currentColor"},null,-1),_hoisted_3$3G=[_hoisted_2$44];function _sfc_render$2$(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4j,_hoisted_3$3G)}const __unplugin_components_7$8=_export_sfc(_sfc_main$4I,[["render",_sfc_render$2$]]),_sfc_main$4H={},_hoisted_1$4i={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$43=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 4V3H0V4H16ZM16 12V11H0V12H16ZM13 7V8H3V7H13Z",fill:"currentColor"},null,-1),_hoisted_3$3F=[_hoisted_2$43];function _sfc_render$2_(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4i,_hoisted_3$3F)}const __unplugin_components_4$f=_export_sfc(_sfc_main$4H,[["render",_sfc_render$2_]]),_sfc_main$4G={},_hoisted_1$4h={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$42=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13 4V3H0V4H13ZM16 8V7H0V8H16ZM10 11V12H0V11H10Z",fill:"currentColor"},null,-1),_hoisted_3$3E=[_hoisted_2$42];function _sfc_render$2Z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4h,_hoisted_3$3E)}const __unplugin_components_6$a=_export_sfc(_sfc_main$4G,[["render",_sfc_render$2Z]]),_sfc_main$4F={},_hoisted_1$4g={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$41=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.0596 5.90881L11.9398 6.72441L8.24969 10.707L4.55957 6.72441L5.4398 5.90881L8.24969 8.94096L11.0596 5.90881Z",fill:"currentColor"},null,-1),_hoisted_3$3D=[_hoisted_2$41];function _sfc_render$2Y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4g,_hoisted_3$3D)}const __unplugin_components_0$B=_export_sfc(_sfc_main$4F,[["render",_sfc_render$2Y]]),_sfc_main$4E={},_hoisted_1$4f={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$40=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.62085 9.99988C2.62085 5.92455 5.92455 2.62085 9.99988 2.62085C14.0752 2.62085 17.3789 5.92455 17.3789 9.99988C17.3789 14.0752 14.0752 17.3789 9.99988 17.3789C5.92455 17.3789 2.62085 14.0752 2.62085 9.99988ZM9.99988 1.12085C5.09613 1.12085 1.12085 5.09613 1.12085 9.99988C1.12085 14.9036 5.09613 18.8789 9.99988 18.8789C14.9036 18.8789 18.8789 14.9036 18.8789 9.99988C18.8789 5.09613 14.9036 1.12085 9.99988 1.12085ZM10.4652 4.81199V10.1907L12.8542 12.5798L11.7936 13.6404L8.96514 10.812L8.96519 10.8119V4.81199H10.4652Z",fill:"currentColor"},null,-1),_hoisted_3$3C=[_hoisted_2$40];function _sfc_render$2X(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4f,_hoisted_3$3C)}const __unplugin_components_3$g=_export_sfc(_sfc_main$4E,[["render",_sfc_render$2X]]),_sfc_main$4D={},_hoisted_1$4e={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3$=createBaseVNode("rect",{x:"2.75",y:"2.75",width:"11.5",height:"11.5",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$3B=createBaseVNode("path",{d:"M19.25 12.5C19.25 15.6756 16.6756 18.25 13.5 18.25C10.3244 18.25 7.75 15.6756 7.75 12.5C7.75 9.32436 10.3244 6.75 13.5 6.75C16.6756 6.75 19.25 9.32436 19.25 12.5Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$1o=[_hoisted_2$3$,_hoisted_3$3B];function _sfc_render$2W(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4e,_hoisted_4$1o)}const __unplugin_components_2$g=_export_sfc(_sfc_main$4D,[["render",_sfc_render$2W]]),Button_vue_vue_type_style_index_0_lang="",_hoisted_1$4d=["disabled","title"],_sfc_main$4C={__name:"Button",props:{title:String,isActive:Boolean,disabled:Boolean||void 0,className:String,mediaQueryClassName:String,img:String,onClick:Function},setup(e){const n=u=>{u==null||u.stopPropagation(),u==null||u.preventDefault()},{img:o}=e,r=o==null?void 0:o.trim().startsWith("data:");return o&&!r&&(!o.includes(".")||o.startsWith("<svg")),(u,s)=>(openBlock(),createElementBlock("button",{class:normalizeClass(["button",{active:e.isActive,disabled:e.disabled,[e.mediaQueryClassName]:e.mediaQueryClassName,[e.className]:e.className}]),onClick:s[0]||(s[0]=w=>e.disabled||!e.onClick?n():e.onClick(w)),onDblclick:s[1]||(s[1]=w=>e.disabled?n:u.onDoubleClick),onMouseup:s[2]||(s[2]=w=>e.disabled?n:u.onDoubleClick),disabled:e.disabled,title:e.title},[renderSlot(u.$slots,"default")],42,_hoisted_1$4d))}},_sfc_main$4B={},_hoisted_1$4c={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3_=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.75 2.75V6H15.25V4.25H10.75V16.25H12.3337V17.75H7.66699V16.25H9.25V4.25H4.75V6H3.25V2.75H16.75Z",fill:"currentColor"},null,-1),_hoisted_3$3A=[_hoisted_2$3_];function _sfc_render$2V(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4c,_hoisted_3$3A)}const __unplugin_components_0$A=_export_sfc(_sfc_main$4B,[["render",_sfc_render$2V]]),_imports_0$2=""+new URL("colorful.c840ddf1.svg",import.meta.url).href;var isVue2=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let activePinia;const setActivePinia=e=>activePinia=e,piniaSymbol=Symbol();function isPlainObject$1(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var MutationType;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const e=effectScope(!0),n=e.run(()=>ref({}));let o=[],r=[];const u=markRaw({install(s){setActivePinia(u),u._a=s,s.provide(piniaSymbol,u),s.config.globalProperties.$pinia=u,r.forEach(w=>o.push(w)),r=[]},use(s){return!this._a&&!isVue2?r.push(s):o.push(s),this},_p:o,_a:null,_e:e,_s:new Map,state:n});return u}const noop$1=()=>{};function addSubscription(e,n,o,r=noop$1){e.push(n);const u=()=>{const s=e.indexOf(n);s>-1&&(e.splice(s,1),r())};return!o&&getCurrentScope()&&onScopeDispose(u),u}function triggerSubscriptions(e,...n){e.slice().forEach(o=>{o(...n)})}const fallbackRunWithContext=e=>e();function mergeReactiveObjects(e,n){e instanceof Map&&n instanceof Map&&n.forEach((o,r)=>e.set(r,o)),e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const o in n){if(!n.hasOwnProperty(o))continue;const r=n[o],u=e[o];isPlainObject$1(u)&&isPlainObject$1(r)&&e.hasOwnProperty(o)&&!isRef(r)&&!isReactive(r)?e[o]=mergeReactiveObjects(u,r):e[o]=r}return e}const skipHydrateSymbol=Symbol();function shouldHydrate(e){return!isPlainObject$1(e)||!e.hasOwnProperty(skipHydrateSymbol)}const{assign}=Object;function isComputed(e){return!!(isRef(e)&&e.effect)}function createOptionsStore(e,n,o,r){const{state:u,actions:s,getters:w}=n,m=o.state.value[e];let v;function g(){m||(o.state.value[e]=u?u():{});const d=toRefs(o.state.value[e]);return assign(d,s,Object.keys(w||{}).reduce((f,y)=>(f[y]=markRaw(computed(()=>{setActivePinia(o);const x=o._s.get(e);return w[y].call(x,x)})),f),{}))}return v=createSetupStore(e,g,n,o,r,!0),v}function createSetupStore(e,n,o={},r,u,s){let w;const m=assign({actions:{}},o),v={deep:!0};let g,d,f=[],y=[],x;const k=r.state.value[e];!s&&!k&&(r.state.value[e]={}),ref({});let P;function S(F){let q;g=d=!1,typeof F=="function"?(F(r.state.value[e]),q={type:MutationType.patchFunction,storeId:e,events:x}):(mergeReactiveObjects(r.state.value[e],F),q={type:MutationType.patchObject,payload:F,storeId:e,events:x});const Y=P=Symbol();nextTick().then(()=>{P===Y&&(g=!0)}),d=!0,triggerSubscriptions(f,q,r.state.value[e])}const E=s?function(){const{state:q}=o,Y=q?q():{};this.$patch(_e=>{assign(_e,Y)})}:noop$1;function M(){w.stop(),f=[],y=[],r._s.delete(e)}function T(F,q){return function(){setActivePinia(r);const Y=Array.from(arguments),_e=[],ne=[];function ve(Z){_e.push(Z)}function J(Z){ne.push(Z)}triggerSubscriptions(y,{args:Y,name:F,store:N,after:ve,onError:J});let fe;try{fe=q.apply(this&&this.$id===e?this:N,Y)}catch(Z){throw triggerSubscriptions(ne,Z),Z}return fe instanceof Promise?fe.then(Z=>(triggerSubscriptions(_e,Z),Z)).catch(Z=>(triggerSubscriptions(ne,Z),Promise.reject(Z))):(triggerSubscriptions(_e,fe),fe)}}const D={_p:r,$id:e,$onAction:addSubscription.bind(null,y),$patch:S,$reset:E,$subscribe(F,q={}){const Y=addSubscription(f,F,q.detached,()=>_e()),_e=w.run(()=>watch(()=>r.state.value[e],ne=>{(q.flush==="sync"?d:g)&&F({storeId:e,type:MutationType.direct,events:x},ne)},assign({},v,q)));return Y},$dispose:M},N=reactive(D);r._s.set(e,N);const O=(r._a&&r._a.runWithContext||fallbackRunWithContext)(()=>r._e.run(()=>(w=effectScope()).run(n)));for(const F in O){const q=O[F];if(isRef(q)&&!isComputed(q)||isReactive(q))s||(k&&shouldHydrate(q)&&(isRef(q)?q.value=k[F]:mergeReactiveObjects(q,k[F])),r.state.value[e][F]=q);else if(typeof q=="function"){const Y=T(F,q);O[F]=Y,m.actions[F]=q}}return assign(N,O),assign(toRaw(N),O),Object.defineProperty(N,"$state",{get:()=>r.state.value[e],set:F=>{S(q=>{assign(q,F)})}}),r._p.forEach(F=>{assign(N,w.run(()=>F({store:N,app:r._a,pinia:r,options:m})))}),k&&s&&o.hydrate&&o.hydrate(N.$state,k),g=!0,d=!0,N}function defineStore(e,n,o){let r,u;const s=typeof n=="function";typeof e=="string"?(r=e,u=s?o:n):(u=e,r=e.id);function w(m,v){const g=hasInjectionContext();return m=m||(g?inject(piniaSymbol,null):null),m&&setActivePinia(m),m=activePinia,m._s.has(r)||(s?createSetupStore(r,n,u,m):createOptionsStore(r,u,m)),m._s.get(r)}return w.$id=r,w}function _assertClassBrand(e,n,o){if(typeof e=="function"?e===n:e.has(n))return arguments.length<3?n:o;throw new TypeError("Private element is not present on this object")}function _callSuper(e,n,o){return n=_getPrototypeOf(n),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(n,o||[],_getPrototypeOf(e).constructor):n.apply(e,o))}function _classPrivateFieldGet2(e,n){return e.get(_assertClassBrand(e,n))}function _classPrivateFieldSet2(e,n,o){return e.set(_assertClassBrand(e,n),o),o}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!e})()}function _iterableToArrayLimit(e,n){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var r,u,s,w,m=[],v=!0,g=!1;try{if(s=(o=o.call(e)).next,n===0){if(Object(o)!==o)return;v=!1}else for(;!(v=(r=s.call(o)).done)&&(m.push(r.value),m.length!==n);v=!0);}catch(d){g=!0,u=d}finally{try{if(!v&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(g)throw u}}return m}}function ownKeys$1(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),o.push.apply(o,r)}return o}function _objectSpread2$1(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$1(Object(o),!0).forEach(function(r){_defineProperty$1(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys$1(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return n};var e,n={},o=Object.prototype,r=o.hasOwnProperty,u=Object.defineProperty||function(Z,j,X){Z[j]=X.value},s=typeof Symbol=="function"?Symbol:{},w=s.iterator||"@@iterator",m=s.asyncIterator||"@@asyncIterator",v=s.toStringTag||"@@toStringTag";function g(Z,j,X){return Object.defineProperty(Z,j,{value:X,enumerable:!0,configurable:!0,writable:!0}),Z[j]}try{g({},"")}catch{g=function(j,X,H){return j[X]=H}}function d(Z,j,X,H){var U=j&&j.prototype instanceof E?j:E,te=Object.create(U.prototype),Q=new J(H||[]);return u(te,"_invoke",{value:Y(Z,X,Q)}),te}function f(Z,j,X){try{return{type:"normal",arg:Z.call(j,X)}}catch(H){return{type:"throw",arg:H}}}n.wrap=d;var y="suspendedStart",x="suspendedYield",k="executing",P="completed",S={};function E(){}function M(){}function T(){}var D={};g(D,w,function(){return this});var N=Object.getPrototypeOf,I=N&&N(N(fe([])));I&&I!==o&&r.call(I,w)&&(D=I);var O=T.prototype=E.prototype=Object.create(D);function F(Z){["next","throw","return"].forEach(function(j){g(Z,j,function(X){return this._invoke(j,X)})})}function q(Z,j){function X(U,te,Q,re){var Pe=f(Z[U],Z,te);if(Pe.type!=="throw"){var be=Pe.arg,we=be.value;return we&&typeof we=="object"&&r.call(we,"__await")?j.resolve(we.__await).then(function(Ae){X("next",Ae,Q,re)},function(Ae){X("throw",Ae,Q,re)}):j.resolve(we).then(function(Ae){be.value=Ae,Q(be)},function(Ae){return X("throw",Ae,Q,re)})}re(Pe.arg)}var H;u(this,"_invoke",{value:function(U,te){function Q(){return new j(function(re,Pe){X(U,te,re,Pe)})}return H=H?H.then(Q,Q):Q()}})}function Y(Z,j,X){var H=y;return function(U,te){if(H===k)throw Error("Generator is already running");if(H===P){if(U==="throw")throw te;return{value:e,done:!0}}for(X.method=U,X.arg=te;;){var Q=X.delegate;if(Q){var re=_e(Q,X);if(re){if(re===S)continue;return re}}if(X.method==="next")X.sent=X._sent=X.arg;else if(X.method==="throw"){if(H===y)throw H=P,X.arg;X.dispatchException(X.arg)}else X.method==="return"&&X.abrupt("return",X.arg);H=k;var Pe=f(Z,j,X);if(Pe.type==="normal"){if(H=X.done?P:x,Pe.arg===S)continue;return{value:Pe.arg,done:X.done}}Pe.type==="throw"&&(H=P,X.method="throw",X.arg=Pe.arg)}}}function _e(Z,j){var X=j.method,H=Z.iterator[X];if(H===e)return j.delegate=null,X==="throw"&&Z.iterator.return&&(j.method="return",j.arg=e,_e(Z,j),j.method==="throw")||X!=="return"&&(j.method="throw",j.arg=new TypeError("The iterator does not provide a '"+X+"' method")),S;var U=f(H,Z.iterator,j.arg);if(U.type==="throw")return j.method="throw",j.arg=U.arg,j.delegate=null,S;var te=U.arg;return te?te.done?(j[Z.resultName]=te.value,j.next=Z.nextLoc,j.method!=="return"&&(j.method="next",j.arg=e),j.delegate=null,S):te:(j.method="throw",j.arg=new TypeError("iterator result is not an object"),j.delegate=null,S)}function ne(Z){var j={tryLoc:Z[0]};1 in Z&&(j.catchLoc=Z[1]),2 in Z&&(j.finallyLoc=Z[2],j.afterLoc=Z[3]),this.tryEntries.push(j)}function ve(Z){var j=Z.completion||{};j.type="normal",delete j.arg,Z.completion=j}function J(Z){this.tryEntries=[{tryLoc:"root"}],Z.forEach(ne,this),this.reset(!0)}function fe(Z){if(Z||Z===""){var j=Z[w];if(j)return j.call(Z);if(typeof Z.next=="function")return Z;if(!isNaN(Z.length)){var X=-1,H=function U(){for(;++X<Z.length;)if(r.call(Z,X))return U.value=Z[X],U.done=!1,U;return U.value=e,U.done=!0,U};return H.next=H}}throw new TypeError(typeof Z+" is not iterable")}return M.prototype=T,u(O,"constructor",{value:T,configurable:!0}),u(T,"constructor",{value:M,configurable:!0}),M.displayName=g(T,v,"GeneratorFunction"),n.isGeneratorFunction=function(Z){var j=typeof Z=="function"&&Z.constructor;return!!j&&(j===M||(j.displayName||j.name)==="GeneratorFunction")},n.mark=function(Z){return Object.setPrototypeOf?Object.setPrototypeOf(Z,T):(Z.__proto__=T,g(Z,v,"GeneratorFunction")),Z.prototype=Object.create(O),Z},n.awrap=function(Z){return{__await:Z}},F(q.prototype),g(q.prototype,m,function(){return this}),n.AsyncIterator=q,n.async=function(Z,j,X,H,U){U===void 0&&(U=Promise);var te=new q(d(Z,j,X,H),U);return n.isGeneratorFunction(j)?te:te.next().then(function(Q){return Q.done?Q.value:te.next()})},F(O),g(O,v,"Generator"),g(O,w,function(){return this}),g(O,"toString",function(){return"[object Generator]"}),n.keys=function(Z){var j=Object(Z),X=[];for(var H in j)X.push(H);return X.reverse(),function U(){for(;X.length;){var te=X.pop();if(te in j)return U.value=te,U.done=!1,U}return U.done=!0,U}},n.values=fe,J.prototype={constructor:J,reset:function(Z){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(ve),!Z)for(var j in this)j.charAt(0)==="t"&&r.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=e)},stop:function(){this.done=!0;var Z=this.tryEntries[0].completion;if(Z.type==="throw")throw Z.arg;return this.rval},dispatchException:function(Z){if(this.done)throw Z;var j=this;function X(Pe,be){return te.type="throw",te.arg=Z,j.next=Pe,be&&(j.method="next",j.arg=e),!!be}for(var H=this.tryEntries.length-1;H>=0;--H){var U=this.tryEntries[H],te=U.completion;if(U.tryLoc==="root")return X("end");if(U.tryLoc<=this.prev){var Q=r.call(U,"catchLoc"),re=r.call(U,"finallyLoc");if(Q&&re){if(this.prev<U.catchLoc)return X(U.catchLoc,!0);if(this.prev<U.finallyLoc)return X(U.finallyLoc)}else if(Q){if(this.prev<U.catchLoc)return X(U.catchLoc,!0)}else{if(!re)throw Error("try statement without catch or finally");if(this.prev<U.finallyLoc)return X(U.finallyLoc)}}}},abrupt:function(Z,j){for(var X=this.tryEntries.length-1;X>=0;--X){var H=this.tryEntries[X];if(H.tryLoc<=this.prev&&r.call(H,"finallyLoc")&&this.prev<H.finallyLoc){var U=H;break}}U&&(Z==="break"||Z==="continue")&&U.tryLoc<=j&&j<=U.finallyLoc&&(U=null);var te=U?U.completion:{};return te.type=Z,te.arg=j,U?(this.method="next",this.next=U.finallyLoc,S):this.complete(te)},complete:function(Z,j){if(Z.type==="throw")throw Z.arg;return Z.type==="break"||Z.type==="continue"?this.next=Z.arg:Z.type==="return"?(this.rval=this.arg=Z.arg,this.method="return",this.next="end"):Z.type==="normal"&&j&&(this.next=j),S},finish:function(Z){for(var j=this.tryEntries.length-1;j>=0;--j){var X=this.tryEntries[j];if(X.finallyLoc===Z)return this.complete(X.completion,X.afterLoc),ve(X),S}},catch:function(Z){for(var j=this.tryEntries.length-1;j>=0;--j){var X=this.tryEntries[j];if(X.tryLoc===Z){var H=X.completion;if(H.type==="throw"){var U=H.arg;ve(X)}return U}}throw Error("illegal catch attempt")},delegateYield:function(Z,j,X){return this.delegate={iterator:fe(Z),resultName:j,nextLoc:X},this.method==="next"&&(this.arg=e),S}},n}function _toPrimitive(e,n){if(typeof e!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var r=o.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function _toPropertyKey(e){var n=_toPrimitive(e,"string");return typeof n=="symbol"?n:n+""}function _typeof$1(e){return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof$1(e)}function asyncGeneratorStep(e,n,o,r,u,s,w){try{var m=e[s](w),v=m.value}catch(g){return void o(g)}m.done?n(v):Promise.resolve(v).then(r,u)}function _asyncToGenerator(e){return function(){var n=this,o=arguments;return new Promise(function(r,u){var s=e.apply(n,o);function w(v){asyncGeneratorStep(s,r,u,w,m,"next",v)}function m(v){asyncGeneratorStep(s,r,u,w,m,"throw",v)}w(void 0)})}}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,n,o){return n&&_defineProperties(e.prototype,n),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$1(e,n,o){return(n=_toPropertyKey(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function _inherits(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&_setPrototypeOf(e,n)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},_getPrototypeOf(e)}function _setPrototypeOf(e,n){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,r){return o.__proto__=r,o},_setPrototypeOf(e,n)}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _superPropBase(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=_getPrototypeOf(e))!==null;);return e}function _get(){return _get=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(e,n,o){var r=_superPropBase(e,n);if(r){var u=Object.getOwnPropertyDescriptor(r,n);return u.get?u.get.call(arguments.length<3?e:o):u.value}},_get.apply(this,arguments)}function _readOnlyError(e){throw new TypeError('"'+e+'" is read-only')}function _slicedToArray(e,n){return _arrayWithHoles(e)||_iterableToArrayLimit(e,n)||_unsupportedIterableToArray$1(e,n)||_nonIterableRest()}function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$1(e)||_nonIterableSpread$1()}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$1(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray$1(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _unsupportedIterableToArray$1(e,n){if(e){if(typeof e=="string")return _arrayLikeToArray$1(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$1(e,n):void 0}}function _arrayLikeToArray$1(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=e[o];return r}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _createForOfIteratorHelper(e,n){var o=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=_unsupportedIterableToArray$1(e))||n&&e&&typeof e.length=="number"){o&&(e=o);var r=0,u=function(){};return{s:u,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(v){throw v},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,w=!0,m=!1;return{s:function(){o=o.call(e)},n:function(){var v=o.next();return w=v.done,v},e:function(v){m=!0,s=v},f:function(){try{w||o.return==null||o.return()}finally{if(m)throw s}}}}function _checkPrivateRedeclaration(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldInitSpec(e,n,o){_checkPrivateRedeclaration(e,n),n.set(e,o)}function _classPrivateMethodInitSpec(e,n){_checkPrivateRedeclaration(e,n),n.add(e)}var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace$1(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var o=function r(){if(this instanceof r){var u=[null];return u.push.apply(u,arguments),new(Function.bind.apply(n,u))}return n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var u=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(o,r,u.get?u:{enumerable:!0,get:function(){return e[r]}})}),o}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdfExports={},pdf={get exports(){return pdfExports},set exports(e){pdfExports=e}},_nodeResolve_empty={},_nodeResolve_empty$1=Object.freeze({__proto__:null,default:_nodeResolve_empty}),require$$0=getAugmentedNamespace$1(_nodeResolve_empty$1),path2dPolyfill_esm={},hasRequiredPath2dPolyfill_esm;function requirePath2dPolyfill_esm(){if(hasRequiredPath2dPolyfill_esm)return path2dPolyfill_esm;function e(d,f,y){if(y||arguments.length===2)for(var x,k=0,P=f.length;k<P;k++)!x&&k in f||(x||(x=Array.prototype.slice.call(f,0,k)),x[k]=f[k]);return d.concat(x||Array.prototype.slice.call(f))}hasRequiredPath2dPolyfill_esm=1;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=/([astvzqmhlc])([^astvzqmhlc]*)/gi,r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function u(d){var f=[],y=String(d).trim();return y[0]!=="M"&&y[0]!=="m"||y.replace(o,function(x,k,P){var S=function(T){var D=T.match(r);return D?D.map(Number):[]}(P),E=k.toLowerCase(),M=k;if(E==="m"&&S.length>2&&(f.push(e([M],S.splice(0,2),!0)),E="l",M=M==="m"?"l":"L"),S.length<n[E])return"";for(f.push(e([M],S.splice(0,n[E]),!0));S.length>=n[E]&&S.length&&n[E];)f.push(e([M],S.splice(0,n[E]),!0));return""}),f}function s(d,f){var y=d.x*Math.cos(f)-d.y*Math.sin(f),x=d.y*Math.cos(f)+d.x*Math.sin(f);d.x=y,d.y=x}function w(d,f){d.x*=f,d.y*=f}var m=function(){function d(f){var y;this.commands=[],f&&f instanceof d?(y=this.commands).push.apply(y,f.commands):f&&(this.commands=u(f))}return d.prototype.addPath=function(f){var y;f&&f instanceof d&&(y=this.commands).push.apply(y,f.commands)},d.prototype.moveTo=function(f,y){this.commands.push(["M",f,y])},d.prototype.lineTo=function(f,y){this.commands.push(["L",f,y])},d.prototype.arc=function(f,y,x,k,P,S){this.commands.push(["AC",f,y,x,k,P,!!S])},d.prototype.arcTo=function(f,y,x,k,P){this.commands.push(["AT",f,y,x,k,P])},d.prototype.ellipse=function(f,y,x,k,P,S,E,M){this.commands.push(["E",f,y,x,k,P,S,E,!!M])},d.prototype.closePath=function(){this.commands.push(["Z"])},d.prototype.bezierCurveTo=function(f,y,x,k,P,S){this.commands.push(["C",f,y,x,k,P,S])},d.prototype.quadraticCurveTo=function(f,y,x,k){this.commands.push(["Q",f,y,x,k])},d.prototype.rect=function(f,y,x,k){this.commands.push(["R",f,y,x,k])},d.prototype.roundRect=function(f,y,x,k,P){P===void 0?this.commands.push(["RR",f,y,x,k,0]):this.commands.push(["RR",f,y,x,k,P])},d}();function v(d,f){var y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H,U=0,te=0,Q=null,re=null,Pe=null,be=null,we=null,Ae=null;d.beginPath();for(var $e=0;$e<f.length;++$e){(ve=f[$e][0])!=="S"&&ve!=="s"&&ve!=="C"&&ve!=="c"&&(Q=null,re=null),ve!=="T"&&ve!=="t"&&ve!=="Q"&&ve!=="q"&&(Pe=null,be=null);var Me=void 0;switch(ve){case"m":case"M":Me=f[$e],ve==="m"?(U+=Me[1],te+=Me[2]):(U=Me[1],te=Me[2]),ve!=="M"&&we||(we={x:U,y:te}),d.moveTo(U,te);break;case"l":U+=(Me=f[$e])[1],te+=Me[2],d.lineTo(U,te);break;case"L":U=(Me=f[$e])[1],te=Me[2],d.lineTo(U,te);break;case"H":U=(Me=f[$e])[1],d.lineTo(U,te);break;case"h":U+=(Me=f[$e])[1],d.lineTo(U,te);break;case"V":te=(Me=f[$e])[1],d.lineTo(U,te);break;case"v":te+=(Me=f[$e])[1],d.lineTo(U,te);break;case"a":case"A":if(Me=f[$e],Ae===null)throw new Error("This should never happen");ve==="a"?(U+=Me[6],te+=Me[7]):(U=Me[6],te=Me[7]),q=Me[1],Y=Me[2],M=Me[3]*Math.PI/180,k=!!Me[4],P=!!Me[5],S={x:U,y:te},s(E={x:(Ae.x-S.x)/2,y:(Ae.y-S.y)/2},-M),(T=E.x*E.x/(q*q)+E.y*E.y/(Y*Y))>1&&(q*=T=Math.sqrt(T),Y*=T),D=q*q*Y*Y,N=q*q*E.y*E.y+Y*Y*E.x*E.x,w(J={x:q*E.y/Y,y:-Y*E.x/q},P!==k?Math.sqrt((D-N)/N)||0:-Math.sqrt((D-N)/N)||0),x=Math.atan2((E.y-J.y)/Y,(E.x-J.x)/q),y=Math.atan2(-(E.y+J.y)/Y,-(E.x+J.x)/q),s(J,M),j=J,X=(S.x+Ae.x)/2,H=(S.y+Ae.y)/2,j.x+=X,j.y+=H,d.save(),d.translate(J.x,J.y),d.rotate(M),d.scale(q,Y),d.arc(0,0,1,x,y,!P),d.restore();break;case"C":Q=(Me=f[$e])[3],re=Me[4],U=Me[5],te=Me[6],d.bezierCurveTo(Me[1],Me[2],Q,re,U,te);break;case"c":Me=f[$e],d.bezierCurveTo(Me[1]+U,Me[2]+te,Me[3]+U,Me[4]+te,Me[5]+U,Me[6]+te),Q=Me[3]+U,re=Me[4]+te,U+=Me[5],te+=Me[6];break;case"S":Me=f[$e],Q!==null&&re!==null||(Q=U,re=te),d.bezierCurveTo(2*U-Q,2*te-re,Me[1],Me[2],Me[3],Me[4]),Q=Me[1],re=Me[2],U=Me[3],te=Me[4];break;case"s":Me=f[$e],Q!==null&&re!==null||(Q=U,re=te),d.bezierCurveTo(2*U-Q,2*te-re,Me[1]+U,Me[2]+te,Me[3]+U,Me[4]+te),Q=Me[1]+U,re=Me[2]+te,U+=Me[3],te+=Me[4];break;case"Q":Pe=(Me=f[$e])[1],be=Me[2],U=Me[3],te=Me[4],d.quadraticCurveTo(Pe,be,U,te);break;case"q":Pe=(Me=f[$e])[1]+U,be=Me[2]+te,U+=Me[3],te+=Me[4],d.quadraticCurveTo(Pe,be,U,te);break;case"T":Pe!==null&&be!==null||(Pe=U,be=te),Pe=2*U-Pe,be=2*te-be,U=(Me=f[$e])[1],te=Me[2],d.quadraticCurveTo(Pe,be,U,te);break;case"t":Pe!==null&&be!==null||(Pe=U,be=te),Pe=2*U-Pe,be=2*te-be,U+=(Me=f[$e])[1],te+=Me[2],d.quadraticCurveTo(Pe,be,U,te);break;case"z":case"Z":we&&(U=we.x,te=we.y),we=null,d.closePath();break;case"AC":U=(Me=f[$e])[1],te=Me[2],F=Me[3],x=Me[4],y=Me[5],fe=Me[6],d.arc(U,te,F,x,y,fe);break;case"AT":I=(Me=f[$e])[1],O=Me[2],U=Me[3],te=Me[4],F=Me[5],d.arcTo(I,O,U,te,F);break;case"E":U=(Me=f[$e])[1],te=Me[2],q=Me[3],Y=Me[4],M=Me[5],x=Me[6],y=Me[7],fe=Me[8],d.save(),d.translate(U,te),d.rotate(M),d.scale(q,Y),d.arc(0,0,1,x,y,fe),d.restore();break;case"R":U=(Me=f[$e])[1],te=Me[2],_e=Me[3],ne=Me[4],we={x:U,y:te},d.rect(U,te,_e,ne);break;case"RR":U=(Me=f[$e])[1],te=Me[2],_e=Me[3],ne=Me[4],Z=Me[5],we={x:U,y:te},d.roundRect(U,te,_e,ne,Z)}Ae?(Ae.x=U,Ae.y=te):Ae={x:U,y:te}}}function g(d,f,y,x,k){var P=this;if(k===void 0&&(k=0),typeof k=="number"&&(k=[k]),Array.isArray(k)){if(k.length===0||k.length>4)throw new RangeError("Failed to execute 'roundRect' on '".concat(this.constructor.name,"': ").concat(k.length," radii provided. Between one and four radii are necessary."));if(k.forEach(function(N){if(N<0)throw new RangeError("Failed to execute 'roundRect' on '".concat(P.constructor.name,"': Radius value ").concat(N," is negative."))}),k.length===1&&k[0]===0)return this.rect(d,f,y,x);var S,E,M,T=Math.min(y,x)/2,D=S=E=M=Math.min(T,k[0]);k.length===2&&(S=M=Math.min(T,k[1])),k.length===3&&(S=M=Math.min(T,k[1]),E=Math.min(T,k[2])),k.length===4&&(S=Math.min(T,k[1]),E=Math.min(T,k[2]),M=Math.min(T,k[3])),this.moveTo(d,f+x-M),this.arcTo(d,f,d+D,f,D),this.arcTo(d+y,f,d+y,f+S,S),this.arcTo(d+y,f+x,d+y-E,f+x,E),this.arcTo(d,f+x,d,f+x-M,M),this.moveTo(d,f)}}return function(d){if(d&&d.CanvasRenderingContext2D&&!d.Path2D){var f=d.CanvasRenderingContext2D,y=f.prototype.fill,x=f.prototype.stroke,k=f.prototype.isPointInPath;f.prototype.fill=function(){for(var P=[],S=0;S<arguments.length;S++)P[S]=arguments[S];if(!(P[0]instanceof m))return M=P[0]||"nonzero",y.apply(this,[M]);var E=P[0],M=P[1]||"nonzero";v(this,E.commands),y.apply(this,[M])},f.prototype.stroke=function(P){P&&v(this,P.commands),x.apply(this)},f.prototype.isPointInPath=function(){for(var P=[],S=0;S<arguments.length;S++)P[S]=arguments[S];if(P[0]instanceof m){var E=P[0],M=P[1],T=P[2],D=P[3]||"nonzero";return v(this,E.commands),k.apply(this,[M,T,D])}return k.apply(this,P)},d.Path2D=m}}(window),function(d){if(d&&d.CanvasRenderingContext2D){var f=d.CanvasRenderingContext2D,y=d.Path2D;f&&!f.prototype.roundRect&&(f.prototype.roundRect=g),y&&!y.prototype.roundRect&&(y.prototype.roundRect=g)}}(window),path2dPolyfill_esm}var ponyfillExports={},hasRequiredPonyfill;function requirePonyfill(){return hasRequiredPonyfill||(hasRequiredPonyfill=1,function(e){var n=typeof Symbol=="function"&&_typeof$1(Symbol.iterator)==="symbol"?Symbol:function(Se){return"Symbol(".concat(Se,")")};function o(Se,Ne){var Ze,lt,ft,Et,$t={label:0,sent:function(){if(1&ft[0])throw ft[1];return ft[1]},trys:[],ops:[]};return Et={next:Ot(0),throw:Ot(1),return:Ot(2)},typeof Symbol=="function"&&(Et[Symbol.iterator]=function(){return this}),Et;function Ot(qt){return function(bn){return Xt([qt,bn])}}function Xt(qt){if(Ze)throw new TypeError("Generator is already executing.");for(;Et&&(Et=0,qt[0]&&($t=0)),$t;)try{if(Ze=1,lt&&(ft=2&qt[0]?lt.return:qt[0]?lt.throw||((ft=lt.return)&&ft.call(lt),0):lt.next)&&!(ft=ft.call(lt,qt[1])).done)return ft;switch(lt=0,ft&&(qt=[2&qt[0],ft.value]),qt[0]){case 0:case 1:ft=qt;break;case 4:return $t.label++,{value:qt[1],done:!1};case 5:$t.label++,lt=qt[1],qt=[0];continue;case 7:qt=$t.ops.pop(),$t.trys.pop();continue;default:if(!((ft=(ft=$t.trys).length>0&&ft[ft.length-1])||qt[0]!==6&&qt[0]!==2)){$t=0;continue}if(qt[0]===3&&(!ft||qt[1]>ft[0]&&qt[1]<ft[3])){$t.label=qt[1];break}if(qt[0]===6&&$t.label<ft[1]){$t.label=ft[1],ft=qt;break}if(ft&&$t.label<ft[2]){$t.label=ft[2],$t.ops.push(qt);break}ft[2]&&$t.ops.pop(),$t.trys.pop();continue}qt=Ne.call(Se,$t)}catch(bn){qt=[6,bn],lt=0}finally{Ze=ft=0}if(5&qt[0])throw qt[1];return{value:qt[0]?qt[1]:void 0,done:!0}}}function r(Se){var Ne=typeof Symbol=="function"&&Symbol.iterator,Ze=Ne&&Se[Ne],lt=0;if(Ze)return Ze.call(Se);if(Se&&typeof Se.length=="number")return{next:function(){return Se&&lt>=Se.length&&(Se=void 0),{value:Se&&Se[lt++],done:!Se}}};throw new TypeError(Ne?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(Se){return this instanceof u?(this.v=Se,this):new u(Se)}function s(Se,Ne,Ze){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var lt,ft=Ze.apply(Se,Ne||[]),Et=[];return lt={},$t("next"),$t("throw"),$t("return"),lt[Symbol.asyncIterator]=function(){return this},lt;function $t(yn){ft[yn]&&(lt[yn]=function(Fn){return new Promise(function(mi,ci){Et.push([yn,Fn,mi,ci])>1||Ot(yn,Fn)})})}function Ot(yn,Fn){try{Xt(ft[yn](Fn))}catch(mi){_n(Et[0][3],mi)}}function Xt(yn){yn.value instanceof u?Promise.resolve(yn.value.v).then(qt,bn):_n(Et[0][2],yn)}function qt(yn){Ot("next",yn)}function bn(yn){Ot("throw",yn)}function _n(yn,Fn){yn(Fn),Et.shift(),Et.length&&Ot(Et[0][0],Et[0][1])}}function w(Se){var Ne,Ze;return Ne={},lt("next"),lt("throw",function(ft){throw ft}),lt("return"),Ne[Symbol.iterator]=function(){return this},Ne;function lt(ft,Et){Ne[ft]=Se[ft]?function($t){return(Ze=!Ze)?{value:u(Se[ft]($t)),done:!1}:Et?Et($t):$t}:Et}}function m(Se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ne,Ze=Se[Symbol.asyncIterator];return Ze?Ze.call(Se):(Se=typeof r=="function"?r(Se):Se[Symbol.iterator](),Ne={},lt("next"),lt("throw"),lt("return"),Ne[Symbol.asyncIterator]=function(){return this},Ne);function lt(Et){Ne[Et]=Se[Et]&&function($t){return new Promise(function(Ot,Xt){ft(Ot,Xt,($t=Se[Et]($t)).done,$t.value)})}}function ft(Et,$t,Ot,Xt){Promise.resolve(Xt).then(function(qt){Et({value:qt,done:Ot})},$t)}}function v(){}function g(Se){return _typeof$1(Se)==="object"&&Se!==null||typeof Se=="function"}typeof SuppressedError=="function"&&SuppressedError;var d=v;function f(Se,Ne){try{Object.defineProperty(Se,"name",{value:Ne,configurable:!0})}catch{}}var y=Promise,x=Promise.prototype.then,k=Promise.reject.bind(y);function P(Se){return new y(Se)}function S(Se){return P(function(Ne){return Ne(Se)})}function E(Se){return k(Se)}function M(Se,Ne,Ze){return x.call(Se,Ne,Ze)}function T(Se,Ne,Ze){M(M(Se,Ne,Ze),void 0,d)}function D(Se,Ne){T(Se,Ne)}function N(Se,Ne){T(Se,void 0,Ne)}function I(Se,Ne,Ze){return M(Se,Ne,Ze)}function O(Se){M(Se,void 0,d)}var F=function(Se){if(typeof queueMicrotask=="function")F=queueMicrotask;else{var Ne=S(void 0);F=function(Ze){return M(Ne,Ze)}}return F(Se)};function q(Se,Ne,Ze){if(typeof Se!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(Se,Ne,Ze)}function Y(Se,Ne,Ze){try{return S(q(Se,Ne,Ze))}catch(lt){return E(lt)}}var _e=16384,ne=function(){function Se(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}return Object.defineProperty(Se.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),Se.prototype.push=function(Ne){var Ze=this._back,lt=Ze;Ze._elements.length===_e-1&&(lt={_elements:[],_next:void 0}),Ze._elements.push(Ne),lt!==Ze&&(this._back=lt,Ze._next=lt),++this._size},Se.prototype.shift=function(){var Ne=this._front,Ze=Ne,lt=this._cursor,ft=lt+1,Et=Ne._elements,$t=Et[lt];return ft===_e&&(Ze=Ne._next,ft=0),--this._size,this._cursor=ft,Ne!==Ze&&(this._front=Ze),Et[lt]=void 0,$t},Se.prototype.forEach=function(Ne){for(var Ze=this._cursor,lt=this._front,ft=lt._elements;!(Ze===ft.length&&lt._next===void 0||Ze===ft.length&&(Ze=0,(ft=(lt=lt._next)._elements).length===0));)Ne(ft[Ze]),++Ze},Se.prototype.peek=function(){var Ne=this._front,Ze=this._cursor;return Ne._elements[Ze]},Se}(),ve=n("[[AbortSteps]]"),J=n("[[ErrorSteps]]"),fe=n("[[CancelSteps]]"),Z=n("[[PullSteps]]"),j=n("[[ReleaseSteps]]");function X(Se,Ne){Se._ownerReadableStream=Ne,Ne._reader=Se,Ne._state==="readable"?Q(Se):Ne._state==="closed"?Pe(Se):re(Se,Ne._storedError)}function H(Se,Ne){return Ci(Se._ownerReadableStream,Ne)}function U(Se){var Ne=Se._ownerReadableStream;Ne._state==="readable"?be(Se,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):we(Se,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),Ne._readableStreamController[j](),Ne._reader=void 0,Se._ownerReadableStream=void 0}function te(Se){return new TypeError("Cannot "+Se+" a stream using a released reader")}function Q(Se){Se._closedPromise=P(function(Ne,Ze){Se._closedPromise_resolve=Ne,Se._closedPromise_reject=Ze})}function re(Se,Ne){Q(Se),be(Se,Ne)}function Pe(Se){Q(Se),Ae(Se)}function be(Se,Ne){Se._closedPromise_reject!==void 0&&(O(Se._closedPromise),Se._closedPromise_reject(Ne),Se._closedPromise_resolve=void 0,Se._closedPromise_reject=void 0)}function we(Se,Ne){re(Se,Ne)}function Ae(Se){Se._closedPromise_resolve!==void 0&&(Se._closedPromise_resolve(void 0),Se._closedPromise_resolve=void 0,Se._closedPromise_reject=void 0)}var $e=Number.isFinite||function(Se){return typeof Se=="number"&&isFinite(Se)},Me=Math.trunc||function(Se){return Se<0?Math.ceil(Se):Math.floor(Se)};function Ie(Se){return _typeof$1(Se)==="object"||typeof Se=="function"}function Le(Se,Ne){if(Se!==void 0&&!Ie(Se))throw new TypeError("".concat(Ne," is not an object."))}function le(Se,Ne){if(typeof Se!="function")throw new TypeError("".concat(Ne," is not a function."))}function oe(Se){return _typeof$1(Se)==="object"&&Se!==null||typeof Se=="function"}function ke(Se,Ne){if(!oe(Se))throw new TypeError("".concat(Ne," is not an object."))}function Ce(Se,Ne,Ze){if(Se===void 0)throw new TypeError("Parameter ".concat(Ne," is required in '").concat(Ze,"'."))}function Ee(Se,Ne,Ze){if(Se===void 0)throw new TypeError("".concat(Ne," is required in '").concat(Ze,"'."))}function Be(Se){return Number(Se)}function Ve(Se){return Se===0?0:Se}function Oe(Se){return Ve(Me(Se))}function je(Se,Ne){var Ze=0,lt=Number.MAX_SAFE_INTEGER,ft=Number(Se);if(ft=Ve(ft),!$e(ft))throw new TypeError("".concat(Ne," is not a finite number"));if((ft=Oe(ft))<Ze||ft>lt)throw new TypeError("".concat(Ne," is outside the accepted range of ").concat(Ze," to ").concat(lt,", inclusive"));return $e(ft)&&ft!==0?ft:0}function Ge(Se,Ne){if(!xi(Se))throw new TypeError("".concat(Ne," is not a ReadableStream."))}function Xe(Se){return new kt(Se)}function qe(Se,Ne){Se._reader._readRequests.push(Ne)}function Ke(Se,Ne,Ze){var lt=Se._reader._readRequests.shift();Ze?lt._closeSteps():lt._chunkSteps(Ne)}function Je(Se){return Se._reader._readRequests.length}function rt(Se){var Ne=Se._reader;return Ne!==void 0&&!!mt(Ne)}var ht,vt,Ct,kt=function(){function Se(Ne){if(Ce(Ne,1,"ReadableStreamDefaultReader"),Ge(Ne,"First parameter"),ai(Ne))throw new TypeError("This stream has already been locked for exclusive reading by another reader");X(this,Ne),this._readRequests=new ne}return Object.defineProperty(Se.prototype,"closed",{get:function(){return mt(this)?this._closedPromise:E(gt("closed"))},enumerable:!1,configurable:!0}),Se.prototype.cancel=function(Ne){return Ne===void 0&&(Ne=void 0),mt(this)?this._ownerReadableStream===void 0?E(te("cancel")):H(this,Ne):E(gt("cancel"))},Se.prototype.read=function(){if(!mt(this))return E(gt("read"));if(this._ownerReadableStream===void 0)return E(te("read from"));var Ne,Ze,lt=P(function(ft,Et){Ne=ft,Ze=Et});return Vt(this,{_chunkSteps:function(ft){return Ne({value:ft,done:!1})},_closeSteps:function(){return Ne({value:void 0,done:!0})},_errorSteps:function(ft){return Ze(ft)}}),lt},Se.prototype.releaseLock=function(){if(!mt(this))throw gt("releaseLock");this._ownerReadableStream!==void 0&&bt(this)},Se}();function mt(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_readRequests")&&Se instanceof kt}function Vt(Se,Ne){var Ze=Se._ownerReadableStream;Ze._disturbed=!0,Ze._state==="closed"?Ne._closeSteps():Ze._state==="errored"?Ne._errorSteps(Ze._storedError):Ze._readableStreamController[Z](Ne)}function bt(Se){U(Se),ot(Se,new TypeError("Reader was released"))}function ot(Se,Ne){var Ze=Se._readRequests;Se._readRequests=new ne,Ze.forEach(function(lt){lt._errorSteps(Ne)})}function gt(Se){return new TypeError("ReadableStreamDefaultReader.prototype.".concat(Se," can only be used on a ReadableStreamDefaultReader"))}function tt(Se){return Se.slice()}function ut(Se,Ne,Ze,lt,ft){new Uint8Array(Se).set(new Uint8Array(Ze,lt,ft),Ne)}Object.defineProperties(kt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),f(kt.prototype.cancel,"cancel"),f(kt.prototype.read,"read"),f(kt.prototype.releaseLock,"releaseLock"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(kt.prototype,n.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});var Re=function(Se){return(Re=typeof Se.transfer=="function"?function(Ne){return Ne.transfer()}:typeof structuredClone=="function"?function(Ne){return structuredClone(Ne,{transfer:[Ne]})}:function(Ne){return Ne})(Se)},Te=function(Se){return(Te=typeof Se.detached=="boolean"?function(Ne){return Ne.detached}:function(Ne){return Ne.byteLength===0})(Se)};function He(Se,Ne,Ze){if(Se.slice)return Se.slice(Ne,Ze);var lt=Ze-Ne,ft=new ArrayBuffer(lt);return ut(ft,0,Se,Ne,lt),ft}function Fe(Se,Ne){var Ze=Se[Ne];if(Ze!=null){if(typeof Ze!="function")throw new TypeError("".concat(String(Ne)," is not a function"));return Ze}}function ze(Se){var Ne,Ze=((Ne={})[n.iterator]=function(){return Se.iterator},Ne),lt=function(){return s(this,arguments,function(){return o(this,function(ft){switch(ft.label){case 0:return[5,r(w(m(Ze)))];case 1:case 2:return[4,u.apply(void 0,[ft.sent()])];case 3:return[2,ft.sent()]}})})}();return{iterator:lt,nextMethod:lt.next,done:!1}}var We,Ue=(Ct=(ht=n.asyncIterator)!==null&&ht!==void 0?ht:(vt=n.for)===null||vt===void 0?void 0:vt.call(n,"Symbol.asyncIterator"))!==null&&Ct!==void 0?Ct:"@@asyncIterator";function et(Se,Ne,Ze){if(Ne===void 0&&(Ne="sync"),Ze===void 0)if(Ne==="async"){if((Ze=Fe(Se,Ue))===void 0)return ze(et(Se,"sync",Fe(Se,n.iterator)))}else Ze=Fe(Se,n.iterator);if(Ze===void 0)throw new TypeError("The object is not iterable");var lt=q(Ze,Se,[]);if(!g(lt))throw new TypeError("The iterator method must return an object");return{iterator:lt,nextMethod:lt.next,done:!1}}function it(Se){var Ne=q(Se.nextMethod,Se.iterator,[]);if(!g(Ne))throw new TypeError("The iterator.next() method must return an object");return Ne}function nt(Se){return Boolean(Se.done)}function dt(Se){return Se.value}var xt=((We={})[Ue]=function(){return this},We);Object.defineProperty(xt,Ue,{enumerable:!1});var yt=function(){function Se(Ne,Ze){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=Ne,this._preventCancel=Ze}return Se.prototype.next=function(){var Ne=this,Ze=function(){return Ne._nextSteps()};return this._ongoingPromise=this._ongoingPromise?I(this._ongoingPromise,Ze,Ze):Ze(),this._ongoingPromise},Se.prototype.return=function(Ne){var Ze=this,lt=function(){return Ze._returnSteps(Ne)};return this._ongoingPromise?I(this._ongoingPromise,lt,lt):lt()},Se.prototype._nextSteps=function(){var Ne=this;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});var Ze,lt,ft=this._reader,Et=P(function($t,Ot){Ze=$t,lt=Ot});return Vt(ft,{_chunkSteps:function($t){Ne._ongoingPromise=void 0,F(function(){return Ze({value:$t,done:!1})})},_closeSteps:function(){Ne._ongoingPromise=void 0,Ne._isFinished=!0,U(ft),Ze({value:void 0,done:!0})},_errorSteps:function($t){Ne._ongoingPromise=void 0,Ne._isFinished=!0,U(ft),lt($t)}}),Et},Se.prototype._returnSteps=function(Ne){if(this._isFinished)return Promise.resolve({value:Ne,done:!0});this._isFinished=!0;var Ze=this._reader;if(!this._preventCancel){var lt=H(Ze,Ne);return U(Ze),I(lt,function(){return{value:Ne,done:!0}})}return U(Ze),S({value:Ne,done:!0})},Se}(),Bt={next:function(){return Tt(this)?this._asyncIteratorImpl.next():E(ct("next"))},return:function(Se){return Tt(this)?this._asyncIteratorImpl.return(Se):E(ct("return"))}};function Pt(Se,Ne){var Ze=Xe(Se),lt=new yt(Ze,Ne),ft=Object.create(Bt);return ft._asyncIteratorImpl=lt,ft}function Tt(Se){if(!g(Se)||!Object.prototype.hasOwnProperty.call(Se,"_asyncIteratorImpl"))return!1;try{return Se._asyncIteratorImpl instanceof yt}catch{return!1}}function ct(Se){return new TypeError("ReadableStreamAsyncIterator.".concat(Se," can only be used on a ReadableSteamAsyncIterator"))}Object.setPrototypeOf(Bt,xt);var wt=Number.isNaN||function(Se){return Se!=Se};function St(Se){return!(typeof Se!="number"||wt(Se)||Se<0)}function Ft(Se){var Ne=He(Se.buffer,Se.byteOffset,Se.byteOffset+Se.byteLength);return new Uint8Array(Ne)}function Gt(Se){var Ne=Se._queue.shift();return Se._queueTotalSize-=Ne.size,Se._queueTotalSize<0&&(Se._queueTotalSize=0),Ne.value}function jt(Se,Ne,Ze){if(!St(Ze)||Ze===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");Se._queue.push({value:Ne,size:Ze}),Se._queueTotalSize+=Ze}function Ut(Se){return Se._queue.peek().value}function Jt(Se){Se._queue=new ne,Se._queueTotalSize=0}function un(Se){return Se===DataView}function nn(Se){return un(Se.constructor)}function Zt(Se){return un(Se)?1:Se.BYTES_PER_ELEMENT}var en=function(){function Se(){throw new TypeError("Illegal constructor")}return Object.defineProperty(Se.prototype,"view",{get:function(){if(!Rn(this))throw Jo("view");return this._view},enumerable:!1,configurable:!0}),Se.prototype.respond=function(Ne){if(!Rn(this))throw Jo("respond");if(Ce(Ne,1,"respond"),Ne=je(Ne,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Te(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");uo(this._associatedReadableByteStreamController,Ne)},Se.prototype.respondWithNewView=function(Ne){if(!Rn(this))throw Jo("respondWithNewView");if(Ce(Ne,1,"respondWithNewView"),!ArrayBuffer.isView(Ne))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Te(Ne.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");ho(this._associatedReadableByteStreamController,Ne)},Se}();Object.defineProperties(en.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),f(en.prototype.respond,"respond"),f(en.prototype.respondWithNewView,"respondWithNewView"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(en.prototype,n.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});var Cn=function(){function Se(){throw new TypeError("Illegal constructor")}return Object.defineProperty(Se.prototype,"byobRequest",{get:function(){if(!$n(this))throw Qi("byobRequest");return Vo(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"desiredSize",{get:function(){if(!$n(this))throw Qi("desiredSize");return Zo(this)},enumerable:!1,configurable:!0}),Se.prototype.close=function(){if(!$n(this))throw Qi("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var Ne=this._controlledReadableByteStream._state;if(Ne!=="readable")throw new TypeError("The stream (in ".concat(Ne," state) is not in the readable state and cannot be closed"));Wi(this)},Se.prototype.enqueue=function(Ne){if(!$n(this))throw Qi("enqueue");if(Ce(Ne,1,"enqueue"),!ArrayBuffer.isView(Ne))throw new TypeError("chunk must be an array buffer view");if(Ne.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(Ne.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");var Ze=this._controlledReadableByteStream._state;if(Ze!=="readable")throw new TypeError("The stream (in ".concat(Ze," state) is not in the readable state and cannot be enqueued to"));Zn(this,Ne)},Se.prototype.error=function(Ne){if(Ne===void 0&&(Ne=void 0),!$n(this))throw Qi("error");oi(this,Ne)},Se.prototype[fe]=function(Ne){zn(this),Jt(this);var Ze=this._cancelAlgorithm(Ne);return co(this),Ze},Se.prototype[Z]=function(Ne){var Ze=this._controlledReadableByteStream;if(this._queueTotalSize>0)Ko(this,Ne);else{var lt=this._autoAllocateChunkSize;if(lt!==void 0){var ft=void 0;try{ft=new ArrayBuffer(lt)}catch($t){return void Ne._errorSteps($t)}var Et={buffer:ft,bufferByteLength:lt,byteOffset:0,byteLength:lt,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(Et)}qe(Ze,Ne),Nn(this)}},Se.prototype[j]=function(){if(this._pendingPullIntos.length>0){var Ne=this._pendingPullIntos.peek();Ne.readerType="none",this._pendingPullIntos=new ne,this._pendingPullIntos.push(Ne)}},Se}();function $n(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_controlledReadableByteStream")&&Se instanceof Cn}function Rn(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_associatedReadableByteStreamController")&&Se instanceof en}function Nn(Se){zi(Se)&&(Se._pulling?Se._pullAgain=!0:(Se._pulling=!0,T(Se._pullAlgorithm(),function(){return Se._pulling=!1,Se._pullAgain&&(Se._pullAgain=!1,Nn(Se)),null},function(Ne){return oi(Se,Ne),null})))}function zn(Se){kn(Se),Se._pendingPullIntos=new ne}function _i(Se,Ne){var Ze=!1;Se._state==="closed"&&(Ze=!0);var lt=$i(Ne);Ne.readerType==="default"?Ke(Se,lt,Ze):aa(Se,lt,Ze)}function $i(Se){var Ne=Se.bytesFilled,Ze=Se.elementSize;return new Se.viewConstructor(Se.buffer,Se.byteOffset,Ne/Ze)}function Bo(Se,Ne,Ze,lt){Se._queue.push({buffer:Ne,byteOffset:Ze,byteLength:lt}),Se._queueTotalSize+=lt}function Ar(Se,Ne,Ze,lt){var ft;try{ft=He(Ne,Ze,Ze+lt)}catch(Et){throw oi(Se,Et),Et}Bo(Se,ft,0,lt)}function Mr(Se,Ne){Ne.bytesFilled>0&&Ar(Se,Ne.buffer,Ne.byteOffset,Ne.bytesFilled),Di(Se)}function $r(Se,Ne){var Ze=Math.min(Se._queueTotalSize,Ne.byteLength-Ne.bytesFilled),lt=Ne.bytesFilled+Ze,ft=Ze,Et=!1,$t=lt-lt%Ne.elementSize;$t>=Ne.minimumFill&&(ft=$t-Ne.bytesFilled,Et=!0);for(var Ot=Se._queue;ft>0;){var Xt=Ot.peek(),qt=Math.min(ft,Xt.byteLength),bn=Ne.byteOffset+Ne.bytesFilled;ut(Ne.buffer,bn,Xt.buffer,Xt.byteOffset,qt),Xt.byteLength===qt?Ot.shift():(Xt.byteOffset+=qt,Xt.byteLength-=qt),Se._queueTotalSize-=qt,Tr(Se,qt,Ne),ft-=qt}return Et}function Tr(Se,Ne,Ze){Ze.bytesFilled+=Ne}function En(Se){Se._queueTotalSize===0&&Se._closeRequested?(co(Se),gr(Se._controlledReadableByteStream)):Nn(Se)}function kn(Se){Se._byobRequest!==null&&(Se._byobRequest._associatedReadableByteStreamController=void 0,Se._byobRequest._view=null,Se._byobRequest=null)}function Xo(Se){for(;Se._pendingPullIntos.length>0;){if(Se._queueTotalSize===0)return;var Ne=Se._pendingPullIntos.peek();$r(Se,Ne)&&(Di(Se),_i(Se._controlledReadableByteStream,Ne))}}function na(Se){for(var Ne=Se._controlledReadableByteStream._reader;Ne._readRequests.length>0;){if(Se._queueTotalSize===0)return;Ko(Se,Ne._readRequests.shift())}}function ia(Se,Ne,Ze,lt){var ft,Et=Se._controlledReadableByteStream,$t=Ne.constructor,Ot=Zt($t),Xt=Ne.byteOffset,qt=Ne.byteLength,bn=Ze*Ot;try{ft=Re(Ne.buffer)}catch(ci){return void lt._errorSteps(ci)}var _n={buffer:ft,bufferByteLength:ft.byteLength,byteOffset:Xt,byteLength:qt,bytesFilled:0,minimumFill:bn,elementSize:Ot,viewConstructor:$t,readerType:"byob"};if(Se._pendingPullIntos.length>0)return Se._pendingPullIntos.push(_n),void ji(Et,lt);if(Et._state!=="closed"){if(Se._queueTotalSize>0){if($r(Se,_n)){var yn=$i(_n);return En(Se),void lt._chunkSteps(yn)}if(Se._closeRequested){var Fn=new TypeError("Insufficient bytes to fill elements in the given buffer");return oi(Se,Fn),void lt._errorSteps(Fn)}}Se._pendingPullIntos.push(_n),ji(Et,lt),Nn(Se)}else{var mi=new $t(_n.buffer,_n.byteOffset,0);lt._closeSteps(mi)}}function Br(Se,Ne){Ne.readerType==="none"&&Di(Se);var Ze=Se._controlledReadableByteStream;if(er(Ze))for(;Ia(Ze)>0;)_i(Ze,Di(Se))}function oa(Se,Ne,Ze){if(Tr(Se,Ne,Ze),Ze.readerType==="none")return Mr(Se,Ze),void Xo(Se);if(!(Ze.bytesFilled<Ze.minimumFill)){Di(Se);var lt=Ze.bytesFilled%Ze.elementSize;if(lt>0){var ft=Ze.byteOffset+Ze.bytesFilled;Ar(Se,Ze.buffer,ft-lt,lt)}Ze.bytesFilled-=lt,_i(Se._controlledReadableByteStream,Ze),Xo(Se)}}function Wn(Se,Ne){var Ze=Se._pendingPullIntos.peek();kn(Se),Se._controlledReadableByteStream._state==="closed"?Br(Se,Ze):oa(Se,Ne,Ze),Nn(Se)}function Di(Se){return Se._pendingPullIntos.shift()}function zi(Se){var Ne=Se._controlledReadableByteStream;return Ne._state==="readable"&&!Se._closeRequested&&!!Se._started&&(!!(rt(Ne)&&Je(Ne)>0)||!!(er(Ne)&&Ia(Ne)>0)||Zo(Se)>0)}function co(Se){Se._pullAlgorithm=void 0,Se._cancelAlgorithm=void 0}function Wi(Se){var Ne=Se._controlledReadableByteStream;if(!Se._closeRequested&&Ne._state==="readable")if(Se._queueTotalSize>0)Se._closeRequested=!0;else{if(Se._pendingPullIntos.length>0){var Ze=Se._pendingPullIntos.peek();if(Ze.bytesFilled%Ze.elementSize!=0){var lt=new TypeError("Insufficient bytes to fill elements in the given buffer");throw oi(Se,lt),lt}}co(Se),gr(Ne)}}function Zn(Se,Ne){var Ze=Se._controlledReadableByteStream;if(!Se._closeRequested&&Ze._state==="readable"){var lt=Ne.buffer,ft=Ne.byteOffset,Et=Ne.byteLength;if(Te(lt))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");var $t=Re(lt);if(Se._pendingPullIntos.length>0){var Ot=Se._pendingPullIntos.peek();if(Te(Ot.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");kn(Se),Ot.buffer=Re(Ot.buffer),Ot.readerType==="none"&&Mr(Se,Ot)}rt(Ze)?(na(Se),Je(Ze)===0?Bo(Se,$t,ft,Et):(Se._pendingPullIntos.length>0&&Di(Se),Ke(Ze,new Uint8Array($t,ft,Et),!1))):er(Ze)?(Bo(Se,$t,ft,Et),Xo(Se)):Bo(Se,$t,ft,Et),Nn(Se)}}function oi(Se,Ne){var Ze=Se._controlledReadableByteStream;Ze._state==="readable"&&(zn(Se),Jt(Se),co(Se),mr(Ze,Ne))}function Ko(Se,Ne){var Ze=Se._queue.shift();Se._queueTotalSize-=Ze.byteLength,En(Se);var lt=new Uint8Array(Ze.buffer,Ze.byteOffset,Ze.byteLength);Ne._chunkSteps(lt)}function Vo(Se){if(Se._byobRequest===null&&Se._pendingPullIntos.length>0){var Ne=Se._pendingPullIntos.peek(),Ze=new Uint8Array(Ne.buffer,Ne.byteOffset+Ne.bytesFilled,Ne.byteLength-Ne.bytesFilled),lt=Object.create(en.prototype);si(lt,Se,Ze),Se._byobRequest=lt}return Se._byobRequest}function Zo(Se){var Ne=Se._controlledReadableByteStream._state;return Ne==="errored"?null:Ne==="closed"?0:Se._strategyHWM-Se._queueTotalSize}function uo(Se,Ne){var Ze=Se._pendingPullIntos.peek();if(Se._controlledReadableByteStream._state==="closed"){if(Ne!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(Ne===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(Ze.bytesFilled+Ne>Ze.byteLength)throw new RangeError("bytesWritten out of range")}Ze.buffer=Re(Ze.buffer),Wn(Se,Ne)}function ho(Se,Ne){var Ze=Se._pendingPullIntos.peek();if(Se._controlledReadableByteStream._state==="closed"){if(Ne.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(Ne.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(Ze.byteOffset+Ze.bytesFilled!==Ne.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(Ze.bufferByteLength!==Ne.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(Ze.bytesFilled+Ne.byteLength>Ze.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");var lt=Ne.byteLength;Ze.buffer=Re(Ne.buffer),Wn(Se,lt)}function ei(Se,Ne,Ze,lt,ft,Et,$t){Ne._controlledReadableByteStream=Se,Ne._pullAgain=!1,Ne._pulling=!1,Ne._byobRequest=null,Ne._queue=Ne._queueTotalSize=void 0,Jt(Ne),Ne._closeRequested=!1,Ne._started=!1,Ne._strategyHWM=Et,Ne._pullAlgorithm=lt,Ne._cancelAlgorithm=ft,Ne._autoAllocateChunkSize=$t,Ne._pendingPullIntos=new ne,Se._readableStreamController=Ne,T(S(Ze()),function(){return Ne._started=!0,Nn(Ne),null},function(Ot){return oi(Ne,Ot),null})}function ra(Se,Ne,Ze){var lt,ft,Et,$t=Object.create(Cn.prototype);lt=Ne.start!==void 0?function(){return Ne.start($t)}:function(){},ft=Ne.pull!==void 0?function(){return Ne.pull($t)}:function(){return S(void 0)},Et=Ne.cancel!==void 0?function(Xt){return Ne.cancel(Xt)}:function(){return S(void 0)};var Ot=Ne.autoAllocateChunkSize;if(Ot===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");ei(Se,$t,lt,ft,Et,Ze,Ot)}function si(Se,Ne,Ze){Se._associatedReadableByteStreamController=Ne,Se._view=Ze}function Jo(Se){return new TypeError("ReadableStreamBYOBRequest.prototype.".concat(Se," can only be used on a ReadableStreamBYOBRequest"))}function Qi(Se){return new TypeError("ReadableByteStreamController.prototype.".concat(Se," can only be used on a ReadableByteStreamController"))}function Ni(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.mode;return{mode:Ze===void 0?void 0:Lo(Ze,"".concat(Ne," has member 'mode' that"))}}function Lo(Se,Ne){if((Se="".concat(Se))!=="byob")throw new TypeError("".concat(Ne," '").concat(Se,"' is not a valid enumeration value for ReadableStreamReaderMode"));return Se}function Qo(Se,Ne){var Ze;return Le(Se,Ne),{min:je((Ze=Se==null?void 0:Se.min)!==null&&Ze!==void 0?Ze:1,"".concat(Ne," has member 'min' that"))}}function Bn(Se){return new eo(Se)}function ji(Se,Ne){Se._reader._readIntoRequests.push(Ne)}function aa(Se,Ne,Ze){var lt=Se._reader._readIntoRequests.shift();Ze?lt._closeSteps(Ne):lt._chunkSteps(Ne)}function Ia(Se){return Se._reader._readIntoRequests.length}function er(Se){var Ne=Se._reader;return Ne!==void 0&&!!to(Ne)}Object.defineProperties(Cn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),f(Cn.prototype.close,"close"),f(Cn.prototype.enqueue,"enqueue"),f(Cn.prototype.error,"error"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(Cn.prototype,n.toStringTag,{value:"ReadableByteStreamController",configurable:!0});var eo=function(){function Se(Ne){if(Ce(Ne,1,"ReadableStreamBYOBReader"),Ge(Ne,"First parameter"),ai(Ne))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!$n(Ne._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");X(this,Ne),this._readIntoRequests=new ne}return Object.defineProperty(Se.prototype,"closed",{get:function(){return to(this)?this._closedPromise:E(nr("closed"))},enumerable:!1,configurable:!0}),Se.prototype.cancel=function(Ne){return Ne===void 0&&(Ne=void 0),to(this)?this._ownerReadableStream===void 0?E(te("cancel")):H(this,Ne):E(nr("cancel"))},Se.prototype.read=function(Ne,Ze){if(Ze===void 0&&(Ze={}),!to(this))return E(nr("read"));if(!ArrayBuffer.isView(Ne))return E(new TypeError("view must be an array buffer view"));if(Ne.byteLength===0)return E(new TypeError("view must have non-zero byteLength"));if(Ne.buffer.byteLength===0)return E(new TypeError("view's buffer must have non-zero byteLength"));if(Te(Ne.buffer))return E(new TypeError("view's buffer has been detached"));var lt;try{lt=Qo(Ze,"options")}catch(Xt){return E(Xt)}var ft,Et,$t=lt.min;if($t===0)return E(new TypeError("options.min must be greater than 0"));if(nn(Ne)){if($t>Ne.byteLength)return E(new RangeError("options.min must be less than or equal to view's byteLength"))}else if($t>Ne.length)return E(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return E(te("read from"));var Ot=P(function(Xt,qt){ft=Xt,Et=qt});return tr(this,Ne,$t,{_chunkSteps:function(Xt){return ft({value:Xt,done:!1})},_closeSteps:function(Xt){return ft({value:Xt,done:!0})},_errorSteps:function(Xt){return Et(Xt)}}),Ot},Se.prototype.releaseLock=function(){if(!to(this))throw nr("releaseLock");this._ownerReadableStream!==void 0&&Ro(this)},Se}();function to(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_readIntoRequests")&&Se instanceof eo}function tr(Se,Ne,Ze,lt){var ft=Se._ownerReadableStream;ft._disturbed=!0,ft._state==="errored"?lt._errorSteps(ft._storedError):ia(ft._readableStreamController,Ne,Ze,lt)}function Ro(Se){U(Se),Oa(Se,new TypeError("Reader was released"))}function Oa(Se,Ne){var Ze=Se._readIntoRequests;Se._readIntoRequests=new ne,Ze.forEach(function(lt){lt._errorSteps(Ne)})}function nr(Se){return new TypeError("ReadableStreamBYOBReader.prototype.".concat(Se," can only be used on a ReadableStreamBYOBReader"))}function Do(Se,Ne){var Ze=Se.highWaterMark;if(Ze===void 0)return Ne;if(wt(Ze)||Ze<0)throw new RangeError("Invalid highWaterMark");return Ze}function No(Se){var Ne=Se.size;return Ne||function(){return 1}}function Io(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.highWaterMark,lt=Se==null?void 0:Se.size;return{highWaterMark:Ze===void 0?void 0:Be(Ze),size:lt===void 0?void 0:Fa(lt,"".concat(Ne," has member 'size' that"))}}function Fa(Se,Ne){return le(Se,Ne),function(Ze){return Be(Se(Ze))}}function sa(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.abort,lt=Se==null?void 0:Se.close,ft=Se==null?void 0:Se.start,Et=Se==null?void 0:Se.type,$t=Se==null?void 0:Se.write;return{abort:Ze===void 0?void 0:la(Ze,Se,"".concat(Ne," has member 'abort' that")),close:lt===void 0?void 0:Ha(lt,Se,"".concat(Ne," has member 'close' that")),start:ft===void 0?void 0:hi(ft,Se,"".concat(Ne," has member 'start' that")),write:$t===void 0?void 0:ca($t,Se,"".concat(Ne," has member 'write' that")),type:Et}}function la(Se,Ne,Ze){return le(Se,Ze),function(lt){return Y(Se,Ne,[lt])}}function Ha(Se,Ne,Ze){return le(Se,Ze),function(){return Y(Se,Ne,[])}}function hi(Se,Ne,Ze){return le(Se,Ze),function(lt){return q(Se,Ne,[lt])}}function ca(Se,Ne,Ze){return le(Se,Ze),function(lt,ft){return Y(Se,Ne,[lt,ft])}}function Oo(Se,Ne){if(!fo(Se))throw new TypeError("".concat(Ne," is not a WritableStream."))}function za(Se){if(_typeof$1(Se)!=="object"||Se===null)return!1;try{return typeof Se.aborted=="boolean"}catch{return!1}}Object.defineProperties(eo.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),f(eo.prototype.cancel,"cancel"),f(eo.prototype.read,"read"),f(eo.prototype.releaseLock,"releaseLock"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(eo.prototype,n.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});var Wa=typeof AbortController=="function";function $s(){if(Wa)return new AbortController}var no=function(){function Se(Ne,Ze){Ne===void 0&&(Ne={}),Ze===void 0&&(Ze={}),Ne===void 0?Ne=null:ke(Ne,"First parameter");var lt=Io(Ze,"Second parameter"),ft=sa(Ne,"First parameter");if(Vr(this),ft.type!==void 0)throw new RangeError("Invalid type is specified");var Et=No(lt);Bs(this,ft,Do(lt,1),Et)}return Object.defineProperty(Se.prototype,"locked",{get:function(){if(!fo(this))throw yo("locked");return fi(this)},enumerable:!1,configurable:!0}),Se.prototype.abort=function(Ne){return Ne===void 0&&(Ne=void 0),fo(this)?fi(this)?E(new TypeError("Cannot abort a stream that already has a writer")):po(this,Ne):E(yo("abort"))},Se.prototype.close=function(){return fo(this)?fi(this)?E(new TypeError("Cannot close a stream that already has a writer")):Wt(this)?E(new TypeError("Cannot close an already-closing stream")):Ua(this):E(yo("close"))},Se.prototype.getWriter=function(){if(!fo(this))throw yo("getWriter");return ja(this)},Se}();function ja(Se){return new Ti(Se)}function Fo(Se,Ne,Ze,lt,ft,Et){ft===void 0&&(ft=1),Et===void 0&&(Et=function(){return 1});var $t=Object.create(no.prototype);return Vr($t),Ga($t,Object.create(Ui.prototype),Se,Ne,Ze,lt,ft,Et),$t}function Vr(Se){Se._state="writable",Se._storedError=void 0,Se._writer=void 0,Se._writableStreamController=void 0,Se._writeRequests=new ne,Se._inFlightWriteRequest=void 0,Se._closeRequest=void 0,Se._inFlightCloseRequest=void 0,Se._pendingAbortRequest=void 0,Se._backpressure=!1}function fo(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_writableStreamController")&&Se instanceof no}function fi(Se){return Se._writer!==void 0}function po(Se,Ne){var Ze;if(Se._state==="closed"||Se._state==="errored")return S(void 0);Se._writableStreamController._abortReason=Ne,(Ze=Se._writableStreamController._abortController)===null||Ze===void 0||Ze.abort(Ne);var lt=Se._state;if(lt==="closed"||lt==="errored")return S(void 0);if(Se._pendingAbortRequest!==void 0)return Se._pendingAbortRequest._promise;var ft=!1;lt==="erroring"&&(ft=!0,Ne=void 0);var Et=P(function($t,Ot){Se._pendingAbortRequest={_promise:void 0,_resolve:$t,_reject:Ot,_reason:Ne,_wasAlreadyErroring:ft}});return Se._pendingAbortRequest._promise=Et,ft||Lr(Se,Ne),Et}function Ua(Se){var Ne=Se._state;if(Ne==="closed"||Ne==="errored")return E(new TypeError("The stream (in ".concat(Ne," state) is not in the writable state and cannot be closed")));var Ze=P(function(ft,Et){var $t={_resolve:ft,_reject:Et};Se._closeRequest=$t}),lt=Se._writer;return lt!==void 0&&Se._backpressure&&Ne==="writable"&&va(lt),io(Se._writableStreamController),Ze}function Ho(Se){return P(function(Ne,Ze){var lt={_resolve:Ne,_reject:Ze};Se._writeRequests.push(lt)})}function pi(Se,Ne){Se._state!=="writable"?ua(Se):Lr(Se,Ne)}function Lr(Se,Ne){var Ze=Se._writableStreamController;Se._state="erroring",Se._storedError=Ne;var lt=Se._writer;lt!==void 0&&or(lt,Ne),!dn(Se)&&Ze._started&&ua(Se)}function ua(Se){Se._state="errored",Se._writableStreamController[J]();var Ne=Se._storedError;if(Se._writeRequests.forEach(function(lt){lt._reject(Ne)}),Se._writeRequests=new ne,Se._pendingAbortRequest!==void 0){var Ze=Se._pendingAbortRequest;if(Se._pendingAbortRequest=void 0,Ze._wasAlreadyErroring)return Ze._reject(Ne),void gi(Se);T(Se._writableStreamController[ve](Ze._reason),function(){return Ze._resolve(),gi(Se),null},function(lt){return Ze._reject(lt),gi(Se),null})}else gi(Se)}function zo(Se){Se._inFlightWriteRequest._resolve(void 0),Se._inFlightWriteRequest=void 0}function Mt(Se,Ne){Se._inFlightWriteRequest._reject(Ne),Se._inFlightWriteRequest=void 0,pi(Se,Ne)}function Rt(Se){Se._inFlightCloseRequest._resolve(void 0),Se._inFlightCloseRequest=void 0,Se._state==="erroring"&&(Se._storedError=void 0,Se._pendingAbortRequest!==void 0&&(Se._pendingAbortRequest._resolve(),Se._pendingAbortRequest=void 0)),Se._state="closed";var Ne=Se._writer;Ne!==void 0&&Ka(Ne)}function It(Se,Ne){Se._inFlightCloseRequest._reject(Ne),Se._inFlightCloseRequest=void 0,Se._pendingAbortRequest!==void 0&&(Se._pendingAbortRequest._reject(Ne),Se._pendingAbortRequest=void 0),pi(Se,Ne)}function Wt(Se){return Se._closeRequest!==void 0||Se._inFlightCloseRequest!==void 0}function dn(Se){return Se._inFlightWriteRequest!==void 0||Se._inFlightCloseRequest!==void 0}function wn(Se){Se._inFlightCloseRequest=Se._closeRequest,Se._closeRequest=void 0}function qn(Se){Se._inFlightWriteRequest=Se._writeRequests.shift()}function gi(Se){Se._closeRequest!==void 0&&(Se._closeRequest._reject(Se._storedError),Se._closeRequest=void 0);var Ne=Se._writer;Ne!==void 0&&ma(Ne,Se._storedError)}function Mn(Se,Ne){var Ze=Se._writer;Ze!==void 0&&Ne!==Se._backpressure&&(Ne?Vs(Ze):va(Ze)),Se._backpressure=Ne}Object.defineProperties(no.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),f(no.prototype.abort,"abort"),f(no.prototype.close,"close"),f(no.prototype.getWriter,"getWriter"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(no.prototype,n.toStringTag,{value:"WritableStream",configurable:!0});var Ti=function(){function Se(Ne){if(Ce(Ne,1,"WritableStreamDefaultWriter"),Oo(Ne,"First parameter"),fi(Ne))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=Ne,Ne._writer=this;var Ze=Ne._state;if(Ze==="writable")!Wt(Ne)&&Ne._backpressure?Or(this):Jn(this),bo(this);else if(Ze==="erroring")On(this,Ne._storedError),bo(this);else if(Ze==="closed")Jn(this),ga(this);else{var lt=Ne._storedError;On(this,lt),lr(this,lt)}}return Object.defineProperty(Se.prototype,"closed",{get:function(){return go(this)?this._closedPromise:E(_o("closed"))},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"desiredSize",{get:function(){if(!go(this))throw _o("desiredSize");if(this._ownerWritableStream===void 0)throw sr("desiredSize");return Rr(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"ready",{get:function(){return go(this)?this._readyPromise:E(_o("ready"))},enumerable:!1,configurable:!0}),Se.prototype.abort=function(Ne){return Ne===void 0&&(Ne=void 0),go(this)?this._ownerWritableStream===void 0?E(sr("abort")):bi(this,Ne):E(_o("abort"))},Se.prototype.close=function(){if(!go(this))return E(_o("close"));var Ne=this._ownerWritableStream;return Ne===void 0?E(sr("close")):Wt(Ne)?E(new TypeError("Cannot close an already-closing stream")):ir(this)},Se.prototype.releaseLock=function(){if(!go(this))throw _o("releaseLock");this._ownerWritableStream!==void 0&&Sn(this)},Se.prototype.write=function(Ne){return Ne===void 0&&(Ne=void 0),go(this)?this._ownerWritableStream===void 0?E(sr("write to")):qa(this,Ne):E(_o("write"))},Se}();function go(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_ownerWritableStream")&&Se instanceof Ti}function bi(Se,Ne){return po(Se._ownerWritableStream,Ne)}function ir(Se){return Ua(Se._ownerWritableStream)}function Ts(Se){var Ne=Se._ownerWritableStream,Ze=Ne._state;return Wt(Ne)||Ze==="closed"?S(void 0):Ze==="errored"?E(Ne._storedError):ir(Se)}function Wo(Se,Ne){Se._closedPromiseState==="pending"?ma(Se,Ne):Xa(Se,Ne)}function or(Se,Ne){Se._readyPromiseState==="pending"?Za(Se,Ne):Ja(Se,Ne)}function Rr(Se){var Ne=Se._ownerWritableStream,Ze=Ne._state;return Ze==="errored"||Ze==="erroring"?null:Ze==="closed"?0:fa(Ne._writableStreamController)}function Sn(Se){var Ne=Se._ownerWritableStream,Ze=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");or(Se,Ze),Wo(Se,Ze),Ne._writer=void 0,Se._ownerWritableStream=void 0}function qa(Se,Ne){var Ze=Se._ownerWritableStream,lt=Ze._writableStreamController,ft=Dr(lt,Ne);if(Ze!==Se._ownerWritableStream)return E(sr("write to"));var Et=Ze._state;if(Et==="errored")return E(Ze._storedError);if(Wt(Ze)||Et==="closed")return E(new TypeError("The stream is closing or closed and cannot be written to"));if(Et==="erroring")return E(Ze._storedError);var $t=Ho(Ze);return Nr(lt,Ne,ft),$t}Object.defineProperties(Ti.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),f(Ti.prototype.abort,"abort"),f(Ti.prototype.close,"close"),f(Ti.prototype.releaseLock,"releaseLock"),f(Ti.prototype.write,"write"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(Ti.prototype,n.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});var da={},Ui=function(){function Se(){throw new TypeError("Illegal constructor")}return Object.defineProperty(Se.prototype,"abortReason",{get:function(){if(!ha(this))throw pa("abortReason");return this._abortReason},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"signal",{get:function(){if(!ha(this))throw pa("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal},enumerable:!1,configurable:!0}),Se.prototype.error=function(Ne){if(Ne===void 0&&(Ne=void 0),!ha(this))throw pa("error");this._controlledWritableStream._state==="writable"&&oo(this,Ne)},Se.prototype[ve]=function(Ne){var Ze=this._abortAlgorithm(Ne);return mo(this),Ze},Se.prototype[J]=function(){Jt(this)},Se}();function ha(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_controlledWritableStream")&&Se instanceof Ui}function Ga(Se,Ne,Ze,lt,ft,Et,$t,Ot){Ne._controlledWritableStream=Se,Se._writableStreamController=Ne,Ne._queue=void 0,Ne._queueTotalSize=void 0,Jt(Ne),Ne._abortReason=void 0,Ne._abortController=$s(),Ne._started=!1,Ne._strategySizeAlgorithm=Ot,Ne._strategyHWM=$t,Ne._writeAlgorithm=lt,Ne._closeAlgorithm=ft,Ne._abortAlgorithm=Et;var Xt=vo(Ne);Mn(Se,Xt),T(S(Ze()),function(){return Ne._started=!0,ar(Ne),null},function(qt){return Ne._started=!0,pi(Se,qt),null})}function Bs(Se,Ne,Ze,lt){var ft,Et,$t,Ot,Xt=Object.create(Ui.prototype);ft=Ne.start!==void 0?function(){return Ne.start(Xt)}:function(){},Et=Ne.write!==void 0?function(qt){return Ne.write(qt,Xt)}:function(){return S(void 0)},$t=Ne.close!==void 0?function(){return Ne.close()}:function(){return S(void 0)},Ot=Ne.abort!==void 0?function(qt){return Ne.abort(qt)}:function(){return S(void 0)},Ga(Se,Xt,ft,Et,$t,Ot,Ze,lt)}function mo(Se){Se._writeAlgorithm=void 0,Se._closeAlgorithm=void 0,Se._abortAlgorithm=void 0,Se._strategySizeAlgorithm=void 0}function io(Se){jt(Se,da,0),ar(Se)}function Dr(Se,Ne){try{return Se._strategySizeAlgorithm(Ne)}catch(Ze){return jo(Se,Ze),1}}function fa(Se){return Se._strategyHWM-Se._queueTotalSize}function Nr(Se,Ne,Ze){try{jt(Se,Ne,Ze)}catch(ft){return void jo(Se,ft)}var lt=Se._controlledWritableStream;Wt(lt)||lt._state!=="writable"||Mn(lt,vo(Se)),ar(Se)}function ar(Se){var Ne=Se._controlledWritableStream;if(Se._started&&Ne._inFlightWriteRequest===void 0)if(Ne._state!=="erroring"){if(Se._queue.length!==0){var Ze=Ut(Se);Ze===da?Ir(Se):Ya(Se,Ze)}}else ua(Ne)}function jo(Se,Ne){Se._controlledWritableStream._state==="writable"&&oo(Se,Ne)}function Ir(Se){var Ne=Se._controlledWritableStream;wn(Ne),Gt(Se);var Ze=Se._closeAlgorithm();mo(Se),T(Ze,function(){return Rt(Ne),null},function(lt){return It(Ne,lt),null})}function Ya(Se,Ne){var Ze=Se._controlledWritableStream;qn(Ze),T(Se._writeAlgorithm(Ne),function(){zo(Ze);var lt=Ze._state;if(Gt(Se),!Wt(Ze)&&lt==="writable"){var ft=vo(Se);Mn(Ze,ft)}return ar(Se),null},function(lt){return Ze._state==="writable"&&mo(Se),Mt(Ze,lt),null})}function vo(Se){return fa(Se)<=0}function oo(Se,Ne){var Ze=Se._controlledWritableStream;mo(Se),Lr(Ze,Ne)}function yo(Se){return new TypeError("WritableStream.prototype.".concat(Se," can only be used on a WritableStream"))}function pa(Se){return new TypeError("WritableStreamDefaultController.prototype.".concat(Se," can only be used on a WritableStreamDefaultController"))}function _o(Se){return new TypeError("WritableStreamDefaultWriter.prototype.".concat(Se," can only be used on a WritableStreamDefaultWriter"))}function sr(Se){return new TypeError("Cannot "+Se+" a stream using a released writer")}function bo(Se){Se._closedPromise=P(function(Ne,Ze){Se._closedPromise_resolve=Ne,Se._closedPromise_reject=Ze,Se._closedPromiseState="pending"})}function lr(Se,Ne){bo(Se),ma(Se,Ne)}function ga(Se){bo(Se),Ka(Se)}function ma(Se,Ne){Se._closedPromise_reject!==void 0&&(O(Se._closedPromise),Se._closedPromise_reject(Ne),Se._closedPromise_resolve=void 0,Se._closedPromise_reject=void 0,Se._closedPromiseState="rejected")}function Xa(Se,Ne){lr(Se,Ne)}function Ka(Se){Se._closedPromise_resolve!==void 0&&(Se._closedPromise_resolve(void 0),Se._closedPromise_resolve=void 0,Se._closedPromise_reject=void 0,Se._closedPromiseState="resolved")}function Or(Se){Se._readyPromise=P(function(Ne,Ze){Se._readyPromise_resolve=Ne,Se._readyPromise_reject=Ze}),Se._readyPromiseState="pending"}function On(Se,Ne){Or(Se),Za(Se,Ne)}function Jn(Se){Or(Se),va(Se)}function Za(Se,Ne){Se._readyPromise_reject!==void 0&&(O(Se._readyPromise),Se._readyPromise_reject(Ne),Se._readyPromise_resolve=void 0,Se._readyPromise_reject=void 0,Se._readyPromiseState="rejected")}function Vs(Se){Or(Se)}function Ja(Se,Ne){On(Se,Ne)}function va(Se){Se._readyPromise_resolve!==void 0&&(Se._readyPromise_resolve(void 0),Se._readyPromise_resolve=void 0,Se._readyPromise_reject=void 0,Se._readyPromiseState="fulfilled")}function ya(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:commonjsGlobal$1!==void 0?commonjsGlobal$1:void 0}Object.defineProperties(Ui.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(Ui.prototype,n.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});var Uo=ya();function ba(Se){if(typeof Se!="function"&&_typeof$1(Se)!=="object"||Se.name!=="DOMException")return!1;try{return new Se,!0}catch{return!1}}function qo(){var Se=Uo==null?void 0:Uo.DOMException;return ba(Se)?Se:void 0}function cr(){var Se=function(Ne,Ze){this.message=Ne||"",this.name=Ze||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return f(Se,"DOMException"),Se.prototype=Object.create(Error.prototype),Object.defineProperty(Se.prototype,"constructor",{value:Se,writable:!0,configurable:!0}),Se}var ur=qo()||cr();function dr(Se,Ne,Ze,lt,ft,Et){var $t=Xe(Se),Ot=ja(Ne);Se._disturbed=!0;var Xt=!1,qt=S(void 0);return P(function(bn,_n){var yn;if(Et!==void 0){if(yn=function(){var sn=Et.reason!==void 0?Et.reason:new ur("Aborted","AbortError"),xn=[];lt||xn.push(function(){return Ne._state==="writable"?po(Ne,sn):S(void 0)}),ft||xn.push(function(){return Se._state==="readable"?Ci(Se,sn):S(void 0)}),jn(function(){return Promise.all(xn.map(function(Ln){return Ln()}))},!0,sn)},Et.aborted)return void yn();Et.addEventListener("abort",yn)}function Fn(){return P(function(sn,xn){function Ln(Si){Si?sn():M(mi(),Ln,xn)}Ln(!1)})}function mi(){return Xt?S(!0):M(Ot._readyPromise,function(){return P(function(sn,xn){Vt($t,{_chunkSteps:function(Ln){qt=M(qa(Ot,Ln),void 0,v),sn(!1)},_closeSteps:function(){return sn(!0)},_errorSteps:xn})})})}if(Vn(Se,$t._closedPromise,function(sn){return lt?ao(!0,sn):jn(function(){return po(Ne,sn)},!0,sn),null}),Vn(Ne,Ot._closedPromise,function(sn){return ft?ao(!0,sn):jn(function(){return Ci(Se,sn)},!0,sn),null}),Ki(Se,$t._closedPromise,function(){return Ze?ao():jn(function(){return Ts(Ot)}),null}),Wt(Ne)||Ne._state==="closed"){var ci=new TypeError("the destination writable stream closed before all data could be piped to it");ft?ao(!0,ci):jn(function(){return Ci(Se,ci)},!0,ci)}function ki(){var sn=qt;return M(qt,function(){return sn!==qt?ki():void 0})}function Vn(sn,xn,Ln){sn._state==="errored"?Ln(sn._storedError):N(xn,Ln)}function Ki(sn,xn,Ln){sn._state==="closed"?Ln():D(xn,Ln)}function jn(sn,xn,Ln){function Si(){return T(sn(),function(){return Tn(xn,Ln)},function(Zi){return Tn(!0,Zi)}),null}Xt||(Xt=!0,Ne._state!=="writable"||Wt(Ne)?Si():D(ki(),Si))}function ao(sn,xn){Xt||(Xt=!0,Ne._state!=="writable"||Wt(Ne)?Tn(sn,xn):D(ki(),function(){return Tn(sn,xn)}))}function Tn(sn,xn){return Sn(Ot),U($t),Et!==void 0&&Et.removeEventListener("abort",yn),sn?_n(xn):bn(void 0),null}O(Fn())})}var li=function(){function Se(){throw new TypeError("Illegal constructor")}return Object.defineProperty(Se.prototype,"desiredSize",{get:function(){if(!Fr(this))throw gn("desiredSize");return zr(this)},enumerable:!1,configurable:!0}),Se.prototype.close=function(){if(!Fr(this))throw gn("close");if(!Bi(this))throw new TypeError("The stream is not in a state that permits close");wo(this)},Se.prototype.enqueue=function(Ne){if(Ne===void 0&&(Ne=void 0),!Fr(this))throw gn("enqueue");if(!Bi(this))throw new TypeError("The stream is not in a state that permits enqueue");return qi(this,Ne)},Se.prototype.error=function(Ne){if(Ne===void 0&&(Ne=void 0),!Fr(this))throw gn("error");ri(this,Ne)},Se.prototype[fe]=function(Ne){Jt(this);var Ze=this._cancelAlgorithm(Ne);return Hr(this),Ze},Se.prototype[Z]=function(Ne){var Ze=this._controlledReadableStream;if(this._queue.length>0){var lt=Gt(this);this._closeRequested&&this._queue.length===0?(Hr(this),gr(Ze)):hr(this),Ne._chunkSteps(lt)}else qe(Ze,Ne),hr(this)},Se.prototype[j]=function(){},Se}();function Fr(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_controlledReadableStream")&&Se instanceof li}function hr(Se){Qa(Se)&&(Se._pulling?Se._pullAgain=!0:(Se._pulling=!0,T(Se._pullAlgorithm(),function(){return Se._pulling=!1,Se._pullAgain&&(Se._pullAgain=!1,hr(Se)),null},function(Ne){return ri(Se,Ne),null})))}function Qa(Se){var Ne=Se._controlledReadableStream;return!!Bi(Se)&&!!Se._started&&(!!(ai(Ne)&&Je(Ne)>0)||zr(Se)>0)}function Hr(Se){Se._pullAlgorithm=void 0,Se._cancelAlgorithm=void 0,Se._strategySizeAlgorithm=void 0}function wo(Se){if(Bi(Se)){var Ne=Se._controlledReadableStream;Se._closeRequested=!0,Se._queue.length===0&&(Hr(Se),gr(Ne))}}function qi(Se,Ne){if(Bi(Se)){var Ze=Se._controlledReadableStream;if(ai(Ze)&&Je(Ze)>0)Ke(Ze,Ne,!1);else{var lt=void 0;try{lt=Se._strategySizeAlgorithm(Ne)}catch(ft){throw ri(Se,ft),ft}try{jt(Se,Ne,lt)}catch(ft){throw ri(Se,ft),ft}}hr(Se)}}function ri(Se,Ne){var Ze=Se._controlledReadableStream;Ze._state==="readable"&&(Jt(Se),Hr(Se),mr(Ze,Ne))}function zr(Se){var Ne=Se._controlledReadableStream._state;return Ne==="errored"?null:Ne==="closed"?0:Se._strategyHWM-Se._queueTotalSize}function at(Se){return!Qa(Se)}function Bi(Se){var Ne=Se._controlledReadableStream._state;return!Se._closeRequested&&Ne==="readable"}function fr(Se,Ne,Ze,lt,ft,Et,$t){Ne._controlledReadableStream=Se,Ne._queue=void 0,Ne._queueTotalSize=void 0,Jt(Ne),Ne._started=!1,Ne._closeRequested=!1,Ne._pullAgain=!1,Ne._pulling=!1,Ne._strategySizeAlgorithm=$t,Ne._strategyHWM=Et,Ne._pullAlgorithm=lt,Ne._cancelAlgorithm=ft,Se._readableStreamController=Ne,T(S(Ze()),function(){return Ne._started=!0,hr(Ne),null},function(Ot){return ri(Ne,Ot),null})}function wi(Se,Ne,Ze,lt){var ft,Et,$t,Ot=Object.create(li.prototype);ft=Ne.start!==void 0?function(){return Ne.start(Ot)}:function(){},Et=Ne.pull!==void 0?function(){return Ne.pull(Ot)}:function(){return S(void 0)},$t=Ne.cancel!==void 0?function(Xt){return Ne.cancel(Xt)}:function(){return S(void 0)},fr(Se,Ot,ft,Et,$t,Ze,lt)}function gn(Se){return new TypeError("ReadableStreamDefaultController.prototype.".concat(Se," can only be used on a ReadableStreamDefaultController"))}function xo(Se,Ne){return $n(Se._readableStreamController)?Yi(Se):Gi(Se)}function Gi(Se,Ne){var Ze,lt,ft,Et,$t,Ot=Xe(Se),Xt=!1,qt=!1,bn=!1,_n=!1,yn=P(function(Vn){$t=Vn});function Fn(){return Xt?(qt=!0,S(void 0)):(Xt=!0,Vt(Ot,{_chunkSteps:function(Vn){F(function(){qt=!1;var Ki=Vn,jn=Vn;bn||qi(ft._readableStreamController,Ki),_n||qi(Et._readableStreamController,jn),Xt=!1,qt&&Fn()})},_closeSteps:function(){Xt=!1,bn||wo(ft._readableStreamController),_n||wo(Et._readableStreamController),bn&&_n||$t(void 0)},_errorSteps:function(){Xt=!1}}),S(void 0))}function mi(Vn){if(bn=!0,Ze=Vn,_n){var Ki=tt([Ze,lt]),jn=Ci(Se,Ki);$t(jn)}return yn}function ci(Vn){if(_n=!0,lt=Vn,bn){var Ki=tt([Ze,lt]),jn=Ci(Se,Ki);$t(jn)}return yn}function ki(){}return ft=ti(ki,Fn,mi),Et=ti(ki,Fn,ci),N(Ot._closedPromise,function(Vn){return ri(ft._readableStreamController,Vn),ri(Et._readableStreamController,Vn),bn&&_n||$t(void 0),null}),[ft,Et]}function Yi(Se){var Ne,Ze,lt,ft,Et,$t=Xe(Se),Ot=!1,Xt=!1,qt=!1,bn=!1,_n=!1,yn=P(function(Tn){Et=Tn});function Fn(Tn){N(Tn._closedPromise,function(sn){return Tn!==$t||(oi(lt._readableStreamController,sn),oi(ft._readableStreamController,sn),bn&&_n||Et(void 0)),null})}function mi(){to($t)&&(U($t),Fn($t=Xe(Se))),Vt($t,{_chunkSteps:function(Tn){F(function(){Xt=!1,qt=!1;var sn=Tn,xn=Tn;if(!bn&&!_n)try{xn=Ft(Tn)}catch(Ln){return oi(lt._readableStreamController,Ln),oi(ft._readableStreamController,Ln),void Et(Ci(Se,Ln))}bn||Zn(lt._readableStreamController,sn),_n||Zn(ft._readableStreamController,xn),Ot=!1,Xt?ki():qt&&Vn()})},_closeSteps:function(){Ot=!1,bn||Wi(lt._readableStreamController),_n||Wi(ft._readableStreamController),lt._readableStreamController._pendingPullIntos.length>0&&uo(lt._readableStreamController,0),ft._readableStreamController._pendingPullIntos.length>0&&uo(ft._readableStreamController,0),bn&&_n||Et(void 0)},_errorSteps:function(){Ot=!1}})}function ci(Tn,sn){mt($t)&&(U($t),Fn($t=Bn(Se)));var xn=sn?ft:lt,Ln=sn?lt:ft;tr($t,Tn,1,{_chunkSteps:function(Si){F(function(){Xt=!1,qt=!1;var Zi=sn?_n:bn;if(sn?bn:_n)Zi||ho(xn._readableStreamController,Si);else{var Gn=void 0;try{Gn=Ft(Si)}catch(Pi){return oi(xn._readableStreamController,Pi),oi(Ln._readableStreamController,Pi),void Et(Ci(Se,Pi))}Zi||ho(xn._readableStreamController,Si),Zn(Ln._readableStreamController,Gn)}Ot=!1,Xt?ki():qt&&Vn()})},_closeSteps:function(Si){Ot=!1;var Zi=sn?_n:bn,Gn=sn?bn:_n;Zi||Wi(xn._readableStreamController),Gn||Wi(Ln._readableStreamController),Si!==void 0&&(Zi||ho(xn._readableStreamController,Si),!Gn&&Ln._readableStreamController._pendingPullIntos.length>0&&uo(Ln._readableStreamController,0)),Zi&&Gn||Et(void 0)},_errorSteps:function(){Ot=!1}})}function ki(){if(Ot)return Xt=!0,S(void 0);Ot=!0;var Tn=Vo(lt._readableStreamController);return Tn===null?mi():ci(Tn._view,!1),S(void 0)}function Vn(){if(Ot)return qt=!0,S(void 0);Ot=!0;var Tn=Vo(ft._readableStreamController);return Tn===null?mi():ci(Tn._view,!0),S(void 0)}function Ki(Tn){if(bn=!0,Ne=Tn,_n){var sn=tt([Ne,Ze]),xn=Ci(Se,sn);Et(xn)}return yn}function jn(Tn){if(_n=!0,Ze=Tn,bn){var sn=tt([Ne,Ze]),xn=Ci(Se,sn);Et(xn)}return yn}function ao(){}return lt=ka(ao,ki,Ki),ft=ka(ao,Vn,jn),Fn($t),[lt,ft]}function Co(Se){return g(Se)&&Se.getReader!==void 0}function Vi(Se){return Co(Se)?ts(Se.getReader()):es(Se)}function es(Se){var Ne,Ze=et(Se,"async");function lt(){var Et;try{Et=it(Ze)}catch($t){return E($t)}return I(S(Et),function($t){if(!g($t))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(nt($t))wo(Ne._readableStreamController);else{var Ot=dt($t);qi(Ne._readableStreamController,Ot)}})}function ft(Et){var $t,Ot,Xt=Ze.iterator;try{$t=Fe(Xt,"return")}catch(qt){return E(qt)}if($t===void 0)return S(void 0);try{Ot=q($t,Xt,[Et])}catch(qt){return E(qt)}return I(S(Ot),function(qt){if(!g(qt))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return Ne=ti(v,lt,ft,0)}function ts(Se){var Ne;function Ze(){var ft;try{ft=Se.read()}catch(Et){return E(Et)}return I(ft,function(Et){if(!g(Et))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(Et.done)wo(Ne._readableStreamController);else{var $t=Et.value;qi(Ne._readableStreamController,$t)}})}function lt(ft){try{return S(Se.cancel(ft))}catch(Et){return E(Et)}}return Ne=ti(v,Ze,lt,0)}function Ls(Se,Ne){Le(Se,Ne);var Ze=Se,lt=Ze==null?void 0:Ze.autoAllocateChunkSize,ft=Ze==null?void 0:Ze.cancel,Et=Ze==null?void 0:Ze.pull,$t=Ze==null?void 0:Ze.start,Ot=Ze==null?void 0:Ze.type;return{autoAllocateChunkSize:lt===void 0?void 0:je(lt,"".concat(Ne," has member 'autoAllocateChunkSize' that")),cancel:ft===void 0?void 0:Rs(ft,Ze,"".concat(Ne," has member 'cancel' that")),pull:Et===void 0?void 0:wa(Et,Ze,"".concat(Ne," has member 'pull' that")),start:$t===void 0?void 0:pr($t,Ze,"".concat(Ne," has member 'start' that")),type:Ot===void 0?void 0:Wr(Ot,"".concat(Ne," has member 'type' that"))}}function Rs(Se,Ne,Ze){return le(Se,Ze),function(lt){return Y(Se,Ne,[lt])}}function wa(Se,Ne,Ze){return le(Se,Ze),function(lt){return Y(Se,Ne,[lt])}}function pr(Se,Ne,Ze){return le(Se,Ze),function(lt){return q(Se,Ne,[lt])}}function Wr(Se,Ne){if((Se="".concat(Se))!=="bytes")throw new TypeError("".concat(Ne," '").concat(Se,"' is not a valid enumeration value for ReadableStreamType"));return Se}function Ds(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.preventCancel;return{preventCancel:Boolean(Ze)}}function xa(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.preventAbort,lt=Se==null?void 0:Se.preventCancel,ft=Se==null?void 0:Se.preventClose,Et=Se==null?void 0:Se.signal;return Et!==void 0&&Xi(Et,"".concat(Ne," has member 'signal' that")),{preventAbort:Boolean(Ze),preventCancel:Boolean(lt),preventClose:Boolean(ft),signal:Et}}function Xi(Se,Ne){if(!za(Se))throw new TypeError("".concat(Ne," is not an AbortSignal."))}function Ca(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.readable;Ee(Ze,"readable","ReadableWritablePair"),Ge(Ze,"".concat(Ne," has member 'readable' that"));var lt=Se==null?void 0:Se.writable;return Ee(lt,"writable","ReadableWritablePair"),Oo(lt,"".concat(Ne," has member 'writable' that")),{readable:Ze,writable:lt}}Object.defineProperties(li.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),f(li.prototype.close,"close"),f(li.prototype.enqueue,"enqueue"),f(li.prototype.error,"error"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(li.prototype,n.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});var In=function(){function Se(Ne,Ze){Ne===void 0&&(Ne={}),Ze===void 0&&(Ze={}),Ne===void 0?Ne=null:ke(Ne,"First parameter");var lt=Io(Ze,"Second parameter"),ft=Ls(Ne,"First parameter");if(jr(this),ft.type==="bytes"){if(lt.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");ra(this,ft,Do(lt,0))}else{var Et=No(lt);wi(this,ft,Do(lt,1),Et)}}return Object.defineProperty(Se.prototype,"locked",{get:function(){if(!xi(this))throw ro("locked");return ai(this)},enumerable:!1,configurable:!0}),Se.prototype.cancel=function(Ne){return Ne===void 0&&(Ne=void 0),xi(this)?ai(this)?E(new TypeError("Cannot cancel a stream that already has a reader")):Ci(this,Ne):E(ro("cancel"))},Se.prototype.getReader=function(Ne){if(Ne===void 0&&(Ne=void 0),!xi(this))throw ro("getReader");return Ni(Ne,"First parameter").mode===void 0?Xe(this):Bn(this)},Se.prototype.pipeThrough=function(Ne,Ze){if(Ze===void 0&&(Ze={}),!xi(this))throw ro("pipeThrough");Ce(Ne,1,"pipeThrough");var lt=Ca(Ne,"First parameter"),ft=xa(Ze,"Second parameter");if(ai(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(fi(lt.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return O(dr(this,lt.writable,ft.preventClose,ft.preventAbort,ft.preventCancel,ft.signal)),lt.readable},Se.prototype.pipeTo=function(Ne,Ze){if(Ze===void 0&&(Ze={}),!xi(this))return E(ro("pipeTo"));if(Ne===void 0)return E("Parameter 1 is required in 'pipeTo'.");if(!fo(Ne))return E(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));var lt;try{lt=xa(Ze,"Second parameter")}catch(ft){return E(ft)}return ai(this)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):fi(Ne)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):dr(this,Ne,lt.preventClose,lt.preventAbort,lt.preventCancel,lt.signal)},Se.prototype.tee=function(){if(!xi(this))throw ro("tee");return tt(xo(this))},Se.prototype.values=function(Ne){if(Ne===void 0&&(Ne=void 0),!xi(this))throw ro("values");return Pt(this,Ds(Ne,"First parameter").preventCancel)},Se.prototype[Ue]=function(Ne){return this.values(Ne)},Se.from=function(Ne){return Vi(Ne)},Se}();function ti(Se,Ne,Ze,lt,ft){lt===void 0&&(lt=1),ft===void 0&&(ft=function(){return 1});var Et=Object.create(In.prototype);return jr(Et),fr(Et,Object.create(li.prototype),Se,Ne,Ze,lt,ft),Et}function ka(Se,Ne,Ze){var lt=Object.create(In.prototype);return jr(lt),ei(lt,Object.create(Cn.prototype),Se,Ne,Ze,0,void 0),lt}function jr(Se){Se._state="readable",Se._reader=void 0,Se._storedError=void 0,Se._disturbed=!1}function xi(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_readableStreamController")&&Se instanceof In}function ai(Se){return Se._reader!==void 0}function Ci(Se,Ne){if(Se._disturbed=!0,Se._state==="closed")return S(void 0);if(Se._state==="errored")return E(Se._storedError);gr(Se);var Ze=Se._reader;if(Ze!==void 0&&to(Ze)){var lt=Ze._readIntoRequests;Ze._readIntoRequests=new ne,lt.forEach(function(ft){ft._closeSteps(void 0)})}return I(Se._readableStreamController[fe](Ne),v)}function gr(Se){Se._state="closed";var Ne=Se._reader;if(Ne!==void 0&&(Ae(Ne),mt(Ne))){var Ze=Ne._readRequests;Ne._readRequests=new ne,Ze.forEach(function(lt){lt._closeSteps()})}}function mr(Se,Ne){Se._state="errored",Se._storedError=Ne;var Ze=Se._reader;Ze!==void 0&&(be(Ze,Ne),mt(Ze)?ot(Ze,Ne):Oa(Ze,Ne))}function ro(Se){return new TypeError("ReadableStream.prototype.".concat(Se," can only be used on a ReadableStream"))}function Kn(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.highWaterMark;return Ee(Ze,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Be(Ze)}}Object.defineProperties(In,{from:{enumerable:!0}}),Object.defineProperties(In.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),f(In.from,"from"),f(In.prototype.cancel,"cancel"),f(In.prototype.getReader,"getReader"),f(In.prototype.pipeThrough,"pipeThrough"),f(In.prototype.pipeTo,"pipeTo"),f(In.prototype.tee,"tee"),f(In.prototype.values,"values"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(In.prototype,n.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(In.prototype,Ue,{value:In.prototype.values,writable:!0,configurable:!0});var Ur=function(Se){return Se.byteLength};f(Ur,"size");var vr=function(){function Se(Ne){Ce(Ne,1,"ByteLengthQueuingStrategy"),Ne=Kn(Ne,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=Ne.highWaterMark}return Object.defineProperty(Se.prototype,"highWaterMark",{get:function(){if(!qr(this))throw Li("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"size",{get:function(){if(!qr(this))throw Li("size");return Ur},enumerable:!1,configurable:!0}),Se}();function Li(Se){return new TypeError("ByteLengthQueuingStrategy.prototype.".concat(Se," can only be used on a ByteLengthQueuingStrategy"))}function qr(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_byteLengthQueuingStrategyHighWaterMark")&&Se instanceof vr}Object.defineProperties(vr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(vr.prototype,n.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});var yr=function(){return 1};f(yr,"size");var Ii=function(){function Se(Ne){Ce(Ne,1,"CountQueuingStrategy"),Ne=Kn(Ne,"First parameter"),this._countQueuingStrategyHighWaterMark=Ne.highWaterMark}return Object.defineProperty(Se.prototype,"highWaterMark",{get:function(){if(!ni(this))throw Sa("highWaterMark");return this._countQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"size",{get:function(){if(!ni(this))throw Sa("size");return yr},enumerable:!1,configurable:!0}),Se}();function Sa(Se){return new TypeError("CountQueuingStrategy.prototype.".concat(Se," can only be used on a CountQueuingStrategy"))}function ni(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_countQueuingStrategyHighWaterMark")&&Se instanceof Ii}function Pa(Se,Ne){Le(Se,Ne);var Ze=Se==null?void 0:Se.cancel,lt=Se==null?void 0:Se.flush,ft=Se==null?void 0:Se.readableType,Et=Se==null?void 0:Se.start,$t=Se==null?void 0:Se.transform,Ot=Se==null?void 0:Se.writableType;return{cancel:Ze===void 0?void 0:_r(Ze,Se,"".concat(Ne," has member 'cancel' that")),flush:lt===void 0?void 0:Ns(lt,Se,"".concat(Ne," has member 'flush' that")),readableType:ft,start:Et===void 0?void 0:Is(Et,Se,"".concat(Ne," has member 'start' that")),transform:$t===void 0?void 0:Ea($t,Se,"".concat(Ne," has member 'transform' that")),writableType:Ot}}function Ns(Se,Ne,Ze){return le(Se,Ze),function(lt){return Y(Se,Ne,[lt])}}function Is(Se,Ne,Ze){return le(Se,Ze),function(lt){return q(Se,Ne,[lt])}}function Ea(Se,Ne,Ze){return le(Se,Ze),function(lt,ft){return Y(Se,Ne,[lt,ft])}}function _r(Se,Ne,Ze){return le(Se,Ze),function(lt){return Y(Se,Ne,[lt])}}Object.defineProperties(Ii.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(Ii.prototype,n.toStringTag,{value:"CountQueuingStrategy",configurable:!0});var br=function(){function Se(Ne,Ze,lt){Ne===void 0&&(Ne={}),Ze===void 0&&(Ze={}),lt===void 0&&(lt={}),Ne===void 0&&(Ne=null);var ft=Io(Ze,"Second parameter"),Et=Io(lt,"Third parameter"),$t=Pa(Ne,"First parameter");if($t.readableType!==void 0)throw new RangeError("Invalid readableType specified");if($t.writableType!==void 0)throw new RangeError("Invalid writableType specified");var Ot,Xt=Do(Et,0),qt=No(Et),bn=Do(ft,1),_n=No(ft);wr(this,P(function(yn){Ot=yn}),bn,_n,Xt,qt),is(this,$t),$t.start!==void 0?Ot($t.start(this._transformStreamController)):Ot(void 0)}return Object.defineProperty(Se.prototype,"readable",{get:function(){if(!Gr(this))throw as("readable");return this._readable},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"writable",{get:function(){if(!Gr(this))throw as("writable");return this._writable},enumerable:!1,configurable:!0}),Se}();function wr(Se,Ne,Ze,lt,ft,Et){function $t(){return Ne}function Ot(yn){return rs(Se,yn)}function Xt(yn){return Ba(Se,yn)}function qt(){return Va(Se)}function bn(){return mn(Se)}function _n(yn){return Os(Se,yn)}Se._writable=Fo($t,Ot,qt,Xt,Ze,lt),Se._readable=ti($t,bn,_n,ft,Et),Se._backpressure=void 0,Se._backpressureChangePromise=void 0,Se._backpressureChangePromise_resolve=void 0,Xr(Se,!0),Se._transformStreamController=void 0}function Gr(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_transformStreamController")&&Se instanceof br}function Aa(Se,Ne){ri(Se._readable._readableStreamController,Ne),Yr(Se,Ne)}function Yr(Se,Ne){ko(Se._transformStreamController),jo(Se._writable._writableStreamController,Ne),xr(Se)}function xr(Se){Se._backpressure&&Xr(Se,!1)}function Xr(Se,Ne){Se._backpressureChangePromise!==void 0&&Se._backpressureChangePromise_resolve(),Se._backpressureChangePromise=P(function(Ze){Se._backpressureChangePromise_resolve=Ze}),Se._backpressure=Ne}Object.defineProperties(br.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(br.prototype,n.toStringTag,{value:"TransformStream",configurable:!0});var Oi=function(){function Se(){throw new TypeError("Illegal constructor")}return Object.defineProperty(Se.prototype,"desiredSize",{get:function(){if(!Cr(this))throw Kr("desiredSize");return zr(this._controlledTransformStream._readable._readableStreamController)},enumerable:!1,configurable:!0}),Se.prototype.enqueue=function(Ne){if(Ne===void 0&&(Ne=void 0),!Cr(this))throw Kr("enqueue");Ma(this,Ne)},Se.prototype.error=function(Ne){if(Ne===void 0&&(Ne=void 0),!Cr(this))throw Kr("error");os(this,Ne)},Se.prototype.terminate=function(){if(!Cr(this))throw Kr("terminate");Ta(this)},Se}();function Cr(Se){return!!g(Se)&&!!Object.prototype.hasOwnProperty.call(Se,"_controlledTransformStream")&&Se instanceof Oi}function ns(Se,Ne,Ze,lt,ft){Ne._controlledTransformStream=Se,Se._transformStreamController=Ne,Ne._transformAlgorithm=Ze,Ne._flushAlgorithm=lt,Ne._cancelAlgorithm=ft,Ne._finishPromise=void 0,Ne._finishPromise_resolve=void 0,Ne._finishPromise_reject=void 0}function is(Se,Ne){var Ze,lt,ft,Et=Object.create(Oi.prototype);Ze=Ne.transform!==void 0?function($t){return Ne.transform($t,Et)}:function($t){try{return Ma(Et,$t),S(void 0)}catch(Ot){return E(Ot)}},lt=Ne.flush!==void 0?function(){return Ne.flush(Et)}:function(){return S(void 0)},ft=Ne.cancel!==void 0?function($t){return Ne.cancel($t)}:function(){return S(void 0)},ns(Se,Et,Ze,lt,ft)}function ko(Se){Se._transformAlgorithm=void 0,Se._flushAlgorithm=void 0,Se._cancelAlgorithm=void 0}function Ma(Se,Ne){var Ze=Se._controlledTransformStream,lt=Ze._readable._readableStreamController;if(!Bi(lt))throw new TypeError("Readable side is not in a state that permits enqueue");try{qi(lt,Ne)}catch(ft){throw Yr(Ze,ft),Ze._readable._storedError}at(lt)!==Ze._backpressure&&Xr(Ze,!0)}function os(Se,Ne){Aa(Se._controlledTransformStream,Ne)}function $a(Se,Ne){return I(Se._transformAlgorithm(Ne),void 0,function(Ze){throw Aa(Se._controlledTransformStream,Ze),Ze})}function Ta(Se){var Ne=Se._controlledTransformStream;wo(Ne._readable._readableStreamController),Yr(Ne,new TypeError("TransformStream terminated"))}function rs(Se,Ne){var Ze=Se._transformStreamController;return Se._backpressure?I(Se._backpressureChangePromise,function(){var lt=Se._writable;if(lt._state==="erroring")throw lt._storedError;return $a(Ze,Ne)}):$a(Ze,Ne)}function Ba(Se,Ne){var Ze=Se._transformStreamController;if(Ze._finishPromise!==void 0)return Ze._finishPromise;var lt=Se._readable;Ze._finishPromise=P(function(Et,$t){Ze._finishPromise_resolve=Et,Ze._finishPromise_reject=$t});var ft=Ze._cancelAlgorithm(Ne);return ko(Ze),T(ft,function(){return lt._state==="errored"?Po(Ze,lt._storedError):(ri(lt._readableStreamController,Ne),So(Ze)),null},function(Et){return ri(lt._readableStreamController,Et),Po(Ze,Et),null}),Ze._finishPromise}function Va(Se){var Ne=Se._transformStreamController;if(Ne._finishPromise!==void 0)return Ne._finishPromise;var Ze=Se._readable;Ne._finishPromise=P(function(ft,Et){Ne._finishPromise_resolve=ft,Ne._finishPromise_reject=Et});var lt=Ne._flushAlgorithm();return ko(Ne),T(lt,function(){return Ze._state==="errored"?Po(Ne,Ze._storedError):(wo(Ze._readableStreamController),So(Ne)),null},function(ft){return ri(Ze._readableStreamController,ft),Po(Ne,ft),null}),Ne._finishPromise}function mn(Se){return Xr(Se,!1),Se._backpressureChangePromise}function Os(Se,Ne){var Ze=Se._transformStreamController;if(Ze._finishPromise!==void 0)return Ze._finishPromise;var lt=Se._writable;Ze._finishPromise=P(function(Et,$t){Ze._finishPromise_resolve=Et,Ze._finishPromise_reject=$t});var ft=Ze._cancelAlgorithm(Ne);return ko(Ze),T(ft,function(){return lt._state==="errored"?Po(Ze,lt._storedError):(jo(lt._writableStreamController,Ne),xr(Se),So(Ze)),null},function(Et){return jo(lt._writableStreamController,Et),xr(Se),Po(Ze,Et),null}),Ze._finishPromise}function Kr(Se){return new TypeError("TransformStreamDefaultController.prototype.".concat(Se," can only be used on a TransformStreamDefaultController"))}function So(Se){Se._finishPromise_resolve!==void 0&&(Se._finishPromise_resolve(),Se._finishPromise_resolve=void 0,Se._finishPromise_reject=void 0)}function Po(Se,Ne){Se._finishPromise_reject!==void 0&&(O(Se._finishPromise),Se._finishPromise_reject(Ne),Se._finishPromise_resolve=void 0,Se._finishPromise_reject=void 0)}function as(Se){return new TypeError("TransformStream.prototype.".concat(Se," can only be used on a TransformStream"))}Object.defineProperties(Oi.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),f(Oi.prototype.enqueue,"enqueue"),f(Oi.prototype.error,"error"),f(Oi.prototype.terminate,"terminate"),_typeof$1(n.toStringTag)==="symbol"&&Object.defineProperty(Oi.prototype,n.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=vr,e.CountQueuingStrategy=Ii,e.ReadableByteStreamController=Cn,e.ReadableStream=In,e.ReadableStreamBYOBReader=eo,e.ReadableStreamBYOBRequest=en,e.ReadableStreamDefaultController=li,e.ReadableStreamDefaultReader=kt,e.TransformStream=br,e.TransformStreamDefaultController=Oi,e.WritableStream=no,e.WritableStreamDefaultController=Ui,e.WritableStreamDefaultWriter=Ti}(ponyfillExports)),ponyfillExports}(function(module,exports){var factory;factory=function(){return function(){var __webpack_modules__=[,function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=function(O,F){O||m(F)},n.bytesToString=function(O){_typeof$1(O)==="object"&&O!==null&&O.length!==void 0||m("Invalid argument for bytesToString");var F=O.length,q=8192;if(F<q)return String.fromCharCode.apply(null,O);for(var Y=[],_e=0;_e<F;_e+=q){var ne=Math.min(_e+q,F),ve=O.subarray(_e,ne);Y.push(String.fromCharCode.apply(null,ve))}return Y.join("")},n.createPromiseCapability=function(){var O=Object.create(null),F=!1;return Object.defineProperty(O,"settled",{get:function(){return F}}),O.promise=new Promise(function(q,Y){O.resolve=function(_e){F=!0,q(_e)},O.reject=function(_e){F=!0,Y(_e)}}),O},n.createValidAbsoluteUrl=function(O){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!O)return null;try{if(q&&typeof O=="string"){if(q.addDefaultProtocol&&O.startsWith("www.")){var Y=O.match(/\./g);Y&&Y.length>=2&&(O="http://".concat(O))}if(q.tryConvertEncoding)try{O=I(O)}catch{}}var _e=F?new URL(O,F):new URL(O);if(function(ne){if(!ne)return!1;switch(ne.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(_e))return _e}catch{}return null},n.getModificationDate=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[O.getUTCFullYear().toString(),(O.getUTCMonth()+1).toString().padStart(2,"0"),O.getUTCDate().toString().padStart(2,"0"),O.getUTCHours().toString().padStart(2,"0"),O.getUTCMinutes().toString().padStart(2,"0"),O.getUTCSeconds().toString().padStart(2,"0")].join("")},n.getVerbosityLevel=function(){return s},n.info=function(O){s>=u.INFOS&&console.log("Info: ".concat(O))},n.isArrayBuffer=function(O){return _typeof$1(O)==="object"&&O!==null&&O.byteLength!==void 0},n.isArrayEqual=function(O,F){if(O.length!==F.length)return!1;for(var q=0,Y=O.length;q<Y;q++)if(O[q]!==F[q])return!1;return!0},n.objectFromMap=function(O){var F,q=Object.create(null),Y=_createForOfIteratorHelper(O);try{for(Y.s();!(F=Y.n()).done;){var _e=_slicedToArray(F.value,2),ne=_e[0],ve=_e[1];q[ne]=ve}}catch(J){Y.e(J)}finally{Y.f()}return q},n.objectSize=function(O){return Object.keys(O).length},n.setVerbosityLevel=function(O){Number.isInteger(O)&&(s=O)},n.shadow=v,n.string32=function(O){return String.fromCharCode(O>>24&255,O>>16&255,O>>8&255,255&O)},n.stringToBytes=E,n.stringToPDFString=function(O){var F;if(O[0]>="\xEF"&&(O[0]==="\xFE"&&O[1]==="\xFF"?F="utf-16be":O[0]==="\xFF"&&O[1]==="\xFE"?F="utf-16le":O[0]==="\xEF"&&O[1]==="\xBB"&&O[2]==="\xBF"&&(F="utf-8"),F))try{var q=new TextDecoder(F,{fatal:!0}),Y=E(O);return q.decode(Y)}catch(fe){w('stringToPDFString: "'.concat(fe,'".'))}for(var _e=[],ne=0,ve=O.length;ne<ve;ne++){var J=N[O.charCodeAt(ne)];_e.push(J?String.fromCharCode(J):O.charAt(ne))}return _e.join("")},n.stringToUTF8String=I,n.unreachable=m,n.utf8StringToString=function(O){return unescape(encodeURIComponent(O))},n.warn=w,globalThis._pdfjsCompatibilityChecked||(globalThis._pdfjsCompatibilityChecked=!0,o(2)),n.IDENTITY_MATRIX=[1,0,0,1,0,0],n.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],n.MAX_IMAGE_SIZE_TO_CACHE=1e7,n.LINE_FACTOR=1.35,n.LINE_DESCENT_FACTOR=.35;var r=.35/1.35;n.BASELINE_FACTOR=r,n.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},n.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},n.AnnotationEditorPrefix="pdfjs_internal_editor_",n.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},n.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},n.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},n.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},n.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},n.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},n.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},n.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},n.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},n.AnnotationReplyType={GROUP:"Group",REPLY:"R"},n.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},n.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},n.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},n.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},n.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},n.PageActionEventType={O:"PageOpen",C:"PageClose"};var u={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=u,n.CMapCompressionType={NONE:0,BINARY:1},n.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},n.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var s=u.WARNINGS;function w(O){s>=u.WARNINGS&&console.log("Warning: ".concat(O))}function m(O){throw new Error(O)}function v(O,F,q){var Y=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return Object.defineProperty(O,F,{value:q,enumerable:!Y,configurable:!0,writable:!1}),q}var g=function(){function O(F,q){this.constructor===O&&m("Cannot initialize BaseException."),this.message=F,this.name=q}return O.prototype=new Error,O.constructor=O,O}();n.BaseException=g;var d=function(O){function F(q,Y){var _e;return _classCallCheck(this,F),(_e=_callSuper(this,F,[q,"PasswordException"])).code=Y,_e}return _inherits(F,O),_createClass(F)}(g);n.PasswordException=d;var f=function(O){function F(q,Y){var _e;return _classCallCheck(this,F),(_e=_callSuper(this,F,[q,"UnknownErrorException"])).details=Y,_e}return _inherits(F,O),_createClass(F)}(g);n.UnknownErrorException=f;var y=function(O){function F(q){return _classCallCheck(this,F),_callSuper(this,F,[q,"InvalidPDFException"])}return _inherits(F,O),_createClass(F)}(g);n.InvalidPDFException=y;var x=function(O){function F(q){return _classCallCheck(this,F),_callSuper(this,F,[q,"MissingPDFException"])}return _inherits(F,O),_createClass(F)}(g);n.MissingPDFException=x;var k=function(O){function F(q,Y){var _e;return _classCallCheck(this,F),(_e=_callSuper(this,F,[q,"UnexpectedResponseException"])).status=Y,_e}return _inherits(F,O),_createClass(F)}(g);n.UnexpectedResponseException=k;var P=function(O){function F(q){return _classCallCheck(this,F),_callSuper(this,F,[q,"FormatError"])}return _inherits(F,O),_createClass(F)}(g);n.FormatError=P;var S=function(O){function F(q){return _classCallCheck(this,F),_callSuper(this,F,[q,"AbortException"])}return _inherits(F,O),_createClass(F)}(g);function E(O){typeof O!="string"&&m("Invalid argument for stringToBytes");for(var F=O.length,q=new Uint8Array(F),Y=0;Y<F;++Y)q[Y]=255&O.charCodeAt(Y);return q}n.AbortException=S;var M=function(){return _createClass(function O(){_classCallCheck(this,O)},null,[{key:"isLittleEndian",get:function(){return v(this,"isLittleEndian",((O=new Uint8Array(4))[0]=1,new Uint32Array(O.buffer,0,1)[0]===1));var O}},{key:"isEvalSupported",get:function(){return v(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}},{key:"isOffscreenCanvasSupported",get:function(){return v(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}},{key:"platform",get:function(){return typeof navigator>"u"?v(this,"platform",{isWin:!1,isMac:!1}):v(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}])}();n.FeatureTest=M;var T=_toConsumableArray$1(Array(256).keys()).map(function(O){return O.toString(16).padStart(2,"0")}),D=function(){function O(){_classCallCheck(this,O)}return _createClass(O,null,[{key:"makeHexColor",value:function(F,q,Y){return"#".concat(T[F]).concat(T[q]).concat(T[Y])}},{key:"scaleMinMax",value:function(F,q){var Y;F[0]?(F[0]<0&&(Y=q[0],q[0]=q[1],q[1]=Y),q[0]*=F[0],q[1]*=F[0],F[3]<0&&(Y=q[2],q[2]=q[3],q[3]=Y),q[2]*=F[3],q[3]*=F[3]):(Y=q[0],q[0]=q[2],q[2]=Y,Y=q[1],q[1]=q[3],q[3]=Y,F[1]<0&&(Y=q[2],q[2]=q[3],q[3]=Y),q[2]*=F[1],q[3]*=F[1],F[2]<0&&(Y=q[0],q[0]=q[1],q[1]=Y),q[0]*=F[2],q[1]*=F[2]),q[0]+=F[4],q[1]+=F[4],q[2]+=F[5],q[3]+=F[5]}},{key:"transform",value:function(F,q){return[F[0]*q[0]+F[2]*q[1],F[1]*q[0]+F[3]*q[1],F[0]*q[2]+F[2]*q[3],F[1]*q[2]+F[3]*q[3],F[0]*q[4]+F[2]*q[5]+F[4],F[1]*q[4]+F[3]*q[5]+F[5]]}},{key:"applyTransform",value:function(F,q){return[F[0]*q[0]+F[1]*q[2]+q[4],F[0]*q[1]+F[1]*q[3]+q[5]]}},{key:"applyInverseTransform",value:function(F,q){var Y=q[0]*q[3]-q[1]*q[2];return[(F[0]*q[3]-F[1]*q[2]+q[2]*q[5]-q[4]*q[3])/Y,(-F[0]*q[1]+F[1]*q[0]+q[4]*q[1]-q[5]*q[0])/Y]}},{key:"getAxialAlignedBoundingBox",value:function(F,q){var Y=O.applyTransform(F,q),_e=O.applyTransform(F.slice(2,4),q),ne=O.applyTransform([F[0],F[3]],q),ve=O.applyTransform([F[2],F[1]],q);return[Math.min(Y[0],_e[0],ne[0],ve[0]),Math.min(Y[1],_e[1],ne[1],ve[1]),Math.max(Y[0],_e[0],ne[0],ve[0]),Math.max(Y[1],_e[1],ne[1],ve[1])]}},{key:"inverseTransform",value:function(F){var q=F[0]*F[3]-F[1]*F[2];return[F[3]/q,-F[1]/q,-F[2]/q,F[0]/q,(F[2]*F[5]-F[4]*F[3])/q,(F[4]*F[1]-F[5]*F[0])/q]}},{key:"singularValueDecompose2dScale",value:function(F){var q=[F[0],F[2],F[1],F[3]],Y=F[0]*q[0]+F[1]*q[2],_e=F[0]*q[1]+F[1]*q[3],ne=F[2]*q[0]+F[3]*q[2],ve=F[2]*q[1]+F[3]*q[3],J=(Y+ve)/2,fe=Math.sqrt(Math.pow(Y+ve,2)-4*(Y*ve-ne*_e))/2,Z=J+fe||1,j=J-fe||1;return[Math.sqrt(Z),Math.sqrt(j)]}},{key:"normalizeRect",value:function(F){var q=F.slice(0);return F[0]>F[2]&&(q[0]=F[2],q[2]=F[0]),F[1]>F[3]&&(q[1]=F[3],q[3]=F[1]),q}},{key:"intersect",value:function(F,q){var Y=Math.max(Math.min(F[0],F[2]),Math.min(q[0],q[2])),_e=Math.min(Math.max(F[0],F[2]),Math.max(q[0],q[2]));if(Y>_e)return null;var ne=Math.max(Math.min(F[1],F[3]),Math.min(q[1],q[3])),ve=Math.min(Math.max(F[1],F[3]),Math.max(q[1],q[3]));return ne>ve?null:[Y,ne,_e,ve]}},{key:"bezierBoundingBox",value:function(F,q,Y,_e,ne,ve,J,fe){for(var Z,j,X,H,U,te,Q,re,Pe=[],be=[[],[]],we=0;we<2;++we)if(we===0?(j=6*F-12*Y+6*ne,Z=-3*F+9*Y-9*ne+3*J,X=3*Y-3*F):(j=6*q-12*_e+6*ve,Z=-3*q+9*_e-9*ve+3*fe,X=3*_e-3*q),Math.abs(Z)<1e-12){if(Math.abs(j)<1e-12)continue;0<(H=-X/j)&&H<1&&Pe.push(H)}else Q=j*j-4*X*Z,re=Math.sqrt(Q),Q<0||(0<(U=(-j+re)/(2*Z))&&U<1&&Pe.push(U),0<(te=(-j-re)/(2*Z))&&te<1&&Pe.push(te));for(var Ae,$e=Pe.length,Me=$e;$e--;)Ae=1-(H=Pe[$e]),be[0][$e]=Ae*Ae*Ae*F+3*Ae*Ae*H*Y+3*Ae*H*H*ne+H*H*H*J,be[1][$e]=Ae*Ae*Ae*q+3*Ae*Ae*H*_e+3*Ae*H*H*ve+H*H*H*fe;return be[0][Me]=F,be[1][Me]=q,be[0][Me+1]=J,be[1][Me+1]=fe,be[0].length=be[1].length=Me+2,[Math.min.apply(Math,_toConsumableArray$1(be[0])),Math.min.apply(Math,_toConsumableArray$1(be[1])),Math.max.apply(Math,_toConsumableArray$1(be[0])),Math.max.apply(Math,_toConsumableArray$1(be[1]))]}}])}();n.Util=D;var N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function I(O){return decodeURIComponent(escape(O))}},function(e,n,o){var r=o(3);!globalThis.DOMMatrix&&r.isNodeJS&&(globalThis.DOMMatrix=require$$0.DOMMatrix),function(){if(!globalThis.Path2D&&r.isNodeJS){var u=require$$0.CanvasRenderingContext2D,s=requirePath2dPolyfill_esm().polyfillPath2D;globalThis.CanvasRenderingContext2D=u,s(globalThis)}}(),!globalThis.ReadableStream&&r.isNodeJS&&(globalThis.ReadableStream=requirePonyfill().ReadableStream),Array.prototype.at||o(4),Uint8Array.prototype.at||o(78),globalThis.structuredClone||o(90)},function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;var o=!((typeof process>"u"?"undefined":_typeof$1(process))!=="object"||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=o},function(e,n,o){o(5);var r=o(77);e.exports=r("Array","at")},function(e,n,o){var r=o(6),u=o(43),s=o(67),w=o(65),m=o(72);r({target:"Array",proto:!0},{at:function(v){var g=u(this),d=s(g),f=w(v),y=f>=0?f:d+f;return y<0||y>=d?void 0:g[y]}}),m("at")},function(e,n,o){var r=o(7),u=o(8).f,s=o(47),w=o(51),m=o(41),v=o(59),g=o(71);e.exports=function(d,f){var y,x,k,P,S,E=d.target,M=d.global,T=d.stat;if(y=M?r:T?r[E]||m(E,{}):(r[E]||{}).prototype)for(x in f){if(P=f[x],k=d.dontCallGetSet?(S=u(y,x))&&S.value:y[x],!g(M?x:E+(T?".":"#")+x,d.forced)&&k!==void 0){if(_typeof$1(P)==_typeof$1(k))continue;v(P,k)}(d.sham||k&&k.sham)&&s(P,"sham",!0),w(y,x,P,d)}}},function(e){var n=function(o){return o&&o.Math==Math&&o};e.exports=n((typeof globalThis>"u"?"undefined":_typeof$1(globalThis))=="object"&&globalThis)||n((typeof window>"u"?"undefined":_typeof$1(window))=="object"&&window)||n((typeof self>"u"?"undefined":_typeof$1(self))=="object"&&self)||n(_typeof$1(commonjsGlobal$1)=="object"&&commonjsGlobal$1)||function(){return this}()||Function("return this")()},function(e,n,o){var r=o(9),u=o(11),s=o(13),w=o(14),m=o(15),v=o(21),g=o(42),d=o(45),f=Object.getOwnPropertyDescriptor;n.f=r?f:function(y,x){if(y=m(y),x=v(x),d)try{return f(y,x)}catch{}if(g(y,x))return w(!u(s.f,y,x),y[x])}},function(e,n,o){var r=o(10);e.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(e){e.exports=function(n){try{return!!n()}catch{return!0}}},function(e,n,o){var r=o(12),u=Function.prototype.call;e.exports=r?u.bind(u):function(){return u.apply(u,arguments)}},function(e,n,o){var r=o(10);e.exports=!r(function(){var u=function(){}.bind();return typeof u!="function"||u.hasOwnProperty("prototype")})},function(e,n){var o={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,u=r&&!o.call({1:2},1);n.f=u?function(s){var w=r(this,s);return!!w&&w.enumerable}:o},function(e){e.exports=function(n,o){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:o}}},function(e,n,o){var r=o(16),u=o(19);e.exports=function(s){return r(u(s))}},function(e,n,o){var r=o(17),u=o(10),s=o(18),w=Object,m=r("".split);e.exports=u(function(){return!w("z").propertyIsEnumerable(0)})?function(v){return s(v)=="String"?m(v,""):w(v)}:w},function(e,n,o){var r=o(12),u=Function.prototype,s=u.call,w=r&&u.bind.bind(s,s);e.exports=r?w:function(m){return function(){return s.apply(m,arguments)}}},function(e,n,o){var r=o(17),u=r({}.toString),s=r("".slice);e.exports=function(w){return s(u(w),8,-1)}},function(e,n,o){var r=o(20),u=TypeError;e.exports=function(s){if(r(s))throw u("Can't call method on "+s);return s}},function(e){e.exports=function(n){return n==null}},function(e,n,o){var r=o(22),u=o(26);e.exports=function(s){var w=r(s,"string");return u(w)?w:w+""}},function(e,n,o){var r=o(11),u=o(23),s=o(26),w=o(33),m=o(36),v=o(37),g=TypeError,d=v("toPrimitive");e.exports=function(f,y){if(!u(f)||s(f))return f;var x,k=w(f,d);if(k){if(y===void 0&&(y="default"),x=r(k,f,y),!u(x)||s(x))return x;throw g("Can't convert object to primitive value")}return y===void 0&&(y="number"),m(f,y)}},function(e,n,o){var r=o(24),u=o(25),s=u.all;e.exports=u.IS_HTMLDDA?function(w){return _typeof$1(w)=="object"?w!==null:r(w)||w===s}:function(w){return _typeof$1(w)=="object"?w!==null:r(w)}},function(e,n,o){var r=o(25),u=r.all;e.exports=r.IS_HTMLDDA?function(s){return typeof s=="function"||s===u}:function(s){return typeof s=="function"}},function(e){var n=(typeof document>"u"?"undefined":_typeof$1(document))=="object"&&document.all,o=n===void 0&&n!==void 0;e.exports={all:n,IS_HTMLDDA:o}},function(e,n,o){var r=o(27),u=o(24),s=o(28),w=o(29),m=Object;e.exports=w?function(v){return _typeof$1(v)=="symbol"}:function(v){var g=r("Symbol");return u(g)&&s(g.prototype,m(v))}},function(e,n,o){var r=o(7),u=o(24);e.exports=function(s,w){return arguments.length<2?(m=r[s],u(m)?m:void 0):r[s]&&r[s][w];var m}},function(e,n,o){var r=o(17);e.exports=r({}.isPrototypeOf)},function(e,n,o){var r=o(30);e.exports=r&&!Symbol.sham&&_typeof$1(Symbol.iterator)=="symbol"},function(e,n,o){var r=o(31),u=o(10);e.exports=!!Object.getOwnPropertySymbols&&!u(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&r&&r<41})},function(e,n,o){var r,u,s=o(7),w=o(32),m=s.process,v=s.Deno,g=m&&m.versions||v&&v.version,d=g&&g.v8;d&&(u=(r=d.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!u&&w&&(!(r=w.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=w.match(/Chrome\/(\d+)/))&&(u=+r[1]),e.exports=u},function(e){e.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},function(e,n,o){var r=o(34),u=o(20);e.exports=function(s,w){var m=s[w];return u(m)?void 0:r(m)}},function(e,n,o){var r=o(24),u=o(35),s=TypeError;e.exports=function(w){if(r(w))return w;throw s(u(w)+" is not a function")}},function(e){var n=String;e.exports=function(o){try{return n(o)}catch{return"Object"}}},function(e,n,o){var r=o(11),u=o(24),s=o(23),w=TypeError;e.exports=function(m,v){var g,d;if(v==="string"&&u(g=m.toString)&&!s(d=r(g,m))||u(g=m.valueOf)&&!s(d=r(g,m))||v!=="string"&&u(g=m.toString)&&!s(d=r(g,m)))return d;throw w("Can't convert object to primitive value")}},function(e,n,o){var r=o(7),u=o(38),s=o(42),w=o(44),m=o(30),v=o(29),g=r.Symbol,d=u("wks"),f=v?g.for||g:g&&g.withoutSetter||w;e.exports=function(y){return s(d,y)||(d[y]=m&&s(g,y)?g[y]:f("Symbol."+y)),d[y]}},function(e,n,o){var r=o(39),u=o(40);(e.exports=function(s,w){return u[s]||(u[s]=w!==void 0?w:{})})("versions",[]).push({version:"3.29.1",mode:r?"pure":"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e){e.exports=!1},function(e,n,o){var r=o(7),u=o(41),s="__core-js_shared__",w=r[s]||u(s,{});e.exports=w},function(e,n,o){var r=o(7),u=Object.defineProperty;e.exports=function(s,w){try{u(r,s,{value:w,configurable:!0,writable:!0})}catch{r[s]=w}return w}},function(e,n,o){var r=o(17),u=o(43),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(w,m){return s(u(w),m)}},function(e,n,o){var r=o(19),u=Object;e.exports=function(s){return u(r(s))}},function(e,n,o){var r=o(17),u=0,s=Math.random(),w=r(1 .toString);e.exports=function(m){return"Symbol("+(m===void 0?"":m)+")_"+w(++u+s,36)}},function(e,n,o){var r=o(9),u=o(10),s=o(46);e.exports=!r&&!u(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7})},function(e,n,o){var r=o(7),u=o(23),s=r.document,w=u(s)&&u(s.createElement);e.exports=function(m){return w?s.createElement(m):{}}},function(e,n,o){var r=o(9),u=o(48),s=o(14);e.exports=r?function(w,m,v){return u.f(w,m,s(1,v))}:function(w,m,v){return w[m]=v,w}},function(e,n,o){var r=o(9),u=o(45),s=o(49),w=o(50),m=o(21),v=TypeError,g=Object.defineProperty,d=Object.getOwnPropertyDescriptor,f="enumerable",y="configurable",x="writable";n.f=r?s?function(k,P,S){if(w(k),P=m(P),w(S),typeof k=="function"&&P==="prototype"&&"value"in S&&x in S&&!S[x]){var E=d(k,P);E&&E[x]&&(k[P]=S.value,S={configurable:y in S?S[y]:E[y],enumerable:f in S?S[f]:E[f],writable:!1})}return g(k,P,S)}:g:function(k,P,S){if(w(k),P=m(P),w(S),u)try{return g(k,P,S)}catch{}if("get"in S||"set"in S)throw v("Accessors not supported");return"value"in S&&(k[P]=S.value),k}},function(e,n,o){var r=o(9),u=o(10);e.exports=r&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(e,n,o){var r=o(23),u=String,s=TypeError;e.exports=function(w){if(r(w))return w;throw s(u(w)+" is not an object")}},function(e,n,o){var r=o(24),u=o(48),s=o(52),w=o(41);e.exports=function(m,v,g,d){d||(d={});var f=d.enumerable,y=d.name!==void 0?d.name:v;if(r(g)&&s(g,y,d),d.global)f?m[v]=g:w(v,g);else{try{d.unsafe?m[v]&&(f=!0):delete m[v]}catch{}f?m[v]=g:u.f(m,v,{value:g,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return m}},function(e,n,o){var r=o(17),u=o(10),s=o(24),w=o(42),m=o(9),v=o(53).CONFIGURABLE,g=o(54),d=o(55),f=d.enforce,y=d.get,x=String,k=Object.defineProperty,P=r("".slice),S=r("".replace),E=r([].join),M=m&&!u(function(){return k(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),D=e.exports=function(N,I,O){P(x(I),0,7)==="Symbol("&&(I="["+S(x(I),/^Symbol\(([^)]*)\)/,"$1")+"]"),O&&O.getter&&(I="get "+I),O&&O.setter&&(I="set "+I),(!w(N,"name")||v&&N.name!==I)&&(m?k(N,"name",{value:I,configurable:!0}):N.name=I),M&&O&&w(O,"arity")&&N.length!==O.arity&&k(N,"length",{value:O.arity});try{O&&w(O,"constructor")&&O.constructor?m&&k(N,"prototype",{writable:!1}):N.prototype&&(N.prototype=void 0)}catch{}var F=f(N);return w(F,"source")||(F.source=E(T,typeof I=="string"?I:"")),N};Function.prototype.toString=D(function(){return s(this)&&y(this).source||g(this)},"toString")},function(e,n,o){var r=o(9),u=o(42),s=Function.prototype,w=r&&Object.getOwnPropertyDescriptor,m=u(s,"name"),v=m&&function(){}.name==="something",g=m&&(!r||r&&w(s,"name").configurable);e.exports={EXISTS:m,PROPER:v,CONFIGURABLE:g}},function(e,n,o){var r=o(17),u=o(24),s=o(40),w=r(Function.toString);u(s.inspectSource)||(s.inspectSource=function(m){return w(m)}),e.exports=s.inspectSource},function(e,n,o){var r,u,s,w=o(56),m=o(7),v=o(23),g=o(47),d=o(42),f=o(40),y=o(57),x=o(58),k="Object already initialized",P=m.TypeError,S=m.WeakMap;if(w||f.state){var E=f.state||(f.state=new S);E.get=E.get,E.has=E.has,E.set=E.set,r=function(T,D){if(E.has(T))throw P(k);return D.facade=T,E.set(T,D),D},u=function(T){return E.get(T)||{}},s=function(T){return E.has(T)}}else{var M=y("state");x[M]=!0,r=function(T,D){if(d(T,M))throw P(k);return D.facade=T,g(T,M,D),D},u=function(T){return d(T,M)?T[M]:{}},s=function(T){return d(T,M)}}e.exports={set:r,get:u,has:s,enforce:function(T){return s(T)?u(T):r(T,{})},getterFor:function(T){return function(D){var N;if(!v(D)||(N=u(D)).type!==T)throw P("Incompatible receiver, "+T+" required");return N}}}},function(e,n,o){var r=o(7),u=o(24),s=r.WeakMap;e.exports=u(s)&&/native code/.test(String(s))},function(e,n,o){var r=o(38),u=o(44),s=r("keys");e.exports=function(w){return s[w]||(s[w]=u(w))}},function(e){e.exports={}},function(e,n,o){var r=o(42),u=o(60),s=o(8),w=o(48);e.exports=function(m,v,g){for(var d=u(v),f=w.f,y=s.f,x=0;x<d.length;x++){var k=d[x];r(m,k)||g&&r(g,k)||f(m,k,y(v,k))}}},function(e,n,o){var r=o(27),u=o(17),s=o(61),w=o(70),m=o(50),v=u([].concat);e.exports=r("Reflect","ownKeys")||function(g){var d=s.f(m(g)),f=w.f;return f?v(d,f(g)):d}},function(e,n,o){var r=o(62),u=o(69).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(s){return r(s,u)}},function(e,n,o){var r=o(17),u=o(42),s=o(15),w=o(63).indexOf,m=o(58),v=r([].push);e.exports=function(g,d){var f,y=s(g),x=0,k=[];for(f in y)!u(m,f)&&u(y,f)&&v(k,f);for(;d.length>x;)u(y,f=d[x++])&&(~w(k,f)||v(k,f));return k}},function(e,n,o){var r=o(15),u=o(64),s=o(67),w=function(m){return function(v,g,d){var f,y=r(v),x=s(y),k=u(d,x);if(m&&g!=g){for(;x>k;)if((f=y[k++])!=f)return!0}else for(;x>k;k++)if((m||k in y)&&y[k]===g)return m||k||0;return!m&&-1}};e.exports={includes:w(!0),indexOf:w(!1)}},function(e,n,o){var r=o(65),u=Math.max,s=Math.min;e.exports=function(w,m){var v=r(w);return v<0?u(v+m,0):s(v,m)}},function(e,n,o){var r=o(66);e.exports=function(u){var s=+u;return s!=s||s===0?0:r(s)}},function(e){var n=Math.ceil,o=Math.floor;e.exports=Math.trunc||function(r){var u=+r;return(u>0?o:n)(u)}},function(e,n,o){var r=o(68);e.exports=function(u){return r(u.length)}},function(e,n,o){var r=o(65),u=Math.min;e.exports=function(s){return s>0?u(r(s),9007199254740991):0}},function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,n){n.f=Object.getOwnPropertySymbols},function(e,n,o){var r=o(10),u=o(24),s=/#|\.prototype\./,w=function(f,y){var x=v[m(f)];return x==d||x!=g&&(u(y)?r(y):!!y)},m=w.normalize=function(f){return String(f).replace(s,".").toLowerCase()},v=w.data={},g=w.NATIVE="N",d=w.POLYFILL="P";e.exports=w},function(e,n,o){var r=o(37),u=o(73),s=o(48).f,w=r("unscopables"),m=Array.prototype;m[w]==null&&s(m,w,{configurable:!0,value:u(null)}),e.exports=function(v){m[w][v]=!0}},function(e,n,o){var r,u=o(50),s=o(74),w=o(69),m=o(58),v=o(76),g=o(46),d=o(57),f="prototype",y="script",x=d("IE_PROTO"),k=function(){},P=function(M){return"<"+y+">"+M+"</"+y+">"},S=function(M){M.write(P("")),M.close();var T=M.parentWindow.Object;return M=null,T},E=function(){try{r=new ActiveXObject("htmlfile")}catch{}var M,T,D;E=typeof document<"u"?document.domain&&r?S(r):(T=g("iframe"),D="java"+y+":",T.style.display="none",v.appendChild(T),T.src=String(D),(M=T.contentWindow.document).open(),M.write(P("document.F=Object")),M.close(),M.F):S(r);for(var N=w.length;N--;)delete E[f][w[N]];return E()};m[x]=!0,e.exports=Object.create||function(M,T){var D;return M!==null?(k[f]=u(M),D=new k,k[f]=null,D[x]=M):D=E(),T===void 0?D:s.f(D,T)}},function(e,n,o){var r=o(9),u=o(49),s=o(48),w=o(50),m=o(15),v=o(75);n.f=r&&!u?Object.defineProperties:function(g,d){w(g);for(var f,y=m(d),x=v(d),k=x.length,P=0;k>P;)s.f(g,f=x[P++],y[f]);return g}},function(e,n,o){var r=o(62),u=o(69);e.exports=Object.keys||function(s){return r(s,u)}},function(e,n,o){var r=o(27);e.exports=r("document","documentElement")},function(e,n,o){var r=o(7),u=o(17);e.exports=function(s,w){return u(r[s].prototype[w])}},function(e,n,o){o(79)},function(e,n,o){var r=o(80),u=o(67),s=o(65),w=r.aTypedArray;(0,r.exportTypedArrayMethod)("at",function(m){var v=w(this),g=u(v),d=s(m),f=d>=0?d:g+d;return f<0||f>=g?void 0:v[f]})},function(e,n,o){var r,u,s,w=o(81),m=o(9),v=o(7),g=o(24),d=o(23),f=o(42),y=o(82),x=o(35),k=o(47),P=o(51),S=o(84),E=o(28),M=o(85),T=o(87),D=o(37),N=o(44),I=o(55),O=I.enforce,F=I.get,q=v.Int8Array,Y=q&&q.prototype,_e=v.Uint8ClampedArray,ne=_e&&_e.prototype,ve=q&&M(q),J=Y&&M(Y),fe=Object.prototype,Z=v.TypeError,j=D("toStringTag"),X=N("TYPED_ARRAY_TAG"),H="TypedArrayConstructor",U=w&&!!T&&y(v.opera)!=="Opera",te=!1,Q={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},re={BigInt64Array:8,BigUint64Array:8},Pe=function(be){if(!d(be))return!1;var we=y(be);return f(Q,we)||f(re,we)};for(r in Q)(s=(u=v[r])&&u.prototype)?O(s)[H]=u:U=!1;for(r in re)(s=(u=v[r])&&u.prototype)&&(O(s)[H]=u);if((!U||!g(ve)||ve===Function.prototype)&&(ve=function(){throw Z("Incorrect invocation")},U))for(r in Q)v[r]&&T(v[r],ve);if((!U||!J||J===fe)&&(J=ve.prototype,U))for(r in Q)v[r]&&T(v[r].prototype,J);if(U&&M(ne)!==J&&T(ne,J),m&&!f(J,j))for(r in te=!0,S(J,j,{configurable:!0,get:function(){return d(this)?this[X]:void 0}}),Q)v[r]&&k(v[r],X,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:U,TYPED_ARRAY_TAG:te&&X,aTypedArray:function(be){if(Pe(be))return be;throw Z("Target is not a typed array")},aTypedArrayConstructor:function(be){if(g(be)&&(!T||E(ve,be)))return be;throw Z(x(be)+" is not a typed array constructor")},exportTypedArrayMethod:function(be,we,Ae,$e){if(m){if(Ae)for(var Me in Q){var Ie=v[Me];if(Ie&&f(Ie.prototype,be))try{delete Ie.prototype[be]}catch{try{Ie.prototype[be]=we}catch{}}}J[be]&&!Ae||P(J,be,Ae?we:U&&Y[be]||we,$e)}},exportTypedArrayStaticMethod:function(be,we,Ae){var $e,Me;if(m){if(T){if(Ae){for($e in Q)if((Me=v[$e])&&f(Me,be))try{delete Me[be]}catch{}}if(ve[be]&&!Ae)return;try{return P(ve,be,Ae?we:U&&ve[be]||we)}catch{}}for($e in Q)!(Me=v[$e])||Me[be]&&!Ae||P(Me,be,we)}},getTypedArrayConstructor:function be(we){var Ae=M(we);if(d(Ae)){var $e=F(Ae);return $e&&f($e,H)?$e[H]:be(Ae)}},isView:function(be){if(!d(be))return!1;var we=y(be);return we==="DataView"||f(Q,we)||f(re,we)},isTypedArray:Pe,TypedArray:ve,TypedArrayPrototype:J}},function(e){e.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},function(e,n,o){var r=o(83),u=o(24),s=o(18),w=o(37)("toStringTag"),m=Object,v=s(function(){return arguments}())=="Arguments";e.exports=r?s:function(g){var d,f,y;return g===void 0?"Undefined":g===null?"Null":typeof(f=function(x,k){try{return x[k]}catch{}}(d=m(g),w))=="string"?f:v?s(d):(y=s(d))=="Object"&&u(d.callee)?"Arguments":y}},function(e,n,o){var r={};r[o(37)("toStringTag")]="z",e.exports=String(r)==="[object z]"},function(e,n,o){var r=o(52),u=o(48);e.exports=function(s,w,m){return m.get&&r(m.get,w,{getter:!0}),m.set&&r(m.set,w,{setter:!0}),u.f(s,w,m)}},function(e,n,o){var r=o(42),u=o(24),s=o(43),w=o(57),m=o(86),v=w("IE_PROTO"),g=Object,d=g.prototype;e.exports=m?g.getPrototypeOf:function(f){var y=s(f);if(r(y,v))return y[v];var x=y.constructor;return u(x)&&y instanceof x?x.prototype:y instanceof g?d:null}},function(e,n,o){var r=o(10);e.exports=!r(function(){function u(){}return u.prototype.constructor=null,Object.getPrototypeOf(new u)!==u.prototype})},function(e,n,o){var r=o(88),u=o(50),s=o(89);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var w,m=!1,v={};try{(w=r(Object.prototype,"__proto__","set"))(v,[]),m=v instanceof Array}catch{}return function(g,d){return u(g),s(d),m?w(g,d):g.__proto__=d,g}}():void 0)},function(e,n,o){var r=o(17),u=o(34);e.exports=function(s,w,m){try{return r(u(Object.getOwnPropertyDescriptor(s,w)[m]))}catch{}}},function(e,n,o){var r=o(24),u=String,s=TypeError;e.exports=function(w){if(_typeof$1(w)=="object"||r(w))return w;throw s("Can't set "+u(w)+" as a prototype")}},function(e,n,o){o(91),o(98),o(100),o(123),o(125);var r=o(137);e.exports=r.structuredClone},function(e,n,o){var r=o(15),u=o(72),s=o(92),w=o(55),m=o(48).f,v=o(93),g=o(97),d=o(39),f=o(9),y="Array Iterator",x=w.set,k=w.getterFor(y);e.exports=v(Array,"Array",function(S,E){x(this,{type:y,target:r(S),index:0,kind:E})},function(){var S=k(this),E=S.target,M=S.kind,T=S.index++;return!E||T>=E.length?(S.target=void 0,g(void 0,!0)):g(M=="keys"?T:M=="values"?E[T]:[T,E[T]],!1)},"values");var P=s.Arguments=s.Array;if(u("keys"),u("values"),u("entries"),!d&&f&&P.name!=="values")try{m(P,"name",{value:"values"})}catch{}},function(e){e.exports={}},function(e,n,o){var r=o(6),u=o(11),s=o(39),w=o(53),m=o(24),v=o(94),g=o(85),d=o(87),f=o(96),y=o(47),x=o(51),k=o(37),P=o(92),S=o(95),E=w.PROPER,M=w.CONFIGURABLE,T=S.IteratorPrototype,D=S.BUGGY_SAFARI_ITERATORS,N=k("iterator"),I="keys",O="values",F="entries",q=function(){return this};e.exports=function(Y,_e,ne,ve,J,fe,Z){v(ne,_e,ve);var j,X,H,U=function(Ae){if(Ae===J&&be)return be;if(!D&&Ae in re)return re[Ae];switch(Ae){case I:case O:case F:return function(){return new ne(this,Ae)}}return function(){return new ne(this)}},te=_e+" Iterator",Q=!1,re=Y.prototype,Pe=re[N]||re["@@iterator"]||J&&re[J],be=!D&&Pe||U(J),we=_e=="Array"&&re.entries||Pe;if(we&&(j=g(we.call(new Y)))!==Object.prototype&&j.next&&(s||g(j)===T||(d?d(j,T):m(j[N])||x(j,N,q)),f(j,te,!0,!0),s&&(P[te]=q)),E&&J==O&&Pe&&Pe.name!==O&&(!s&&M?y(re,"name",O):(Q=!0,be=function(){return u(Pe,this)})),J)if(X={values:U(O),keys:fe?be:U(I),entries:U(F)},Z)for(H in X)(D||Q||!(H in re))&&x(re,H,X[H]);else r({target:_e,proto:!0,forced:D||Q},X);return s&&!Z||re[N]===be||x(re,N,be,{name:J}),P[_e]=be,X}},function(e,n,o){var r=o(95).IteratorPrototype,u=o(73),s=o(14),w=o(96),m=o(92),v=function(){return this};e.exports=function(g,d,f,y){var x=d+" Iterator";return g.prototype=u(r,{next:s(+!y,f)}),w(g,x,!1,!0),m[x]=v,g}},function(e,n,o){var r,u,s,w=o(10),m=o(24),v=o(23),g=o(73),d=o(85),f=o(51),y=o(37),x=o(39),k=y("iterator"),P=!1;[].keys&&("next"in(s=[].keys())?(u=d(d(s)))!==Object.prototype&&(r=u):P=!0),!v(r)||w(function(){var S={};return r[k].call(S)!==S})?r={}:x&&(r=g(r)),m(r[k])||f(r,k,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:P}},function(e,n,o){var r=o(48).f,u=o(42),s=o(37)("toStringTag");e.exports=function(w,m,v){w&&!v&&(w=w.prototype),w&&!u(w,s)&&r(w,s,{configurable:!0,value:m})}},function(e){e.exports=function(n,o){return{value:n,done:o}}},function(e,n,o){var r=o(83),u=o(51),s=o(99);r||u(Object.prototype,"toString",s,{unsafe:!0})},function(e,n,o){var r=o(83),u=o(82);e.exports=r?{}.toString:function(){return"[object "+u(this)+"]"}},function(e,n,o){o(101)},function(e,n,o){o(102)("Map",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},o(120))},function(e,n,o){var r=o(6),u=o(7),s=o(17),w=o(71),m=o(51),v=o(103),g=o(110),d=o(117),f=o(24),y=o(20),x=o(23),k=o(10),P=o(118),S=o(96),E=o(119);e.exports=function(M,T,D){var N=M.indexOf("Map")!==-1,I=M.indexOf("Weak")!==-1,O=N?"set":"add",F=u[M],q=F&&F.prototype,Y=F,_e={},ne=function(X){var H=s(q[X]);m(q,X,X=="add"?function(U){return H(this,U===0?0:U),this}:X=="delete"?function(U){return!(I&&!x(U))&&H(this,U===0?0:U)}:X=="get"?function(U){return I&&!x(U)?void 0:H(this,U===0?0:U)}:X=="has"?function(U){return!(I&&!x(U))&&H(this,U===0?0:U)}:function(U,te){return H(this,U===0?0:U,te),this})};if(w(M,!f(F)||!(I||q.forEach&&!k(function(){new F().entries().next()}))))Y=D.getConstructor(T,M,N,O),v.enable();else if(w(M,!0)){var ve=new Y,J=ve[O](I?{}:-0,1)!=ve,fe=k(function(){ve.has(1)}),Z=P(function(X){new F(X)}),j=!I&&k(function(){for(var X=new F,H=5;H--;)X[O](H,H);return!X.has(-0)});Z||((Y=T(function(X,H){d(X,q);var U=E(new F,X,Y);return y(H)||g(H,U[O],{that:U,AS_ENTRIES:N}),U})).prototype=q,q.constructor=Y),(fe||j)&&(ne("delete"),ne("has"),N&&ne("get")),(j||J)&&ne(O),I&&q.clear&&delete q.clear}return _e[M]=Y,r({global:!0,constructor:!0,forced:Y!=F},_e),S(Y,M),I||D.setStrong(Y,M,N),Y}},function(e,n,o){var r=o(6),u=o(17),s=o(58),w=o(23),m=o(42),v=o(48).f,g=o(61),d=o(104),f=o(107),y=o(44),x=o(109),k=!1,P=y("meta"),S=0,E=function(T){v(T,P,{value:{objectID:"O"+S++,weakData:{}}})},M=e.exports={enable:function(){M.enable=function(){},k=!0;var T=g.f,D=u([].splice),N={};N[P]=1,T(N).length&&(g.f=function(I){for(var O=T(I),F=0,q=O.length;F<q;F++)if(O[F]===P){D(O,F,1);break}return O},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},fastKey:function(T,D){if(!w(T))return _typeof$1(T)=="symbol"?T:(typeof T=="string"?"S":"P")+T;if(!m(T,P)){if(!f(T))return"F";if(!D)return"E";E(T)}return T[P].objectID},getWeakData:function(T,D){if(!m(T,P)){if(!f(T))return!0;if(!D)return!1;E(T)}return T[P].weakData},onFreeze:function(T){return x&&k&&f(T)&&!m(T,P)&&E(T),T}};s[P]=!0},function(e,n,o){var r=o(18),u=o(15),s=o(61).f,w=o(105),m=(typeof window>"u"?"undefined":_typeof$1(window))=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(v){return m&&r(v)=="Window"?function(g){try{return s(g)}catch{return w(m)}}(v):s(u(v))}},function(e,n,o){var r=o(64),u=o(67),s=o(106),w=Array,m=Math.max;e.exports=function(v,g,d){for(var f=u(v),y=r(g,f),x=r(d===void 0?f:d,f),k=w(m(x-y,0)),P=0;y<x;y++,P++)s(k,P,v[y]);return k.length=P,k}},function(e,n,o){var r=o(21),u=o(48),s=o(14);e.exports=function(w,m,v){var g=r(m);g in w?u.f(w,g,s(0,v)):w[g]=v}},function(e,n,o){var r=o(10),u=o(23),s=o(18),w=o(108),m=Object.isExtensible,v=r(function(){});e.exports=v||w?function(g){return!!u(g)&&(!w||s(g)!="ArrayBuffer")&&(!m||m(g))}:m},function(e,n,o){var r=o(10);e.exports=r(function(){if(typeof ArrayBuffer=="function"){var u=new ArrayBuffer(8);Object.isExtensible(u)&&Object.defineProperty(u,"a",{value:8})}})},function(e,n,o){var r=o(10);e.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(e,n,o){var r=o(111),u=o(11),s=o(50),w=o(35),m=o(113),v=o(67),g=o(28),d=o(114),f=o(115),y=o(116),x=TypeError,k=function(S,E){this.stopped=S,this.result=E},P=k.prototype;e.exports=function(S,E,M){var T,D,N,I,O,F,q,Y=M&&M.that,_e=!(!M||!M.AS_ENTRIES),ne=!(!M||!M.IS_RECORD),ve=!(!M||!M.IS_ITERATOR),J=!(!M||!M.INTERRUPTED),fe=r(E,Y),Z=function(X){return T&&y(T,"normal",X),new k(!0,X)},j=function(X){return _e?(s(X),J?fe(X[0],X[1],Z):fe(X[0],X[1])):J?fe(X,Z):fe(X)};if(ne)T=S.iterator;else if(ve)T=S;else{if(!(D=f(S)))throw x(w(S)+" is not iterable");if(m(D)){for(N=0,I=v(S);I>N;N++)if((O=j(S[N]))&&g(P,O))return O;return new k(!1)}T=d(S,D)}for(F=ne?S.next:T.next;!(q=u(F,T)).done;){try{O=j(q.value)}catch(X){y(T,"throw",X)}if(_typeof$1(O)=="object"&&O&&g(P,O))return O}return new k(!1)}},function(e,n,o){var r=o(112),u=o(34),s=o(12),w=r(r.bind);e.exports=function(m,v){return u(m),v===void 0?m:s?w(m,v):function(){return m.apply(v,arguments)}}},function(e,n,o){var r=o(18),u=o(17);e.exports=function(s){if(r(s)==="Function")return u(s)}},function(e,n,o){var r=o(37),u=o(92),s=r("iterator"),w=Array.prototype;e.exports=function(m){return m!==void 0&&(u.Array===m||w[s]===m)}},function(e,n,o){var r=o(11),u=o(34),s=o(50),w=o(35),m=o(115),v=TypeError;e.exports=function(g,d){var f=arguments.length<2?m(g):d;if(u(f))return s(r(f,g));throw v(w(g)+" is not iterable")}},function(e,n,o){var r=o(82),u=o(33),s=o(20),w=o(92),m=o(37)("iterator");e.exports=function(v){if(!s(v))return u(v,m)||u(v,"@@iterator")||w[r(v)]}},function(e,n,o){var r=o(11),u=o(50),s=o(33);e.exports=function(w,m,v){var g,d;u(w);try{if(!(g=s(w,"return"))){if(m==="throw")throw v;return v}g=r(g,w)}catch(f){d=!0,g=f}if(m==="throw")throw v;if(d)throw g;return u(g),v}},function(e,n,o){var r=o(28),u=TypeError;e.exports=function(s,w){if(r(w,s))return s;throw u("Incorrect invocation")}},function(e,n,o){var r=o(37)("iterator"),u=!1;try{var s=0,w={next:function(){return{done:!!s++}},return:function(){u=!0}};w[r]=function(){return this},Array.from(w,function(){throw 2})}catch{}e.exports=function(m,v){if(!v&&!u)return!1;var g=!1;try{var d={};d[r]=function(){return{next:function(){return{done:g=!0}}}},m(d)}catch{}return g}},function(e,n,o){var r=o(24),u=o(23),s=o(87);e.exports=function(w,m,v){var g,d;return s&&r(g=m.constructor)&&g!==v&&u(d=g.prototype)&&d!==v.prototype&&s(w,d),w}},function(e,n,o){var r=o(73),u=o(84),s=o(121),w=o(111),m=o(117),v=o(20),g=o(110),d=o(93),f=o(97),y=o(122),x=o(9),k=o(103).fastKey,P=o(55),S=P.set,E=P.getterFor;e.exports={getConstructor:function(M,T,D,N){var I=M(function(_e,ne){m(_e,O),S(_e,{type:T,index:r(null),first:void 0,last:void 0,size:0}),x||(_e.size=0),v(ne)||g(ne,_e[N],{that:_e,AS_ENTRIES:D})}),O=I.prototype,F=E(T),q=function(_e,ne,ve){var J,fe,Z=F(_e),j=Y(_e,ne);return j?j.value=ve:(Z.last=j={index:fe=k(ne,!0),key:ne,value:ve,previous:J=Z.last,next:void 0,removed:!1},Z.first||(Z.first=j),J&&(J.next=j),x?Z.size++:_e.size++,fe!=="F"&&(Z.index[fe]=j)),_e},Y=function(_e,ne){var ve,J=F(_e),fe=k(ne);if(fe!=="F")return J.index[fe];for(ve=J.first;ve;ve=ve.next)if(ve.key==ne)return ve};return s(O,{clear:function(){for(var _e=F(this),ne=_e.index,ve=_e.first;ve;)ve.removed=!0,ve.previous&&(ve.previous=ve.previous.next=void 0),delete ne[ve.index],ve=ve.next;_e.first=_e.last=void 0,x?_e.size=0:this.size=0},delete:function(_e){var ne=this,ve=F(ne),J=Y(ne,_e);if(J){var fe=J.next,Z=J.previous;delete ve.index[J.index],J.removed=!0,Z&&(Z.next=fe),fe&&(fe.previous=Z),ve.first==J&&(ve.first=fe),ve.last==J&&(ve.last=Z),x?ve.size--:ne.size--}return!!J},forEach:function(_e){for(var ne,ve=F(this),J=w(_e,arguments.length>1?arguments[1]:void 0);ne=ne?ne.next:ve.first;)for(J(ne.value,ne.key,this);ne&&ne.removed;)ne=ne.previous},has:function(_e){return!!Y(this,_e)}}),s(O,D?{get:function(_e){var ne=Y(this,_e);return ne&&ne.value},set:function(_e,ne){return q(this,_e===0?0:_e,ne)}}:{add:function(_e){return q(this,_e=_e===0?0:_e,_e)}}),x&&u(O,"size",{configurable:!0,get:function(){return F(this).size}}),I},setStrong:function(M,T,D){var N=T+" Iterator",I=E(T),O=E(N);d(M,T,function(F,q){S(this,{type:N,target:F,state:I(F),kind:q,last:void 0})},function(){for(var F=O(this),q=F.kind,Y=F.last;Y&&Y.removed;)Y=Y.previous;return F.target&&(F.last=Y=Y?Y.next:F.state.first)?f(q=="keys"?Y.key:q=="values"?Y.value:[Y.key,Y.value],!1):(F.target=void 0,f(void 0,!0))},D?"entries":"values",!D,!0),y(T)}}},function(e,n,o){var r=o(51);e.exports=function(u,s,w){for(var m in s)r(u,m,s[m],w);return u}},function(e,n,o){var r=o(27),u=o(84),s=o(37),w=o(9),m=s("species");e.exports=function(v){var g=r(v);w&&g&&!g[m]&&u(g,m,{configurable:!0,get:function(){return this}})}},function(e,n,o){o(124)},function(e,n,o){o(102)("Set",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},o(120))},function(e,n,o){var r,u=o(39),s=o(6),w=o(7),m=o(27),v=o(17),g=o(10),d=o(44),f=o(24),y=o(126),x=o(20),k=o(23),P=o(26),S=o(110),E=o(50),M=o(82),T=o(42),D=o(106),N=o(47),I=o(67),O=o(127),F=o(128),q=o(130),Y=o(131),_e=o(132),ne=o(133),ve=w.Object,J=w.Array,fe=w.Date,Z=w.Error,j=w.EvalError,X=w.RangeError,H=w.ReferenceError,U=w.SyntaxError,te=w.TypeError,Q=w.URIError,re=w.PerformanceMark,Pe=w.WebAssembly,be=Pe&&Pe.CompileError||Z,we=Pe&&Pe.LinkError||Z,Ae=Pe&&Pe.RuntimeError||Z,$e=m("DOMException"),Me=q.Map,Ie=q.has,Le=q.get,le=q.set,oe=Y.Set,ke=Y.add,Ce=m("Object","keys"),Ee=v([].push),Be=v((!0).valueOf),Ve=v(1 .valueOf),Oe=v("".valueOf),je=v(fe.prototype.getTime),Ge=d("structuredClone"),Xe="DataCloneError",qe="Transferring",Ke=function(bt){return!g(function(){var ot=new w.Set([7]),gt=bt(ot),tt=bt(ve(7));return gt==ot||!gt.has(7)||_typeof$1(tt)!="object"||tt!=7})&&bt},Je=function(bt,ot){return!g(function(){var gt=new ot,tt=bt({a:gt,b:gt});return!(tt&&tt.a===tt.b&&tt.a instanceof ot&&tt.a.stack===gt.stack)})},rt=w.structuredClone,ht=u||!Je(rt,Z)||!Je(rt,$e)||(r=rt,!!g(function(){var bt=r(new w.AggregateError([1],Ge,{cause:3}));return bt.name!="AggregateError"||bt.errors[0]!=1||bt.message!=Ge||bt.cause!=3})),vt=!rt&&Ke(function(bt){return new re(Ge,{detail:bt}).detail}),Ct=Ke(rt)||vt,kt=function(bt){throw new $e("Uncloneable type: "+bt,Xe)},mt=function(bt,ot){throw new $e((ot||"Cloning")+" of "+bt+" cannot be properly polyfilled in this engine",Xe)},Vt=function bt(ot,gt){if(P(ot)&&kt("Symbol"),!k(ot))return ot;if(gt){if(Ie(gt,ot))return Le(gt,ot)}else gt=new Me;var tt,ut,Re,Te,He,Fe,ze,We,Ue,et,it,nt=M(ot),dt=!1;switch(nt){case"Array":Re=J(I(ot)),dt=!0;break;case"Object":Re={},dt=!0;break;case"Map":Re=new Me,dt=!0;break;case"Set":Re=new oe,dt=!0;break;case"RegExp":Re=new RegExp(ot.source,F(ot));break;case"Error":switch(ut=ot.name){case"AggregateError":Re=m("AggregateError")([]);break;case"EvalError":Re=j();break;case"RangeError":Re=X();break;case"ReferenceError":Re=H();break;case"SyntaxError":Re=U();break;case"TypeError":Re=te();break;case"URIError":Re=Q();break;case"CompileError":Re=be();break;case"LinkError":Re=we();break;case"RuntimeError":Re=Ae();break;default:Re=Z()}dt=!0;break;case"DOMException":Re=new $e(ot.message,ot.name),dt=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":tt=w[nt],k(tt)||mt(nt),Re=new tt(bt(ot.buffer,gt),ot.byteOffset,nt==="DataView"?ot.byteLength:ot.length);break;case"DOMQuad":try{Re=new DOMQuad(bt(ot.p1,gt),bt(ot.p2,gt),bt(ot.p3,gt),bt(ot.p4,gt))}catch{Ct?Re=Ct(ot):mt(nt)}break;case"FileList":if(Te=function(){var xt;try{xt=new w.DataTransfer}catch{try{xt=new w.ClipboardEvent("").clipboardData}catch{}}return xt&&xt.items&&xt.files?xt:null}()){for(He=0,Fe=I(ot);He<Fe;He++)Te.items.add(bt(ot[He],gt));Re=Te.files}else Ct?Re=Ct(ot):mt(nt);break;case"ImageData":try{Re=new ImageData(bt(ot.data,gt),ot.width,ot.height,{colorSpace:ot.colorSpace})}catch{Ct?Re=Ct(ot):mt(nt)}break;default:if(Ct)Re=Ct(ot);else switch(nt){case"BigInt":Re=ve(ot.valueOf());break;case"Boolean":Re=ve(Be(ot));break;case"Number":Re=ve(Ve(ot));break;case"String":Re=ve(Oe(ot));break;case"Date":Re=new fe(je(ot));break;case"ArrayBuffer":(tt=w.DataView)||typeof ot.slice=="function"||mt(nt);try{if(typeof ot.slice!="function"||ot.resizable)for(Fe=ot.byteLength,it=("maxByteLength"in ot)?{maxByteLength:ot.maxByteLength}:void 0,Re=new ArrayBuffer(Fe,it),Ue=new tt(ot),et=new tt(Re),He=0;He<Fe;He++)et.setUint8(He,Ue.getUint8(He));else Re=ot.slice(0)}catch{throw new $e("ArrayBuffer is detached",Xe)}break;case"SharedArrayBuffer":Re=ot;break;case"Blob":try{Re=ot.slice(0,ot.size,ot.type)}catch{mt(nt)}break;case"DOMPoint":case"DOMPointReadOnly":tt=w[nt];try{Re=tt.fromPoint?tt.fromPoint(ot):new tt(ot.x,ot.y,ot.z,ot.w)}catch{mt(nt)}break;case"DOMRect":case"DOMRectReadOnly":tt=w[nt];try{Re=tt.fromRect?tt.fromRect(ot):new tt(ot.x,ot.y,ot.width,ot.height)}catch{mt(nt)}break;case"DOMMatrix":case"DOMMatrixReadOnly":tt=w[nt];try{Re=tt.fromMatrix?tt.fromMatrix(ot):new tt(ot)}catch{mt(nt)}break;case"AudioData":case"VideoFrame":f(ot.clone)||mt(nt);try{Re=ot.clone()}catch{kt(nt)}break;case"File":try{Re=new File([ot],ot.name,ot)}catch{mt(nt)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":mt(nt);default:kt(nt)}}if(le(gt,ot,Re),dt)switch(nt){case"Array":case"Object":for(ze=Ce(ot),He=0,Fe=I(ze);He<Fe;He++)We=ze[He],D(Re,We,bt(ot[We],gt));break;case"Map":ot.forEach(function(xt,yt){le(Re,bt(yt,gt),bt(xt,gt))});break;case"Set":ot.forEach(function(xt){ke(Re,bt(xt,gt))});break;case"Error":N(Re,"message",bt(ot.message,gt)),T(ot,"cause")&&N(Re,"cause",bt(ot.cause,gt)),ut=="AggregateError"&&(Re.errors=bt(ot.errors,gt));case"DOMException":_e&&N(Re,"stack",bt(ot.stack,gt))}return Re};s({global:!0,enumerable:!0,sham:!ne,forced:ht},{structuredClone:function(bt){var ot,gt=O(arguments.length,1)>1&&!x(arguments[1])?E(arguments[1]):void 0,tt=gt?gt.transfer:void 0;return tt!==void 0&&function(ut,Re){if(!k(ut))throw te("Transfer option cannot be converted to a sequence");var Te=[];S(ut,function(dt){Ee(Te,E(dt))});var He,Fe,ze,We,Ue,et,it=0,nt=I(Te);if(ne)for(We=rt(Te,{transfer:Te});it<nt;)le(Re,Te[it],We[it++]);else for(;it<nt;){if(He=Te[it++],Ie(Re,He))throw new $e("Duplicate transferable",Xe);switch(Fe=M(He)){case"ImageBitmap":ze=w.OffscreenCanvas,y(ze)||mt(Fe,qe);try{(et=new ze(He.width,He.height)).getContext("bitmaprenderer").transferFromImageBitmap(He),Ue=et.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":f(He.clone)&&f(He.close)||mt(Fe,qe);try{Ue=He.clone(),He.close()}catch{}break;case"ArrayBuffer":f(He.transfer)||mt(Fe,qe),Ue=He.transfer();break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":mt(Fe,qe)}if(Ue===void 0)throw new $e("This object cannot be transferred: "+Fe,Xe);le(Re,He,Ue)}}(tt,ot=new Me),Vt(bt,ot)}})},function(e,n,o){var r=o(17),u=o(10),s=o(24),w=o(82),m=o(27),v=o(54),g=function(){},d=[],f=m("Reflect","construct"),y=/^\s*(?:class|function)\b/,x=r(y.exec),k=!y.exec(g),P=function(E){if(!s(E))return!1;try{return f(g,d,E),!0}catch{return!1}},S=function(E){if(!s(E))return!1;switch(w(E)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return k||!!x(y,v(E))}catch{return!0}};S.sham=!0,e.exports=!f||u(function(){var E;return P(P.call)||!P(Object)||!P(function(){E=!0})||E})?S:P},function(e){var n=TypeError;e.exports=function(o,r){if(o<r)throw n("Not enough arguments");return o}},function(e,n,o){var r=o(11),u=o(42),s=o(28),w=o(129),m=RegExp.prototype;e.exports=function(v){var g=v.flags;return g!==void 0||"flags"in m||u(v,"flags")||!s(m,v)?g:r(w,v)}},function(e,n,o){var r=o(50);e.exports=function(){var u=r(this),s="";return u.hasIndices&&(s+="d"),u.global&&(s+="g"),u.ignoreCase&&(s+="i"),u.multiline&&(s+="m"),u.dotAll&&(s+="s"),u.unicode&&(s+="u"),u.unicodeSets&&(s+="v"),u.sticky&&(s+="y"),s}},function(e,n,o){var r=o(17),u=Map.prototype;e.exports={Map,set:r(u.set),get:r(u.get),has:r(u.has),remove:r(u.delete),proto:u}},function(e,n,o){var r=o(17),u=Set.prototype;e.exports={Set,add:r(u.add),has:r(u.has),remove:r(u.delete),proto:u,$has:u.has,$keys:u.keys}},function(e,n,o){var r=o(10),u=o(14);e.exports=!r(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",u(1,7)),s.stack!==7)})},function(e,n,o){var r=o(7),u=o(10),s=o(31),w=o(134),m=o(135),v=o(136),g=r.structuredClone;e.exports=!!g&&!u(function(){if(m&&s>92||v&&s>94||w&&s>97)return!1;var d=new ArrayBuffer(8),f=g(d,{transfer:[d]});return d.byteLength!=0||f.byteLength!=8})},function(e,n,o){var r=o(135),u=o(136);e.exports=!r&&!u&&(typeof window>"u"?"undefined":_typeof$1(window))=="object"&&(typeof document>"u"?"undefined":_typeof$1(document))=="object"},function(e){e.exports=(typeof Deno>"u"?"undefined":_typeof$1(Deno))=="object"&&Deno&&_typeof$1(Deno.version)=="object"},function(e,n,o){var r=o(18);e.exports=typeof process<"u"&&r(process)=="process"},function(e,n,o){var r=o(7);e.exports=r},function(__unused_webpack_module,exports,__w_pdfjs_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(139),_display_utils=__w_pdfjs_require__(142),_font_loader=__w_pdfjs_require__(145),_canvas=__w_pdfjs_require__(146),_worker_options=__w_pdfjs_require__(149),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(150),_metadata=__w_pdfjs_require__(151),_optional_content_config=__w_pdfjs_require__(152),_transport_stream=__w_pdfjs_require__(153),_xfa_text=__w_pdfjs_require__(154);function _classPrivateMethodInitSpec(e,n){_checkPrivateRedeclaration(e,n),n.add(e)}function _classPrivateFieldInitSpec$1(e,n,o){_checkPrivateRedeclaration(e,n),n.set(e,o)}function _checkPrivateRedeclaration(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(e,n){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,n,"get"))}function _classApplyDescriptorGet(e,n){return n.get?n.get.call(e):n.value}function _classPrivateMethodGet(e,n,o){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return o}function _classPrivateFieldSet(e,n,o){return _classApplyDescriptorSet(e,_classExtractFieldDescriptor(e,n,"set"),o),o}function _classExtractFieldDescriptor(e,n,o){if(!n.has(e))throw new TypeError("attempted to "+o+" private field on non-instance");return n.get(e)}function _classApplyDescriptorSet(e,n,o){if(n.set)n.set.call(e,o);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=o}}var DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;var DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;var DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;var DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){var _w_pdfjs_require__=__w_pdfjs_require__(155),NodeCanvasFactory=_w_pdfjs_require__.NodeCanvasFactory,NodeCMapReaderFactory=_w_pdfjs_require__.NodeCMapReaderFactory,NodeFilterFactory=_w_pdfjs_require__.NodeFilterFactory,NodeStandardFontDataFactory=_w_pdfjs_require__.NodeStandardFontDataFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory=NodeCanvasFactory,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=NodeCMapReaderFactory,exports.DefaultFilterFactory=DefaultFilterFactory=NodeFilterFactory,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=NodeStandardFontDataFactory}if(_is_node.isNodeJS){var _w_pdfjs_require__2=__w_pdfjs_require__(156),PDFNodeStream=_w_pdfjs_require__2.PDFNodeStream;createPDFNetworkStream=function(e){return new PDFNodeStream(e)}}else{var _w_pdfjs_require__3=__w_pdfjs_require__(159),PDFNetworkStream=_w_pdfjs_require__3.PDFNetworkStream,_w_pdfjs_require__4=__w_pdfjs_require__(160),PDFFetchStream=_w_pdfjs_require__4.PDFFetchStream;createPDFNetworkStream=function(e){return(0,_display_utils.isValidFetchUrl)(e.url)?new PDFFetchStream(e):new PDFNetworkStream(e)}}function getDocument(e){var n,o;if(typeof e=="string"||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),_typeof$1(e)!=="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");var r=new PDFDocumentLoadingTask,u=r.docId,s=e.url?getUrlProp(e.url):null,w=e.data?getDataProp(e.data):null,m=e.httpHeaders||null,v=e.withCredentials===!0,g=(n=e.password)!==null&&n!==void 0?n:null,d=e.range instanceof PDFDataRangeTransport?e.range:null,f=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,y=e.worker instanceof PDFWorker?e.worker:null,x=e.verbosity,k=typeof e.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(e.docBaseUrl)?null:e.docBaseUrl,P=typeof e.cMapUrl=="string"?e.cMapUrl:null,S=e.cMapPacked!==!1,E=e.CMapReaderFactory||DefaultCMapReaderFactory,M=typeof e.standardFontDataUrl=="string"?e.standardFontDataUrl:null,T=e.StandardFontDataFactory||DefaultStandardFontDataFactory,D=e.stopAtErrors!==!0,N=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,I=e.isEvalSupported!==!1,O=typeof e.isOffscreenCanvasSupported=="boolean"?e.isOffscreenCanvasSupported:!_is_node.isNodeJS,F=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,q=typeof e.disableFontFace=="boolean"?e.disableFontFace:_is_node.isNodeJS,Y=e.fontExtraProperties===!0,_e=e.enableXfa===!0,ne=e.ownerDocument||globalThis.document,ve=e.disableRange===!0,J=e.disableStream===!0,fe=e.disableAutoFetch===!0,Z=e.pdfBug===!0,j=d?d.length:(o=e.length)!==null&&o!==void 0?o:NaN,X=typeof e.useSystemFonts=="boolean"?e.useSystemFonts:!_is_node.isNodeJS&&!q,H=typeof e.useWorkerFetch=="boolean"?e.useWorkerFetch:E===_display_utils.DOMCMapReaderFactory&&T===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(P,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(M,document.baseURI),U=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:ne}),te=e.filterFactory||new DefaultFilterFactory({docId:u,ownerDocument:ne});(0,_util.setVerbosityLevel)(x);var Q={canvasFactory:U,filterFactory:te};if(H||(Q.cMapReaderFactory=new E({baseUrl:P,isCompressed:S}),Q.standardFontDataFactory=new T({baseUrl:M})),!y){var re={verbosity:x,port:_worker_options.GlobalWorkerOptions.workerPort};y=re.port?PDFWorker.fromPort(re):new PDFWorker(re),r._worker=y}var Pe={docId:u,apiVersion:"3.5.141",data:w,password:g,disableAutoFetch:fe,rangeChunkSize:f,length:j,docBaseUrl:k,enableXfa:_e,evaluatorOptions:{maxImageSize:N,disableFontFace:q,ignoreErrors:D,isEvalSupported:I,isOffscreenCanvasSupported:O,canvasMaxAreaInBytes:F,fontExtraProperties:Y,useSystemFonts:X,cMapUrl:H?P:null,standardFontDataUrl:H?M:null}},be={ignoreErrors:D,isEvalSupported:I,disableFontFace:q,fontExtraProperties:Y,enableXfa:_e,ownerDocument:ne,disableAutoFetch:fe,pdfBug:Z,styleElement:null};return y.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");var we=_fetchDocument(y,Pe),Ae=new Promise(function($e){var Me;d?Me=new _transport_stream.PDFDataTransportStream({length:j,initialData:d.initialData,progressiveDone:d.progressiveDone,contentDispositionFilename:d.contentDispositionFilename,disableRange:ve,disableStream:J},d):w||(Me=createPDFNetworkStream({url:s,length:j,httpHeaders:m,withCredentials:v,rangeChunkSize:f,disableRange:ve,disableStream:J})),$e(Me)});return Promise.all([we,Ae]).then(function($e){var Me=_slicedToArray($e,2),Ie=Me[0],Le=Me[1];if(r.destroyed)throw new Error("Loading aborted");var le=new _message_handler.MessageHandler(u,Ie,y.port),oe=new WorkerTransport(le,r,Le,be,Q);r._transport=oe,le.send("Ready",null)})}).catch(r._capability.reject),r}function _fetchDocument(e,n){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(_regeneratorRuntime().mark(function e(n,o){var r;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!n.destroyed){u.next=2;break}throw new Error("Worker was destroyed");case 2:return u.next=4,n.messageHandler.sendWithPromise("GetDocRequest",o,o.data?[o.data.buffer]:null);case 4:if(r=u.sent,!n.destroyed){u.next=7;break}throw new Error("Worker was destroyed");case 7:return u.abrupt("return",r);case 8:case"end":return u.stop()}},e)}))).apply(this,arguments)}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(_is_node.isNodeJS&&typeof e=="string")return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_is_node.isNodeJS&&typeof Buffer<"u"&&e instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(e);if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e=="string")return(0,_util.stringToBytes)(e);if(_typeof$1(e)==="object"&&!isNaN(e==null?void 0:e.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}var PDFDocumentLoadingTask=function(){return _createClass(function n(){var o,r;_classCallCheck(this,n),this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d".concat((_docId2._=(o=_docId2._,r=o++,o),r)),this.destroyed=!1,this.onPassword=null,this.onProgress=null},[{key:"promise",get:function(){return this._capability.promise}},{key:"destroy",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(){var o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.destroyed=!0,r.next=3,(o=this._transport)===null||o===void 0?void 0:o.destroy();case 3:this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null);case 5:case"end":return r.stop()}},n,this)})),function(){return e.apply(this,arguments)})}]);var e}(),_docId2={_:0};exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;var PDFDataRangeTransport=function(){return _createClass(function e(n,o){_classCallCheck(this,e);var r=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=n,this.initialData=o,this.progressiveDone=r,this.contentDispositionFilename=u,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()},[{key:"addRangeListener",value:function(e){this._rangeListeners.push(e)}},{key:"addProgressListener",value:function(e){this._progressListeners.push(e)}},{key:"addProgressiveReadListener",value:function(e){this._progressiveReadListeners.push(e)}},{key:"addProgressiveDoneListener",value:function(e){this._progressiveDoneListeners.push(e)}},{key:"onDataRange",value:function(e,n){var o,r=_createForOfIteratorHelper(this._rangeListeners);try{for(r.s();!(o=r.n()).done;)(0,o.value)(e,n)}catch(u){r.e(u)}finally{r.f()}}},{key:"onDataProgress",value:function(e,n){var o=this;this._readyCapability.promise.then(function(){var r,u=_createForOfIteratorHelper(o._progressListeners);try{for(u.s();!(r=u.n()).done;)(0,r.value)(e,n)}catch(s){u.e(s)}finally{u.f()}})}},{key:"onDataProgressiveRead",value:function(e){var n=this;this._readyCapability.promise.then(function(){var o,r=_createForOfIteratorHelper(n._progressiveReadListeners);try{for(r.s();!(o=r.n()).done;)(0,o.value)(e)}catch(u){r.e(u)}finally{r.f()}})}},{key:"onDataProgressiveDone",value:function(){var e=this;this._readyCapability.promise.then(function(){var n,o=_createForOfIteratorHelper(e._progressiveDoneListeners);try{for(o.s();!(n=o.n()).done;)(0,n.value)()}catch(r){o.e(r)}finally{o.f()}})}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(e,n){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}])}();exports.PDFDataRangeTransport=PDFDataRangeTransport;var PDFDocumentProxy=function(){return _createClass(function e(n,o){_classCallCheck(this,e),this._pdfInfo=n,this._transport=o},[{key:"annotationStorage",get:function(){return this._transport.annotationStorage}},{key:"filterFactory",get:function(){return this._transport.filterFactory}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprints",get:function(){return this._pdfInfo.fingerprints}},{key:"isPureXfa",get:function(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}},{key:"allXfaHtml",get:function(){return this._transport._htmlForXfa}},{key:"getPage",value:function(e){return this._transport.getPage(e)}},{key:"getPageIndex",value:function(e){return this._transport.getPageIndex(e)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(e){return this._transport.getDestination(e)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageLayout",value:function(){return this._transport.getPageLayout()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getViewerPreferences",value:function(){return this._transport.getViewerPreferences()}},{key:"getOpenAction",value:function(){return this._transport.getOpenAction()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getJSActions",value:function(){return this._transport.getDocJSActions()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getOptionalContentConfig",value:function(){return this._transport.getOptionalContentConfig()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getMarkInfo",value:function(){return this._transport.getMarkInfo()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"saveDocument",value:function(){return this._transport.saveDocument()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"cleanup",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"loadingParams",get:function(){return this._transport.loadingParams}},{key:"loadingTask",get:function(){return this._transport.loadingTask}},{key:"getFieldObjects",value:function(){return this._transport.getFieldObjects()}},{key:"hasJSActions",value:function(){return this._transport.hasJSActions()}},{key:"getCalculationOrderIds",value:function(){return this._transport.getCalculationOrderIds()}}])}();exports.PDFDocumentProxy=PDFDocumentProxy;var _delayedCleanupTimeout=new WeakMap,_pendingCleanup=new WeakMap,_tryCleanup=new WeakSet,_abortDelayedCleanup=new WeakSet,PDFPageProxy=function(){return _createClass(function n(o,r,u){_classCallCheck(this,n);var s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];_classPrivateMethodInitSpec(this,_abortDelayedCleanup),_classPrivateMethodInitSpec(this,_tryCleanup),_classPrivateFieldInitSpec$1(this,_delayedCleanupTimeout,{writable:!0,value:null}),_classPrivateFieldInitSpec$1(this,_pendingCleanup,{writable:!0,value:!1}),this._pageIndex=o,this._pageInfo=r,this._transport=u,this._stats=s?new _display_utils.StatTimer:null,this._pdfBug=s,this.commonObjs=u.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1},[{key:"pageNumber",get:function(){return this._pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"getViewport",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=n.scale,r=n.rotation,u=r===void 0?this.rotate:r,s=n.offsetX,w=s===void 0?0:s,m=n.offsetY,v=m===void 0?0:m,g=n.dontFlip,d=g!==void 0&&g;return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:u,offsetX:w,offsetY:v,dontFlip:d})}},{key:"getAnnotations",value:function(){var n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).intent,o=n===void 0?"display":n,r=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,r.renderingIntent)}},{key:"getJSActions",value:function(){return this._transport.getPageJSActions(this._pageIndex)}},{key:"isPureXfa",get:function(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}},{key:"getXfa",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(){var o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",((o=this._transport._htmlForXfa)===null||o===void 0?void 0:o.children[this._pageIndex])||null);case 1:case"end":return r.stop()}},n,this)})),function(){return e.apply(this,arguments)})},{key:"render",value:function(n){var o,r,u,s=this,w=n.canvasContext,m=n.viewport,v=n.intent,g=v===void 0?"display":v,d=n.annotationMode,f=d===void 0?_util.AnnotationMode.ENABLE:d,y=n.transform,x=y===void 0?null:y,k=n.background,P=k===void 0?null:k,S=n.optionalContentConfigPromise,E=S===void 0?null:S,M=n.annotationCanvasMap,T=M===void 0?null:M,D=n.pageColors,N=D===void 0?null:D,I=n.printAnnotationStorage,O=I===void 0?null:I;if((r=arguments[0])!==null&&r!==void 0&&r.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(u=this._stats)===null||u===void 0||u.time("Overall");var F=this._transport.getRenderingIntent(g,f,O);_classPrivateFieldSet(this,_pendingCleanup,!1),_classPrivateMethodGet(this,_abortDelayedCleanup,_abortDelayedCleanup2).call(this),E||(E=this._transport.getOptionalContentConfig());var q=this._intentStates.get(F.cacheKey);q||(q=Object.create(null),this._intentStates.set(F.cacheKey,q)),q.streamReaderCancelTimeout&&(clearTimeout(q.streamReaderCancelTimeout),q.streamReaderCancelTimeout=null);var Y,_e=!!(F.renderingIntent&_util.RenderingIntentFlag.PRINT);q.displayReadyCapability||(q.displayReadyCapability=(0,_util.createPromiseCapability)(),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Y=this._stats)===null||Y===void 0||Y.time("Page Request"),this._pumpOperatorList(F));var ne=function(fe){var Z,j;q.renderTasks.delete(ve),(s._maybeCleanupAfterRender||_e)&&_classPrivateFieldSet(s,_pendingCleanup,!0),_classPrivateMethodGet(s,_tryCleanup,_tryCleanup2).call(s,!_e),fe?(ve.capability.reject(fe),s._abortOperatorList({intentState:q,reason:fe instanceof Error?fe:new Error(fe)})):ve.capability.resolve(),(Z=s._stats)===null||Z===void 0||Z.timeEnd("Rendering"),(j=s._stats)===null||j===void 0||j.timeEnd("Overall")},ve=new InternalRenderTask({callback:ne,params:{canvasContext:w,viewport:m,transform:x,background:P},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:T,operatorList:q.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_e,pdfBug:this._pdfBug,pageColors:N});((o=q).renderTasks||(o.renderTasks=new Set)).add(ve);var J=ve.task;return Promise.all([q.displayReadyCapability.promise,E]).then(function(fe){var Z,j=_slicedToArray(fe,2),X=j[0],H=j[1];_classPrivateFieldGet(s,_pendingCleanup)?ne():((Z=s._stats)===null||Z===void 0||Z.time("Rendering"),ve.initializeGraphics({transparency:X,optionalContentConfig:H}),ve.operatorListChanged())}).catch(ne),J}},{key:"getOperatorList",value:function(){var n,o,r,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=u.intent,w=s===void 0?"display":s,m=u.annotationMode,v=m===void 0?_util.AnnotationMode.ENABLE:m,g=u.printAnnotationStorage,d=g===void 0?null:g,f=this._transport.getRenderingIntent(w,v,d,!0),y=this._intentStates.get(f.cacheKey);return y||(y=Object.create(null),this._intentStates.set(f.cacheKey,y)),y.opListReadCapability||((n=Object.create(null)).operatorListChanged=function(){y.operatorList.lastChunk&&(y.opListReadCapability.resolve(y.operatorList),y.renderTasks.delete(n))},y.opListReadCapability=(0,_util.createPromiseCapability)(),((o=y).renderTasks||(o.renderTasks=new Set)).add(n),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(r=this._stats)===null||r===void 0||r.time("Page Request"),this._pumpOperatorList(f)),y.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeMarkedContent,o=n!==void 0&&n;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:o===!0},{highWaterMark:100,size:function(r){return r.items.length}})}},{key:"getTextContent",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(function(r){return _xfa_text.XfaText.textContent(r)});var o=this.streamTextContent(n);return new Promise(function(r,u){var s=o.getReader(),w={items:[],styles:Object.create(null)};(function m(){s.read().then(function(v){var g,d=v.value;v.done?r(w):(Object.assign(w.styles,d.styles),(g=w.items).push.apply(g,_toConsumableArray$1(d.items)),m())},u)})()})}},{key:"getStructTree",value:function(){return this._transport.getStructTree(this._pageIndex)}},{key:"_destroy",value:function(){this.destroyed=!0;var n,o=[],r=_createForOfIteratorHelper(this._intentStates.values());try{for(r.s();!(n=r.n()).done;){var u=n.value;if(this._abortOperatorList({intentState:u,reason:new Error("Page was destroyed."),force:!0}),!u.opListReadCapability){var s,w=_createForOfIteratorHelper(u.renderTasks);try{for(w.s();!(s=w.n()).done;){var m=s.value;o.push(m.completed),m.cancel()}}catch(v){w.e(v)}finally{w.f()}}}}catch(v){r.e(v)}finally{r.f()}return this.objs.clear(),_classPrivateFieldSet(this,_pendingCleanup,!1),_classPrivateMethodGet(this,_abortDelayedCleanup,_abortDelayedCleanup2).call(this),Promise.all(o)}},{key:"cleanup",value:function(){var n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];_classPrivateFieldSet(this,_pendingCleanup,!0);var o=_classPrivateMethodGet(this,_tryCleanup,_tryCleanup2).call(this,!1);return n&&o&&this._stats&&(this._stats=new _display_utils.StatTimer),o}},{key:"_startRenderPage",value:function(n,o){var r,u,s=this._intentStates.get(o);s&&((r=this._stats)===null||r===void 0||r.timeEnd("Page Request"),(u=s.displayReadyCapability)===null||u===void 0||u.resolve(n))}},{key:"_renderPageChunk",value:function(n,o){for(var r=0,u=n.length;r<u;r++)o.operatorList.fnArray.push(n.fnArray[r]),o.operatorList.argsArray.push(n.argsArray[r]);o.operatorList.lastChunk=n.lastChunk,o.operatorList.separateAnnots=n.separateAnnots;var s,w=_createForOfIteratorHelper(o.renderTasks);try{for(w.s();!(s=w.n()).done;)s.value.operatorListChanged()}catch(m){w.e(m)}finally{w.f()}n.lastChunk&&_classPrivateMethodGet(this,_tryCleanup,_tryCleanup2).call(this,!0)}},{key:"_pumpOperatorList",value:function(n){var o=this,r=n.renderingIntent,u=n.cacheKey,s=n.annotationStorageMap,w=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:r,cacheKey:u,annotationStorage:s}).getReader(),m=this._intentStates.get(u);m.streamReader=w,function v(){w.read().then(function(g){var d=g.value;g.done?m.streamReader=null:o._transport.destroyed||(o._renderPageChunk(d,m),v())},function(g){if(m.streamReader=null,!o._transport.destroyed){if(m.operatorList){m.operatorList.lastChunk=!0;var d,f=_createForOfIteratorHelper(m.renderTasks);try{for(f.s();!(d=f.n()).done;)d.value.operatorListChanged()}catch(y){f.e(y)}finally{f.f()}_classPrivateMethodGet(o,_tryCleanup,_tryCleanup2).call(o,!0)}if(m.displayReadyCapability)m.displayReadyCapability.reject(g);else{if(!m.opListReadCapability)throw g;m.opListReadCapability.reject(g)}}})}()}},{key:"_abortOperatorList",value:function(n){var o=this,r=n.intentState,u=n.reason,s=n.force,w=s!==void 0&&s;if(r.streamReader){if(r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null),!w){if(r.renderTasks.size>0)return;if(u instanceof _display_utils.RenderingCancelledException){var m=RENDERING_CANCELLED_TIMEOUT;return u.extraDelay>0&&u.extraDelay<1e3&&(m+=u.extraDelay),void(r.streamReaderCancelTimeout=setTimeout(function(){r.streamReaderCancelTimeout=null,o._abortOperatorList({intentState:r,reason:u,force:!0})},m))}}if(r.streamReader.cancel(new _util.AbortException(u.message)).catch(function(){}),r.streamReader=null,!this._transport.destroyed){var v,g=_createForOfIteratorHelper(this._intentStates);try{for(g.s();!(v=g.n()).done;){var d=_slicedToArray(v.value,2),f=d[0];if(d[1]===r){this._intentStates.delete(f);break}}}catch(y){g.e(y)}finally{g.f()}this.cleanup()}}}},{key:"stats",get:function(){return this._stats}}]);var e}();function _tryCleanup2(){var e=this,n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(_classPrivateMethodGet(this,_abortDelayedCleanup,_abortDelayedCleanup2).call(this),!_classPrivateFieldGet(this,_pendingCleanup))return!1;if(n)return _classPrivateFieldSet(this,_delayedCleanupTimeout,setTimeout(function(){_classPrivateFieldSet(e,_delayedCleanupTimeout,null),_classPrivateMethodGet(e,_tryCleanup,_tryCleanup2).call(e,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;var o,r=_createForOfIteratorHelper(this._intentStates.values());try{for(r.s();!(o=r.n()).done;){var u=o.value,s=u.renderTasks,w=u.operatorList;if(s.size>0||!w.lastChunk)return!1}}catch(m){r.e(m)}finally{r.f()}return this._intentStates.clear(),this.objs.clear(),_classPrivateFieldSet(this,_pendingCleanup,!1),!0}function _abortDelayedCleanup2(){_classPrivateFieldGet(this,_delayedCleanupTimeout)&&(clearTimeout(_classPrivateFieldGet(this,_delayedCleanupTimeout)),_classPrivateFieldSet(this,_delayedCleanupTimeout,null))}exports.PDFPageProxy=PDFPageProxy;var _listeners=new WeakMap,_deferred=new WeakMap,LoopbackPort=function(){return _createClass(function e(){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_listeners,new Set),_classPrivateFieldInitSpec(this,_deferred,Promise.resolve())},[{key:"postMessage",value:function(e,n){var o=this,r={data:structuredClone(e,n?{transfer:n}:null)};_classPrivateFieldGet2(_deferred,this).then(function(){var u,s=_createForOfIteratorHelper(_classPrivateFieldGet2(_listeners,o));try{for(s.s();!(u=s.n()).done;)u.value.call(o,r)}catch(w){s.e(w)}finally{s.f()}})}},{key:"addEventListener",value:function(e,n){_classPrivateFieldGet2(_listeners,this).add(n)}},{key:"removeEventListener",value:function(e,n){_classPrivateFieldGet2(_listeners,this).delete(n)}},{key:"terminate",value:function(){_classPrivateFieldGet2(_listeners,this).clear()}}])}();exports.LoopbackPort=LoopbackPort;var PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if((typeof document>"u"?"undefined":_typeof$1(document))==="object"){var _document,_document$currentScri,pdfjsFilePath=(_document=document)===null||_document===void 0||(_document$currentScri=_document.currentScript)===null||_document$currentScri===void 0?void 0:_document$currentScri.src;pdfjsFilePath&&(PDFWorkerUtil.fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,n){var o;try{if(!(o=new URL(e)).origin||o.origin==="null")return!1}catch{return!1}var r=new URL(n,o);return o.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(e){var n='importScripts("'.concat(e,'");');return URL.createObjectURL(new Blob([n]))};var PDFWorker=function(){function PDFWorker(){_classCallCheck(this,PDFWorker);var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.name,o=n===void 0?null:n,r=e.port,u=r===void 0?null:r,s=e.verbosity,w=s===void 0?(0,_util.getVerbosityLevel)():s;if(u&&_workerPorts._.has(u))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=w,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,u)return _workerPorts._.set(u,this),void this._initializeFromPort(u);this._initialize()}return _createClass(PDFWorker,[{key:"promise",get:function(){return this._readyCapability.promise}},{key:"port",get:function(){return this._port}},{key:"messageHandler",get:function(){return this._messageHandler}},{key:"_initializeFromPort",value:function(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}},{key:"_initialize",value:function(){var e=this;if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){var n=PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,n)||(n=PDFWorkerUtil.createCDNWrapper(new URL(n,window.location).href));var o=new Worker(n),r=new _message_handler.MessageHandler("main","worker",o),u=function(){o.removeEventListener("error",s),r.destroy(),o.terminate(),e.destroyed?e._readyCapability.reject(new Error("Worker was destroyed")):e._setupFakeWorker()},s=function(){e._webWorker||u()};o.addEventListener("error",s),r.on("test",function(m){o.removeEventListener("error",s),e.destroyed?u():m?(e._messageHandler=r,e._port=o,e._webWorker=o,e._readyCapability.resolve(),r.send("configure",{verbosity:e.verbosity})):(e._setupFakeWorker(),r.destroy(),o.terminate())}),r.on("ready",function(m){if(o.removeEventListener("error",s),e.destroyed)u();else try{w()}catch{e._setupFakeWorker()}});var w=function(){var m=new Uint8Array;r.send("test",m,[m.buffer])};return void w()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}},{key:"_setupFakeWorker",value:function(){var e=this;PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(function(n){if(e.destroyed)e._readyCapability.reject(new Error("Worker was destroyed"));else{var o=new LoopbackPort;e._port=o;var r="fake".concat(PDFWorkerUtil.fakeWorkerId++),u=new _message_handler.MessageHandler(r+"_worker",r,o);n.setup(u,o);var s=new _message_handler.MessageHandler(r,r+"_worker",o);e._messageHandler=s,e._readyCapability.resolve(),s.send("configure",{verbosity:e.verbosity})}}).catch(function(n){e._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(n.message,'".')))})}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_workerPorts._.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}}],[{key:"fromPort",value:function(e){if(e==null||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return _assertClassBrand(PDFWorker,this,_workerPorts)._.has(e.port)?_assertClassBrand(PDFWorker,this,_workerPorts)._.get(e.port):new PDFWorker(e)}},{key:"workerSrc",get:function(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}},{key:"_mainThreadWorkerMessageHandler",get:function(){try{var e;return((e=globalThis.pdfjsWorker)===null||e===void 0?void 0:e.WorkerMessageHandler)||null}catch{return null}}},{key:"_setupFakeWorkerGlobal",get:function get(){var _this14=this,loader=function(){var _ref22=_asyncToGenerator(_regeneratorRuntime().mark(function _callee3(){var mainWorkerMessageHandler,worker;return _regeneratorRuntime().wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(mainWorkerMessageHandler=_this14._mainThreadWorkerMessageHandler,!mainWorkerMessageHandler){_context3.next=3;break}return _context3.abrupt("return",mainWorkerMessageHandler);case 3:if(!_is_node.isNodeJS||typeof commonjsRequire!="function"){_context3.next=6;break}return worker=eval("require")(_this14.workerSrc),_context3.abrupt("return",worker.WorkerMessageHandler);case 6:return _context3.next=8,(0,_display_utils.loadScript)(_this14.workerSrc);case 8:return _context3.abrupt("return",window.pdfjsWorker.WorkerMessageHandler);case 9:case"end":return _context3.stop()}},_callee3)}));return function(){return _ref22.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}])}(),_workerPorts={_:new WeakMap};exports.PDFWorker=PDFWorker;var _methodPromises=new WeakMap,_pageCache=new WeakMap,_pagePromises=new WeakMap,_cacheSimpleMethod=new WeakSet,WorkerTransport=function(){return _createClass(function n(o,r,u,s,w){_classCallCheck(this,n),_classPrivateMethodInitSpec(this,_cacheSimpleMethod),_classPrivateFieldInitSpec$1(this,_methodPromises,{writable:!0,value:new Map}),_classPrivateFieldInitSpec$1(this,_pageCache,{writable:!0,value:new Map}),_classPrivateFieldInitSpec$1(this,_pagePromises,{writable:!0,value:new Map}),this.messageHandler=o,this.loadingTask=r,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this._params=s,this.canvasFactory=w.canvasFactory,this.filterFactory=w.filterFactory,this.cMapReaderFactory=w.cMapReaderFactory,this.standardFontDataFactory=w.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=u,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()},[{key:"annotationStorage",get:function(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}},{key:"getRenderingIntent",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=arguments.length>3&&arguments[3]!==void 0&&arguments[3],s=_util.RenderingIntentFlag.DISPLAY,w=null;switch(n){case"any":s=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":s=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)("getRenderingIntent - invalid intent: ".concat(n))}switch(o){case _util.AnnotationMode.DISABLE:s+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:s+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:w=((s+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE)&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)("getRenderingIntent - invalid annotationMode: ".concat(o))}return u&&(s+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:s,cacheKey:"".concat(s,"_").concat(_annotation_storage.AnnotationStorage.getHash(w)),annotationStorageMap:w}}},{key:"destroy",value:function(){var n=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var o,r=[],u=_createForOfIteratorHelper(_classPrivateFieldGet(this,_pageCache).values());try{for(u.s();!(o=u.n()).done;){var s=o.value;r.push(s._destroy())}}catch(m){u.e(m)}finally{u.f()}_classPrivateFieldGet(this,_pageCache).clear(),_classPrivateFieldGet(this,_pagePromises).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();var w=this.messageHandler.sendWithPromise("Terminate",null);return r.push(w),Promise.all(r).then(function(){n.commonObjs.clear(),n.fontLoader.clear(),_classPrivateFieldGet(n,_methodPromises).clear(),n.filterFactory.destroy(),n._networkStream&&n._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),n.messageHandler&&(n.messageHandler.destroy(),n.messageHandler=null),n.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var n=this,o=this.messageHandler,r=this.loadingTask;o.on("GetReader",function(u,s){(0,_util.assert)(n._networkStream,"GetReader - no `IPDFStream` instance available."),n._fullReader=n._networkStream.getFullReader(),n._fullReader.onProgress=function(w){n._lastProgress={loaded:w.loaded,total:w.total}},s.onPull=function(){n._fullReader.read().then(function(w){var m=w.value;w.done?s.close():((0,_util.assert)(m instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(m),1,[m]))}).catch(function(w){s.error(w)})},s.onCancel=function(w){n._fullReader.cancel(w),s.ready.catch(function(m){if(!n.destroyed)throw m})}}),o.on("ReaderHeadersReady",function(u){var s=(0,_util.createPromiseCapability)(),w=n._fullReader;return w.headersReady.then(function(){var m;w.isStreamingSupported&&w.isRangeSupported||(n._lastProgress&&((m=r.onProgress)===null||m===void 0||m.call(r,n._lastProgress)),w.onProgress=function(v){var g;(g=r.onProgress)===null||g===void 0||g.call(r,{loaded:v.loaded,total:v.total})}),s.resolve({isStreamingSupported:w.isStreamingSupported,isRangeSupported:w.isRangeSupported,contentLength:w.contentLength})},s.reject),s.promise}),o.on("GetRangeReader",function(u,s){(0,_util.assert)(n._networkStream,"GetRangeReader - no `IPDFStream` instance available.");var w=n._networkStream.getRangeReader(u.begin,u.end);w?(s.onPull=function(){w.read().then(function(m){var v=m.value;m.done?s.close():((0,_util.assert)(v instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(v),1,[v]))}).catch(function(m){s.error(m)})},s.onCancel=function(m){w.cancel(m),s.ready.catch(function(v){if(!n.destroyed)throw v})}):s.close()}),o.on("GetDoc",function(u){var s=u.pdfInfo;n._numPages=s.numPages,n._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,r._capability.resolve(new PDFDocumentProxy(s,n))}),o.on("DocException",function(u){var s;switch(u.name){case"PasswordException":s=new _util.PasswordException(u.message,u.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(u.message);break;case"MissingPDFException":s=new _util.MissingPDFException(u.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(u.message,u.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(u.message,u.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}r._capability.reject(s)}),o.on("PasswordRequest",function(u){if(n._passwordCapability=(0,_util.createPromiseCapability)(),r.onPassword)try{r.onPassword(function(s){s instanceof Error?n._passwordCapability.reject(s):n._passwordCapability.resolve({password:s})},u.code)}catch(s){n._passwordCapability.reject(s)}else n._passwordCapability.reject(new _util.PasswordException(u.message,u.code));return n._passwordCapability.promise}),o.on("DataLoaded",function(u){var s;(s=r.onProgress)===null||s===void 0||s.call(r,{loaded:u.length,total:u.length}),n.downloadInfoCapability.resolve(u)}),o.on("StartRenderPage",function(u){n.destroyed||_classPrivateFieldGet(n,_pageCache).get(u.pageIndex)._startRenderPage(u.transparency,u.cacheKey)}),o.on("commonobj",function(u){var s,w=_slicedToArray(u,3),m=w[0],v=w[1],g=w[2];if(!n.destroyed&&!n.commonObjs.has(m))switch(v){case"Font":var d=n._params;if("error"in g){var f=g.error;(0,_util.warn)("Error during font loading: ".concat(f)),n.commonObjs.resolve(m,f);break}var y=d.pdfBug&&(s=globalThis.FontInspector)!==null&&s!==void 0&&s.enabled?function(k,P){return globalThis.FontInspector.fontAdded(k,P)}:null,x=new _font_loader.FontFaceObject(g,{isEvalSupported:d.isEvalSupported,disableFontFace:d.disableFontFace,ignoreErrors:d.ignoreErrors,inspectFont:y});n.fontLoader.bind(x).catch(function(k){return o.sendWithPromise("FontFallback",{id:m})}).finally(function(){!d.fontExtraProperties&&x.data&&(x.data=null),n.commonObjs.resolve(m,x)});break;case"FontPath":case"Image":case"Pattern":n.commonObjs.resolve(m,g);break;default:throw new Error("Got unknown common object type ".concat(v))}}),o.on("obj",function(u){var s=_slicedToArray(u,4),w=s[0],m=s[1],v=s[2],g=s[3];if(!n.destroyed){var d=_classPrivateFieldGet(n,_pageCache).get(m);if(!d.objs.has(w))switch(v){case"Image":var f;d.objs.resolve(w,g),g&&(g.bitmap?g.width*g.height*4:((f=g.data)===null||f===void 0?void 0:f.length)||0)>_util.MAX_IMAGE_SIZE_TO_CACHE&&(d._maybeCleanupAfterRender=!0);break;case"Pattern":d.objs.resolve(w,g);break;default:throw new Error("Got unknown object type ".concat(v))}}}),o.on("DocProgress",function(u){var s;n.destroyed||(s=r.onProgress)===null||s===void 0||s.call(r,{loaded:u.loaded,total:u.total})}),o.on("FetchBuiltInCMap",function(u){return n.destroyed?Promise.reject(new Error("Worker was destroyed.")):n.cMapReaderFactory?n.cMapReaderFactory.fetch(u):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))}),o.on("FetchStandardFontData",function(u){return n.destroyed?Promise.reject(new Error("Worker was destroyed.")):n.standardFontDataFactory?n.standardFontDataFactory.fetch(u):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))})}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"saveDocument",value:function(){var n,o,r=this;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(n=(o=this._fullReader)===null||o===void 0?void 0:o.filename)!==null&&n!==void 0?n:null}).finally(function(){r.annotationStorage.resetModified()})}},{key:"getPage",value:function(n){var o=this;if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));var r=n-1,u=_classPrivateFieldGet(this,_pagePromises).get(r);if(u)return u;var s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then(function(w){if(o.destroyed)throw new Error("Transport destroyed");var m=new PDFPageProxy(r,w,o,o._params.pdfBug);return _classPrivateFieldGet(o,_pageCache).set(r,m),m});return _classPrivateFieldGet(this,_pagePromises).set(r,s),s}},{key:"getPageIndex",value:function(n){return _typeof$1(n)!=="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}},{key:"getAnnotations",value:function(n,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:o})}},{key:"getFieldObjects",value:function(){return _classPrivateMethodGet(this,_cacheSimpleMethod,_cacheSimpleMethod2).call(this,"GetFieldObjects")}},{key:"hasJSActions",value:function(){return _classPrivateMethodGet(this,_cacheSimpleMethod,_cacheSimpleMethod2).call(this,"HasJSActions")}},{key:"getCalculationOrderIds",value:function(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageLayout",value:function(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getViewerPreferences",value:function(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}},{key:"getOpenAction",value:function(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getDocJSActions",value:function(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}},{key:"getPageJSActions",value:function(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}},{key:"getStructTree",value:function(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getOptionalContentConfig",value:function(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(function(n){return new _optional_content_config.OptionalContentConfig(n)})}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var n=this,o="GetMetadata",r=_classPrivateFieldGet(this,_methodPromises).get(o);if(r)return r;var u=this.messageHandler.sendWithPromise(o,null).then(function(s){var w,m,v,g;return{info:s[0],metadata:s[1]?new _metadata.Metadata(s[1]):null,contentDispositionFilename:(w=(v=n._fullReader)===null||v===void 0?void 0:v.filename)!==null&&w!==void 0?w:null,contentLength:(m=(g=n._fullReader)===null||g===void 0?void 0:g.contentLength)!==null&&m!==void 0?m:null}});return _classPrivateFieldGet(this,_methodPromises).set(o,u),u}},{key:"getMarkInfo",value:function(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}},{key:"startCleanup",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(){var o,r,u,s,w=arguments;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o=w.length>0&&w[0]!==void 0&&w[0],!this.destroyed){m.next=3;break}return m.abrupt("return");case 3:return m.next=5,this.messageHandler.sendWithPromise("Cleanup",null);case 5:r=_createForOfIteratorHelper(_classPrivateFieldGet(this,_pageCache).values()),m.prev=6,r.s();case 8:if((u=r.n()).done){m.next=15;break}if((s=u.value).cleanup()){m.next=13;break}throw new Error("startCleanup: Page ".concat(s.pageNumber," is currently rendering."));case 13:m.next=8;break;case 15:m.next=20;break;case 17:m.prev=17,m.t0=m.catch(6),r.e(m.t0);case 20:return m.prev=20,r.f(),m.finish(20);case 23:this.commonObjs.clear(),o||this.fontLoader.clear(),_classPrivateFieldGet(this,_methodPromises).clear(),this.filterFactory.destroy(!0);case 27:case"end":return m.stop()}},n,this,[[6,17,20,23]])})),function(){return e.apply(this,arguments)})},{key:"loadingParams",get:function(){var n=this._params,o=n.disableAutoFetch,r=n.enableXfa;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:r})}}]);var e}();function _cacheSimpleMethod2(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=_classPrivateFieldGet(this,_methodPromises).get(e);if(o)return o;var r=this.messageHandler.sendWithPromise(e,n);return _classPrivateFieldGet(this,_methodPromises).set(e,r),r}var _objs=new WeakMap,_ensureObj=new WeakSet,PDFObjects=function(){return _createClass(function e(){_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_ensureObj),_classPrivateFieldInitSpec$1(this,_objs,{writable:!0,value:Object.create(null)})},[{key:"get",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(n){var o=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,e);return o.capability.promise.then(function(){return n(o.data)}),null}var r=_classPrivateFieldGet(this,_objs)[e];if(r==null||!r.capability.settled)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return r.data}},{key:"has",value:function(e){var n=_classPrivateFieldGet(this,_objs)[e];return(n==null?void 0:n.capability.settled)||!1}},{key:"resolve",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,e);o.data=n,o.capability.resolve()}},{key:"clear",value:function(){for(var e in _classPrivateFieldGet(this,_objs)){var n,o=_classPrivateFieldGet(this,_objs)[e].data;o==null||(n=o.bitmap)===null||n===void 0||n.close()}_classPrivateFieldSet(this,_objs,Object.create(null))}}])}();function _ensureObj2(e){var n=_classPrivateFieldGet(this,_objs)[e];return n||(_classPrivateFieldGet(this,_objs)[e]={capability:(0,_util.createPromiseCapability)(),data:null})}var _internalRenderTask=new WeakMap,RenderTask=function(){return _createClass(function e(n){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_internalRenderTask,null),_classPrivateFieldSet2(_internalRenderTask,this,n),this.onContinue=null},[{key:"promise",get:function(){return _classPrivateFieldGet2(_internalRenderTask,this).capability.promise}},{key:"cancel",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;_classPrivateFieldGet2(_internalRenderTask,this).cancel(null,e)}},{key:"separateAnnots",get:function(){var e=_classPrivateFieldGet2(_internalRenderTask,this).operatorList.separateAnnots;if(!e)return!1;var n=_classPrivateFieldGet2(_internalRenderTask,this).annotationCanvasMap;return e.form||e.canvas&&(n==null?void 0:n.size)>0}}])}();exports.RenderTask=RenderTask;var InternalRenderTask=function(){return _createClass(function n(o){_classCallCheck(this,n);var r=o.callback,u=o.params,s=o.objs,w=o.commonObjs,m=o.annotationCanvasMap,v=o.operatorList,g=o.pageIndex,d=o.canvasFactory,f=o.filterFactory,y=o.useRequestAnimationFrame,x=y!==void 0&&y,k=o.pdfBug,P=k!==void 0&&k,S=o.pageColors,E=S===void 0?null:S;this.callback=r,this.params=u,this.objs=s,this.commonObjs=w,this.annotationCanvasMap=m,this.operatorListIdx=null,this.operatorList=v,this._pageIndex=g,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=P,this.pageColors=E,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=x===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=u.canvasContext.canvas},[{key:"completed",get:function(){return this.capability.promise.catch(function(){})}},{key:"initializeGraphics",value:function(n){var o,r,u=n.transparency,s=u!==void 0&&u,w=n.optionalContentConfig;if(!this.cancelled){if(this._canvas){if(_canvasInUse._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_canvasInUse._.add(this._canvas)}this._pdfBug&&(o=globalThis.StepperManager)!==null&&o!==void 0&&o.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var m=this.params,v=m.canvasContext,g=m.viewport,d=m.transform,f=m.background;this.gfx=new _canvas.CanvasGraphics(v,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:w},this.annotationCanvasMap),this.gfx.beginDrawing({transform:d,viewport:g,transparency:s,background:f}),this.operatorListIdx=0,this.graphicsReady=!0,(r=this.graphicsReadyCallback)===null||r===void 0||r.call(this)}}},{key:"cancel",value:function(){var n,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.running=!1,this.cancelled=!0,(n=this.gfx)===null||n===void 0||n.endDrawing(this.pageColors),this._canvas&&_canvasInUse._.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException("Rendering cancelled, page ".concat(this._pageIndex+1),"canvas",r))}},{key:"operatorListChanged",value:function(){var n;this.graphicsReady?((n=this.stepper)===null||n===void 0||n.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var n=this;this._useRequestAnimationFrame?window.requestAnimationFrame(function(){n._nextBound().catch(n._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}},{key:"_next",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.cancelled){o.next=2;break}return o.abrupt("return");case 2:this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&_canvasInUse._.delete(this._canvas),this.callback()));case 4:case"end":return o.stop()}},n,this)})),function(){return e.apply(this,arguments)})}]);var e}(),_canvasInUse={_:new WeakSet},version="3.5.141";exports.version=version;var build="be0f6ee08";exports.build=build},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var r=o(1),u=o(140),s=o(144);function w(M,T,D){m(M,T),T.set(M,D)}function m(M,T){if(T.has(M))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v(M,T,D){return function(N,I,O){if(I.set)I.set.call(N,O);else{if(!I.writable)throw new TypeError("attempted to set read only private field");I.value=O}}(M,d(M,T,"set"),D),D}function g(M,T){return function(D,N){return N.get?N.get.call(D):N.value}(M,d(M,T,"get"))}function d(M,T,D){if(!T.has(M))throw new TypeError("attempted to "+D+" private field on non-instance");return T.get(M)}var f=new WeakMap,y=new WeakMap,x=new WeakSet,k=function(){return _createClass(function M(){var T,D;_classCallCheck(this,M),m(T=this,D=x),D.add(T),w(this,f,{writable:!0,value:!1}),w(this,y,{writable:!0,value:new Map}),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null},[{key:"getValue",value:function(M,T){var D=g(this,y).get(M);return D===void 0?T:Object.assign(T,D)}},{key:"getRawValue",value:function(M){return g(this,y).get(M)}},{key:"remove",value:function(M){if(g(this,y).delete(M),g(this,y).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){var T,D=_createForOfIteratorHelper(g(this,y).values());try{for(D.s();!(T=D.n()).done;)if(T.value instanceof u.AnnotationEditor)return}catch(N){D.e(N)}finally{D.f()}this.onAnnotationEditor(null)}}},{key:"setValue",value:function(M,T){var D=g(this,y).get(M),N=!1;if(D!==void 0)for(var I=0,O=Object.entries(T);I<O.length;I++){var F=_slicedToArray(O[I],2),q=F[0],Y=F[1];D[q]!==Y&&(N=!0,D[q]=Y)}else N=!0,g(this,y).set(M,T);N&&function(_e,ne,ve){if(!ne.has(_e))throw new TypeError("attempted to get private field on non-instance");return ve}(this,x,P).call(this),T instanceof u.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(T.constructor._type)}},{key:"has",value:function(M){return g(this,y).has(M)}},{key:"getAll",value:function(){return g(this,y).size>0?(0,r.objectFromMap)(g(this,y)):null}},{key:"setAll",value:function(M){for(var T=0,D=Object.entries(M);T<D.length;T++){var N=_slicedToArray(D[T],2),I=N[0],O=N[1];this.setValue(I,O)}}},{key:"size",get:function(){return g(this,y).size}},{key:"resetModified",value:function(){g(this,f)&&(v(this,f,!1),typeof this.onResetModified=="function"&&this.onResetModified())}},{key:"print",get:function(){return new E(this)}},{key:"serializable",get:function(){if(g(this,y).size===0)return null;var M,T=new Map,D=_createForOfIteratorHelper(g(this,y));try{for(D.s();!(M=D.n()).done;){var N=_slicedToArray(M.value,2),I=N[0],O=N[1],F=O instanceof u.AnnotationEditor?O.serialize():O;F&&T.set(I,F)}}catch(q){D.e(q)}finally{D.f()}return T}}],[{key:"getHash",value:function(M){if(!M)return"";var T,D=new s.MurmurHash3_64,N=_createForOfIteratorHelper(M);try{for(N.s();!(T=N.n()).done;){var I=_slicedToArray(T.value,2),O=I[0],F=I[1];D.update("".concat(O,":").concat(JSON.stringify(F)))}}catch(q){N.e(q)}finally{N.f()}return D.hexdigest()}}])}();function P(){g(this,f)||(v(this,f,!0),typeof this.onSetModified=="function"&&this.onSetModified())}n.AnnotationStorage=k;var S=new WeakMap,E=function(M){function T(D){var N;return _classCallCheck(this,T),_classPrivateFieldInitSpec(N=_callSuper(this,T),S,null),_classPrivateFieldSet2(S,N,structuredClone(D.serializable)),N}return _inherits(T,M),_createClass(T,[{key:"print",get:function(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}},{key:"serializable",get:function(){return _classPrivateFieldGet2(S,this)}}])}(k);n.PrintAnnotationStorage=E},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var r=o(141),u=o(1),s=new WeakMap,w=new WeakMap,m=new WeakMap,v=new WeakMap,g=new WeakMap,d=new WeakMap,f=function(){return _createClass(function y(x){_classCallCheck(this,y),_classPrivateFieldInitSpec(this,s,this.focusin.bind(this)),_classPrivateFieldInitSpec(this,w,this.focusout.bind(this)),_classPrivateFieldInitSpec(this,m,!1),_classPrivateFieldInitSpec(this,v,!1),_classPrivateFieldInitSpec(this,g,!1),_defineProperty$1(this,"_uiManager",null),_classPrivateFieldInitSpec(this,d,y._zIndex++),this.constructor===y&&(0,u.unreachable)("Cannot initialize AnnotationEditor."),this.parent=x.parent,this.id=x.id,this.width=this.height=null,this.pageIndex=x.parent.pageIndex,this.name=x.name,this.div=null,this._uiManager=x.uiManager;var k=this.parent.viewport,P=k.rotation,S=k.rawDims,E=S.pageWidth,M=S.pageHeight,T=S.pageX,D=S.pageY;this.rotation=P,this.pageDimensions=[E,M],this.pageTranslation=[T,D];var N=_slicedToArray(this.parentDimensions,2),I=N[0],O=N[1];this.x=x.x/I,this.y=x.y/O,this.isAttachedToDOM=!1},[{key:"addCommands",value:function(y){this._uiManager.addCommands(y)}},{key:"currentLayer",get:function(){return this._uiManager.currentLayer}},{key:"setInBackground",value:function(){this.div.style.zIndex=0}},{key:"setInForeground",value:function(){this.div.style.zIndex=_classPrivateFieldGet2(d,this)}},{key:"setParent",value:function(y){y!==null&&(this.pageIndex=y.pageIndex,this.pageDimensions=y.pageDimensions),this.parent=y}},{key:"focusin",value:function(y){_classPrivateFieldGet2(m,this)?_classPrivateFieldSet2(m,this,!1):this.parent.setSelected(this)}},{key:"focusout",value:function(y){var x;if(this.isAttachedToDOM){var k=y.relatedTarget;k!=null&&k.closest("#".concat(this.id))||(y.preventDefault(),(x=this.parent)!==null&&x!==void 0&&x.isMultipleSelection||this.commitOrRemove())}}},{key:"commitOrRemove",value:function(){this.isEmpty()?this.remove():this.commit()}},{key:"commit",value:function(){this.addToAnnotationStorage()}},{key:"addToAnnotationStorage",value:function(){this._uiManager.addToAnnotationStorage(this)}},{key:"dragstart",value:function(y){var x=this.parent.div.getBoundingClientRect();this.startX=y.clientX-x.x,this.startY=y.clientY-x.y,y.dataTransfer.setData("text/plain",this.id),y.dataTransfer.effectAllowed="move"}},{key:"setAt",value:function(y,x,k,P){var S=_slicedToArray(this.parentDimensions,2),E=S[0],M=S[1],T=_slicedToArray(this.screenToPageTranslation(k,P),2);k=T[0],P=T[1],this.x=(y+k)/E,this.y=(x+P)/M,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"translate",value:function(y,x){var k=_slicedToArray(this.parentDimensions,2),P=k[0],S=k[1],E=_slicedToArray(this.screenToPageTranslation(y,x),2);y=E[0],x=E[1],this.x+=y/P,this.y+=x/S,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"screenToPageTranslation",value:function(y,x){switch(this.parentRotation){case 90:return[x,-y];case 180:return[-y,-x];case 270:return[-x,y];default:return[y,x]}}},{key:"parentScale",get:function(){return this._uiManager.viewParameters.realScale}},{key:"parentRotation",get:function(){return this._uiManager.viewParameters.rotation}},{key:"parentDimensions",get:function(){var y=this._uiManager.viewParameters.realScale,x=_slicedToArray(this.pageDimensions,2);return[x[0]*y,x[1]*y]}},{key:"setDims",value:function(y,x){var k=_slicedToArray(this.parentDimensions,2),P=k[0],S=k[1];this.div.style.width="".concat(100*y/P,"%"),this.div.style.height="".concat(100*x/S,"%")}},{key:"fixDims",value:function(){var y=this.div.style,x=y.height,k=y.width,P=k.endsWith("%"),S=x.endsWith("%");if(!P||!S){var E=_slicedToArray(this.parentDimensions,2),M=E[0],T=E[1];P||(y.width="".concat(100*parseFloat(k)/M,"%")),S||(y.height="".concat(100*parseFloat(x)/T,"%"))}}},{key:"getInitialTranslation",value:function(){return[0,0]}},{key:"render",value:function(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",_classPrivateFieldGet2(s,this)),this.div.addEventListener("focusout",_classPrivateFieldGet2(w,this));var y=_slicedToArray(this.getInitialTranslation(),2),x=y[0],k=y[1];return this.translate(x,k),(0,r.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}},{key:"pointerdown",value:function(y){var x=u.FeatureTest.platform.isMac;y.button!==0||y.ctrlKey&&x?y.preventDefault():(y.ctrlKey&&!x||y.shiftKey||y.metaKey&&x?this.parent.toggleSelected(this):this.parent.setSelected(this),_classPrivateFieldSet2(m,this,!0))}},{key:"getRect",value:function(y,x){var k=this.parentScale,P=_slicedToArray(this.pageDimensions,2),S=P[0],E=P[1],M=_slicedToArray(this.pageTranslation,2),T=M[0],D=M[1],N=y/k,I=x/k,O=this.x*S,F=this.y*E,q=this.width*S,Y=this.height*E;switch(this.rotation){case 0:return[O+N+T,E-F-I-Y+D,O+N+q+T,E-F-I+D];case 90:return[O+I+T,E-F+N+D,O+I+Y+T,E-F+N+q+D];case 180:return[O-N-q+T,E-F+I+D,O-N+T,E-F+I+Y+D];case 270:return[O-I-Y+T,E-F-N-q+D,O-I+T,E-F-N+D];default:throw new Error("Invalid rotation")}}},{key:"getRectInCurrentCoords",value:function(y,x){var k=_slicedToArray(y,4),P=k[0],S=k[1],E=k[2],M=k[3],T=E-P,D=M-S;switch(this.rotation){case 0:return[P,x-M,T,D];case 90:return[P,x-S,D,T];case 180:return[E,x-S,T,D];case 270:return[E,x-M,D,T];default:throw new Error("Invalid rotation")}}},{key:"onceAdded",value:function(){}},{key:"isEmpty",value:function(){return!1}},{key:"enableEditMode",value:function(){_classPrivateFieldSet2(g,this,!0)}},{key:"disableEditMode",value:function(){_classPrivateFieldSet2(g,this,!1)}},{key:"isInEditMode",value:function(){return _classPrivateFieldGet2(g,this)}},{key:"shouldGetKeyboardEvents",value:function(){return!1}},{key:"needsToBeRebuilt",value:function(){return this.div&&!this.isAttachedToDOM}},{key:"rebuild",value:function(){var y;(y=this.div)===null||y===void 0||y.addEventListener("focusin",_classPrivateFieldGet2(s,this))}},{key:"serialize",value:function(){(0,u.unreachable)("An editor must be serializable")}},{key:"remove",value:function(){this.div.removeEventListener("focusin",_classPrivateFieldGet2(s,this)),this.div.removeEventListener("focusout",_classPrivateFieldGet2(w,this)),this.isEmpty()||this.commit(),this.parent.remove(this)}},{key:"select",value:function(){var y;(y=this.div)===null||y===void 0||y.classList.add("selectedEditor")}},{key:"unselect",value:function(){var y;(y=this.div)===null||y===void 0||y.classList.remove("selectedEditor")}},{key:"updateParams",value:function(y,x){}},{key:"disableEditing",value:function(){}},{key:"enableEditing",value:function(){}},{key:"propertiesToUpdate",get:function(){return{}}},{key:"contentDiv",get:function(){return this.div}},{key:"isEditing",get:function(){return _classPrivateFieldGet2(v,this)},set:function(y){_classPrivateFieldSet2(v,this,y),y?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}],[{key:"_defaultLineColor",get:function(){return(0,u.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}},{key:"deserialize",value:function(y,x,k){var P=new this.prototype.constructor({parent:x,id:x.getNextId(),uiManager:k});P.rotation=y.rotation;var S=_slicedToArray(P.pageDimensions,2),E=S[0],M=S[1],T=_slicedToArray(P.getRectInCurrentCoords(y.rect,M),4),D=T[0],N=T[1],I=T[2],O=T[3];return P.x=D/E,P.y=N/M,P.width=I/E,P.height=O/M,P}}])}();_defineProperty$1(f,"_colorManager",new r.ColorManager),_defineProperty$1(f,"_zIndex",1),n.AnnotationEditor=f},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=function(bt,ot,gt){var tt,ut=_createForOfIteratorHelper(gt);try{for(ut.s();!(tt=ut.n()).done;){var Re=tt.value;ot.addEventListener(Re,bt[Re].bind(bt))}}catch(Te){ut.e(Te)}finally{ut.f()}},n.opacityToHex=function(bt){return Math.round(Math.min(255,Math.max(1,255*bt))).toString(16).padStart(2,"0")};var r=o(1),u=o(142);function s(bt,ot,gt){d(bt,ot),ot.set(bt,gt)}function w(bt,ot){return function(gt,tt){return tt.get?tt.get.call(gt):tt.value}(bt,v(bt,ot,"get"))}function m(bt,ot,gt){return function(tt,ut,Re){if(ut.set)ut.set.call(tt,Re);else{if(!ut.writable)throw new TypeError("attempted to set read only private field");ut.value=Re}}(bt,v(bt,ot,"set"),gt),gt}function v(bt,ot,gt){if(!ot.has(bt))throw new TypeError("attempted to "+gt+" private field on non-instance");return ot.get(bt)}function g(bt,ot){d(bt,ot),ot.add(bt)}function d(bt,ot){if(ot.has(bt))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(bt,ot,gt){if(!ot.has(bt))throw new TypeError("attempted to get private field on non-instance");return gt}var y=new WeakMap,x=function(){return _createClass(function bt(){_classCallCheck(this,bt),_classPrivateFieldInitSpec(this,y,0)},[{key:"getId",value:function(){var bt,ot;return"".concat(r.AnnotationEditorPrefix).concat((_classPrivateFieldSet2(y,this,(bt=_classPrivateFieldGet2(y,this),ot=bt++,bt)),ot))}}])}(),k=new WeakMap,P=new WeakMap,S=new WeakMap,E=new WeakMap,M=function(){return _createClass(function bt(){_classCallCheck(this,bt),_classPrivateFieldInitSpec(this,k,[]),_classPrivateFieldInitSpec(this,P,!1),_classPrivateFieldInitSpec(this,S,void 0),_classPrivateFieldInitSpec(this,E,-1),_classPrivateFieldSet2(S,this,arguments.length>0&&arguments[0]!==void 0?arguments[0]:128)},[{key:"add",value:function(bt){var ot=bt.cmd,gt=bt.undo,tt=bt.mustExec,ut=bt.type,Re=ut===void 0?NaN:ut,Te=bt.overwriteIfSameType,He=Te!==void 0&&Te,Fe=bt.keepUndo,ze=Fe!==void 0&&Fe;if(tt&&ot(),!_classPrivateFieldGet2(P,this)){var We={cmd:ot,undo:gt,type:Re};if(_classPrivateFieldGet2(E,this)===-1)return _classPrivateFieldGet2(k,this).length>0&&(_classPrivateFieldGet2(k,this).length=0),_classPrivateFieldSet2(E,this,0),void _classPrivateFieldGet2(k,this).push(We);if(He&&_classPrivateFieldGet2(k,this)[_classPrivateFieldGet2(E,this)].type===Re)return ze&&(We.undo=_classPrivateFieldGet2(k,this)[_classPrivateFieldGet2(E,this)].undo),void(_classPrivateFieldGet2(k,this)[_classPrivateFieldGet2(E,this)]=We);var Ue=_classPrivateFieldGet2(E,this)+1;Ue===_classPrivateFieldGet2(S,this)?_classPrivateFieldGet2(k,this).splice(0,1):(_classPrivateFieldSet2(E,this,Ue),Ue<_classPrivateFieldGet2(k,this).length&&_classPrivateFieldGet2(k,this).splice(Ue)),_classPrivateFieldGet2(k,this).push(We)}}},{key:"undo",value:function(){_classPrivateFieldGet2(E,this)!==-1&&(_classPrivateFieldSet2(P,this,!0),_classPrivateFieldGet2(k,this)[_classPrivateFieldGet2(E,this)].undo(),_classPrivateFieldSet2(P,this,!1),_classPrivateFieldSet2(E,this,_classPrivateFieldGet2(E,this)-1))}},{key:"redo",value:function(){_classPrivateFieldGet2(E,this)<_classPrivateFieldGet2(k,this).length-1&&(_classPrivateFieldSet2(E,this,_classPrivateFieldGet2(E,this)+1),_classPrivateFieldSet2(P,this,!0),_classPrivateFieldGet2(k,this)[_classPrivateFieldGet2(E,this)].cmd(),_classPrivateFieldSet2(P,this,!1))}},{key:"hasSomethingToUndo",value:function(){return _classPrivateFieldGet2(E,this)!==-1}},{key:"hasSomethingToRedo",value:function(){return _classPrivateFieldGet2(E,this)<_classPrivateFieldGet2(k,this).length-1}},{key:"destroy",value:function(){_classPrivateFieldSet2(k,this,null)}}])}();n.CommandManager=M;var T=new WeakSet,D=function(){return _createClass(function bt(ot){_classCallCheck(this,bt),g(this,T),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;var gt,tt=r.FeatureTest.platform.isMac,ut=_createForOfIteratorHelper(ot);try{for(ut.s();!(gt=ut.n()).done;){var Re,Te=_slicedToArray(gt.value,2),He=Te[0],Fe=Te[1],ze=_createForOfIteratorHelper(He);try{for(ze.s();!(Re=ze.n()).done;){var We=Re.value,Ue=We.startsWith("mac+");tt&&Ue?(this.callbacks.set(We.slice(4),Fe),this.allKeys.add(We.split("+").at(-1))):tt||Ue||(this.callbacks.set(We,Fe),this.allKeys.add(We.split("+").at(-1)))}}catch(et){ze.e(et)}finally{ze.f()}}}catch(et){ut.e(et)}finally{ut.f()}},[{key:"exec",value:function(bt,ot){if(this.allKeys.has(ot.key)){var gt=this.callbacks.get(f(this,T,N).call(this,ot));gt&&(gt.bind(bt)(),ot.stopPropagation(),ot.preventDefault())}}}])}();function N(bt){bt.altKey&&this.buffer.push("alt"),bt.ctrlKey&&this.buffer.push("ctrl"),bt.metaKey&&this.buffer.push("meta"),bt.shiftKey&&this.buffer.push("shift"),this.buffer.push(bt.key);var ot=this.buffer.join("+");return this.buffer.length=0,ot}n.KeyboardManager=D;var I=function(){function bt(){_classCallCheck(this,bt)}return _createClass(bt,[{key:"_colors",get:function(){var ot=new Map([["CanvasText",null],["Canvas",null]]);return(0,u.getColorValues)(ot),(0,r.shadow)(this,"_colors",ot)}},{key:"convert",value:function(ot){var gt=(0,u.getRGB)(ot);if(!window.matchMedia("(forced-colors: active)").matches)return gt;var tt,ut=_createForOfIteratorHelper(this._colors);try{for(ut.s();!(tt=ut.n()).done;){var Re=_slicedToArray(tt.value,2),Te=Re[0];if(Re[1].every(function(He,Fe){return He===gt[Fe]}))return bt._colorsMapping.get(Te)}}catch(He){ut.e(He)}finally{ut.f()}return gt}},{key:"getHexCode",value:function(ot){var gt,tt=this._colors.get(ot);return tt?(gt=r.Util).makeHexColor.apply(gt,_toConsumableArray$1(tt)):ot}}])}();_defineProperty$1(I,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),n.ColorManager=I;var O=new WeakMap,F=new WeakMap,q=new WeakMap,Y=new WeakMap,_e=new WeakMap,ne=new WeakMap,ve=new WeakMap,J=new WeakMap,fe=new WeakMap,Z=new WeakMap,j=new WeakMap,X=new WeakMap,H=new WeakMap,U=new WeakMap,te=new WeakMap,Q=new WeakMap,re=new WeakMap,Pe=new WeakMap,be=new WeakMap,we=new WeakMap,Ae=new WeakMap,$e=new WeakMap,Me=new WeakMap,Ie=new WeakSet,Le=new WeakSet,le=new WeakSet,oe=new WeakSet,ke=new WeakSet,Ce=new WeakSet,Ee=new WeakSet,Be=new WeakSet,Ve=new WeakSet,Oe=new WeakSet,je=new WeakSet,Ge=function(){function bt(ot,gt,tt){_classCallCheck(this,bt),g(this,je),g(this,Oe),g(this,Ve),g(this,Be),g(this,Ee),g(this,Ce),g(this,ke),g(this,oe),g(this,le),g(this,Le),g(this,Ie),s(this,O,{writable:!0,value:null}),s(this,F,{writable:!0,value:new Map}),s(this,q,{writable:!0,value:new Map}),s(this,Y,{writable:!0,value:null}),s(this,_e,{writable:!0,value:new M}),s(this,ne,{writable:!0,value:0}),s(this,ve,{writable:!0,value:null}),s(this,J,{writable:!0,value:new Set}),s(this,fe,{writable:!0,value:null}),s(this,Z,{writable:!0,value:new x}),s(this,j,{writable:!0,value:!1}),s(this,X,{writable:!0,value:r.AnnotationEditorType.NONE}),s(this,H,{writable:!0,value:new Set}),s(this,U,{writable:!0,value:this.copy.bind(this)}),s(this,te,{writable:!0,value:this.cut.bind(this)}),s(this,Q,{writable:!0,value:this.paste.bind(this)}),s(this,re,{writable:!0,value:this.keydown.bind(this)}),s(this,Pe,{writable:!0,value:this.onEditingAction.bind(this)}),s(this,be,{writable:!0,value:this.onPageChanging.bind(this)}),s(this,we,{writable:!0,value:this.onScaleChanging.bind(this)}),s(this,Ae,{writable:!0,value:this.onRotationChanging.bind(this)}),s(this,$e,{writable:!0,value:{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}}),s(this,Me,{writable:!0,value:null}),m(this,Me,ot),m(this,fe,gt),w(this,fe)._on("editingaction",w(this,Pe)),w(this,fe)._on("pagechanging",w(this,be)),w(this,fe)._on("scalechanging",w(this,we)),w(this,fe)._on("rotationchanging",w(this,Ae)),m(this,Y,tt),this.viewParameters={realScale:u.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}return _createClass(bt,[{key:"destroy",value:function(){f(this,Le,qe).call(this),w(this,fe)._off("editingaction",w(this,Pe)),w(this,fe)._off("pagechanging",w(this,be)),w(this,fe)._off("scalechanging",w(this,we)),w(this,fe)._off("rotationchanging",w(this,Ae));var ot,gt=_createForOfIteratorHelper(w(this,q).values());try{for(gt.s();!(ot=gt.n()).done;)ot.value.destroy()}catch(tt){gt.e(tt)}finally{gt.f()}w(this,q).clear(),w(this,F).clear(),w(this,J).clear(),m(this,O,null),w(this,H).clear(),w(this,_e).destroy()}},{key:"onPageChanging",value:function(ot){var gt=ot.pageNumber;m(this,ne,gt-1)}},{key:"focusMainContainer",value:function(){w(this,Me).focus()}},{key:"addShouldRescale",value:function(ot){w(this,J).add(ot)}},{key:"removeShouldRescale",value:function(ot){w(this,J).delete(ot)}},{key:"onScaleChanging",value:function(ot){var gt=ot.scale;this.commitOrRemove(),this.viewParameters.realScale=gt*u.PixelsPerInch.PDF_TO_CSS_UNITS;var tt,ut=_createForOfIteratorHelper(w(this,J));try{for(ut.s();!(tt=ut.n()).done;)tt.value.onScaleChanging()}catch(Re){ut.e(Re)}finally{ut.f()}}},{key:"onRotationChanging",value:function(ot){var gt=ot.pagesRotation;this.commitOrRemove(),this.viewParameters.rotation=gt}},{key:"addToAnnotationStorage",value:function(ot){ot.isEmpty()||!w(this,Y)||w(this,Y).has(ot.id)||w(this,Y).setValue(ot.id,ot)}},{key:"copy",value:function(ot){if(ot.preventDefault(),w(this,O)&&w(this,O).commitOrRemove(),this.hasSelection){var gt,tt=[],ut=_createForOfIteratorHelper(w(this,H));try{for(ut.s();!(gt=ut.n()).done;){var Re=gt.value;Re.isEmpty()||tt.push(Re.serialize())}}catch(Te){ut.e(Te)}finally{ut.f()}tt.length!==0&&ot.clipboardData.setData("application/pdfjs",JSON.stringify(tt))}}},{key:"cut",value:function(ot){this.copy(ot),this.delete()}},{key:"paste",value:function(ot){var gt=this;ot.preventDefault();var tt=ot.clipboardData.getData("application/pdfjs");if(tt){try{tt=JSON.parse(tt)}catch(We){return void(0,r.warn)('paste: "'.concat(We.message,'".'))}if(Array.isArray(tt)){this.unselectAll();var ut=w(this,q).get(w(this,ne));try{var Re,Te=[],He=_createForOfIteratorHelper(tt);try{for(He.s();!(Re=He.n()).done;){var Fe=Re.value,ze=ut.deserialize(Fe);if(!ze)return;Te.push(ze)}}catch(We){He.e(We)}finally{He.f()}this.addCommands({cmd:function(){for(var We=0,Ue=Te;We<Ue.length;We++){var et=Ue[We];f(gt,Ve,kt).call(gt,et)}f(gt,je,Vt).call(gt,Te)},undo:function(){for(var We=0,Ue=Te;We<Ue.length;We++)Ue[We].remove()},mustExec:!0})}catch(We){(0,r.warn)('paste: "'.concat(We.message,'".'))}}}}},{key:"keydown",value:function(ot){var gt;(gt=this.getActive())!==null&&gt!==void 0&&gt.shouldGetKeyboardEvents()||bt._keyboardManager.exec(this,ot)}},{key:"onEditingAction",value:function(ot){["undo","redo","delete","selectAll"].includes(ot.name)&&this[ot.name]()}},{key:"setEditingState",value:function(ot){ot?(f(this,Ie,Xe).call(this),f(this,le,Ke).call(this),f(this,ke,rt).call(this,{isEditing:w(this,X)!==r.AnnotationEditorType.NONE,isEmpty:f(this,Oe,mt).call(this),hasSomethingToUndo:w(this,_e).hasSomethingToUndo(),hasSomethingToRedo:w(this,_e).hasSomethingToRedo(),hasSelectedEditor:!1})):(f(this,Le,qe).call(this),f(this,oe,Je).call(this),f(this,ke,rt).call(this,{isEditing:!1}))}},{key:"registerEditorTypes",value:function(ot){if(!w(this,ve)){m(this,ve,ot);var gt,tt=_createForOfIteratorHelper(w(this,ve));try{for(tt.s();!(gt=tt.n()).done;){var ut=gt.value;f(this,Ce,ht).call(this,ut.defaultPropertiesToUpdate)}}catch(Re){tt.e(Re)}finally{tt.f()}}}},{key:"getId",value:function(){return w(this,Z).getId()}},{key:"currentLayer",get:function(){return w(this,q).get(w(this,ne))}},{key:"currentPageIndex",get:function(){return w(this,ne)}},{key:"addLayer",value:function(ot){w(this,q).set(ot.pageIndex,ot),w(this,j)?ot.enable():ot.disable()}},{key:"removeLayer",value:function(ot){w(this,q).delete(ot.pageIndex)}},{key:"updateMode",value:function(ot){if(m(this,X,ot),ot===r.AnnotationEditorType.NONE)this.setEditingState(!1),f(this,Be,Ct).call(this);else{this.setEditingState(!0),f(this,Ee,vt).call(this);var gt,tt=_createForOfIteratorHelper(w(this,q).values());try{for(tt.s();!(gt=tt.n()).done;)gt.value.updateMode(ot)}catch(ut){tt.e(ut)}finally{tt.f()}}}},{key:"updateToolbar",value:function(ot){ot!==w(this,X)&&w(this,fe).dispatch("switchannotationeditormode",{source:this,mode:ot})}},{key:"updateParams",value:function(ot,gt){if(w(this,ve)){var tt,ut=_createForOfIteratorHelper(w(this,H));try{for(ut.s();!(tt=ut.n()).done;)tt.value.updateParams(ot,gt)}catch(He){ut.e(He)}finally{ut.f()}var Re,Te=_createForOfIteratorHelper(w(this,ve));try{for(Te.s();!(Re=Te.n()).done;)Re.value.updateDefaultParams(ot,gt)}catch(He){Te.e(He)}finally{Te.f()}}}},{key:"getEditors",value:function(ot){var gt,tt=[],ut=_createForOfIteratorHelper(w(this,F).values());try{for(ut.s();!(gt=ut.n()).done;){var Re=gt.value;Re.pageIndex===ot&&tt.push(Re)}}catch(Te){ut.e(Te)}finally{ut.f()}return tt}},{key:"getEditor",value:function(ot){return w(this,F).get(ot)}},{key:"addEditor",value:function(ot){w(this,F).set(ot.id,ot)}},{key:"removeEditor",value:function(ot){var gt;w(this,F).delete(ot.id),this.unselect(ot),(gt=w(this,Y))===null||gt===void 0||gt.remove(ot.id)}},{key:"setActiveEditor",value:function(ot){w(this,O)!==ot&&(m(this,O,ot),ot&&f(this,Ce,ht).call(this,ot.propertiesToUpdate))}},{key:"toggleSelected",value:function(ot){if(w(this,H).has(ot))return w(this,H).delete(ot),ot.unselect(),void f(this,ke,rt).call(this,{hasSelectedEditor:this.hasSelection});w(this,H).add(ot),ot.select(),f(this,Ce,ht).call(this,ot.propertiesToUpdate),f(this,ke,rt).call(this,{hasSelectedEditor:!0})}},{key:"setSelected",value:function(ot){var gt,tt=_createForOfIteratorHelper(w(this,H));try{for(tt.s();!(gt=tt.n()).done;){var ut=gt.value;ut!==ot&&ut.unselect()}}catch(Re){tt.e(Re)}finally{tt.f()}w(this,H).clear(),w(this,H).add(ot),ot.select(),f(this,Ce,ht).call(this,ot.propertiesToUpdate),f(this,ke,rt).call(this,{hasSelectedEditor:!0})}},{key:"isSelected",value:function(ot){return w(this,H).has(ot)}},{key:"unselect",value:function(ot){ot.unselect(),w(this,H).delete(ot),f(this,ke,rt).call(this,{hasSelectedEditor:this.hasSelection})}},{key:"hasSelection",get:function(){return w(this,H).size!==0}},{key:"undo",value:function(){w(this,_e).undo(),f(this,ke,rt).call(this,{hasSomethingToUndo:w(this,_e).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:f(this,Oe,mt).call(this)})}},{key:"redo",value:function(){w(this,_e).redo(),f(this,ke,rt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:w(this,_e).hasSomethingToRedo(),isEmpty:f(this,Oe,mt).call(this)})}},{key:"addCommands",value:function(ot){w(this,_e).add(ot),f(this,ke,rt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:f(this,Oe,mt).call(this)})}},{key:"delete",value:function(){var ot=this;if(this.commitOrRemove(),this.hasSelection){var gt=_toConsumableArray$1(w(this,H));this.addCommands({cmd:function(){var tt,ut=_createForOfIteratorHelper(gt);try{for(ut.s();!(tt=ut.n()).done;)tt.value.remove()}catch(Re){ut.e(Re)}finally{ut.f()}},undo:function(){var tt,ut=_createForOfIteratorHelper(gt);try{for(ut.s();!(tt=ut.n()).done;){var Re=tt.value;f(ot,Ve,kt).call(ot,Re)}}catch(Te){ut.e(Te)}finally{ut.f()}},mustExec:!0})}}},{key:"commitOrRemove",value:function(){var ot;(ot=w(this,O))===null||ot===void 0||ot.commitOrRemove()}},{key:"selectAll",value:function(){var ot,gt=_createForOfIteratorHelper(w(this,H));try{for(gt.s();!(ot=gt.n()).done;)ot.value.commit()}catch(tt){gt.e(tt)}finally{gt.f()}f(this,je,Vt).call(this,w(this,F).values())}},{key:"unselectAll",value:function(){if(w(this,O))w(this,O).commitOrRemove();else if(w(this,H).size!==0){var ot,gt=_createForOfIteratorHelper(w(this,H));try{for(gt.s();!(ot=gt.n()).done;)ot.value.unselect()}catch(tt){gt.e(tt)}finally{gt.f()}w(this,H).clear(),f(this,ke,rt).call(this,{hasSelectedEditor:!1})}}},{key:"isActive",value:function(ot){return w(this,O)===ot}},{key:"getActive",value:function(){return w(this,O)}},{key:"getMode",value:function(){return w(this,X)}}])}();function Xe(){w(this,Me).addEventListener("keydown",w(this,re))}function qe(){w(this,Me).removeEventListener("keydown",w(this,re))}function Ke(){document.addEventListener("copy",w(this,U)),document.addEventListener("cut",w(this,te)),document.addEventListener("paste",w(this,Q))}function Je(){document.removeEventListener("copy",w(this,U)),document.removeEventListener("cut",w(this,te)),document.removeEventListener("paste",w(this,Q))}function rt(bt){var ot=this;Object.entries(bt).some(function(gt){var tt=_slicedToArray(gt,2),ut=tt[0],Re=tt[1];return w(ot,$e)[ut]!==Re})&&w(this,fe).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(w(this,$e),bt)})}function ht(bt){w(this,fe).dispatch("annotationeditorparamschanged",{source:this,details:bt})}function vt(){if(!w(this,j)){m(this,j,!0);var bt,ot=_createForOfIteratorHelper(w(this,q).values());try{for(ot.s();!(bt=ot.n()).done;)bt.value.enable()}catch(gt){ot.e(gt)}finally{ot.f()}}}function Ct(){if(this.unselectAll(),w(this,j)){m(this,j,!1);var bt,ot=_createForOfIteratorHelper(w(this,q).values());try{for(ot.s();!(bt=ot.n()).done;)bt.value.disable()}catch(gt){ot.e(gt)}finally{ot.f()}}}function kt(bt){var ot=w(this,q).get(bt.pageIndex);ot?ot.addOrRebuild(bt):this.addEditor(bt)}function mt(){if(w(this,F).size===0)return!0;if(w(this,F).size===1){var bt,ot=_createForOfIteratorHelper(w(this,F).values());try{for(ot.s();!(bt=ot.n()).done;)return bt.value.isEmpty()}catch(gt){ot.e(gt)}finally{ot.f()}}return!1}function Vt(bt){w(this,H).clear();var ot,gt=_createForOfIteratorHelper(bt);try{for(gt.s();!(ot=gt.n()).done;){var tt=ot.value;tt.isEmpty()||(w(this,H).add(tt),tt.select())}}catch(ut){gt.e(ut)}finally{gt.f()}f(this,ke,rt).call(this,{hasSelectedEditor:!0})}n.AnnotationEditorUIManager=Ge,function(bt,ot,gt){(ot=function(tt){var ut=function(Re,Te){if(_typeof$1(Re)!=="object"||Re===null)return Re;var He=Re[Symbol.toPrimitive];if(He!==void 0){var Fe=He.call(Re,Te||"default");if(_typeof$1(Fe)!=="object")return Fe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Te==="string"?String:Number)(Re)}(tt,"string");return _typeof$1(ut)==="symbol"?ut:String(ut)}(ot))in bt?Object.defineProperty(bt,ot,{value:gt,enumerable:!0,configurable:!0,writable:!0}):bt[ot]=gt}(Ge,"_keyboardManager",new D([[["ctrl+a","mac+meta+a"],Ge.prototype.selectAll],[["ctrl+z","mac+meta+z"],Ge.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],Ge.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],Ge.prototype.delete],[["Escape","mac+Escape"],Ge.prototype.unselectAll]]))},function(e,n,o){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=function(Ae){console.log("Deprecated API usage: "+Ae)},n.getColorValues=function(Ae){var $e=document.createElement("span");$e.style.visibility="hidden",document.body.append($e);var Me,Ie=_createForOfIteratorHelper(Ae.keys());try{for(Ie.s();!(Me=Ie.n()).done;){var Le=Me.value;$e.style.color=Le;var le=window.getComputedStyle($e).color;Ae.set(Le,we(le))}}catch(oe){Ie.e(oe)}finally{Ie.f()}$e.remove()},n.getCurrentTransform=function(Ae){var $e=Ae.getTransform(),Me=$e.a,Ie=$e.b,Le=$e.c,le=$e.d,oe=$e.e,ke=$e.f;return[Me,Ie,Le,le,oe,ke]},n.getCurrentTransformInverse=function(Ae){var $e=Ae.getTransform().invertSelf(),Me=$e.a,Ie=$e.b,Le=$e.c,le=$e.d,oe=$e.e,ke=$e.f;return[Me,Ie,Le,le,oe,ke]},n.getFilenameFromUrl=function(Ae){var $e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!$e){var Me=Ae.split(/[#?]/,1);Ae=_slicedToArray(Me,1)[0]}return Ae.substring(Ae.lastIndexOf("/")+1)},n.getPdfFilenameFromUrl=function(Ae){var $e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof Ae!="string")return $e;if(te(Ae))return(0,s.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),$e;var Me=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Ie=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(Ae),Le=Me.exec(Ie[1])||Me.exec(Ie[2])||Me.exec(Ie[3]);if(Le&&(Le=Le[0]).includes("%"))try{Le=Me.exec(decodeURIComponent(Le))[0]}catch{}return Le||$e},n.getRGB=we,n.getXfaPageViewport=function(Ae,$e){var Me=$e.scale,Ie=Me===void 0?1:Me,Le=$e.rotation,le=Le===void 0?0:Le,oe=Ae.attributes.style,ke=oe.width,Ce=oe.height,Ee=[0,0,parseInt(ke),parseInt(Ce)];return new H({viewBox:Ee,scale:Ie,rotation:le})},n.isDataScheme=te,n.isPdfFile=function(Ae){return typeof Ae=="string"&&/\.pdf$/i.test(Ae)},n.isValidFetchUrl=Pe,n.loadScript=function(Ae){var $e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Me,Ie){var Le=document.createElement("script");Le.src=Ae,Le.onload=function(le){$e&&Le.remove(),Me(le)},Le.onerror=function(){Ie(new Error("Cannot load script at: ".concat(Le.src)))},(document.head||document.documentElement).append(Le)})},n.setLayerDimensions=function(Ae,$e){var Me=arguments.length>2&&arguments[2]!==void 0&&arguments[2],Ie=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];if($e instanceof H){var Le=$e.rawDims,le=Le.pageWidth,oe=Le.pageHeight,ke=Ae.style,Ce="calc(var(--scale-factor) * ".concat(le,"px)"),Ee="calc(var(--scale-factor) * ".concat(oe,"px)");Me&&$e.rotation%180!=0?(ke.width=Ee,ke.height=Ce):(ke.width=Ce,ke.height=Ee)}Ie&&Ae.setAttribute("data-main-rotation",$e.rotation)};var u=o(143),s=o(1);function w(Ae,$e,Me){m(Ae,$e),$e.set(Ae,Me)}function m(Ae,$e){if($e.has(Ae))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v(Ae,$e,Me){if(!$e.has(Ae))throw new TypeError("attempted to get private field on non-instance");return Me}function g(Ae,$e){return function(Me,Ie){return Ie.get?Ie.get.call(Me):Ie.value}(Ae,f(Ae,$e,"get"))}function d(Ae,$e,Me){return function(Ie,Le,le){if(Le.set)Le.set.call(Ie,le);else{if(!Le.writable)throw new TypeError("attempted to set read only private field");Le.value=le}}(Ae,f(Ae,$e,"set"),Me),Me}function f(Ae,$e,Me){if(!$e.has(Ae))throw new TypeError("attempted to "+Me+" private field on non-instance");return $e.get(Ae)}var y="http://www.w3.org/2000/svg";n.AnnotationPrefix="pdfjs_internal_id_";var x=_createClass(function Ae(){_classCallCheck(this,Ae)});r=x,_defineProperty$1(x,"CSS",96),_defineProperty$1(x,"PDF",72),_defineProperty$1(x,"PDF_TO_CSS_UNITS",r.CSS/r.PDF),n.PixelsPerInch=x;var k=new WeakMap,P=new WeakMap,S=new WeakMap,E=new WeakMap,M=new WeakMap,T=new WeakMap,D=new WeakMap,N=new WeakMap,I=new WeakMap,O=new WeakMap,F=new WeakSet,q=function(Ae){function $e(){var Me;_classCallCheck(this,$e);var Ie,Le,le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=le.docId,ke=le.ownerDocument,Ce=ke===void 0?globalThis.document:ke;return Me=_callSuper(this,$e),m(Ie=Me,Le=F),Le.add(Ie),w(Me,O,{get:_e,set:void 0}),w(Me,I,{get:Y,set:void 0}),w(Me,k,{writable:!0,value:void 0}),w(Me,P,{writable:!0,value:void 0}),w(Me,S,{writable:!0,value:void 0}),w(Me,E,{writable:!0,value:void 0}),w(Me,M,{writable:!0,value:void 0}),w(Me,T,{writable:!0,value:void 0}),w(Me,D,{writable:!0,value:void 0}),w(Me,N,{writable:!0,value:0}),d(Me,S,oe),d(Me,E,Ce),Me}return _inherits($e,Ae),_createClass($e,[{key:"addFilter",value:function(Me){var Ie,Le;if(!Me)return"none";var le,oe,ke,Ce,Ee=g(this,I).get(Me);if(Ee)return Ee;if(Me.length===1){for(var Be=Me[0],Ve=new Array(256),Oe=0;Oe<256;Oe++)Ve[Oe]=Be[Oe]/255;Ce=le=oe=ke=Ve.join(",")}else{for(var je=_slicedToArray(Me,3),Ge=je[0],Xe=je[1],qe=je[2],Ke=new Array(256),Je=new Array(256),rt=new Array(256),ht=0;ht<256;ht++)Ke[ht]=Ge[ht]/255,Je[ht]=Xe[ht]/255,rt[ht]=qe[ht]/255;le=Ke.join(","),oe=Je.join(","),ke=rt.join(","),Ce="".concat(le).concat(oe).concat(ke)}if(Ee=g(this,I).get(Ce))return g(this,I).set(Me,Ee),Ee;var vt="g_".concat(g(this,S),"_transfer_map_").concat((d(this,N,(Ie=g(this,N),Le=Ie++,Ie)),Le)),Ct="url(#".concat(vt,")");g(this,I).set(Me,Ct),g(this,I).set(Ce,Ct);var kt=g(this,E).createElementNS(y,"filter",y);kt.setAttribute("id",vt),kt.setAttribute("color-interpolation-filters","sRGB");var mt=g(this,E).createElementNS(y,"feComponentTransfer");return kt.append(mt),v(this,F,ne).call(this,mt,"feFuncR",le),v(this,F,ne).call(this,mt,"feFuncG",oe),v(this,F,ne).call(this,mt,"feFuncB",ke),g(this,O).append(kt),Ct}},{key:"addHCMFilter",value:function(Me,Ie){var Le,le,oe,ke="".concat(Me,"-").concat(Ie);if(g(this,T)===ke)return g(this,D);if(d(this,T,ke),d(this,D,"none"),(oe=g(this,M))===null||oe===void 0||oe.remove(),!Me||!Ie)return g(this,D);g(this,O).style.color=Me;var Ce=we(Me=getComputedStyle(g(this,O)).getPropertyValue("color"));Me=(Le=s.Util).makeHexColor.apply(Le,_toConsumableArray$1(Ce)),g(this,O).style.color=Ie;var Ee=we(Ie=getComputedStyle(g(this,O)).getPropertyValue("color"));if(Ie=(le=s.Util).makeHexColor.apply(le,_toConsumableArray$1(Ee)),g(this,O).style.color="",Me==="#000000"&&Ie==="#ffffff"||Me===Ie)return g(this,D);for(var Be=new Array(256),Ve=0;Ve<=255;Ve++){var Oe=Ve/255;Be[Ve]=Oe<=.03928?Oe/12.92:Math.pow((Oe+.055)/1.055,2.4)}var je=Be.join(","),Ge="g_".concat(g(this,S),"_hcm_filter"),Xe=d(this,M,g(this,E).createElementNS(y,"filter",y));Xe.setAttribute("id",Ge),Xe.setAttribute("color-interpolation-filters","sRGB");var qe=g(this,E).createElementNS(y,"feComponentTransfer");Xe.append(qe),v(this,F,ne).call(this,qe,"feFuncR",je),v(this,F,ne).call(this,qe,"feFuncG",je),v(this,F,ne).call(this,qe,"feFuncB",je);var Ke=g(this,E).createElementNS(y,"feColorMatrix");Ke.setAttribute("type","matrix"),Ke.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Xe.append(Ke),qe=g(this,E).createElementNS(y,"feComponentTransfer"),Xe.append(qe);var Je=function(rt,ht){for(var vt=Ce[rt]/255,Ct=Ee[rt]/255,kt=new Array(ht+1),mt=0;mt<=ht;mt++)kt[mt]=vt+mt/ht*(Ct-vt);return kt.join(",")};return v(this,F,ne).call(this,qe,"feFuncR",Je(0,5)),v(this,F,ne).call(this,qe,"feFuncG",Je(1,5)),v(this,F,ne).call(this,qe,"feFuncB",Je(2,5)),g(this,O).append(Xe),d(this,D,"url(#".concat(Ge,")")),g(this,D)}},{key:"destroy",value:function(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&g(this,D)||(g(this,P)&&(g(this,P).parentNode.parentNode.remove(),d(this,P,null)),g(this,k)&&(g(this,k).clear(),d(this,k,null)),d(this,N,0))}}])}(u.BaseFilterFactory);function Y(){return g(this,k)||d(this,k,new Map)}function _e(){if(!g(this,P)){var Ae=g(this,E).createElement("div"),$e=Ae.style;$e.visibility="hidden",$e.contain="strict",$e.width=$e.height=0,$e.position="absolute",$e.top=$e.left=0,$e.zIndex=-1;var Me=g(this,E).createElementNS(y,"svg");Me.setAttribute("width",0),Me.setAttribute("height",0),d(this,P,g(this,E).createElementNS(y,"defs")),Ae.append(Me),Me.append(g(this,P)),g(this,E).body.append(Ae)}return g(this,P)}function ne(Ae,$e,Me){var Ie=g(this,E).createElementNS(y,$e);Ie.setAttribute("type","discrete"),Ie.setAttribute("tableValues",Me),Ae.append(Ie)}n.DOMFilterFactory=q;var ve=function(Ae){function $e(){var Me;_classCallCheck(this,$e);var Ie=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).ownerDocument,Le=Ie===void 0?globalThis.document:Ie;return(Me=_callSuper(this,$e))._document=Le,Me}return _inherits($e,Ae),_createClass($e,[{key:"_createCanvas",value:function(Me,Ie){var Le=this._document.createElement("canvas");return Le.width=Me,Le.height=Ie,Le}}])}(u.BaseCanvasFactory);function J(Ae){return fe.apply(this,arguments)}function fe(){return fe=_asyncToGenerator(_regeneratorRuntime().mark(function Ae($e){var Me,Ie,Le=arguments;return _regeneratorRuntime().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(Me=Le.length>1&&Le[1]!==void 0&&Le[1],!Pe($e,document.baseURI)){le.next=21;break}return le.next=4,fetch($e);case 4:if((Ie=le.sent).ok){le.next=7;break}throw new Error(Ie.statusText);case 7:if(!Me){le.next=15;break}return le.t1=Uint8Array,le.next=11,Ie.arrayBuffer();case 11:le.t2=le.sent,le.t0=new le.t1(le.t2),le.next=20;break;case 15:return le.t3=s.stringToBytes,le.next=18,Ie.text();case 18:le.t4=le.sent,le.t0=(0,le.t3)(le.t4);case 20:return le.abrupt("return",le.t0);case 21:return le.abrupt("return",new Promise(function(oe,ke){var Ce=new XMLHttpRequest;Ce.open("GET",$e,!0),Me&&(Ce.responseType="arraybuffer"),Ce.onreadystatechange=function(){if(Ce.readyState===XMLHttpRequest.DONE){var Ee;if((Ce.status===200||Ce.status===0)&&(Me&&Ce.response?Ee=new Uint8Array(Ce.response):!Me&&Ce.responseText&&(Ee=(0,s.stringToBytes)(Ce.responseText)),Ee))return void oe(Ee);ke(new Error(Ce.statusText))}},Ce.send(null)}));case 22:case"end":return le.stop()}},Ae)})),fe.apply(this,arguments)}n.DOMCanvasFactory=ve;var Z=function(Ae){function $e(){return _classCallCheck(this,$e),_callSuper(this,$e,arguments)}return _inherits($e,Ae),_createClass($e,[{key:"_fetchData",value:function(Me,Ie){return J(Me,this.isCompressed).then(function(Le){return{cMapData:Le,compressionType:Ie}})}}])}(u.BaseCMapReaderFactory);n.DOMCMapReaderFactory=Z;var j=function(Ae){function $e(){return _classCallCheck(this,$e),_callSuper(this,$e,arguments)}return _inherits($e,Ae),_createClass($e,[{key:"_fetchData",value:function(Me){return J(Me,!0)}}])}(u.BaseStandardFontDataFactory);n.DOMStandardFontDataFactory=j;var X=function(Ae){function $e(){return _classCallCheck(this,$e),_callSuper(this,$e,arguments)}return _inherits($e,Ae),_createClass($e,[{key:"_createSVG",value:function(Me){return document.createElementNS(y,Me)}}])}(u.BaseSVGFactory);n.DOMSVGFactory=X;var H=function(){function Ae($e){_classCallCheck(this,Ae);var Me=$e.viewBox,Ie=$e.scale,Le=$e.rotation,le=$e.offsetX,oe=le===void 0?0:le,ke=$e.offsetY,Ce=ke===void 0?0:ke,Ee=$e.dontFlip,Be=Ee!==void 0&&Ee;this.viewBox=Me,this.scale=Ie,this.rotation=Le,this.offsetX=oe,this.offsetY=Ce;var Ve,Oe,je,Ge,Xe,qe,Ke,Je,rt=(Me[2]+Me[0])/2,ht=(Me[3]+Me[1])/2;switch((Le%=360)<0&&(Le+=360),Le){case 180:Ve=-1,Oe=0,je=0,Ge=1;break;case 90:Ve=0,Oe=1,je=1,Ge=0;break;case 270:Ve=0,Oe=-1,je=-1,Ge=0;break;case 0:Ve=1,Oe=0,je=0,Ge=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Be&&(je=-je,Ge=-Ge),Ve===0?(Xe=Math.abs(ht-Me[1])*Ie+oe,qe=Math.abs(rt-Me[0])*Ie+Ce,Ke=(Me[3]-Me[1])*Ie,Je=(Me[2]-Me[0])*Ie):(Xe=Math.abs(rt-Me[0])*Ie+oe,qe=Math.abs(ht-Me[1])*Ie+Ce,Ke=(Me[2]-Me[0])*Ie,Je=(Me[3]-Me[1])*Ie),this.transform=[Ve*Ie,Oe*Ie,je*Ie,Ge*Ie,Xe-Ve*Ie*rt-je*Ie*ht,qe-Oe*Ie*rt-Ge*Ie*ht],this.width=Ke,this.height=Je}return _createClass(Ae,[{key:"rawDims",get:function(){var $e=this.viewBox;return(0,s.shadow)(this,"rawDims",{pageWidth:$e[2]-$e[0],pageHeight:$e[3]-$e[1],pageX:$e[0],pageY:$e[1]})}},{key:"clone",value:function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Me=$e.scale,Ie=Me===void 0?this.scale:Me,Le=$e.rotation,le=Le===void 0?this.rotation:Le,oe=$e.offsetX,ke=oe===void 0?this.offsetX:oe,Ce=$e.offsetY,Ee=Ce===void 0?this.offsetY:Ce,Be=$e.dontFlip,Ve=Be!==void 0&&Be;return new Ae({viewBox:this.viewBox.slice(),scale:Ie,rotation:le,offsetX:ke,offsetY:Ee,dontFlip:Ve})}},{key:"convertToViewportPoint",value:function($e,Me){return s.Util.applyTransform([$e,Me],this.transform)}},{key:"convertToViewportRectangle",value:function($e){var Me=s.Util.applyTransform([$e[0],$e[1]],this.transform),Ie=s.Util.applyTransform([$e[2],$e[3]],this.transform);return[Me[0],Me[1],Ie[0],Ie[1]]}},{key:"convertToPdfPoint",value:function($e,Me){return s.Util.applyInverseTransform([$e,Me],this.transform)}}])}();n.PageViewport=H;var U=function(Ae){function $e(Me,Ie){var Le;_classCallCheck(this,$e);var le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return(Le=_callSuper(this,$e,[Me,"RenderingCancelledException"])).type=Ie,Le.extraDelay=le,Le}return _inherits($e,Ae),_createClass($e)}(s.BaseException);function te(Ae){for(var $e=Ae.length,Me=0;Me<$e&&Ae[Me].trim()==="";)Me++;return Ae.substring(Me,Me+5).toLowerCase()==="data:"}n.RenderingCancelledException=U;var Q,re=function(){return _createClass(function Ae(){_classCallCheck(this,Ae),_defineProperty$1(this,"started",Object.create(null)),_defineProperty$1(this,"times",[])},[{key:"time",value:function(Ae){Ae in this.started&&(0,s.warn)("Timer is already running for ".concat(Ae)),this.started[Ae]=Date.now()}},{key:"timeEnd",value:function(Ae){Ae in this.started||(0,s.warn)("Timer has not been started for ".concat(Ae)),this.times.push({name:Ae,start:this.started[Ae],end:Date.now()}),delete this.started[Ae]}},{key:"toString",value:function(){var Ae,$e=[],Me=0,Ie=_createForOfIteratorHelper(this.times);try{for(Ie.s();!(Ae=Ie.n()).done;){var Le=Ae.value.name;Me=Math.max(Le.length,Me)}}catch(Ve){Ie.e(Ve)}finally{Ie.f()}var le,oe=_createForOfIteratorHelper(this.times);try{for(oe.s();!(le=oe.n()).done;){var ke=le.value,Ce=ke.name,Ee=ke.start,Be=ke.end;$e.push("".concat(Ce.padEnd(Me)," ").concat(Be-Ee,`ms
`))}}catch(Ve){oe.e(Ve)}finally{oe.f()}return $e.join("")}}])}();function Pe(Ae,$e){try{var Me=($e?new URL(Ae,$e):new URL(Ae)).protocol;return Me==="http:"||Me==="https:"}catch{return!1}}n.StatTimer=re;var be=function(){return _createClass(function Ae(){_classCallCheck(this,Ae)},null,[{key:"toDateObject",value:function(Ae){if(!Ae||typeof Ae!="string")return null;Q||(Q=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));var $e=Q.exec(Ae);if(!$e)return null;var Me=parseInt($e[1],10),Ie=parseInt($e[2],10);Ie=Ie>=1&&Ie<=12?Ie-1:0;var Le=parseInt($e[3],10);Le=Le>=1&&Le<=31?Le:1;var le=parseInt($e[4],10);le=le>=0&&le<=23?le:0;var oe=parseInt($e[5],10);oe=oe>=0&&oe<=59?oe:0;var ke=parseInt($e[6],10);ke=ke>=0&&ke<=59?ke:0;var Ce=$e[7]||"Z",Ee=parseInt($e[8],10);Ee=Ee>=0&&Ee<=23?Ee:0;var Be=parseInt($e[9],10)||0;return Be=Be>=0&&Be<=59?Be:0,Ce==="-"?(le+=Ee,oe+=Be):Ce==="+"&&(le-=Ee,oe-=Be),new Date(Date.UTC(Me,Ie,Le,le,oe,ke))}}])}();function we(Ae){if(Ae.startsWith("#")){var $e=parseInt(Ae.slice(1),16);return[(16711680&$e)>>16,(65280&$e)>>8,255&$e]}return Ae.startsWith("rgb(")?Ae.slice(4,-1).split(",").map(function(Me){return parseInt(Me)}):Ae.startsWith("rgba(")?Ae.slice(5,-1).split(",").map(function(Me){return parseInt(Me)}).slice(0,3):((0,s.warn)('Not a valid color format: "'.concat(Ae,'"')),[0,0,0])}n.PDFDateString=be},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var r=o(1),u=function(){return _createClass(function g(){_classCallCheck(this,g),this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")},[{key:"addFilter",value:function(g){return"none"}},{key:"addHCMFilter",value:function(g,d){return"none"}},{key:"destroy",value:function(){}}])}();n.BaseFilterFactory=u;var s=function(){return _createClass(function g(){_classCallCheck(this,g),this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")},[{key:"create",value:function(g,d){if(g<=0||d<=0)throw new Error("Invalid canvas size");var f=this._createCanvas(g,d);return{canvas:f,context:f.getContext("2d")}}},{key:"reset",value:function(g,d,f){if(!g.canvas)throw new Error("Canvas is not specified");if(d<=0||f<=0)throw new Error("Invalid canvas size");g.canvas.width=d,g.canvas.height=f}},{key:"destroy",value:function(g){if(!g.canvas)throw new Error("Canvas is not specified");g.canvas.width=0,g.canvas.height=0,g.canvas=null,g.context=null}},{key:"_createCanvas",value:function(g,d){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}])}();n.BaseCanvasFactory=s;var w=function(){return _createClass(function d(f){_classCallCheck(this,d);var y=f.baseUrl,x=y===void 0?null:y,k=f.isCompressed,P=k===void 0||k;this.constructor===d&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=x,this.isCompressed=P},[{key:"fetch",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P=this;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(y=f.name,this.baseUrl){S.next=3;break}throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');case 3:if(y){S.next=5;break}throw new Error("CMap name must be specified.");case 5:return x=this.baseUrl+y+(this.isCompressed?".bcmap":""),k=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE,S.abrupt("return",this._fetchData(x,k).catch(function(E){throw new Error("Unable to load ".concat(P.isCompressed?"binary ":"","CMap at: ").concat(x))}));case 8:case"end":return S.stop()}},d,this)})),function(d){return g.apply(this,arguments)})},{key:"_fetchData",value:function(d,f){(0,r.unreachable)("Abstract method `_fetchData` called.")}}]);var g}();n.BaseCMapReaderFactory=w;var m=function(){return _createClass(function d(f){_classCallCheck(this,d);var y=f.baseUrl,x=y===void 0?null:y;this.constructor===d&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=x},[{key:"fetch",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(y=f.filename,this.baseUrl){k.next=3;break}throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');case 3:if(y){k.next=5;break}throw new Error("Font filename must be specified.");case 5:return x="".concat(this.baseUrl).concat(y),k.abrupt("return",this._fetchData(x).catch(function(P){throw new Error("Unable to load font data at: ".concat(x))}));case 7:case"end":return k.stop()}},d,this)})),function(d){return g.apply(this,arguments)})},{key:"_fetchData",value:function(d){(0,r.unreachable)("Abstract method `_fetchData` called.")}}]);var g}();n.BaseStandardFontDataFactory=m;var v=function(){return _createClass(function g(){_classCallCheck(this,g),this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")},[{key:"create",value:function(g,d){var f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(g<=0||d<=0)throw new Error("Invalid SVG dimensions");var y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),f||(y.setAttribute("width","".concat(g,"px")),y.setAttribute("height","".concat(d,"px"))),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox","0 0 ".concat(g," ").concat(d)),y}},{key:"createElement",value:function(g){if(typeof g!="string")throw new Error("Invalid SVG element type");return this._createSVG(g)}},{key:"_createSVG",value:function(g){(0,r.unreachable)("Abstract method `_createSVG` called.")}}])}();n.BaseSVGFactory=v},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var r=o(1),u=3285377520,s=4294901760,w=65535,m=function(){return _createClass(function v(g){_classCallCheck(this,v),this.h1=g?4294967295&g:u,this.h2=g?4294967295&g:u},[{key:"update",value:function(v){var g,d;if(typeof v=="string"){g=new Uint8Array(2*v.length),d=0;for(var f=0,y=v.length;f<y;f++){var x=v.charCodeAt(f);x<=255?g[d++]=x:(g[d++]=x>>>8,g[d++]=255&x)}}else{if(!(0,r.isArrayBuffer)(v))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");d=(g=v.slice()).byteLength}for(var k=d>>2,P=d-4*k,S=new Uint32Array(g.buffer,0,k),E=0,M=0,T=this.h1,D=this.h2,N=3432918353,I=461845907,O=11601,F=13715,q=0;q<k;q++)1&q?T=5*(T=(T^=E=(E=(E=(E=S[q])*N&s|E*O&w)<<15|E>>>17)*I&s|E*F&w)<<13|T>>>19)+3864292196:D=5*(D=(D^=M=(M=(M=(M=S[q])*N&s|M*O&w)<<15|M>>>17)*I&s|M*F&w)<<13|D>>>19)+3864292196;switch(E=0,P){case 3:E^=g[4*k+2]<<16;case 2:E^=g[4*k+1]<<8;case 1:E=(E=(E=(E^=g[4*k])*N&s|E*O&w)<<15|E>>>17)*I&s|E*F&w,1&k?T^=E:D^=E}this.h1=T,this.h2=D}},{key:"hexdigest",value:function(){var v=this.h1,g=this.h2;return v=3981806797*(v^=g>>>1)&s|36045*v&w,v=444984403*(v^=(g=4283543511*g&s|(2950163797*(g<<16|v>>>16)&s)>>>16)>>>1)&s|60499*v&w,((v^=(g=3301882366*g&s|(3120437893*(g<<16|v>>>16)&s)>>>16)>>>1)>>>0).toString(16).padStart(8,"0")+(g>>>0).toString(16).padStart(8,"0")}}])}();n.MurmurHash3_64=m},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var r=o(1),u=o(3),s=function(){return _createClass(function v(g){_classCallCheck(this,v);var d=g.ownerDocument,f=d===void 0?globalThis.document:d;g.styleElement,this._document=f,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0},[{key:"addNativeFontFace",value:function(v){this.nativeFontFaces.push(v),this._document.fonts.add(v)}},{key:"insertRule",value:function(v){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));var g=this.styleElement.sheet;g.insertRule(v,g.cssRules.length)}},{key:"clear",value:function(){var v,g=_createForOfIteratorHelper(this.nativeFontFaces);try{for(g.s();!(v=g.n()).done;){var d=v.value;this._document.fonts.delete(d)}}catch(f){g.e(f)}finally{g.f()}this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function v(g){var d,f,y=this;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!g.attached&&!g.missingFile){x.next=2;break}return x.abrupt("return");case 2:if(g.attached=!0,!this.isFontLoadingAPISupported){x.next=18;break}if(!(d=g.createNativeFontFace())){x.next=17;break}return this.addNativeFontFace(d),x.prev=7,x.next=10,d.loaded;case 10:x.next=17;break;case 12:throw x.prev=12,x.t0=x.catch(7),(0,r.warn)("Failed to load font '".concat(d.family,"': '").concat(x.t0,"'.")),g.disableFontFace=!0,x.t0;case 17:return x.abrupt("return");case 18:if(!(f=g.createFontFaceRule())){x.next=25;break}if(this.insertRule(f),!this.isSyncFontLoadingSupported){x.next=23;break}return x.abrupt("return");case 23:return x.next=25,new Promise(function(k){var P=y._queueLoadingCallback(k);y._prepareFontLoadEvent(g,P)});case 25:case"end":return x.stop()}},v,this,[[7,12]])})),function(v){return m.apply(this,arguments)})},{key:"isFontLoadingAPISupported",get:function(){var v,g=!((v=this._document)===null||v===void 0||!v.fonts);return(0,r.shadow)(this,"isFontLoadingAPISupported",g)}},{key:"isSyncFontLoadingSupported",get:function(){var v=!1;return(u.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(v=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",v)}},{key:"_queueLoadingCallback",value:function(v){var g=this.loadingRequests,d={done:!1,complete:function(){for((0,r.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;g.length>0&&g[0].done;){var f=g.shift();setTimeout(f.callback,0)}},callback:v};return g.push(d),d}},{key:"_loadTestFont",get:function(){var v=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",v)}},{key:"_prepareFontLoadEvent",value:function(v,g){function d(ne,ve){return ne.charCodeAt(ve)<<24|ne.charCodeAt(ve+1)<<16|ne.charCodeAt(ve+2)<<8|255&ne.charCodeAt(ve+3)}function f(ne,ve,J,fe){return ne.substring(0,ve)+fe+ne.substring(ve+J)}var y,x,k=this._document.createElement("canvas");k.width=1,k.height=1;var P=k.getContext("2d"),S=0,E="lt".concat(Date.now()).concat(this.loadTestFontId++),M=this._loadTestFont,T=1482184792,D=d(M=f(M,976,E.length,E),16);for(y=0,x=E.length-3;y<x;y+=4)D=D-T+d(E,y)|0;y<E.length&&(D=D-T+d(E+"XXX",y)|0),M=f(M,16,4,(0,r.string32)(D));var N="url(data:font/opentype;base64,".concat(btoa(M),");"),I='@font-face {font-family:"'.concat(E,'";src:').concat(N,"}");this.insertRule(I);var O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(var F=0,q=[v.loadedName,E];F<q.length;F++){var Y=q[F],_e=this._document.createElement("span");_e.textContent="Hi",_e.style.fontFamily=Y,O.append(_e)}this._document.body.append(O),function ne(ve,J){if(++S>30)return(0,r.warn)("Load test font never loaded."),void J();P.font="30px "+ve,P.fillText(".",0,20),P.getImageData(0,0,1,1).data[3]>0?J():setTimeout(ne.bind(null,ve,J))}(E,function(){O.remove(),g.complete()})}}]);var m}();n.FontLoader=s;var w=function(){return _createClass(function m(v,g){_classCallCheck(this,m);var d=g.isEvalSupported,f=d===void 0||d,y=g.disableFontFace,x=y!==void 0&&y,k=g.ignoreErrors,P=k!==void 0&&k,S=g.inspectFont,E=S===void 0?null:S;for(var M in this.compiledGlyphs=Object.create(null),v)this[M]=v[M];this.isEvalSupported=f!==!1,this.disableFontFace=x===!0,this.ignoreErrors=P===!0,this._inspectFont=E},[{key:"createNativeFontFace",value:function(){var m,v;if(!this.data||this.disableFontFace)return null;if(this.cssFontInfo){var g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),v=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}else v=new FontFace(this.loadedName,this.data,{});return(m=this._inspectFont)===null||m===void 0||m.call(this,this),v}},{key:"createFontFaceRule",value:function(){var m;if(!this.data||this.disableFontFace)return null;var v,g=(0,r.bytesToString)(this.data),d="url(data:".concat(this.mimetype,";base64,").concat(btoa(g),");");if(this.cssFontInfo){var f="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(f+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),v='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(f,"src:").concat(d,"}")}else v='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(d,"}");return(m=this._inspectFont)===null||m===void 0||m.call(this,this,d),v}},{key:"getPathGenerator",value:function(m,v){if(this.compiledGlyphs[v]!==void 0)return this.compiledGlyphs[v];var g;try{g=m.get(this.loadedName+"_path_"+v)}catch(P){if(!this.ignoreErrors)throw P;return(0,r.warn)('getPathGenerator - ignoring character: "'.concat(P,'".')),this.compiledGlyphs[v]=function(S,E){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){var d,f=[],y=_createForOfIteratorHelper(g);try{for(y.s();!(d=y.n()).done;){var x=d.value,k=x.args!==void 0?x.args.join(","):"";f.push("c.",x.cmd,"(",k,`);
`)}}catch(P){y.e(P)}finally{y.f()}return this.compiledGlyphs[v]=new Function("c","size",f.join(""))}return this.compiledGlyphs[v]=function(P,S){var E,M=_createForOfIteratorHelper(g);try{for(M.s();!(E=M.n()).done;){var T=E.value;T.cmd==="scale"&&(T.args=[S,-S]),P[T.cmd].apply(P,T.args)}}catch(D){M.e(D)}finally{M.f()}}}}])}();n.FontFaceObject=w},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var r=o(1),u=o(142),s=o(147),w=o(148),m=o(3);function v(Z,j){(function(X,H){if(H.has(X))throw new TypeError("Cannot initialize the same private elements twice on an object")})(Z,j),j.add(Z)}function g(Z,j,X){if(!j.has(Z))throw new TypeError("attempted to get private field on non-instance");return X}var d=4096,f=16,y=function(){return _createClass(function Z(j){_classCallCheck(this,Z),this.canvasFactory=j,this.cache=Object.create(null)},[{key:"getCanvas",value:function(Z,j,X){var H;return this.cache[Z]!==void 0?(H=this.cache[Z],this.canvasFactory.reset(H,j,X)):(H=this.canvasFactory.create(j,X),this.cache[Z]=H),H}},{key:"delete",value:function(Z){delete this.cache[Z]}},{key:"clear",value:function(){for(var Z in this.cache){var j=this.cache[Z];this.canvasFactory.destroy(j),delete this.cache[Z]}}}])}();function x(Z,j,X,H,U,te,Q,re,Pe,be){var we=_slicedToArray((0,u.getCurrentTransform)(Z),6),Ae=we[0],$e=we[1],Me=we[2],Ie=we[3],Le=we[4],le=we[5];if($e===0&&Me===0){var oe=Q*Ae+Le,ke=Math.round(oe),Ce=re*Ie+le,Ee=Math.round(Ce),Be=(Q+Pe)*Ae+Le,Ve=Math.abs(Math.round(Be)-ke)||1,Oe=(re+be)*Ie+le,je=Math.abs(Math.round(Oe)-Ee)||1;return Z.setTransform(Math.sign(Ae),0,0,Math.sign(Ie),ke,Ee),Z.drawImage(j,X,H,U,te,0,0,Ve,je),Z.setTransform(Ae,$e,Me,Ie,Le,le),[Ve,je]}if(Ae===0&&Ie===0){var Ge=re*Me+Le,Xe=Math.round(Ge),qe=Q*$e+le,Ke=Math.round(qe),Je=(re+be)*Me+Le,rt=Math.abs(Math.round(Je)-Xe)||1,ht=(Q+Pe)*$e+le,vt=Math.abs(Math.round(ht)-Ke)||1;return Z.setTransform(0,Math.sign($e),Math.sign(Me),0,Xe,Ke),Z.drawImage(j,X,H,U,te,0,0,vt,rt),Z.setTransform(Ae,$e,Me,Ie,Le,le),[vt,rt]}return Z.drawImage(j,X,H,U,te,Q,re,Pe,be),[Math.hypot(Ae,$e)*Pe,Math.hypot(Me,Ie)*be]}var k=function(){return _createClass(function Z(j,X){_classCallCheck(this,Z),this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,j,X])},[{key:"clone",value:function(){var Z=Object.create(this);return Z.clipBox=this.clipBox.slice(),Z}},{key:"setCurrentPoint",value:function(Z,j){this.x=Z,this.y=j}},{key:"updatePathMinMax",value:function(Z,j,X){var H=_slicedToArray(r.Util.applyTransform([j,X],Z),2);j=H[0],X=H[1],this.minX=Math.min(this.minX,j),this.minY=Math.min(this.minY,X),this.maxX=Math.max(this.maxX,j),this.maxY=Math.max(this.maxY,X)}},{key:"updateRectMinMax",value:function(Z,j){var X=r.Util.applyTransform(j,Z),H=r.Util.applyTransform(j.slice(2),Z);this.minX=Math.min(this.minX,X[0],H[0]),this.minY=Math.min(this.minY,X[1],H[1]),this.maxX=Math.max(this.maxX,X[0],H[0]),this.maxY=Math.max(this.maxY,X[1],H[1])}},{key:"updateScalingPathMinMax",value:function(Z,j){r.Util.scaleMinMax(Z,j),this.minX=Math.min(this.minX,j[0]),this.maxX=Math.max(this.maxX,j[1]),this.minY=Math.min(this.minY,j[2]),this.maxY=Math.max(this.maxY,j[3])}},{key:"updateCurvePathMinMax",value:function(Z,j,X,H,U,te,Q,re,Pe,be){var we=r.Util.bezierBoundingBox(j,X,H,U,te,Q,re,Pe);if(be)return be[0]=Math.min(be[0],we[0],we[2]),be[1]=Math.max(be[1],we[0],we[2]),be[2]=Math.min(be[2],we[1],we[3]),void(be[3]=Math.max(be[3],we[1],we[3]));this.updateRectMinMax(Z,we)}},{key:"getPathBoundingBox",value:function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.PathType.FILL,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,X=[this.minX,this.minY,this.maxX,this.maxY];if(Z===s.PathType.STROKE){j||(0,r.unreachable)("Stroke bounding box must include transform.");var H=r.Util.singularValueDecompose2dScale(j),U=H[0]*this.lineWidth/2,te=H[1]*this.lineWidth/2;X[0]-=U,X[1]-=te,X[2]+=U,X[3]+=te}return X}},{key:"updateClipFromPath",value:function(){var Z=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(Z||[0,0,0,0])}},{key:"isEmptyClip",value:function(){return this.minX===1/0}},{key:"startNewPathAndClipBox",value:function(Z){this.clipBox=Z,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}},{key:"getClippedPathBoundingBox",value:function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.PathType.FILL,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return r.Util.intersect(this.clipBox,this.getPathBoundingBox(Z,j))}}])}();function P(Z,j){if(typeof ImageData<"u"&&j instanceof ImageData)Z.putImageData(j,0,0);else{var X,H,U,te,Q,re=j.height,Pe=j.width,be=re%f,we=(re-be)/f,Ae=be===0?we:we+1,$e=Z.createImageData(Pe,f),Me=0,Ie=j.data,Le=$e.data;if(j.kind===r.ImageKind.GRAYSCALE_1BPP){var le=Ie.byteLength,oe=new Uint32Array(Le.buffer,0,Le.byteLength>>2),ke=oe.length,Ce=Pe+7>>3,Ee=4294967295,Be=r.FeatureTest.isLittleEndian?4278190080:255;for(H=0;H<Ae;H++){for(te=H<we?f:be,X=0,U=0;U<te;U++){for(var Ve=le-Me,Oe=0,je=Ve>Ce?Pe:8*Ve-7,Ge=-8&je,Xe=0,qe=0;Oe<Ge;Oe+=8)qe=Ie[Me++],oe[X++]=128&qe?Ee:Be,oe[X++]=64&qe?Ee:Be,oe[X++]=32&qe?Ee:Be,oe[X++]=16&qe?Ee:Be,oe[X++]=8&qe?Ee:Be,oe[X++]=4&qe?Ee:Be,oe[X++]=2&qe?Ee:Be,oe[X++]=1&qe?Ee:Be;for(;Oe<je;Oe++)Xe===0&&(qe=Ie[Me++],Xe=128),oe[X++]=qe&Xe?Ee:Be,Xe>>=1}for(;X<ke;)oe[X++]=0;Z.putImageData($e,0,H*f)}}else if(j.kind===r.ImageKind.RGBA_32BPP){for(U=0,Q=Pe*f*4,H=0;H<we;H++)Le.set(Ie.subarray(Me,Me+Q)),Me+=Q,Z.putImageData($e,0,U),U+=f;H<Ae&&(Q=Pe*be*4,Le.set(Ie.subarray(Me,Me+Q)),Z.putImageData($e,0,U))}else{if(j.kind!==r.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(j.kind));for(Q=Pe*(te=f),H=0;H<Ae;H++){for(H>=we&&(Q=Pe*(te=be)),X=0,U=Q;U--;)Le[X++]=Ie[Me++],Le[X++]=Ie[Me++],Le[X++]=Ie[Me++],Le[X++]=255;Z.putImageData($e,0,H*f)}}}}function S(Z,j){if(j.bitmap)Z.drawImage(j.bitmap,0,0);else for(var X=j.height,H=j.width,U=X%f,te=(X-U)/f,Q=U===0?te:te+1,re=Z.createImageData(H,f),Pe=0,be=j.data,we=re.data,Ae=0;Ae<Q;Ae++){var $e=Ae<te?f:U;Pe=(0,w.convertBlackAndWhiteToRGBA)({src:be,srcPos:Pe,dest:we,width:H,height:$e,nonBlackColor:0}).srcPos,Z.putImageData(re,0,Ae*f)}}function E(Z,j){for(var X=0,H=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];X<H.length;X++){var U=H[X];Z[U]!==void 0&&(j[U]=Z[U])}Z.setLineDash!==void 0&&(j.setLineDash(Z.getLineDash()),j.lineDashOffset=Z.lineDashOffset)}function M(Z){Z.strokeStyle=Z.fillStyle="#000000",Z.fillRule="nonzero",Z.globalAlpha=1,Z.lineWidth=1,Z.lineCap="butt",Z.lineJoin="miter",Z.miterLimit=10,Z.globalCompositeOperation="source-over",Z.font="10px sans-serif",Z.setLineDash!==void 0&&(Z.setLineDash([]),Z.lineDashOffset=0),m.isNodeJS||(Z.filter="none")}function T(Z,j,X,H){for(var U=Z.length,te=3;te<U;te+=4){var Q=Z[te];if(Q===0)Z[te-3]=j,Z[te-2]=X,Z[te-1]=H;else if(Q<255){var re=255-Q;Z[te-3]=Z[te-3]*Q+j*re>>8,Z[te-2]=Z[te-2]*Q+X*re>>8,Z[te-1]=Z[te-1]*Q+H*re>>8}}}function D(Z,j,X){for(var H=Z.length,U=.00392156862745098,te=3;te<H;te+=4){var Q=X?X[Z[te]]:Z[te];j[te]=j[te]*Q*U|0}}function N(Z,j,X){for(var H=Z.length,U=3;U<H;U+=4){var te=77*Z[U-3]+152*Z[U-2]+28*Z[U-1];j[U]=X?j[U]*X[te>>8]>>8:j[U]*te>>16}}function I(Z,j,X,H){var U=H[0],te=H[1],Q=H[2]-U,re=H[3]-te;Q!==0&&re!==0&&(function(Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke){var Ce,Ee=!!Me,Be=Ee?Me[0]:0,Ve=Ee?Me[1]:0,Oe=Ee?Me[2]:0;Ce=$e==="Luminosity"?N:D;for(var je=Math.min(Ae,Math.ceil(1048576/we)),Ge=0;Ge<Ae;Ge+=je){var Xe=Math.min(je,Ae-Ge),qe=Pe.getImageData(Le-oe,Ge+(le-ke),we,Xe),Ke=be.getImageData(Le,Ge+le,we,Xe);Ee&&T(qe.data,Be,Ve,Oe),Ce(qe.data,Ke.data,Ie),be.putImageData(Ke,Le,Ge+le)}}(j.context,X,Q,re,j.subtype,j.backdrop,j.transferMap,U,te,j.offsetX,j.offsetY),Z.save(),Z.globalAlpha=1,Z.globalCompositeOperation="source-over",Z.setTransform(1,0,0,1,0,0),Z.drawImage(X.canvas,0,0),Z.restore())}function O(Z,j){var X=r.Util.singularValueDecompose2dScale(Z);X[0]=Math.fround(X[0]),X[1]=Math.fround(X[1]);var H=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return j!==void 0?j:X[0]<=H||X[1]<=H}var F=["butt","round","square"],q=["miter","round","bevel"],Y={},_e={},ne=new WeakSet,ve=function(){function Z(j,X,H,U,te,Q,re){_classCallCheck(this,Z);var Pe=Q.optionalContentConfig,be=Q.markedContentStack,we=be===void 0?null:be;v(this,ne),this.ctx=j,this.current=new k(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=X,this.objs=H,this.canvasFactory=U,this.filterFactory=te,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=we||[],this.optionalContentConfig=Pe,this.cachedCanvases=new y(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=re,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}return _createClass(Z,[{key:"getObject",value:function(j){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof j=="string"?j.startsWith("g_")?this.commonObjs.get(j):this.objs.get(j):X}},{key:"beginDrawing",value:function(j){var X,H,U=j.transform,te=j.viewport,Q=j.transparency,re=Q!==void 0&&Q,Pe=j.background,be=Pe===void 0?null:Pe,we=this.ctx.canvas.width,Ae=this.ctx.canvas.height,$e=this.ctx.fillStyle;if(this.ctx.fillStyle=be||"#ffffff",this.ctx.fillRect(0,0,we,Ae),this.ctx.fillStyle=$e,re){var Me,Ie=this.cachedCanvases.getCanvas("transparent",we,Ae);this.compositeCtx=this.ctx,this.transparentCanvas=Ie.canvas,this.ctx=Ie.context,this.ctx.save(),(Me=this.ctx).transform.apply(Me,_toConsumableArray$1((0,u.getCurrentTransform)(this.compositeCtx)))}this.ctx.save(),M(this.ctx),U&&((H=this.ctx).transform.apply(H,_toConsumableArray$1(U)),this.outputScaleX=U[0],this.outputScaleY=U[0]),(X=this.ctx).transform.apply(X,_toConsumableArray$1(te.transform)),this.viewportScale=te.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx)}},{key:"executeOperatorList",value:function(j,X,H,U){var te=j.argsArray,Q=j.fnArray,re=X||0,Pe=te.length;if(Pe===re)return re;for(var be,we=Pe-re>10&&typeof H=="function",Ae=we?Date.now()+15:0,$e=0,Me=this.commonObjs,Ie=this.objs;;){if(U!==void 0&&re===U.nextBreakPoint)return U.breakIt(re,H),re;if((be=Q[re])!==r.OPS.dependency)this[be].apply(this,te[re]);else{var Le,le=_createForOfIteratorHelper(te[re]);try{for(le.s();!(Le=le.n()).done;){var oe=Le.value,ke=oe.startsWith("g_")?Me:Ie;if(!ke.has(oe))return ke.get(oe,H),re}}catch(Ce){le.e(Ce)}finally{le.f()}}if(++re===Pe)return re;if(we&&++$e>10){if(Date.now()>Ae)return H(),re;$e=0}}}},{key:"endDrawing",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;g(this,ne,J).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();var X,H=_createForOfIteratorHelper(this._cachedBitmapsMap.values());try{for(H.s();!(X=H.n()).done;){var U,te=X.value,Q=_createForOfIteratorHelper(te.values());try{for(Q.s();!(U=Q.n()).done;){var re=U.value;typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement&&(re.width=re.height=0)}}catch(we){Q.e(we)}finally{Q.f()}te.clear()}}catch(we){H.e(we)}finally{H.f()}if(this._cachedBitmapsMap.clear(),j){var Pe=this.filterFactory.addHCMFilter(j.foreground,j.background);if(Pe!=="none"){var be=this.ctx.filter;this.ctx.filter=Pe,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=be}}}},{key:"_scaleImage",value:function(j,X){for(var H,U,te=j.width,Q=j.height,re=Math.max(Math.hypot(X[0],X[1]),1),Pe=Math.max(Math.hypot(X[2],X[3]),1),be=te,we=Q,Ae="prescale1";re>2&&be>1||Pe>2&&we>1;){var $e=be,Me=we;re>2&&be>1&&(re/=be/($e=be>=16384?Math.floor(be/2)-1||1:Math.ceil(be/2))),Pe>2&&we>1&&(Pe/=we/(Me=we>=16384?Math.floor(we/2)-1||1:Math.ceil(we)/2)),(U=(H=this.cachedCanvases.getCanvas(Ae,$e,Me)).context).clearRect(0,0,$e,Me),U.drawImage(j,0,0,be,we,0,0,$e,Me),j=H.canvas,be=$e,we=Me,Ae=Ae==="prescale1"?"prescale2":"prescale1"}return{img:j,paintWidth:be,paintHeight:we}}},{key:"_createMaskCanvas",value:function(j){var X,H,U,te,Q=this.ctx,re=j.width,Pe=j.height,be=this.current.fillColor,we=this.current.patternFill,Ae=(0,u.getCurrentTransform)(Q);if((j.bitmap||j.data)&&j.count>1){var $e=j.bitmap||j.data.buffer;H=JSON.stringify(we?Ae:[Ae.slice(0,4),be]),(X=this._cachedBitmapsMap.get($e))||(X=new Map,this._cachedBitmapsMap.set($e,X));var Me=X.get(H);if(Me&&!we)return{canvas:Me,offsetX:Math.round(Math.min(Ae[0],Ae[2])+Ae[4]),offsetY:Math.round(Math.min(Ae[1],Ae[3])+Ae[5])};U=Me}U||S((te=this.cachedCanvases.getCanvas("maskCanvas",re,Pe)).context,j);var Ie=r.Util.transform(Ae,[1/re,0,0,-1/Pe,0,0]);Ie=r.Util.transform(Ie,[1,0,0,1,0,-Pe]);var Le=r.Util.applyTransform([0,0],Ie),le=r.Util.applyTransform([re,Pe],Ie),oe=r.Util.normalizeRect([Le[0],Le[1],le[0],le[1]]),ke=Math.round(oe[2]-oe[0])||1,Ce=Math.round(oe[3]-oe[1])||1,Ee=this.cachedCanvases.getCanvas("fillCanvas",ke,Ce),Be=Ee.context,Ve=Math.min(Le[0],le[0]),Oe=Math.min(Le[1],le[1]);Be.translate(-Ve,-Oe),Be.transform.apply(Be,_toConsumableArray$1(Ie)),U||(U=(U=this._scaleImage(te.canvas,(0,u.getCurrentTransformInverse)(Be))).img,X&&we&&X.set(H,U)),Be.imageSmoothingEnabled=O((0,u.getCurrentTransform)(Be),j.interpolate),x(Be,U,0,0,U.width,U.height,0,0,re,Pe),Be.globalCompositeOperation="source-in";var je=r.Util.transform((0,u.getCurrentTransformInverse)(Be),[1,0,0,1,-Ve,-Oe]);return Be.fillStyle=we?be.getPattern(Q,this,je,s.PathType.FILL):be,Be.fillRect(0,0,re,Pe),X&&!we&&(this.cachedCanvases.delete("fillCanvas"),X.set(H,Ee.canvas)),{canvas:Ee.canvas,offsetX:Math.round(Ve),offsetY:Math.round(Oe)}}},{key:"setLineWidth",value:function(j){j!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=j,this.ctx.lineWidth=j}},{key:"setLineCap",value:function(j){this.ctx.lineCap=F[j]}},{key:"setLineJoin",value:function(j){this.ctx.lineJoin=q[j]}},{key:"setMiterLimit",value:function(j){this.ctx.miterLimit=j}},{key:"setDash",value:function(j,X){var H=this.ctx;H.setLineDash!==void 0&&(H.setLineDash(j),H.lineDashOffset=X)}},{key:"setRenderingIntent",value:function(j){}},{key:"setFlatness",value:function(j){}},{key:"setGState",value:function(j){var X,H=_createForOfIteratorHelper(j);try{for(H.s();!(X=H.n()).done;){var U=_slicedToArray(X.value,2),te=U[0],Q=U[1];switch(te){case"LW":this.setLineWidth(Q);break;case"LC":this.setLineCap(Q);break;case"LJ":this.setLineJoin(Q);break;case"ML":this.setMiterLimit(Q);break;case"D":this.setDash(Q[0],Q[1]);break;case"RI":this.setRenderingIntent(Q);break;case"FL":this.setFlatness(Q);break;case"Font":this.setFont(Q[0],Q[1]);break;case"CA":this.current.strokeAlpha=Q;break;case"ca":this.current.fillAlpha=Q,this.ctx.globalAlpha=Q;break;case"BM":this.ctx.globalCompositeOperation=Q;break;case"SMask":this.current.activeSMask=Q?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Q)}}}catch(re){H.e(re)}finally{H.f()}}},{key:"inSMaskMode",get:function(){return!!this.suspendedCtx}},{key:"checkSMaskState",value:function(){var j=this.inSMaskMode;this.current.activeSMask&&!j?this.beginSMaskMode():!this.current.activeSMask&&j&&this.endSMaskMode()}},{key:"beginSMaskMode",value:function(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");var j=this.ctx.canvas.width,X=this.ctx.canvas.height,H="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(H,j,X);this.suspendedCtx=this.ctx,this.ctx=U.context;var te=this.ctx;te.setTransform.apply(te,_toConsumableArray$1((0,u.getCurrentTransform)(this.suspendedCtx))),E(this.suspendedCtx,te),function(Q,re){if(Q._removeMirroring)throw new Error("Context is already forwarding operations.");Q.__originalSave=Q.save,Q.__originalRestore=Q.restore,Q.__originalRotate=Q.rotate,Q.__originalScale=Q.scale,Q.__originalTranslate=Q.translate,Q.__originalTransform=Q.transform,Q.__originalSetTransform=Q.setTransform,Q.__originalResetTransform=Q.resetTransform,Q.__originalClip=Q.clip,Q.__originalMoveTo=Q.moveTo,Q.__originalLineTo=Q.lineTo,Q.__originalBezierCurveTo=Q.bezierCurveTo,Q.__originalRect=Q.rect,Q.__originalClosePath=Q.closePath,Q.__originalBeginPath=Q.beginPath,Q._removeMirroring=function(){Q.save=Q.__originalSave,Q.restore=Q.__originalRestore,Q.rotate=Q.__originalRotate,Q.scale=Q.__originalScale,Q.translate=Q.__originalTranslate,Q.transform=Q.__originalTransform,Q.setTransform=Q.__originalSetTransform,Q.resetTransform=Q.__originalResetTransform,Q.clip=Q.__originalClip,Q.moveTo=Q.__originalMoveTo,Q.lineTo=Q.__originalLineTo,Q.bezierCurveTo=Q.__originalBezierCurveTo,Q.rect=Q.__originalRect,Q.closePath=Q.__originalClosePath,Q.beginPath=Q.__originalBeginPath,delete Q._removeMirroring},Q.save=function(){re.save(),this.__originalSave()},Q.restore=function(){re.restore(),this.__originalRestore()},Q.translate=function(Pe,be){re.translate(Pe,be),this.__originalTranslate(Pe,be)},Q.scale=function(Pe,be){re.scale(Pe,be),this.__originalScale(Pe,be)},Q.transform=function(Pe,be,we,Ae,$e,Me){re.transform(Pe,be,we,Ae,$e,Me),this.__originalTransform(Pe,be,we,Ae,$e,Me)},Q.setTransform=function(Pe,be,we,Ae,$e,Me){re.setTransform(Pe,be,we,Ae,$e,Me),this.__originalSetTransform(Pe,be,we,Ae,$e,Me)},Q.resetTransform=function(){re.resetTransform(),this.__originalResetTransform()},Q.rotate=function(Pe){re.rotate(Pe),this.__originalRotate(Pe)},Q.clip=function(Pe){re.clip(Pe),this.__originalClip(Pe)},Q.moveTo=function(Pe,be){re.moveTo(Pe,be),this.__originalMoveTo(Pe,be)},Q.lineTo=function(Pe,be){re.lineTo(Pe,be),this.__originalLineTo(Pe,be)},Q.bezierCurveTo=function(Pe,be,we,Ae,$e,Me){re.bezierCurveTo(Pe,be,we,Ae,$e,Me),this.__originalBezierCurveTo(Pe,be,we,Ae,$e,Me)},Q.rect=function(Pe,be,we,Ae){re.rect(Pe,be,we,Ae),this.__originalRect(Pe,be,we,Ae)},Q.closePath=function(){re.closePath(),this.__originalClosePath()},Q.beginPath=function(){re.beginPath(),this.__originalBeginPath()}}(te,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}},{key:"endSMaskMode",value:function(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),E(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}},{key:"compose",value:function(j){if(this.current.activeSMask){j?(j[0]=Math.floor(j[0]),j[1]=Math.floor(j[1]),j[2]=Math.ceil(j[2]),j[3]=Math.ceil(j[3])):j=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];var X=this.current.activeSMask;I(this.suspendedCtx,X,this.ctx,j),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}}},{key:"save",value:function(){this.inSMaskMode?(E(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();var j=this.current;this.stateStack.push(j),this.current=j.clone()}},{key:"restore",value:function(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),E(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}},{key:"transform",value:function(j,X,H,U,te,Q){this.ctx.transform(j,X,H,U,te,Q),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}},{key:"constructPath",value:function(j,X,H){for(var U,te,Q=this.ctx,re=this.current,Pe=re.x,be=re.y,we=(0,u.getCurrentTransform)(Q),Ae=we[0]===0&&we[3]===0||we[1]===0&&we[2]===0,$e=Ae?H.slice(0):null,Me=0,Ie=0,Le=j.length;Me<Le;Me++)switch(0|j[Me]){case r.OPS.rectangle:Pe=X[Ie++],be=X[Ie++];var le=X[Ie++],oe=X[Ie++],ke=Pe+le,Ce=be+oe;Q.moveTo(Pe,be),le===0||oe===0?Q.lineTo(ke,Ce):(Q.lineTo(ke,be),Q.lineTo(ke,Ce),Q.lineTo(Pe,Ce)),Ae||re.updateRectMinMax(we,[Pe,be,ke,Ce]),Q.closePath();break;case r.OPS.moveTo:Pe=X[Ie++],be=X[Ie++],Q.moveTo(Pe,be),Ae||re.updatePathMinMax(we,Pe,be);break;case r.OPS.lineTo:Pe=X[Ie++],be=X[Ie++],Q.lineTo(Pe,be),Ae||re.updatePathMinMax(we,Pe,be);break;case r.OPS.curveTo:U=Pe,te=be,Pe=X[Ie+4],be=X[Ie+5],Q.bezierCurveTo(X[Ie],X[Ie+1],X[Ie+2],X[Ie+3],Pe,be),re.updateCurvePathMinMax(we,U,te,X[Ie],X[Ie+1],X[Ie+2],X[Ie+3],Pe,be,$e),Ie+=6;break;case r.OPS.curveTo2:U=Pe,te=be,Q.bezierCurveTo(Pe,be,X[Ie],X[Ie+1],X[Ie+2],X[Ie+3]),re.updateCurvePathMinMax(we,U,te,Pe,be,X[Ie],X[Ie+1],X[Ie+2],X[Ie+3],$e),Pe=X[Ie+2],be=X[Ie+3],Ie+=4;break;case r.OPS.curveTo3:U=Pe,te=be,Pe=X[Ie+2],be=X[Ie+3],Q.bezierCurveTo(X[Ie],X[Ie+1],Pe,be,Pe,be),re.updateCurvePathMinMax(we,U,te,X[Ie],X[Ie+1],Pe,be,Pe,be,$e),Ie+=4;break;case r.OPS.closePath:Q.closePath()}Ae&&re.updateScalingPathMinMax(we,$e),re.setCurrentPoint(Pe,be)}},{key:"closePath",value:function(){this.ctx.closePath()}},{key:"stroke",value:function(){var j=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],X=this.ctx,H=this.current.strokeColor;X.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(_typeof$1(H)==="object"&&H!=null&&H.getPattern?(X.save(),X.strokeStyle=H.getPattern(X,this,(0,u.getCurrentTransformInverse)(X),s.PathType.STROKE),this.rescaleAndStroke(!1),X.restore()):this.rescaleAndStroke(!0)),j&&this.consumePath(this.current.getClippedPathBoundingBox()),X.globalAlpha=this.current.fillAlpha}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"fill",value:function(){var j=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],X=this.ctx,H=this.current.fillColor,U=!1;this.current.patternFill&&(X.save(),X.fillStyle=H.getPattern(X,this,(0,u.getCurrentTransformInverse)(X),s.PathType.FILL),U=!0);var te=this.current.getClippedPathBoundingBox();this.contentVisible&&te!==null&&(this.pendingEOFill?(X.fill("evenodd"),this.pendingEOFill=!1):X.fill()),U&&X.restore(),j&&this.consumePath(te)}},{key:"eoFill",value:function(){this.pendingEOFill=!0,this.fill()}},{key:"fillStroke",value:function(){this.fill(!1),this.stroke(!1),this.consumePath()}},{key:"eoFillStroke",value:function(){this.pendingEOFill=!0,this.fillStroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}},{key:"endPath",value:function(){this.consumePath()}},{key:"clip",value:function(){this.pendingClip=Y}},{key:"eoClip",value:function(){this.pendingClip=_e}},{key:"beginText",value:function(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}},{key:"endText",value:function(){var j=this.pendingTextPaths,X=this.ctx;if(j!==void 0){X.save(),X.beginPath();var H,U=_createForOfIteratorHelper(j);try{for(U.s();!(H=U.n()).done;){var te=H.value;X.setTransform.apply(X,_toConsumableArray$1(te.transform)),X.translate(te.x,te.y),te.addToPath(X,te.fontSize)}}catch(Q){U.e(Q)}finally{U.f()}X.restore(),X.clip(),X.beginPath(),delete this.pendingTextPaths}else X.beginPath()}},{key:"setCharSpacing",value:function(j){this.current.charSpacing=j}},{key:"setWordSpacing",value:function(j){this.current.wordSpacing=j}},{key:"setHScale",value:function(j){this.current.textHScale=j/100}},{key:"setLeading",value:function(j){this.current.leading=-j}},{key:"setFont",value:function(j,X){var H=this.commonObjs.get(j),U=this.current;if(!H)throw new Error("Can't find font for ".concat(j));if(U.fontMatrix=H.fontMatrix||r.FONT_IDENTITY_MATRIX,U.fontMatrix[0]!==0&&U.fontMatrix[3]!==0||(0,r.warn)("Invalid font matrix for font "+j),X<0?(X=-X,U.fontDirection=-1):U.fontDirection=1,this.current.font=H,this.current.fontSize=X,!H.isType3Font){var te=H.loadedName||"sans-serif",Q="normal";H.black?Q="900":H.bold&&(Q="bold");var re=H.italic?"italic":"normal",Pe='"'.concat(te,'", ').concat(H.fallbackName),be=X;X<16?be=16:X>100&&(be=100),this.current.fontSizeScale=X/be,this.ctx.font="".concat(re," ").concat(Q," ").concat(be,"px ").concat(Pe)}}},{key:"setTextRenderingMode",value:function(j){this.current.textRenderingMode=j}},{key:"setTextRise",value:function(j){this.current.textRise=j}},{key:"moveText",value:function(j,X){this.current.x=this.current.lineX+=j,this.current.y=this.current.lineY+=X}},{key:"setLeadingMoveText",value:function(j,X){this.setLeading(-X),this.moveText(j,X)}},{key:"setTextMatrix",value:function(j,X,H,U,te,Q){this.current.textMatrix=[j,X,H,U,te,Q],this.current.textMatrixScale=Math.hypot(j,X),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"paintChar",value:function(j,X,H,U){var te,Q=this.ctx,re=this.current,Pe=re.font,be=re.textRenderingMode,we=re.fontSize/re.fontSizeScale,Ae=be&r.TextRenderingMode.FILL_STROKE_MASK,$e=!!(be&r.TextRenderingMode.ADD_TO_PATH_FLAG),Me=re.patternFill&&!Pe.missingFile;(Pe.disableFontFace||$e||Me)&&(te=Pe.getPathGenerator(this.commonObjs,j)),Pe.disableFontFace||Me?(Q.save(),Q.translate(X,H),Q.beginPath(),te(Q,we),U&&Q.setTransform.apply(Q,_toConsumableArray$1(U)),Ae!==r.TextRenderingMode.FILL&&Ae!==r.TextRenderingMode.FILL_STROKE||Q.fill(),Ae!==r.TextRenderingMode.STROKE&&Ae!==r.TextRenderingMode.FILL_STROKE||Q.stroke(),Q.restore()):(Ae!==r.TextRenderingMode.FILL&&Ae!==r.TextRenderingMode.FILL_STROKE||Q.fillText(j,X,H),Ae!==r.TextRenderingMode.STROKE&&Ae!==r.TextRenderingMode.FILL_STROKE||Q.strokeText(j,X,H)),$e&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,u.getCurrentTransform)(Q),x:X,y:H,fontSize:we,addToPath:te})}},{key:"isFontSubpixelAAEnabled",get:function(){var j=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10).context;j.scale(1.5,1),j.fillText("I",0,10);for(var X=j.getImageData(0,0,10,10).data,H=!1,U=3;U<X.length;U+=4)if(X[U]>0&&X[U]<255){H=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",H)}},{key:"showText",value:function(j){var X=this.current,H=X.font;if(H.isType3Font)return this.showType3Text(j);var U=X.fontSize;if(U!==0){var te,Q=this.ctx,re=X.fontSizeScale,Pe=X.charSpacing,be=X.wordSpacing,we=X.fontDirection,Ae=X.textHScale*we,$e=j.length,Me=H.vertical,Ie=Me?1:-1,Le=H.defaultVMetrics,le=U*X.fontMatrix[0],oe=X.textRenderingMode===r.TextRenderingMode.FILL&&!H.disableFontFace&&!X.patternFill;if(Q.save(),Q.transform.apply(Q,_toConsumableArray$1(X.textMatrix)),Q.translate(X.x,X.y+X.textRise),we>0?Q.scale(Ae,-1):Q.scale(Ae,1),X.patternFill){Q.save();var ke=X.fillColor.getPattern(Q,this,(0,u.getCurrentTransformInverse)(Q),s.PathType.FILL);te=(0,u.getCurrentTransform)(Q),Q.restore(),Q.fillStyle=ke}var Ce=X.lineWidth,Ee=X.textMatrixScale;if(Ee===0||Ce===0){var Be=X.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;Be!==r.TextRenderingMode.STROKE&&Be!==r.TextRenderingMode.FILL_STROKE||(Ce=this.getSinglePixelWidth())}else Ce/=Ee;if(re!==1&&(Q.scale(re,re),Ce/=re),Q.lineWidth=Ce,H.isInvalidPDFjsFont){var Ve,Oe=[],je=0,Ge=_createForOfIteratorHelper(j);try{for(Ge.s();!(Ve=Ge.n()).done;){var Xe=Ve.value;Oe.push(Xe.unicode),je+=Xe.width}}catch(He){Ge.e(He)}finally{Ge.f()}return Q.fillText(Oe.join(""),0,0),X.x+=je*le*Ae,Q.restore(),void this.compose()}var qe,Ke=0;for(qe=0;qe<$e;++qe){var Je=j[qe];if(typeof Je!="number"){var rt=!1,ht=(Je.isSpace?be:0)+Pe,vt=Je.fontChar,Ct=Je.accent,kt=void 0,mt=void 0,Vt=Je.width;if(Me){var bt=Je.vmetric||Le,ot=-(Je.vmetric?bt[1]:.5*Vt)*le,gt=bt[2]*le;Vt=bt?-bt[0]:Vt,kt=ot/re,mt=(Ke+gt)/re}else kt=Ke/re,mt=0;if(H.remeasure&&Vt>0){var tt=1e3*Q.measureText(vt).width/U*re;if(Vt<tt&&this.isFontSubpixelAAEnabled){var ut=Vt/tt;rt=!0,Q.save(),Q.scale(ut,1),kt/=ut}else Vt!==tt&&(kt+=(Vt-tt)/2e3*U/re)}if(this.contentVisible&&(Je.isInFont||H.missingFile)){if(oe&&!Ct)Q.fillText(vt,kt,mt);else if(this.paintChar(vt,kt,mt,te),Ct){var Re=kt+U*Ct.offset.x/re,Te=mt-U*Ct.offset.y/re;this.paintChar(Ct.fontChar,Re,Te,te)}}Ke+=Me?Vt*le-ht*we:Vt*le+ht*we,rt&&Q.restore()}else Ke+=Ie*Je*U/1e3}Me?X.y-=Ke:X.x+=Ke*Ae,Q.restore(),this.compose()}}},{key:"showType3Text",value:function(j){var X,H,U,te,Q=this.ctx,re=this.current,Pe=re.font,be=re.fontSize,we=re.fontDirection,Ae=Pe.vertical?1:-1,$e=re.charSpacing,Me=re.wordSpacing,Ie=re.textHScale*we,Le=re.fontMatrix||r.FONT_IDENTITY_MATRIX,le=j.length;if(re.textRenderingMode!==r.TextRenderingMode.INVISIBLE&&be!==0){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,Q.save(),Q.transform.apply(Q,_toConsumableArray$1(re.textMatrix)),Q.translate(re.x,re.y),Q.scale(Ie,we),X=0;X<le;++X)if(typeof(H=j[X])!="number"){var oe=(H.isSpace?Me:0)+$e,ke=Pe.charProcOperatorList[H.operatorListId];ke?(this.contentVisible&&(this.processingType3=H,this.save(),Q.scale(be,be),Q.transform.apply(Q,_toConsumableArray$1(Le)),this.executeOperatorList(ke),this.restore()),U=r.Util.applyTransform([H.width,0],Le)[0]*be+oe,Q.translate(U,0),re.x+=U*Ie):(0,r.warn)('Type3 character "'.concat(H.operatorListId,'" is not available.'))}else te=Ae*H*be/1e3,this.ctx.translate(te,0),re.x+=te*Ie;Q.restore(),this.processingType3=null}}},{key:"setCharWidth",value:function(j,X){}},{key:"setCharWidthAndBounds",value:function(j,X,H,U,te,Q){this.ctx.rect(H,U,te-H,Q-U),this.ctx.clip(),this.endPath()}},{key:"getColorN_Pattern",value:function(j){var X,H=this;if(j[0]==="TilingPattern"){var U=j[1],te=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),Q={createCanvasGraphics:function(re){return new Z(re,H.commonObjs,H.objs,H.canvasFactory,H.filterFactory,{optionalContentConfig:H.optionalContentConfig,markedContentStack:H.markedContentStack})}};X=new s.TilingPattern(j,U,this.ctx,Q,te)}else X=this._getPattern(j[1],j[2]);return X}},{key:"setStrokeColorN",value:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)}},{key:"setFillColorN",value:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}},{key:"setStrokeRGBColor",value:function(j,X,H){var U=r.Util.makeHexColor(j,X,H);this.ctx.strokeStyle=U,this.current.strokeColor=U}},{key:"setFillRGBColor",value:function(j,X,H){var U=r.Util.makeHexColor(j,X,H);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}},{key:"_getPattern",value:function(j){var X,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.cachedPatterns.has(j)?X=this.cachedPatterns.get(j):(X=(0,s.getShadingPattern)(this.getObject(j)),this.cachedPatterns.set(j,X)),H&&(X.matrix=H),X}},{key:"shadingFill",value:function(j){if(this.contentVisible){var X=this.ctx;this.save();var H=this._getPattern(j);X.fillStyle=H.getPattern(X,this,(0,u.getCurrentTransformInverse)(X),s.PathType.SHADING);var U=(0,u.getCurrentTransformInverse)(X);if(U){var te=X.canvas,Q=te.width,re=te.height,Pe=r.Util.applyTransform([0,0],U),be=r.Util.applyTransform([0,re],U),we=r.Util.applyTransform([Q,0],U),Ae=r.Util.applyTransform([Q,re],U),$e=Math.min(Pe[0],be[0],we[0],Ae[0]),Me=Math.min(Pe[1],be[1],we[1],Ae[1]),Ie=Math.max(Pe[0],be[0],we[0],Ae[0]),Le=Math.max(Pe[1],be[1],we[1],Ae[1]);this.ctx.fillRect($e,Me,Ie-$e,Le-Me)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}}},{key:"beginInlineImage",value:function(){(0,r.unreachable)("Should not call beginInlineImage")}},{key:"beginImageData",value:function(){(0,r.unreachable)("Should not call beginImageData")}},{key:"paintFormXObjectBegin",value:function(j,X){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(j)&&j.length===6&&this.transform.apply(this,_toConsumableArray$1(j)),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),X)){var H=X[2]-X[0],U=X[3]-X[1];this.ctx.rect(X[0],X[1],H,U),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),X),this.clip(),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}},{key:"beginGroup",value:function(j){if(this.contentVisible){this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);var X=this.ctx;j.isolated||(0,r.info)("TODO: Support non-isolated groups."),j.knockout&&(0,r.warn)("Knockout groups not supported.");var H=(0,u.getCurrentTransform)(X);if(j.matrix&&X.transform.apply(X,_toConsumableArray$1(j.matrix)),!j.bbox)throw new Error("Bounding box is required.");var U=r.Util.getAxialAlignedBoundingBox(j.bbox,(0,u.getCurrentTransform)(X)),te=[0,0,X.canvas.width,X.canvas.height];U=r.Util.intersect(U,te)||[0,0,0,0];var Q=Math.floor(U[0]),re=Math.floor(U[1]),Pe=Math.max(Math.ceil(U[2])-Q,1),be=Math.max(Math.ceil(U[3])-re,1),we=1,Ae=1;Pe>d&&(we=Pe/d,Pe=d),be>d&&(Ae=be/d,be=d),this.current.startNewPathAndClipBox([0,0,Pe,be]);var $e="groupAt"+this.groupLevel;j.smask&&($e+="_smask_"+this.smaskCounter++%2);var Me=this.cachedCanvases.getCanvas($e,Pe,be),Ie=Me.context;Ie.scale(1/we,1/Ae),Ie.translate(-Q,-re),Ie.transform.apply(Ie,_toConsumableArray$1(H)),j.smask?this.smaskStack.push({canvas:Me.canvas,context:Ie,offsetX:Q,offsetY:re,scaleX:we,scaleY:Ae,subtype:j.smask.subtype,backdrop:j.smask.backdrop,transferMap:j.smask.transferMap||null,startTransformInverse:null}):(X.setTransform(1,0,0,1,0,0),X.translate(Q,re),X.scale(we,Ae),X.save()),E(X,Ie),this.ctx=Ie,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(X),this.groupLevel++}}},{key:"endGroup",value:function(j){if(this.contentVisible){this.groupLevel--;var X=this.ctx,H=this.groupStack.pop();if(this.ctx=H,this.ctx.imageSmoothingEnabled=!1,j.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{var U;this.ctx.restore();var te=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),(U=this.ctx).setTransform.apply(U,_toConsumableArray$1(te));var Q=r.Util.getAxialAlignedBoundingBox([0,0,X.canvas.width,X.canvas.height],te);this.ctx.drawImage(X.canvas,0,0),this.ctx.restore(),this.compose(Q)}}}},{key:"beginAnnotation",value:function(j,X,H,U,te){var Q;if(g(this,ne,J).call(this),M(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&(Q=this.ctx).setTransform.apply(Q,_toConsumableArray$1(this.baseTransform)),Array.isArray(X)&&X.length===4){var re=X[2]-X[0],Pe=X[3]-X[1];if(te&&this.annotationCanvasMap){(H=H.slice())[4]-=X[0],H[5]-=X[1],(X=X.slice())[0]=X[1]=0,X[2]=re,X[3]=Pe;var be=_slicedToArray(r.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),2),we=be[0],Ae=be[1],$e=this.viewportScale,Me=Math.ceil(re*this.outputScaleX*$e),Ie=Math.ceil(Pe*this.outputScaleY*$e);this.annotationCanvas=this.canvasFactory.create(Me,Ie);var Le=this.annotationCanvas,le=Le.canvas,oe=Le.context;this.annotationCanvasMap.set(j,le),this.annotationCanvas.savedCtx=this.ctx,this.ctx=oe,this.ctx.setTransform(we,0,0,-Ae,0,Pe*Ae),M(this.ctx)}else M(this.ctx),this.ctx.rect(X[0],X[1],re,Pe),this.ctx.clip(),this.endPath()}this.current=new k(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,_toConsumableArray$1(H)),this.transform.apply(this,_toConsumableArray$1(U))}},{key:"endAnnotation",value:function(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}},{key:"paintImageMaskXObject",value:function(j){if(this.contentVisible){var X=j.count;(j=this.getObject(j.data,j)).count=X;var H=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=function(re){var Pe=re.width,be=re.height;if(Pe>1e3||be>1e3)return null;var we,Ae,$e,Me,Ie=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Le=Pe+1,le=new Uint8Array(Le*(be+1)),oe=Pe+7&-8,ke=new Uint8Array(oe*be),Ce=0,Ee=_createForOfIteratorHelper(re.data);try{for(Ee.s();!(Me=Ee.n()).done;)for(var Be=Me.value,Ve=128;Ve>0;)ke[Ce++]=Be&Ve?0:255,Ve>>=1}catch(Ct){Ee.e(Ct)}finally{Ee.f()}var Oe=0;for(ke[Ce=0]!==0&&(le[0]=1,++Oe),Ae=1;Ae<Pe;Ae++)ke[Ce]!==ke[Ce+1]&&(le[Ae]=ke[Ce]?2:1,++Oe),Ce++;for(ke[Ce]!==0&&(le[Ae]=2,++Oe),we=1;we<be;we++){$e=we*Le,ke[(Ce=we*oe)-oe]!==ke[Ce]&&(le[$e]=ke[Ce]?1:8,++Oe);var je=(ke[Ce]?4:0)+(ke[Ce-oe]?8:0);for(Ae=1;Ae<Pe;Ae++)Ie[je=(je>>2)+(ke[Ce+1]?4:0)+(ke[Ce-oe+1]?8:0)]&&(le[$e+Ae]=Ie[je],++Oe),Ce++;if(ke[Ce-oe]!==ke[Ce]&&(le[$e+Ae]=ke[Ce]?2:4,++Oe),Oe>1e3)return null}for($e=we*Le,ke[Ce=oe*(be-1)]!==0&&(le[$e]=8,++Oe),Ae=1;Ae<Pe;Ae++)ke[Ce]!==ke[Ce+1]&&(le[$e+Ae]=ke[Ce]?4:8,++Oe),Ce++;if(ke[Ce]!==0&&(le[$e+Ae]=4,++Oe),Oe>1e3)return null;var Ge=new Int32Array([0,Le,-1,0,-Le,0,0,0,1]),Xe=new Path2D;for(we=0;Oe&&we<=be;we++){for(var qe=we*Le,Ke=qe+Pe;qe<Ke&&!le[qe];)qe++;if(qe!==Ke){Xe.moveTo(qe%Le,we);var Je=qe,rt=le[qe];do{var ht=Ge[rt];do qe+=ht;while(!le[qe]);var vt=le[qe];vt!==5&&vt!==10?(rt=vt,le[qe]=0):(rt=vt&51*rt>>4,le[qe]&=rt>>2|rt<<2),Xe.lineTo(qe%Le,qe/Le|0),le[qe]||--Oe}while(Je!==qe);--we}}return ke=null,le=null,function(Ct){Ct.save(),Ct.scale(1/Pe,-1/be),Ct.translate(0,-be),Ct.fill(Xe),Ct.beginPath(),Ct.restore()}}(j)),U.compiled))U.compiled(H);else{var te=this._createMaskCanvas(j),Q=te.canvas;H.save(),H.setTransform(1,0,0,1,0,0),H.drawImage(Q,te.offsetX,te.offsetY),H.restore(),this.compose()}}}},{key:"paintImageMaskXObjectRepeat",value:function(j,X){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,te=arguments.length>4?arguments[4]:void 0,Q=arguments.length>5?arguments[5]:void 0;if(this.contentVisible){j=this.getObject(j.data,j);var re=this.ctx;re.save();var Pe=(0,u.getCurrentTransform)(re);re.transform(X,H,U,te,0,0);var be=this._createMaskCanvas(j);re.setTransform(1,0,0,1,be.offsetX-Pe[4],be.offsetY-Pe[5]);for(var we=0,Ae=Q.length;we<Ae;we+=2){var $e=r.Util.transform(Pe,[X,H,U,te,Q[we],Q[we+1]]),Me=_slicedToArray(r.Util.applyTransform([0,0],$e),2),Ie=Me[0],Le=Me[1];re.drawImage(be.canvas,Ie,Le)}re.restore(),this.compose()}}},{key:"paintImageMaskXObjectGroup",value:function(j){if(this.contentVisible){var X,H=this.ctx,U=this.current.fillColor,te=this.current.patternFill,Q=_createForOfIteratorHelper(j);try{for(Q.s();!(X=Q.n()).done;){var re=X.value,Pe=re.data,be=re.width,we=re.height,Ae=re.transform,$e=this.cachedCanvases.getCanvas("maskCanvas",be,we),Me=$e.context;Me.save(),S(Me,this.getObject(Pe,re)),Me.globalCompositeOperation="source-in",Me.fillStyle=te?U.getPattern(Me,this,(0,u.getCurrentTransformInverse)(H),s.PathType.FILL):U,Me.fillRect(0,0,be,we),Me.restore(),H.save(),H.transform.apply(H,_toConsumableArray$1(Ae)),H.scale(1,-1),x(H,$e.canvas,0,0,be,we,0,-1,1,1),H.restore()}}catch(Ie){Q.e(Ie)}finally{Q.f()}this.compose()}}},{key:"paintImageXObject",value:function(j){if(this.contentVisible){var X=this.getObject(j);X?this.paintInlineImageXObject(X):(0,r.warn)("Dependent image isn't ready yet")}}},{key:"paintImageXObjectRepeat",value:function(j,X,H,U){if(this.contentVisible){var te=this.getObject(j);if(te){for(var Q=te.width,re=te.height,Pe=[],be=0,we=U.length;be<we;be+=2)Pe.push({transform:[X,0,0,H,U[be],U[be+1]],x:0,y:0,w:Q,h:re});this.paintInlineImageXObjectGroup(te,Pe)}else(0,r.warn)("Dependent image isn't ready yet")}}},{key:"applyTransferMapsToCanvas",value:function(j){return this.current.transferMaps!=="none"&&(j.filter=this.current.transferMaps,j.drawImage(j.canvas,0,0),j.filter="none"),j.canvas}},{key:"applyTransferMapsToBitmap",value:function(j){if(this.current.transferMaps==="none")return j.bitmap;var X=j.bitmap,H=j.width,U=j.height,te=this.cachedCanvases.getCanvas("inlineImage",H,U),Q=te.context;return Q.filter=this.current.transferMaps,Q.drawImage(X,0,0),Q.filter="none",te.canvas}},{key:"paintInlineImageXObject",value:function(j){if(this.contentVisible){var X,H=j.width,U=j.height,te=this.ctx;if(this.save(),m.isNodeJS||(te.filter="none"),te.scale(1/H,-1/U),j.bitmap)X=this.applyTransferMapsToBitmap(j);else if(typeof HTMLElement=="function"&&j instanceof HTMLElement||!j.data)X=j;else{var Q=this.cachedCanvases.getCanvas("inlineImage",H,U).context;P(Q,j),X=this.applyTransferMapsToCanvas(Q)}var re=this._scaleImage(X,(0,u.getCurrentTransformInverse)(te));te.imageSmoothingEnabled=O((0,u.getCurrentTransform)(te),j.interpolate),x(te,re.img,0,0,re.paintWidth,re.paintHeight,0,-U,H,U),this.compose(),this.restore()}}},{key:"paintInlineImageXObjectGroup",value:function(j,X){if(this.contentVisible){var H,U=this.ctx;if(j.bitmap)H=j.bitmap;else{var te=j.width,Q=j.height,re=this.cachedCanvases.getCanvas("inlineImage",te,Q).context;P(re,j),H=this.applyTransferMapsToCanvas(re)}var Pe,be=_createForOfIteratorHelper(X);try{for(be.s();!(Pe=be.n()).done;){var we=Pe.value;U.save(),U.transform.apply(U,_toConsumableArray$1(we.transform)),U.scale(1,-1),x(U,H,we.x,we.y,we.w,we.h,0,-1,1,1),U.restore()}}catch(Ae){be.e(Ae)}finally{be.f()}this.compose()}}},{key:"paintSolidColorImageMask",value:function(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}},{key:"markPoint",value:function(j){}},{key:"markPointProps",value:function(j,X){}},{key:"beginMarkedContent",value:function(j){this.markedContentStack.push({visible:!0})}},{key:"beginMarkedContentProps",value:function(j,X){j==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(X)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}},{key:"endMarkedContent",value:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}},{key:"beginCompat",value:function(){}},{key:"endCompat",value:function(){}},{key:"consumePath",value:function(j){var X=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(j);var H=this.ctx;this.pendingClip&&(X||(this.pendingClip===_e?H.clip("evenodd"):H.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),H.beginPath()}},{key:"getSinglePixelWidth",value:function(){if(!this._cachedGetSinglePixelWidth){var j=(0,u.getCurrentTransform)(this.ctx);if(j[1]===0&&j[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(j[0]),Math.abs(j[3]));else{var X=Math.abs(j[0]*j[3]-j[2]*j[1]),H=Math.hypot(j[0],j[2]),U=Math.hypot(j[1],j[3]);this._cachedGetSinglePixelWidth=Math.max(H,U)/X}}return this._cachedGetSinglePixelWidth}},{key:"getScaleForStroking",value:function(){if(!this._cachedScaleForStroking){var j,X,H=this.current.lineWidth,U=(0,u.getCurrentTransform)(this.ctx);if(U[1]===0&&U[2]===0){var te=Math.abs(U[0]),Q=Math.abs(U[3]);if(H===0)j=1/te,X=1/Q;else{var re=te*H,Pe=Q*H;j=re<1?1/re:1,X=Pe<1?1/Pe:1}}else{var be=Math.abs(U[0]*U[3]-U[2]*U[1]),we=Math.hypot(U[0],U[1]),Ae=Math.hypot(U[2],U[3]);if(H===0)j=Ae/be,X=we/be;else{var $e=H*be;j=Ae>$e?Ae/$e:1,X=we>$e?we/$e:1}}this._cachedScaleForStroking=[j,X]}return this._cachedScaleForStroking}},{key:"rescaleAndStroke",value:function(j){var X=this.ctx,H=this.current.lineWidth,U=_slicedToArray(this.getScaleForStroking(),2),te=U[0],Q=U[1];if(X.lineWidth=H||1,te!==1||Q!==1){var re,Pe,be;j&&(re=(0,u.getCurrentTransform)(X),Pe=X.getLineDash().slice(),be=X.lineDashOffset),X.scale(te,Q);var we=Math.max(te,Q);X.setLineDash(X.getLineDash().map(function(Ae){return Ae/we})),X.lineDashOffset/=we,X.stroke(),j&&(X.setTransform.apply(X,_toConsumableArray$1(re)),X.setLineDash(Pe),X.lineDashOffset=be)}else X.stroke()}},{key:"isContentVisible",value:function(){for(var j=this.markedContentStack.length-1;j>=0;j--)if(!this.markedContentStack[j].visible)return!1;return!0}}])}();function J(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}for(var fe in n.CanvasGraphics=ve,r.OPS)ve.prototype[fe]!==void 0&&(ve.prototype[r.OPS[fe]]=ve.prototype[fe])},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=function(S){switch(S[0]){case"RadialAxial":return new v(S);case"Mesh":return new f(S);case"Dummy":return new y}throw new Error("Unknown IR type: ".concat(S[0]))};var r=o(1),u=o(142),s={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function w(S,E){if(E){var M=E[2]-E[0],T=E[3]-E[1],D=new Path2D;D.rect(E[0],E[1],M,T),S.clip(D)}}n.PathType=s;var m=function(){return _createClass(function S(){_classCallCheck(this,S),this.constructor===S&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")},[{key:"getPattern",value:function(){(0,r.unreachable)("Abstract method `getPattern` called.")}}])}(),v=function(S){function E(M){var T;return _classCallCheck(this,E),(T=_callSuper(this,E))._type=M[1],T._bbox=M[2],T._colorStops=M[3],T._p0=M[4],T._p1=M[5],T._r0=M[6],T._r1=M[7],T.matrix=null,T}return _inherits(E,S),_createClass(E,[{key:"_createGradient",value:function(M){var T;this._type==="axial"?T=M.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(T=M.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));var D,N=_createForOfIteratorHelper(this._colorStops);try{for(N.s();!(D=N.n()).done;){var I=D.value;T.addColorStop(I[0],I[1])}}catch(O){N.e(O)}finally{N.f()}return T}},{key:"getPattern",value:function(M,T,D,N){var I;if(N===s.STROKE||N===s.FILL){var O=T.current.getClippedPathBoundingBox(N,(0,u.getCurrentTransform)(M))||[0,0,0,0],F=Math.ceil(O[2]-O[0])||1,q=Math.ceil(O[3]-O[1])||1,Y=T.cachedCanvases.getCanvas("pattern",F,q,!0),_e=Y.context;_e.clearRect(0,0,_e.canvas.width,_e.canvas.height),_e.beginPath(),_e.rect(0,0,_e.canvas.width,_e.canvas.height),_e.translate(-O[0],-O[1]),D=r.Util.transform(D,[1,0,0,1,O[0],O[1]]),_e.transform.apply(_e,_toConsumableArray$1(T.baseTransform)),this.matrix&&_e.transform.apply(_e,_toConsumableArray$1(this.matrix)),w(_e,this._bbox),_e.fillStyle=this._createGradient(_e),_e.fill(),I=M.createPattern(Y.canvas,"no-repeat");var ne=new DOMMatrix(D);I.setTransform(ne)}else w(M,this._bbox),I=this._createGradient(M);return I}}])}(m);function g(S,E,M,T,D,N,I,O){var F,q=E.coords,Y=E.colors,_e=S.data,ne=4*S.width;q[M+1]>q[T+1]&&(F=M,M=T,T=F,F=N,N=I,I=F),q[T+1]>q[D+1]&&(F=T,T=D,D=F,F=I,I=O,O=F),q[M+1]>q[T+1]&&(F=M,M=T,T=F,F=N,N=I,I=F);var ve=(q[M]+E.offsetX)*E.scaleX,J=(q[M+1]+E.offsetY)*E.scaleY,fe=(q[T]+E.offsetX)*E.scaleX,Z=(q[T+1]+E.offsetY)*E.scaleY,j=(q[D]+E.offsetX)*E.scaleX,X=(q[D+1]+E.offsetY)*E.scaleY;if(!(J>=X))for(var H,U,te,Q,re,Pe,be,we,Ae=Y[N],$e=Y[N+1],Me=Y[N+2],Ie=Y[I],Le=Y[I+1],le=Y[I+2],oe=Y[O],ke=Y[O+1],Ce=Y[O+2],Ee=Math.round(J),Be=Math.round(X),Ve=Ee;Ve<=Be;Ve++){if(Ve<Z){var Oe=void 0;H=ve-(ve-fe)*(Oe=Ve<J?0:(J-Ve)/(J-Z)),U=Ae-(Ae-Ie)*Oe,te=$e-($e-Le)*Oe,Q=Me-(Me-le)*Oe}else{var je=void 0;H=fe-(fe-j)*(je=Ve>X?1:Z===X?0:(Z-Ve)/(Z-X)),U=Ie-(Ie-oe)*je,te=Le-(Le-ke)*je,Q=le-(le-Ce)*je}var Ge=void 0;re=ve-(ve-j)*(Ge=Ve<J?0:Ve>X?1:(J-Ve)/(J-X)),Pe=Ae-(Ae-oe)*Ge,be=$e-($e-ke)*Ge,we=Me-(Me-Ce)*Ge;for(var Xe=Math.round(Math.min(H,re)),qe=Math.round(Math.max(H,re)),Ke=ne*Ve+4*Xe,Je=Xe;Je<=qe;Je++)(Ge=(H-Je)/(H-re))<0?Ge=0:Ge>1&&(Ge=1),_e[Ke++]=U-(U-Pe)*Ge|0,_e[Ke++]=te-(te-be)*Ge|0,_e[Ke++]=Q-(Q-we)*Ge|0,_e[Ke++]=255}}function d(S,E,M){var T,D,N=E.coords,I=E.colors;switch(E.type){case"lattice":var O=E.verticesPerRow,F=Math.floor(N.length/O)-1,q=O-1;for(T=0;T<F;T++)for(var Y=T*O,_e=0;_e<q;_e++,Y++)g(S,M,N[Y],N[Y+1],N[Y+O],I[Y],I[Y+1],I[Y+O]),g(S,M,N[Y+O+1],N[Y+1],N[Y+O],I[Y+O+1],I[Y+1],I[Y+O]);break;case"triangles":for(T=0,D=N.length;T<D;T+=3)g(S,M,N[T],N[T+1],N[T+2],I[T],I[T+1],I[T+2]);break;default:throw new Error("illegal figure")}}var f=function(S){function E(M){var T;return _classCallCheck(this,E),(T=_callSuper(this,E))._coords=M[2],T._colors=M[3],T._figures=M[4],T._bounds=M[5],T._bbox=M[7],T._background=M[8],T.matrix=null,T}return _inherits(E,S),_createClass(E,[{key:"_createMeshCanvas",value:function(M,T,D){var N=Math.floor(this._bounds[0]),I=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-N,F=Math.ceil(this._bounds[3])-I,q=Math.min(Math.ceil(Math.abs(O*M[0]*1.1)),3e3),Y=Math.min(Math.ceil(Math.abs(F*M[1]*1.1)),3e3),_e=O/q,ne=F/Y,ve={coords:this._coords,colors:this._colors,offsetX:-N,offsetY:-I,scaleX:1/_e,scaleY:1/ne},J=q+4,fe=Y+4,Z=D.getCanvas("mesh",J,fe,!1),j=Z.context,X=j.createImageData(q,Y);if(T)for(var H=X.data,U=0,te=H.length;U<te;U+=4)H[U]=T[0],H[U+1]=T[1],H[U+2]=T[2],H[U+3]=255;var Q,re=_createForOfIteratorHelper(this._figures);try{for(re.s();!(Q=re.n()).done;)d(X,Q.value,ve)}catch(Pe){re.e(Pe)}finally{re.f()}return j.putImageData(X,2,2),{canvas:Z.canvas,offsetX:N-2*_e,offsetY:I-2*ne,scaleX:_e,scaleY:ne}}},{key:"getPattern",value:function(M,T,D,N){var I;if(w(M,this._bbox),N===s.SHADING)I=r.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(M));else if(I=r.Util.singularValueDecompose2dScale(T.baseTransform),this.matrix){var O=r.Util.singularValueDecompose2dScale(this.matrix);I=[I[0]*O[0],I[1]*O[1]]}var F=this._createMeshCanvas(I,N===s.SHADING?null:this._background,T.cachedCanvases);return N!==s.SHADING&&(M.setTransform.apply(M,_toConsumableArray$1(T.baseTransform)),this.matrix&&M.transform.apply(M,_toConsumableArray$1(this.matrix))),M.translate(F.offsetX,F.offsetY),M.scale(F.scaleX,F.scaleY),M.createPattern(F.canvas,"no-repeat")}}])}(m),y=function(S){function E(){return _classCallCheck(this,E),_callSuper(this,E,arguments)}return _inherits(E,S),_createClass(E,[{key:"getPattern",value:function(){return"hotpink"}}])}(m),x=1,k=2,P=function(){function S(E,M,T,D,N){_classCallCheck(this,S),this.operatorList=E[2],this.matrix=E[3]||[1,0,0,1,0,0],this.bbox=E[4],this.xstep=E[5],this.ystep=E[6],this.paintType=E[7],this.tilingType=E[8],this.color=M,this.ctx=T,this.canvasGraphicsFactory=D,this.baseTransform=N}return _createClass(S,[{key:"createPatternCanvas",value:function(E){var M=this.operatorList,T=this.bbox,D=this.xstep,N=this.ystep,I=this.paintType,O=this.tilingType,F=this.color,q=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+O);var Y=T[0],_e=T[1],ne=T[2],ve=T[3],J=r.Util.singularValueDecompose2dScale(this.matrix),fe=r.Util.singularValueDecompose2dScale(this.baseTransform),Z=[J[0]*fe[0],J[1]*fe[1]],j=this.getSizeAndScale(D,this.ctx.canvas.width,Z[0]),X=this.getSizeAndScale(N,this.ctx.canvas.height,Z[1]),H=E.cachedCanvases.getCanvas("pattern",j.size,X.size,!0),U=H.context,te=q.createCanvasGraphics(U);te.groupLevel=E.groupLevel,this.setFillAndStrokeStyleToContext(te,I,F);var Q=Y,re=_e,Pe=ne,be=ve;return Y<0&&(Q=0,Pe+=Math.abs(Y)),_e<0&&(re=0,be+=Math.abs(_e)),U.translate(-j.scale*Q,-X.scale*re),te.transform(j.scale,0,0,X.scale,0,0),U.save(),this.clipBbox(te,Q,re,Pe,be),te.baseTransform=(0,u.getCurrentTransform)(te.ctx),te.executeOperatorList(M),te.endDrawing(),{canvas:H.canvas,scaleX:j.scale,scaleY:X.scale,offsetX:Q,offsetY:re}}},{key:"getSizeAndScale",value:function(E,M,T){E=Math.abs(E);var D=Math.max(S.MAX_PATTERN_SIZE,M),N=Math.ceil(E*T);return N>=D?N=D:T=N/E,{scale:T,size:N}}},{key:"clipBbox",value:function(E,M,T,D,N){var I=D-M,O=N-T;E.ctx.rect(M,T,I,O),E.current.updateRectMinMax((0,u.getCurrentTransform)(E.ctx),[M,T,D,N]),E.clip(),E.endPath()}},{key:"setFillAndStrokeStyleToContext",value:function(E,M,T){var D=E.ctx,N=E.current;switch(M){case x:var I=this.ctx;D.fillStyle=I.fillStyle,D.strokeStyle=I.strokeStyle,N.fillColor=I.fillStyle,N.strokeColor=I.strokeStyle;break;case k:var O=r.Util.makeHexColor(T[0],T[1],T[2]);D.fillStyle=O,D.strokeStyle=O,N.fillColor=O,N.strokeColor=O;break;default:throw new r.FormatError("Unsupported paint type: ".concat(M))}}},{key:"getPattern",value:function(E,M,T,D){var N=T;D!==s.SHADING&&(N=r.Util.transform(N,M.baseTransform),this.matrix&&(N=r.Util.transform(N,this.matrix)));var I=this.createPatternCanvas(M),O=new DOMMatrix(N);O=(O=O.translate(I.offsetX,I.offsetY)).scale(1/I.scaleX,1/I.scaleY);var F=E.createPattern(I.canvas,"repeat");return F.setTransform(O),F}}],[{key:"MAX_PATTERN_SIZE",get:function(){return(0,r.shadow)(this,"MAX_PATTERN_SIZE",3e3)}}])}();n.TilingPattern=P},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=u,n.convertToRGBA=function(s){switch(s.kind){case r.ImageKind.GRAYSCALE_1BPP:return u(s);case r.ImageKind.RGB_24BPP:return function(w){var m=w.src,v=w.srcPos,g=v===void 0?0:v,d=w.dest,f=w.destPos,y=f===void 0?0:f;w.width,w.height;var x=0,k=m.length>>2,P=new Uint32Array(m.buffer,g,k);if(r.FeatureTest.isLittleEndian){for(;x<k-2;x+=3,y+=4){var S=P[x],E=P[x+1],M=P[x+2];d[y]=4278190080|S,d[y+1]=S>>>24|E<<8|4278190080,d[y+2]=E>>>16|M<<16|4278190080,d[y+3]=M>>>8|4278190080}for(var T=4*x,D=m.length;T<D;T+=3)d[y++]=m[T]|m[T+1]<<8|m[T+2]<<16|4278190080}else{for(;x<k-2;x+=3,y+=4){var N=P[x],I=P[x+1],O=P[x+2];d[y]=255|N,d[y+1]=N<<24|I>>>8|255,d[y+2]=I<<16|O>>>16|255,d[y+3]=O<<8|255}for(var F=4*x,q=m.length;F<q;F+=3)d[y++]=m[F]<<24|m[F+1]<<16|m[F+2]<<8|255}return{srcPos:g,destPos:y}}(s)}return null},n.grayToRGBA=function(s,w){if(r.FeatureTest.isLittleEndian)for(var m=0,v=s.length;m<v;m++)w[m]=65793*s[m]|4278190080;else for(var g=0,d=s.length;g<d;g++)w[g]=16843008*s[g]|255};var r=o(1);function u(s){var w=s.src,m=s.srcPos,v=m===void 0?0:m,g=s.dest,d=s.width,f=s.height,y=s.nonBlackColor,x=y===void 0?4294967295:y,k=s.inverseDecode,P=k!==void 0&&k,S=r.FeatureTest.isLittleEndian?4278190080:255,E=_slicedToArray(P?[x,S]:[S,x],2),M=E[0],T=E[1],D=d>>3,N=7&d,I=w.length;g=new Uint32Array(g.buffer);for(var O=0,F=0;F<f;F++){for(var q=v+D;v<q;v++){var Y=v<I?w[v]:255;g[O++]=128&Y?T:M,g[O++]=64&Y?T:M,g[O++]=32&Y?T:M,g[O++]=16&Y?T:M,g[O++]=8&Y?T:M,g[O++]=4&Y?T:M,g[O++]=2&Y?T:M,g[O++]=1&Y?T:M}if(N!==0)for(var _e=v<I?w[v++]:255,ne=0;ne<N;ne++)g[O++]=_e&1<<7-ne?T:M}return{srcPos:v,destPos:O}}},function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;var o=Object.create(null);n.GlobalWorkerOptions=o,o.workerPort=null,o.workerSrc=""},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var r=o(1),u=1,s=2,w=1,m=2,v=3,g=4,d=5,f=6,y=7,x=8;function k(S){switch(S instanceof Error||_typeof$1(S)==="object"&&S!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new r.AbortException(S.message);case"MissingPDFException":return new r.MissingPDFException(S.message);case"PasswordException":return new r.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new r.UnknownErrorException(S.message,S.details);default:return new r.UnknownErrorException(S.message,S.toString())}}var P=function(){return _createClass(function E(M,T,D){var N=this;_classCallCheck(this,E),this.sourceName=M,this.targetName=T,this.comObj=D,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=function(I){var O=I.data;if(O.targetName===N.sourceName)if(O.stream)N._processStreamMessage(O);else if(O.callback){var F=O.callbackId,q=N.callbackCapabilities[F];if(!q)throw new Error("Cannot resolve callback ".concat(F));if(delete N.callbackCapabilities[F],O.callback===u)q.resolve(O.data);else{if(O.callback!==s)throw new Error("Unexpected callback case");q.reject(k(O.reason))}}else{var Y=N.actionHandler[O.action];if(!Y)throw new Error("Unknown action from worker: ".concat(O.action));if(O.callbackId){var _e=N.sourceName,ne=O.sourceName;new Promise(function(ve){ve(Y(O.data))}).then(function(ve){D.postMessage({sourceName:_e,targetName:ne,callback:u,callbackId:O.callbackId,data:ve})},function(ve){D.postMessage({sourceName:_e,targetName:ne,callback:s,callbackId:O.callbackId,reason:k(ve)})})}else O.streamId?N._createStreamSink(O):Y(O.data)}},D.addEventListener("message",this._onComObjOnMessage)},[{key:"on",value:function(E,M){var T=this.actionHandler;if(T[E])throw new Error('There is already an actionName called "'.concat(E,'"'));T[E]=M}},{key:"send",value:function(E,M,T){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,data:M},T)}},{key:"sendWithPromise",value:function(E,M,T){var D=this.callbackId++,N=(0,r.createPromiseCapability)();this.callbackCapabilities[D]=N;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,callbackId:D,data:M},T)}catch(I){N.reject(I)}return N.promise}},{key:"sendWithStream",value:function(E,M,T,D){var N=this,I=this.streamId++,O=this.sourceName,F=this.targetName,q=this.comObj;return new ReadableStream({start:function(Y){var _e=(0,r.createPromiseCapability)();return N.streamControllers[I]={controller:Y,startCall:_e,pullCall:null,cancelCall:null,isClosed:!1},q.postMessage({sourceName:O,targetName:F,action:E,streamId:I,data:M,desiredSize:Y.desiredSize},D),_e.promise},pull:function(Y){var _e=(0,r.createPromiseCapability)();return N.streamControllers[I].pullCall=_e,q.postMessage({sourceName:O,targetName:F,stream:f,streamId:I,desiredSize:Y.desiredSize}),_e.promise},cancel:function(Y){(0,r.assert)(Y instanceof Error,"cancel must have a valid reason");var _e=(0,r.createPromiseCapability)();return N.streamControllers[I].cancelCall=_e,N.streamControllers[I].isClosed=!0,q.postMessage({sourceName:O,targetName:F,stream:w,streamId:I,reason:k(Y)}),_e.promise}},T)}},{key:"_createStreamSink",value:function(E){var M=E.streamId,T=this.sourceName,D=E.sourceName,N=this.comObj,I=this,O=this.actionHandler[E.action],F={enqueue:function(q){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,_e=arguments.length>2?arguments[2]:void 0;if(!this.isCancelled){var ne=this.desiredSize;this.desiredSize-=Y,ne>0&&this.desiredSize<=0&&(this.sinkCapability=(0,r.createPromiseCapability)(),this.ready=this.sinkCapability.promise),N.postMessage({sourceName:T,targetName:D,stream:g,streamId:M,chunk:q},_e)}},close:function(){this.isCancelled||(this.isCancelled=!0,N.postMessage({sourceName:T,targetName:D,stream:v,streamId:M}),delete I.streamSinks[M])},error:function(q){(0,r.assert)(q instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,N.postMessage({sourceName:T,targetName:D,stream:d,streamId:M,reason:k(q)}))},sinkCapability:(0,r.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:E.desiredSize,ready:null};F.sinkCapability.resolve(),F.ready=F.sinkCapability.promise,this.streamSinks[M]=F,new Promise(function(q){q(O(E.data,F))}).then(function(){N.postMessage({sourceName:T,targetName:D,stream:x,streamId:M,success:!0})},function(q){N.postMessage({sourceName:T,targetName:D,stream:x,streamId:M,reason:k(q)})})}},{key:"_processStreamMessage",value:function(E){var M=E.streamId,T=this.sourceName,D=E.sourceName,N=this.comObj,I=this.streamControllers[M],O=this.streamSinks[M];switch(E.stream){case x:E.success?I.startCall.resolve():I.startCall.reject(k(E.reason));break;case y:E.success?I.pullCall.resolve():I.pullCall.reject(k(E.reason));break;case f:if(!O){N.postMessage({sourceName:T,targetName:D,stream:y,streamId:M,success:!0});break}O.desiredSize<=0&&E.desiredSize>0&&O.sinkCapability.resolve(),O.desiredSize=E.desiredSize,new Promise(function(F){F(O.onPull&&O.onPull())}).then(function(){N.postMessage({sourceName:T,targetName:D,stream:y,streamId:M,success:!0})},function(F){N.postMessage({sourceName:T,targetName:D,stream:y,streamId:M,reason:k(F)})});break;case g:if((0,r.assert)(I,"enqueue should have stream controller"),I.isClosed)break;I.controller.enqueue(E.chunk);break;case v:if((0,r.assert)(I,"close should have stream controller"),I.isClosed)break;I.isClosed=!0,I.controller.close(),this._deleteStreamController(I,M);break;case d:(0,r.assert)(I,"error should have stream controller"),I.controller.error(k(E.reason)),this._deleteStreamController(I,M);break;case m:E.success?I.cancelCall.resolve():I.cancelCall.reject(k(E.reason)),this._deleteStreamController(I,M);break;case w:if(!O)break;new Promise(function(F){F(O.onCancel&&O.onCancel(k(E.reason)))}).then(function(){N.postMessage({sourceName:T,targetName:D,stream:m,streamId:M,success:!0})},function(F){N.postMessage({sourceName:T,targetName:D,stream:m,streamId:M,reason:k(F)})}),O.sinkCapability.reject(k(E.reason)),O.isCancelled=!0,delete this.streamSinks[M];break;default:throw new Error("Unexpected stream case")}}},{key:"_deleteStreamController",value:(S=_asyncToGenerator(_regeneratorRuntime().mark(function E(M,T){return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,Promise.allSettled([M.startCall&&M.startCall.promise,M.pullCall&&M.pullCall.promise,M.cancelCall&&M.cancelCall.promise]);case 2:delete this.streamControllers[T];case 3:case"end":return D.stop()}},E,this)})),function(E,M){return S.apply(this,arguments)})},{key:"destroy",value:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}]);var S}();n.MessageHandler=P},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var r=o(1),u=new WeakMap,s=new WeakMap,w=function(){return _createClass(function m(v){_classCallCheck(this,m),_classPrivateFieldInitSpec(this,u,void 0),_classPrivateFieldInitSpec(this,s,void 0);var g=v.parsedData,d=v.rawData;_classPrivateFieldSet2(u,this,g),_classPrivateFieldSet2(s,this,d)},[{key:"getRaw",value:function(){return _classPrivateFieldGet2(s,this)}},{key:"get",value:function(m){var v;return(v=_classPrivateFieldGet2(u,this).get(m))!==null&&v!==void 0?v:null}},{key:"getAll",value:function(){return(0,r.objectFromMap)(_classPrivateFieldGet2(u,this))}},{key:"has",value:function(m){return _classPrivateFieldGet2(u,this).has(m)}}])}();n.Metadata=w},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var r=o(1),u=o(144);function s(N,I,O){w(N,I),I.set(N,O)}function w(N,I){if(I.has(N))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m(N,I,O){if(!I.has(N))throw new TypeError("attempted to get private field on non-instance");return O}function v(N,I){return function(O,F){return F.get?F.get.call(O):F.value}(N,d(N,I,"get"))}function g(N,I,O){return function(F,q,Y){if(q.set)q.set.call(F,Y);else{if(!q.writable)throw new TypeError("attempted to set read only private field");q.value=Y}}(N,d(N,I,"set"),O),O}function d(N,I,O){if(!I.has(N))throw new TypeError("attempted to "+O+" private field on non-instance");return I.get(N)}var f=Symbol("INTERNAL"),y=new WeakMap,x=function(){return _createClass(function N(I,O){_classCallCheck(this,N),_classPrivateFieldInitSpec(this,y,!0),this.name=I,this.intent=O},[{key:"visible",get:function(){return _classPrivateFieldGet2(y,this)}},{key:"_setVisible",value:function(N,I){N!==f&&(0,r.unreachable)("Internal method `_setVisible` called."),_classPrivateFieldSet2(y,this,I)}}])}(),k=new WeakMap,P=new WeakMap,S=new WeakMap,E=new WeakMap,M=new WeakSet,T=function(){return _createClass(function N(I){var O,F;if(_classCallCheck(this,N),w(O=this,F=M),F.add(O),s(this,k,{writable:!0,value:null}),s(this,P,{writable:!0,value:new Map}),s(this,S,{writable:!0,value:null}),s(this,E,{writable:!0,value:null}),this.name=null,this.creator=null,I!==null){this.name=I.name,this.creator=I.creator,g(this,E,I.order);var q,Y=_createForOfIteratorHelper(I.groups);try{for(Y.s();!(q=Y.n()).done;){var _e=q.value;v(this,P).set(_e.id,new x(_e.name,_e.intent))}}catch(U){Y.e(U)}finally{Y.f()}if(I.baseState==="OFF"){var ne,ve=_createForOfIteratorHelper(v(this,P).values());try{for(ve.s();!(ne=ve.n()).done;)ne.value._setVisible(f,!1)}catch(U){ve.e(U)}finally{ve.f()}}var J,fe=_createForOfIteratorHelper(I.on);try{for(fe.s();!(J=fe.n()).done;){var Z=J.value;v(this,P).get(Z)._setVisible(f,!0)}}catch(U){fe.e(U)}finally{fe.f()}var j,X=_createForOfIteratorHelper(I.off);try{for(X.s();!(j=X.n()).done;){var H=j.value;v(this,P).get(H)._setVisible(f,!1)}}catch(U){X.e(U)}finally{X.f()}g(this,S,this.getHash())}},[{key:"isVisible",value:function(N){if(v(this,P).size===0)return!0;if(!N)return(0,r.warn)("Optional content group not defined."),!0;if(N.type==="OCG")return v(this,P).has(N.id)?v(this,P).get(N.id).visible:((0,r.warn)("Optional content group not found: ".concat(N.id)),!0);if(N.type==="OCMD"){if(N.expression)return m(this,M,D).call(this,N.expression);if(!N.policy||N.policy==="AnyOn"){var I,O=_createForOfIteratorHelper(N.ids);try{for(O.s();!(I=O.n()).done;){var F=I.value;if(!v(this,P).has(F))return(0,r.warn)("Optional content group not found: ".concat(F)),!0;if(v(this,P).get(F).visible)return!0}}catch(X){O.e(X)}finally{O.f()}return!1}if(N.policy==="AllOn"){var q,Y=_createForOfIteratorHelper(N.ids);try{for(Y.s();!(q=Y.n()).done;){var _e=q.value;if(!v(this,P).has(_e))return(0,r.warn)("Optional content group not found: ".concat(_e)),!0;if(!v(this,P).get(_e).visible)return!1}}catch(X){Y.e(X)}finally{Y.f()}return!0}if(N.policy==="AnyOff"){var ne,ve=_createForOfIteratorHelper(N.ids);try{for(ve.s();!(ne=ve.n()).done;){var J=ne.value;if(!v(this,P).has(J))return(0,r.warn)("Optional content group not found: ".concat(J)),!0;if(!v(this,P).get(J).visible)return!0}}catch(X){ve.e(X)}finally{ve.f()}return!1}if(N.policy==="AllOff"){var fe,Z=_createForOfIteratorHelper(N.ids);try{for(Z.s();!(fe=Z.n()).done;){var j=fe.value;if(!v(this,P).has(j))return(0,r.warn)("Optional content group not found: ".concat(j)),!0;if(v(this,P).get(j).visible)return!1}}catch(X){Z.e(X)}finally{Z.f()}return!0}return(0,r.warn)("Unknown optional content policy ".concat(N.policy,".")),!0}return(0,r.warn)("Unknown group type ".concat(N.type,".")),!0}},{key:"setVisibility",value:function(N){var I=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];v(this,P).has(N)?(v(this,P).get(N)._setVisible(f,!!I),g(this,k,null)):(0,r.warn)("Optional content group not found: ".concat(N))}},{key:"hasInitialVisibility",get:function(){return this.getHash()===v(this,S)}},{key:"getOrder",value:function(){return v(this,P).size?v(this,E)?v(this,E).slice():_toConsumableArray$1(v(this,P).keys()):null}},{key:"getGroups",value:function(){return v(this,P).size>0?(0,r.objectFromMap)(v(this,P)):null}},{key:"getGroup",value:function(N){return v(this,P).get(N)||null}},{key:"getHash",value:function(){if(v(this,k)!==null)return v(this,k);var N,I=new u.MurmurHash3_64,O=_createForOfIteratorHelper(v(this,P));try{for(O.s();!(N=O.n()).done;){var F=_slicedToArray(N.value,2),q=F[0],Y=F[1];I.update("".concat(q,":").concat(Y.visible))}}catch(_e){O.e(_e)}finally{O.f()}return g(this,k,I.hexdigest())}}])}();function D(N){var I=N.length;if(I<2)return!0;for(var O=N[0],F=1;F<I;F++){var q=N[F],Y=void 0;if(Array.isArray(q))Y=m(this,M,D).call(this,q);else{if(!v(this,P).has(q))return(0,r.warn)("Optional content group not found: ".concat(q)),!0;Y=v(this,P).get(q).visible}switch(O){case"And":if(!Y)return!1;break;case"Or":if(Y)return!0;break;case"Not":return!Y;default:return!0}}return O==="And"}n.OptionalContentConfig=T},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var r=o(1),u=o(142),s=function(){return _createClass(function v(g,d){var f=this;_classCallCheck(this,v);var y=g.length,x=g.initialData,k=g.progressiveDone,P=k!==void 0&&k,S=g.contentDispositionFilename,E=S===void 0?null:S,M=g.disableRange,T=M!==void 0&&M,D=g.disableStream,N=D!==void 0&&D;if((0,r.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=P,this._contentDispositionFilename=E,(x==null?void 0:x.length)>0){var I=x instanceof Uint8Array&&x.byteLength===x.buffer.byteLength?x.buffer:new Uint8Array(x).buffer;this._queuedChunks.push(I)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!N,this._isRangeSupported=!T,this._contentLength=y,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(function(O,F){f._onReceiveData({begin:O,chunk:F})}),this._pdfDataRangeTransport.addProgressListener(function(O,F){f._onProgress({loaded:O,total:F})}),this._pdfDataRangeTransport.addProgressiveReadListener(function(O){f._onReceiveData({chunk:O})}),this._pdfDataRangeTransport.addProgressiveDoneListener(function(){f._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()},[{key:"_onReceiveData",value:function(v){var g=v.begin,d=v.chunk,f=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;if(g===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(f):this._queuedChunks.push(f);else{var y=this._rangeReaders.some(function(x){return x._begin===g&&(x._enqueue(f),!0)});(0,r.assert)(y,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}},{key:"_progressiveDataLength",get:function(){var v,g;return(v=(g=this._fullRequestReader)===null||g===void 0?void 0:g._loaded)!==null&&v!==void 0?v:0}},{key:"_onProgress",value:function(v){var g,d,f,y;v.total===void 0?(g=this._rangeReaders[0])===null||g===void 0||(d=g.onProgress)===null||d===void 0||d.call(g,{loaded:v.loaded}):(f=this._fullRequestReader)===null||f===void 0||(y=f.onProgress)===null||y===void 0||y.call(f,{loaded:v.loaded,total:v.total})}},{key:"_onProgressiveDone",value:function(){var v;(v=this._fullRequestReader)===null||v===void 0||v.progressiveDone(),this._progressiveDone=!0}},{key:"_removeRangeReader",value:function(v){var g=this._rangeReaders.indexOf(v);g>=0&&this._rangeReaders.splice(g,1)}},{key:"getFullReader",value:function(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");var v=this._queuedChunks;return this._queuedChunks=null,new w(this,v,this._progressiveDone,this._contentDispositionFilename)}},{key:"getRangeReader",value:function(v,g){if(g<=this._progressiveDataLength)return null;var d=new m(this,v,g);return this._pdfDataRangeTransport.requestDataRange(v,g),this._rangeReaders.push(d),d}},{key:"cancelAllRequests",value:function(v){var g;(g=this._fullRequestReader)===null||g===void 0||g.cancel(v);var d,f=_createForOfIteratorHelper(this._rangeReaders.slice(0));try{for(f.s();!(d=f.n()).done;)d.value.cancel(v)}catch(y){f.e(y)}finally{f.f()}this._pdfDataRangeTransport.abort()}}])}();n.PDFDataTransportStream=s;var w=function(){return _createClass(function g(d,f){_classCallCheck(this,g);var y=arguments.length>2&&arguments[2]!==void 0&&arguments[2],x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=d,this._done=y||!1,this._filename=(0,u.isPdfFile)(x)?x:null,this._queuedChunks=f||[],this._loaded=0;var k,P=_createForOfIteratorHelper(this._queuedChunks);try{for(P.s();!(k=P.n()).done;){var S=k.value;this._loaded+=S.byteLength}}catch(E){P.e(E)}finally{P.f()}this._requests=[],this._headersReady=Promise.resolve(),d._fullRequestReader=this,this.onProgress=null},[{key:"_enqueue",value:function(g){this._done||(this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunks.push(g),this._loaded+=g.byteLength)}},{key:"headersReady",get:function(){return this._headersReady}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._stream._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._stream._isStreamingSupported}},{key:"contentLength",get:function(){return this._stream._contentLength}},{key:"read",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(this._queuedChunks.length>0)){y.next=3;break}return d=this._queuedChunks.shift(),y.abrupt("return",{value:d,done:!1});case 3:if(!this._done){y.next=5;break}return y.abrupt("return",{value:void 0,done:!0});case 5:return f=(0,r.createPromiseCapability)(),this._requests.push(f),y.abrupt("return",f.promise);case 8:case"end":return y.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"cancel",value:function(g){this._done=!0;var d,f=_createForOfIteratorHelper(this._requests);try{for(f.s();!(d=f.n()).done;)d.value.resolve({value:void 0,done:!0})}catch(y){f.e(y)}finally{f.f()}this._requests.length=0}},{key:"progressiveDone",value:function(){this._done||(this._done=!0)}}]);var v}(),m=function(){return _createClass(function g(d,f,y){_classCallCheck(this,g),this._stream=d,this._begin=f,this._end=y,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null},[{key:"_enqueue",value:function(g){if(!this._done){if(this._requests.length===0)this._queuedChunk=g;else{this._requests.shift().resolve({value:g,done:!1});var d,f=_createForOfIteratorHelper(this._requests);try{for(f.s();!(d=f.n()).done;)d.value.resolve({value:void 0,done:!0})}catch(y){f.e(y)}finally{f.f()}this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this._queuedChunk){y.next=4;break}return d=this._queuedChunk,this._queuedChunk=null,y.abrupt("return",{value:d,done:!1});case 4:if(!this._done){y.next=6;break}return y.abrupt("return",{value:void 0,done:!0});case 6:return f=(0,r.createPromiseCapability)(),this._requests.push(f),y.abrupt("return",f.promise);case 9:case"end":return y.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"cancel",value:function(g){this._done=!0;var d,f=_createForOfIteratorHelper(this._requests);try{for(f.s();!(d=f.n()).done;)d.value.resolve({value:void 0,done:!0})}catch(y){f.e(y)}finally{f.f()}this._requests.length=0,this._stream._removeRangeReader(this)}}]);var v}()},function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;var o=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"textContent",value:function(u){var s=[],w={items:s,styles:Object.create(null)};return function m(v){var g;if(v){var d=null,f=v.name;if(f==="#text")d=v.value;else{if(!r.shouldBuildText(f))return;v!=null&&(g=v.attributes)!==null&&g!==void 0&&g.textContent?d=v.attributes.textContent:v.value&&(d=v.value)}if(d!==null&&s.push({str:d}),v.children){var y,x=_createForOfIteratorHelper(v.children);try{for(x.s();!(y=x.n()).done;)m(y.value)}catch(k){x.e(k)}finally{x.f()}}}}(u),w}},{key:"shouldBuildText",value:function(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}])}();n.XfaText=o},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var r=o(143),u=function(g){return new Promise(function(d,f){require$$0.readFile(g,function(y,x){!y&&x?d(new Uint8Array(x)):f(new Error(y))})})},s=function(g){function d(){return _classCallCheck(this,d),_callSuper(this,d,arguments)}return _inherits(d,g),_createClass(d)}(r.BaseFilterFactory);n.NodeFilterFactory=s;var w=function(g){function d(){return _classCallCheck(this,d),_callSuper(this,d,arguments)}return _inherits(d,g),_createClass(d,[{key:"_createCanvas",value:function(f,y){return require$$0.createCanvas(f,y)}}])}(r.BaseCanvasFactory);n.NodeCanvasFactory=w;var m=function(g){function d(){return _classCallCheck(this,d),_callSuper(this,d,arguments)}return _inherits(d,g),_createClass(d,[{key:"_fetchData",value:function(f,y){return u(f).then(function(x){return{cMapData:x,compressionType:y}})}}])}(r.BaseCMapReaderFactory);n.NodeCMapReaderFactory=m;var v=function(g){function d(){return _classCallCheck(this,d),_callSuper(this,d,arguments)}return _inherits(d,g),_createClass(d,[{key:"_fetchData",value:function(f){return u(f)}}])}(r.BaseStandardFontDataFactory);n.NodeStandardFontDataFactory=v},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var r=o(1),u=o(157),s=require$$0,w=require$$0,m=require$$0,v=require$$0,g=/^file:\/\/\/[a-zA-Z]:\//,d=function(){return _createClass(function M(T){var D,N;_classCallCheck(this,M),this.source=T,this.url=(D=T.url,(N=v.parse(D)).protocol==="file:"||N.host?N:/^[a-z]:[/\\]/i.test(D)?v.parse("file:///".concat(D)):(N.host||(N.protocol="file:"),N)),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&T.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]},[{key:"_progressiveDataLength",get:function(){var M,T;return(M=(T=this._fullRequestReader)===null||T===void 0?void 0:T._loaded)!==null&&M!==void 0?M:0}},{key:"getFullReader",value:function(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new S(this):new k(this),this._fullRequestReader}},{key:"getRangeReader",value:function(M,T){if(T<=this._progressiveDataLength)return null;var D=this.isFsUrl?new E(this,M,T):new P(this,M,T);return this._rangeRequestReaders.push(D),D}},{key:"cancelAllRequests",value:function(M){var T;(T=this._fullRequestReader)===null||T===void 0||T.cancel(M);var D,N=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(N.s();!(D=N.n()).done;)D.value.cancel(M)}catch(I){N.e(I)}finally{N.f()}}}])}();n.PDFNodeStream=d;var f=function(){return _createClass(function T(D){_classCallCheck(this,T),this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null;var N=D.source;this._contentLength=N.length,this._loaded=0,this._filename=null,this._disableRange=N.disableRange||!1,this._rangeChunkSize=N.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!N.disableStream,this._isRangeSupported=!N.disableRange,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)(),this._headersCapability=(0,r.createPromiseCapability)()},[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(M=_asyncToGenerator(_regeneratorRuntime().mark(function T(){var D,N,I;return _regeneratorRuntime().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,this._readCapability.promise;case 2:if(!this._done){O.next=4;break}return O.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){O.next=6;break}throw this._storedError;case 6:if((N=this._readableStream.read())!==null){O.next=10;break}return this._readCapability=(0,r.createPromiseCapability)(),O.abrupt("return",this.read());case 10:return this._loaded+=N.length,(D=this.onProgress)===null||D===void 0||D.call(this,{loaded:this._loaded,total:this._contentLength}),I=new Uint8Array(N).buffer,O.abrupt("return",{value:I,done:!1});case 14:case"end":return O.stop()}},T,this)})),function(){return M.apply(this,arguments)})},{key:"cancel",value:function(T){this._readableStream?this._readableStream.destroy(T):this._error(T)}},{key:"_error",value:function(T){this._storedError=T,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(T){var D=this;this._readableStream=T,T.on("readable",function(){D._readCapability.resolve()}),T.on("end",function(){T.destroy(),D._done=!0,D._readCapability.resolve()}),T.on("error",function(N){D._error(N)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}]);var M}(),y=function(){return _createClass(function T(D){_classCallCheck(this,T),this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)();var N=D.source;this._isStreamingSupported=!N.disableStream},[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(M=_asyncToGenerator(_regeneratorRuntime().mark(function T(){var D,N,I;return _regeneratorRuntime().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,this._readCapability.promise;case 2:if(!this._done){O.next=4;break}return O.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){O.next=6;break}throw this._storedError;case 6:if((N=this._readableStream.read())!==null){O.next=10;break}return this._readCapability=(0,r.createPromiseCapability)(),O.abrupt("return",this.read());case 10:return this._loaded+=N.length,(D=this.onProgress)===null||D===void 0||D.call(this,{loaded:this._loaded}),I=new Uint8Array(N).buffer,O.abrupt("return",{value:I,done:!1});case 14:case"end":return O.stop()}},T,this)})),function(){return M.apply(this,arguments)})},{key:"cancel",value:function(T){this._readableStream?this._readableStream.destroy(T):this._error(T)}},{key:"_error",value:function(T){this._storedError=T,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(T){var D=this;this._readableStream=T,T.on("readable",function(){D._readCapability.resolve()}),T.on("end",function(){T.destroy(),D._done=!0,D._readCapability.resolve()}),T.on("error",function(N){D._error(N)}),this._storedError&&this._readableStream.destroy(this._storedError)}}]);var M}();function x(M,T){return{protocol:M.protocol,auth:M.auth,host:M.hostname,port:M.port,path:M.path,method:"GET",headers:T}}var k=function(M){function T(D){var N;_classCallCheck(this,T);var I=function(O){if(O.statusCode===404){var F=new r.MissingPDFException('Missing PDF "'.concat(N._url,'".'));return N._storedError=F,void N._headersCapability.reject(F)}N._headersCapability.resolve(),N._setReadableStream(O);var q=function(ve){return N._readableStream.headers[ve.toLowerCase()]},Y=(0,u.validateRangeRequestCapabilities)({getResponseHeader:q,isHttp:D.isHttp,rangeChunkSize:N._rangeChunkSize,disableRange:N._disableRange}),_e=Y.allowRangeRequests,ne=Y.suggestedLength;N._isRangeSupported=_e,N._contentLength=ne||N._contentLength,N._filename=(0,u.extractFilenameFromHeader)(q)};return(N=_callSuper(this,T,[D]))._request=null,N._url.protocol==="http:"?N._request=w.request(x(N._url,D.httpHeaders),I):N._request=m.request(x(N._url,D.httpHeaders),I),N._request.on("error",function(O){N._storedError=O,N._headersCapability.reject(O)}),N._request.end(),N}return _inherits(T,M),_createClass(T)}(f),P=function(M){function T(D,N,I){var O;for(var F in _classCallCheck(this,T),(O=_callSuper(this,T,[D]))._httpHeaders={},D.httpHeaders){var q=D.httpHeaders[F];q!==void 0&&(O._httpHeaders[F]=q)}O._httpHeaders.Range="bytes=".concat(N,"-").concat(I-1);var Y=function(_e){if(_e.statusCode!==404)O._setReadableStream(_e);else{var ne=new r.MissingPDFException('Missing PDF "'.concat(O._url,'".'));O._storedError=ne}};return O._request=null,O._url.protocol==="http:"?O._request=w.request(x(O._url,O._httpHeaders),Y):O._request=m.request(x(O._url,O._httpHeaders),Y),O._request.on("error",function(_e){O._storedError=_e}),O._request.end(),O}return _inherits(T,M),_createClass(T)}(y),S=function(M){function T(D){var N;_classCallCheck(this,T),N=_callSuper(this,T,[D]);var I=decodeURIComponent(N._url.path);return g.test(N._url.href)&&(I=I.replace(/^\//,"")),s.lstat(I,function(O,F){if(O)return O.code==="ENOENT"&&(O=new r.MissingPDFException('Missing PDF "'.concat(I,'".'))),N._storedError=O,void N._headersCapability.reject(O);N._contentLength=F.size,N._setReadableStream(s.createReadStream(I)),N._headersCapability.resolve()}),N}return _inherits(T,M),_createClass(T)}(f),E=function(M){function T(D,N,I){var O;_classCallCheck(this,T),O=_callSuper(this,T,[D]);var F=decodeURIComponent(O._url.path);return g.test(O._url.href)&&(F=F.replace(/^\//,"")),O._setReadableStream(s.createReadStream(F,{start:N,end:I-1})),O}return _inherits(T,M),_createClass(T)}(y)},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=function(w,m){return w===404||w===0&&m.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+m+'".'):new r.UnexpectedResponseException("Unexpected server response (".concat(w,') while retrieving PDF "').concat(m,'".'),w)},n.extractFilenameFromHeader=function(w){var m=w("Content-Disposition");if(m){var v=(0,u.getFilenameFromContentDispositionHeader)(m);if(v.includes("%"))try{v=decodeURIComponent(v)}catch{}if((0,s.isPdfFile)(v))return v}return null},n.validateRangeRequestCapabilities=function(w){var m=w.getResponseHeader,v=w.isHttp,g=w.rangeChunkSize,d=w.disableRange,f={allowRangeRequests:!1,suggestedLength:void 0},y=parseInt(m("Content-Length"),10);return Number.isInteger(y)&&(f.suggestedLength=y,y<=2*g||d||!v||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(f.allowRangeRequests=!0)),f},n.validateResponseStatus=function(w){return w===200||w===206};var r=o(1),u=o(158),s=o(142)},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=function(u){var s=!0,w=g("filename\\*","i").exec(u);if(w){var m=y(w=w[1]);return f(m=k(m=x(m=unescape(m))))}if(w=function(P){for(var S,E=[],M=g("filename\\*((?!0\\d)\\d+)(\\*?)","ig");(S=M.exec(P))!==null;){var T=_slicedToArray(S,4),D=T[1],N=T[2],I=T[3];if((D=parseInt(D,10))in E){if(D===0)break}else E[D]=[N,I]}for(var O=[],F=0;F<E.length&&F in E;++F){var q=_slicedToArray(E[F],2),Y=q[0],_e=q[1];_e=y(_e),Y&&(_e=unescape(_e),F===0&&(_e=x(_e))),O.push(_e)}return O.join("")}(u))return f(k(w));if(w=g("filename","i").exec(u)){var v=y(w=w[1]);return f(v=k(v))}function g(P,S){return new RegExp("(?:^|;)\\s*"+P+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',S)}function d(P,S){if(P){if(!/^[\x00-\xFF]+$/.test(S))return S;try{var E=new TextDecoder(P,{fatal:!0}),M=(0,r.stringToBytes)(S);S=E.decode(M),s=!1}catch{}}return S}function f(P){return s&&/[\x80-\xff]/.test(P)&&(P=d("utf-8",P),s&&(P=d("iso-8859-1",P))),P}function y(P){if(P.startsWith('"')){for(var S=P.slice(1).split('\\"'),E=0;E<S.length;++E){var M=S[E].indexOf('"');M!==-1&&(S[E]=S[E].slice(0,M),S.length=E+1),S[E]=S[E].replaceAll(/\\(.)/g,"$1")}P=S.join('"')}return P}function x(P){var S=P.indexOf("'");return S===-1?P:d(P.slice(0,S),P.slice(S+1).replace(/^[^']*'/,""))}function k(P){return!P.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(P)?P:P.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(S,E,M,T){if(M==="q"||M==="Q")return d(E,T=(T=T.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(D,N){return String.fromCharCode(parseInt(N,16))}));try{T=atob(T)}catch{}return d(E,T)})}return""};var r=o(1)},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var r=o(1),u=o(157),s=function(){return _createClass(function g(d){_classCallCheck(this,g);var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=d,this.isHttp=/^https?:/i.test(d),this.httpHeaders=this.isHttp&&f.httpHeaders||Object.create(null),this.withCredentials=f.withCredentials||!1,this.getXhr=f.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)},[{key:"requestRange",value:function(g,d,f){var y={begin:g,end:d};for(var x in f)y[x]=f[x];return this.request(y)}},{key:"requestFull",value:function(g){return this.request(g)}},{key:"request",value:function(g){var d=this.getXhr(),f=this.currXhrId++,y=this.pendingRequests[f]={xhr:d};for(var x in d.open("GET",this.url),d.withCredentials=this.withCredentials,this.httpHeaders){var k=this.httpHeaders[x];k!==void 0&&d.setRequestHeader(x,k)}return this.isHttp&&"begin"in g&&"end"in g?(d.setRequestHeader("Range","bytes=".concat(g.begin,"-").concat(g.end-1)),y.expectedStatus=206):y.expectedStatus=200,d.responseType="arraybuffer",g.onError&&(d.onerror=function(P){g.onError(d.status)}),d.onreadystatechange=this.onStateChange.bind(this,f),d.onprogress=this.onProgress.bind(this,f),y.onHeadersReceived=g.onHeadersReceived,y.onDone=g.onDone,y.onError=g.onError,y.onProgress=g.onProgress,d.send(null),f}},{key:"onProgress",value:function(g,d){var f,y=this.pendingRequests[g];y&&((f=y.onProgress)===null||f===void 0||f.call(y,d))}},{key:"onStateChange",value:function(g,d){var f=this.pendingRequests[g];if(f){var y=f.xhr;if(y.readyState>=2&&f.onHeadersReceived&&(f.onHeadersReceived(),delete f.onHeadersReceived),y.readyState===4&&g in this.pendingRequests)if(delete this.pendingRequests[g],y.status===0&&this.isHttp){var x;(x=f.onError)===null||x===void 0||x.call(f,y.status)}else{var k=y.status||200;if(k===200&&f.expectedStatus===206||k===f.expectedStatus){var P=function(D){var N=D.response;return typeof N!="string"?N:(0,r.stringToBytes)(N).buffer}(y);if(k===206){var S=y.getResponseHeader("Content-Range"),E=/bytes (\d+)-(\d+)\/(\d+)/.exec(S);f.onDone({begin:parseInt(E[1],10),chunk:P})}else if(P)f.onDone({begin:0,chunk:P});else{var M;(M=f.onError)===null||M===void 0||M.call(f,y.status)}}else{var T;(T=f.onError)===null||T===void 0||T.call(f,y.status)}}}}},{key:"getRequestXhr",value:function(g){return this.pendingRequests[g].xhr}},{key:"isPendingRequest",value:function(g){return g in this.pendingRequests}},{key:"abortRequest",value:function(g){var d=this.pendingRequests[g].xhr;delete this.pendingRequests[g],d.abort()}}])}(),w=function(){return _createClass(function g(d){_classCallCheck(this,g),this._source=d,this._manager=new s(d.url,{httpHeaders:d.httpHeaders,withCredentials:d.withCredentials}),this._rangeChunkSize=d.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]},[{key:"_onRangeRequestReaderClosed",value:function(g){var d=this._rangeRequestReaders.indexOf(g);d>=0&&this._rangeRequestReaders.splice(d,1)}},{key:"getFullReader",value:function(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}},{key:"getRangeReader",value:function(g,d){var f=new v(this._manager,g,d);return f.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(f),f}},{key:"cancelAllRequests",value:function(g){var d;(d=this._fullRequestReader)===null||d===void 0||d.cancel(g);var f,y=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(y.s();!(f=y.n()).done;)f.value.cancel(g)}catch(x){y.e(x)}finally{y.f()}}}])}();n.PDFNetworkStream=w;var m=function(){return _createClass(function d(f,y){_classCallCheck(this,d),this._manager=f;var x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._fullRequestId=f.requestFull(x),this._headersReceivedCapability=(0,r.createPromiseCapability)(),this._disableRange=y.disableRange||!1,this._contentLength=y.length,this._rangeChunkSize=y.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null},[{key:"_onHeadersReceived",value:function(){var d=this._fullRequestId,f=this._manager.getRequestXhr(d),y=function(S){return f.getResponseHeader(S)},x=(0,u.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),k=x.allowRangeRequests,P=x.suggestedLength;k&&(this._isRangeSupported=!0),this._contentLength=P||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(y),this._isRangeSupported&&this._manager.abortRequest(d),this._headersReceivedCapability.resolve()}},{key:"_onDone",value:function(d){if(d&&(this._requests.length>0?this._requests.shift().resolve({value:d.chunk,done:!1}):this._cachedChunks.push(d.chunk)),this._done=!0,!(this._cachedChunks.length>0)){var f,y=_createForOfIteratorHelper(this._requests);try{for(y.s();!(f=y.n()).done;)f.value.resolve({value:void 0,done:!0})}catch(x){y.e(x)}finally{y.f()}this._requests.length=0}}},{key:"_onError",value:function(d){this._storedError=(0,u.createResponseStatusError)(d,this._url),this._headersReceivedCapability.reject(this._storedError);var f,y=_createForOfIteratorHelper(this._requests);try{for(y.s();!(f=y.n()).done;)f.value.reject(this._storedError)}catch(x){y.e(x)}finally{y.f()}this._requests.length=0,this._cachedChunks.length=0}},{key:"_onProgress",value:function(d){var f;(f=this.onProgress)===null||f===void 0||f.call(this,{loaded:d.loaded,total:d.lengthComputable?d.total:this._contentLength})}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"contentLength",get:function(){return this._contentLength}},{key:"headersReady",get:function(){return this._headersReceivedCapability.promise}},{key:"read",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!this._storedError){x.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){x.next=5;break}return f=this._cachedChunks.shift(),x.abrupt("return",{value:f,done:!1});case 5:if(!this._done){x.next=7;break}return x.abrupt("return",{value:void 0,done:!0});case 7:return y=(0,r.createPromiseCapability)(),this._requests.push(y),x.abrupt("return",y.promise);case 10:case"end":return x.stop()}},d,this)})),function(){return g.apply(this,arguments)})},{key:"cancel",value:function(d){this._done=!0,this._headersReceivedCapability.reject(d);var f,y=_createForOfIteratorHelper(this._requests);try{for(y.s();!(f=y.n()).done;)f.value.resolve({value:void 0,done:!0})}catch(x){y.e(x)}finally{y.f()}this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}]);var g}(),v=function(){return _createClass(function d(f,y,x){_classCallCheck(this,d),this._manager=f;var k={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=f.url,this._requestId=f.requestRange(y,x,k),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null},[{key:"_close",value:function(){var d;(d=this.onClosed)===null||d===void 0||d.call(this,this)}},{key:"_onDone",value:function(d){var f=d.chunk;this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunk=f,this._done=!0;var y,x=_createForOfIteratorHelper(this._requests);try{for(x.s();!(y=x.n()).done;)y.value.resolve({value:void 0,done:!0})}catch(k){x.e(k)}finally{x.f()}this._requests.length=0,this._close()}},{key:"_onError",value:function(d){this._storedError=(0,u.createResponseStatusError)(d,this._url);var f,y=_createForOfIteratorHelper(this._requests);try{for(y.s();!(f=y.n()).done;)f.value.reject(this._storedError)}catch(x){y.e(x)}finally{y.f()}this._requests.length=0,this._queuedChunk=null}},{key:"_onProgress",value:function(d){var f;this.isStreamingSupported||(f=this.onProgress)===null||f===void 0||f.call(this,{loaded:d.loaded})}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!this._storedError){x.next=2;break}throw this._storedError;case 2:if(this._queuedChunk===null){x.next=6;break}return f=this._queuedChunk,this._queuedChunk=null,x.abrupt("return",{value:f,done:!1});case 6:if(!this._done){x.next=8;break}return x.abrupt("return",{value:void 0,done:!0});case 8:return y=(0,r.createPromiseCapability)(),this._requests.push(y),x.abrupt("return",y.promise);case 11:case"end":return x.stop()}},d,this)})),function(){return g.apply(this,arguments)})},{key:"cancel",value:function(d){this._done=!0;var f,y=_createForOfIteratorHelper(this._requests);try{for(y.s();!(f=y.n()).done;)f.value.resolve({value:void 0,done:!0})}catch(x){y.e(x)}finally{y.f()}this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}]);var g}()},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var r=o(1),u=o(157);function s(f,y,x){return{method:"GET",headers:f,signal:x.signal,mode:"cors",credentials:y?"include":"same-origin",redirect:"follow"}}function w(f){var y=new Headers;for(var x in f){var k=f[x];k!==void 0&&y.append(x,k)}return y}function m(f){return f instanceof Uint8Array?f.buffer:f instanceof ArrayBuffer?f:((0,r.warn)("getArrayBuffer - unexpected data format: ".concat(f)),new Uint8Array(f).buffer)}var v=function(){return _createClass(function f(y){_classCallCheck(this,f),this.source=y,this.isHttp=/^https?:/i.test(y.url),this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]},[{key:"_progressiveDataLength",get:function(){var f,y;return(f=(y=this._fullRequestReader)===null||y===void 0?void 0:y._loaded)!==null&&f!==void 0?f:0}},{key:"getFullReader",value:function(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new g(this),this._fullRequestReader}},{key:"getRangeReader",value:function(f,y){if(y<=this._progressiveDataLength)return null;var x=new d(this,f,y);return this._rangeRequestReaders.push(x),x}},{key:"cancelAllRequests",value:function(f){var y;(y=this._fullRequestReader)===null||y===void 0||y.cancel(f);var x,k=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(k.s();!(x=k.n()).done;)x.value.cancel(f)}catch(P){k.e(P)}finally{k.f()}}}])}();n.PDFFetchStream=v;var g=function(){return _createClass(function y(x){var k=this;_classCallCheck(this,y),this._stream=x,this._reader=null,this._loaded=0,this._filename=null;var P=x.source;this._withCredentials=P.withCredentials||!1,this._contentLength=P.length,this._headersCapability=(0,r.createPromiseCapability)(),this._disableRange=P.disableRange||!1,this._rangeChunkSize=P.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!P.disableStream,this._isRangeSupported=!P.disableRange,this._headers=w(this._stream.httpHeaders);var S=P.url;fetch(S,s(this._headers,this._withCredentials,this._abortController)).then(function(E){if(!(0,u.validateResponseStatus)(E.status))throw(0,u.createResponseStatusError)(E.status,S);k._reader=E.body.getReader(),k._headersCapability.resolve();var M=function(I){return E.headers.get(I)},T=(0,u.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:k._stream.isHttp,rangeChunkSize:k._rangeChunkSize,disableRange:k._disableRange}),D=T.allowRangeRequests,N=T.suggestedLength;k._isRangeSupported=D,k._contentLength=N||k._contentLength,k._filename=(0,u.extractFilenameFromHeader)(M),!k._isStreamingSupported&&k._isRangeSupported&&k.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null},[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(f=_asyncToGenerator(_regeneratorRuntime().mark(function y(){var x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._headersCapability.promise;case 2:return E.next=4,this._reader.read();case 4:if(k=E.sent,P=k.value,!(S=k.done)){E.next=9;break}return E.abrupt("return",{value:P,done:S});case 9:return this._loaded+=P.byteLength,(x=this.onProgress)===null||x===void 0||x.call(this,{loaded:this._loaded,total:this._contentLength}),E.abrupt("return",{value:m(P),done:!1});case 12:case"end":return E.stop()}},y,this)})),function(){return f.apply(this,arguments)})},{key:"cancel",value:function(y){var x;(x=this._reader)===null||x===void 0||x.cancel(y),this._abortController.abort()}}]);var f}(),d=function(){return _createClass(function y(x,k,P){var S=this;_classCallCheck(this,y),this._stream=x,this._reader=null,this._loaded=0;var E=x.source;this._withCredentials=E.withCredentials||!1,this._readCapability=(0,r.createPromiseCapability)(),this._isStreamingSupported=!E.disableStream,this._abortController=new AbortController,this._headers=w(this._stream.httpHeaders),this._headers.append("Range","bytes=".concat(k,"-").concat(P-1));var M=E.url;fetch(M,s(this._headers,this._withCredentials,this._abortController)).then(function(T){if(!(0,u.validateResponseStatus)(T.status))throw(0,u.createResponseStatusError)(T.status,M);S._readCapability.resolve(),S._reader=T.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null},[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(f=_asyncToGenerator(_regeneratorRuntime().mark(function y(){var x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._readCapability.promise;case 2:return E.next=4,this._reader.read();case 4:if(k=E.sent,P=k.value,!(S=k.done)){E.next=9;break}return E.abrupt("return",{value:P,done:S});case 9:return this._loaded+=P.byteLength,(x=this.onProgress)===null||x===void 0||x.call(this,{loaded:this._loaded}),E.abrupt("return",{value:m(P),done:!1});case 12:case"end":return E.stop()}},y,this)})),function(){return f.apply(this,arguments)})},{key:"cancel",value:function(y){var x;(x=this._reader)===null||x===void 0||x.cancel(y),this._abortController.abort()}}]);var f}()},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=function(y){y.textContentSource||!y.textContent&&!y.textContentStream||((0,u.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),y.textContentSource=y.textContent||y.textContentStream);var x=y.container,k=y.viewport,P=getComputedStyle(x),S=P.getPropertyValue("visibility"),E=parseFloat(P.getPropertyValue("--scale-factor"));S==="visible"&&(!E||Math.abs(E-k.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");var M=new f(y);return M._render(),M},n.updateTextLayer=function(y){var x=y.container,k=y.viewport,P=y.textDivs,S=y.textDivProperties,E=y.isOffscreenCanvasSupported,M=y.mustRotate,T=M===void 0||M,D=y.mustRescale,N=D===void 0||D;if(T&&(0,u.setLayerDimensions)(x,{rotation:k.rotation}),N){var I,O=v(0,E),F={prevFontSize:null,prevFontFamily:null,div:null,scale:k.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:O},q=_createForOfIteratorHelper(P);try{for(q.s();!(I=q.n()).done;){var Y=I.value;F.properties=S.get(Y),F.div=Y,d(F)}}catch(_e){q.e(_e)}finally{q.f()}}};var r=o(1),u=o(142),s=30,w=.8,m=new Map;function v(y,x){var k;if(x&&r.FeatureTest.isOffscreenCanvasSupported)k=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{var P=document.createElement("canvas");P.width=P.height=y,k=P.getContext("2d",{alpha:!1})}return k}function g(y,x,k){var P=document.createElement("span"),S={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};y._textDivs.push(P);var E=r.Util.transform(y._transform,x.transform),M=Math.atan2(E[1],E[0]),T=k[x.fontName];T.vertical&&(M+=Math.PI/2);var D,N,I=Math.hypot(E[2],E[3]),O=I*function(ve,J){var fe=m.get(ve);if(fe)return fe;var Z=v(s,J);Z.font="".concat(s,"px ").concat(ve);var j=Z.measureText(""),X=j.fontBoundingBoxAscent,H=Math.abs(j.fontBoundingBoxDescent);if(X){var U=X/(X+H);return m.set(ve,U),Z.canvas.width=Z.canvas.height=0,U}Z.strokeStyle="red",Z.clearRect(0,0,s,s),Z.strokeText("g",0,0);var te=Z.getImageData(0,0,s,s).data;H=0;for(var Q=te.length-1-3;Q>=0;Q-=4)if(te[Q]>0){H=Math.ceil(Q/4/s);break}Z.clearRect(0,0,s,s),Z.strokeText("A",0,s),X=0;for(var re=0,Pe=(te=Z.getImageData(0,0,s,s).data).length;re<Pe;re+=4)if(te[re]>0){X=s-Math.floor(re/4/s);break}if(Z.canvas.width=Z.canvas.height=0,X){var be=X/(X+H);return m.set(ve,be),be}return m.set(ve,w),w}(T.fontFamily,y._isOffscreenCanvasSupported);M===0?(D=E[4],N=E[5]-O):(D=E[4]+O*Math.sin(M),N=E[5]-O*Math.cos(M));var F="calc(var(--scale-factor)*",q=P.style;y._container===y._rootContainer?(q.left="".concat((100*D/y._pageWidth).toFixed(2),"%"),q.top="".concat((100*N/y._pageHeight).toFixed(2),"%")):(q.left="".concat(F).concat(D.toFixed(2),"px)"),q.top="".concat(F).concat(N.toFixed(2),"px)")),q.fontSize="".concat(F).concat(I.toFixed(2),"px)"),q.fontFamily=T.fontFamily,S.fontSize=I,P.setAttribute("role","presentation"),P.textContent=x.str,P.dir=x.dir,y._fontInspectorEnabled&&(P.dataset.fontName=x.fontName),M!==0&&(S.angle=M*(180/Math.PI));var Y=!1;if(x.str.length>1)Y=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){var _e=Math.abs(x.transform[0]),ne=Math.abs(x.transform[3]);_e!==ne&&Math.max(_e,ne)/Math.min(_e,ne)>1.5&&(Y=!0)}Y&&(S.canvasWidth=T.vertical?x.height:x.width),y._textDivProperties.set(P,S),y._isReadableStream&&y._layoutText(P)}function d(y){var x=y.div,k=y.scale,P=y.properties,S=y.ctx,E=y.prevFontSize,M=y.prevFontFamily,T=x.style,D="";if(P.canvasWidth!==0&&P.hasText){var N=T.fontFamily,I=P.canvasWidth,O=P.fontSize;E===O&&M===N||(S.font="".concat(O*k,"px ").concat(N),y.prevFontSize=O,y.prevFontFamily=N);var F=S.measureText(x.textContent).width;F>0&&(D="scaleX(".concat(I*k/F,")"))}P.angle!==0&&(D="rotate(".concat(P.angle,"deg) ").concat(D)),D.length>0&&(T.transform=D)}var f=function(){return _createClass(function y(x){var k,P=this;_classCallCheck(this,y);var S=x.textContentSource,E=x.container,M=x.viewport,T=x.textDivs,D=x.textDivProperties,N=x.textContentItemsStr,I=x.isOffscreenCanvasSupported;this._textContentSource=S,this._isReadableStream=S instanceof ReadableStream,this._container=this._rootContainer=E,this._textDivs=T||[],this._textContentItemsStr=N||[],this._isOffscreenCanvasSupported=I,this._fontInspectorEnabled=!((k=globalThis.FontInspector)===null||k===void 0||!k.enabled),this._reader=null,this._textDivProperties=D||new WeakMap,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:v(0,I)};var O=M.rawDims,F=O.pageWidth,q=O.pageHeight,Y=O.pageX,_e=O.pageY;this._transform=[1,0,0,-1,-Y,_e+q],this._pageWidth=F,this._pageHeight=q,(0,u.setLayerDimensions)(E,M),this._capability.promise.finally(function(){P._layoutTextParams=null}).catch(function(){})},[{key:"promise",get:function(){return this._capability.promise}},{key:"cancel",value:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(function(){}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}},{key:"_processItems",value:function(y,x){var k,P=_createForOfIteratorHelper(y);try{for(P.s();!(k=P.n()).done;){var S=k.value;if(S.str!==void 0)this._textContentItemsStr.push(S.str),g(this,S,x);else if(S.type==="beginMarkedContentProps"||S.type==="beginMarkedContent"){var E=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),S.id!==null&&this._container.setAttribute("id","".concat(S.id)),E.append(this._container)}else S.type==="endMarkedContent"&&(this._container=this._container.parentNode)}}catch(M){P.e(M)}finally{P.f()}}},{key:"_layoutText",value:function(y){var x=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,d(this._layoutTextParams),x.hasText&&this._container.append(y),x.hasEOL){var k=document.createElement("br");k.setAttribute("role","presentation"),this._container.append(k)}}},{key:"_render",value:function(){var y=this,x=(0,r.createPromiseCapability)(),k=Object.create(null);if(this._isReadableStream)this._reader=this._textContentSource.getReader(),function M(){y._reader.read().then(function(T){var D=T.value;T.done?x.resolve():(Object.assign(k,D.styles),y._processItems(D.items,k),M())},x.reject)}();else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');var P=this._textContentSource,S=P.items,E=P.styles;this._processItems(S,E),x.resolve()}x.promise.then(function(){k=null,function(M){if(!M._canceled){var T=M._textDivs,D=M._capability;if(T.length>1e5)D.resolve();else{if(!M._isReadableStream){var N,I=_createForOfIteratorHelper(T);try{for(I.s();!(N=I.n()).done;){var O=N.value;M._layoutText(O)}}catch(F){I.e(F)}finally{I.f()}}D.resolve()}}}(y)},this._capability.reject)}}])}();n.TextLayerRenderTask=f},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var r=o(1),u=o(141),s=o(163),w=o(164),m=o(142);function v(Z,j){d(Z,j),j.add(Z)}function g(Z,j,X){d(Z,j),j.set(Z,X)}function d(Z,j){if(j.has(Z))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(Z,j,X){if(!j.has(Z))throw new TypeError("attempted to get private field on non-instance");return X}function y(Z,j){return function(X,H){return H.get?H.get.call(X):H.value}(Z,k(Z,j,"get"))}function x(Z,j,X){return function(H,U,te){if(U.set)U.set.call(H,te);else{if(!U.writable)throw new TypeError("attempted to set read only private field");U.value=te}}(Z,k(Z,j,"set"),X),X}function k(Z,j,X){if(!j.has(Z))throw new TypeError("attempted to "+X+" private field on non-instance");return j.get(Z)}var P=new WeakMap,S=new WeakMap,E=new WeakMap,M=new WeakMap,T=new WeakMap,D=new WeakMap,N=new WeakMap,I=new WeakMap,O=new WeakSet,F=new WeakSet,q=new WeakSet,Y=new WeakSet,_e=function(){return _createClass(function Z(j){_classCallCheck(this,Z),v(this,Y),v(this,q),v(this,F),v(this,O),g(this,P,{writable:!0,value:void 0}),g(this,S,{writable:!0,value:!1}),g(this,E,{writable:!0,value:this.pointerup.bind(this)}),g(this,M,{writable:!0,value:this.pointerdown.bind(this)}),g(this,T,{writable:!0,value:new Map}),g(this,D,{writable:!0,value:!1}),g(this,N,{writable:!0,value:!1}),g(this,I,{writable:!0,value:void 0}),Z._initialized||(Z._initialized=!0,s.FreeTextEditor.initialize(j.l10n),w.InkEditor.initialize(j.l10n)),j.uiManager.registerEditorTypes([s.FreeTextEditor,w.InkEditor]),x(this,I,j.uiManager),this.pageIndex=j.pageIndex,this.div=j.div,x(this,P,j.accessibilityManager),y(this,I).addLayer(this)},[{key:"isEmpty",get:function(){return y(this,T).size===0}},{key:"updateToolbar",value:function(Z){y(this,I).updateToolbar(Z)}},{key:"updateMode",value:function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y(this,I).getMode();f(this,Y,fe).call(this),Z===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),y(this,I).unselectAll(),Z!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",Z===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",Z===r.AnnotationEditorType.INK),this.div.hidden=!1)}},{key:"addInkEditorIfNeeded",value:function(Z){if(Z||y(this,I).getMode()===r.AnnotationEditorType.INK){if(!Z){var j,X=_createForOfIteratorHelper(y(this,T).values());try{for(X.s();!(j=X.n()).done;){var H=j.value;if(H.isEmpty())return void H.setInBackground()}}catch(U){X.e(U)}finally{X.f()}}f(this,q,J).call(this,{offsetX:0,offsetY:0}).setInBackground()}}},{key:"setEditingState",value:function(Z){y(this,I).setEditingState(Z)}},{key:"addCommands",value:function(Z){y(this,I).addCommands(Z)}},{key:"enable",value:function(){this.div.style.pointerEvents="auto";var Z,j=_createForOfIteratorHelper(y(this,T).values());try{for(j.s();!(Z=j.n()).done;)Z.value.enableEditing()}catch(X){j.e(X)}finally{j.f()}}},{key:"disable",value:function(){this.div.style.pointerEvents="none";var Z,j=_createForOfIteratorHelper(y(this,T).values());try{for(j.s();!(Z=j.n()).done;)Z.value.disableEditing()}catch(X){j.e(X)}finally{j.f()}f(this,Y,fe).call(this),this.isEmpty&&(this.div.hidden=!0)}},{key:"setActiveEditor",value:function(Z){y(this,I).getActive()!==Z&&y(this,I).setActiveEditor(Z)}},{key:"enableClick",value:function(){this.div.addEventListener("pointerdown",y(this,M)),this.div.addEventListener("pointerup",y(this,E))}},{key:"disableClick",value:function(){this.div.removeEventListener("pointerdown",y(this,M)),this.div.removeEventListener("pointerup",y(this,E))}},{key:"attach",value:function(Z){y(this,T).set(Z.id,Z)}},{key:"detach",value:function(Z){var j;y(this,T).delete(Z.id),(j=y(this,P))===null||j===void 0||j.removePointerInTextLayer(Z.contentDiv)}},{key:"remove",value:function(Z){var j=this;y(this,I).removeEditor(Z),this.detach(Z),Z.div.style.display="none",setTimeout(function(){Z.div.style.display="",Z.div.remove(),Z.isAttachedToDOM=!1,document.activeElement===document.body&&y(j,I).focusMainContainer()},0),y(this,N)||this.addInkEditorIfNeeded(!1)}},{key:"add",value:function(Z){if(f(this,O,ne).call(this,Z),y(this,I).addEditor(Z),this.attach(Z),!Z.isAttachedToDOM){var j=Z.render();this.div.append(j),Z.isAttachedToDOM=!0}this.moveEditorInDOM(Z),Z.onceAdded(),y(this,I).addToAnnotationStorage(Z)}},{key:"moveEditorInDOM",value:function(Z){var j;(j=y(this,P))===null||j===void 0||j.moveElementInDOM(this.div,Z.div,Z.contentDiv,!0)}},{key:"addOrRebuild",value:function(Z){Z.needsToBeRebuilt()?Z.rebuild():this.add(Z)}},{key:"addANewEditor",value:function(Z){var j=this;this.addCommands({cmd:function(){j.addOrRebuild(Z)},undo:function(){Z.remove()},mustExec:!0})}},{key:"addUndoableEditor",value:function(Z){var j=this;this.addCommands({cmd:function(){j.addOrRebuild(Z)},undo:function(){Z.remove()},mustExec:!1})}},{key:"getNextId",value:function(){return y(this,I).getId()}},{key:"deserialize",value:function(Z){switch(Z.annotationType){case r.AnnotationEditorType.FREETEXT:return s.FreeTextEditor.deserialize(Z,this,y(this,I));case r.AnnotationEditorType.INK:return w.InkEditor.deserialize(Z,this,y(this,I))}return null}},{key:"setSelected",value:function(Z){y(this,I).setSelected(Z)}},{key:"toggleSelected",value:function(Z){y(this,I).toggleSelected(Z)}},{key:"isSelected",value:function(Z){return y(this,I).isSelected(Z)}},{key:"unselect",value:function(Z){y(this,I).unselect(Z)}},{key:"pointerup",value:function(Z){var j=r.FeatureTest.platform.isMac;Z.button!==0||Z.ctrlKey&&j||Z.target===this.div&&y(this,D)&&(x(this,D,!1),y(this,S)?f(this,q,J).call(this,Z):x(this,S,!0))}},{key:"pointerdown",value:function(Z){var j=r.FeatureTest.platform.isMac;if(!(Z.button!==0||Z.ctrlKey&&j)&&Z.target===this.div){x(this,D,!0);var X=y(this,I).getActive();x(this,S,!X||X.isEmpty())}}},{key:"drop",value:function(Z){var j=Z.dataTransfer.getData("text/plain"),X=y(this,I).getEditor(j);if(X){Z.preventDefault(),Z.dataTransfer.dropEffect="move",f(this,O,ne).call(this,X);var H=this.div.getBoundingClientRect(),U=Z.clientX-H.x,te=Z.clientY-H.y;X.translate(U-X.startX,te-X.startY),this.moveEditorInDOM(X),X.div.focus()}}},{key:"dragover",value:function(Z){Z.preventDefault()}},{key:"destroy",value:function(){var Z;((Z=y(this,I).getActive())===null||Z===void 0?void 0:Z.parent)===this&&y(this,I).setActiveEditor(null);var j,X=_createForOfIteratorHelper(y(this,T).values());try{for(X.s();!(j=X.n()).done;){var H,U=j.value;(H=y(this,P))===null||H===void 0||H.removePointerInTextLayer(U.contentDiv),U.setParent(null),U.isAttachedToDOM=!1,U.div.remove()}}catch(te){X.e(te)}finally{X.f()}this.div=null,y(this,T).clear(),y(this,I).removeLayer(this)}},{key:"render",value:function(Z){var j=Z.viewport;this.viewport=j,(0,m.setLayerDimensions)(this.div,j),(0,u.bindEvents)(this,this.div,["dragover","drop"]);var X,H=_createForOfIteratorHelper(y(this,I).getEditors(this.pageIndex));try{for(H.s();!(X=H.n()).done;){var U=X.value;this.add(U)}}catch(te){H.e(te)}finally{H.f()}this.updateMode()}},{key:"update",value:function(Z){var j=Z.viewport;y(this,I).commitOrRemove(),this.viewport=j,(0,m.setLayerDimensions)(this.div,{rotation:j.rotation}),this.updateMode()}},{key:"pageDimensions",get:function(){var Z=this.viewport.rawDims;return[Z.pageWidth,Z.pageHeight]}}])}();function ne(Z){var j;Z.parent!==this&&(this.attach(Z),(j=Z.parent)===null||j===void 0||j.detach(Z),Z.setParent(this),Z.div&&Z.isAttachedToDOM&&(Z.div.remove(),this.div.append(Z.div)))}function ve(Z){switch(y(this,I).getMode()){case r.AnnotationEditorType.FREETEXT:return new s.FreeTextEditor(Z);case r.AnnotationEditorType.INK:return new w.InkEditor(Z)}return null}function J(Z){var j=this.getNextId(),X=f(this,F,ve).call(this,{parent:this,id:j,x:Z.offsetX,y:Z.offsetY,uiManager:y(this,I)});return X&&this.add(X),X}function fe(){x(this,N,!0);var Z,j=_createForOfIteratorHelper(y(this,T).values());try{for(j.s();!(Z=j.n()).done;){var X=Z.value;X.isEmpty()&&X.remove()}}catch(H){j.e(H)}finally{j.f()}x(this,N,!1)}n.AnnotationEditorLayer=_e,function(Z,j,X){(j=function(H){var U=function(te,Q){if(_typeof$1(te)!=="object"||te===null)return te;var re=te[Symbol.toPrimitive];if(re!==void 0){var Pe=re.call(te,Q||"default");if(_typeof$1(Pe)!=="object")return Pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Q==="string"?String:Number)(te)}(H,"string");return _typeof$1(U)==="symbol"?U:String(U)}(j))in Z?Object.defineProperty(Z,j,{value:X,enumerable:!0,configurable:!0,writable:!0}):Z[j]=X}(_e,"_initialized",!1)},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var r=o(1),u=o(141),s=o(140);function w(Z,j){g(Z,j),j.add(Z)}function m(Z,j,X){return(j=function(H){var U=function(te,Q){if(_typeof$1(te)!=="object"||te===null)return te;var re=te[Symbol.toPrimitive];if(re!==void 0){var Pe=re.call(te,Q||"default");if(_typeof$1(Pe)!=="object")return Pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Q==="string"?String:Number)(te)}(H,"string");return _typeof$1(U)==="symbol"?U:String(U)}(j))in Z?Object.defineProperty(Z,j,{value:X,enumerable:!0,configurable:!0,writable:!0}):Z[j]=X,Z}function v(Z,j,X){g(Z,j),j.set(Z,X)}function g(Z,j){if(j.has(Z))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(Z,j){return function(X,H){return H.get?H.get.call(X):H.value}(Z,x(Z,j,"get"))}function f(Z,j,X){if(!j.has(Z))throw new TypeError("attempted to get private field on non-instance");return X}function y(Z,j,X){return function(H,U,te){if(U.set)U.set.call(H,te);else{if(!U.writable)throw new TypeError("attempted to set read only private field");U.value=te}}(Z,x(Z,j,"set"),X),X}function x(Z,j,X){if(!j.has(Z))throw new TypeError("attempted to "+X+" private field on non-instance");return j.get(Z)}var k=new WeakMap,P=new WeakMap,S=new WeakMap,E=new WeakMap,M=new WeakMap,T=new WeakMap,D=new WeakMap,N=new WeakMap,I=new WeakMap,O=new WeakSet,F=new WeakSet,q=new WeakSet,Y=new WeakSet,_e=function(Z){function j(X){var H;return _classCallCheck(this,j),w(H=_callSuper(this,j,[_objectSpread2$1(_objectSpread2$1({},X),{},{name:"freeTextEditor"})]),Y),w(H,q),w(H,F),w(H,O),v(H,k,{writable:!0,value:H.editorDivBlur.bind(H)}),v(H,P,{writable:!0,value:H.editorDivFocus.bind(H)}),v(H,S,{writable:!0,value:H.editorDivInput.bind(H)}),v(H,E,{writable:!0,value:H.editorDivKeydown.bind(H)}),v(H,M,{writable:!0,value:void 0}),v(H,T,{writable:!0,value:""}),v(H,D,{writable:!0,value:"".concat(H.id,"-editor")}),v(H,N,{writable:!0,value:!1}),v(H,I,{writable:!0,value:void 0}),y(H,M,X.color||j._defaultColor||s.AnnotationEditor._defaultLineColor),y(H,I,X.fontSize||j._defaultFontSize),H}return _inherits(j,Z),_createClass(j,[{key:"updateParams",value:function(X,H){switch(X){case r.AnnotationEditorParamsType.FREETEXT_SIZE:f(this,O,ne).call(this,H);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:f(this,F,ve).call(this,H)}}},{key:"propertiesToUpdate",get:function(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,d(this,I)],[r.AnnotationEditorParamsType.FREETEXT_COLOR,d(this,M)]]}},{key:"getInitialTranslation",value:function(){var X=this.parentScale;return[-j._internalPadding*X,-(j._internalPadding+d(this,I))*X]}},{key:"rebuild",value:function(){_get(_getPrototypeOf(j.prototype),"rebuild",this).call(this),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}},{key:"enableEditMode",value:function(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),_get(_getPrototypeOf(j.prototype),"enableEditMode",this).call(this),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",d(this,E)),this.editorDiv.addEventListener("focus",d(this,P)),this.editorDiv.addEventListener("blur",d(this,k)),this.editorDiv.addEventListener("input",d(this,S)))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&(this.parent.setEditingState(!0),_get(_getPrototypeOf(j.prototype),"disableEditMode",this).call(this),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,D)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",d(this,E)),this.editorDiv.removeEventListener("focus",d(this,P)),this.editorDiv.removeEventListener("blur",d(this,k)),this.editorDiv.removeEventListener("input",d(this,S)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}},{key:"focusin",value:function(X){_get(_getPrototypeOf(j.prototype),"focusin",this).call(this,X),X.target!==this.editorDiv&&this.editorDiv.focus()}},{key:"onceAdded",value:function(){this.width||(this.enableEditMode(),this.editorDiv.focus())}},{key:"isEmpty",value:function(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}},{key:"remove",value:function(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),_get(_getPrototypeOf(j.prototype),"remove",this).call(this)}},{key:"commit",value:function(){this.isInEditMode()&&(_get(_getPrototypeOf(j.prototype),"commit",this).call(this),d(this,N)||(y(this,N,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),y(this,T,f(this,q,J).call(this).trimEnd()),f(this,Y,fe).call(this))}},{key:"shouldGetKeyboardEvents",value:function(){return this.isInEditMode()}},{key:"dblclick",value:function(X){this.enableEditMode(),this.editorDiv.focus()}},{key:"keydown",value:function(X){X.target===this.div&&X.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}},{key:"editorDivKeydown",value:function(X){j._keyboardManager.exec(this,X)}},{key:"editorDivFocus",value:function(X){this.isEditing=!0}},{key:"editorDivBlur",value:function(X){this.isEditing=!1}},{key:"editorDivInput",value:function(X){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}},{key:"disableEditing",value:function(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}},{key:"enableEditing",value:function(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}},{key:"render",value:function(){var X,H,U=this;if(this.div)return this.div;this.width&&(X=this.x,H=this.y),_get(_getPrototypeOf(j.prototype),"render",this).call(this),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,D)),this.enableEditing(),j._l10nPromise.get("editor_free_text2_aria_label").then(function(Me){var Ie;return(Ie=U.editorDiv)===null||Ie===void 0?void 0:Ie.setAttribute("aria-label",Me)}),j._l10nPromise.get("free_text2_default_content").then(function(Me){var Ie;return(Ie=U.editorDiv)===null||Ie===void 0?void 0:Ie.setAttribute("default-content",Me)}),this.editorDiv.contentEditable=!0;var te=this.editorDiv.style;if(te.fontSize="calc(".concat(d(this,I),"px * var(--scale-factor))"),te.color=d(this,M),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,u.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){var Q=_slicedToArray(this.parentDimensions,2),re=Q[0],Pe=Q[1];this.setAt(X*re,H*Pe,this.width*re,this.height*Pe);var be,we=_createForOfIteratorHelper(d(this,T).split(`
`));try{for(we.s();!(be=we.n()).done;){var Ae=be.value,$e=document.createElement("div");$e.append(Ae?document.createTextNode(Ae):document.createElement("br")),this.editorDiv.append($e)}}catch(Me){we.e(Me)}finally{we.f()}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}},{key:"contentDiv",get:function(){return this.editorDiv}},{key:"serialize",value:function(){if(this.isEmpty())return null;var X=j._internalPadding*this.parentScale,H=this.getRect(X,X),U=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:d(this,M));return{annotationType:r.AnnotationEditorType.FREETEXT,color:U,fontSize:d(this,I),value:d(this,T),pageIndex:this.pageIndex,rect:H,rotation:this.rotation}}}],[{key:"initialize",value:function(X){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(function(U){return[U,X.get(U)]}));var H=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(H.getPropertyValue("--freetext-padding"))}},{key:"updateDefaultParams",value:function(X,H){switch(X){case r.AnnotationEditorParamsType.FREETEXT_SIZE:j._defaultFontSize=H;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:j._defaultColor=H}}},{key:"defaultPropertiesToUpdate",get:function(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,j._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,j._defaultColor||s.AnnotationEditor._defaultLineColor]]}},{key:"deserialize",value:function(X,H,U){var te,Q=_get(_getPrototypeOf(j),"deserialize",this).call(this,X,H,U);return y(Q,I,X.fontSize),y(Q,M,(te=r.Util).makeHexColor.apply(te,_toConsumableArray$1(X.color))),y(Q,T,X.value),Q}}])}(s.AnnotationEditor);function ne(Z){var j=this,X=function(U){j.editorDiv.style.fontSize="calc(".concat(U,"px * var(--scale-factor))"),j.translate(0,-(U-d(j,I))*j.parentScale),y(j,I,U),f(j,Y,fe).call(j)},H=d(this,I);this.addCommands({cmd:function(){X(Z)},undo:function(){X(H)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function ve(Z){var j=this,X=d(this,M);this.addCommands({cmd:function(){y(j,M,j.editorDiv.style.color=Z)},undo:function(){y(j,M,j.editorDiv.style.color=X)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function J(){var Z=this.editorDiv.getElementsByTagName("div");if(Z.length===0)return this.editorDiv.innerText;var j,X=[],H=_createForOfIteratorHelper(Z);try{for(H.s();!(j=H.n()).done;){var U=j.value;X.push(U.innerText.replace(/\r\n?|\n/,""))}}catch(te){H.e(te)}finally{H.f()}return X.join(`
`)}function fe(){var Z,j=_slicedToArray(this.parentDimensions,2),X=j[0],H=j[1];if(this.isAttachedToDOM)Z=this.div.getBoundingClientRect();else{var U=this.currentLayer,te=this.div,Q=te.style.display;te.style.display="hidden",U.div.append(this.div),Z=te.getBoundingClientRect(),te.remove(),te.style.display=Q}this.width=Z.width/X,this.height=Z.height/H}n.FreeTextEditor=_e,m(_e,"_freeTextDefaultContent",""),m(_e,"_l10nPromise",void 0),m(_e,"_internalPadding",0),m(_e,"_defaultColor",null),m(_e,"_defaultFontSize",10),m(_e,"_keyboardManager",new u.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],_e.prototype.commitOrRemove]])),m(_e,"_type","freetext")},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return s.fitCurve}});var r=o(1),u=o(140),s=o(165),w=o(141);function m(Fe,ze){d(Fe,ze),ze.add(Fe)}function v(Fe,ze,We){return(ze=function(Ue){var et=function(it,nt){if(_typeof$1(it)!=="object"||it===null)return it;var dt=it[Symbol.toPrimitive];if(dt!==void 0){var xt=dt.call(it,nt||"default");if(_typeof$1(xt)!=="object")return xt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(nt==="string"?String:Number)(it)}(Ue,"string");return _typeof$1(et)==="symbol"?et:String(et)}(ze))in Fe?Object.defineProperty(Fe,ze,{value:We,enumerable:!0,configurable:!0,writable:!0}):Fe[ze]=We,Fe}function g(Fe,ze,We){d(Fe,ze),ze.set(Fe,We)}function d(Fe,ze){if(ze.has(Fe))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(Fe,ze,We){return function(Ue,et){if(Ue!==et)throw new TypeError("Private static access of wrong provenance")}(Fe,ze),We}function y(Fe,ze,We){return function(Ue,et,it){if(et.set)et.set.call(Ue,it);else{if(!et.writable)throw new TypeError("attempted to set read only private field");et.value=it}}(Fe,k(Fe,ze,"set"),We),We}function x(Fe,ze){return function(We,Ue){return Ue.get?Ue.get.call(We):Ue.value}(Fe,k(Fe,ze,"get"))}function k(Fe,ze,We){if(!ze.has(Fe))throw new TypeError("attempted to "+We+" private field on non-instance");return ze.get(Fe)}function P(Fe,ze,We){if(!ze.has(Fe))throw new TypeError("attempted to get private field on non-instance");return We}var S=16,E=new WeakMap,M=new WeakMap,T=new WeakMap,D=new WeakMap,N=new WeakMap,I=new WeakMap,O=new WeakMap,F=new WeakMap,q=new WeakMap,Y=new WeakMap,_e=new WeakMap,ne=new WeakMap,ve=new WeakMap,J=new WeakMap,fe=new WeakSet,Z=new WeakSet,j=new WeakSet,X=new WeakSet,H=new WeakSet,U=new WeakSet,te=new WeakSet,Q=new WeakSet,re=new WeakSet,Pe=new WeakSet,be=new WeakSet,we=new WeakSet,Ae=new WeakSet,$e=new WeakSet,Me=new WeakSet,Ie=new WeakSet,Le=new WeakSet,le=new WeakSet,oe=new WeakSet,ke=new WeakSet,Ce=new WeakSet,Ee=new WeakSet,Be=function(Fe){function ze(We){var Ue;return _classCallCheck(this,ze),m(Ue=_callSuper(this,ze,[_objectSpread2$1(_objectSpread2$1({},We),{},{name:"inkEditor"})]),Ee),m(Ue,Ce),m(Ue,ke),m(Ue,oe),m(Ue,le),m(Ue,Le),m(Ue,Ie),m(Ue,Me),m(Ue,$e),m(Ue,Ae),m(Ue,we),m(Ue,be),m(Ue,Pe),m(Ue,re),m(Ue,Q),m(Ue,te),m(Ue,U),m(Ue,H),m(Ue,X),m(Ue,j),m(Ue,Z),m(Ue,fe),g(Ue,E,{writable:!0,value:0}),g(Ue,M,{writable:!0,value:0}),g(Ue,T,{writable:!0,value:0}),g(Ue,D,{writable:!0,value:Ue.canvasPointermove.bind(Ue)}),g(Ue,N,{writable:!0,value:Ue.canvasPointerleave.bind(Ue)}),g(Ue,I,{writable:!0,value:Ue.canvasPointerup.bind(Ue)}),g(Ue,O,{writable:!0,value:Ue.canvasPointerdown.bind(Ue)}),g(Ue,F,{writable:!0,value:!1}),g(Ue,q,{writable:!0,value:!1}),g(Ue,Y,{writable:!0,value:null}),g(Ue,_e,{writable:!0,value:null}),g(Ue,ne,{writable:!0,value:0}),g(Ue,ve,{writable:!0,value:0}),g(Ue,J,{writable:!0,value:null}),Ue.color=We.color||null,Ue.thickness=We.thickness||null,Ue.opacity=We.opacity||null,Ue.paths=[],Ue.bezierPath2D=[],Ue.currentPath=[],Ue.scaleFactor=1,Ue.translationX=Ue.translationY=0,Ue.x=0,Ue.y=0,Ue}return _inherits(ze,Fe),_createClass(ze,[{key:"updateParams",value:function(We,Ue){switch(We){case r.AnnotationEditorParamsType.INK_THICKNESS:P(this,fe,Ve).call(this,Ue);break;case r.AnnotationEditorParamsType.INK_COLOR:P(this,Z,Oe).call(this,Ue);break;case r.AnnotationEditorParamsType.INK_OPACITY:P(this,j,je).call(this,Ue)}}},{key:"propertiesToUpdate",get:function(){var We;return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ze._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||ze._defaultColor||u.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((We=this.opacity)!==null&&We!==void 0?We:ze._defaultOpacity))]]}},{key:"rebuild",value:function(){_get(_getPrototypeOf(ze.prototype),"rebuild",this).call(this),this.div!==null&&(this.canvas||(P(this,be,vt).call(this),P(this,we,Ct).call(this)),this.isAttachedToDOM||(this.parent.add(this),P(this,Ae,kt).call(this)),P(this,Ce,Te).call(this))}},{key:"remove",value:function(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,x(this,_e).disconnect(),y(this,_e,null),_get(_getPrototypeOf(ze.prototype),"remove",this).call(this))}},{key:"setParent",value:function(We){!this.parent&&We?this._uiManager.removeShouldRescale(this):this.parent&&We===null&&this._uiManager.addShouldRescale(this),_get(_getPrototypeOf(ze.prototype),"setParent",this).call(this,We)}},{key:"onScaleChanging",value:function(){var We=_slicedToArray(this.parentDimensions,2),Ue=We[0],et=We[1],it=this.width*Ue,nt=this.height*et;this.setDimensions(it,nt)}},{key:"enableEditMode",value:function(){x(this,F)||this.canvas===null||(_get(_getPrototypeOf(ze.prototype),"enableEditMode",this).call(this),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",x(this,O)),this.canvas.addEventListener("pointerup",x(this,I)))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&this.canvas!==null&&(_get(_getPrototypeOf(ze.prototype),"disableEditMode",this).call(this),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",x(this,O)),this.canvas.removeEventListener("pointerup",x(this,I)))}},{key:"onceAdded",value:function(){this.div.draggable=!this.isEmpty()}},{key:"isEmpty",value:function(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}},{key:"commit",value:function(){x(this,F)||(_get(_getPrototypeOf(ze.prototype),"commit",this).call(this),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),y(this,F,!0),this.div.classList.add("disabled"),P(this,Ce,Te).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}},{key:"focusin",value:function(We){_get(_getPrototypeOf(ze.prototype),"focusin",this).call(this,We),this.enableEditMode()}},{key:"canvasPointerdown",value:function(We){We.button===0&&this.isInEditMode()&&!x(this,F)&&(this.setInForeground(),We.type!=="mouse"&&this.div.focus(),We.stopPropagation(),this.canvas.addEventListener("pointerleave",x(this,N)),this.canvas.addEventListener("pointermove",x(this,D)),P(this,U,qe).call(this,We.offsetX,We.offsetY))}},{key:"canvasPointermove",value:function(We){We.stopPropagation(),P(this,te,Ke).call(this,We.offsetX,We.offsetY)}},{key:"canvasPointerup",value:function(We){We.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(We.stopPropagation(),P(this,Pe,ht).call(this,We),this.setInBackground())}},{key:"canvasPointerleave",value:function(We){P(this,Pe,ht).call(this,We),this.setInBackground()}},{key:"render",value:function(){var We,Ue,et=this;if(this.div)return this.div;this.width&&(We=this.x,Ue=this.y),_get(_getPrototypeOf(ze.prototype),"render",this).call(this),ze._l10nPromise.get("editor_ink2_aria_label").then(function(ct){var wt;return(wt=et.div)===null||wt===void 0?void 0:wt.setAttribute("aria-label",ct)});var it=_slicedToArray(P(this,X,Ge).call(this),4),nt=it[0],dt=it[1],xt=it[2],yt=it[3];if(this.setAt(nt,dt,0,0),this.setDims(xt,yt),P(this,be,vt).call(this),this.width){var Bt=_slicedToArray(this.parentDimensions,2),Pt=Bt[0],Tt=Bt[1];this.setAt(We*Pt,Ue*Tt,this.width*Pt,this.height*Tt),y(this,q,!0),P(this,Ae,kt).call(this),this.setDims(this.width*Pt,this.height*Tt),P(this,re,rt).call(this),P(this,Ee,He).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return P(this,we,Ct).call(this),this.div}},{key:"setDimensions",value:function(We,Ue){var et=Math.round(We),it=Math.round(Ue);if(x(this,ne)!==et||x(this,ve)!==it){y(this,ne,et),y(this,ve,it),this.canvas.style.visibility="hidden",x(this,E)&&Math.abs(x(this,E)-We/Ue)>.01&&(Ue=Math.ceil(We/x(this,E)),this.setDims(We,Ue));var nt=_slicedToArray(this.parentDimensions,2),dt=nt[0],xt=nt[1];this.width=We/dt,this.height=Ue/xt,x(this,F)&&P(this,$e,mt).call(this,We,Ue),P(this,Ae,kt).call(this),P(this,re,rt).call(this),this.canvas.style.visibility="visible",this.fixDims()}}},{key:"serialize",value:function(){if(this.isEmpty())return null;var We=this.getRect(0,0),Ue=this.rotation%180==0?We[3]-We[1]:We[2]-We[0],et=u.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:et,thickness:this.thickness,opacity:this.opacity,paths:P(this,Ie,ot).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Ue),pageIndex:this.pageIndex,rect:We,rotation:this.rotation}}}],[{key:"initialize",value:function(We){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(function(Ue){return[Ue,We.get(Ue)]}))}},{key:"updateDefaultParams",value:function(We,Ue){switch(We){case r.AnnotationEditorParamsType.INK_THICKNESS:ze._defaultThickness=Ue;break;case r.AnnotationEditorParamsType.INK_COLOR:ze._defaultColor=Ue;break;case r.AnnotationEditorParamsType.INK_OPACITY:ze._defaultOpacity=Ue/100}}},{key:"defaultPropertiesToUpdate",get:function(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,ze._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,ze._defaultColor||u.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*ze._defaultOpacity)]]}},{key:"deserialize",value:function(We,Ue,et){var it,nt=_get(_getPrototypeOf(ze),"deserialize",this).call(this,We,Ue,et);nt.thickness=We.thickness,nt.color=(it=r.Util).makeHexColor.apply(it,_toConsumableArray$1(We.color)),nt.opacity=We.opacity;var dt=_slicedToArray(nt.pageDimensions,2),xt=dt[0],yt=dt[1],Bt=nt.width*xt,Pt=nt.height*yt,Tt=nt.parentScale,ct=We.thickness/2;y(nt,E,Bt/Pt),y(nt,F,!0),y(nt,ne,Math.round(Bt)),y(nt,ve,Math.round(Pt));var wt,St=_createForOfIteratorHelper(We.paths);try{for(St.s();!(wt=St.n()).done;){var Ft=wt.value.bezier,Gt=[];nt.paths.push(Gt);for(var jt=Tt*(Ft[0]-ct),Ut=Tt*(Pt-Ft[1]-ct),Jt=2,un=Ft.length;Jt<un;Jt+=6){var nn=Tt*(Ft[Jt]-ct),Zt=Tt*(Pt-Ft[Jt+1]-ct),en=Tt*(Ft[Jt+2]-ct),Cn=Tt*(Pt-Ft[Jt+3]-ct),$n=Tt*(Ft[Jt+4]-ct),Rn=Tt*(Pt-Ft[Jt+5]-ct);Gt.push([[jt,Ut],[nn,Zt],[en,Cn],[$n,Rn]]),jt=$n,Ut=Rn}var Nn=f(this,ze,bt).call(this,Gt);nt.bezierPath2D.push(Nn)}}catch(_i){St.e(_i)}finally{St.f()}var zn=P(nt,oe,ut).call(nt);return y(nt,T,Math.max(S,zn[2]-zn[0])),y(nt,M,Math.max(S,zn[3]-zn[1])),P(nt,$e,mt).call(nt,Bt,Pt),nt}}])}(u.AnnotationEditor);function Ve(Fe){var ze=this,We=this.thickness;this.addCommands({cmd:function(){ze.thickness=Fe,P(ze,Ce,Te).call(ze)},undo:function(){ze.thickness=We,P(ze,Ce,Te).call(ze)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function Oe(Fe){var ze=this,We=this.color;this.addCommands({cmd:function(){ze.color=Fe,P(ze,re,rt).call(ze)},undo:function(){ze.color=We,P(ze,re,rt).call(ze)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function je(Fe){var ze=this;Fe/=100;var We=this.opacity;this.addCommands({cmd:function(){ze.opacity=Fe,P(ze,re,rt).call(ze)},undo:function(){ze.opacity=We,P(ze,re,rt).call(ze)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function Ge(){var Fe=this.parentRotation,ze=_slicedToArray(this.parentDimensions,2),We=ze[0],Ue=ze[1];switch(Fe){case 90:return[0,Ue,Ue,We];case 180:return[We,Ue,We,Ue];case 270:return[We,0,Ue,We];default:return[0,0,We,Ue]}}function Xe(){var Fe=this.ctx,ze=this.color,We=this.opacity,Ue=this.thickness,et=this.parentScale,it=this.scaleFactor;Fe.lineWidth=Ue*et/it,Fe.lineCap="round",Fe.lineJoin="round",Fe.miterLimit=10,Fe.strokeStyle="".concat(ze).concat((0,w.opacityToHex)(We))}function qe(Fe,ze){var We,Ue=this;this.isEditing=!0,x(this,q)||(y(this,q,!0),P(this,Ae,kt).call(this),this.thickness||(this.thickness=Be._defaultThickness),this.color||(this.color=Be._defaultColor||u.AnnotationEditor._defaultLineColor),(We=this.opacity)!==null&&We!==void 0||(this.opacity=Be._defaultOpacity)),this.currentPath.push([Fe,ze]),y(this,Y,null),P(this,H,Xe).call(this),this.ctx.beginPath(),this.ctx.moveTo(Fe,ze),y(this,J,function(){var et;x(Ue,J)&&(x(Ue,Y)&&(Ue.isEmpty()?(Ue.ctx.setTransform(1,0,0,1,0,0),Ue.ctx.clearRect(0,0,Ue.canvas.width,Ue.canvas.height)):P(Ue,re,rt).call(Ue),(et=Ue.ctx).lineTo.apply(et,_toConsumableArray$1(x(Ue,Y))),y(Ue,Y,null),Ue.ctx.stroke()),window.requestAnimationFrame(x(Ue,J)))}),window.requestAnimationFrame(x(this,J))}function Ke(Fe,ze){var We=_slicedToArray(this.currentPath.at(-1),2),Ue=We[0],et=We[1];Fe===Ue&&ze===et||(this.currentPath.push([Fe,ze]),y(this,Y,[Fe,ze]))}function Je(Fe,ze){var We=this;this.ctx.closePath(),y(this,J,null),Fe=Math.min(Math.max(Fe,0),this.canvas.width),ze=Math.min(Math.max(ze,0),this.canvas.height);var Ue,et=_slicedToArray(this.currentPath.at(-1),2),it=et[0],nt=et[1];if(Fe===it&&ze===nt||this.currentPath.push([Fe,ze]),this.currentPath.length!==1)Ue=(0,s.fitCurve)(this.currentPath,30,null);else{var dt=[Fe,ze];Ue=[[dt,dt.slice(),dt.slice(),dt]]}var xt=f(Be,Be,bt).call(Be,Ue);this.currentPath.length=0,this.addCommands({cmd:function(){We.paths.push(Ue),We.bezierPath2D.push(xt),We.rebuild()},undo:function(){We.paths.pop(),We.bezierPath2D.pop(),We.paths.length===0?We.remove():(We.canvas||(P(We,be,vt).call(We),P(We,we,Ct).call(We)),P(We,Ce,Te).call(We))},mustExec:!0})}function rt(){if(this.isEmpty())P(this,Me,Vt).call(this);else{P(this,H,Xe).call(this);var Fe=this.canvas,ze=this.ctx;ze.setTransform(1,0,0,1,0,0),ze.clearRect(0,0,Fe.width,Fe.height),P(this,Me,Vt).call(this);var We,Ue=_createForOfIteratorHelper(this.bezierPath2D);try{for(Ue.s();!(We=Ue.n()).done;){var et=We.value;ze.stroke(et)}}catch(it){Ue.e(it)}finally{Ue.f()}}}function ht(Fe){P(this,Q,Je).call(this,Fe.offsetX,Fe.offsetY),this.canvas.removeEventListener("pointerleave",x(this,N)),this.canvas.removeEventListener("pointermove",x(this,D)),this.addToAnnotationStorage()}function vt(){var Fe=this;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Be._l10nPromise.get("editor_ink_canvas_aria_label").then(function(ze){var We;return(We=Fe.canvas)===null||We===void 0?void 0:We.setAttribute("aria-label",ze)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function Ct(){var Fe=this;y(this,_e,new ResizeObserver(function(ze){var We=ze[0].contentRect;We.width&&We.height&&Fe.setDimensions(We.width,We.height)})),x(this,_e).observe(this.div)}function kt(){if(x(this,q)){var Fe=_slicedToArray(this.parentDimensions,2),ze=Fe[0],We=Fe[1];this.canvas.width=Math.ceil(this.width*ze),this.canvas.height=Math.ceil(this.height*We),P(this,Me,Vt).call(this)}}function mt(Fe,ze){var We=P(this,ke,Re).call(this),Ue=(Fe-We)/x(this,T),et=(ze-We)/x(this,M);this.scaleFactor=Math.min(Ue,et)}function Vt(){var Fe=P(this,ke,Re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Fe,this.translationY*this.scaleFactor+Fe)}function bt(Fe){for(var ze=new Path2D,We=0,Ue=Fe.length;We<Ue;We++){var et=_slicedToArray(Fe[We],4),it=et[0],nt=et[1],dt=et[2],xt=et[3];We===0&&ze.moveTo.apply(ze,_toConsumableArray$1(it)),ze.bezierCurveTo(nt[0],nt[1],dt[0],dt[1],xt[0],xt[1])}return ze}function ot(Fe,ze,We,Ue){var et,it,nt,dt=[],xt=this.thickness/2,yt=_createForOfIteratorHelper(this.paths);try{for(yt.s();!(nt=yt.n()).done;){var Bt=nt.value;et=[],it=[];for(var Pt=0,Tt=Bt.length;Pt<Tt;Pt++){var ct=_slicedToArray(Bt[Pt],4),wt=ct[0],St=ct[1],Ft=ct[2],Gt=ct[3],jt=Fe*(wt[0]+ze)+xt,Ut=Ue-Fe*(wt[1]+We)-xt,Jt=Fe*(St[0]+ze)+xt,un=Ue-Fe*(St[1]+We)-xt,nn=Fe*(Ft[0]+ze)+xt,Zt=Ue-Fe*(Ft[1]+We)-xt,en=Fe*(Gt[0]+ze)+xt,Cn=Ue-Fe*(Gt[1]+We)-xt;Pt===0&&(et.push(jt,Ut),it.push(jt,Ut)),et.push(Jt,un,nn,Zt,en,Cn),P(this,Le,gt).call(this,jt,Ut,Jt,un,nn,Zt,en,Cn,4,it)}dt.push({bezier:et,points:it})}}catch($n){yt.e($n)}finally{yt.f()}return dt}function gt(Fe,ze,We,Ue,et,it,nt,dt,xt,yt){if(P(this,le,tt).call(this,Fe,ze,We,Ue,et,it,nt,dt))yt.push(nt,dt);else{for(var Bt=1;Bt<xt-1;Bt++){var Pt=Bt/xt,Tt=1-Pt,ct=Pt*Fe+Tt*We,wt=Pt*ze+Tt*Ue,St=Pt*We+Tt*et,Ft=Pt*Ue+Tt*it;ct=Pt*(ct=Pt*ct+Tt*St)+Tt*(St=Pt*St+Tt*(Pt*et+Tt*nt)),wt=Pt*(wt=Pt*wt+Tt*Ft)+Tt*(Ft=Pt*Ft+Tt*(Pt*it+Tt*dt)),yt.push(ct,wt)}yt.push(nt,dt)}}function tt(Fe,ze,We,Ue,et,it,nt,dt){var xt=Math.pow(3*We-2*Fe-nt,2),yt=Math.pow(3*Ue-2*ze-dt,2),Bt=Math.pow(3*et-Fe-2*nt,2),Pt=Math.pow(3*it-ze-2*dt,2);return Math.max(xt,Bt)+Math.max(yt,Pt)<=10}function ut(){var Fe,ze=1/0,We=-1/0,Ue=1/0,et=-1/0,it=_createForOfIteratorHelper(this.paths);try{for(it.s();!(Fe=it.n()).done;){var nt,dt=_createForOfIteratorHelper(Fe.value);try{for(dt.s();!(nt=dt.n()).done;){var xt,yt=_slicedToArray(nt.value,4),Bt=yt[0],Pt=yt[1],Tt=yt[2],ct=yt[3],wt=(xt=r.Util).bezierBoundingBox.apply(xt,_toConsumableArray$1(Bt).concat(_toConsumableArray$1(Pt),_toConsumableArray$1(Tt),_toConsumableArray$1(ct)));ze=Math.min(ze,wt[0]),Ue=Math.min(Ue,wt[1]),We=Math.max(We,wt[2]),et=Math.max(et,wt[3])}}catch(St){dt.e(St)}finally{dt.f()}}}catch(St){it.e(St)}finally{it.f()}return[ze,Ue,We,et]}function Re(){return x(this,F)?Math.ceil(this.thickness*this.parentScale):0}function Te(){var Fe=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!this.isEmpty())if(x(this,F)){var ze=P(this,oe,ut).call(this),We=P(this,ke,Re).call(this);y(this,T,Math.max(S,ze[2]-ze[0])),y(this,M,Math.max(S,ze[3]-ze[1]));var Ue=Math.ceil(We+x(this,T)*this.scaleFactor),et=Math.ceil(We+x(this,M)*this.scaleFactor),it=_slicedToArray(this.parentDimensions,2),nt=it[0],dt=it[1];this.width=Ue/nt,this.height=et/dt,y(this,E,Ue/et),P(this,Ee,He).call(this);var xt=this.translationX,yt=this.translationY;this.translationX=-ze[0],this.translationY=-ze[1],P(this,Ae,kt).call(this),P(this,re,rt).call(this),y(this,ne,Ue),y(this,ve,et),this.setDims(Ue,et);var Bt=Fe?We/this.scaleFactor/2:0;this.translate(xt-this.translationX-Bt,yt-this.translationY-Bt)}else P(this,re,rt).call(this)}function He(){var Fe=this.div.style;x(this,E)>=1?(Fe.minHeight="".concat(S,"px"),Fe.minWidth="".concat(Math.round(x(this,E)*S),"px")):(Fe.minWidth="".concat(S,"px"),Fe.minHeight="".concat(Math.round(S/x(this,E)),"px"))}n.InkEditor=Be,v(Be,"_defaultColor",null),v(Be,"_defaultOpacity",1),v(Be,"_defaultThickness",1),v(Be,"_l10nPromise",void 0),v(Be,"_type","ink")},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;var r=o(166);n.fitCurve=r},function(e){function n(d,f,y,x,k){var P,S,E,M,T,D,N,I,O,F,q,Y,_e;if(d.length===2)return Y=v.vectorLen(v.subtract(d[0],d[1]))/3,[P=[d[0],v.addArrays(d[0],v.mulItems(f,Y)),v.addArrays(d[1],v.mulItems(y,Y)),d[1]]];S=function(Z){var j,X,H,U=[];return Z.forEach(function(te,Q){j=Q?X+v.vectorLen(v.subtract(te,H)):0,U.push(j),X=j,H=te}),U=U.map(function(te){return te/X})}(d);var ne=_slicedToArray(o(d,S,S,f,y,k),3);if(P=ne[0],M=ne[1],D=ne[2],M===0||M<x)return[P];if(M<x*x)for(E=S,T=M,N=D,_e=0;_e<20;_e++){var ve=_slicedToArray(o(d,S,E=r(P,d,E),f,y,k),3);if(P=ve[0],M=ve[1],D=ve[2],M<x)return[P];if(D===N){var J=M/T;if(J>.9999&&J<1.0001)break}T=M,N=D}if(q=[],(I=v.subtract(d[D-1],d[D+1])).every(function(Z){return Z===0})){var fe=[-(I=v.subtract(d[D-1],d[D]))[1],I[0]];I[0]=fe[0],I[1]=fe[1]}return O=v.normalize(I),F=v.mulItems(O,-1),q=(q=q.concat(n(d.slice(0,D+1),f,O,x,k))).concat(n(d.slice(D),F,y,x,k))}function o(d,f,y,x,k,P){var S,E,M;S=function(N,I,O,F){var q,Y,_e,ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we=N[0],Ae=N[N.length-1];for(q=[we,null,null,Ae],Y=v.zeros_Xx2x2(I.length),te=0,Q=I.length;te<Q;te++)be=1-(Pe=I[te]),(_e=Y[te])[0]=v.mulItems(O,3*Pe*(be*be)),_e[1]=v.mulItems(F,3*be*(Pe*Pe));for(ne=[[0,0],[0,0]],ve=[0,0],te=0,Q=N.length;te<Q;te++)Pe=I[te],_e=Y[te],ne[0][0]+=v.dot(_e[0],_e[0]),ne[0][1]+=v.dot(_e[0],_e[1]),ne[1][0]+=v.dot(_e[0],_e[1]),ne[1][1]+=v.dot(_e[1],_e[1]),re=v.subtract(N[te],g.q([we,we,Ae,Ae],Pe)),ve[0]+=v.dot(_e[0],re),ve[1]+=v.dot(_e[1],re);return J=ne[0][0]*ne[1][1]-ne[1][0]*ne[0][1],fe=ne[0][0]*ve[1]-ne[1][0]*ve[0],Z=ve[0]*ne[1][1]-ve[1]*ne[0][1],j=J===0?0:Z/J,X=J===0?0:fe/J,U=v.vectorLen(v.subtract(we,Ae)),j<(H=1e-6*U)||X<H?(q[1]=v.addArrays(we,v.mulItems(O,U/3)),q[2]=v.addArrays(Ae,v.mulItems(F,U/3))):(q[1]=v.addArrays(we,v.mulItems(O,j)),q[2]=v.addArrays(Ae,v.mulItems(F,X))),q}(d,y,x,k);var T=function(N,I,O){var F,q,Y,_e,ne,ve,J,fe;q=0,Y=Math.floor(N.length/2);var Z=s(I,10);for(ne=0,ve=N.length;ne<ve;ne++)J=N[ne],fe=w(0,O[ne],Z,10),(F=(_e=v.subtract(g.q(I,fe),J))[0]*_e[0]+_e[1]*_e[1])>q&&(q=F,Y=ne);return[q,Y]}(d,S,f),D=_slicedToArray(T,2);return E=D[0],M=D[1],P&&P({bez:S,points:d,params:f,maxErr:E,maxPoint:M}),[S,E,M]}function r(d,f,y){return y.map(function(x,k){return u(d,f[k],x)})}function u(d,f,y){var x=v.subtract(g.q(d,y),f),k=g.qprime(d,y),P=v.mulMatrix(x,k),S=v.sum(v.squareItems(k))+2*v.mulMatrix(x,g.qprimeprime(d,y));return S===0?y:y-P/S}var s=function(d,f){for(var y,x=[0],k=d[0],P=0,S=1;S<=f;S++)y=g.q(d,S/f),P+=v.vectorLen(v.subtract(y,k)),x.push(P),k=y;return x=x.map(function(E){return E/P})};function w(d,f,y,x){if(f<0)return 0;if(f>1)return 1;for(var k,P,S,E,M=1;M<=x;M++)if(f<=y[M]){S=(M-1)/x,P=M/x,E=(f-(k=y[M-1]))/(y[M]-k)*(P-S)+S;break}return E}function m(d,f){return v.normalize(v.subtract(d,f))}var v=function(){function d(){_classCallCheck(this,d)}return _createClass(d,null,[{key:"zeros_Xx2x2",value:function(f){for(var y=[];f--;)y.push([0,0]);return y}},{key:"mulItems",value:function(f,y){return f.map(function(x){return x*y})}},{key:"mulMatrix",value:function(f,y){return f.reduce(function(x,k,P){return x+k*y[P]},0)}},{key:"subtract",value:function(f,y){return f.map(function(x,k){return x-y[k]})}},{key:"addArrays",value:function(f,y){return f.map(function(x,k){return x+y[k]})}},{key:"addItems",value:function(f,y){return f.map(function(x){return x+y})}},{key:"sum",value:function(f){return f.reduce(function(y,x){return y+x})}},{key:"dot",value:function(f,y){return d.mulMatrix(f,y)}},{key:"vectorLen",value:function(f){return Math.hypot.apply(Math,_toConsumableArray$1(f))}},{key:"divItems",value:function(f,y){return f.map(function(x){return x/y})}},{key:"squareItems",value:function(f){return f.map(function(y){return y*y})}},{key:"normalize",value:function(f){return this.divItems(f,this.vectorLen(f))}}])}(),g=function(){return _createClass(function d(){_classCallCheck(this,d)},null,[{key:"q",value:function(d,f){var y=1-f,x=v.mulItems(d[0],y*y*y),k=v.mulItems(d[1],3*y*y*f),P=v.mulItems(d[2],3*y*f*f),S=v.mulItems(d[3],f*f*f);return v.addArrays(v.addArrays(x,k),v.addArrays(P,S))}},{key:"qprime",value:function(d,f){var y=1-f,x=v.mulItems(v.subtract(d[1],d[0]),3*y*y),k=v.mulItems(v.subtract(d[2],d[1]),6*y*f),P=v.mulItems(v.subtract(d[3],d[2]),3*f*f);return v.addArrays(v.addArrays(x,k),P)}},{key:"qprimeprime",value:function(d,f){return v.addArrays(v.mulItems(v.addArrays(v.subtract(d[2],v.mulItems(d[1],2)),d[0]),6*(1-f)),v.mulItems(v.addArrays(v.subtract(d[3],v.mulItems(d[2],2)),d[1]),6*f))}}])}();e.exports=function(d,f,y){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(function(S){if(!Array.isArray(S)||S.some(function(E){return typeof E!="number"})||S.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),d=d.filter(function(S,E){return E===0||!S.every(function(M,T){return M===d[E-1][T]})}),d.length<2)return[];var x=d.length,k=m(d[1],d[0]),P=m(d[x-2],d[x-1]);return n(d,k,P,f,y)},e.exports.fitCubic=n,e.exports.createTangent=m},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var r=o(1),u=o(142),s=o(139),w=o(168),m=o(169);function v(Le,le,oe){return function(ke,Ce){if(ke!==Ce)throw new TypeError("Private static access of wrong provenance")}(Le,le),oe}function g(Le,le){(function(oe,ke){if(ke.has(oe))throw new TypeError("Cannot initialize the same private elements twice on an object")})(Le,le),le.add(Le)}function d(Le,le,oe){if(!le.has(Le))throw new TypeError("attempted to get private field on non-instance");return oe}var f=1e3,y=new WeakSet;function x(Le){return{width:Le[2]-Le[0],height:Le[3]-Le[1]}}var k=function(){return _createClass(function Le(){_classCallCheck(this,Le)},null,[{key:"create",value:function(Le){switch(Le.data.annotationType){case r.AnnotationType.LINK:return new M(Le);case r.AnnotationType.TEXT:return new N(Le);case r.AnnotationType.WIDGET:switch(Le.data.fieldType){case"Tx":return new O(Le);case"Btn":return Le.data.radioButton?new q(Le):Le.data.checkBox?new F(Le):new Y(Le);case"Ch":return new _e(Le)}return new I(Le);case r.AnnotationType.POPUP:return new ne(Le);case r.AnnotationType.FREETEXT:return new J(Le);case r.AnnotationType.LINE:return new fe(Le);case r.AnnotationType.SQUARE:return new Z(Le);case r.AnnotationType.CIRCLE:return new j(Le);case r.AnnotationType.POLYLINE:return new X(Le);case r.AnnotationType.CARET:return new U(Le);case r.AnnotationType.INK:return new te(Le);case r.AnnotationType.POLYGON:return new H(Le);case r.AnnotationType.HIGHLIGHT:return new Q(Le);case r.AnnotationType.UNDERLINE:return new re(Le);case r.AnnotationType.SQUIGGLY:return new Pe(Le);case r.AnnotationType.STRIKEOUT:return new be(Le);case r.AnnotationType.STAMP:return new we(Le);case r.AnnotationType.FILEATTACHMENT:return new Ae(Le);default:return new P(Le)}}}])}(),P=function(){return _createClass(function Le(le){_classCallCheck(this,Le);var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ke=oe.isRenderable,Ce=ke!==void 0&&ke,Ee=oe.ignoreBorder,Be=Ee!==void 0&&Ee,Ve=oe.createQuadrilaterals,Oe=Ve!==void 0&&Ve;this.isRenderable=Ce,this.data=le.data,this.layer=le.layer,this.page=le.page,this.viewport=le.viewport,this.linkService=le.linkService,this.downloadManager=le.downloadManager,this.imageResourcesPath=le.imageResourcesPath,this.renderForms=le.renderForms,this.svgFactory=le.svgFactory,this.annotationStorage=le.annotationStorage,this.enableScripting=le.enableScripting,this.hasJSActions=le.hasJSActions,this._fieldObjects=le.fieldObjects,Ce&&(this.container=this._createContainer(Be)),Oe&&(this.quadrilaterals=this._createQuadrilaterals(Be))},[{key:"_createContainer",value:function(){var Le=arguments.length>0&&arguments[0]!==void 0&&arguments[0],le=this.data,oe=this.page,ke=this.viewport,Ce=document.createElement("section");Ce.setAttribute("data-annotation-id",le.id),le.noRotate&&Ce.classList.add("norotate");var Ee=ke.rawDims,Be=Ee.pageWidth,Ve=Ee.pageHeight,Oe=Ee.pageX,je=Ee.pageY,Ge=x(le.rect),Xe=Ge.width,qe=Ge.height,Ke=r.Util.normalizeRect([le.rect[0],oe.view[3]-le.rect[1]+oe.view[1],le.rect[2],oe.view[3]-le.rect[3]+oe.view[1]]);if(!Le&&le.borderStyle.width>0){Ce.style.borderWidth="".concat(le.borderStyle.width,"px");var Je=le.borderStyle.horizontalCornerRadius,rt=le.borderStyle.verticalCornerRadius;if(Je>0||rt>0){var ht="calc(".concat(Je,"px * var(--scale-factor)) / calc(").concat(rt,"px * var(--scale-factor))");Ce.style.borderRadius=ht}else if(this instanceof q){var vt="calc(".concat(Xe,"px * var(--scale-factor)) / calc(").concat(qe,"px * var(--scale-factor))");Ce.style.borderRadius=vt}switch(le.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:Ce.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:Ce.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:Ce.style.borderBottomStyle="solid"}var Ct=le.borderColor||null;Ct?Ce.style.borderColor=r.Util.makeHexColor(0|Ct[0],0|Ct[1],0|Ct[2]):Ce.style.borderWidth=0}Ce.style.left="".concat(100*(Ke[0]-Oe)/Be,"%"),Ce.style.top="".concat(100*(Ke[1]-je)/Ve,"%");var kt=le.rotation;return le.hasOwnCanvas||kt===0?(Ce.style.width="".concat(100*Xe/Be,"%"),Ce.style.height="".concat(100*qe/Ve,"%")):this.setRotation(kt,Ce),Ce}},{key:"setRotation",value:function(Le){var le,oe,ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container,Ce=this.viewport.rawDims,Ee=Ce.pageWidth,Be=Ce.pageHeight,Ve=x(this.data.rect),Oe=Ve.width,je=Ve.height;Le%180==0?(le=100*Oe/Ee,oe=100*je/Be):(le=100*je/Ee,oe=100*Oe/Be),ke.style.width="".concat(le,"%"),ke.style.height="".concat(oe,"%"),ke.setAttribute("data-main-rotation",(360-Le)%360)}},{key:"_commonActions",get:function(){var Le=this,le=function(oe,ke,Ce){var Ee=Ce.detail[oe];Ce.target.style[ke]=w.ColorConverters["".concat(Ee[0],"_HTML")](Ee.slice(1))};return(0,r.shadow)(this,"_commonActions",{display:function(oe){var ke=oe.detail.display%2==1;Le.container.style.visibility=ke?"hidden":"visible",Le.annotationStorage.setValue(Le.data.id,{hidden:ke,print:oe.detail.display===0||oe.detail.display===3})},print:function(oe){Le.annotationStorage.setValue(Le.data.id,{print:oe.detail.print})},hidden:function(oe){Le.container.style.visibility=oe.detail.hidden?"hidden":"visible",Le.annotationStorage.setValue(Le.data.id,{hidden:oe.detail.hidden})},focus:function(oe){setTimeout(function(){return oe.target.focus({preventScroll:!1})},0)},userName:function(oe){oe.target.title=oe.detail.userName},readonly:function(oe){oe.detail.readonly?oe.target.setAttribute("readonly",""):oe.target.removeAttribute("readonly")},required:function(oe){Le._setRequired(oe.target,oe.detail.required)},bgColor:function(oe){le("bgColor","backgroundColor",oe)},fillColor:function(oe){le("fillColor","backgroundColor",oe)},fgColor:function(oe){le("fgColor","color",oe)},textColor:function(oe){le("textColor","color",oe)},borderColor:function(oe){le("borderColor","borderColor",oe)},strokeColor:function(oe){le("strokeColor","borderColor",oe)},rotation:function(oe){var ke=oe.detail.rotation;Le.setRotation(ke),Le.annotationStorage.setValue(Le.data.id,{rotation:ke})}})}},{key:"_dispatchEventFromSandbox",value:function(Le,le){for(var oe=this._commonActions,ke=0,Ce=Object.keys(le.detail);ke<Ce.length;ke++){var Ee=Ce[ke],Be=Le[Ee]||oe[Ee];Be==null||Be(le)}}},{key:"_setDefaultPropertiesFromJS",value:function(Le){if(this.enableScripting){var le=this.annotationStorage.getRawValue(this.data.id);if(le)for(var oe=this._commonActions,ke=0,Ce=Object.entries(le);ke<Ce.length;ke++){var Ee=_slicedToArray(Ce[ke],2),Be=Ee[0],Ve=Ee[1],Oe=oe[Be];Oe&&(Oe({detail:_defineProperty$1({},Be,Ve),target:Le}),delete le[Be])}}}},{key:"_createQuadrilaterals",value:function(){var Le=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!this.data.quadPoints)return null;var le,oe=[],ke=this.data.rect,Ce=_createForOfIteratorHelper(this.data.quadPoints);try{for(Ce.s();!(le=Ce.n()).done;){var Ee=le.value;this.data.rect=[Ee[2].x,Ee[2].y,Ee[1].x,Ee[1].y],oe.push(this._createContainer(Le))}}catch(Be){Ce.e(Be)}finally{Ce.f()}return this.data.rect=ke,oe}},{key:"_createPopup",value:function(Le,le){var oe=this.container;this.quadrilaterals&&(Le=Le||this.quadrilaterals,oe=this.quadrilaterals[0]),Le||((Le=document.createElement("div")).classList.add("popupTriggerArea"),oe.append(Le));var ke=new ve({container:oe,trigger:Le,color:le.color,titleObj:le.titleObj,modificationDate:le.modificationDate,contentsObj:le.contentsObj,richText:le.richText,hideWrapper:!0}).render();ke.style.left="100%",oe.append(ke)}},{key:"_renderQuadrilaterals",value:function(Le){var le,oe=_createForOfIteratorHelper(this.quadrilaterals);try{for(oe.s();!(le=oe.n()).done;)le.value.classList.add(Le)}catch(ke){oe.e(ke)}finally{oe.f()}return this.quadrilaterals}},{key:"render",value:function(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}},{key:"_getElementsByName",value:function(Le){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,oe=[];if(this._fieldObjects){var ke=this._fieldObjects[Le];if(ke){var Ce,Ee=_createForOfIteratorHelper(ke);try{for(Ee.s();!(Ce=Ee.n()).done;){var Be=Ce.value,Ve=Be.page,Oe=Be.id,je=Be.exportValues;if(Ve!==-1&&Oe!==le){var Ge=typeof je=="string"?je:null,Xe=document.querySelector('[data-element-id="'.concat(Oe,'"]'));!Xe||y.has(Xe)?oe.push({id:Oe,exportValue:Ge,domElement:Xe}):(0,r.warn)("_getElementsByName - element not allowed: ".concat(Oe))}}}catch(vt){Ee.e(vt)}finally{Ee.f()}}return oe}var qe,Ke=_createForOfIteratorHelper(document.getElementsByName(Le));try{for(Ke.s();!(qe=Ke.n()).done;){var Je=qe.value,rt=Je.exportValue,ht=Je.getAttribute("data-element-id");ht!==le&&y.has(Je)&&oe.push({id:ht,exportValue:rt,domElement:Je})}}catch(vt){Ke.e(vt)}finally{Ke.f()}return oe}}])}(),S=new WeakSet,E=new WeakSet,M=function(Le){function le(oe){var ke;_classCallCheck(this,le);var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return g(ke=_callSuper(this,le,[oe,{isRenderable:!0,ignoreBorder:!(Ce==null||!Ce.ignoreBorder),createQuadrilaterals:!0}]),E),g(ke,S),ke.isTooltipOnly=oe.data.isTooltipOnly,ke}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe=this.data,ke=this.linkService,Ce=document.createElement("a");Ce.setAttribute("data-element-id",oe.id);var Ee=!1;return oe.url?(ke.addLinkAttributes(Ce,oe.url,oe.newWindow),Ee=!0):oe.action?(this._bindNamedAction(Ce,oe.action),Ee=!0):oe.attachment?(this._bindAttachment(Ce,oe.attachment),Ee=!0):oe.setOCGState?(d(this,E,D).call(this,Ce,oe.setOCGState),Ee=!0):oe.dest?(this._bindLink(Ce,oe.dest),Ee=!0):(oe.actions&&(oe.actions.Action||oe.actions["Mouse Up"]||oe.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Ce,oe),Ee=!0),oe.resetForm?(this._bindResetFormAction(Ce,oe.resetForm),Ee=!0):this.isTooltipOnly&&!Ee&&(this._bindLink(Ce,""),Ee=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map(function(Be,Ve){var Oe=Ve===0?Ce:Ce.cloneNode();return Be.append(Oe),Be}):(this.container.classList.add("linkAnnotation"),Ee&&this.container.append(Ce),this.container)}},{key:"_bindLink",value:function(oe,ke){var Ce=this;oe.href=this.linkService.getDestinationHash(ke),oe.onclick=function(){return ke&&Ce.linkService.goToDestination(ke),!1},(ke||ke==="")&&d(this,S,T).call(this)}},{key:"_bindNamedAction",value:function(oe,ke){var Ce=this;oe.href=this.linkService.getAnchorUrl(""),oe.onclick=function(){return Ce.linkService.executeNamedAction(ke),!1},d(this,S,T).call(this)}},{key:"_bindAttachment",value:function(oe,ke){var Ce=this;oe.href=this.linkService.getAnchorUrl(""),oe.onclick=function(){var Ee;return(Ee=Ce.downloadManager)===null||Ee===void 0||Ee.openOrDownloadData(Ce.container,ke.content,ke.filename),!1},d(this,S,T).call(this)}},{key:"_bindJSAction",value:function(oe,ke){var Ce=this;oe.href=this.linkService.getAnchorUrl("");for(var Ee=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]),Be=function(){var je=Oe[Ve],Ge=Ee.get(je);if(!Ge)return 1;oe[Ge]=function(){var Xe;return(Xe=Ce.linkService.eventBus)===null||Xe===void 0||Xe.dispatch("dispatcheventinsandbox",{source:Ce,detail:{id:ke.id,name:je}}),!1}},Ve=0,Oe=Object.keys(ke.actions);Ve<Oe.length;Ve++)Be();oe.onclick||(oe.onclick=function(){return!1}),d(this,S,T).call(this)}},{key:"_bindResetFormAction",value:function(oe,ke){var Ce=this,Ee=oe.onclick;if(Ee||(oe.href=this.linkService.getAnchorUrl("")),d(this,S,T).call(this),!this._fieldObjects)return(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(Ee||(oe.onclick=function(){return!1}));oe.onclick=function(){Ee==null||Ee();var Be=ke.fields,Ve=ke.refs,Oe=ke.include,je=[];if(Be.length!==0||Ve.length!==0){var Ge,Xe=new Set(Ve),qe=_createForOfIteratorHelper(Be);try{for(qe.s();!(Ge=qe.n()).done;){var Ke,Je=Ge.value,rt=_createForOfIteratorHelper(Ce._fieldObjects[Je]||[]);try{for(rt.s();!(Ke=rt.n()).done;){var ht=Ke.value.id;Xe.add(ht)}}catch(nt){rt.e(nt)}finally{rt.f()}}}catch(nt){qe.e(nt)}finally{qe.f()}for(var vt=0,Ct=Object.values(Ce._fieldObjects);vt<Ct.length;vt++){var kt,mt=_createForOfIteratorHelper(Ct[vt]);try{for(mt.s();!(kt=mt.n()).done;){var Vt=kt.value;Xe.has(Vt.id)===Oe&&je.push(Vt)}}catch(nt){mt.e(nt)}finally{mt.f()}}}else for(var bt=0,ot=Object.values(Ce._fieldObjects);bt<ot.length;bt++){var gt=ot[bt];je.push.apply(je,_toConsumableArray$1(gt))}for(var tt,ut=Ce.annotationStorage,Re=[],Te=0,He=je;Te<He.length;Te++){var Fe=He[Te],ze=Fe.id;switch(Re.push(ze),Fe.type){case"text":var We=Fe.defaultValue||"";ut.setValue(ze,{value:We});break;case"checkbox":case"radiobutton":var Ue=Fe.defaultValue===Fe.exportValues;ut.setValue(ze,{value:Ue});break;case"combobox":case"listbox":var et=Fe.defaultValue||"";ut.setValue(ze,{value:et});break;default:continue}var it=document.querySelector('[data-element-id="'.concat(ze,'"]'));it&&(y.has(it)?it.dispatchEvent(new Event("resetform")):(0,r.warn)("_bindResetFormAction - element not allowed: ".concat(ze)))}return Ce.enableScripting&&((tt=Ce.linkService.eventBus)===null||tt===void 0||tt.dispatch("dispatcheventinsandbox",{source:Ce,detail:{id:"app",ids:Re,name:"ResetForm"}})),!1}}}])}(P);function T(){this.container.setAttribute("data-internal-link","")}function D(Le,le){var oe=this;Le.href=this.linkService.getAnchorUrl(""),Le.onclick=function(){return oe.linkService.executeSetOCGState(le),!1},d(this,S,T).call(this)}var N=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str)}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add("textAnnotation");var oe=document.createElement("img");return oe.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",oe.alt="[{{type}} Annotation]",oe.dataset.l10nId="text_annotation_type",oe.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(oe,this.data),this.container.append(oe),this.container}}])}(P),I=function(Le){function le(){return _classCallCheck(this,le),_callSuper(this,le,arguments)}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}},{key:"_getKeyModifier",value:function(oe){var ke=r.FeatureTest.platform,Ce=ke.isWin,Ee=ke.isMac;return Ce&&oe.ctrlKey||Ee&&oe.metaKey}},{key:"_setEventListener",value:function(oe,ke,Ce,Ee){var Be=this;ke.includes("mouse")?oe.addEventListener(ke,function(Ve){var Oe;(Oe=Be.linkService.eventBus)===null||Oe===void 0||Oe.dispatch("dispatcheventinsandbox",{source:Be,detail:{id:Be.data.id,name:Ce,value:Ee(Ve),shift:Ve.shiftKey,modifier:Be._getKeyModifier(Ve)}})}):oe.addEventListener(ke,function(Ve){var Oe;(Oe=Be.linkService.eventBus)===null||Oe===void 0||Oe.dispatch("dispatcheventinsandbox",{source:Be,detail:{id:Be.data.id,name:Ce,value:Ee(Ve)}})})}},{key:"_setEventListeners",value:function(oe,ke,Ce){var Ee,Be=_createForOfIteratorHelper(ke);try{for(Be.s();!(Ee=Be.n()).done;){var Ve,Oe=_slicedToArray(Ee.value,2),je=Oe[0],Ge=Oe[1];(Ge==="Action"||(Ve=this.data.actions)!==null&&Ve!==void 0&&Ve[Ge])&&this._setEventListener(oe,je,Ge,Ce)}}catch(Xe){Be.e(Xe)}finally{Be.f()}}},{key:"_setBackgroundColor",value:function(oe){var ke=this.data.backgroundColor||null;oe.style.backgroundColor=ke===null?"transparent":r.Util.makeHexColor(ke[0],ke[1],ke[2])}},{key:"_setTextStyle",value:function(oe){var ke,Ce=this.data.defaultAppearanceData.fontColor,Ee=this.data.defaultAppearanceData.fontSize||9,Be=oe.style,Ve=function(Xe){return Math.round(10*Xe)/10};if(this.data.multiLine){var Oe=Math.abs(this.data.rect[3]-this.data.rect[1]-2),je=Oe/(Math.round(Oe/(r.LINE_FACTOR*Ee))||1);ke=Math.min(Ee,Ve(je/r.LINE_FACTOR))}else{var Ge=Math.abs(this.data.rect[3]-this.data.rect[1]-2);ke=Math.min(Ee,Ve(Ge/r.LINE_FACTOR))}Be.fontSize="calc(".concat(ke,"px * var(--scale-factor))"),Be.color=r.Util.makeHexColor(Ce[0],Ce[1],Ce[2]),this.data.textAlignment!==null&&(Be.textAlign=["left","center","right"][this.data.textAlignment])}},{key:"_setRequired",value:function(oe,ke){ke?oe.setAttribute("required",!0):oe.removeAttribute("required"),oe.setAttribute("aria-required",ke)}}])}(P),O=function(Le){function le(oe){return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:oe.renderForms||!oe.data.hasAppearance&&!!oe.data.fieldValue}])}return _inherits(le,Le),_createClass(le,[{key:"setPropertyOnSiblings",value:function(oe,ke,Ce,Ee){var Be,Ve=this.annotationStorage,Oe=_createForOfIteratorHelper(this._getElementsByName(oe.name,oe.id));try{for(Oe.s();!(Be=Oe.n()).done;){var je=Be.value;je.domElement&&(je.domElement[ke]=Ce),Ve.setValue(je.id,_defineProperty$1({},Ee,Ce))}}catch(Ge){Oe.e(Ge)}finally{Oe.f()}}},{key:"render",value:function(){var oe=this,ke=this.annotationStorage,Ce=this.data.id;this.container.classList.add("textWidgetAnnotation");var Ee=null;if(this.renderForms){var Be=ke.getValue(Ce,{value:this.data.fieldValue}),Ve=Be.formattedValue||Be.value||"",Oe=ke.getValue(Ce,{charLimit:this.data.maxLen}).charLimit;Oe&&Ve.length>Oe&&(Ve=Ve.slice(0,Oe));var je={userValue:Ve,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?((Ee=document.createElement("textarea")).textContent=Ve,this.data.doNotScroll&&(Ee.style.overflowY="hidden")):((Ee=document.createElement("input")).type="text",Ee.setAttribute("value",Ve),this.data.doNotScroll&&(Ee.style.overflowX="hidden")),y.add(Ee),Ee.setAttribute("data-element-id",Ce),Ee.disabled=this.data.readOnly,Ee.name=this.data.fieldName,Ee.tabIndex=f,this._setRequired(Ee,this.data.required),Oe&&(Ee.maxLength=Oe),Ee.addEventListener("input",function(Je){ke.setValue(Ce,{value:Je.target.value}),oe.setPropertyOnSiblings(Ee,"value",Je.target.value,"value")}),Ee.addEventListener("resetform",function(Je){var rt,ht=(rt=oe.data.defaultFieldValue)!==null&&rt!==void 0?rt:"";Ee.value=je.userValue=ht,je.formattedValue=null});var Ge=function(Je){var rt=je.formattedValue;rt!=null&&(Je.target.value=rt),Je.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var Xe;Ee.addEventListener("focus",function(Je){var rt=Je.target;je.userValue&&(rt.value=je.userValue),je.lastCommittedValue=rt.value,je.commitKey=1}),Ee.addEventListener("updatefromsandbox",function(Je){var rt={value:function(ht){var vt;je.userValue=(vt=ht.detail.value)!==null&&vt!==void 0?vt:"",ke.setValue(Ce,{value:je.userValue.toString()}),ht.target.value=je.userValue},formattedValue:function(ht){var vt=ht.detail.formattedValue;je.formattedValue=vt,vt!=null&&ht.target!==document.activeElement&&(ht.target.value=vt),ke.setValue(Ce,{formattedValue:vt})},selRange:function(ht){var vt;(vt=ht.target).setSelectionRange.apply(vt,_toConsumableArray$1(ht.detail.selRange))},charLimit:function(ht){var vt,Ct=ht.detail.charLimit,kt=ht.target;if(Ct!==0){kt.setAttribute("maxLength",Ct);var mt=je.userValue;!mt||mt.length<=Ct||(mt=mt.slice(0,Ct),kt.value=je.userValue=mt,ke.setValue(Ce,{value:mt}),(vt=oe.linkService.eventBus)===null||vt===void 0||vt.dispatch("dispatcheventinsandbox",{source:oe,detail:{id:Ce,name:"Keystroke",value:mt,willCommit:!0,commitKey:1,selStart:kt.selectionStart,selEnd:kt.selectionEnd}}))}else kt.removeAttribute("maxLength")}};oe._dispatchEventFromSandbox(rt,Je)}),Ee.addEventListener("keydown",function(Je){var rt;je.commitKey=1;var ht=-1;if(Je.key==="Escape"?ht=0:Je.key!=="Enter"||oe.data.multiLine?Je.key==="Tab"&&(je.commitKey=3):ht=2,ht!==-1){var vt=Je.target.value;je.lastCommittedValue!==vt&&(je.lastCommittedValue=vt,je.userValue=vt,(rt=oe.linkService.eventBus)===null||rt===void 0||rt.dispatch("dispatcheventinsandbox",{source:oe,detail:{id:Ce,name:"Keystroke",value:vt,willCommit:!0,commitKey:ht,selStart:Je.target.selectionStart,selEnd:Je.target.selectionEnd}}))}});var qe=Ge;Ge=null,Ee.addEventListener("blur",function(Je){if(Je.relatedTarget){var rt,ht=Je.target.value;je.userValue=ht,je.lastCommittedValue!==ht&&((rt=oe.linkService.eventBus)===null||rt===void 0||rt.dispatch("dispatcheventinsandbox",{source:oe,detail:{id:Ce,name:"Keystroke",value:ht,willCommit:!0,commitKey:je.commitKey,selStart:Je.target.selectionStart,selEnd:Je.target.selectionEnd}})),qe(Je)}}),(Xe=this.data.actions)!==null&&Xe!==void 0&&Xe.Keystroke&&Ee.addEventListener("beforeinput",function(Je){var rt;je.lastCommittedValue=null;var ht=Je.data,vt=Je.target,Ct=vt.value,kt=vt.selectionStart,mt=vt.selectionEnd,Vt=kt,bt=mt;switch(Je.inputType){case"deleteWordBackward":var ot=Ct.substring(0,kt).match(/\w*[^\w]*$/);ot&&(Vt-=ot[0].length);break;case"deleteWordForward":var gt=Ct.substring(kt).match(/^[^\w]*\w*/);gt&&(bt+=gt[0].length);break;case"deleteContentBackward":kt===mt&&(Vt-=1);break;case"deleteContentForward":kt===mt&&(bt+=1)}Je.preventDefault(),(rt=oe.linkService.eventBus)===null||rt===void 0||rt.dispatch("dispatcheventinsandbox",{source:oe,detail:{id:Ce,name:"Keystroke",value:Ct,change:ht||"",willCommit:!1,selStart:Vt,selEnd:bt}})}),this._setEventListeners(Ee,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],function(Je){return Je.target.value})}if(Ge&&Ee.addEventListener("blur",Ge),this.data.comb){var Ke=(this.data.rect[2]-this.data.rect[0])/Oe;Ee.classList.add("comb"),Ee.style.letterSpacing="calc(".concat(Ke,"px * var(--scale-factor) - 1ch)")}}else(Ee=document.createElement("div")).textContent=this.data.fieldValue,Ee.style.verticalAlign="middle",Ee.style.display="table-cell";return this._setTextStyle(Ee),this._setBackgroundColor(Ee),this._setDefaultPropertiesFromJS(Ee),this.container.append(Ee),this.container}}])}(I),F=function(Le){function le(oe){return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:oe.renderForms}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe=this,ke=this.annotationStorage,Ce=this.data,Ee=Ce.id,Be=ke.getValue(Ee,{value:Ce.exportValue===Ce.fieldValue}).value;typeof Be=="string"&&(Be=Be!=="Off",ke.setValue(Ee,{value:Be})),this.container.classList.add("buttonWidgetAnnotation","checkBox");var Ve=document.createElement("input");return y.add(Ve),Ve.setAttribute("data-element-id",Ee),Ve.disabled=Ce.readOnly,this._setRequired(Ve,this.data.required),Ve.type="checkbox",Ve.name=Ce.fieldName,Be&&Ve.setAttribute("checked",!0),Ve.setAttribute("exportValue",Ce.exportValue),Ve.tabIndex=f,Ve.addEventListener("change",function(Oe){var je,Ge=Oe.target,Xe=Ge.name,qe=Ge.checked,Ke=_createForOfIteratorHelper(oe._getElementsByName(Xe,Ee));try{for(Ke.s();!(je=Ke.n()).done;){var Je=je.value,rt=qe&&Je.exportValue===Ce.exportValue;Je.domElement&&(Je.domElement.checked=rt),ke.setValue(Je.id,{value:rt})}}catch(ht){Ke.e(ht)}finally{Ke.f()}ke.setValue(Ee,{value:qe})}),Ve.addEventListener("resetform",function(Oe){var je=Ce.defaultFieldValue||"Off";Oe.target.checked=je===Ce.exportValue}),this.enableScripting&&this.hasJSActions&&(Ve.addEventListener("updatefromsandbox",function(Oe){var je={value:function(Ge){Ge.target.checked=Ge.detail.value!=="Off",ke.setValue(Ee,{value:Ge.target.checked})}};oe._dispatchEventFromSandbox(je,Oe)}),this._setEventListeners(Ve,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],function(Oe){return Oe.target.checked})),this._setBackgroundColor(Ve),this._setDefaultPropertiesFromJS(Ve),this.container.append(Ve),this.container}}])}(I),q=function(Le){function le(oe){return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:oe.renderForms}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe=this;this.container.classList.add("buttonWidgetAnnotation","radioButton");var ke=this.annotationStorage,Ce=this.data,Ee=Ce.id,Be=ke.getValue(Ee,{value:Ce.fieldValue===Ce.buttonValue}).value;typeof Be=="string"&&(Be=Be!==Ce.buttonValue,ke.setValue(Ee,{value:Be}));var Ve=document.createElement("input");if(y.add(Ve),Ve.setAttribute("data-element-id",Ee),Ve.disabled=Ce.readOnly,this._setRequired(Ve,this.data.required),Ve.type="radio",Ve.name=Ce.fieldName,Be&&Ve.setAttribute("checked",!0),Ve.tabIndex=f,Ve.addEventListener("change",function(je){var Ge,Xe=je.target,qe=Xe.name,Ke=Xe.checked,Je=_createForOfIteratorHelper(oe._getElementsByName(qe,Ee));try{for(Je.s();!(Ge=Je.n()).done;){var rt=Ge.value;ke.setValue(rt.id,{value:!1})}}catch(ht){Je.e(ht)}finally{Je.f()}ke.setValue(Ee,{value:Ke})}),Ve.addEventListener("resetform",function(je){var Ge=Ce.defaultFieldValue;je.target.checked=Ge!=null&&Ge===Ce.buttonValue}),this.enableScripting&&this.hasJSActions){var Oe=Ce.buttonValue;Ve.addEventListener("updatefromsandbox",function(je){var Ge={value:function(Xe){var qe,Ke=Oe===Xe.detail.value,Je=_createForOfIteratorHelper(oe._getElementsByName(Xe.target.name));try{for(Je.s();!(qe=Je.n()).done;){var rt=qe.value,ht=Ke&&rt.id===Ee;rt.domElement&&(rt.domElement.checked=ht),ke.setValue(rt.id,{value:ht})}}catch(vt){Je.e(vt)}finally{Je.f()}}};oe._dispatchEventFromSandbox(Ge,je)}),this._setEventListeners(Ve,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],function(je){return je.target.checked})}return this._setBackgroundColor(Ve),this._setDefaultPropertiesFromJS(Ve),this.container.append(Ve),this.container}}])}(I),Y=function(Le){function le(oe){return _classCallCheck(this,le),_callSuper(this,le,[oe,{ignoreBorder:oe.data.hasAppearance}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe=this,ke=_get(_getPrototypeOf(le.prototype),"render",this).call(this);ke.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(ke.title=this.data.alternativeText);var Ce=ke.lastChild;return this.enableScripting&&this.hasJSActions&&Ce&&(this._setDefaultPropertiesFromJS(Ce),Ce.addEventListener("updatefromsandbox",function(Ee){oe._dispatchEventFromSandbox({},Ee)})),ke}}])}(M),_e=function(Le){function le(oe){return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:oe.renderForms}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe=this;this.container.classList.add("choiceWidgetAnnotation");var ke=this.annotationStorage,Ce=this.data.id,Ee=ke.getValue(Ce,{value:this.data.fieldValue}),Be=document.createElement("select");y.add(Be),Be.setAttribute("data-element-id",Ce),Be.disabled=this.data.readOnly,this._setRequired(Be,this.data.required),Be.name=this.data.fieldName,Be.tabIndex=f;var Ve=this.data.combo&&this.data.options.length>0;this.data.combo||(Be.size=this.data.options.length,this.data.multiSelect&&(Be.multiple=!0)),Be.addEventListener("resetform",function(vt){var Ct,kt=oe.data.defaultFieldValue,mt=_createForOfIteratorHelper(Be.options);try{for(mt.s();!(Ct=mt.n()).done;){var Vt=Ct.value;Vt.selected=Vt.value===kt}}catch(bt){mt.e(bt)}finally{mt.f()}});var Oe,je=_createForOfIteratorHelper(this.data.options);try{for(je.s();!(Oe=je.n()).done;){var Ge=Oe.value,Xe=document.createElement("option");Xe.textContent=Ge.displayValue,Xe.value=Ge.exportValue,Ee.value.includes(Ge.exportValue)&&(Xe.setAttribute("selected",!0),Ve=!1),Be.append(Xe)}}catch(vt){je.e(vt)}finally{je.f()}var qe=null;if(Ve){var Ke=document.createElement("option");Ke.value=" ",Ke.setAttribute("hidden",!0),Ke.setAttribute("selected",!0),Be.prepend(Ke),qe=function(){Ke.remove(),Be.removeEventListener("input",qe),qe=null},Be.addEventListener("input",qe)}var Je=function(vt){var Ct=vt?"value":"textContent",kt=Be.options;return Be.multiple?Array.prototype.filter.call(kt,function(mt){return mt.selected}).map(function(mt){return mt[Ct]}):kt.selectedIndex===-1?null:kt[kt.selectedIndex][Ct]},rt=Je(!1),ht=function(vt){var Ct=vt.target.options;return Array.prototype.map.call(Ct,function(kt){return{displayValue:kt.textContent,exportValue:kt.value}})};return this.enableScripting&&this.hasJSActions?(Be.addEventListener("updatefromsandbox",function(vt){var Ct={value:function(kt){var mt;(mt=qe)===null||mt===void 0||mt();var Vt,bt=kt.detail.value,ot=new Set(Array.isArray(bt)?bt:[bt]),gt=_createForOfIteratorHelper(Be.options);try{for(gt.s();!(Vt=gt.n()).done;){var tt=Vt.value;tt.selected=ot.has(tt.value)}}catch(ut){gt.e(ut)}finally{gt.f()}ke.setValue(Ce,{value:Je(!0)}),rt=Je(!1)},multipleSelection:function(kt){Be.multiple=!0},remove:function(kt){var mt=Be.options,Vt=kt.detail.remove;if(mt[Vt].selected=!1,Be.remove(Vt),mt.length>0){var bt=Array.prototype.findIndex.call(mt,function(ot){return ot.selected});bt===-1&&(mt[0].selected=!0)}ke.setValue(Ce,{value:Je(!0),items:ht(kt)}),rt=Je(!1)},clear:function(kt){for(;Be.length!==0;)Be.remove(0);ke.setValue(Ce,{value:null,items:[]}),rt=Je(!1)},insert:function(kt){var mt=kt.detail.insert,Vt=mt.index,bt=mt.displayValue,ot=mt.exportValue,gt=Be.children[Vt],tt=document.createElement("option");tt.textContent=bt,tt.value=ot,gt?gt.before(tt):Be.append(tt),ke.setValue(Ce,{value:Je(!0),items:ht(kt)}),rt=Je(!1)},items:function(kt){for(var mt=kt.detail.items;Be.length!==0;)Be.remove(0);var Vt,bt=_createForOfIteratorHelper(mt);try{for(bt.s();!(Vt=bt.n()).done;){var ot=Vt.value,gt=ot.displayValue,tt=ot.exportValue,ut=document.createElement("option");ut.textContent=gt,ut.value=tt,Be.append(ut)}}catch(Re){bt.e(Re)}finally{bt.f()}Be.options.length>0&&(Be.options[0].selected=!0),ke.setValue(Ce,{value:Je(!0),items:ht(kt)}),rt=Je(!1)},indices:function(kt){var mt,Vt=new Set(kt.detail.indices),bt=_createForOfIteratorHelper(kt.target.options);try{for(bt.s();!(mt=bt.n()).done;){var ot=mt.value;ot.selected=Vt.has(ot.index)}}catch(gt){bt.e(gt)}finally{bt.f()}ke.setValue(Ce,{value:Je(!0)}),rt=Je(!1)},editable:function(kt){kt.target.disabled=!kt.detail.editable}};oe._dispatchEventFromSandbox(Ct,vt)}),Be.addEventListener("input",function(vt){var Ct,kt=Je(!0);ke.setValue(Ce,{value:kt}),vt.preventDefault(),(Ct=oe.linkService.eventBus)===null||Ct===void 0||Ct.dispatch("dispatcheventinsandbox",{source:oe,detail:{id:Ce,name:"Keystroke",value:rt,changeEx:kt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Be,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],function(vt){return vt.target.value})):Be.addEventListener("input",function(vt){ke.setValue(Ce,{value:Je(!0)})}),this.data.combo&&this._setTextStyle(Be),this._setBackgroundColor(Be),this._setDefaultPropertiesFromJS(Be),this.container.append(Be),this.container}}])}(I),ne=function(Le){function le(oe){var ke,Ce,Ee;_classCallCheck(this,le);var Be=oe.data,Ve=!le.IGNORE_TYPES.has(Be.parentType)&&!!((ke=Be.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=Be.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=Be.richText)!==null&&Ee!==void 0&&Ee.str);return _callSuper(this,le,[oe,{isRenderable:Ve}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add("popupAnnotation");var oe=this.layer.querySelectorAll('[data-annotation-id="'.concat(this.data.parentId,'"]'));if(oe.length===0)return this.container;var ke=new ve({container:this.container,trigger:Array.from(oe),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Ce=this.page,Ee=r.Util.normalizeRect([this.data.parentRect[0],Ce.view[3]-this.data.parentRect[1]+Ce.view[1],this.data.parentRect[2],Ce.view[3]-this.data.parentRect[3]+Ce.view[1]]),Be=Ee[0]+this.data.parentRect[2]-this.data.parentRect[0],Ve=Ee[1],Oe=this.viewport.rawDims,je=Oe.pageWidth,Ge=Oe.pageHeight,Xe=Oe.pageX,qe=Oe.pageY;return this.container.style.left="".concat(100*(Be-Xe)/je,"%"),this.container.style.top="".concat(100*(Ve-qe)/Ge,"%"),this.container.append(ke.render()),this.container}}])}(P);_defineProperty$1(ne,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));var ve=function(){return _createClass(function Le(le){_classCallCheck(this,Le),this.container=le.container,this.trigger=le.trigger,this.color=le.color,this.titleObj=le.titleObj,this.modificationDate=le.modificationDate,this.contentsObj=le.contentsObj,this.richText=le.richText,this.hideWrapper=le.hideWrapper||!1,this.pinned=!1},[{key:"render",value:function(){var Le,le,oe=document.createElement("div");oe.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?oe:this.container,this.hideElement.hidden=!0;var ke=document.createElement("div");ke.classList.add("popup");var Ce=this.color;if(Ce){var Ee=.7*(255-Ce[0])+Ce[0],Be=.7*(255-Ce[1])+Ce[1],Ve=.7*(255-Ce[2])+Ce[2];ke.style.backgroundColor=r.Util.makeHexColor(0|Ee,0|Be,0|Ve)}var Oe=document.createElement("h1");Oe.dir=this.titleObj.dir,Oe.textContent=this.titleObj.str,ke.append(Oe);var je=u.PDFDateString.toDateObject(this.modificationDate);if(je){var Ge=document.createElement("span");Ge.classList.add("popupDate"),Ge.textContent="{{date}}, {{time}}",Ge.dataset.l10nId="annotation_date_string",Ge.dataset.l10nArgs=JSON.stringify({date:je.toLocaleDateString(),time:je.toLocaleTimeString()}),ke.append(Ge)}if((Le=this.richText)===null||Le===void 0||!Le.str||(le=this.contentsObj)!==null&&le!==void 0&&le.str&&this.contentsObj.str!==this.richText.str){var Xe=this._formatContents(this.contentsObj);ke.append(Xe)}else m.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:ke}),ke.lastChild.classList.add("richText","popupContent");Array.isArray(this.trigger)||(this.trigger=[this.trigger]);var qe,Ke=_createForOfIteratorHelper(this.trigger);try{for(Ke.s();!(qe=Ke.n()).done;){var Je=qe.value;Je.addEventListener("click",this._toggle.bind(this)),Je.addEventListener("mouseover",this._show.bind(this,!1)),Je.addEventListener("mouseout",this._hide.bind(this,!1))}}catch(rt){Ke.e(rt)}finally{Ke.f()}return ke.addEventListener("click",this._hide.bind(this,!0)),oe.append(ke),oe}},{key:"_formatContents",value:function(Le){var le=Le.str,oe=Le.dir,ke=document.createElement("p");ke.classList.add("popupContent"),ke.dir=oe;for(var Ce=le.split(/(?:\r\n?|\n)/),Ee=0,Be=Ce.length;Ee<Be;++Ee){var Ve=Ce[Ee];ke.append(document.createTextNode(Ve)),Ee<Be-1&&ke.append(document.createElement("br"))}return ke}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}},{key:"_hide",value:function(){(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}])}(),J=function(Le){function le(oe){var ke,Ce,Ee,Be;return _classCallCheck(this,le),(ke=_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(Ce=oe.data.titleObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.contentsObj)!==null&&Ee!==void 0&&Ee.str||(Be=oe.data.richText)!==null&&Be!==void 0&&Be.str),ignoreBorder:!0}])).textContent=oe.data.textContent,ke}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){var oe=document.createElement("div");oe.classList.add("annotationTextContent"),oe.setAttribute("role","comment");var ke,Ce=_createForOfIteratorHelper(this.textContent);try{for(Ce.s();!(ke=Ce.n()).done;){var Ee=ke.value,Be=document.createElement("span");Be.textContent=Ee,oe.append(Be)}}catch(Ve){Ce.e(Ve)}finally{Ce.f()}this.container.append(oe)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}])}(P),fe=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add("lineAnnotation");var oe=this.data,ke=x(oe.rect),Ce=ke.width,Ee=ke.height,Be=this.svgFactory.create(Ce,Ee,!0),Ve=this.svgFactory.createElement("svg:line");return Ve.setAttribute("x1",oe.rect[2]-oe.lineCoordinates[0]),Ve.setAttribute("y1",oe.rect[3]-oe.lineCoordinates[1]),Ve.setAttribute("x2",oe.rect[2]-oe.lineCoordinates[2]),Ve.setAttribute("y2",oe.rect[3]-oe.lineCoordinates[3]),Ve.setAttribute("stroke-width",oe.borderStyle.width||1),Ve.setAttribute("stroke","transparent"),Ve.setAttribute("fill","transparent"),Be.append(Ve),this.container.append(Be),this._createPopup(Ve,oe),this.container}}])}(P),Z=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add("squareAnnotation");var oe=this.data,ke=x(oe.rect),Ce=ke.width,Ee=ke.height,Be=this.svgFactory.create(Ce,Ee,!0),Ve=oe.borderStyle.width,Oe=this.svgFactory.createElement("svg:rect");return Oe.setAttribute("x",Ve/2),Oe.setAttribute("y",Ve/2),Oe.setAttribute("width",Ce-Ve),Oe.setAttribute("height",Ee-Ve),Oe.setAttribute("stroke-width",Ve||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),Be.append(Oe),this.container.append(Be),this._createPopup(Oe,oe),this.container}}])}(P),j=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add("circleAnnotation");var oe=this.data,ke=x(oe.rect),Ce=ke.width,Ee=ke.height,Be=this.svgFactory.create(Ce,Ee,!0),Ve=oe.borderStyle.width,Oe=this.svgFactory.createElement("svg:ellipse");return Oe.setAttribute("cx",Ce/2),Oe.setAttribute("cy",Ee/2),Oe.setAttribute("rx",Ce/2-Ve/2),Oe.setAttribute("ry",Ee/2-Ve/2),Oe.setAttribute("stroke-width",Ve||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),Be.append(Oe),this.container.append(Be),this._createPopup(Oe,oe),this.container}}])}(P),X=function(Le){function le(oe){var ke,Ce,Ee,Be;return _classCallCheck(this,le),(ke=_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(Ce=oe.data.titleObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.contentsObj)!==null&&Ee!==void 0&&Ee.str||(Be=oe.data.richText)!==null&&Be!==void 0&&Be.str),ignoreBorder:!0}])).containerClassName="polylineAnnotation",ke.svgElementName="svg:polyline",ke}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add(this.containerClassName);var oe,ke=this.data,Ce=x(ke.rect),Ee=Ce.width,Be=Ce.height,Ve=this.svgFactory.create(Ee,Be,!0),Oe=[],je=_createForOfIteratorHelper(ke.vertices);try{for(je.s();!(oe=je.n()).done;){var Ge=oe.value,Xe=Ge.x-ke.rect[0],qe=ke.rect[3]-Ge.y;Oe.push(Xe+","+qe)}}catch(Je){je.e(Je)}finally{je.f()}Oe=Oe.join(" ");var Ke=this.svgFactory.createElement(this.svgElementName);return Ke.setAttribute("points",Oe),Ke.setAttribute("stroke-width",ke.borderStyle.width||1),Ke.setAttribute("stroke","transparent"),Ke.setAttribute("fill","transparent"),Ve.append(Ke),this.container.append(Ve),this._createPopup(Ke,ke),this.container}}])}(P),H=function(Le){function le(oe){var ke;return _classCallCheck(this,le),(ke=_callSuper(this,le,[oe])).containerClassName="polygonAnnotation",ke.svgElementName="svg:polygon",ke}return _inherits(le,Le),_createClass(le)}(X),U=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}])}(P),te=function(Le){function le(oe){var ke,Ce,Ee,Be;return _classCallCheck(this,le),(ke=_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(Ce=oe.data.titleObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.contentsObj)!==null&&Ee!==void 0&&Ee.str||(Be=oe.data.richText)!==null&&Be!==void 0&&Be.str),ignoreBorder:!0}])).containerClassName="inkAnnotation",ke.svgElementName="svg:polyline",ke}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){this.container.classList.add(this.containerClassName);var oe,ke=this.data,Ce=x(ke.rect),Ee=Ce.width,Be=Ce.height,Ve=this.svgFactory.create(Ee,Be,!0),Oe=_createForOfIteratorHelper(ke.inkLists);try{for(Oe.s();!(oe=Oe.n()).done;){var je,Ge=oe.value,Xe=[],qe=_createForOfIteratorHelper(Ge);try{for(qe.s();!(je=qe.n()).done;){var Ke=je.value,Je=Ke.x-ke.rect[0],rt=ke.rect[3]-Ke.y;Xe.push("".concat(Je,",").concat(rt))}}catch(vt){qe.e(vt)}finally{qe.f()}Xe=Xe.join(" ");var ht=this.svgFactory.createElement(this.svgElementName);ht.setAttribute("points",Xe),ht.setAttribute("stroke-width",ke.borderStyle.width||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),this._createPopup(ht,ke),Ve.append(ht)}}catch(vt){Oe.e(vt)}finally{Oe.f()}return this.container.append(Ve),this.container}}])}(P),Q=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}])}(P),re=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}])}(P),Pe=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}])}(P),be=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}])}(P),we=function(Le){function le(oe){var ke,Ce,Ee;return _classCallCheck(this,le),_callSuper(this,le,[oe,{isRenderable:!!(oe.data.hasPopup||(ke=oe.data.titleObj)!==null&&ke!==void 0&&ke.str||(Ce=oe.data.contentsObj)!==null&&Ce!==void 0&&Ce.str||(Ee=oe.data.richText)!==null&&Ee!==void 0&&Ee.str),ignoreBorder:!0}])}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}])}(P),Ae=function(Le){function le(oe){var ke,Ce;_classCallCheck(this,le);var Ee=(ke=_callSuper(this,le,[oe,{isRenderable:!0}])).data.file,Be=Ee.filename,Ve=Ee.content;return ke.filename=(0,u.getFilenameFromUrl)(Be,!0),ke.content=Ve,(Ce=ke.linkService.eventBus)===null||Ce===void 0||Ce.dispatch("fileattachmentannotation",{source:ke,filename:Be,content:Ve}),ke}return _inherits(le,Le),_createClass(le,[{key:"render",value:function(){var oe,ke,Ce;return this.container.classList.add("fileAttachmentAnnotation"),this.data.hasAppearance?Ce=document.createElement("div"):(Ce=document.createElement("img")).src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(this.data.name)?"paperclip":"pushpin",".svg"),Ce.classList.add("popupTriggerArea"),Ce.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((oe=this.data.titleObj)!==null&&oe!==void 0&&oe.str||(ke=this.data.contentsObj)!==null&&ke!==void 0&&ke.str||this.data.richText)&&this._createPopup(Ce,this.data),this.container.append(Ce),this.container}},{key:"_download",value:function(){var oe;(oe=this.downloadManager)===null||oe===void 0||oe.openOrDownloadData(this.container,this.content,this.filename)}}])}(P),$e=function(){function Le(){_classCallCheck(this,Le)}return _createClass(Le,null,[{key:"render",value:function(le){var oe=le.annotations,ke=le.div,Ce=le.viewport,Ee=le.accessibilityManager;(0,u.setLayerDimensions)(ke,Ce);var Be,Ve={data:null,layer:ke,page:le.page,viewport:Ce,linkService:le.linkService,downloadManager:le.downloadManager,imageResourcesPath:le.imageResourcesPath||"",renderForms:le.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:le.annotationStorage||new s.AnnotationStorage,enableScripting:le.enableScripting===!0,hasJSActions:le.hasJSActions,fieldObjects:le.fieldObjects},Oe=0,je=_createForOfIteratorHelper(oe);try{for(je.s();!(Be=je.n()).done;){var Ge=Be.value;if(!Ge.noHTML){if(Ge.annotationType!==r.AnnotationType.POPUP){var Xe=x(Ge.rect),qe=Xe.width,Ke=Xe.height;if(qe<=0||Ke<=0)continue}Ve.data=Ge;var Je=k.create(Ve);if(Je.isRenderable){var rt=Je.render();if(Ge.hidden&&(rt.style.visibility="hidden"),Array.isArray(rt)){var ht,vt=_createForOfIteratorHelper(rt);try{for(vt.s();!(ht=vt.n()).done;){var Ct=ht.value;Ct.style.zIndex=Oe++,v(Le,Le,Me).call(Le,Ct,Ge.id,ke,Ee)}}catch(kt){vt.e(kt)}finally{vt.f()}}else rt.style.zIndex=Oe++,Je instanceof ne?ke.prepend(rt):v(Le,Le,Me).call(Le,rt,Ge.id,ke,Ee)}}}}catch(kt){je.e(kt)}finally{je.f()}v(this,Le,Ie).call(this,ke,le.annotationCanvasMap)}},{key:"update",value:function(le){var oe=le.annotationCanvasMap,ke=le.div,Ce=le.viewport;(0,u.setLayerDimensions)(ke,{rotation:Ce.rotation}),v(this,Le,Ie).call(this,ke,oe),ke.hidden=!1}}])}();function Me(Le,le,oe,ke){var Ce=Le.firstChild||Le;Ce.id="".concat(u.AnnotationPrefix).concat(le),oe.append(Le),ke==null||ke.moveElementInDOM(oe,Le,Ce,!1)}function Ie(Le,le){if(le){var oe,ke=_createForOfIteratorHelper(le);try{for(ke.s();!(oe=ke.n()).done;){var Ce=_slicedToArray(oe.value,2),Ee=Ce[0],Be=Ce[1],Ve=Le.querySelector('[data-annotation-id="'.concat(Ee,'"]'));if(Ve){var Oe=Ve.firstChild;Oe?Oe.nodeName==="CANVAS"?Oe.replaceWith(Be):Oe.before(Be):Ve.append(Be)}}}catch(je){ke.e(je)}finally{ke.f()}le.clear()}}n.AnnotationLayer=$e},function(e,n){function o(u){return Math.floor(255*Math.max(0,Math.min(1,u))).toString(16).padStart(2,"0")}Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;var r=function(){return _createClass(function u(){_classCallCheck(this,u)},null,[{key:"CMYK_G",value:function(u){var s=_slicedToArray(u,4),w=s[0],m=s[1],v=s[2],g=s[3];return["G",1-Math.min(1,.3*w+.59*v+.11*m+g)]}},{key:"G_CMYK",value:function(u){return["CMYK",0,0,0,1-_slicedToArray(u,1)[0]]}},{key:"G_RGB",value:function(u){var s=_slicedToArray(u,1)[0];return["RGB",s,s,s]}},{key:"G_HTML",value:function(u){var s=o(_slicedToArray(u,1)[0]);return"#".concat(s).concat(s).concat(s)}},{key:"RGB_G",value:function(u){var s=_slicedToArray(u,3);return["G",.3*s[0]+.59*s[1]+.11*s[2]]}},{key:"RGB_HTML",value:function(u){var s=_slicedToArray(u,3),w=s[0],m=s[1],v=s[2],g=o(w),d=o(m),f=o(v);return"#".concat(g).concat(d).concat(f)}},{key:"T_HTML",value:function(){return"#00000000"}},{key:"CMYK_RGB",value:function(u){var s=_slicedToArray(u,4),w=s[0],m=s[1],v=s[2],g=s[3];return["RGB",1-Math.min(1,w+g),1-Math.min(1,v+g),1-Math.min(1,m+g)]}},{key:"CMYK_HTML",value:function(u){var s=this.CMYK_RGB(u).slice(1);return this.RGB_HTML(s)}},{key:"RGB_CMYK",value:function(u){var s=_slicedToArray(u,3),w=1-s[0],m=1-s[1],v=1-s[2];return["CMYK",w,m,v,Math.min(w,m,v)]}}])}();n.ColorConverters=r},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var r=o(154),u=function(){return _createClass(function s(){_classCallCheck(this,s)},null,[{key:"setupStorage",value:function(s,w,m,v,g){var d=v.getValue(w,{value:null});switch(m.name){case"textarea":if(d.value!==null&&(s.textContent=d.value),g==="print")break;s.addEventListener("input",function(k){v.setValue(w,{value:k.target.value})});break;case"input":if(m.attributes.type==="radio"||m.attributes.type==="checkbox"){if(d.value===m.attributes.xfaOn?s.setAttribute("checked",!0):d.value===m.attributes.xfaOff&&s.removeAttribute("checked"),g==="print")break;s.addEventListener("change",function(k){v.setValue(w,{value:k.target.checked?k.target.getAttribute("xfaOn"):k.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&s.setAttribute("value",d.value),g==="print")break;s.addEventListener("input",function(k){v.setValue(w,{value:k.target.value})})}break;case"select":if(d.value!==null){var f,y=_createForOfIteratorHelper(m.children);try{for(y.s();!(f=y.n()).done;){var x=f.value;x.attributes.value===d.value&&(x.attributes.selected=!0)}}catch(k){y.e(k)}finally{y.f()}}s.addEventListener("input",function(k){var P=k.target.options,S=P.selectedIndex===-1?"":P[P.selectedIndex].value;v.setValue(w,{value:S})})}}},{key:"setAttributes",value:function(s){var w=s.html,m=s.element,v=s.storage,g=v===void 0?null:v,d=s.intent,f=s.linkService,y=m.attributes,x=w instanceof HTMLAnchorElement;y.type==="radio"&&(y.name="".concat(y.name,"-").concat(d));for(var k=0,P=Object.entries(y);k<P.length;k++){var S=_slicedToArray(P[k],2),E=S[0],M=S[1];if(M!=null)switch(E){case"class":M.length&&w.setAttribute(E,M.join(" "));break;case"dataId":break;case"id":w.setAttribute("data-element-id",M);break;case"style":Object.assign(w.style,M);break;case"textContent":w.textContent=M;break;default:(!x||E!=="href"&&E!=="newWindow")&&w.setAttribute(E,M)}}x&&f.addLinkAttributes(w,y.href,y.newWindow),g&&y.dataId&&this.setupStorage(w,y.dataId,m,g)}},{key:"render",value:function(s){var w=s.annotationStorage,m=s.linkService,v=s.xfaHtml,g=s.intent||"display",d=document.createElement(v.name);v.attributes&&this.setAttributes({html:d,element:v,intent:g,linkService:m});var f=[[v,-1,d]],y=s.div;if(y.append(d),s.viewport){var x="matrix(".concat(s.viewport.transform.join(","),")");y.style.transform=x}g!=="richText"&&y.setAttribute("class","xfaLayer xfaFont");for(var k=[];f.length>0;){var P,S=_slicedToArray(f.at(-1),3),E=S[0],M=S[1],T=S[2];if(M+1!==E.children.length){var D=E.children[++f.at(-1)[1]];if(D!==null){var N=D.name;if(N!=="#text"){var I=void 0;if(I=D!=null&&(P=D.attributes)!==null&&P!==void 0&&P.xmlns?document.createElementNS(D.attributes.xmlns,N):document.createElement(N),T.append(I),D.attributes&&this.setAttributes({html:I,element:D,storage:w,intent:g,linkService:m}),D.children&&D.children.length>0)f.push([D,-1,I]);else if(D.value){var O=document.createTextNode(D.value);r.XfaText.shouldBuildText(N)&&k.push(O),I.append(O)}}else{var F=document.createTextNode(D.value);k.push(F),T.append(F)}}}else f.pop()}var q,Y=_createForOfIteratorHelper(y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"));try{for(Y.s();!(q=Y.n()).done;)q.value.setAttribute("readOnly",!0)}catch(_e){Y.e(_e)}finally{Y.f()}return{textDivs:k}}},{key:"update",value:function(s){var w="matrix(".concat(s.viewport.transform.join(","),")");s.div.style.transform=w,s.div.hidden=!1}}])}();n.XfaLayer=u},function(e,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var r=o(142),u=o(1),s=o(3),w=_createClass(function M(){_classCallCheck(this,M),(0,u.unreachable)("Not implemented: SVGGraphics")});n.SVGGraphics=w;var m=function(M){if(Number.isInteger(M))return M.toString();var T=M.toFixed(10),D=T.length-1;if(T[D]!=="0")return T;do D--;while(T[D]==="0");return T.substring(0,T[D]==="."?D:D+1)},v=function(M){if(M[4]===0&&M[5]===0){if(M[1]===0&&M[2]===0)return M[0]===1&&M[3]===1?"":"scale(".concat(m(M[0])," ").concat(m(M[3]),")");if(M[0]===M[3]&&M[1]===-M[2]){var T=180*Math.acos(M[0])/Math.PI;return"rotate(".concat(m(T),")")}}else if(M[0]===1&&M[1]===0&&M[2]===0&&M[3]===1)return"translate(".concat(m(M[4])," ").concat(m(M[5]),")");return"matrix(".concat(m(M[0])," ").concat(m(M[1])," ").concat(m(M[2])," ").concat(m(M[3])," ").concat(m(M[4])," ")+"".concat(m(M[5]),")")},g={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d=["butt","round","square"],f=["miter","round","bevel"],y=function(M){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",D=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(URL.createObjectURL&&typeof Blob<"u"&&!D)return URL.createObjectURL(new Blob([M],{type:T}));for(var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",I="data:".concat(T,";base64,"),O=0,F=M.length;O<F;O+=3){var q=255&M[O],Y=255&M[O+1],_e=255&M[O+2];I+=N[q>>2]+N[(3&q)<<4|Y>>4]+N[O+1<F?(15&Y)<<2|_e>>6:64]+N[O+2<F?63&_e:64]}return I},x=function(){for(var M=new Uint8Array([137,80,78,71,13,10,26,10]),T=new Int32Array(256),D=0;D<256;D++){for(var N=D,I=0;I<8;I++)N=1&N?3988292384^N>>1&2147483647:N>>1&2147483647;T[D]=N}function O(Y,_e,ne,ve){var J=ve,fe=_e.length;ne[J]=fe>>24&255,ne[J+1]=fe>>16&255,ne[J+2]=fe>>8&255,ne[J+3]=255&fe,ne[J+=4]=255&Y.charCodeAt(0),ne[J+1]=255&Y.charCodeAt(1),ne[J+2]=255&Y.charCodeAt(2),ne[J+3]=255&Y.charCodeAt(3),J+=4,ne.set(_e,J);var Z=function(j,X,H){for(var U=-1,te=X;te<H;te++){var Q=255&(U^j[te]);U=U>>>8^T[Q]}return~U}(ne,ve+4,J+=_e.length);ne[J]=Z>>24&255,ne[J+1]=Z>>16&255,ne[J+2]=Z>>8&255,ne[J+3]=255&Z}function F(Y){var _e=Y.length,ne=65535,ve=Math.ceil(_e/ne),J=new Uint8Array(2+_e+5*ve+4),fe=0;J[fe++]=120,J[fe++]=156;for(var Z=0;_e>ne;)J[fe++]=0,J[fe++]=255,J[fe++]=255,J[fe++]=0,J[fe++]=0,J.set(Y.subarray(Z,Z+ne),fe),fe+=ne,Z+=ne,_e-=ne;J[fe++]=1,J[fe++]=255&_e,J[fe++]=_e>>8&255,J[fe++]=255&~_e,J[fe++]=(65535&~_e)>>8&255,J.set(Y.subarray(Z),fe),fe+=Y.length-Z;var j=function(X,H,U){for(var te=1,Q=0,re=H;re<U;++re)Q=(Q+(te=(te+(255&X[re]))%65521))%65521;return Q<<16|te}(Y,0,Y.length);return J[fe++]=j>>24&255,J[fe++]=j>>16&255,J[fe++]=j>>8&255,J[fe++]=255&j,J}function q(Y,_e,ne,ve){var J,fe,Z,j=Y.width,X=Y.height,H=Y.data;switch(_e){case u.ImageKind.GRAYSCALE_1BPP:fe=0,J=1,Z=j+7>>3;break;case u.ImageKind.RGB_24BPP:fe=2,J=8,Z=3*j;break;case u.ImageKind.RGBA_32BPP:fe=6,J=8,Z=4*j;break;default:throw new Error("invalid format")}for(var U=new Uint8Array((1+Z)*X),te=0,Q=0,re=0;re<X;++re)U[te++]=0,U.set(H.subarray(Q,Q+Z),te),Q+=Z,te+=Z;if(_e===u.ImageKind.GRAYSCALE_1BPP&&ve){te=0;for(var Pe=0;Pe<X;Pe++){te++;for(var be=0;be<Z;be++)U[te++]^=255}}var we=new Uint8Array([j>>24&255,j>>16&255,j>>8&255,255&j,X>>24&255,X>>16&255,X>>8&255,255&X,J,fe,0,0,0]),Ae=function(Le){if(!s.isNodeJS)return F(Le);try{var le;le=parseInt(process.versions.node)>=8?Le:Buffer.from(Le);var oe=require$$0.deflateSync(le,{level:9});return oe instanceof Uint8Array?oe:new Uint8Array(oe)}catch(ke){(0,u.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ke)}return F(Le)}(U),$e=M.length+36+we.length+Ae.length,Me=new Uint8Array($e),Ie=0;return Me.set(M,Ie),O("IHDR",we,Me,Ie+=M.length),O("IDATA",Ae,Me,Ie+=12+we.length),Ie+=12+Ae.length,O("IEND",new Uint8Array(0),Me,Ie),y(Me,"image/png",ne)}return function(Y,_e,ne){return q(Y,Y.kind===void 0?u.ImageKind.GRAYSCALE_1BPP:Y.kind,_e,ne)}}(),k=function(){return _createClass(function M(){_classCallCheck(this,M),this.fontSizeScale=1,this.fontWeight=g.fontWeight,this.fontSize=0,this.textMatrix=u.IDENTITY_MATRIX,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=u.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=g.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""},[{key:"clone",value:function(){return Object.create(this)}},{key:"setCurrentPoint",value:function(M,T){this.x=M,this.y=T}}])}(),P=0,S=0,E=0;n.SVGGraphics=w=function(){return _createClass(function M(T,D){_classCallCheck(this,M);var N=arguments.length>2&&arguments[2]!==void 0&&arguments[2];for(var I in(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new k,this.transformMatrix=u.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=T,this.objs=D,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!N,this._operatorIdMapping=[],u.OPS)this._operatorIdMapping[u.OPS[I]]=I},[{key:"getObject",value:function(M){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof M=="string"?M.startsWith("g_")?this.commonObjs.get(M):this.objs.get(M):T}},{key:"save",value:function(){this.transformStack.push(this.transformMatrix);var M=this.current;this.extraStack.push(M),this.current=M.clone()}},{key:"restore",value:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}},{key:"group",value:function(M){this.save(),this.executeOpTree(M),this.restore()}},{key:"loadDependencies",value:function(M){for(var T=this,D=M.fnArray,N=M.argsArray,I=0,O=D.length;I<O;I++)if(D[I]===u.OPS.dependency){var F,q=_createForOfIteratorHelper(N[I]);try{var Y=function(){var _e=F.value,ne=_e.startsWith("g_")?T.commonObjs:T.objs,ve=new Promise(function(J){ne.get(_e,J)});T.current.dependencies.push(ve)};for(q.s();!(F=q.n()).done;)Y()}catch(_e){q.e(_e)}finally{q.f()}}return Promise.all(this.current.dependencies)}},{key:"transform",value:function(M,T,D,N,I,O){var F=[M,T,D,N,I,O];this.transformMatrix=u.Util.transform(this.transformMatrix,F),this.tgrp=null}},{key:"getSVG",value:function(M,T){var D=this;this.viewport=T;var N=this._initialize(T);return this.loadDependencies(M).then(function(){return D.transformMatrix=u.IDENTITY_MATRIX,D.executeOpTree(D.convertOpList(M)),N})}},{key:"convertOpList",value:function(M){for(var T=this._operatorIdMapping,D=M.argsArray,N=M.fnArray,I=[],O=0,F=N.length;O<F;O++){var q=N[O];I.push({fnId:q,fn:T[q],args:D[O]})}return function(Y){var _e,ne=[],ve=[],J=_createForOfIteratorHelper(Y);try{for(J.s();!(_e=J.n()).done;){var fe=_e.value;fe.fn!=="save"?fe.fn==="restore"?ne=ve.pop():ne.push(fe):(ne.push({fnId:92,fn:"group",items:[]}),ve.push(ne),ne=ne.at(-1).items)}}catch(Z){J.e(Z)}finally{J.f()}return ne}(I)}},{key:"executeOpTree",value:function(M){var T,D=_createForOfIteratorHelper(M);try{for(D.s();!(T=D.n()).done;){var N=T.value,I=N.fn,O=N.fnId,F=N.args;switch(0|O){case u.OPS.beginText:this.beginText();break;case u.OPS.dependency:break;case u.OPS.setLeading:this.setLeading(F);break;case u.OPS.setLeadingMoveText:this.setLeadingMoveText(F[0],F[1]);break;case u.OPS.setFont:this.setFont(F);break;case u.OPS.showText:case u.OPS.showSpacedText:this.showText(F[0]);break;case u.OPS.endText:this.endText();break;case u.OPS.moveText:this.moveText(F[0],F[1]);break;case u.OPS.setCharSpacing:this.setCharSpacing(F[0]);break;case u.OPS.setWordSpacing:this.setWordSpacing(F[0]);break;case u.OPS.setHScale:this.setHScale(F[0]);break;case u.OPS.setTextMatrix:this.setTextMatrix(F[0],F[1],F[2],F[3],F[4],F[5]);break;case u.OPS.setTextRise:this.setTextRise(F[0]);break;case u.OPS.setTextRenderingMode:this.setTextRenderingMode(F[0]);break;case u.OPS.setLineWidth:this.setLineWidth(F[0]);break;case u.OPS.setLineJoin:this.setLineJoin(F[0]);break;case u.OPS.setLineCap:this.setLineCap(F[0]);break;case u.OPS.setMiterLimit:this.setMiterLimit(F[0]);break;case u.OPS.setFillRGBColor:this.setFillRGBColor(F[0],F[1],F[2]);break;case u.OPS.setStrokeRGBColor:this.setStrokeRGBColor(F[0],F[1],F[2]);break;case u.OPS.setStrokeColorN:this.setStrokeColorN(F);break;case u.OPS.setFillColorN:this.setFillColorN(F);break;case u.OPS.shadingFill:this.shadingFill(F[0]);break;case u.OPS.setDash:this.setDash(F[0],F[1]);break;case u.OPS.setRenderingIntent:this.setRenderingIntent(F[0]);break;case u.OPS.setFlatness:this.setFlatness(F[0]);break;case u.OPS.setGState:this.setGState(F[0]);break;case u.OPS.fill:this.fill();break;case u.OPS.eoFill:this.eoFill();break;case u.OPS.stroke:this.stroke();break;case u.OPS.fillStroke:this.fillStroke();break;case u.OPS.eoFillStroke:this.eoFillStroke();break;case u.OPS.clip:this.clip("nonzero");break;case u.OPS.eoClip:this.clip("evenodd");break;case u.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case u.OPS.paintImageXObject:this.paintImageXObject(F[0]);break;case u.OPS.paintInlineImageXObject:this.paintInlineImageXObject(F[0]);break;case u.OPS.paintImageMaskXObject:this.paintImageMaskXObject(F[0]);break;case u.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(F[0],F[1]);break;case u.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case u.OPS.closePath:this.closePath();break;case u.OPS.closeStroke:this.closeStroke();break;case u.OPS.closeFillStroke:this.closeFillStroke();break;case u.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case u.OPS.nextLine:this.nextLine();break;case u.OPS.transform:this.transform(F[0],F[1],F[2],F[3],F[4],F[5]);break;case u.OPS.constructPath:this.constructPath(F[0],F[1]);break;case u.OPS.endPath:this.endPath();break;case 92:this.group(N.items);break;default:(0,u.warn)("Unimplemented operator ".concat(I))}}}catch(q){D.e(q)}finally{D.f()}}},{key:"setWordSpacing",value:function(M){this.current.wordSpacing=M}},{key:"setCharSpacing",value:function(M){this.current.charSpacing=M}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"setTextMatrix",value:function(M,T,D,N,I,O){var F=this.current;F.textMatrix=F.lineMatrix=[M,T,D,N,I,O],F.textMatrixScale=Math.hypot(M,T),F.x=F.lineX=0,F.y=F.lineY=0,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size","".concat(m(F.fontSize),"px")),F.tspan.setAttributeNS(null,"y",m(-F.y)),F.txtElement=this.svgFactory.createElement("svg:text"),F.txtElement.append(F.tspan)}},{key:"beginText",value:function(){var M=this.current;M.x=M.lineX=0,M.y=M.lineY=0,M.textMatrix=u.IDENTITY_MATRIX,M.lineMatrix=u.IDENTITY_MATRIX,M.textMatrixScale=1,M.tspan=this.svgFactory.createElement("svg:tspan"),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtgrp=this.svgFactory.createElement("svg:g"),M.xcoords=[],M.ycoords=[]}},{key:"moveText",value:function(M,T){var D=this.current;D.x=D.lineX+=M,D.y=D.lineY+=T,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size","".concat(m(D.fontSize),"px")),D.tspan.setAttributeNS(null,"y",m(-D.y))}},{key:"showText",value:function(M){var T=this.current,D=T.font,N=T.fontSize;if(N!==0){var I,O=T.fontSizeScale,F=T.charSpacing,q=T.wordSpacing,Y=T.fontDirection,_e=T.textHScale*Y,ne=D.vertical,ve=ne?1:-1,J=D.defaultVMetrics,fe=N*T.fontMatrix[0],Z=0,j=_createForOfIteratorHelper(M);try{for(j.s();!(I=j.n()).done;){var X=I.value;if(X!==null)if(typeof X!="number"){var H=(X.isSpace?q:0)+F,U=X.fontChar,te=void 0,Q=void 0,re=X.width;if(ne){var Pe=void 0,be=X.vmetric||J;Pe=-(Pe=X.vmetric?be[1]:.5*re)*fe;var we=be[2]*fe;re=be?-be[0]:re,te=Pe/O,Q=(Z+we)/O}else te=Z/O,Q=0;(X.isInFont||D.missingFile)&&(T.xcoords.push(T.x+te),ne&&T.ycoords.push(-T.y+Q),T.tspan.textContent+=U),Z+=ne?re*fe-H*Y:re*fe+H*Y}else Z+=ve*X*N/1e3;else Z+=Y*q}}catch(Ie){j.e(Ie)}finally{j.f()}T.tspan.setAttributeNS(null,"x",T.xcoords.map(m).join(" ")),ne?T.tspan.setAttributeNS(null,"y",T.ycoords.map(m).join(" ")):T.tspan.setAttributeNS(null,"y",m(-T.y)),ne?T.y-=Z:T.x+=Z*_e,T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size","".concat(m(T.fontSize),"px")),T.fontStyle!==g.fontStyle&&T.tspan.setAttributeNS(null,"font-style",T.fontStyle),T.fontWeight!==g.fontWeight&&T.tspan.setAttributeNS(null,"font-weight",T.fontWeight);var Ae=T.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;if(Ae===u.TextRenderingMode.FILL||Ae===u.TextRenderingMode.FILL_STROKE?(T.fillColor!==g.fillColor&&T.tspan.setAttributeNS(null,"fill",T.fillColor),T.fillAlpha<1&&T.tspan.setAttributeNS(null,"fill-opacity",T.fillAlpha)):T.textRenderingMode===u.TextRenderingMode.ADD_TO_PATH?T.tspan.setAttributeNS(null,"fill","transparent"):T.tspan.setAttributeNS(null,"fill","none"),Ae===u.TextRenderingMode.STROKE||Ae===u.TextRenderingMode.FILL_STROKE){var $e=1/(T.textMatrixScale||1);this._setStrokeAttributes(T.tspan,$e)}var Me=T.textMatrix;T.textRise!==0&&((Me=Me.slice())[5]+=T.textRise),T.txtElement.setAttributeNS(null,"transform","".concat(v(Me)," scale(").concat(m(_e),", -1)")),T.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),T.txtElement.append(T.tspan),T.txtgrp.append(T.txtElement),this._ensureTransformGroup().append(T.txtElement)}}},{key:"setLeadingMoveText",value:function(M,T){this.setLeading(-T),this.moveText(M,T)}},{key:"addFontStyle",value:function(M){if(!M.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));var T=y(M.data,M.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(M.loadedName,'";')+" src: url(".concat(T,`); }
`)}},{key:"setFont",value:function(M){var T=this.current,D=this.commonObjs.get(M[0]),N=M[1];T.font=D,!this.embedFonts||D.missingFile||this.embeddedFonts[D.loadedName]||(this.addFontStyle(D),this.embeddedFonts[D.loadedName]=D),T.fontMatrix=D.fontMatrix||u.FONT_IDENTITY_MATRIX;var I="normal";D.black?I="900":D.bold&&(I="bold");var O=D.italic?"italic":"normal";N<0?(N=-N,T.fontDirection=-1):T.fontDirection=1,T.fontSize=N,T.fontFamily=D.loadedName,T.fontWeight=I,T.fontStyle=O,T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"y",m(-T.y)),T.xcoords=[],T.ycoords=[]}},{key:"endText",value:function(){var M,T=this.current;T.textRenderingMode&u.TextRenderingMode.ADD_TO_PATH_FLAG&&(M=T.txtElement)!==null&&M!==void 0&&M.hasChildNodes()&&(T.element=T.txtElement,this.clip("nonzero"),this.endPath())}},{key:"setLineWidth",value:function(M){M>0&&(this.current.lineWidth=M)}},{key:"setLineCap",value:function(M){this.current.lineCap=d[M]}},{key:"setLineJoin",value:function(M){this.current.lineJoin=f[M]}},{key:"setMiterLimit",value:function(M){this.current.miterLimit=M}},{key:"setStrokeAlpha",value:function(M){this.current.strokeAlpha=M}},{key:"setStrokeRGBColor",value:function(M,T,D){this.current.strokeColor=u.Util.makeHexColor(M,T,D)}},{key:"setFillAlpha",value:function(M){this.current.fillAlpha=M}},{key:"setFillRGBColor",value:function(M,T,D){this.current.fillColor=u.Util.makeHexColor(M,T,D),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}},{key:"setStrokeColorN",value:function(M){this.current.strokeColor=this._makeColorN_Pattern(M)}},{key:"setFillColorN",value:function(M){this.current.fillColor=this._makeColorN_Pattern(M)}},{key:"shadingFill",value:function(M){var T=this.viewport.width,D=this.viewport.height,N=u.Util.inverseTransform(this.transformMatrix),I=u.Util.applyTransform([0,0],N),O=u.Util.applyTransform([0,D],N),F=u.Util.applyTransform([T,0],N),q=u.Util.applyTransform([T,D],N),Y=Math.min(I[0],O[0],F[0],q[0]),_e=Math.min(I[1],O[1],F[1],q[1]),ne=Math.max(I[0],O[0],F[0],q[0]),ve=Math.max(I[1],O[1],F[1],q[1]),J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x",Y),J.setAttributeNS(null,"y",_e),J.setAttributeNS(null,"width",ne-Y),J.setAttributeNS(null,"height",ve-_e),J.setAttributeNS(null,"fill",this._makeShadingPattern(M)),this.current.fillAlpha<1&&J.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(J)}},{key:"_makeColorN_Pattern",value:function(M){return M[0]==="TilingPattern"?this._makeTilingPattern(M):this._makeShadingPattern(M)}},{key:"_makeTilingPattern",value:function(M){var T=M[1],D=M[2],N=M[3]||u.IDENTITY_MATRIX,I=_slicedToArray(M[4],4),O=I[0],F=I[1],q=I[2],Y=I[3],_e=M[5],ne=M[6],ve=M[7],J="shading".concat(E++),fe=_slicedToArray(u.Util.normalizeRect([].concat(_toConsumableArray$1(u.Util.applyTransform([O,F],N)),_toConsumableArray$1(u.Util.applyTransform([q,Y],N)))),4),Z=fe[0],j=fe[1],X=fe[2],H=fe[3],U=_slicedToArray(u.Util.singularValueDecompose2dScale(N),2),te=_e*U[0],Q=ne*U[1],re=this.svgFactory.createElement("svg:pattern");re.setAttributeNS(null,"id",J),re.setAttributeNS(null,"patternUnits","userSpaceOnUse"),re.setAttributeNS(null,"width",te),re.setAttributeNS(null,"height",Q),re.setAttributeNS(null,"x","".concat(Z)),re.setAttributeNS(null,"y","".concat(j));var Pe=this.svg,be=this.transformMatrix,we=this.current.fillColor,Ae=this.current.strokeColor,$e=this.svgFactory.create(X-Z,H-j);if(this.svg=$e,this.transformMatrix=N,ve===2){var Me,Ie=(Me=u.Util).makeHexColor.apply(Me,_toConsumableArray$1(T));this.current.fillColor=Ie,this.current.strokeColor=Ie}return this.executeOpTree(this.convertOpList(D)),this.svg=Pe,this.transformMatrix=be,this.current.fillColor=we,this.current.strokeColor=Ae,re.append($e.childNodes[0]),this.defs.append(re),"url(#".concat(J,")")}},{key:"_makeShadingPattern",value:function(M){switch(typeof M=="string"&&(M=this.objs.get(M)),M[0]){case"RadialAxial":var T,D="shading".concat(E++),N=M[3];switch(M[1]){case"axial":var I=M[4],O=M[5];(T=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",D),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"x1",I[0]),T.setAttributeNS(null,"y1",I[1]),T.setAttributeNS(null,"x2",O[0]),T.setAttributeNS(null,"y2",O[1]);break;case"radial":var F=M[4],q=M[5],Y=M[6],_e=M[7];(T=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",D),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"cx",q[0]),T.setAttributeNS(null,"cy",q[1]),T.setAttributeNS(null,"r",_e),T.setAttributeNS(null,"fx",F[0]),T.setAttributeNS(null,"fy",F[1]),T.setAttributeNS(null,"fr",Y);break;default:throw new Error("Unknown RadialAxial type: ".concat(M[1]))}var ne,ve=_createForOfIteratorHelper(N);try{for(ve.s();!(ne=ve.n()).done;){var J=ne.value,fe=this.svgFactory.createElement("svg:stop");fe.setAttributeNS(null,"offset",J[0]),fe.setAttributeNS(null,"stop-color",J[1]),T.append(fe)}}catch(Z){ve.e(Z)}finally{ve.f()}return this.defs.append(T),"url(#".concat(D,")");case"Mesh":return(0,u.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(M[0]))}}},{key:"setDash",value:function(M,T){this.current.dashArray=M,this.current.dashPhase=T}},{key:"constructPath",value:function(M,T){var D,N=this.current,I=N.x,O=N.y,F=[],q=0,Y=_createForOfIteratorHelper(M);try{for(Y.s();!(D=Y.n()).done;)switch(0|D.value){case u.OPS.rectangle:I=T[q++],O=T[q++];var _e=T[q++],ne=T[q++],ve=I+_e,J=O+ne;F.push("M",m(I),m(O),"L",m(ve),m(O),"L",m(ve),m(J),"L",m(I),m(J),"Z");break;case u.OPS.moveTo:I=T[q++],O=T[q++],F.push("M",m(I),m(O));break;case u.OPS.lineTo:I=T[q++],O=T[q++],F.push("L",m(I),m(O));break;case u.OPS.curveTo:I=T[q+4],O=T[q+5],F.push("C",m(T[q]),m(T[q+1]),m(T[q+2]),m(T[q+3]),m(I),m(O)),q+=6;break;case u.OPS.curveTo2:F.push("C",m(I),m(O),m(T[q]),m(T[q+1]),m(T[q+2]),m(T[q+3])),I=T[q+2],O=T[q+3],q+=4;break;case u.OPS.curveTo3:I=T[q+2],O=T[q+3],F.push("C",m(T[q]),m(T[q+1]),m(I),m(O),m(I),m(O)),q+=4;break;case u.OPS.closePath:F.push("Z")}}catch(fe){Y.e(fe)}finally{Y.f()}F=F.join(" "),N.path&&M.length>0&&M[0]!==u.OPS.rectangle&&M[0]!==u.OPS.moveTo?F=N.path.getAttributeNS(null,"d")+F:(N.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(N.path)),N.path.setAttributeNS(null,"d",F),N.path.setAttributeNS(null,"fill","none"),N.element=N.path,N.setCurrentPoint(I,O)}},{key:"endPath",value:function(){var M=this.current;if(M.path=null,this.pendingClip)if(M.element){var T="clippath".concat(P++),D=this.svgFactory.createElement("svg:clipPath");D.setAttributeNS(null,"id",T),D.setAttributeNS(null,"transform",v(this.transformMatrix));var N=M.element.cloneNode(!0);if(this.pendingClip==="evenodd"?N.setAttributeNS(null,"clip-rule","evenodd"):N.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,D.append(N),this.defs.append(D),M.activeClipUrl){M.clipGroup=null;var I,O=_createForOfIteratorHelper(this.extraStack);try{for(O.s();!(I=O.n()).done;)I.value.clipGroup=null}catch(F){O.e(F)}finally{O.f()}D.setAttributeNS(null,"clip-path",M.activeClipUrl)}M.activeClipUrl="url(#".concat(T,")"),this.tgrp=null}else this.pendingClip=null}},{key:"clip",value:function(M){this.pendingClip=M}},{key:"closePath",value:function(){var M=this.current;if(M.path){var T="".concat(M.path.getAttributeNS(null,"d"),"Z");M.path.setAttributeNS(null,"d",T)}}},{key:"setLeading",value:function(M){this.current.leading=-M}},{key:"setTextRise",value:function(M){this.current.textRise=M}},{key:"setTextRenderingMode",value:function(M){this.current.textRenderingMode=M}},{key:"setHScale",value:function(M){this.current.textHScale=M/100}},{key:"setRenderingIntent",value:function(M){}},{key:"setFlatness",value:function(M){}},{key:"setGState",value:function(M){var T,D=_createForOfIteratorHelper(M);try{for(D.s();!(T=D.n()).done;){var N=_slicedToArray(T.value,2),I=N[0],O=N[1];switch(I){case"LW":this.setLineWidth(O);break;case"LC":this.setLineCap(O);break;case"LJ":this.setLineJoin(O);break;case"ML":this.setMiterLimit(O);break;case"D":this.setDash(O[0],O[1]);break;case"RI":this.setRenderingIntent(O);break;case"FL":this.setFlatness(O);break;case"Font":this.setFont(O);break;case"CA":this.setStrokeAlpha(O);break;case"ca":this.setFillAlpha(O);break;default:(0,u.warn)("Unimplemented graphic state operator ".concat(I))}}}catch(F){D.e(F)}finally{D.f()}}},{key:"fill",value:function(){var M=this.current;M.element&&(M.element.setAttributeNS(null,"fill",M.fillColor),M.element.setAttributeNS(null,"fill-opacity",M.fillAlpha),this.endPath())}},{key:"stroke",value:function(){var M=this.current;M.element&&(this._setStrokeAttributes(M.element),M.element.setAttributeNS(null,"fill","none"),this.endPath())}},{key:"_setStrokeAttributes",value:function(M){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,D=this.current,N=D.dashArray;T!==1&&N.length>0&&(N=N.map(function(I){return T*I})),M.setAttributeNS(null,"stroke",D.strokeColor),M.setAttributeNS(null,"stroke-opacity",D.strokeAlpha),M.setAttributeNS(null,"stroke-miterlimit",m(D.miterLimit)),M.setAttributeNS(null,"stroke-linecap",D.lineCap),M.setAttributeNS(null,"stroke-linejoin",D.lineJoin),M.setAttributeNS(null,"stroke-width",m(T*D.lineWidth)+"px"),M.setAttributeNS(null,"stroke-dasharray",N.map(m).join(" ")),M.setAttributeNS(null,"stroke-dashoffset",m(T*D.dashPhase)+"px")}},{key:"eoFill",value:function(){var M;(M=this.current.element)===null||M===void 0||M.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}},{key:"fillStroke",value:function(){this.stroke(),this.fill()}},{key:"eoFillStroke",value:function(){var M;(M=this.current.element)===null||M===void 0||M.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.closePath(),this.eoFillStroke()}},{key:"paintSolidColorImageMask",value:function(){var M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width","1px"),M.setAttributeNS(null,"height","1px"),M.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(M)}},{key:"paintImageXObject",value:function(M){var T=this.getObject(M);T?this.paintInlineImageXObject(T):(0,u.warn)("Dependent image with object ID ".concat(M," is not ready yet"))}},{key:"paintInlineImageXObject",value:function(M,T){var D=M.width,N=M.height,I=x(M,this.forceDataSchema,!!T),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",m(D)),O.setAttributeNS(null,"height",m(N)),this.current.element=O,this.clip("nonzero");var F=this.svgFactory.createElement("svg:image");F.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",I),F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y",m(-N)),F.setAttributeNS(null,"width",m(D)+"px"),F.setAttributeNS(null,"height",m(N)+"px"),F.setAttributeNS(null,"transform","scale(".concat(m(1/D)," ").concat(m(-1/N),")")),T?T.append(F):this._ensureTransformGroup().append(F)}},{key:"paintImageMaskXObject",value:function(M){var T=this.getObject(M.data,M);if(T.bitmap)(0,u.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");else{var D=this.current,N=T.width,I=T.height,O=D.fillColor;D.maskId="mask".concat(S++);var F=this.svgFactory.createElement("svg:mask");F.setAttributeNS(null,"id",D.maskId);var q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y","0"),q.setAttributeNS(null,"width",m(N)),q.setAttributeNS(null,"height",m(I)),q.setAttributeNS(null,"fill",O),q.setAttributeNS(null,"mask","url(#".concat(D.maskId,")")),this.defs.append(F),this._ensureTransformGroup().append(q),this.paintInlineImageXObject(T,F)}}},{key:"paintFormXObjectBegin",value:function(M,T){if(Array.isArray(M)&&M.length===6&&this.transform(M[0],M[1],M[2],M[3],M[4],M[5]),T){var D=T[2]-T[0],N=T[3]-T[1],I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",T[0]),I.setAttributeNS(null,"y",T[1]),I.setAttributeNS(null,"width",m(D)),I.setAttributeNS(null,"height",m(N)),this.current.element=I,this.clip("nonzero"),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){}},{key:"_initialize",value:function(M){var T=this.svgFactory.create(M.width,M.height),D=this.svgFactory.createElement("svg:defs");T.append(D),this.defs=D;var N=this.svgFactory.createElement("svg:g");return N.setAttributeNS(null,"transform",v(M.transform)),T.append(N),this.svg=N,T}},{key:"_ensureClipGroup",value:function(){if(!this.current.clipGroup){var M=this.svgFactory.createElement("svg:g");M.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(M),this.current.clipGroup=M}return this.current.clipGroup}},{key:"_ensureTransformGroup",value:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}])}()}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var n=__webpack_module_cache__[e];if(n!==void 0)return n.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__w_pdfjs_require__),o.exports}var __webpack_exports__={};return function(){var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return s.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return w.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return m.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return v.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return o.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return o.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return g.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return d.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return o.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return o.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return u.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return o.version}});var n=__w_pdfjs_require__(1),o=__w_pdfjs_require__(138),r=__w_pdfjs_require__(142),u=__w_pdfjs_require__(161),s=__w_pdfjs_require__(162),w=__w_pdfjs_require__(141),m=__w_pdfjs_require__(167),v=__w_pdfjs_require__(149),g=__w_pdfjs_require__(170),d=__w_pdfjs_require__(169)}(),__webpack_exports__}()},module.exports=factory()})(pdf);var cryptoJsExports={},cryptoJs={get exports(){return cryptoJsExports},set exports(e){cryptoJsExports=e}},coreExports={},core$1={get exports(){return coreExports},set exports(e){coreExports=e}},hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,core$1.exports=function(){var e=e||function(n,o){var r;if(typeof window<"u"&&window.crypto&&(r=window.crypto),typeof self<"u"&&self.crypto&&(r=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(r=globalThis.crypto),!r&&typeof window<"u"&&window.msCrypto&&(r=window.msCrypto),!r&&commonjsGlobal$1!==void 0&&commonjsGlobal$1.crypto&&(r=commonjsGlobal$1.crypto),!r&&typeof commonjsRequire=="function")try{r=require$$0}catch{}var u=function(){if(r){if(typeof r.getRandomValues=="function")try{return r.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof r.randomBytes=="function")try{return r.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function S(){}return function(E){var M;return S.prototype=E,M=new S,S.prototype=null,M}}(),w={},m=w.lib={},v=m.Base={extend:function(S){var E=s(this);return S&&E.mixIn(S),E.hasOwnProperty("init")&&this.init!==E.init||(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var S=this.extend();return S.init.apply(S,arguments),S},init:function(){},mixIn:function(S){for(var E in S)S.hasOwnProperty(E)&&(this[E]=S[E]);S.hasOwnProperty("toString")&&(this.toString=S.toString)},clone:function(){return this.init.prototype.extend(this)}},g=m.WordArray=v.extend({init:function(S,E){S=this.words=S||[],this.sigBytes=E!=o?E:4*S.length},toString:function(S){return(S||f).stringify(this)},concat:function(S){var E=this.words,M=S.words,T=this.sigBytes,D=S.sigBytes;if(this.clamp(),T%4)for(var N=0;N<D;N++){var I=M[N>>>2]>>>24-N%4*8&255;E[T+N>>>2]|=I<<24-(T+N)%4*8}else for(var O=0;O<D;O+=4)E[T+O>>>2]=M[O>>>2];return this.sigBytes+=D,this},clamp:function(){var S=this.words,E=this.sigBytes;S[E>>>2]&=4294967295<<32-E%4*8,S.length=n.ceil(E/4)},clone:function(){var S=v.clone.call(this);return S.words=this.words.slice(0),S},random:function(S){for(var E=[],M=0;M<S;M+=4)E.push(u());return new g.init(E,S)}}),d=w.enc={},f=d.Hex={stringify:function(S){for(var E=S.words,M=S.sigBytes,T=[],D=0;D<M;D++){var N=E[D>>>2]>>>24-D%4*8&255;T.push((N>>>4).toString(16)),T.push((15&N).toString(16))}return T.join("")},parse:function(S){for(var E=S.length,M=[],T=0;T<E;T+=2)M[T>>>3]|=parseInt(S.substr(T,2),16)<<24-T%8*4;return new g.init(M,E/2)}},y=d.Latin1={stringify:function(S){for(var E=S.words,M=S.sigBytes,T=[],D=0;D<M;D++){var N=E[D>>>2]>>>24-D%4*8&255;T.push(String.fromCharCode(N))}return T.join("")},parse:function(S){for(var E=S.length,M=[],T=0;T<E;T++)M[T>>>2]|=(255&S.charCodeAt(T))<<24-T%4*8;return new g.init(M,E)}},x=d.Utf8={stringify:function(S){try{return decodeURIComponent(escape(y.stringify(S)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(S){return y.parse(unescape(encodeURIComponent(S)))}},k=m.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(S){typeof S=="string"&&(S=x.parse(S)),this._data.concat(S),this._nDataBytes+=S.sigBytes},_process:function(S){var E,M=this._data,T=M.words,D=M.sigBytes,N=this.blockSize,I=D/(4*N),O=(I=S?n.ceil(I):n.max((0|I)-this._minBufferSize,0))*N,F=n.min(4*O,D);if(O){for(var q=0;q<O;q+=N)this._doProcessBlock(T,q);E=T.splice(0,O),M.sigBytes-=F}return new g.init(E,F)},clone:function(){var S=v.clone.call(this);return S._data=this._data.clone(),S},_minBufferSize:0});m.Hasher=k.extend({cfg:v.extend(),init:function(S){this.cfg=this.cfg.extend(S),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(S){return this._append(S),this._process(),this},finalize:function(S){return S&&this._append(S),this._doFinalize()},blockSize:16,_createHelper:function(S){return function(E,M){return new S.init(M).finalize(E)}},_createHmacHelper:function(S){return function(E,M){return new P.HMAC.init(S,M).finalize(E)}}});var P=w.algo={};return w}(Math);return e}()),coreExports}var x64CoreExports={},x64Core={get exports(){return x64CoreExports},set exports(e){x64CoreExports=e}},hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,x64Core.exports=function(e){return function(n){var o=e,r=o.lib,u=r.Base,s=r.WordArray,w=o.x64={};w.Word=u.extend({init:function(m,v){this.high=m,this.low=v}}),w.WordArray=u.extend({init:function(m,v){m=this.words=m||[],this.sigBytes=v!=n?v:8*m.length},toX32:function(){for(var m=this.words,v=m.length,g=[],d=0;d<v;d++){var f=m[d];g.push(f.high),g.push(f.low)}return s.create(g,this.sigBytes)},clone:function(){for(var m=u.clone.call(this),v=m.words=this.words.slice(0),g=v.length,d=0;d<g;d++)v[d]=v[d].clone();return m}})}(),e}(requireCore())),x64CoreExports}var libTypedarraysExports={},libTypedarrays={get exports(){return libTypedarraysExports},set exports(e){libTypedarraysExports=e}},hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,libTypedarrays.exports=function(e){return function(){if(typeof ArrayBuffer=="function"){var n=e.lib.WordArray,o=n.init,r=n.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var s=u.byteLength,w=[],m=0;m<s;m++)w[m>>>2]|=u[m]<<24-m%4*8;o.call(this,w,s)}else o.apply(this,arguments)};r.prototype=n}}(),e.lib.WordArray}(requireCore())),libTypedarraysExports}var encUtf16Exports={},encUtf16={get exports(){return encUtf16Exports},set exports(e){encUtf16Exports=e}},hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,encUtf16.exports=function(e){return function(){var n=e,o=n.lib.WordArray,r=n.enc;function u(s){return s<<8&4278255360|s>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(s){for(var w=s.words,m=s.sigBytes,v=[],g=0;g<m;g+=2){var d=w[g>>>2]>>>16-g%4*8&65535;v.push(String.fromCharCode(d))}return v.join("")},parse:function(s){for(var w=s.length,m=[],v=0;v<w;v++)m[v>>>1]|=s.charCodeAt(v)<<16-v%2*16;return o.create(m,2*w)}},r.Utf16LE={stringify:function(s){for(var w=s.words,m=s.sigBytes,v=[],g=0;g<m;g+=2){var d=u(w[g>>>2]>>>16-g%4*8&65535);v.push(String.fromCharCode(d))}return v.join("")},parse:function(s){for(var w=s.length,m=[],v=0;v<w;v++)m[v>>>1]|=u(s.charCodeAt(v)<<16-v%2*16);return o.create(m,2*w)}}}(),e.enc.Utf16}(requireCore())),encUtf16Exports}var encBase64Exports={},encBase64={get exports(){return encBase64Exports},set exports(e){encBase64Exports=e}},hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,encBase64.exports=function(e){return function(){var n=e,o=n.lib.WordArray;function r(u,s,w){for(var m=[],v=0,g=0;g<s;g++)if(g%4){var d=w[u.charCodeAt(g-1)]<<g%4*2|w[u.charCodeAt(g)]>>>6-g%4*2;m[v>>>2]|=d<<24-v%4*8,v++}return o.create(m,v)}n.enc.Base64={stringify:function(u){var s=u.words,w=u.sigBytes,m=this._map;u.clamp();for(var v=[],g=0;g<w;g+=3)for(var d=(s[g>>>2]>>>24-g%4*8&255)<<16|(s[g+1>>>2]>>>24-(g+1)%4*8&255)<<8|s[g+2>>>2]>>>24-(g+2)%4*8&255,f=0;f<4&&g+.75*f<w;f++)v.push(m.charAt(d>>>6*(3-f)&63));var y=m.charAt(64);if(y)for(;v.length%4;)v.push(y);return v.join("")},parse:function(u){var s=u.length,w=this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var v=0;v<w.length;v++)m[w.charCodeAt(v)]=v}var g=w.charAt(64);if(g){var d=u.indexOf(g);d!==-1&&(s=d)}return r(u,s,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(requireCore())),encBase64Exports}var encBase64urlExports={},encBase64url={get exports(){return encBase64urlExports},set exports(e){encBase64urlExports=e}},hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,encBase64url.exports=function(e){return function(){var n=e,o=n.lib.WordArray;function r(u,s,w){for(var m=[],v=0,g=0;g<s;g++)if(g%4){var d=w[u.charCodeAt(g-1)]<<g%4*2|w[u.charCodeAt(g)]>>>6-g%4*2;m[v>>>2]|=d<<24-v%4*8,v++}return o.create(m,v)}n.enc.Base64url={stringify:function(u,s){s===void 0&&(s=!0);var w=u.words,m=u.sigBytes,v=s?this._safe_map:this._map;u.clamp();for(var g=[],d=0;d<m;d+=3)for(var f=(w[d>>>2]>>>24-d%4*8&255)<<16|(w[d+1>>>2]>>>24-(d+1)%4*8&255)<<8|w[d+2>>>2]>>>24-(d+2)%4*8&255,y=0;y<4&&d+.75*y<m;y++)g.push(v.charAt(f>>>6*(3-y)&63));var x=v.charAt(64);if(x)for(;g.length%4;)g.push(x);return g.join("")},parse:function(u,s){s===void 0&&(s=!0);var w=u.length,m=s?this._safe_map:this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var g=0;g<m.length;g++)v[m.charCodeAt(g)]=g}var d=m.charAt(64);if(d){var f=u.indexOf(d);f!==-1&&(w=f)}return r(u,w,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url}(requireCore())),encBase64urlExports}var md5Exports={},md5={get exports(){return md5Exports},set exports(e){md5Exports=e}},hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,md5.exports=function(e){return function(n){var o=e,r=o.lib,u=r.WordArray,s=r.Hasher,w=o.algo,m=[];(function(){for(var x=0;x<64;x++)m[x]=4294967296*n.abs(n.sin(x+1))|0})();var v=w.MD5=s.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,k){for(var P=0;P<16;P++){var S=k+P,E=x[S];x[S]=16711935&(E<<8|E>>>24)|4278255360&(E<<24|E>>>8)}var M=this._hash.words,T=x[k+0],D=x[k+1],N=x[k+2],I=x[k+3],O=x[k+4],F=x[k+5],q=x[k+6],Y=x[k+7],_e=x[k+8],ne=x[k+9],ve=x[k+10],J=x[k+11],fe=x[k+12],Z=x[k+13],j=x[k+14],X=x[k+15],H=M[0],U=M[1],te=M[2],Q=M[3];H=g(H,U,te,Q,T,7,m[0]),Q=g(Q,H,U,te,D,12,m[1]),te=g(te,Q,H,U,N,17,m[2]),U=g(U,te,Q,H,I,22,m[3]),H=g(H,U,te,Q,O,7,m[4]),Q=g(Q,H,U,te,F,12,m[5]),te=g(te,Q,H,U,q,17,m[6]),U=g(U,te,Q,H,Y,22,m[7]),H=g(H,U,te,Q,_e,7,m[8]),Q=g(Q,H,U,te,ne,12,m[9]),te=g(te,Q,H,U,ve,17,m[10]),U=g(U,te,Q,H,J,22,m[11]),H=g(H,U,te,Q,fe,7,m[12]),Q=g(Q,H,U,te,Z,12,m[13]),te=g(te,Q,H,U,j,17,m[14]),H=d(H,U=g(U,te,Q,H,X,22,m[15]),te,Q,D,5,m[16]),Q=d(Q,H,U,te,q,9,m[17]),te=d(te,Q,H,U,J,14,m[18]),U=d(U,te,Q,H,T,20,m[19]),H=d(H,U,te,Q,F,5,m[20]),Q=d(Q,H,U,te,ve,9,m[21]),te=d(te,Q,H,U,X,14,m[22]),U=d(U,te,Q,H,O,20,m[23]),H=d(H,U,te,Q,ne,5,m[24]),Q=d(Q,H,U,te,j,9,m[25]),te=d(te,Q,H,U,I,14,m[26]),U=d(U,te,Q,H,_e,20,m[27]),H=d(H,U,te,Q,Z,5,m[28]),Q=d(Q,H,U,te,N,9,m[29]),te=d(te,Q,H,U,Y,14,m[30]),H=f(H,U=d(U,te,Q,H,fe,20,m[31]),te,Q,F,4,m[32]),Q=f(Q,H,U,te,_e,11,m[33]),te=f(te,Q,H,U,J,16,m[34]),U=f(U,te,Q,H,j,23,m[35]),H=f(H,U,te,Q,D,4,m[36]),Q=f(Q,H,U,te,O,11,m[37]),te=f(te,Q,H,U,Y,16,m[38]),U=f(U,te,Q,H,ve,23,m[39]),H=f(H,U,te,Q,Z,4,m[40]),Q=f(Q,H,U,te,T,11,m[41]),te=f(te,Q,H,U,I,16,m[42]),U=f(U,te,Q,H,q,23,m[43]),H=f(H,U,te,Q,ne,4,m[44]),Q=f(Q,H,U,te,fe,11,m[45]),te=f(te,Q,H,U,X,16,m[46]),H=y(H,U=f(U,te,Q,H,N,23,m[47]),te,Q,T,6,m[48]),Q=y(Q,H,U,te,Y,10,m[49]),te=y(te,Q,H,U,j,15,m[50]),U=y(U,te,Q,H,F,21,m[51]),H=y(H,U,te,Q,fe,6,m[52]),Q=y(Q,H,U,te,I,10,m[53]),te=y(te,Q,H,U,ve,15,m[54]),U=y(U,te,Q,H,D,21,m[55]),H=y(H,U,te,Q,_e,6,m[56]),Q=y(Q,H,U,te,X,10,m[57]),te=y(te,Q,H,U,q,15,m[58]),U=y(U,te,Q,H,Z,21,m[59]),H=y(H,U,te,Q,O,6,m[60]),Q=y(Q,H,U,te,J,10,m[61]),te=y(te,Q,H,U,N,15,m[62]),U=y(U,te,Q,H,ne,21,m[63]),M[0]=M[0]+H|0,M[1]=M[1]+U|0,M[2]=M[2]+te|0,M[3]=M[3]+Q|0},_doFinalize:function(){var x=this._data,k=x.words,P=8*this._nDataBytes,S=8*x.sigBytes;k[S>>>5]|=128<<24-S%32;var E=n.floor(P/4294967296),M=P;k[15+(S+64>>>9<<4)]=16711935&(E<<8|E>>>24)|4278255360&(E<<24|E>>>8),k[14+(S+64>>>9<<4)]=16711935&(M<<8|M>>>24)|4278255360&(M<<24|M>>>8),x.sigBytes=4*(k.length+1),this._process();for(var T=this._hash,D=T.words,N=0;N<4;N++){var I=D[N];D[N]=16711935&(I<<8|I>>>24)|4278255360&(I<<24|I>>>8)}return T},clone:function(){var x=s.clone.call(this);return x._hash=this._hash.clone(),x}});function g(x,k,P,S,E,M,T){var D=x+(k&P|~k&S)+E+T;return(D<<M|D>>>32-M)+k}function d(x,k,P,S,E,M,T){var D=x+(k&S|P&~S)+E+T;return(D<<M|D>>>32-M)+k}function f(x,k,P,S,E,M,T){var D=x+(k^P^S)+E+T;return(D<<M|D>>>32-M)+k}function y(x,k,P,S,E,M,T){var D=x+(P^(k|~S))+E+T;return(D<<M|D>>>32-M)+k}o.MD5=s._createHelper(v),o.HmacMD5=s._createHmacHelper(v)}(Math),e.MD5}(requireCore())),md5Exports}var sha1Exports={},sha1={get exports(){return sha1Exports},set exports(e){sha1Exports=e}},hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,sha1.exports=function(e){return function(){var n=e,o=n.lib,r=o.WordArray,u=o.Hasher,s=n.algo,w=[],m=s.SHA1=u.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,g){for(var d=this._hash.words,f=d[0],y=d[1],x=d[2],k=d[3],P=d[4],S=0;S<80;S++){if(S<16)w[S]=0|v[g+S];else{var E=w[S-3]^w[S-8]^w[S-14]^w[S-16];w[S]=E<<1|E>>>31}var M=(f<<5|f>>>27)+P+w[S];M+=S<20?1518500249+(y&x|~y&k):S<40?1859775393+(y^x^k):S<60?(y&x|y&k|x&k)-1894007588:(y^x^k)-899497514,P=k,k=x,x=y<<30|y>>>2,y=f,f=M}d[0]=d[0]+f|0,d[1]=d[1]+y|0,d[2]=d[2]+x|0,d[3]=d[3]+k|0,d[4]=d[4]+P|0},_doFinalize:function(){var v=this._data,g=v.words,d=8*this._nDataBytes,f=8*v.sigBytes;return g[f>>>5]|=128<<24-f%32,g[14+(f+64>>>9<<4)]=Math.floor(d/4294967296),g[15+(f+64>>>9<<4)]=d,v.sigBytes=4*g.length,this._process(),this._hash},clone:function(){var v=u.clone.call(this);return v._hash=this._hash.clone(),v}});n.SHA1=u._createHelper(m),n.HmacSHA1=u._createHmacHelper(m)}(),e.SHA1}(requireCore())),sha1Exports}var sha256Exports={},sha256={get exports(){return sha256Exports},set exports(e){sha256Exports=e}},hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,sha256.exports=function(e){return function(n){var o=e,r=o.lib,u=r.WordArray,s=r.Hasher,w=o.algo,m=[],v=[];(function(){function f(P){for(var S=n.sqrt(P),E=2;E<=S;E++)if(!(P%E))return!1;return!0}function y(P){return 4294967296*(P-(0|P))|0}for(var x=2,k=0;k<64;)f(x)&&(k<8&&(m[k]=y(n.pow(x,.5))),v[k]=y(n.pow(x,1/3)),k++),x++})();var g=[],d=w.SHA256=s.extend({_doReset:function(){this._hash=new u.init(m.slice(0))},_doProcessBlock:function(f,y){for(var x=this._hash.words,k=x[0],P=x[1],S=x[2],E=x[3],M=x[4],T=x[5],D=x[6],N=x[7],I=0;I<64;I++){if(I<16)g[I]=0|f[y+I];else{var O=g[I-15],F=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,q=g[I-2],Y=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;g[I]=F+g[I-7]+Y+g[I-16]}var _e=k&P^k&S^P&S,ne=(k<<30|k>>>2)^(k<<19|k>>>13)^(k<<10|k>>>22),ve=N+((M<<26|M>>>6)^(M<<21|M>>>11)^(M<<7|M>>>25))+(M&T^~M&D)+v[I]+g[I];N=D,D=T,T=M,M=E+ve|0,E=S,S=P,P=k,k=ve+(ne+_e)|0}x[0]=x[0]+k|0,x[1]=x[1]+P|0,x[2]=x[2]+S|0,x[3]=x[3]+E|0,x[4]=x[4]+M|0,x[5]=x[5]+T|0,x[6]=x[6]+D|0,x[7]=x[7]+N|0},_doFinalize:function(){var f=this._data,y=f.words,x=8*this._nDataBytes,k=8*f.sigBytes;return y[k>>>5]|=128<<24-k%32,y[14+(k+64>>>9<<4)]=n.floor(x/4294967296),y[15+(k+64>>>9<<4)]=x,f.sigBytes=4*y.length,this._process(),this._hash},clone:function(){var f=s.clone.call(this);return f._hash=this._hash.clone(),f}});o.SHA256=s._createHelper(d),o.HmacSHA256=s._createHmacHelper(d)}(Math),e.SHA256}(requireCore())),sha256Exports}var sha224Exports={},sha224={get exports(){return sha224Exports},set exports(e){sha224Exports=e}},hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,sha224.exports=function(e){return function(){var n=e,o=n.lib.WordArray,r=n.algo,u=r.SHA256,s=r.SHA224=u.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var w=u._doFinalize.call(this);return w.sigBytes-=4,w}});n.SHA224=u._createHelper(s),n.HmacSHA224=u._createHmacHelper(s)}(),e.SHA224}(requireCore(),requireSha256())),sha224Exports}var sha512Exports={},sha512={get exports(){return sha512Exports},set exports(e){sha512Exports=e}},hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,sha512.exports=function(e){return function(){var n=e,o=n.lib.Hasher,r=n.x64,u=r.Word,s=r.WordArray,w=n.algo;function m(){return u.create.apply(u,arguments)}var v=[m(1116352408,3609767458),m(1899447441,602891725),m(3049323471,3964484399),m(3921009573,2173295548),m(961987163,4081628472),m(1508970993,3053834265),m(2453635748,2937671579),m(2870763221,3664609560),m(3624381080,2734883394),m(310598401,1164996542),m(607225278,1323610764),m(1426881987,3590304994),m(1925078388,4068182383),m(2162078206,991336113),m(2614888103,633803317),m(3248222580,3479774868),m(3835390401,2666613458),m(4022224774,944711139),m(264347078,2341262773),m(604807628,2007800933),m(770255983,1495990901),m(1249150122,1856431235),m(1555081692,3175218132),m(1996064986,2198950837),m(2554220882,3999719339),m(2821834349,766784016),m(2952996808,2566594879),m(3210313671,3203337956),m(3336571891,1034457026),m(3584528711,2466948901),m(113926993,3758326383),m(338241895,168717936),m(666307205,1188179964),m(773529912,1546045734),m(1294757372,1522805485),m(1396182291,2643833823),m(1695183700,2343527390),m(1986661051,1014477480),m(2177026350,1206759142),m(2456956037,344077627),m(2730485921,1290863460),m(2820302411,3158454273),m(3259730800,3505952657),m(3345764771,106217008),m(3516065817,3606008344),m(3600352804,1432725776),m(4094571909,1467031594),m(275423344,851169720),m(430227734,3100823752),m(506948616,1363258195),m(659060556,3750685593),m(883997877,3785050280),m(958139571,3318307427),m(1322822218,3812723403),m(1537002063,2003034995),m(1747873779,3602036899),m(1955562222,1575990012),m(2024104815,1125592928),m(2227730452,2716904306),m(2361852424,442776044),m(2428436474,593698344),m(2756734187,3733110249),m(3204031479,2999351573),m(3329325298,3815920427),m(3391569614,3928383900),m(3515267271,566280711),m(3940187606,3454069534),m(4118630271,4000239992),m(116418474,1914138554),m(174292421,2731055270),m(289380356,3203993006),m(460393269,320620315),m(685471733,587496836),m(852142971,1086792851),m(1017036298,365543100),m(1126000580,2618297676),m(1288033470,3409855158),m(1501505948,4234509866),m(1607167915,987167468),m(1816402316,1246189591)],g=[];(function(){for(var f=0;f<80;f++)g[f]=m()})();var d=w.SHA512=o.extend({_doReset:function(){this._hash=new s.init([new u.init(1779033703,4089235720),new u.init(3144134277,2227873595),new u.init(1013904242,4271175723),new u.init(2773480762,1595750129),new u.init(1359893119,2917565137),new u.init(2600822924,725511199),new u.init(528734635,4215389547),new u.init(1541459225,327033209)])},_doProcessBlock:function(f,y){for(var x=this._hash.words,k=x[0],P=x[1],S=x[2],E=x[3],M=x[4],T=x[5],D=x[6],N=x[7],I=k.high,O=k.low,F=P.high,q=P.low,Y=S.high,_e=S.low,ne=E.high,ve=E.low,J=M.high,fe=M.low,Z=T.high,j=T.low,X=D.high,H=D.low,U=N.high,te=N.low,Q=I,re=O,Pe=F,be=q,we=Y,Ae=_e,$e=ne,Me=ve,Ie=J,Le=fe,le=Z,oe=j,ke=X,Ce=H,Ee=U,Be=te,Ve=0;Ve<80;Ve++){var Oe,je,Ge=g[Ve];if(Ve<16)je=Ge.high=0|f[y+2*Ve],Oe=Ge.low=0|f[y+2*Ve+1];else{var Xe=g[Ve-15],qe=Xe.high,Ke=Xe.low,Je=(qe>>>1|Ke<<31)^(qe>>>8|Ke<<24)^qe>>>7,rt=(Ke>>>1|qe<<31)^(Ke>>>8|qe<<24)^(Ke>>>7|qe<<25),ht=g[Ve-2],vt=ht.high,Ct=ht.low,kt=(vt>>>19|Ct<<13)^(vt<<3|Ct>>>29)^vt>>>6,mt=(Ct>>>19|vt<<13)^(Ct<<3|vt>>>29)^(Ct>>>6|vt<<26),Vt=g[Ve-7],bt=Vt.high,ot=Vt.low,gt=g[Ve-16],tt=gt.high,ut=gt.low;je=(je=(je=Je+bt+((Oe=rt+ot)>>>0<rt>>>0?1:0))+kt+((Oe+=mt)>>>0<mt>>>0?1:0))+tt+((Oe+=ut)>>>0<ut>>>0?1:0),Ge.high=je,Ge.low=Oe}var Re,Te=Ie&le^~Ie&ke,He=Le&oe^~Le&Ce,Fe=Q&Pe^Q&we^Pe&we,ze=re&be^re&Ae^be&Ae,We=(Q>>>28|re<<4)^(Q<<30|re>>>2)^(Q<<25|re>>>7),Ue=(re>>>28|Q<<4)^(re<<30|Q>>>2)^(re<<25|Q>>>7),et=(Ie>>>14|Le<<18)^(Ie>>>18|Le<<14)^(Ie<<23|Le>>>9),it=(Le>>>14|Ie<<18)^(Le>>>18|Ie<<14)^(Le<<23|Ie>>>9),nt=v[Ve],dt=nt.high,xt=nt.low,yt=Ee+et+((Re=Be+it)>>>0<Be>>>0?1:0),Bt=Ue+ze;Ee=ke,Be=Ce,ke=le,Ce=oe,le=Ie,oe=Le,Ie=$e+(yt=(yt=(yt=yt+Te+((Re+=He)>>>0<He>>>0?1:0))+dt+((Re+=xt)>>>0<xt>>>0?1:0))+je+((Re+=Oe)>>>0<Oe>>>0?1:0))+((Le=Me+Re|0)>>>0<Me>>>0?1:0)|0,$e=we,Me=Ae,we=Pe,Ae=be,Pe=Q,be=re,Q=yt+(We+Fe+(Bt>>>0<Ue>>>0?1:0))+((re=Re+Bt|0)>>>0<Re>>>0?1:0)|0}O=k.low=O+re,k.high=I+Q+(O>>>0<re>>>0?1:0),q=P.low=q+be,P.high=F+Pe+(q>>>0<be>>>0?1:0),_e=S.low=_e+Ae,S.high=Y+we+(_e>>>0<Ae>>>0?1:0),ve=E.low=ve+Me,E.high=ne+$e+(ve>>>0<Me>>>0?1:0),fe=M.low=fe+Le,M.high=J+Ie+(fe>>>0<Le>>>0?1:0),j=T.low=j+oe,T.high=Z+le+(j>>>0<oe>>>0?1:0),H=D.low=H+Ce,D.high=X+ke+(H>>>0<Ce>>>0?1:0),te=N.low=te+Be,N.high=U+Ee+(te>>>0<Be>>>0?1:0)},_doFinalize:function(){var f=this._data,y=f.words,x=8*this._nDataBytes,k=8*f.sigBytes;return y[k>>>5]|=128<<24-k%32,y[30+(k+128>>>10<<5)]=Math.floor(x/4294967296),y[31+(k+128>>>10<<5)]=x,f.sigBytes=4*y.length,this._process(),this._hash.toX32()},clone:function(){var f=o.clone.call(this);return f._hash=this._hash.clone(),f},blockSize:32});n.SHA512=o._createHelper(d),n.HmacSHA512=o._createHmacHelper(d)}(),e.SHA512}(requireCore(),requireX64Core())),sha512Exports}var sha384Exports={},sha384={get exports(){return sha384Exports},set exports(e){sha384Exports=e}},hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,sha384.exports=function(e){return function(){var n=e,o=n.x64,r=o.Word,u=o.WordArray,s=n.algo,w=s.SHA512,m=s.SHA384=w.extend({_doReset:function(){this._hash=new u.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var v=w._doFinalize.call(this);return v.sigBytes-=16,v}});n.SHA384=w._createHelper(m),n.HmacSHA384=w._createHmacHelper(m)}(),e.SHA384}(requireCore(),requireX64Core(),requireSha512())),sha384Exports}var sha3Exports={},sha3={get exports(){return sha3Exports},set exports(e){sha3Exports=e}},hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,sha3.exports=function(e){return function(n){var o=e,r=o.lib,u=r.WordArray,s=r.Hasher,w=o.x64.Word,m=o.algo,v=[],g=[],d=[];(function(){for(var x=1,k=0,P=0;P<24;P++){v[x+5*k]=(P+1)*(P+2)/2%64;var S=(2*x+3*k)%5;x=k%5,k=S}for(x=0;x<5;x++)for(k=0;k<5;k++)g[x+5*k]=k+(2*x+3*k)%5*5;for(var E=1,M=0;M<24;M++){for(var T=0,D=0,N=0;N<7;N++){if(1&E){var I=(1<<N)-1;I<32?D^=1<<I:T^=1<<I-32}128&E?E=E<<1^113:E<<=1}d[M]=w.create(T,D)}})();var f=[];(function(){for(var x=0;x<25;x++)f[x]=w.create()})();var y=m.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var x=this._state=[],k=0;k<25;k++)x[k]=new w.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(x,k){for(var P=this._state,S=this.blockSize/2,E=0;E<S;E++){var M=x[k+2*E],T=x[k+2*E+1];M=16711935&(M<<8|M>>>24)|4278255360&(M<<24|M>>>8),T=16711935&(T<<8|T>>>24)|4278255360&(T<<24|T>>>8),(te=P[E]).high^=T,te.low^=M}for(var D=0;D<24;D++){for(var N=0;N<5;N++){for(var I=0,O=0,F=0;F<5;F++)I^=(te=P[N+5*F]).high,O^=te.low;var q=f[N];q.high=I,q.low=O}for(N=0;N<5;N++){var Y=f[(N+4)%5],_e=f[(N+1)%5],ne=_e.high,ve=_e.low;for(I=Y.high^(ne<<1|ve>>>31),O=Y.low^(ve<<1|ne>>>31),F=0;F<5;F++)(te=P[N+5*F]).high^=I,te.low^=O}for(var J=1;J<25;J++){var fe=(te=P[J]).high,Z=te.low,j=v[J];j<32?(I=fe<<j|Z>>>32-j,O=Z<<j|fe>>>32-j):(I=Z<<j-32|fe>>>64-j,O=fe<<j-32|Z>>>64-j);var X=f[g[J]];X.high=I,X.low=O}var H=f[0],U=P[0];for(H.high=U.high,H.low=U.low,N=0;N<5;N++)for(F=0;F<5;F++){var te=P[J=N+5*F],Q=f[J],re=f[(N+1)%5+5*F],Pe=f[(N+2)%5+5*F];te.high=Q.high^~re.high&Pe.high,te.low=Q.low^~re.low&Pe.low}te=P[0];var be=d[D];te.high^=be.high,te.low^=be.low}},_doFinalize:function(){var x=this._data,k=x.words;this._nDataBytes;var P=8*x.sigBytes,S=32*this.blockSize;k[P>>>5]|=1<<24-P%32,k[(n.ceil((P+1)/S)*S>>>5)-1]|=128,x.sigBytes=4*k.length,this._process();for(var E=this._state,M=this.cfg.outputLength/8,T=M/8,D=[],N=0;N<T;N++){var I=E[N],O=I.high,F=I.low;O=16711935&(O<<8|O>>>24)|4278255360&(O<<24|O>>>8),F=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),D.push(F),D.push(O)}return new u.init(D,M)},clone:function(){for(var x=s.clone.call(this),k=x._state=this._state.slice(0),P=0;P<25;P++)k[P]=k[P].clone();return x}});o.SHA3=s._createHelper(y),o.HmacSHA3=s._createHmacHelper(y)}(Math),e.SHA3}(requireCore(),requireX64Core())),sha3Exports}var ripemd160Exports={},ripemd160={get exports(){return ripemd160Exports},set exports(e){ripemd160Exports=e}},hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,ripemd160.exports=function(e){/** @preserve
      (c) 2012 by Cédric Mesnil. All rights reserved.
      	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
      	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
          - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
      	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
      */return function(n){var o=e,r=o.lib,u=r.WordArray,s=r.Hasher,w=o.algo,m=u.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),v=u.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),g=u.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=u.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=u.create([0,1518500249,1859775393,2400959708,2840853838]),y=u.create([1352829926,1548603684,1836072691,2053994217,0]),x=w.RIPEMD160=s.extend({_doReset:function(){this._hash=u.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(D,N){for(var I=0;I<16;I++){var O=N+I,F=D[O];D[O]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8)}var q,Y,_e,ne,ve,J,fe,Z,j,X,H,U=this._hash.words,te=f.words,Q=y.words,re=m.words,Pe=v.words,be=g.words,we=d.words;for(J=q=U[0],fe=Y=U[1],Z=_e=U[2],j=ne=U[3],X=ve=U[4],I=0;I<80;I+=1)H=q+D[N+re[I]]|0,H+=I<16?k(Y,_e,ne)+te[0]:I<32?P(Y,_e,ne)+te[1]:I<48?S(Y,_e,ne)+te[2]:I<64?E(Y,_e,ne)+te[3]:M(Y,_e,ne)+te[4],H=(H=T(H|=0,be[I]))+ve|0,q=ve,ve=ne,ne=T(_e,10),_e=Y,Y=H,H=J+D[N+Pe[I]]|0,H+=I<16?M(fe,Z,j)+Q[0]:I<32?E(fe,Z,j)+Q[1]:I<48?S(fe,Z,j)+Q[2]:I<64?P(fe,Z,j)+Q[3]:k(fe,Z,j)+Q[4],H=(H=T(H|=0,we[I]))+X|0,J=X,X=j,j=T(Z,10),Z=fe,fe=H;H=U[1]+_e+j|0,U[1]=U[2]+ne+X|0,U[2]=U[3]+ve+J|0,U[3]=U[4]+q+fe|0,U[4]=U[0]+Y+Z|0,U[0]=H},_doFinalize:function(){var D=this._data,N=D.words,I=8*this._nDataBytes,O=8*D.sigBytes;N[O>>>5]|=128<<24-O%32,N[14+(O+64>>>9<<4)]=16711935&(I<<8|I>>>24)|4278255360&(I<<24|I>>>8),D.sigBytes=4*(N.length+1),this._process();for(var F=this._hash,q=F.words,Y=0;Y<5;Y++){var _e=q[Y];q[Y]=16711935&(_e<<8|_e>>>24)|4278255360&(_e<<24|_e>>>8)}return F},clone:function(){var D=s.clone.call(this);return D._hash=this._hash.clone(),D}});function k(D,N,I){return D^N^I}function P(D,N,I){return D&N|~D&I}function S(D,N,I){return(D|~N)^I}function E(D,N,I){return D&I|N&~I}function M(D,N,I){return D^(N|~I)}function T(D,N){return D<<N|D>>>32-N}o.RIPEMD160=s._createHelper(x),o.HmacRIPEMD160=s._createHmacHelper(x)}(),e.RIPEMD160}(requireCore())),ripemd160Exports}var hmacExports={},hmac={get exports(){return hmacExports},set exports(e){hmacExports=e}},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,hmac.exports=function(e){(function(){var n=e,o=n.lib.Base,r=n.enc.Utf8;n.algo.HMAC=o.extend({init:function(u,s){u=this._hasher=new u.init,typeof s=="string"&&(s=r.parse(s));var w=u.blockSize,m=4*w;s.sigBytes>m&&(s=u.finalize(s)),s.clamp();for(var v=this._oKey=s.clone(),g=this._iKey=s.clone(),d=v.words,f=g.words,y=0;y<w;y++)d[y]^=1549556828,f[y]^=909522486;v.sigBytes=g.sigBytes=m,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var s=this._hasher,w=s.finalize(u);return s.reset(),s.finalize(this._oKey.clone().concat(w))}})})()}(requireCore())),hmacExports}var pbkdf2Exports={},pbkdf2={get exports(){return pbkdf2Exports},set exports(e){pbkdf2Exports=e}},hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,pbkdf2.exports=function(e){return function(){var n=e,o=n.lib,r=o.Base,u=o.WordArray,s=n.algo,w=s.SHA256,m=s.HMAC,v=s.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:w,iterations:25e4}),init:function(g){this.cfg=this.cfg.extend(g)},compute:function(g,d){for(var f=this.cfg,y=m.create(f.hasher,g),x=u.create(),k=u.create([1]),P=x.words,S=k.words,E=f.keySize,M=f.iterations;P.length<E;){var T=y.update(d).finalize(k);y.reset();for(var D=T.words,N=D.length,I=T,O=1;O<M;O++){I=y.finalize(I),y.reset();for(var F=I.words,q=0;q<N;q++)D[q]^=F[q]}x.concat(T),S[0]++}return x.sigBytes=4*E,x}});n.PBKDF2=function(g,d,f){return v.create(f).compute(g,d)}}(),e.PBKDF2}(requireCore(),requireSha256(),requireHmac())),pbkdf2Exports}var evpkdfExports={},evpkdf={get exports(){return evpkdfExports},set exports(e){evpkdfExports=e}},hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,evpkdf.exports=function(e){return function(){var n=e,o=n.lib,r=o.Base,u=o.WordArray,s=n.algo,w=s.MD5,m=s.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:w,iterations:1}),init:function(v){this.cfg=this.cfg.extend(v)},compute:function(v,g){for(var d,f=this.cfg,y=f.hasher.create(),x=u.create(),k=x.words,P=f.keySize,S=f.iterations;k.length<P;){d&&y.update(d),d=y.update(v).finalize(g),y.reset();for(var E=1;E<S;E++)d=y.finalize(d),y.reset();x.concat(d)}return x.sigBytes=4*P,x}});n.EvpKDF=function(v,g,d){return m.create(d).compute(v,g)}}(),e.EvpKDF}(requireCore(),requireSha1(),requireHmac())),evpkdfExports}var cipherCoreExports={},cipherCore={get exports(){return cipherCoreExports},set exports(e){cipherCoreExports=e}},hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,cipherCore.exports=function(e){e.lib.Cipher||function(n){var o=e,r=o.lib,u=r.Base,s=r.WordArray,w=r.BufferedBlockAlgorithm,m=o.enc;m.Utf8;var v=m.Base64,g=o.algo.EvpKDF,d=r.Cipher=w.extend({cfg:u.extend(),createEncryptor:function(D,N){return this.create(this._ENC_XFORM_MODE,D,N)},createDecryptor:function(D,N){return this.create(this._DEC_XFORM_MODE,D,N)},init:function(D,N,I){this.cfg=this.cfg.extend(I),this._xformMode=D,this._key=N,this.reset()},reset:function(){w.reset.call(this),this._doReset()},process:function(D){return this._append(D),this._process()},finalize:function(D){return D&&this._append(D),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function D(N){return typeof N=="string"?T:E}return function(N){return{encrypt:function(I,O,F){return D(O).encrypt(N,I,O,F)},decrypt:function(I,O,F){return D(O).decrypt(N,I,O,F)}}}}()});r.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var f=o.mode={},y=r.BlockCipherMode=u.extend({createEncryptor:function(D,N){return this.Encryptor.create(D,N)},createDecryptor:function(D,N){return this.Decryptor.create(D,N)},init:function(D,N){this._cipher=D,this._iv=N}}),x=f.CBC=function(){var D=y.extend();function N(I,O,F){var q,Y=this._iv;Y?(q=Y,this._iv=n):q=this._prevBlock;for(var _e=0;_e<F;_e++)I[O+_e]^=q[_e]}return D.Encryptor=D.extend({processBlock:function(I,O){var F=this._cipher,q=F.blockSize;N.call(this,I,O,q),F.encryptBlock(I,O),this._prevBlock=I.slice(O,O+q)}}),D.Decryptor=D.extend({processBlock:function(I,O){var F=this._cipher,q=F.blockSize,Y=I.slice(O,O+q);F.decryptBlock(I,O),N.call(this,I,O,q),this._prevBlock=Y}}),D}(),k=(o.pad={}).Pkcs7={pad:function(D,N){for(var I=4*N,O=I-D.sigBytes%I,F=O<<24|O<<16|O<<8|O,q=[],Y=0;Y<O;Y+=4)q.push(F);var _e=s.create(q,O);D.concat(_e)},unpad:function(D){var N=255&D.words[D.sigBytes-1>>>2];D.sigBytes-=N}};r.BlockCipher=d.extend({cfg:d.cfg.extend({mode:x,padding:k}),reset:function(){var D;d.reset.call(this);var N=this.cfg,I=N.iv,O=N.mode;this._xformMode==this._ENC_XFORM_MODE?D=O.createEncryptor:(D=O.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==D?this._mode.init(this,I&&I.words):(this._mode=D.call(O,this,I&&I.words),this._mode.__creator=D)},_doProcessBlock:function(D,N){this._mode.processBlock(D,N)},_doFinalize:function(){var D,N=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(N.pad(this._data,this.blockSize),D=this._process(!0)):(D=this._process(!0),N.unpad(D)),D},blockSize:4});var P=r.CipherParams=u.extend({init:function(D){this.mixIn(D)},toString:function(D){return(D||this.formatter).stringify(this)}}),S=(o.format={}).OpenSSL={stringify:function(D){var N=D.ciphertext,I=D.salt;return(I?s.create([1398893684,1701076831]).concat(I).concat(N):N).toString(v)},parse:function(D){var N,I=v.parse(D),O=I.words;return O[0]==1398893684&&O[1]==1701076831&&(N=s.create(O.slice(2,4)),O.splice(0,4),I.sigBytes-=16),P.create({ciphertext:I,salt:N})}},E=r.SerializableCipher=u.extend({cfg:u.extend({format:S}),encrypt:function(D,N,I,O){O=this.cfg.extend(O);var F=D.createEncryptor(I,O),q=F.finalize(N),Y=F.cfg;return P.create({ciphertext:q,key:I,iv:Y.iv,algorithm:D,mode:Y.mode,padding:Y.padding,blockSize:D.blockSize,formatter:O.format})},decrypt:function(D,N,I,O){return O=this.cfg.extend(O),N=this._parse(N,O.format),D.createDecryptor(I,O).finalize(N.ciphertext)},_parse:function(D,N){return typeof D=="string"?N.parse(D,this):D}}),M=(o.kdf={}).OpenSSL={execute:function(D,N,I,O,F){if(O||(O=s.random(8)),F)q=g.create({keySize:N+I,hasher:F}).compute(D,O);else var q=g.create({keySize:N+I}).compute(D,O);var Y=s.create(q.words.slice(N),4*I);return q.sigBytes=4*N,P.create({key:q,iv:Y,salt:O})}},T=r.PasswordBasedCipher=E.extend({cfg:E.cfg.extend({kdf:M}),encrypt:function(D,N,I,O){var F=(O=this.cfg.extend(O)).kdf.execute(I,D.keySize,D.ivSize,O.salt,O.hasher);O.iv=F.iv;var q=E.encrypt.call(this,D,N,F.key,O);return q.mixIn(F),q},decrypt:function(D,N,I,O){O=this.cfg.extend(O),N=this._parse(N,O.format);var F=O.kdf.execute(I,D.keySize,D.ivSize,N.salt,O.hasher);return O.iv=F.iv,E.decrypt.call(this,D,N,F.key,O)}})}()}(requireCore(),requireEvpkdf())),cipherCoreExports}var modeCfbExports={},modeCfb={get exports(){return modeCfbExports},set exports(e){modeCfbExports=e}},hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,modeCfb.exports=function(e){return e.mode.CFB=function(){var n=e.lib.BlockCipherMode.extend();function o(r,u,s,w){var m,v=this._iv;v?(m=v.slice(0),this._iv=void 0):m=this._prevBlock,w.encryptBlock(m,0);for(var g=0;g<s;g++)r[u+g]^=m[g]}return n.Encryptor=n.extend({processBlock:function(r,u){var s=this._cipher,w=s.blockSize;o.call(this,r,u,w,s),this._prevBlock=r.slice(u,u+w)}}),n.Decryptor=n.extend({processBlock:function(r,u){var s=this._cipher,w=s.blockSize,m=r.slice(u,u+w);o.call(this,r,u,w,s),this._prevBlock=m}}),n}(),e.mode.CFB}(requireCore(),requireCipherCore())),modeCfbExports}var modeCtrExports={},modeCtr={get exports(){return modeCtrExports},set exports(e){modeCtrExports=e}},hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,modeCtr.exports=function(e){return e.mode.CTR=(n=e.lib.BlockCipherMode.extend(),o=n.Encryptor=n.extend({processBlock:function(r,u){var s=this._cipher,w=s.blockSize,m=this._iv,v=this._counter;m&&(v=this._counter=m.slice(0),this._iv=void 0);var g=v.slice(0);s.encryptBlock(g,0),v[w-1]=v[w-1]+1|0;for(var d=0;d<w;d++)r[u+d]^=g[d]}}),n.Decryptor=o,n),e.mode.CTR;var n,o}(requireCore(),requireCipherCore())),modeCtrExports}var modeCtrGladmanExports={},modeCtrGladman={get exports(){return modeCtrGladmanExports},set exports(e){modeCtrGladmanExports=e}},hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,modeCtrGladman.exports=function(e){/** @preserve
       * Counter block mode compatible with  Dr Brian Gladman fileenc.c
       * derived from CryptoJS.mode.CTR
       * Jan Hruby jhruby.web@gmail.com
       */return e.mode.CTRGladman=function(){var n=e.lib.BlockCipherMode.extend();function o(s){if(255&~(s>>24))s+=1<<24;else{var w=s>>16&255,m=s>>8&255,v=255&s;w===255?(w=0,m===255?(m=0,v===255?v=0:++v):++m):++w,s=0,s+=w<<16,s+=m<<8,s+=v}return s}function r(s){return(s[0]=o(s[0]))===0&&(s[1]=o(s[1])),s}var u=n.Encryptor=n.extend({processBlock:function(s,w){var m=this._cipher,v=m.blockSize,g=this._iv,d=this._counter;g&&(d=this._counter=g.slice(0),this._iv=void 0),r(d);var f=d.slice(0);m.encryptBlock(f,0);for(var y=0;y<v;y++)s[w+y]^=f[y]}});return n.Decryptor=u,n}(),e.mode.CTRGladman}(requireCore(),requireCipherCore())),modeCtrGladmanExports}var modeOfbExports={},modeOfb={get exports(){return modeOfbExports},set exports(e){modeOfbExports=e}},hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,modeOfb.exports=function(e){return e.mode.OFB=(n=e.lib.BlockCipherMode.extend(),o=n.Encryptor=n.extend({processBlock:function(r,u){var s=this._cipher,w=s.blockSize,m=this._iv,v=this._keystream;m&&(v=this._keystream=m.slice(0),this._iv=void 0),s.encryptBlock(v,0);for(var g=0;g<w;g++)r[u+g]^=v[g]}}),n.Decryptor=o,n),e.mode.OFB;var n,o}(requireCore(),requireCipherCore())),modeOfbExports}var modeEcbExports={},modeEcb={get exports(){return modeEcbExports},set exports(e){modeEcbExports=e}},hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,modeEcb.exports=function(e){return e.mode.ECB=((n=e.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(o,r){this._cipher.encryptBlock(o,r)}}),n.Decryptor=n.extend({processBlock:function(o,r){this._cipher.decryptBlock(o,r)}}),n),e.mode.ECB;var n}(requireCore(),requireCipherCore())),modeEcbExports}var padAnsix923Exports={},padAnsix923={get exports(){return padAnsix923Exports},set exports(e){padAnsix923Exports=e}},hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,padAnsix923.exports=function(e){return e.pad.AnsiX923={pad:function(n,o){var r=n.sigBytes,u=4*o,s=u-r%u,w=r+s-1;n.clamp(),n.words[w>>>2]|=s<<24-w%4*8,n.sigBytes+=s},unpad:function(n){var o=255&n.words[n.sigBytes-1>>>2];n.sigBytes-=o}},e.pad.Ansix923}(requireCore(),requireCipherCore())),padAnsix923Exports}var padIso10126Exports={},padIso10126={get exports(){return padIso10126Exports},set exports(e){padIso10126Exports=e}},hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,padIso10126.exports=function(e){return e.pad.Iso10126={pad:function(n,o){var r=4*o,u=r-n.sigBytes%r;n.concat(e.lib.WordArray.random(u-1)).concat(e.lib.WordArray.create([u<<24],1))},unpad:function(n){var o=255&n.words[n.sigBytes-1>>>2];n.sigBytes-=o}},e.pad.Iso10126}(requireCore(),requireCipherCore())),padIso10126Exports}var padIso97971Exports={},padIso97971={get exports(){return padIso97971Exports},set exports(e){padIso97971Exports=e}},hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,padIso97971.exports=function(e){return e.pad.Iso97971={pad:function(n,o){n.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(n,o)},unpad:function(n){e.pad.ZeroPadding.unpad(n),n.sigBytes--}},e.pad.Iso97971}(requireCore(),requireCipherCore())),padIso97971Exports}var padZeropaddingExports={},padZeropadding={get exports(){return padZeropaddingExports},set exports(e){padZeropaddingExports=e}},hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,padZeropadding.exports=function(e){return e.pad.ZeroPadding={pad:function(n,o){var r=4*o;n.clamp(),n.sigBytes+=r-(n.sigBytes%r||r)},unpad:function(n){var o=n.words,r=n.sigBytes-1;for(r=n.sigBytes-1;r>=0;r--)if(o[r>>>2]>>>24-r%4*8&255){n.sigBytes=r+1;break}}},e.pad.ZeroPadding}(requireCore(),requireCipherCore())),padZeropaddingExports}var padNopaddingExports={},padNopadding={get exports(){return padNopaddingExports},set exports(e){padNopaddingExports=e}},hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,padNopadding.exports=function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding}(requireCore(),requireCipherCore())),padNopaddingExports}var formatHexExports={},formatHex={get exports(){return formatHexExports},set exports(e){formatHexExports=e}},hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,formatHex.exports=function(e){return function(n){var o=e,r=o.lib.CipherParams,u=o.enc.Hex;o.format.Hex={stringify:function(s){return s.ciphertext.toString(u)},parse:function(s){var w=u.parse(s);return r.create({ciphertext:w})}}}(),e.format.Hex}(requireCore(),requireCipherCore())),formatHexExports}var aesExports={},aes={get exports(){return aesExports},set exports(e){aesExports=e}},hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,aes.exports=function(e){return function(){var n=e,o=n.lib.BlockCipher,r=n.algo,u=[],s=[],w=[],m=[],v=[],g=[],d=[],f=[],y=[],x=[];(function(){for(var S=[],E=0;E<256;E++)S[E]=E<128?E<<1:E<<1^283;var M=0,T=0;for(E=0;E<256;E++){var D=T^T<<1^T<<2^T<<3^T<<4;D=D>>>8^255&D^99,u[M]=D,s[D]=M;var N=S[M],I=S[N],O=S[I],F=257*S[D]^16843008*D;w[M]=F<<24|F>>>8,m[M]=F<<16|F>>>16,v[M]=F<<8|F>>>24,g[M]=F,F=16843009*O^65537*I^257*N^16843008*M,d[D]=F<<24|F>>>8,f[D]=F<<16|F>>>16,y[D]=F<<8|F>>>24,x[D]=F,M?(M=N^S[S[S[O^N]]],T^=S[S[T]]):M=T=1}})();var k=[0,1,2,4,8,16,32,64,128,27,54],P=r.AES=o.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var S=this._keyPriorReset=this._key,E=S.words,M=S.sigBytes/4,T=4*((this._nRounds=M+6)+1),D=this._keySchedule=[],N=0;N<T;N++)N<M?D[N]=E[N]:(F=D[N-1],N%M?M>6&&N%M==4&&(F=u[F>>>24]<<24|u[F>>>16&255]<<16|u[F>>>8&255]<<8|u[255&F]):(F=u[(F=F<<8|F>>>24)>>>24]<<24|u[F>>>16&255]<<16|u[F>>>8&255]<<8|u[255&F],F^=k[N/M|0]<<24),D[N]=D[N-M]^F);for(var I=this._invKeySchedule=[],O=0;O<T;O++){if(N=T-O,O%4)var F=D[N];else F=D[N-4];I[O]=O<4||N<=4?F:d[u[F>>>24]]^f[u[F>>>16&255]]^y[u[F>>>8&255]]^x[u[255&F]]}}},encryptBlock:function(S,E){this._doCryptBlock(S,E,this._keySchedule,w,m,v,g,u)},decryptBlock:function(S,E){var M=S[E+1];S[E+1]=S[E+3],S[E+3]=M,this._doCryptBlock(S,E,this._invKeySchedule,d,f,y,x,s),M=S[E+1],S[E+1]=S[E+3],S[E+3]=M},_doCryptBlock:function(S,E,M,T,D,N,I,O){for(var F=this._nRounds,q=S[E]^M[0],Y=S[E+1]^M[1],_e=S[E+2]^M[2],ne=S[E+3]^M[3],ve=4,J=1;J<F;J++){var fe=T[q>>>24]^D[Y>>>16&255]^N[_e>>>8&255]^I[255&ne]^M[ve++],Z=T[Y>>>24]^D[_e>>>16&255]^N[ne>>>8&255]^I[255&q]^M[ve++],j=T[_e>>>24]^D[ne>>>16&255]^N[q>>>8&255]^I[255&Y]^M[ve++],X=T[ne>>>24]^D[q>>>16&255]^N[Y>>>8&255]^I[255&_e]^M[ve++];q=fe,Y=Z,_e=j,ne=X}fe=(O[q>>>24]<<24|O[Y>>>16&255]<<16|O[_e>>>8&255]<<8|O[255&ne])^M[ve++],Z=(O[Y>>>24]<<24|O[_e>>>16&255]<<16|O[ne>>>8&255]<<8|O[255&q])^M[ve++],j=(O[_e>>>24]<<24|O[ne>>>16&255]<<16|O[q>>>8&255]<<8|O[255&Y])^M[ve++],X=(O[ne>>>24]<<24|O[q>>>16&255]<<16|O[Y>>>8&255]<<8|O[255&_e])^M[ve++],S[E]=fe,S[E+1]=Z,S[E+2]=j,S[E+3]=X},keySize:8});n.AES=o._createHelper(P)}(),e.AES}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),aesExports}var tripledesExports={},tripledes={get exports(){return tripledesExports},set exports(e){tripledesExports=e}},hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,tripledes.exports=function(e){return function(){var n=e,o=n.lib,r=o.WordArray,u=o.BlockCipher,s=n.algo,w=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],m=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],v=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],g=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=u.extend({_doReset:function(){for(var P=this._key.words,S=[],E=0;E<56;E++){var M=w[E]-1;S[E]=P[M>>>5]>>>31-M%32&1}for(var T=this._subKeys=[],D=0;D<16;D++){var N=T[D]=[],I=v[D];for(E=0;E<24;E++)N[E/6|0]|=S[(m[E]-1+I)%28]<<31-E%6,N[4+(E/6|0)]|=S[28+(m[E+24]-1+I)%28]<<31-E%6;for(N[0]=N[0]<<1|N[0]>>>31,E=1;E<7;E++)N[E]=N[E]>>>4*(E-1)+3;N[7]=N[7]<<5|N[7]>>>27}var O=this._invSubKeys=[];for(E=0;E<16;E++)O[E]=T[15-E]},encryptBlock:function(P,S){this._doCryptBlock(P,S,this._subKeys)},decryptBlock:function(P,S){this._doCryptBlock(P,S,this._invSubKeys)},_doCryptBlock:function(P,S,E){this._lBlock=P[S],this._rBlock=P[S+1],y.call(this,4,252645135),y.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),y.call(this,1,1431655765);for(var M=0;M<16;M++){for(var T=E[M],D=this._lBlock,N=this._rBlock,I=0,O=0;O<8;O++)I|=g[O][((N^T[O])&d[O])>>>0];this._lBlock=N,this._rBlock=D^I}var F=this._lBlock;this._lBlock=this._rBlock,this._rBlock=F,y.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),y.call(this,16,65535),y.call(this,4,252645135),P[S]=this._lBlock,P[S+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function y(P,S){var E=(this._lBlock>>>P^this._rBlock)&S;this._rBlock^=E,this._lBlock^=E<<P}function x(P,S){var E=(this._rBlock>>>P^this._lBlock)&S;this._lBlock^=E,this._rBlock^=E<<P}n.DES=u._createHelper(f);var k=s.TripleDES=u.extend({_doReset:function(){var P=this._key.words;if(P.length!==2&&P.length!==4&&P.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var S=P.slice(0,2),E=P.length<4?P.slice(0,2):P.slice(2,4),M=P.length<6?P.slice(0,2):P.slice(4,6);this._des1=f.createEncryptor(r.create(S)),this._des2=f.createEncryptor(r.create(E)),this._des3=f.createEncryptor(r.create(M))},encryptBlock:function(P,S){this._des1.encryptBlock(P,S),this._des2.decryptBlock(P,S),this._des3.encryptBlock(P,S)},decryptBlock:function(P,S){this._des3.decryptBlock(P,S),this._des2.encryptBlock(P,S),this._des1.decryptBlock(P,S)},keySize:6,ivSize:2,blockSize:2});n.TripleDES=u._createHelper(k)}(),e.TripleDES}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),tripledesExports}var rc4Exports={},rc4={get exports(){return rc4Exports},set exports(e){rc4Exports=e}},hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,rc4.exports=function(e){return function(){var n=e,o=n.lib.StreamCipher,r=n.algo,u=r.RC4=o.extend({_doReset:function(){for(var m=this._key,v=m.words,g=m.sigBytes,d=this._S=[],f=0;f<256;f++)d[f]=f;f=0;for(var y=0;f<256;f++){var x=f%g,k=v[x>>>2]>>>24-x%4*8&255;y=(y+d[f]+k)%256;var P=d[f];d[f]=d[y],d[y]=P}this._i=this._j=0},_doProcessBlock:function(m,v){m[v]^=s.call(this)},keySize:8,ivSize:0});function s(){for(var m=this._S,v=this._i,g=this._j,d=0,f=0;f<4;f++){g=(g+m[v=(v+1)%256])%256;var y=m[v];m[v]=m[g],m[g]=y,d|=m[(m[v]+m[g])%256]<<24-8*f}return this._i=v,this._j=g,d}n.RC4=o._createHelper(u);var w=r.RC4Drop=u.extend({cfg:u.cfg.extend({drop:192}),_doReset:function(){u._doReset.call(this);for(var m=this.cfg.drop;m>0;m--)s.call(this)}});n.RC4Drop=o._createHelper(w)}(),e.RC4}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),rc4Exports}var rabbitExports={},rabbit={get exports(){return rabbitExports},set exports(e){rabbitExports=e}},hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,rabbit.exports=function(e){return function(){var n=e,o=n.lib.StreamCipher,r=n.algo,u=[],s=[],w=[],m=r.Rabbit=o.extend({_doReset:function(){for(var g=this._key.words,d=this.cfg.iv,f=0;f<4;f++)g[f]=16711935&(g[f]<<8|g[f]>>>24)|4278255360&(g[f]<<24|g[f]>>>8);var y=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],x=this._C=[g[2]<<16|g[2]>>>16,4294901760&g[0]|65535&g[1],g[3]<<16|g[3]>>>16,4294901760&g[1]|65535&g[2],g[0]<<16|g[0]>>>16,4294901760&g[2]|65535&g[3],g[1]<<16|g[1]>>>16,4294901760&g[3]|65535&g[0]];for(this._b=0,f=0;f<4;f++)v.call(this);for(f=0;f<8;f++)x[f]^=y[f+4&7];if(d){var k=d.words,P=k[0],S=k[1],E=16711935&(P<<8|P>>>24)|4278255360&(P<<24|P>>>8),M=16711935&(S<<8|S>>>24)|4278255360&(S<<24|S>>>8),T=E>>>16|4294901760&M,D=M<<16|65535&E;for(x[0]^=E,x[1]^=T,x[2]^=M,x[3]^=D,x[4]^=E,x[5]^=T,x[6]^=M,x[7]^=D,f=0;f<4;f++)v.call(this)}},_doProcessBlock:function(g,d){var f=this._X;v.call(this),u[0]=f[0]^f[5]>>>16^f[3]<<16,u[1]=f[2]^f[7]>>>16^f[5]<<16,u[2]=f[4]^f[1]>>>16^f[7]<<16,u[3]=f[6]^f[3]>>>16^f[1]<<16;for(var y=0;y<4;y++)u[y]=16711935&(u[y]<<8|u[y]>>>24)|4278255360&(u[y]<<24|u[y]>>>8),g[d+y]^=u[y]},blockSize:4,ivSize:2});function v(){for(var g=this._X,d=this._C,f=0;f<8;f++)s[f]=d[f];for(d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<s[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<s[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<s[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<s[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<s[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<s[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<s[6]>>>0?1:0)|0,this._b=d[7]>>>0<s[7]>>>0?1:0,f=0;f<8;f++){var y=g[f]+d[f],x=65535&y,k=y>>>16,P=((x*x>>>17)+x*k>>>15)+k*k,S=((4294901760&y)*y|0)+((65535&y)*y|0);w[f]=P^S}g[0]=w[0]+(w[7]<<16|w[7]>>>16)+(w[6]<<16|w[6]>>>16)|0,g[1]=w[1]+(w[0]<<8|w[0]>>>24)+w[7]|0,g[2]=w[2]+(w[1]<<16|w[1]>>>16)+(w[0]<<16|w[0]>>>16)|0,g[3]=w[3]+(w[2]<<8|w[2]>>>24)+w[1]|0,g[4]=w[4]+(w[3]<<16|w[3]>>>16)+(w[2]<<16|w[2]>>>16)|0,g[5]=w[5]+(w[4]<<8|w[4]>>>24)+w[3]|0,g[6]=w[6]+(w[5]<<16|w[5]>>>16)+(w[4]<<16|w[4]>>>16)|0,g[7]=w[7]+(w[6]<<8|w[6]>>>24)+w[5]|0}n.Rabbit=o._createHelper(m)}(),e.Rabbit}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),rabbitExports}var rabbitLegacyExports={},rabbitLegacy={get exports(){return rabbitLegacyExports},set exports(e){rabbitLegacyExports=e}},hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,rabbitLegacy.exports=function(e){return function(){var n=e,o=n.lib.StreamCipher,r=n.algo,u=[],s=[],w=[],m=r.RabbitLegacy=o.extend({_doReset:function(){var g=this._key.words,d=this.cfg.iv,f=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],y=this._C=[g[2]<<16|g[2]>>>16,4294901760&g[0]|65535&g[1],g[3]<<16|g[3]>>>16,4294901760&g[1]|65535&g[2],g[0]<<16|g[0]>>>16,4294901760&g[2]|65535&g[3],g[1]<<16|g[1]>>>16,4294901760&g[3]|65535&g[0]];this._b=0;for(var x=0;x<4;x++)v.call(this);for(x=0;x<8;x++)y[x]^=f[x+4&7];if(d){var k=d.words,P=k[0],S=k[1],E=16711935&(P<<8|P>>>24)|4278255360&(P<<24|P>>>8),M=16711935&(S<<8|S>>>24)|4278255360&(S<<24|S>>>8),T=E>>>16|4294901760&M,D=M<<16|65535&E;for(y[0]^=E,y[1]^=T,y[2]^=M,y[3]^=D,y[4]^=E,y[5]^=T,y[6]^=M,y[7]^=D,x=0;x<4;x++)v.call(this)}},_doProcessBlock:function(g,d){var f=this._X;v.call(this),u[0]=f[0]^f[5]>>>16^f[3]<<16,u[1]=f[2]^f[7]>>>16^f[5]<<16,u[2]=f[4]^f[1]>>>16^f[7]<<16,u[3]=f[6]^f[3]>>>16^f[1]<<16;for(var y=0;y<4;y++)u[y]=16711935&(u[y]<<8|u[y]>>>24)|4278255360&(u[y]<<24|u[y]>>>8),g[d+y]^=u[y]},blockSize:4,ivSize:2});function v(){for(var g=this._X,d=this._C,f=0;f<8;f++)s[f]=d[f];for(d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<s[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<s[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<s[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<s[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<s[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<s[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<s[6]>>>0?1:0)|0,this._b=d[7]>>>0<s[7]>>>0?1:0,f=0;f<8;f++){var y=g[f]+d[f],x=65535&y,k=y>>>16,P=((x*x>>>17)+x*k>>>15)+k*k,S=((4294901760&y)*y|0)+((65535&y)*y|0);w[f]=P^S}g[0]=w[0]+(w[7]<<16|w[7]>>>16)+(w[6]<<16|w[6]>>>16)|0,g[1]=w[1]+(w[0]<<8|w[0]>>>24)+w[7]|0,g[2]=w[2]+(w[1]<<16|w[1]>>>16)+(w[0]<<16|w[0]>>>16)|0,g[3]=w[3]+(w[2]<<8|w[2]>>>24)+w[1]|0,g[4]=w[4]+(w[3]<<16|w[3]>>>16)+(w[2]<<16|w[2]>>>16)|0,g[5]=w[5]+(w[4]<<8|w[4]>>>24)+w[3]|0,g[6]=w[6]+(w[5]<<16|w[5]>>>16)+(w[4]<<16|w[4]>>>16)|0,g[7]=w[7]+(w[6]<<8|w[6]>>>24)+w[5]|0}n.RabbitLegacy=o._createHelper(m)}(),e.RabbitLegacy}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),rabbitLegacyExports}var blowfishExports={},blowfish={get exports(){return blowfishExports},set exports(e){blowfishExports=e}},hasRequiredBlowfish;function requireBlowfish(){return hasRequiredBlowfish||(hasRequiredBlowfish=1,blowfish.exports=function(e){return function(){var n=e,o=n.lib.BlockCipher,r=n.algo,u=16,s=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],w=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],m={pbox:[],sbox:[]};function v(x,k){var P=k>>24&255,S=k>>16&255,E=k>>8&255,M=255&k,T=x.sbox[0][P]+x.sbox[1][S];return T^=x.sbox[2][E],T+=x.sbox[3][M]}function g(x,k,P){for(var S,E=k,M=P,T=0;T<u;++T)S=E^=x.pbox[T],E=M=v(x,E)^M,M=S;return S=E,E=M,M=S,M^=x.pbox[u],{left:E^=x.pbox[u+1],right:M}}function d(x,k,P){for(var S,E=k,M=P,T=u+1;T>1;--T)S=E^=x.pbox[T],E=M=v(x,E)^M,M=S;return S=E,E=M,M=S,M^=x.pbox[1],{left:E^=x.pbox[0],right:M}}function f(x,k,P){for(var S=0;S<4;S++){x.sbox[S]=[];for(var E=0;E<256;E++)x.sbox[S][E]=w[S][E]}for(var M=0,T=0;T<u+2;T++)x.pbox[T]=s[T]^k[M],++M>=P&&(M=0);for(var D=0,N=0,I=0,O=0;O<u+2;O+=2)D=(I=g(x,D,N)).left,N=I.right,x.pbox[O]=D,x.pbox[O+1]=N;for(var F=0;F<4;F++)for(var q=0;q<256;q+=2)D=(I=g(x,D,N)).left,N=I.right,x.sbox[F][q]=D,x.sbox[F][q+1]=N;return!0}var y=r.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var x=this._keyPriorReset=this._key,k=x.words,P=x.sigBytes/4;f(m,k,P)}},encryptBlock:function(x,k){var P=g(m,x[k],x[k+1]);x[k]=P.left,x[k+1]=P.right},decryptBlock:function(x,k){var P=d(m,x[k],x[k+1]);x[k]=P.left,x[k+1]=P.right},blockSize:2,keySize:4,ivSize:2});n.Blowfish=o._createHelper(y)}(),e.Blowfish}(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())),blowfishExports}cryptoJs.exports=function(e){return e}(requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy(),requireBlowfish());var CryptoJS=cryptoJsExports,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";function int2char(e){return BI_RM.charAt(e)}function op_and(e,n){return e&n}function op_or(e,n){return e|n}function op_xor(e,n){return e^n}function op_andnot(e,n){return e&~n}function lbit(e){if(e==0)return-1;var n=0;return 65535&e||(e>>=16,n+=16),255&e||(e>>=8,n+=8),15&e||(e>>=4,n+=4),3&e||(e>>=2,n+=2),1&e||++n,n}function cbit(e){for(var n=0;e!=0;)e&=e-1,++n;return n}var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=",decoder$1;function hex2b64(e){var n,o,r="";for(n=0;n+3<=e.length;n+=3)o=parseInt(e.substring(n,n+3),16),r+=b64map.charAt(o>>6)+b64map.charAt(63&o);for(n+1==e.length?(o=parseInt(e.substring(n,n+1),16),r+=b64map.charAt(o<<2)):n+2==e.length&&(o=parseInt(e.substring(n,n+2),16),r+=b64map.charAt(o>>2)+b64map.charAt((3&o)<<4));(3&r.length)>0;)r+=b64pad;return r}function b64tohex(e){var n,o="",r=0,u=0;for(n=0;n<e.length&&e.charAt(n)!=b64pad;++n){var s=b64map.indexOf(e.charAt(n));s<0||(r==0?(o+=int2char(s>>2),u=3&s,r=1):r==1?(o+=int2char(u<<2|s>>4),u=15&s,r=2):r==2?(o+=int2char(u),o+=int2char(s>>2),u=3&s,r=3):(o+=int2char(u<<2|s>>4),o+=int2char(15&s),r=0))}return r==1&&(o+=int2char(u<<2)),o}var Hex={decode:function(e){var n;if(decoder$1===void 0){var o="0123456789ABCDEF",r=` \f
\r	\xA0\u2028\u2029`;for(decoder$1={},n=0;n<16;++n)decoder$1[o.charAt(n)]=n;for(o=o.toLowerCase(),n=10;n<16;++n)decoder$1[o.charAt(n)]=n;for(n=0;n<8;++n)decoder$1[r.charAt(n)]=-1}var u=[],s=0,w=0;for(n=0;n<e.length;++n){var m=e.charAt(n);if(m=="=")break;if((m=decoder$1[m])!=-1){if(m===void 0)throw new Error("Illegal character at offset "+n);s|=m,++w>=2?(u[u.length]=s,s=0,w=0):s<<=4}}if(w)throw new Error("Hex encoding incomplete: 4 bits missing");return u}},decoder,Base64$1={decode:function(e){var n;if(decoder===void 0){var o=`= \f
\r	\xA0\u2028\u2029`;for(decoder=Object.create(null),n=0;n<64;++n)decoder["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n)]=n;for(decoder["-"]=62,decoder._=63,n=0;n<9;++n)decoder[o.charAt(n)]=-1}var r=[],u=0,s=0;for(n=0;n<e.length;++n){var w=e.charAt(n);if(w=="=")break;if((w=decoder[w])!=-1){if(w===void 0)throw new Error("Illegal character at offset "+n);u|=w,++s>=4?(r[r.length]=u>>16,r[r.length]=u>>8&255,r[r.length]=255&u,u=0,s=0):u<<=6}}switch(s){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:r[r.length]=u>>10;break;case 3:r[r.length]=u>>16,r[r.length]=u>>8&255}return r},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(e){var n=Base64$1.re.exec(e);if(n)if(n[1])e=n[1];else{if(!n[2])throw new Error("RegExp out of sync");e=n[2]}return Base64$1.decode(e)}},max=1e13,Int10=function(){function e(n){this.buf=[+n||0]}return e.prototype.mulAdd=function(n,o){var r,u,s=this.buf,w=s.length;for(r=0;r<w;++r)(u=s[r]*n+o)<max?o=0:u-=(o=0|u/max)*max,s[r]=u;o>0&&(s[r]=o)},e.prototype.sub=function(n){var o,r,u=this.buf,s=u.length;for(o=0;o<s;++o)(r=u[o]-n)<0?(r+=max,n=1):n=0,u[o]=r;for(;u[u.length-1]===0;)u.pop()},e.prototype.toString=function(n){if((n||10)!=10)throw new Error("only base 10 is supported");for(var o=this.buf,r=o[o.length-1].toString(),u=o.length-2;u>=0;--u)r+=(max+o[u]).toString().substring(1);return r},e.prototype.valueOf=function(){for(var n=this.buf,o=0,r=n.length-1;r>=0;--r)o=o*max+n[r];return o},e.prototype.simplify=function(){var n=this.buf;return n.length==1?n[0]:this},e}(),ellipsis="\u2026",reTimeS=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,reTimeL=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function stringCut(e,n){return e.length>n&&(e=e.substring(0,n)+ellipsis),e}var Stream=function(){function e(n,o){this.hexDigits="0123456789ABCDEF",n instanceof e?(this.enc=n.enc,this.pos=n.pos):(this.enc=n,this.pos=o)}return e.prototype.get=function(n){if(n===void 0&&(n=this.pos++),n>=this.enc.length)throw new Error("Requesting byte offset ".concat(n," on a stream of length ").concat(this.enc.length));return typeof this.enc=="string"?this.enc.charCodeAt(n):this.enc[n]},e.prototype.hexByte=function(n){return this.hexDigits.charAt(n>>4&15)+this.hexDigits.charAt(15&n)},e.prototype.hexDump=function(n,o,r){for(var u="",s=n;s<o;++s)if(u+=this.hexByte(this.get(s)),r!==!0)switch(15&s){case 7:u+="  ";break;case 15:u+=`
`;break;default:u+=" "}return u},e.prototype.isASCII=function(n,o){for(var r=n;r<o;++r){var u=this.get(r);if(u<32||u>176)return!1}return!0},e.prototype.parseStringISO=function(n,o){for(var r="",u=n;u<o;++u)r+=String.fromCharCode(this.get(u));return r},e.prototype.parseStringUTF=function(n,o){for(var r="",u=n;u<o;){var s=this.get(u++);r+=s<128?String.fromCharCode(s):s>191&&s<224?String.fromCharCode((31&s)<<6|63&this.get(u++)):String.fromCharCode((15&s)<<12|(63&this.get(u++))<<6|63&this.get(u++))}return r},e.prototype.parseStringBMP=function(n,o){for(var r,u,s="",w=n;w<o;)r=this.get(w++),u=this.get(w++),s+=String.fromCharCode(r<<8|u);return s},e.prototype.parseTime=function(n,o,r){var u=this.parseStringISO(n,o),s=(r?reTimeS:reTimeL).exec(u);return s?(r&&(s[1]=+s[1],s[1]+=+s[1]<70?2e3:1900),u=s[1]+"-"+s[2]+"-"+s[3]+" "+s[4],s[5]&&(u+=":"+s[5],s[6]&&(u+=":"+s[6],s[7]&&(u+="."+s[7]))),s[8]&&(u+=" UTC",s[8]!="Z"&&(u+=s[8],s[9]&&(u+=":"+s[9]))),u):"Unrecognized time: "+u},e.prototype.parseInteger=function(n,o){for(var r,u=this.get(n),s=u>127,w=s?255:0,m="";u==w&&++n<o;)u=this.get(n);if((r=o-n)===0)return s?-1:0;if(r>4){for(m=u,r<<=3;!(128&(+m^w));)m=+m<<1,--r;m="("+r+` bit)
`}s&&(u-=256);for(var v=new Int10(u),g=n+1;g<o;++g)v.mulAdd(256,this.get(g));return m+v.toString()},e.prototype.parseBitString=function(n,o,r){for(var u=this.get(n),s="("+((o-n-1<<3)-u)+` bit)
`,w="",m=n+1;m<o;++m){for(var v=this.get(m),g=m==o-1?u:0,d=7;d>=g;--d)w+=v>>d&1?"1":"0";if(w.length>r)return s+stringCut(w,r)}return s+w},e.prototype.parseOctetString=function(n,o,r){if(this.isASCII(n,o))return stringCut(this.parseStringISO(n,o),r);var u=o-n,s="("+u+` byte)
`;u>(r/=2)&&(o=n+r);for(var w=n;w<o;++w)s+=this.hexByte(this.get(w));return u>r&&(s+=ellipsis),s},e.prototype.parseOID=function(n,o,r){for(var u="",s=new Int10,w=0,m=n;m<o;++m){var v=this.get(m);if(s.mulAdd(128,127&v),w+=7,!(128&v)){if(u==="")if((s=s.simplify())instanceof Int10)s.sub(80),u="2."+s.toString();else{var g=s<80?s<40?0:1:2;u=g+"."+(s-40*g)}else u+="."+s.toString();if(u.length>r)return stringCut(u,r);s=new Int10,w=0}}return w>0&&(u+=".incomplete"),u},e}(),ASN1=function(){function e(n,o,r,u,s){if(!(u instanceof ASN1Tag))throw new Error("Invalid tag value.");this.stream=n,this.header=o,this.length=r,this.tag=u,this.sub=s}return e.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},e.prototype.content=function(n){if(this.tag===void 0)return null;n===void 0&&(n=1/0);var o=this.posContent(),r=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(o,o+r,n);switch(this.tag.tagNumber){case 1:return this.stream.get(o)===0?"false":"true";case 2:return this.stream.parseInteger(o,o+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(o,o+r,n);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(o,o+r,n);case 6:return this.stream.parseOID(o,o+r,n);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return stringCut(this.stream.parseStringUTF(o,o+r),n);case 18:case 19:case 20:case 21:case 22:case 26:return stringCut(this.stream.parseStringISO(o,o+r),n);case 30:return stringCut(this.stream.parseStringBMP(o,o+r),n);case 23:case 24:return this.stream.parseTime(o,o+r,this.tag.tagNumber==23)}return null},e.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"},e.prototype.toPrettyString=function(n){n===void 0&&(n="");var o=n+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(o+="+"),o+=this.length,this.tag.tagConstructed?o+=" (constructed)":!this.tag.isUniversal()||this.tag.tagNumber!=3&&this.tag.tagNumber!=4||this.sub===null||(o+=" (encapsulates)"),o+=`
`,this.sub!==null){n+="  ";for(var r=0,u=this.sub.length;r<u;++r)o+=this.sub[r].toPrettyString(n)}return o},e.prototype.posStart=function(){return this.stream.pos},e.prototype.posContent=function(){return this.stream.pos+this.header},e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},e.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},e.decodeLength=function(n){var o=n.get(),r=127&o;if(r==o)return r;if(r>6)throw new Error("Length over 48 bits not supported at position "+(n.pos-1));if(r===0)return null;o=0;for(var u=0;u<r;++u)o=256*o+n.get();return o},e.prototype.getHexStringValue=function(){var n=this.toHexString(),o=2*this.header,r=2*this.length;return n.substr(o,r)},e.decode=function(n){var o;o=n instanceof Stream?n:new Stream(n,0);var r=new Stream(o),u=new ASN1Tag(o),s=e.decodeLength(o),w=o.pos,m=w-r.pos,v=null,g=function(){var f=[];if(s!==null){for(var y=w+s;o.pos<y;)f[f.length]=e.decode(o);if(o.pos!=y)throw new Error("Content size is not correct for container starting at offset "+w)}else try{for(;;){var x=e.decode(o);if(x.tag.isEOC())break;f[f.length]=x}s=w-o.pos}catch(k){throw new Error("Exception while decoding undefined length content: "+k)}return f};if(u.tagConstructed)v=g();else if(u.isUniversal()&&(u.tagNumber==3||u.tagNumber==4))try{if(u.tagNumber==3&&o.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");v=g();for(var d=0;d<v.length;++d)if(v[d].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{v=null}if(v===null){if(s===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+w);o.pos=w+Math.abs(s)}return new e(r,m,s,u,v)},e}(),ASN1Tag=function(){function e(n){var o=n.get();if(this.tagClass=o>>6,this.tagConstructed=!!(32&o),this.tagNumber=31&o,this.tagNumber==31){var r=new Int10;do o=n.get(),r.mulAdd(128,127&o);while(128&o);this.tagNumber=r.simplify()}}return e.prototype.isUniversal=function(){return this.tagClass===0},e.prototype.isEOC=function(){return this.tagClass===0&&this.tagNumber===0},e}(),dbits,canary=0xdeadbeefcafe,j_lm=(16777215&canary)==15715070,lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1],BigInteger=function(){function e(n,o,r){n!=null&&(typeof n=="number"?this.fromNumber(n,o,r):o==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,o))}return e.prototype.toString=function(n){if(this.s<0)return"-"+this.negate().toString(n);var o;if(n==16)o=4;else if(n==8)o=3;else if(n==2)o=1;else if(n==32)o=5;else{if(n!=4)return this.toRadix(n);o=2}var r,u=(1<<o)-1,s=!1,w="",m=this.t,v=this.DB-m*this.DB%o;if(m-- >0)for(v<this.DB&&(r=this[m]>>v)>0&&(s=!0,w=int2char(r));m>=0;)v<o?(r=(this[m]&(1<<v)-1)<<o-v,r|=this[--m]>>(v+=this.DB-o)):(r=this[m]>>(v-=o)&u,v<=0&&(v+=this.DB,--m)),r>0&&(s=!0),s&&(w+=int2char(r));return s?w:"0"},e.prototype.negate=function(){var n=nbi();return e.ZERO.subTo(this,n),n},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(n){var o=this.s-n.s;if(o!=0)return o;var r=this.t;if((o=r-n.t)!=0)return this.s<0?-o:o;for(;--r>=0;)if((o=this[r]-n[r])!=0)return o;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(n){var o=nbi();return this.abs().divRemTo(n,null,o),this.s<0&&o.compareTo(e.ZERO)>0&&n.subTo(o,o),o},e.prototype.modPowInt=function(n,o){var r;return r=n<256||o.isEven()?new Classic(o):new Montgomery(o),this.exp(n,r)},e.prototype.clone=function(){var n=nbi();return this.copyTo(n),n},e.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var n=this.t,o=[];o[0]=this.s;var r,u=this.DB-n*this.DB%8,s=0;if(n-- >0)for(u<this.DB&&(r=this[n]>>u)!=(this.s&this.DM)>>u&&(o[s++]=r|this.s<<this.DB-u);n>=0;)u<8?(r=(this[n]&(1<<u)-1)<<8-u,r|=this[--n]>>(u+=this.DB-8)):(r=this[n]>>(u-=8)&255,u<=0&&(u+=this.DB,--n)),128&r&&(r|=-256),s==0&&(128&this.s)!=(128&r)&&++s,(s>0||r!=this.s)&&(o[s++]=r);return o},e.prototype.equals=function(n){return this.compareTo(n)==0},e.prototype.min=function(n){return this.compareTo(n)<0?this:n},e.prototype.max=function(n){return this.compareTo(n)>0?this:n},e.prototype.and=function(n){var o=nbi();return this.bitwiseTo(n,op_and,o),o},e.prototype.or=function(n){var o=nbi();return this.bitwiseTo(n,op_or,o),o},e.prototype.xor=function(n){var o=nbi();return this.bitwiseTo(n,op_xor,o),o},e.prototype.andNot=function(n){var o=nbi();return this.bitwiseTo(n,op_andnot,o),o},e.prototype.not=function(){for(var n=nbi(),o=0;o<this.t;++o)n[o]=this.DM&~this[o];return n.t=this.t,n.s=~this.s,n},e.prototype.shiftLeft=function(n){var o=nbi();return n<0?this.rShiftTo(-n,o):this.lShiftTo(n,o),o},e.prototype.shiftRight=function(n){var o=nbi();return n<0?this.lShiftTo(-n,o):this.rShiftTo(n,o),o},e.prototype.getLowestSetBit=function(){for(var n=0;n<this.t;++n)if(this[n]!=0)return n*this.DB+lbit(this[n]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var n=0,o=this.s&this.DM,r=0;r<this.t;++r)n+=cbit(this[r]^o);return n},e.prototype.testBit=function(n){var o=Math.floor(n/this.DB);return o>=this.t?this.s!=0:!!(this[o]&1<<n%this.DB)},e.prototype.setBit=function(n){return this.changeBit(n,op_or)},e.prototype.clearBit=function(n){return this.changeBit(n,op_andnot)},e.prototype.flipBit=function(n){return this.changeBit(n,op_xor)},e.prototype.add=function(n){var o=nbi();return this.addTo(n,o),o},e.prototype.subtract=function(n){var o=nbi();return this.subTo(n,o),o},e.prototype.multiply=function(n){var o=nbi();return this.multiplyTo(n,o),o},e.prototype.divide=function(n){var o=nbi();return this.divRemTo(n,o,null),o},e.prototype.remainder=function(n){var o=nbi();return this.divRemTo(n,null,o),o},e.prototype.divideAndRemainder=function(n){var o=nbi(),r=nbi();return this.divRemTo(n,o,r),[o,r]},e.prototype.modPow=function(n,o){var r,u,s=n.bitLength(),w=nbv(1);if(s<=0)return w;r=s<18?1:s<48?3:s<144?4:s<768?5:6,u=s<8?new Classic(o):o.isEven()?new Barrett(o):new Montgomery(o);var m=[],v=3,g=r-1,d=(1<<r)-1;if(m[1]=u.convert(this),r>1){var f=nbi();for(u.sqrTo(m[1],f);v<=d;)m[v]=nbi(),u.mulTo(f,m[v-2],m[v]),v+=2}var y,x,k=n.t-1,P=!0,S=nbi();for(s=nbits(n[k])-1;k>=0;){for(s>=g?y=n[k]>>s-g&d:(y=(n[k]&(1<<s+1)-1)<<g-s,k>0&&(y|=n[k-1]>>this.DB+s-g)),v=r;!(1&y);)y>>=1,--v;if((s-=v)<0&&(s+=this.DB,--k),P)m[y].copyTo(w),P=!1;else{for(;v>1;)u.sqrTo(w,S),u.sqrTo(S,w),v-=2;v>0?u.sqrTo(w,S):(x=w,w=S,S=x),u.mulTo(S,m[y],w)}for(;k>=0&&!(n[k]&1<<s);)u.sqrTo(w,S),x=w,w=S,S=x,--s<0&&(s=this.DB-1,--k)}return u.revert(w)},e.prototype.modInverse=function(n){var o=n.isEven();if(this.isEven()&&o||n.signum()==0)return e.ZERO;for(var r=n.clone(),u=this.clone(),s=nbv(1),w=nbv(0),m=nbv(0),v=nbv(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),o?(s.isEven()&&w.isEven()||(s.addTo(this,s),w.subTo(n,w)),s.rShiftTo(1,s)):w.isEven()||w.subTo(n,w),w.rShiftTo(1,w);for(;u.isEven();)u.rShiftTo(1,u),o?(m.isEven()&&v.isEven()||(m.addTo(this,m),v.subTo(n,v)),m.rShiftTo(1,m)):v.isEven()||v.subTo(n,v),v.rShiftTo(1,v);r.compareTo(u)>=0?(r.subTo(u,r),o&&s.subTo(m,s),w.subTo(v,w)):(u.subTo(r,u),o&&m.subTo(s,m),v.subTo(w,v))}return u.compareTo(e.ONE)!=0?e.ZERO:v.compareTo(n)>=0?v.subtract(n):v.signum()<0?(v.addTo(n,v),v.signum()<0?v.add(n):v):v},e.prototype.pow=function(n){return this.exp(n,new NullExp)},e.prototype.gcd=function(n){var o=this.s<0?this.negate():this.clone(),r=n.s<0?n.negate():n.clone();if(o.compareTo(r)<0){var u=o;o=r,r=u}var s=o.getLowestSetBit(),w=r.getLowestSetBit();if(w<0)return o;for(s<w&&(w=s),w>0&&(o.rShiftTo(w,o),r.rShiftTo(w,r));o.signum()>0;)(s=o.getLowestSetBit())>0&&o.rShiftTo(s,o),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),o.compareTo(r)>=0?(o.subTo(r,o),o.rShiftTo(1,o)):(r.subTo(o,r),r.rShiftTo(1,r));return w>0&&r.lShiftTo(w,r),r},e.prototype.isProbablePrime=function(n){var o,r=this.abs();if(r.t==1&&r[0]<=lowprimes[lowprimes.length-1]){for(o=0;o<lowprimes.length;++o)if(r[0]==lowprimes[o])return!0;return!1}if(r.isEven())return!1;for(o=1;o<lowprimes.length;){for(var u=lowprimes[o],s=o+1;s<lowprimes.length&&u<lplim;)u*=lowprimes[s++];for(u=r.modInt(u);o<s;)if(u%lowprimes[o++]==0)return!1}return r.millerRabin(n)},e.prototype.copyTo=function(n){for(var o=this.t-1;o>=0;--o)n[o]=this[o];n.t=this.t,n.s=this.s},e.prototype.fromInt=function(n){this.t=1,this.s=n<0?-1:0,n>0?this[0]=n:n<-1?this[0]=n+this.DV:this.t=0},e.prototype.fromString=function(n,o){var r;if(o==16)r=4;else if(o==8)r=3;else if(o==256)r=8;else if(o==2)r=1;else if(o==32)r=5;else{if(o!=4)return void this.fromRadix(n,o);r=2}this.t=0,this.s=0;for(var u=n.length,s=!1,w=0;--u>=0;){var m=r==8?255&+n[u]:intAt(n,u);m<0?n.charAt(u)=="-"&&(s=!0):(s=!1,w==0?this[this.t++]=m:w+r>this.DB?(this[this.t-1]|=(m&(1<<this.DB-w)-1)<<w,this[this.t++]=m>>this.DB-w):this[this.t-1]|=m<<w,(w+=r)>=this.DB&&(w-=this.DB))}r==8&&128&+n[0]&&(this.s=-1,w>0&&(this[this.t-1]|=(1<<this.DB-w)-1<<w)),this.clamp(),s&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var n=this.s&this.DM;this.t>0&&this[this.t-1]==n;)--this.t},e.prototype.dlShiftTo=function(n,o){var r;for(r=this.t-1;r>=0;--r)o[r+n]=this[r];for(r=n-1;r>=0;--r)o[r]=0;o.t=this.t+n,o.s=this.s},e.prototype.drShiftTo=function(n,o){for(var r=n;r<this.t;++r)o[r-n]=this[r];o.t=Math.max(this.t-n,0),o.s=this.s},e.prototype.lShiftTo=function(n,o){for(var r=n%this.DB,u=this.DB-r,s=(1<<u)-1,w=Math.floor(n/this.DB),m=this.s<<r&this.DM,v=this.t-1;v>=0;--v)o[v+w+1]=this[v]>>u|m,m=(this[v]&s)<<r;for(v=w-1;v>=0;--v)o[v]=0;o[w]=m,o.t=this.t+w+1,o.s=this.s,o.clamp()},e.prototype.rShiftTo=function(n,o){o.s=this.s;var r=Math.floor(n/this.DB);if(r>=this.t)o.t=0;else{var u=n%this.DB,s=this.DB-u,w=(1<<u)-1;o[0]=this[r]>>u;for(var m=r+1;m<this.t;++m)o[m-r-1]|=(this[m]&w)<<s,o[m-r]=this[m]>>u;u>0&&(o[this.t-r-1]|=(this.s&w)<<s),o.t=this.t-r,o.clamp()}},e.prototype.subTo=function(n,o){for(var r=0,u=0,s=Math.min(n.t,this.t);r<s;)u+=this[r]-n[r],o[r++]=u&this.DM,u>>=this.DB;if(n.t<this.t){for(u-=n.s;r<this.t;)u+=this[r],o[r++]=u&this.DM,u>>=this.DB;u+=this.s}else{for(u+=this.s;r<n.t;)u-=n[r],o[r++]=u&this.DM,u>>=this.DB;u-=n.s}o.s=u<0?-1:0,u<-1?o[r++]=this.DV+u:u>0&&(o[r++]=u),o.t=r,o.clamp()},e.prototype.multiplyTo=function(n,o){var r=this.abs(),u=n.abs(),s=r.t;for(o.t=s+u.t;--s>=0;)o[s]=0;for(s=0;s<u.t;++s)o[s+r.t]=r.am(0,u[s],o,s,0,r.t);o.s=0,o.clamp(),this.s!=n.s&&e.ZERO.subTo(o,o)},e.prototype.squareTo=function(n){for(var o=this.abs(),r=n.t=2*o.t;--r>=0;)n[r]=0;for(r=0;r<o.t-1;++r){var u=o.am(r,o[r],n,2*r,0,1);(n[r+o.t]+=o.am(r+1,2*o[r],n,2*r+1,u,o.t-r-1))>=o.DV&&(n[r+o.t]-=o.DV,n[r+o.t+1]=1)}n.t>0&&(n[n.t-1]+=o.am(r,o[r],n,2*r,0,1)),n.s=0,n.clamp()},e.prototype.divRemTo=function(n,o,r){var u=n.abs();if(!(u.t<=0)){var s=this.abs();if(s.t<u.t)return o!=null&&o.fromInt(0),void(r!=null&&this.copyTo(r));r==null&&(r=nbi());var w=nbi(),m=this.s,v=n.s,g=this.DB-nbits(u[u.t-1]);g>0?(u.lShiftTo(g,w),s.lShiftTo(g,r)):(u.copyTo(w),s.copyTo(r));var d=w.t,f=w[d-1];if(f!=0){var y=f*(1<<this.F1)+(d>1?w[d-2]>>this.F2:0),x=this.FV/y,k=(1<<this.F1)/y,P=1<<this.F2,S=r.t,E=S-d,M=o==null?nbi():o;for(w.dlShiftTo(E,M),r.compareTo(M)>=0&&(r[r.t++]=1,r.subTo(M,r)),e.ONE.dlShiftTo(d,M),M.subTo(w,w);w.t<d;)w[w.t++]=0;for(;--E>=0;){var T=r[--S]==f?this.DM:Math.floor(r[S]*x+(r[S-1]+P)*k);if((r[S]+=w.am(0,T,r,E,0,d))<T)for(w.dlShiftTo(E,M),r.subTo(M,r);r[S]<--T;)r.subTo(M,r)}o!=null&&(r.drShiftTo(d,o),m!=v&&e.ZERO.subTo(o,o)),r.t=d,r.clamp(),g>0&&r.rShiftTo(g,r),m<0&&e.ZERO.subTo(r,r)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var n=this[0];if(!(1&n))return 0;var o=3&n;return(o=(o=(o=(o=o*(2-(15&n)*o)&15)*(2-(255&n)*o)&255)*(2-((65535&n)*o&65535))&65535)*(2-n*o%this.DV)%this.DV)>0?this.DV-o:-o},e.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},e.prototype.exp=function(n,o){if(n>4294967295||n<1)return e.ONE;var r=nbi(),u=nbi(),s=o.convert(this),w=nbits(n)-1;for(s.copyTo(r);--w>=0;)if(o.sqrTo(r,u),(n&1<<w)>0)o.mulTo(u,s,r);else{var m=r;r=u,u=m}return o.revert(r)},e.prototype.chunkSize=function(n){return Math.floor(Math.LN2*this.DB/Math.log(n))},e.prototype.toRadix=function(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var o=this.chunkSize(n),r=Math.pow(n,o),u=nbv(r),s=nbi(),w=nbi(),m="";for(this.divRemTo(u,s,w);s.signum()>0;)m=(r+w.intValue()).toString(n).substr(1)+m,s.divRemTo(u,s,w);return w.intValue().toString(n)+m},e.prototype.fromRadix=function(n,o){this.fromInt(0),o==null&&(o=10);for(var r=this.chunkSize(o),u=Math.pow(o,r),s=!1,w=0,m=0,v=0;v<n.length;++v){var g=intAt(n,v);g<0?n.charAt(v)=="-"&&this.signum()==0&&(s=!0):(m=o*m+g,++w>=r&&(this.dMultiply(u),this.dAddOffset(m,0),w=0,m=0))}w>0&&(this.dMultiply(Math.pow(o,w)),this.dAddOffset(m,0)),s&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(n,o,r){if(typeof o=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,r),this.testBit(n-1)||this.bitwiseTo(e.ONE.shiftLeft(n-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(o);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(e.ONE.shiftLeft(n-1),this);else{var u=[],s=7&n;u.length=1+(n>>3),o.nextBytes(u),s>0?u[0]&=(1<<s)-1:u[0]=0,this.fromString(u,256)}},e.prototype.bitwiseTo=function(n,o,r){var u,s,w=Math.min(n.t,this.t);for(u=0;u<w;++u)r[u]=o(this[u],n[u]);if(n.t<this.t){for(s=n.s&this.DM,u=w;u<this.t;++u)r[u]=o(this[u],s);r.t=this.t}else{for(s=this.s&this.DM,u=w;u<n.t;++u)r[u]=o(s,n[u]);r.t=n.t}r.s=o(this.s,n.s),r.clamp()},e.prototype.changeBit=function(n,o){var r=e.ONE.shiftLeft(n);return this.bitwiseTo(r,o,r),r},e.prototype.addTo=function(n,o){for(var r=0,u=0,s=Math.min(n.t,this.t);r<s;)u+=this[r]+n[r],o[r++]=u&this.DM,u>>=this.DB;if(n.t<this.t){for(u+=n.s;r<this.t;)u+=this[r],o[r++]=u&this.DM,u>>=this.DB;u+=this.s}else{for(u+=this.s;r<n.t;)u+=n[r],o[r++]=u&this.DM,u>>=this.DB;u+=n.s}o.s=u<0?-1:0,u>0?o[r++]=u:u<-1&&(o[r++]=this.DV+u),o.t=r,o.clamp()},e.prototype.dMultiply=function(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(n,o){if(n!=0){for(;this.t<=o;)this[this.t++]=0;for(this[o]+=n;this[o]>=this.DV;)this[o]-=this.DV,++o>=this.t&&(this[this.t++]=0),++this[o]}},e.prototype.multiplyLowerTo=function(n,o,r){var u=Math.min(this.t+n.t,o);for(r.s=0,r.t=u;u>0;)r[--u]=0;for(var s=r.t-this.t;u<s;++u)r[u+this.t]=this.am(0,n[u],r,u,0,this.t);for(s=Math.min(n.t,o);u<s;++u)this.am(0,n[u],r,u,0,o-u);r.clamp()},e.prototype.multiplyUpperTo=function(n,o,r){--o;var u=r.t=this.t+n.t-o;for(r.s=0;--u>=0;)r[u]=0;for(u=Math.max(o-this.t,0);u<n.t;++u)r[this.t+u-o]=this.am(o-u,n[u],r,0,0,this.t+u-o);r.clamp(),r.drShiftTo(1,r)},e.prototype.modInt=function(n){if(n<=0)return 0;var o=this.DV%n,r=this.s<0?n-1:0;if(this.t>0)if(o==0)r=this[0]%n;else for(var u=this.t-1;u>=0;--u)r=(o*r+this[u])%n;return r},e.prototype.millerRabin=function(n){var o=this.subtract(e.ONE),r=o.getLowestSetBit();if(r<=0)return!1;var u=o.shiftRight(r);(n=n+1>>1)>lowprimes.length&&(n=lowprimes.length);for(var s=nbi(),w=0;w<n;++w){s.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var m=s.modPow(u,this);if(m.compareTo(e.ONE)!=0&&m.compareTo(o)!=0){for(var v=1;v++<r&&m.compareTo(o)!=0;)if((m=m.modPowInt(2,this)).compareTo(e.ONE)==0)return!1;if(m.compareTo(o)!=0)return!1}}return!0},e.prototype.square=function(){var n=nbi();return this.squareTo(n),n},e.prototype.gcda=function(n,o){var r=this.s<0?this.negate():this.clone(),u=n.s<0?n.negate():n.clone();if(r.compareTo(u)<0){var s=r;r=u,u=s}var w=r.getLowestSetBit(),m=u.getLowestSetBit();m<0?o(r):(w<m&&(m=w),m>0&&(r.rShiftTo(m,r),u.rShiftTo(m,u)),setTimeout(function v(){(w=r.getLowestSetBit())>0&&r.rShiftTo(w,r),(w=u.getLowestSetBit())>0&&u.rShiftTo(w,u),r.compareTo(u)>=0?(r.subTo(u,r),r.rShiftTo(1,r)):(u.subTo(r,u),u.rShiftTo(1,u)),r.signum()>0?setTimeout(v,0):(m>0&&u.lShiftTo(m,u),setTimeout(function(){o(u)},0))},10))},e.prototype.fromNumberAsync=function(n,o,r,u){if(typeof o=="number")if(n<2)this.fromInt(1);else{this.fromNumber(n,r),this.testBit(n-1)||this.bitwiseTo(e.ONE.shiftLeft(n-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);var s=this;setTimeout(function v(){s.dAddOffset(2,0),s.bitLength()>n&&s.subTo(e.ONE.shiftLeft(n-1),s),s.isProbablePrime(o)?setTimeout(function(){u()},0):setTimeout(v,0)},0)}else{var w=[],m=7&n;w.length=1+(n>>3),o.nextBytes(w),m>0?w[0]&=(1<<m)-1:w[0]=0,this.fromString(w,256)}},e}(),NullExp=function(){function e(){}return e.prototype.convert=function(n){return n},e.prototype.revert=function(n){return n},e.prototype.mulTo=function(n,o,r){n.multiplyTo(o,r)},e.prototype.sqrTo=function(n,o){n.squareTo(o)},e}(),Classic=function(){function e(n){this.m=n}return e.prototype.convert=function(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n},e.prototype.revert=function(n){return n},e.prototype.reduce=function(n){n.divRemTo(this.m,null,n)},e.prototype.mulTo=function(n,o,r){n.multiplyTo(o,r),this.reduce(r)},e.prototype.sqrTo=function(n,o){n.squareTo(o),this.reduce(o)},e}(),Montgomery=function(){function e(n){this.m=n,this.mp=n.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}return e.prototype.convert=function(n){var o=nbi();return n.abs().dlShiftTo(this.m.t,o),o.divRemTo(this.m,null,o),n.s<0&&o.compareTo(BigInteger.ZERO)>0&&this.m.subTo(o,o),o},e.prototype.revert=function(n){var o=nbi();return n.copyTo(o),this.reduce(o),o},e.prototype.reduce=function(n){for(;n.t<=this.mt2;)n[n.t++]=0;for(var o=0;o<this.m.t;++o){var r=32767&n[o],u=r*this.mpl+((r*this.mph+(n[o]>>15)*this.mpl&this.um)<<15)&n.DM;for(n[r=o+this.m.t]+=this.m.am(0,u,n,o,0,this.m.t);n[r]>=n.DV;)n[r]-=n.DV,n[++r]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)},e.prototype.mulTo=function(n,o,r){n.multiplyTo(o,r),this.reduce(r)},e.prototype.sqrTo=function(n,o){n.squareTo(o),this.reduce(o)},e}(),Barrett=function(){function e(n){this.m=n,this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n)}return e.prototype.convert=function(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var o=nbi();return n.copyTo(o),this.reduce(o),o},e.prototype.revert=function(n){return n},e.prototype.reduce=function(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)},e.prototype.mulTo=function(n,o,r){n.multiplyTo(o,r),this.reduce(r)},e.prototype.sqrTo=function(n,o){n.squareTo(o),this.reduce(o)},e}();function nbi(){return new BigInteger(null)}function parseBigInt(e,n){return new BigInteger(e,n)}var inBrowser=typeof navigator<"u";inBrowser&&j_lm&&navigator.appName=="Microsoft Internet Explorer"?(BigInteger.prototype.am=function(e,n,o,r,u,s){for(var w=32767&n,m=n>>15;--s>=0;){var v=32767&this[e],g=this[e++]>>15,d=m*v+g*w;u=((v=w*v+((32767&d)<<15)+o[r]+(1073741823&u))>>>30)+(d>>>15)+m*g+(u>>>30),o[r++]=1073741823&v}return u},dbits=30):inBrowser&&j_lm&&navigator.appName!="Netscape"?(BigInteger.prototype.am=function(e,n,o,r,u,s){for(;--s>=0;){var w=n*this[e++]+o[r]+u;u=Math.floor(w/67108864),o[r++]=67108863&w}return u},dbits=26):(BigInteger.prototype.am=function(e,n,o,r,u,s){for(var w=16383&n,m=n>>14;--s>=0;){var v=16383&this[e],g=this[e++]>>14,d=m*v+g*w;u=((v=w*v+((16383&d)<<14)+o[r]+u)>>28)+(d>>14)+m*g,o[r++]=268435455&v}return u},dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RC=[],rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function intAt(e,n){var o=BI_RC[e.charCodeAt(n)];return o==null?-1:o}function nbv(e){var n=nbi();return n.fromInt(e),n}function nbits(e){var n,o=1;return(n=e>>>16)!=0&&(e=n,o+=16),(n=e>>8)!=0&&(e=n,o+=8),(n=e>>4)!=0&&(e=n,o+=4),(n=e>>2)!=0&&(e=n,o+=2),(n=e>>1)!=0&&(e=n,o+=1),o}BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1);var Arcfour=function(){function e(){this.i=0,this.j=0,this.S=[]}return e.prototype.init=function(n){var o,r,u;for(o=0;o<256;++o)this.S[o]=o;for(r=0,o=0;o<256;++o)r=r+this.S[o]+n[o%n.length]&255,u=this.S[o],this.S[o]=this.S[r],this.S[r]=u;this.i=0,this.j=0},e.prototype.next=function(){var n;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,n=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=n,this.S[n+this.S[this.i]&255]},e}();function prng_newstate(){return new Arcfour}var rng_psize=256,rng_state,rng_pool=null,rng_pptr;if(rng_pool==null){rng_pool=[],rng_pptr=0;var t=void 0;if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){var z=new Uint32Array(256);for(window.crypto.getRandomValues(z),t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z[t]}var count=0,onMouseMoveListener_1=function e(n){if((count=count||0)>=256||rng_pptr>=rng_psize)window.removeEventListener?window.removeEventListener("mousemove",e,!1):window.detachEvent&&window.detachEvent("onmousemove",e);else try{var o=n.x+n.y;rng_pool[rng_pptr++]=255&o,count+=1}catch{}};typeof window<"u"&&(window.addEventListener?window.addEventListener("mousemove",onMouseMoveListener_1,!1):window.attachEvent&&window.attachEvent("onmousemove",onMouseMoveListener_1))}function rng_get_byte(){if(rng_state==null){for(rng_state=prng_newstate();rng_pptr<rng_psize;){var e=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=255&e}for(rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}var SecureRandom=function(){function e(){}return e.prototype.nextBytes=function(n){for(var o=0;o<n.length;++o)n[o]=rng_get_byte()},e}();function pkcs1pad1(e,n){if(n<e.length+22)return console.error("Message too long for RSA"),null;for(var o=n-e.length-6,r="",u=0;u<o;u+=2)r+="ff";return parseBigInt("0001"+r+"00"+e,16)}function pkcs1pad2(e,n){if(n<e.length+11)return console.error("Message too long for RSA"),null;for(var o=[],r=e.length-1;r>=0&&n>0;){var u=e.charCodeAt(r--);u<128?o[--n]=u:u>127&&u<2048?(o[--n]=63&u|128,o[--n]=u>>6|192):(o[--n]=63&u|128,o[--n]=u>>6&63|128,o[--n]=u>>12|224)}o[--n]=0;for(var s=new SecureRandom,w=[];n>2;){for(w[0]=0;w[0]==0;)s.nextBytes(w);o[--n]=w[0]}return o[--n]=2,o[--n]=0,new BigInteger(o)}var RSAKey=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.doPublic=function(n){return n.modPowInt(this.e,this.n)},e.prototype.doPrivate=function(n){if(this.p==null||this.q==null)return n.modPow(this.d,this.n);for(var o=n.mod(this.p).modPow(this.dmp1,this.p),r=n.mod(this.q).modPow(this.dmq1,this.q);o.compareTo(r)<0;)o=o.add(this.p);return o.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},e.prototype.setPublic=function(n,o){n!=null&&o!=null&&n.length>0&&o.length>0?(this.n=parseBigInt(n,16),this.e=parseInt(o,16)):console.error("Invalid RSA public key")},e.prototype.encrypt=function(n){var o=this.n.bitLength()+7>>3,r=pkcs1pad2(n,o);if(r==null)return null;var u=this.doPublic(r);if(u==null)return null;for(var s=u.toString(16),w=s.length,m=0;m<2*o-w;m++)s="0"+s;return s},e.prototype.setPrivate=function(n,o,r){n!=null&&o!=null&&n.length>0&&o.length>0?(this.n=parseBigInt(n,16),this.e=parseInt(o,16),this.d=parseBigInt(r,16)):console.error("Invalid RSA private key")},e.prototype.setPrivateEx=function(n,o,r,u,s,w,m,v){n!=null&&o!=null&&n.length>0&&o.length>0?(this.n=parseBigInt(n,16),this.e=parseInt(o,16),this.d=parseBigInt(r,16),this.p=parseBigInt(u,16),this.q=parseBigInt(s,16),this.dmp1=parseBigInt(w,16),this.dmq1=parseBigInt(m,16),this.coeff=parseBigInt(v,16)):console.error("Invalid RSA private key")},e.prototype.generate=function(n,o){var r=new SecureRandom,u=n>>1;this.e=parseInt(o,16);for(var s=new BigInteger(o,16);;){for(;this.p=new BigInteger(n-u,1,r),this.p.subtract(BigInteger.ONE).gcd(s).compareTo(BigInteger.ONE)!=0||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(u,1,r),this.q.subtract(BigInteger.ONE).gcd(s).compareTo(BigInteger.ONE)!=0||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var w=this.p;this.p=this.q,this.q=w}var m=this.p.subtract(BigInteger.ONE),v=this.q.subtract(BigInteger.ONE),g=m.multiply(v);if(g.gcd(s).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q),this.d=s.modInverse(g),this.dmp1=this.d.mod(m),this.dmq1=this.d.mod(v),this.coeff=this.q.modInverse(this.p);break}}},e.prototype.decrypt=function(n){var o=parseBigInt(n,16),r=this.doPrivate(o);return r==null?null:pkcs1unpad2(r,this.n.bitLength()+7>>3)},e.prototype.generateAsync=function(n,o,r){var u=new SecureRandom,s=n>>1;this.e=parseInt(o,16);var w=new BigInteger(o,16),m=this;setTimeout(function v(){var g=function(){if(m.p.compareTo(m.q)<=0){var f=m.p;m.p=m.q,m.q=f}var y=m.p.subtract(BigInteger.ONE),x=m.q.subtract(BigInteger.ONE),k=y.multiply(x);k.gcd(w).compareTo(BigInteger.ONE)==0?(m.n=m.p.multiply(m.q),m.d=w.modInverse(k),m.dmp1=m.d.mod(y),m.dmq1=m.d.mod(x),m.coeff=m.q.modInverse(m.p),setTimeout(function(){r()},0)):setTimeout(v,0)},d=function f(){m.q=nbi(),m.q.fromNumberAsync(s,1,u,function(){m.q.subtract(BigInteger.ONE).gcda(w,function(y){y.compareTo(BigInteger.ONE)==0&&m.q.isProbablePrime(10)?setTimeout(g,0):setTimeout(f,0)})})};setTimeout(function f(){m.p=nbi(),m.p.fromNumberAsync(n-s,1,u,function(){m.p.subtract(BigInteger.ONE).gcda(w,function(y){y.compareTo(BigInteger.ONE)==0&&m.p.isProbablePrime(10)?setTimeout(d,0):setTimeout(f,0)})})},0)},0)},e.prototype.sign=function(n,o,r){var u=pkcs1pad1(getDigestHeader(r)+o(n).toString(),this.n.bitLength()/4);if(u==null)return null;var s=this.doPrivate(u);if(s==null)return null;var w=s.toString(16);return 1&w.length?"0"+w:w},e.prototype.verify=function(n,o,r){var u=parseBigInt(o,16),s=this.doPublic(u);return s==null?null:removeDigestHeader(s.toString(16).replace(/^1f+00/,""))==r(n).toString()},e}();function pkcs1unpad2(e,n){for(var o=e.toByteArray(),r=0;r<o.length&&o[r]==0;)++r;if(o.length-r!=n-1||o[r]!=2)return null;for(++r;o[r]!=0;)if(++r>=o.length)return null;for(var u="";++r<o.length;){var s=255&o[r];s<128?u+=String.fromCharCode(s):s>191&&s<224?(u+=String.fromCharCode((31&s)<<6|63&o[r+1]),++r):(u+=String.fromCharCode((15&s)<<12|(63&o[r+1])<<6|63&o[r+2]),r+=2)}return u}var DIGEST_HEADERS={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function getDigestHeader(e){return DIGEST_HEADERS[e]||""}function removeDigestHeader(e){for(var n in DIGEST_HEADERS)if(DIGEST_HEADERS.hasOwnProperty(n)){var o=DIGEST_HEADERS[n],r=o.length;if(e.substr(0,r)==o)return e.substr(r)}return e}/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/var YAHOO={};YAHOO.lang={extend:function(e,n,o){if(!n||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=n.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=n.prototype,n.prototype.constructor==Object.prototype.constructor&&(n.prototype.constructor=n),o){var u;for(u in o)e.prototype[u]=o[u];var s=function(){},w=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(s=function(m,v){for(u=0;u<w.length;u+=1){var g=w[u],d=v[g];typeof d=="function"&&d!=Object.prototype[g]&&(m[g]=d)}})}catch{}s(e.prototype,o)}}};/**
 * @fileOverview
 * @name asn1-1.0.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version asn1 1.0.13 (2017-Jun-02)
 * @since jsrsasign 2.1
 * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
 */var KJUR={};KJUR.asn1!==void 0&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var n=e.toString(16);return n.length%2==1&&(n="0"+n),n},this.bigIntToMinTwosComplementsHex=function(e){var n=e.toString(16);if(n.substr(0,1)!="-")n.length%2==1?n="0"+n:n.match(/^[0-7]/)||(n="00"+n);else{var o=n.substr(1).length;o%2==1?o+=1:n.match(/^[0-7]/)||(o+=2);for(var r="",u=0;u<o;u++)r+="f";n=new BigInteger(r,16).xor(e).add(BigInteger.ONE).toString(16).replace(/^-/,"")}return n},this.getPEMStringFromHex=function(e,n){return hextopem(e,n)},this.newObject=function(e){var n=KJUR.asn1,o=n.DERBoolean,r=n.DERInteger,u=n.DERBitString,s=n.DEROctetString,w=n.DERNull,m=n.DERObjectIdentifier,v=n.DEREnumerated,g=n.DERUTF8String,d=n.DERNumericString,f=n.DERPrintableString,y=n.DERTeletexString,x=n.DERIA5String,k=n.DERUTCTime,P=n.DERGeneralizedTime,S=n.DERSequence,E=n.DERSet,M=n.DERTaggedObject,T=n.ASN1Util.newObject,D=Object.keys(e);if(D.length!=1)throw"key of param shall be only one.";var N=D[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+N+":")==-1)throw"undefined key: "+N;if(N=="bool")return new o(e[N]);if(N=="int")return new r(e[N]);if(N=="bitstr")return new u(e[N]);if(N=="octstr")return new s(e[N]);if(N=="null")return new w(e[N]);if(N=="oid")return new m(e[N]);if(N=="enum")return new v(e[N]);if(N=="utf8str")return new g(e[N]);if(N=="numstr")return new d(e[N]);if(N=="prnstr")return new f(e[N]);if(N=="telstr")return new y(e[N]);if(N=="ia5str")return new x(e[N]);if(N=="utctime")return new k(e[N]);if(N=="gentime")return new P(e[N]);if(N=="seq"){for(var I=e[N],O=[],F=0;F<I.length;F++){var q=T(I[F]);O.push(q)}return new S({array:O})}if(N=="set"){for(I=e[N],O=[],F=0;F<I.length;F++)q=T(I[F]),O.push(q);return new E({array:O})}if(N=="tag"){var Y=e[N];if(Object.prototype.toString.call(Y)==="[object Array]"&&Y.length==3){var _e=T(Y[2]);return new M({tag:Y[0],explicit:Y[1],obj:_e})}var ne={};if(Y.explicit!==void 0&&(ne.explicit=Y.explicit),Y.tag!==void 0&&(ne.tag=Y.tag),Y.obj===void 0)throw"obj shall be specified for 'tag'.";return ne.obj=T(Y.obj),new M(ne)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},KJUR.asn1.ASN1Util.oidHexToInt=function(e){for(var n="",o=parseInt(e.substr(0,2),16),r=(n=Math.floor(o/40)+"."+o%40,""),u=2;u<e.length;u+=2){var s=("00000000"+parseInt(e.substr(u,2),16).toString(2)).slice(-8);r+=s.substr(1,7),s.substr(0,1)=="0"&&(n=n+"."+new BigInteger(r,2).toString(10),r="")}return n},KJUR.asn1.ASN1Util.oidIntToHex=function(e){var n=function(m){var v=m.toString(16);return v.length==1&&(v="0"+v),v},o=function(m){var v="",g=new BigInteger(m,10).toString(2),d=7-g.length%7;d==7&&(d=0);for(var f="",y=0;y<d;y++)f+="0";for(g=f+g,y=0;y<g.length-1;y+=7){var x=g.substr(y,7);y!=g.length-7&&(x="1"+x),v+=n(parseInt(x,2))}return v};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",u=e.split("."),s=40*parseInt(u[0])+parseInt(u[1]);r+=n(s),u.splice(0,2);for(var w=0;w<u.length;w++)r+=o(u[w]);return r},KJUR.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n=0,v="+this.hV;var e=this.hV.length/2,n=e.toString(16);if(n.length%2==1&&(n="0"+n),e<128)return n;var o=n.length/2;if(o>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+o).toString(16)+n},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=stohex(this.s)},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(typeof e=="string"?this.setString(e):e.str!==void 0?this.setString(e.str):e.hex!==void 0&&this.setStringHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(e){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(n){return utc=n.getTime()+6e4*n.getTimezoneOffset(),new Date(utc)},this.formatDate=function(n,o,r){var u=this.zeroPadding,s=this.localDateToUTC(n),w=String(s.getFullYear());o=="utc"&&(w=w.substr(2,2));var m=w+u(String(s.getMonth()+1),2)+u(String(s.getDate()),2)+u(String(s.getHours()),2)+u(String(s.getMinutes()),2)+u(String(s.getSeconds()),2);if(r===!0){var v=s.getMilliseconds();if(v!=0){var g=u(String(v),3);m=m+"."+(g=g.replace(/[0]+$/,""))}}return m+"Z"},this.zeroPadding=function(n,o){return n.length>=o?n:new Array(o-n.length+1).join("0")+n},this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=stohex(n)},this.setByDateValue=function(n,o,r,u,s,w){var m=new Date(Date.UTC(n,o-1,r,u,s,w,0));this.setByDate(m)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(n){this.hTLV=null,this.isModified=!0,this.asn1Array=n},this.appendASN1Object=function(n){this.hTLV=null,this.isModified=!0,this.asn1Array.push(n)},this.asn1Array=new Array,e!==void 0&&e.array!==void 0&&(this.asn1Array=e.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(e){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(n){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(n)},this.setByInteger=function(n){var o=new BigInteger(String(n),10);this.setByBigInteger(o)},this.setValueHex=function(n){this.hV=n},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(e.bigint!==void 0?this.setByBigInteger(e.bigint):e.int!==void 0?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):e.hex!==void 0&&this.setValueHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(e){if(e!==void 0&&e.obj!==void 0){var n=KJUR.asn1.ASN1Util.newObject(e.obj);e.hex="00"+n.getEncodedHex()}KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(o){this.hTLV=null,this.isModified=!0,this.hV=o},this.setUnusedBitsAndHexValue=function(o,r){if(o<0||7<o)throw"unused bits shall be from 0 to 7: u = "+o;var u="0"+o;this.hTLV=null,this.isModified=!0,this.hV=u+r},this.setByBinaryString=function(o){var r=8-(o=o.replace(/0+$/,"")).length%8;r==8&&(r=0);for(var u=0;u<=r;u++)o+="0";var s="";for(u=0;u<o.length-1;u+=8){var w=o.substr(u,8),m=parseInt(w,2).toString(16);m.length==1&&(m="0"+m),s+=m}this.hTLV=null,this.isModified=!0,this.hV="0"+r+s},this.setByBooleanArray=function(o){for(var r="",u=0;u<o.length;u++)o[u]==1?r+="1":r+="0";this.setByBinaryString(r)},this.newFalseArray=function(o){for(var r=new Array(o),u=0;u<o;u++)r[u]=!1;return r},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):e.hex!==void 0?this.setHexValueIncludingUnusedBits(e.hex):e.bin!==void 0?this.setByBinaryString(e.bin):e.array!==void 0&&this.setByBooleanArray(e.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(e){if(e!==void 0&&e.obj!==void 0){var n=KJUR.asn1.ASN1Util.newObject(e.obj);e.hex=n.getEncodedHex()}KJUR.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(e){var n=function(r){var u=r.toString(16);return u.length==1&&(u="0"+u),u},o=function(r){var u="",s=new BigInteger(r,10).toString(2),w=7-s.length%7;w==7&&(w=0);for(var m="",v=0;v<w;v++)m+="0";for(s=m+s,v=0;v<s.length-1;v+=7){var g=s.substr(v,7);v!=s.length-7&&(g="1"+g),u+=n(parseInt(g,2))}return u};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(r){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueOidString=function(r){if(!r.match(/^[0-9.]+$/))throw"malformed oid string: "+r;var u="",s=r.split("."),w=40*parseInt(s[0])+parseInt(s[1]);u+=n(w),s.splice(0,2);for(var m=0;m<s.length;m++)u+=o(s[m]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueName=function(r){var u=KJUR.asn1.x509.OID.name2oid(r);if(u==="")throw"DERObjectIdentifier oidName undefined: "+r;this.setValueOidString(u)},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(typeof e=="string"?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):e.oid!==void 0?this.setValueOidString(e.oid):e.hex!==void 0?this.setValueHex(e.hex):e.name!==void 0&&this.setValueName(e.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DEREnumerated=function(e){KJUR.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(n){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(n)},this.setByInteger=function(n){var o=new BigInteger(String(n),10);this.setByBigInteger(o)},this.setValueHex=function(n){this.hV=n},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(e.int!==void 0?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):e.hex!==void 0&&this.setValueHex(e.hex))},YAHOO.lang.extend(KJUR.asn1.DEREnumerated,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(e){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(e){KJUR.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(e){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(e){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(e){KJUR.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(e){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.date=n,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},e!==void 0&&(e.str!==void 0?this.setString(e.str):typeof e=="string"&&e.match(/^[0-9]{12}Z$/)?this.setString(e):e.hex!==void 0?this.setStringHex(e.hex):e.date!==void 0&&this.setByDate(e.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(e){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.date=n,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},e!==void 0&&(e.str!==void 0?this.setString(e.str):typeof e=="string"&&e.match(/^[0-9]{14}Z$/)?this.setString(e):e.hex!==void 0?this.setStringHex(e.hex):e.date!==void 0&&this.setByDate(e.date),e.millis===!0&&(this.withMillis=!0))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(e){KJUR.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var n="",o=0;o<this.asn1Array.length;o++)n+=this.asn1Array[o].getEncodedHex();return this.hV=n,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(e){KJUR.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var n=new Array,o=0;o<this.asn1Array.length;o++){var r=this.asn1Array[o];n.push(r.getEncodedHex())}return this.sortFlag==1&&n.sort(),this.hV=n.join(""),this.hV},e!==void 0&&e.sortflag!==void 0&&e.sortflag==0&&(this.sortFlag=!1)},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(e){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(n,o,r){this.hT=o,this.isExplicit=n,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,o),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},e!==void 0&&(e.tag!==void 0&&(this.hT=e.tag),e.explicit!==void 0&&(this.isExplicit=e.explicit),e.obj!==void 0&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var __extends=(_extendStatics=function(e,n){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(o[u]=r[u])},_extendStatics(e,n)},function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}_extendStatics(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}),_extendStatics,JSEncryptRSAKey=function(e){function n(o){var r=e.call(this)||this;return o&&(typeof o=="string"?r.parseKey(o):(n.hasPrivateKeyProperty(o)||n.hasPublicKeyProperty(o))&&r.parsePropertiesFrom(o)),r}return __extends(n,e),n.prototype.parseKey=function(o){try{var r=0,u=0,s=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(o)?Hex.decode(o):Base64$1.unarmor(o),w=ASN1.decode(s);if(w.sub.length===3&&(w=w.sub[2].sub[0]),w.sub.length===9){r=w.sub[1].getHexStringValue(),this.n=parseBigInt(r,16),u=w.sub[2].getHexStringValue(),this.e=parseInt(u,16);var m=w.sub[3].getHexStringValue();this.d=parseBigInt(m,16);var v=w.sub[4].getHexStringValue();this.p=parseBigInt(v,16);var g=w.sub[5].getHexStringValue();this.q=parseBigInt(g,16);var d=w.sub[6].getHexStringValue();this.dmp1=parseBigInt(d,16);var f=w.sub[7].getHexStringValue();this.dmq1=parseBigInt(f,16);var y=w.sub[8].getHexStringValue();this.coeff=parseBigInt(y,16)}else{if(w.sub.length!==2)return!1;if(w.sub[0].sub){var x=w.sub[1].sub[0];r=x.sub[0].getHexStringValue(),this.n=parseBigInt(r,16),u=x.sub[1].getHexStringValue(),this.e=parseInt(u,16)}else r=w.sub[0].getHexStringValue(),this.n=parseBigInt(r,16),u=w.sub[1].getHexStringValue(),this.e=parseInt(u,16)}return!0}catch{return!1}},n.prototype.getPrivateBaseKey=function(){var o={array:[new KJUR.asn1.DERInteger({int:0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]};return new KJUR.asn1.DERSequence(o).getEncodedHex()},n.prototype.getPrivateBaseKeyB64=function(){return hex2b64(this.getPrivateBaseKey())},n.prototype.getPublicBaseKey=function(){var o=new KJUR.asn1.DERSequence({array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]}),r=new KJUR.asn1.DERSequence({array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e})]}),u=new KJUR.asn1.DERBitString({hex:"00"+r.getEncodedHex()});return new KJUR.asn1.DERSequence({array:[o,u]}).getEncodedHex()},n.prototype.getPublicBaseKeyB64=function(){return hex2b64(this.getPublicBaseKey())},n.wordwrap=function(o,r){if(!o)return o;var u="(.{1,"+(r=r||64)+`})( +|$
?)|(.{1,`+r+"})";return o.match(RegExp(u,"g")).join(`
`)},n.prototype.getPrivateKey=function(){var o=`-----BEGIN RSA PRIVATE KEY-----
`;return o+=n.wordwrap(this.getPrivateBaseKeyB64())+`
`,o+="-----END RSA PRIVATE KEY-----"},n.prototype.getPublicKey=function(){var o=`-----BEGIN PUBLIC KEY-----
`;return o+=n.wordwrap(this.getPublicBaseKeyB64())+`
`,o+="-----END PUBLIC KEY-----"},n.hasPublicKeyProperty=function(o){return(o=o||{}).hasOwnProperty("n")&&o.hasOwnProperty("e")},n.hasPrivateKeyProperty=function(o){return(o=o||{}).hasOwnProperty("n")&&o.hasOwnProperty("e")&&o.hasOwnProperty("d")&&o.hasOwnProperty("p")&&o.hasOwnProperty("q")&&o.hasOwnProperty("dmp1")&&o.hasOwnProperty("dmq1")&&o.hasOwnProperty("coeff")},n.prototype.parsePropertiesFrom=function(o){this.n=o.n,this.e=o.e,o.hasOwnProperty("d")&&(this.d=o.d,this.p=o.p,this.q=o.q,this.dmp1=o.dmp1,this.dmq1=o.dmq1,this.coeff=o.coeff)},n}(RSAKey),_a$1,version$1=typeof process<"u"?(_a$1=process.env)===null||_a$1===void 0?void 0:_a$1.npm_package_version:void 0,JSEncrypt=function(){function e(n){n===void 0&&(n={}),n=n||{},this.default_key_size=n.default_key_size?parseInt(n.default_key_size,10):1024,this.default_public_exponent=n.default_public_exponent||"010001",this.log=n.log||!1,this.key=null}return e.prototype.setKey=function(n){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new JSEncryptRSAKey(n)},e.prototype.setPrivateKey=function(n){this.setKey(n)},e.prototype.setPublicKey=function(n){this.setKey(n)},e.prototype.decrypt=function(n){try{return this.getKey().decrypt(b64tohex(n))}catch{return!1}},e.prototype.encrypt=function(n){try{return hex2b64(this.getKey().encrypt(n))}catch{return!1}},e.prototype.sign=function(n,o,r){try{return hex2b64(this.getKey().sign(n,o,r))}catch{return!1}},e.prototype.verify=function(n,o,r){try{return this.getKey().verify(n,b64tohex(o),r)}catch{return!1}},e.prototype.getKey=function(n){if(!this.key){if(this.key=new JSEncryptRSAKey,n&&{}.toString.call(n)==="[object Function]")return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,n);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},e.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},e.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},e.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},e.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},e.version=version$1,e}(),base64Exports={},base64={get exports(){return base64Exports},set exports(e){base64Exports=e}},module$1,exports$1;module$1=base64,exports$1=base64Exports,function(e){var n=exports$1,o=module$1&&module$1.exports==n&&module$1,r=_typeof$1(commonjsGlobal$1)=="object"&&commonjsGlobal$1;r.global!==r&&r.window!==r||(e=r);var u=function(d){this.message=d};(u.prototype=new Error).name="InvalidCharacterError";var s=function(d){throw new u(d)},w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=/[\t\n\f\r ]/g,v={encode:function(d){d=String(d),/[^\0-\xFF]/.test(d)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var f,y,x,k,P=d.length%3,S="",E=-1,M=d.length-P;++E<M;)f=d.charCodeAt(E)<<16,y=d.charCodeAt(++E)<<8,x=d.charCodeAt(++E),S+=w.charAt((k=f+y+x)>>18&63)+w.charAt(k>>12&63)+w.charAt(k>>6&63)+w.charAt(63&k);return P==2?(f=d.charCodeAt(E)<<8,y=d.charCodeAt(++E),S+=w.charAt((k=f+y)>>10)+w.charAt(k>>4&63)+w.charAt(k<<2&63)+"="):P==1&&(k=d.charCodeAt(E),S+=w.charAt(k>>2)+w.charAt(k<<4&63)+"=="),S},decode:function(d){var f=(d=String(d).replace(m,"")).length;f%4==0&&(f=(d=d.replace(/==?$/,"")).length),(f%4==1||/[^+a-zA-Z0-9/]/.test(d))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var y,x,k=0,P="",S=-1;++S<f;)x=w.indexOf(d.charAt(S)),y=k%4?64*y+x:x,k++%4&&(P+=String.fromCharCode(255&y>>(-2*k&6)));return P},version:"1.0.0"};if(n&&!n.nodeType)if(o)o.exports=v;else for(var g in v)v.hasOwnProperty(g)&&(n[g]=v[g]);else e.base64=v}(commonjsGlobal$1);var Base64=base64Exports,printExports={},print={get exports(){return printExports},set exports(e){printExports=e}},factory;factory=function(){return function(e){var n={};function o(r){if(n[r])return n[r].exports;var u=n[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,o),u.l=!0,u.exports}return o.m=e,o.c=n,o.d=function(r,u,s){o.o(r,u)||Object.defineProperty(r,u,{enumerable:!0,get:s})},o.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},o.t=function(r,u){if(1&u&&(r=o(r)),8&u||4&u&&_typeof$1(r)==="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&u&&typeof r!="string")for(var w in r)o.d(s,w,function(m){return r[m]}.bind(null,w));return s},o.n=function(r){var u=r&&r.__esModule?function(){return r.default}:function(){return r};return o.d(u,"a",u),u},o.o=function(r,u){return Object.prototype.hasOwnProperty.call(r,u)},o.p="",o(o.s=0)}({"./src/index.js":function(e,n,o){o.r(n),o("./src/sass/index.scss");var r=o("./src/js/init.js").default.init;typeof window<"u"&&(window.printJS=r),n.default=r},"./src/js/browser.js":function(e,n,o){o.r(n);var r={isFirefox:function(){return typeof InstallTrigger<"u"},isIE:function(){return navigator.userAgent.indexOf("MSIE")!==-1||!!document.documentMode},isEdge:function(){return!r.isIE()&&!!window.StyleMedia},isChrome:function(){return!!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||navigator.userAgent.toLowerCase().indexOf("safari")!==-1},isIOSChrome:function(){return navigator.userAgent.toLowerCase().indexOf("crios")!==-1}};n.default=r},"./src/js/functions.js":function(e,n,o){o.r(n),o.d(n,"addWrapper",function(){return w}),o.d(n,"capitalizePrint",function(){return m}),o.d(n,"collectStyles",function(){return v}),o.d(n,"addHeader",function(){return d}),o.d(n,"cleanUp",function(){return f}),o.d(n,"isRawHTML",function(){return y});var r=o("./src/js/modal.js"),u=o("./src/js/browser.js");function s(x){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},s(x)}function w(x,k){return'<div style="font-family:'+k.font+" !important; font-size: "+k.font_size+' !important; width:100%;">'+x+"</div>"}function m(x){return x.charAt(0).toUpperCase()+x.slice(1)}function v(x,k){for(var P="",S=(document.defaultView||window).getComputedStyle(x,""),E=0;E<S.length;E++)(k.targetStyles.indexOf("*")!==-1||k.targetStyle.indexOf(S[E])!==-1||g(k.targetStyles,S[E]))&&S.getPropertyValue(S[E])&&(P+=S[E]+":"+S.getPropertyValue(S[E])+";");return P+="max-width: "+k.maxWidth+"px !important; font-size: "+k.font_size+" !important;"}function g(x,k){for(var P=0;P<x.length;P++)if(s(k)==="object"&&k.indexOf(x[P])!==-1)return!0;return!1}function d(x,k){var P=document.createElement("div");if(y(k.header))P.innerHTML=k.header;else{var S=document.createElement("h1"),E=document.createTextNode(k.header);S.appendChild(E),S.setAttribute("style",k.headerStyle),P.appendChild(S)}x.insertBefore(P,x.childNodes[0])}function f(x){x.showModal&&r.default.close(),x.onLoadingEnd&&x.onLoadingEnd(),(x.showModal||x.onLoadingStart)&&window.URL.revokeObjectURL(x.printable);var k="mouseover";(u.default.isChrome()||u.default.isFirefox())&&(k="focus"),window.addEventListener(k,function P(){window.removeEventListener(k,P),x.onPrintDialogClose();var S=document.getElementById(x.frameId);S&&S.remove()})}function y(x){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(x)}},"./src/js/html.js":function(e,n,o){o.r(n);var r=o("./src/js/functions.js"),u=o("./src/js/print.js");function s(m){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},s(m)}function w(m,v){for(var g=m.cloneNode(),d=Array.prototype.slice.call(m.childNodes),f=0;f<d.length;f++)if(v.ignoreElements.indexOf(d[f].id)===-1){var y=w(d[f],v);g.appendChild(y)}switch(v.scanStyles&&m.nodeType===1&&g.setAttribute("style",Object(r.collectStyles)(m,v)),m.tagName){case"SELECT":g.value=m.value;break;case"CANVAS":g.getContext("2d").drawImage(m,0,0)}return g}n.default={print:function(m,v){var g,d=s(g=m.printable)==="object"&&g&&(g instanceof HTMLElement||g.nodeType===1)?m.printable:document.getElementById(m.printable);d?(m.printableElement=w(d,m),m.header&&Object(r.addHeader)(m.printableElement,m),u.default.send(m,v)):window.console.error("Invalid HTML element id: "+m.printable)}}},"./src/js/image.js":function(e,n,o){o.r(n);var r=o("./src/js/functions.js"),u=o("./src/js/print.js"),s=o("./src/js/browser.js");n.default={print:function(w,m){w.printable.constructor!==Array&&(w.printable=[w.printable]),w.printableElement=document.createElement("div"),w.printable.forEach(function(v){var g=document.createElement("img");if(g.setAttribute("style",w.imageStyle),g.src=v,s.default.isFirefox()){var d=g.src;g.src=d}var f=document.createElement("div");f.appendChild(g),w.printableElement.appendChild(f)}),w.header&&Object(r.addHeader)(w.printableElement,w),u.default.send(w,m)}}},"./src/js/init.js":function(e,n,o){o.r(n);var r=o("./src/js/browser.js"),u=o("./src/js/modal.js"),s=o("./src/js/pdf.js"),w=o("./src/js/html.js"),m=o("./src/js/raw-html.js"),v=o("./src/js/image.js"),g=o("./src/js/json.js");function d(y){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(y)}var f=["pdf","html","image","json","raw-html"];n.default={init:function(){var y={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(E){throw E},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},x=arguments[0];if(x===void 0)throw new Error("printJS expects at least 1 attribute.");switch(d(x)){case"string":y.printable=encodeURI(x),y.fallbackPrintable=y.printable,y.type=arguments[1]||y.type;break;case"object":for(var k in y.printable=x.printable,y.fallbackPrintable=x.fallbackPrintable!==void 0?x.fallbackPrintable:y.printable,y.fallbackPrintable=y.base64?"data:application/pdf;base64,".concat(y.fallbackPrintable):y.fallbackPrintable,y)k!=="printable"&&k!=="fallbackPrintable"&&(y[k]=x[k]!==void 0?x[k]:y[k]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+d(x))}if(!y.printable)throw new Error("Missing printable information.");if(!y.type||typeof y.type!="string"||f.indexOf(y.type.toLowerCase())===-1)throw new Error("Invalid print type. Available types are: pdf, html, image and json.");y.showModal&&u.default.show(y),y.onLoadingStart&&y.onLoadingStart();var P=document.getElementById(y.frameId);P&&P.parentNode.removeChild(P);var S=document.createElement("iframe");switch(r.default.isFirefox()?S.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):S.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),S.setAttribute("id",y.frameId),y.type!=="pdf"&&(S.srcdoc="<html><head><title>"+y.documentTitle+"</title>",y.css&&(Array.isArray(y.css)||(y.css=[y.css]),y.css.forEach(function(E){S.srcdoc+='<link rel="stylesheet" href="'+E+'">'})),S.srcdoc+="</head><body></body></html>"),y.type){case"pdf":if(r.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(y.fallbackPrintable,"_blank").focus(),y.onIncompatibleBrowser()}catch(E){y.onError(E)}finally{y.showModal&&u.default.close(),y.onLoadingEnd&&y.onLoadingEnd()}else s.default.print(y,S);break;case"image":v.default.print(y,S);break;case"html":w.default.print(y,S);break;case"raw-html":m.default.print(y,S);break;case"json":g.default.print(y,S)}}}},"./src/js/json.js":function(e,n,o){o.r(n);var r=o("./src/js/functions.js"),u=o("./src/js/print.js");function s(w){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},s(w)}n.default={print:function(w,m){if(s(w.printable)!=="object")throw new Error("Invalid javascript data object (JSON).");if(typeof w.repeatTableHeader!="boolean")throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!w.properties||!Array.isArray(w.properties))throw new Error("Invalid properties array for your JSON data.");w.properties=w.properties.map(function(v){return{field:s(v)==="object"?v.field:v,displayName:s(v)==="object"?v.displayName:v,columnSize:s(v)==="object"&&v.columnSize?v.columnSize+";":100/w.properties.length+"%;"}}),w.printableElement=document.createElement("div"),w.header&&Object(r.addHeader)(w.printableElement,w),w.printableElement.innerHTML+=function(v){var g=v.printable,d=v.properties,f='<table style="border-collapse: collapse; width: 100%;">';v.repeatTableHeader&&(f+="<thead>"),f+="<tr>";for(var y=0;y<d.length;y++)f+='<th style="width:'+d[y].columnSize+";"+v.gridHeaderStyle+'">'+Object(r.capitalizePrint)(d[y].displayName)+"</th>";f+="</tr>",v.repeatTableHeader&&(f+="</thead>"),f+="<tbody>";for(var x=0;x<g.length;x++){f+="<tr>";for(var k=0;k<d.length;k++){var P=g[x],S=d[k].field.split(".");if(S.length>1)for(var E=0;E<S.length;E++)P=P[S[E]];else P=P[d[k].field];f+='<td style="width:'+d[k].columnSize+v.gridStyle+'">'+P+"</td>"}f+="</tr>"}return f+="</tbody></table>"}(w),u.default.send(w,m)}}},"./src/js/modal.js":function(e,n,o){o.r(n);var r={show:function(u){var s=document.createElement("div");s.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),s.setAttribute("id","printJS-Modal");var w=document.createElement("div");w.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var m=document.createElement("div");m.setAttribute("class","printClose"),m.setAttribute("id","printClose"),w.appendChild(m);var v=document.createElement("span");v.setAttribute("class","printSpinner"),w.appendChild(v);var g=document.createTextNode(u.modalMessage);w.appendChild(g),s.appendChild(w),document.getElementsByTagName("body")[0].appendChild(s),document.getElementById("printClose").addEventListener("click",function(){r.close()})},close:function(){var u=document.getElementById("printJS-Modal");u&&u.parentNode.removeChild(u)}};n.default=r},"./src/js/pdf.js":function(e,n,o){o.r(n);var r=o("./src/js/print.js"),u=o("./src/js/functions.js");function s(w,m,v){var g=new window.Blob([v],{type:"application/pdf"});g=window.URL.createObjectURL(g),m.setAttribute("src",g),r.default.send(w,m)}n.default={print:function(w,m){if(w.base64){var v=Uint8Array.from(atob(w.printable),function(d){return d.charCodeAt(0)});s(w,m,v)}else{w.printable=/^(blob|http|\/\/)/i.test(w.printable)?w.printable:window.location.origin+(w.printable.charAt(0)!=="/"?"/"+w.printable:w.printable);var g=new window.XMLHttpRequest;g.responseType="arraybuffer",g.addEventListener("error",function(){Object(u.cleanUp)(w),w.onError(g.statusText,g)}),g.addEventListener("load",function(){if([200,201].indexOf(g.status)===-1)return Object(u.cleanUp)(w),void w.onError(g.statusText,g);s(w,m,g.response)}),g.open("GET",w.printable,!0),g.send()}}}},"./src/js/print.js":function(e,n,o){o.r(n);var r=o("./src/js/browser.js"),u=o("./src/js/functions.js"),s={send:function(m,v){document.getElementsByTagName("body")[0].appendChild(v);var g=document.getElementById(m.frameId);g.onload=function(){if(m.type!=="pdf"){var d=g.contentWindow||g.contentDocument;if(d.document&&(d=d.document),d.body.appendChild(m.printableElement),m.type!=="pdf"&&m.style){var f=document.createElement("style");f.innerHTML=m.style,d.head.appendChild(f)}var y=d.getElementsByTagName("img");y.length>0?function(x){var k=x.map(function(P){if(P.src&&P.src!==window.location.href)return function(S){return new Promise(function(E){(function M(){S&&S.naturalWidth!==void 0&&S.naturalWidth!==0&&S.complete?E():setTimeout(M,500)})()})}(P)});return Promise.all(k)}(Array.from(y)).then(function(){return w(g,m)}):w(g,m)}else r.default.isFirefox()?setTimeout(function(){return w(g,m)},1e3):w(g,m)}}};function w(m,v){try{if(m.focus(),r.default.isEdge()||r.default.isIE())try{m.contentWindow.document.execCommand("print",!1,null)}catch{m.contentWindow.print()}else m.contentWindow.print()}catch(g){v.onError(g)}finally{r.default.isFirefox()&&(m.style.visibility="hidden",m.style.left="-1px"),Object(u.cleanUp)(v)}}n.default=s},"./src/js/raw-html.js":function(e,n,o){o.r(n);var r=o("./src/js/print.js");n.default={print:function(u,s){u.printableElement=document.createElement("div"),u.printableElement.setAttribute("style","width:100%"),u.printableElement.innerHTML=u.printable,r.default.send(u,s)}}},"./src/sass/index.scss":function(e,n,o){},0:function(e,n,o){e.exports=o("./src/index.js")}}).default},print.exports=factory();var printJS=getDefaultExportFromCjs$1(printExports),FileSaver_minExports={},FileSaver_min$1={get exports(){return FileSaver_minExports},set exports(e){FileSaver_minExports=e}};(function(e,n){(function(){function o(g,d){return d===void 0?d={autoBom:!1}:_typeof$1(d)!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\uFEFF",g],{type:g.type}):g}function r(g,d,f){var y=new XMLHttpRequest;y.open("GET",g),y.responseType="blob",y.onload=function(){v(y.response,d,f)},y.onerror=function(){console.error("could not download file")},y.send()}function u(g){var d=new XMLHttpRequest;d.open("HEAD",g,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function s(g){try{g.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(d)}}var w=(typeof window>"u"?"undefined":_typeof$1(window))=="object"&&window.window===window?window:(typeof self>"u"?"undefined":_typeof$1(self))=="object"&&self.self===self?self:_typeof$1(commonjsGlobal$1)=="object"&&commonjsGlobal$1.global===commonjsGlobal$1?commonjsGlobal$1:void 0,m=w.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=w.saveAs||((typeof window>"u"?"undefined":_typeof$1(window))!="object"||window!==w?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(g,d,f){var y=w.URL||w.webkitURL,x=document.createElement("a");d=d||g.name||"download",x.download=d,x.rel="noopener",typeof g=="string"?(x.href=g,x.origin===location.origin?s(x):u(x.href)?r(g,d,f):s(x,x.target="_blank")):(x.href=y.createObjectURL(g),setTimeout(function(){y.revokeObjectURL(x.href)},4e4),setTimeout(function(){s(x)},0))}:"msSaveOrOpenBlob"in navigator?function(g,d,f){if(d=d||g.name||"download",typeof g!="string")navigator.msSaveOrOpenBlob(o(g,f),d);else if(u(g))r(g,d,f);else{var y=document.createElement("a");y.href=g,y.target="_blank",setTimeout(function(){s(y)})}}:function(g,d,f,y){if((y=y||open("","_blank"))&&(y.document.title=y.document.body.innerText="downloading..."),typeof g=="string")return r(g,d,f);var x=g.type==="application/octet-stream",k=/constructor/i.test(w.HTMLElement)||w.safari,P=/CriOS\/[\d]+/.test(navigator.userAgent);if((P||x&&k||m)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var T=S.result;T=P?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=T:location=T,y=null},S.readAsDataURL(g)}else{var E=w.URL||w.webkitURL,M=E.createObjectURL(g);y?y.location=M:location.href=M,y=null,setTimeout(function(){E.revokeObjectURL(M)},4e4)}});w.saveAs=v.saveAs=v,e.exports=v})()})(FileSaver_min$1);var lodashExports={},lodash={get exports(){return lodashExports},set exports(e){lodashExports=e}};(function(e,n){(function(){var o,r="Expected a function",u="__lodash_hash_undefined__",s="__lodash_placeholder__",w=16,m=32,v=64,g=128,d=256,f=1/0,y=9007199254740991,x=NaN,k=4294967295,P=[["ary",g],["bind",1],["bindKey",2],["curry",8],["curryRight",w],["flip",512],["partial",m],["partialRight",v],["rearg",d]],S="[object Arguments]",E="[object Array]",M="[object Boolean]",T="[object Date]",D="[object Error]",N="[object Function]",I="[object GeneratorFunction]",O="[object Map]",F="[object Number]",q="[object Object]",Y="[object Promise]",_e="[object RegExp]",ne="[object Set]",ve="[object String]",J="[object Symbol]",fe="[object WeakMap]",Z="[object ArrayBuffer]",j="[object DataView]",X="[object Float32Array]",H="[object Float64Array]",U="[object Int8Array]",te="[object Int16Array]",Q="[object Int32Array]",re="[object Uint8Array]",Pe="[object Uint8ClampedArray]",be="[object Uint16Array]",we="[object Uint32Array]",Ae=/\b__p \+= '';/g,$e=/\b(__p \+=) '' \+/g,Me=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ie=/&(?:amp|lt|gt|quot|#39);/g,Le=/[&<>"']/g,le=RegExp(Ie.source),oe=RegExp(Le.source),ke=/<%-([\s\S]+?)%>/g,Ce=/<%([\s\S]+?)%>/g,Ee=/<%=([\s\S]+?)%>/g,Be=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ve=/^\w*$/,Oe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/[\\^$.*+?()[\]{}|]/g,Ge=RegExp(je.source),Xe=/^\s+/,qe=/\s/,Ke=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Je=/\{\n\/\* \[wrapped with (.+)\] \*/,rt=/,? & /,ht=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,vt=/[()=,{}\[\]\/\s]/,Ct=/\\(\\)?/g,kt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mt=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,bt=/^0b[01]+$/i,ot=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,tt=/^(?:0|[1-9]\d*)$/,ut=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Re=/($^)/,Te=/['\n\r\u2028\u2029\\]/g,He="\\ud800-\\udfff",Fe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ze="\\u2700-\\u27bf",We="a-z\\xdf-\\xf6\\xf8-\\xff",Ue="A-Z\\xc0-\\xd6\\xd8-\\xde",et="\\ufe0e\\ufe0f",it="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nt="['\u2019]",dt="["+He+"]",xt="["+it+"]",yt="["+Fe+"]",Bt="\\d+",Pt="["+ze+"]",Tt="["+We+"]",ct="[^"+He+it+Bt+ze+We+Ue+"]",wt="\\ud83c[\\udffb-\\udfff]",St="[^"+He+"]",Ft="(?:\\ud83c[\\udde6-\\uddff]){2}",Gt="[\\ud800-\\udbff][\\udc00-\\udfff]",jt="["+Ue+"]",Ut="\\u200d",Jt="(?:"+Tt+"|"+ct+")",un="(?:"+jt+"|"+ct+")",nn="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Zt="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",en="(?:"+yt+"|"+wt+")?",Cn="["+et+"]?",$n=Cn+en+("(?:"+Ut+"(?:"+[St,Ft,Gt].join("|")+")"+Cn+en+")*"),Rn="(?:"+[Pt,Ft,Gt].join("|")+")"+$n,Nn="(?:"+[St+yt+"?",yt,Ft,Gt,dt].join("|")+")",zn=RegExp(nt,"g"),_i=RegExp(yt,"g"),$i=RegExp(wt+"(?="+wt+")|"+Nn+$n,"g"),Bo=RegExp([jt+"?"+Tt+"+"+nn+"(?="+[xt,jt,"$"].join("|")+")",un+"+"+Zt+"(?="+[xt,jt+Jt,"$"].join("|")+")",jt+"?"+Jt+"+"+nn,jt+"+"+Zt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Bt,Rn].join("|"),"g"),Ar=RegExp("["+Ut+He+Fe+et+"]"),Mr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$r=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Tr=-1,En={};En[X]=En[H]=En[U]=En[te]=En[Q]=En[re]=En[Pe]=En[be]=En[we]=!0,En[S]=En[E]=En[Z]=En[M]=En[j]=En[T]=En[D]=En[N]=En[O]=En[F]=En[q]=En[_e]=En[ne]=En[ve]=En[fe]=!1;var kn={};kn[S]=kn[E]=kn[Z]=kn[j]=kn[M]=kn[T]=kn[X]=kn[H]=kn[U]=kn[te]=kn[Q]=kn[O]=kn[F]=kn[q]=kn[_e]=kn[ne]=kn[ve]=kn[J]=kn[re]=kn[Pe]=kn[be]=kn[we]=!0,kn[D]=kn[N]=kn[fe]=!1;var Xo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},na=parseFloat,ia=parseInt,Br=_typeof$1(commonjsGlobal$1)=="object"&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,oa=(typeof self>"u"?"undefined":_typeof$1(self))=="object"&&self&&self.Object===Object&&self,Wn=Br||oa||Function("return this")(),Di=n&&!n.nodeType&&n,zi=Di&&e&&!e.nodeType&&e,co=zi&&zi.exports===Di,Wi=co&&Br.process,Zn=function(){try{var Mt=zi&&zi.require&&zi.require("util").types;return Mt||Wi&&Wi.binding&&Wi.binding("util")}catch{}}(),oi=Zn&&Zn.isArrayBuffer,Ko=Zn&&Zn.isDate,Vo=Zn&&Zn.isMap,Zo=Zn&&Zn.isRegExp,uo=Zn&&Zn.isSet,ho=Zn&&Zn.isTypedArray;function ei(Mt,Rt,It){switch(It.length){case 0:return Mt.call(Rt);case 1:return Mt.call(Rt,It[0]);case 2:return Mt.call(Rt,It[0],It[1]);case 3:return Mt.call(Rt,It[0],It[1],It[2])}return Mt.apply(Rt,It)}function ra(Mt,Rt,It,Wt){for(var dn=-1,wn=Mt==null?0:Mt.length;++dn<wn;){var qn=Mt[dn];Rt(Wt,qn,It(qn),Mt)}return Wt}function si(Mt,Rt){for(var It=-1,Wt=Mt==null?0:Mt.length;++It<Wt&&Rt(Mt[It],It,Mt)!==!1;);return Mt}function Jo(Mt,Rt){for(var It=Mt==null?0:Mt.length;It--&&Rt(Mt[It],It,Mt)!==!1;);return Mt}function Qi(Mt,Rt){for(var It=-1,Wt=Mt==null?0:Mt.length;++It<Wt;)if(!Rt(Mt[It],It,Mt))return!1;return!0}function Ni(Mt,Rt){for(var It=-1,Wt=Mt==null?0:Mt.length,dn=0,wn=[];++It<Wt;){var qn=Mt[It];Rt(qn,It,Mt)&&(wn[dn++]=qn)}return wn}function Lo(Mt,Rt){return!!(Mt!=null&&Mt.length)&&Ro(Mt,Rt,0)>-1}function Qo(Mt,Rt,It){for(var Wt=-1,dn=Mt==null?0:Mt.length;++Wt<dn;)if(It(Rt,Mt[Wt]))return!0;return!1}function Bn(Mt,Rt){for(var It=-1,Wt=Mt==null?0:Mt.length,dn=Array(Wt);++It<Wt;)dn[It]=Rt(Mt[It],It,Mt);return dn}function ji(Mt,Rt){for(var It=-1,Wt=Rt.length,dn=Mt.length;++It<Wt;)Mt[dn+It]=Rt[It];return Mt}function aa(Mt,Rt,It,Wt){var dn=-1,wn=Mt==null?0:Mt.length;for(Wt&&wn&&(It=Mt[++dn]);++dn<wn;)It=Rt(It,Mt[dn],dn,Mt);return It}function Ia(Mt,Rt,It,Wt){var dn=Mt==null?0:Mt.length;for(Wt&&dn&&(It=Mt[--dn]);dn--;)It=Rt(It,Mt[dn],dn,Mt);return It}function er(Mt,Rt){for(var It=-1,Wt=Mt==null?0:Mt.length;++It<Wt;)if(Rt(Mt[It],It,Mt))return!0;return!1}var eo=No("length");function to(Mt,Rt,It){var Wt;return It(Mt,function(dn,wn,qn){if(Rt(dn,wn,qn))return Wt=wn,!1}),Wt}function tr(Mt,Rt,It,Wt){for(var dn=Mt.length,wn=It+(Wt?1:-1);Wt?wn--:++wn<dn;)if(Rt(Mt[wn],wn,Mt))return wn;return-1}function Ro(Mt,Rt,It){return Rt==Rt?function(Wt,dn,wn){for(var qn=wn-1,gi=Wt.length;++qn<gi;)if(Wt[qn]===dn)return qn;return-1}(Mt,Rt,It):tr(Mt,nr,It)}function Oa(Mt,Rt,It,Wt){for(var dn=It-1,wn=Mt.length;++dn<wn;)if(Wt(Mt[dn],Rt))return dn;return-1}function nr(Mt){return Mt!=Mt}function Do(Mt,Rt){var It=Mt==null?0:Mt.length;return It?sa(Mt,Rt)/It:x}function No(Mt){return function(Rt){return Rt==null?o:Rt[Mt]}}function Io(Mt){return function(Rt){return Mt==null?o:Mt[Rt]}}function Fa(Mt,Rt,It,Wt,dn){return dn(Mt,function(wn,qn,gi){It=Wt?(Wt=!1,wn):Rt(It,wn,qn,gi)}),It}function sa(Mt,Rt){for(var It,Wt=-1,dn=Mt.length;++Wt<dn;){var wn=Rt(Mt[Wt]);wn!==o&&(It=It===o?wn:It+wn)}return It}function la(Mt,Rt){for(var It=-1,Wt=Array(Mt);++It<Mt;)Wt[It]=Rt(It);return Wt}function Ha(Mt){return Mt&&Mt.slice(0,Lr(Mt)+1).replace(Xe,"")}function hi(Mt){return function(Rt){return Mt(Rt)}}function ca(Mt,Rt){return Bn(Rt,function(It){return Mt[It]})}function Oo(Mt,Rt){return Mt.has(Rt)}function za(Mt,Rt){for(var It=-1,Wt=Mt.length;++It<Wt&&Ro(Rt,Mt[It],0)>-1;);return It}function Wa(Mt,Rt){for(var It=Mt.length;It--&&Ro(Rt,Mt[It],0)>-1;);return It}var $s=Io({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),no=Io({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ja(Mt){return"\\"+Xo[Mt]}function Fo(Mt){return Ar.test(Mt)}function Vr(Mt){var Rt=-1,It=Array(Mt.size);return Mt.forEach(function(Wt,dn){It[++Rt]=[dn,Wt]}),It}function fo(Mt,Rt){return function(It){return Mt(Rt(It))}}function fi(Mt,Rt){for(var It=-1,Wt=Mt.length,dn=0,wn=[];++It<Wt;){var qn=Mt[It];qn!==Rt&&qn!==s||(Mt[It]=s,wn[dn++]=It)}return wn}function po(Mt){var Rt=-1,It=Array(Mt.size);return Mt.forEach(function(Wt){It[++Rt]=Wt}),It}function Ua(Mt){var Rt=-1,It=Array(Mt.size);return Mt.forEach(function(Wt){It[++Rt]=[Wt,Wt]}),It}function Ho(Mt){return Fo(Mt)?function(Rt){for(var It=$i.lastIndex=0;$i.test(Rt);)++It;return It}(Mt):eo(Mt)}function pi(Mt){return Fo(Mt)?function(Rt){return Rt.match($i)||[]}(Mt):function(Rt){return Rt.split("")}(Mt)}function Lr(Mt){for(var Rt=Mt.length;Rt--&&qe.test(Mt.charAt(Rt)););return Rt}var ua=Io({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),zo=function Mt(Rt){var It,Wt=(Rt=Rt==null?Wn:zo.defaults(Wn.Object(),Rt,zo.pick(Wn,$r))).Array,dn=Rt.Date,wn=Rt.Error,qn=Rt.Function,gi=Rt.Math,Mn=Rt.Object,Ti=Rt.RegExp,go=Rt.String,bi=Rt.TypeError,ir=Wt.prototype,Ts=qn.prototype,Wo=Mn.prototype,or=Rt["__core-js_shared__"],Rr=Ts.toString,Sn=Wo.hasOwnProperty,qa=0,da=(It=/[^.]+$/.exec(or&&or.keys&&or.keys.IE_PROTO||""))?"Symbol(src)_1."+It:"",Ui=Wo.toString,ha=Rr.call(Mn),Ga=Wn._,Bs=Ti("^"+Rr.call(Sn).replace(je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mo=co?Rt.Buffer:o,io=Rt.Symbol,Dr=Rt.Uint8Array,fa=mo?mo.allocUnsafe:o,Nr=fo(Mn.getPrototypeOf,Mn),ar=Mn.create,jo=Wo.propertyIsEnumerable,Ir=ir.splice,Ya=io?io.isConcatSpreadable:o,vo=io?io.iterator:o,oo=io?io.toStringTag:o,yo=function(){try{var W=kr(Mn,"defineProperty");return W({},"",{}),W}catch{}}(),pa=Rt.clearTimeout!==Wn.clearTimeout&&Rt.clearTimeout,_o=dn&&dn.now!==Wn.Date.now&&dn.now,sr=Rt.setTimeout!==Wn.setTimeout&&Rt.setTimeout,bo=gi.ceil,lr=gi.floor,ga=Mn.getOwnPropertySymbols,ma=mo?mo.isBuffer:o,Xa=Rt.isFinite,Ka=ir.join,Or=fo(Mn.keys,Mn),On=gi.max,Jn=gi.min,Za=dn.now,Vs=Rt.parseInt,Ja=gi.random,va=ir.reverse,ya=kr(Rt,"DataView"),Uo=kr(Rt,"Map"),ba=kr(Rt,"Promise"),qo=kr(Rt,"Set"),cr=kr(Rt,"WeakMap"),ur=kr(Mn,"create"),dr=cr&&new cr,li={},Fr=Sr(ya),hr=Sr(Uo),Qa=Sr(ba),Hr=Sr(qo),wo=Sr(cr),qi=io?io.prototype:o,ri=qi?qi.valueOf:o,zr=qi?qi.toString:o;function at(W){if(Un(W)&&!fn(W)&&!(W instanceof gn)){if(W instanceof wi)return W;if(Sn.call(W,"__wrapped__"))return Il(W)}return new wi(W)}var Bi=function(){function W(){}return function(ye){if(!Hn(ye))return{};if(ar)return ar(ye);W.prototype=ye;var De=new W;return W.prototype=o,De}}();function fr(){}function wi(W,ye){this.__wrapped__=W,this.__actions__=[],this.__chain__=!!ye,this.__index__=0,this.__values__=o}function gn(W){this.__wrapped__=W,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function xo(W){var ye=-1,De=W==null?0:W.length;for(this.clear();++ye<De;){var Ye=W[ye];this.set(Ye[0],Ye[1])}}function Gi(W){var ye=-1,De=W==null?0:W.length;for(this.clear();++ye<De;){var Ye=W[ye];this.set(Ye[0],Ye[1])}}function Yi(W){var ye=-1,De=W==null?0:W.length;for(this.clear();++ye<De;){var Ye=W[ye];this.set(Ye[0],Ye[1])}}function Co(W){var ye=-1,De=W==null?0:W.length;for(this.__data__=new Yi;++ye<De;)this.add(W[ye])}function Vi(W){var ye=this.__data__=new Gi(W);this.size=ye.size}function es(W,ye){var De=fn(W),Ye=!De&&Pr(W),Qe=!De&&!Ye&&Go(W),st=!De&&!Ye&&!Qe&&ea(W),pt=De||Ye||Qe||st,_t=pt?la(W.length,go):[],At=_t.length;for(var Dt in W)!ye&&!Sn.call(W,Dt)||pt&&(Dt=="length"||Qe&&(Dt=="offset"||Dt=="parent")||st&&(Dt=="buffer"||Dt=="byteLength"||Dt=="byteOffset")||Mo(Dt,At))||_t.push(Dt);return _t}function ts(W){var ye=W.length;return ye?W[Ba(0,ye-1)]:o}function Ls(W,ye){return ps(Gn(W),In(ye,0,W.length))}function Rs(W){return ps(Gn(W))}function wa(W,ye,De){(De!==o&&!Ji(W[ye],De)||De===o&&!(ye in W))&&Xi(W,ye,De)}function pr(W,ye,De){var Ye=W[ye];Sn.call(W,ye)&&Ji(Ye,De)&&(De!==o||ye in W)||Xi(W,ye,De)}function Wr(W,ye){for(var De=W.length;De--;)if(Ji(W[De][0],ye))return De;return-1}function Ds(W,ye,De,Ye){return ai(W,function(Qe,st,pt){ye(Ye,Qe,De(Qe),pt)}),Ye}function xa(W,ye){return W&&Pi(ye,ii(ye),W)}function Xi(W,ye,De){ye=="__proto__"&&yo?yo(W,ye,{configurable:!0,enumerable:!0,value:De,writable:!0}):W[ye]=De}function Ca(W,ye){for(var De=-1,Ye=ye.length,Qe=Wt(Ye),st=W==null;++De<Ye;)Qe[De]=st?o:il(W,ye[De]);return Qe}function In(W,ye,De){return W==W&&(De!==o&&(W=W<=De?W:De),ye!==o&&(W=W>=ye?W:ye)),W}function ti(W,ye,De,Ye,Qe,st){var pt,_t=1&ye,At=2&ye,Dt=4&ye;if(De&&(pt=Qe?De(W,Ye,Qe,st):De(W)),pt!==o)return pt;if(!Hn(W))return W;var Lt=fn(W);if(Lt){if(pt=function(Nt){var zt=Nt.length,ln=new Nt.constructor(zt);return zt&&typeof Nt[0]=="string"&&Sn.call(Nt,"index")&&(ln.index=Nt.index,ln.input=Nt.input),ln}(W),!_t)return Gn(W,pt)}else{var Ht=ui(W),Kt=Ht==N||Ht==I;if(Go(W))return Tn(W,_t);if(Ht==q||Ht==S||Kt&&!Qe){if(pt=At||Kt?{}:Ml(W),!_t)return At?function(Nt,zt){return Pi(Nt,El(Nt),zt)}(W,function(Nt,zt){return Nt&&Pi(zt,Ai(zt),Nt)}(pt,W)):function(Nt,zt){return Pi(Nt,qs(Nt),zt)}(W,xa(pt,W))}else{if(!kn[Ht])return Qe?W:{};pt=function(Nt,zt,ln){var Yt=Nt.constructor;switch(zt){case Z:return sn(Nt);case M:case T:return new Yt(+Nt);case j:return function(hn,Pn){var tn=Pn?sn(hn.buffer):hn.buffer;return new hn.constructor(tn,hn.byteOffset,hn.byteLength)}(Nt,ln);case X:case H:case U:case te:case Q:case re:case Pe:case be:case we:return xn(Nt,ln);case O:return new Yt;case F:case ve:return new Yt(Nt);case _e:return function(hn){var Pn=new hn.constructor(hn.source,mt.exec(hn));return Pn.lastIndex=hn.lastIndex,Pn}(Nt);case ne:return new Yt;case J:return pn=Nt,ri?Mn(ri.call(pn)):{}}var pn}(W,Ht,_t)}}st||(st=new Vi);var Qt=st.get(W);if(Qt)return Qt;st.set(W,pt),nc(W)?W.forEach(function(Nt){pt.add(ti(Nt,ye,De,Nt,W,st))}):ec(W)&&W.forEach(function(Nt,zt){pt.set(zt,ti(Nt,ye,De,zt,W,st))});var rn=Lt?o:(Dt?At?Ws:zs:At?Ai:ii)(W);return si(rn||W,function(Nt,zt){rn&&(Nt=W[zt=Nt]),pr(pt,zt,ti(Nt,ye,De,zt,W,st))}),pt}function ka(W,ye,De){var Ye=De.length;if(W==null)return!Ye;for(W=Mn(W);Ye--;){var Qe=De[Ye],st=ye[Qe],pt=W[Qe];if(pt===o&&!(Qe in W)||!st(pt))return!1}return!0}function jr(W,ye,De){if(typeof W!="function")throw new bi(r);return Da(function(){W.apply(o,De)},ye)}function xi(W,ye,De,Ye){var Qe=-1,st=Lo,pt=!0,_t=W.length,At=[],Dt=ye.length;if(!_t)return At;De&&(ye=Bn(ye,hi(De))),Ye?(st=Qo,pt=!1):ye.length>=200&&(st=Oo,pt=!1,ye=new Co(ye));e:for(;++Qe<_t;){var Lt=W[Qe],Ht=De==null?Lt:De(Lt);if(Lt=Ye||Lt!==0?Lt:0,pt&&Ht==Ht){for(var Kt=Dt;Kt--;)if(ye[Kt]===Ht)continue e;At.push(Lt)}else st(ye,Ht,Ye)||At.push(Lt)}return At}at.templateSettings={escape:ke,evaluate:Ce,interpolate:Ee,variable:"",imports:{_:at}},at.prototype=fr.prototype,at.prototype.constructor=at,wi.prototype=Bi(fr.prototype),wi.prototype.constructor=wi,gn.prototype=Bi(fr.prototype),gn.prototype.constructor=gn,xo.prototype.clear=function(){this.__data__=ur?ur(null):{},this.size=0},xo.prototype.delete=function(W){var ye=this.has(W)&&delete this.__data__[W];return this.size-=ye?1:0,ye},xo.prototype.get=function(W){var ye=this.__data__;if(ur){var De=ye[W];return De===u?o:De}return Sn.call(ye,W)?ye[W]:o},xo.prototype.has=function(W){var ye=this.__data__;return ur?ye[W]!==o:Sn.call(ye,W)},xo.prototype.set=function(W,ye){var De=this.__data__;return this.size+=this.has(W)?0:1,De[W]=ur&&ye===o?u:ye,this},Gi.prototype.clear=function(){this.__data__=[],this.size=0},Gi.prototype.delete=function(W){var ye=this.__data__,De=Wr(ye,W);return!(De<0)&&(De==ye.length-1?ye.pop():Ir.call(ye,De,1),--this.size,!0)},Gi.prototype.get=function(W){var ye=this.__data__,De=Wr(ye,W);return De<0?o:ye[De][1]},Gi.prototype.has=function(W){return Wr(this.__data__,W)>-1},Gi.prototype.set=function(W,ye){var De=this.__data__,Ye=Wr(De,W);return Ye<0?(++this.size,De.push([W,ye])):De[Ye][1]=ye,this},Yi.prototype.clear=function(){this.size=0,this.__data__={hash:new xo,map:new(Uo||Gi),string:new xo}},Yi.prototype.delete=function(W){var ye=fs(this,W).delete(W);return this.size-=ye?1:0,ye},Yi.prototype.get=function(W){return fs(this,W).get(W)},Yi.prototype.has=function(W){return fs(this,W).has(W)},Yi.prototype.set=function(W,ye){var De=fs(this,W),Ye=De.size;return De.set(W,ye),this.size+=De.size==Ye?0:1,this},Co.prototype.add=Co.prototype.push=function(W){return this.__data__.set(W,u),this},Co.prototype.has=function(W){return this.__data__.has(W)},Vi.prototype.clear=function(){this.__data__=new Gi,this.size=0},Vi.prototype.delete=function(W){var ye=this.__data__,De=ye.delete(W);return this.size=ye.size,De},Vi.prototype.get=function(W){return this.__data__.get(W)},Vi.prototype.has=function(W){return this.__data__.has(W)},Vi.prototype.set=function(W,ye){var De=this.__data__;if(De instanceof Gi){var Ye=De.__data__;if(!Uo||Ye.length<199)return Ye.push([W,ye]),this.size=++De.size,this;De=this.__data__=new Yi(Ye)}return De.set(W,ye),this.size=De.size,this};var ai=gl(Li),Ci=gl(qr,!0);function gr(W,ye){var De=!0;return ai(W,function(Ye,Qe,st){return De=!!ye(Ye,Qe,st)}),De}function mr(W,ye,De){for(var Ye=-1,Qe=W.length;++Ye<Qe;){var st=W[Ye],pt=ye(st);if(pt!=null&&(_t===o?pt==pt&&!Ri(pt):De(pt,_t)))var _t=pt,At=st}return At}function ro(W,ye){var De=[];return ai(W,function(Ye,Qe,st){ye(Ye,Qe,st)&&De.push(Ye)}),De}function Kn(W,ye,De,Ye,Qe){var st=-1,pt=W.length;for(De||(De=wc),Qe||(Qe=[]);++st<pt;){var _t=W[st];ye>0&&De(_t)?ye>1?Kn(_t,ye-1,De,Ye,Qe):ji(Qe,_t):Ye||(Qe[Qe.length]=_t)}return Qe}var Ur=ml(),vr=ml(!0);function Li(W,ye){return W&&Ur(W,ye,ii)}function qr(W,ye){return W&&vr(W,ye,ii)}function yr(W,ye){return Ni(ye,function(De){return $o(W[De])})}function Ii(W,ye){for(var De=0,Ye=(ye=Vn(ye,W)).length;W!=null&&De<Ye;)W=W[so(ye[De++])];return De&&De==Ye?W:o}function Sa(W,ye,De){var Ye=ye(W);return fn(W)?Ye:ji(Ye,De(W))}function ni(W){return W==null?W===o?"[object Undefined]":"[object Null]":oo&&oo in Mn(W)?function(ye){var De=Sn.call(ye,oo),Ye=ye[oo];try{ye[oo]=o;var Qe=!0}catch{}var st=Ui.call(ye);return Qe&&(De?ye[oo]=Ye:delete ye[oo]),st}(W):function(ye){return Ui.call(ye)}(W)}function Pa(W,ye){return W>ye}function Ns(W,ye){return W!=null&&Sn.call(W,ye)}function Is(W,ye){return W!=null&&ye in Mn(W)}function Ea(W,ye,De){for(var Ye=De?Qo:Lo,Qe=W[0].length,st=W.length,pt=st,_t=Wt(st),At=1/0,Dt=[];pt--;){var Lt=W[pt];pt&&ye&&(Lt=Bn(Lt,hi(ye))),At=Jn(Lt.length,At),_t[pt]=!De&&(ye||Qe>=120&&Lt.length>=120)?new Co(pt&&Lt):o}Lt=W[0];var Ht=-1,Kt=_t[0];e:for(;++Ht<Qe&&Dt.length<At;){var Qt=Lt[Ht],rn=ye?ye(Qt):Qt;if(Qt=De||Qt!==0?Qt:0,!(Kt?Oo(Kt,rn):Ye(Dt,rn,De))){for(pt=st;--pt;){var Nt=_t[pt];if(!(Nt?Oo(Nt,rn):Ye(W[pt],rn,De)))continue e}Kt&&Kt.push(rn),Dt.push(Qt)}}return Dt}function _r(W,ye,De){var Ye=(W=Vl(W,ye=Vn(ye,W)))==null?W:W[so(Fi(ye))];return Ye==null?o:ei(Ye,W,De)}function br(W){return Un(W)&&ni(W)==S}function wr(W,ye,De,Ye,Qe){return W===ye||(W==null||ye==null||!Un(W)&&!Un(ye)?W!=W&&ye!=ye:function(st,pt,_t,At,Dt,Lt){var Ht=fn(st),Kt=fn(pt),Qt=Ht?E:ui(st),rn=Kt?E:ui(pt),Nt=(Qt=Qt==S?q:Qt)==q,zt=(rn=rn==S?q:rn)==q,ln=Qt==rn;if(ln&&Go(st)){if(!Go(pt))return!1;Ht=!0,Nt=!1}if(ln&&!Nt)return Lt||(Lt=new Vi),Ht||ea(st)?Pl(st,pt,_t,At,Dt,Lt):function(tn,cn,Qn,Xn,yi,Dn,di){switch(Qn){case j:if(tn.byteLength!=cn.byteLength||tn.byteOffset!=cn.byteOffset)return!1;tn=tn.buffer,cn=cn.buffer;case Z:return!(tn.byteLength!=cn.byteLength||!Dn(new Dr(tn),new Dr(cn)));case M:case T:case F:return Ji(+tn,+cn);case D:return tn.name==cn.name&&tn.message==cn.message;case _e:case ve:return tn==cn+"";case O:var lo=Vr;case ne:var Yo=1&Xn;if(lo||(lo=po),tn.size!=cn.size&&!Yo)return!1;var Cs=di.get(tn);if(Cs)return Cs==cn;Xn|=2,di.set(tn,cn);var fl=Pl(lo(tn),lo(cn),Xn,yi,Dn,di);return di.delete(tn),fl;case J:if(ri)return ri.call(tn)==ri.call(cn)}return!1}(st,pt,Qt,_t,At,Dt,Lt);if(!(1&_t)){var Yt=Nt&&Sn.call(st,"__wrapped__"),pn=zt&&Sn.call(pt,"__wrapped__");if(Yt||pn){var hn=Yt?st.value():st,Pn=pn?pt.value():pt;return Lt||(Lt=new Vi),Dt(hn,Pn,_t,At,Lt)}}return ln?(Lt||(Lt=new Vi),function(tn,cn,Qn,Xn,yi,Dn){var di=1&Qn,lo=zs(tn),Yo=lo.length,Cs=zs(cn),fl=Cs.length;if(Yo!=fl&&!di)return!1;for(var ks=Yo;ks--;){var Er=lo[ks];if(!(di?Er in cn:Sn.call(cn,Er)))return!1}var mc=Dn.get(tn),vc=Dn.get(cn);if(mc&&vc)return mc==cn&&vc==tn;var Ss=!0;Dn.set(tn,cn),Dn.set(cn,tn);for(var pl=di;++ks<Yo;){var Ps=tn[Er=lo[ks]],Es=cn[Er];if(Xn)var yc=di?Xn(Es,Ps,Er,cn,tn,Dn):Xn(Ps,Es,Er,tn,cn,Dn);if(!(yc===o?Ps===Es||yi(Ps,Es,Qn,Xn,Dn):yc)){Ss=!1;break}pl||(pl=Er=="constructor")}if(Ss&&!pl){var As=tn.constructor,Ms=cn.constructor;As==Ms||!("constructor"in tn)||!("constructor"in cn)||typeof As=="function"&&As instanceof As&&typeof Ms=="function"&&Ms instanceof Ms||(Ss=!1)}return Dn.delete(tn),Dn.delete(cn),Ss}(st,pt,_t,At,Dt,Lt)):!1}(W,ye,De,Ye,wr,Qe))}function Gr(W,ye,De,Ye){var Qe=De.length,st=Qe,pt=!Ye;if(W==null)return!st;for(W=Mn(W);Qe--;){var _t=De[Qe];if(pt&&_t[2]?_t[1]!==W[_t[0]]:!(_t[0]in W))return!1}for(;++Qe<st;){var At=(_t=De[Qe])[0],Dt=W[At],Lt=_t[1];if(pt&&_t[2]){if(Dt===o&&!(At in W))return!1}else{var Ht=new Vi;if(Ye)var Kt=Ye(Dt,Lt,At,W,ye,Ht);if(!(Kt===o?wr(Lt,Dt,3,Ye,Ht):Kt))return!1}}return!0}function Aa(W){return!(!Hn(W)||(ye=W,da&&da in ye))&&($o(W)?Bs:ot).test(Sr(W));var ye}function Yr(W){return typeof W=="function"?W:W==null?Mi:_typeof$1(W)=="object"?fn(W)?is(W[0],W[1]):ns(W):gc(W)}function xr(W){if(!Ra(W))return Or(W);var ye=[];for(var De in Mn(W))Sn.call(W,De)&&De!="constructor"&&ye.push(De);return ye}function Xr(W){if(!Hn(W))return function(Qe){var st=[];if(Qe!=null)for(var pt in Mn(Qe))st.push(pt);return st}(W);var ye=Ra(W),De=[];for(var Ye in W)(Ye!="constructor"||!ye&&Sn.call(W,Ye))&&De.push(Ye);return De}function Oi(W,ye){return W<ye}function Cr(W,ye){var De=-1,Ye=Ei(W)?Wt(W.length):[];return ai(W,function(Qe,st,pt){Ye[++De]=ye(Qe,st,pt)}),Ye}function ns(W){var ye=Us(W);return ye.length==1&&ye[0][2]?Tl(ye[0][0],ye[0][1]):function(De){return De===W||Gr(De,W,ye)}}function is(W,ye){return Gs(W)&&$l(ye)?Tl(so(W),ye):function(De){var Ye=il(De,W);return Ye===o&&Ye===ye?ol(De,W):wr(ye,Ye,3)}}function ko(W,ye,De,Ye,Qe){W!==ye&&Ur(ye,function(st,pt){if(Qe||(Qe=new Vi),Hn(st))(function(At,Dt,Lt,Ht,Kt,Qt,rn){var Nt=Xs(At,Lt),zt=Xs(Dt,Lt),ln=rn.get(zt);if(ln)return void wa(At,Lt,ln);var Yt=Qt?Qt(Nt,zt,Lt+"",At,Dt,rn):o,pn=Yt===o;if(pn){var hn=fn(zt),Pn=!hn&&Go(zt),tn=!hn&&!Pn&&ea(zt);Yt=zt,hn||Pn||tn?fn(Nt)?Yt=Nt:Yn(Nt)?Yt=Gn(Nt):Pn?(pn=!1,Yt=Tn(zt,!0)):tn?(pn=!1,Yt=xn(zt,!0)):Yt=[]:Na(zt)||Pr(zt)?(Yt=Nt,Pr(Nt)?Yt=rc(Nt):Hn(Nt)&&!$o(Nt)||(Yt=Ml(zt))):pn=!1}pn&&(rn.set(zt,Yt),Kt(Yt,zt,Ht,Qt,rn),rn.delete(zt)),wa(At,Lt,Yt)})(W,ye,pt,De,ko,Ye,Qe);else{var _t=Ye?Ye(Xs(W,pt),st,pt+"",W,ye,Qe):o;_t===o&&(_t=st),wa(W,pt,_t)}},Ai)}function Ma(W,ye){var De=W.length;if(De)return Mo(ye+=ye<0?De:0,De)?W[ye]:o}function os(W,ye,De){ye=ye.length?Bn(ye,function(st){return fn(st)?function(pt){return Ii(pt,st.length===1?st[0]:st)}:st}):[Mi];var Ye=-1;ye=Bn(ye,hi(an()));var Qe=Cr(W,function(st,pt,_t){var At=Bn(ye,function(Dt){return Dt(st)});return{criteria:At,index:++Ye,value:st}});return function(st,pt){var _t=st.length;for(st.sort(pt);_t--;)st[_t]=st[_t].value;return st}(Qe,function(st,pt){return function(_t,At,Dt){for(var Lt=-1,Ht=_t.criteria,Kt=At.criteria,Qt=Ht.length,rn=Dt.length;++Lt<Qt;){var Nt=Ln(Ht[Lt],Kt[Lt]);if(Nt)return Lt>=rn?Nt:Nt*(Dt[Lt]=="desc"?-1:1)}return _t.index-At.index}(st,pt,De)})}function $a(W,ye,De){for(var Ye=-1,Qe=ye.length,st={};++Ye<Qe;){var pt=ye[Ye],_t=Ii(W,pt);De(_t,pt)&&So(st,Vn(pt,W),_t)}return st}function Ta(W,ye,De,Ye){var Qe=Ye?Oa:Ro,st=-1,pt=ye.length,_t=W;for(W===ye&&(ye=Gn(ye)),De&&(_t=Bn(W,hi(De)));++st<pt;)for(var At=0,Dt=ye[st],Lt=De?De(Dt):Dt;(At=Qe(_t,Lt,At,Ye))>-1;)_t!==W&&Ir.call(_t,At,1),Ir.call(W,At,1);return W}function rs(W,ye){for(var De=W?ye.length:0,Ye=De-1;De--;){var Qe=ye[De];if(De==Ye||Qe!==st){var st=Qe;Mo(Qe)?Ir.call(W,Qe,1):qt(W,Qe)}}return W}function Ba(W,ye){return W+lr(Ja()*(ye-W+1))}function Va(W,ye){var De="";if(!W||ye<1||ye>y)return De;do ye%2&&(De+=W),(ye=lr(ye/2))&&(W+=W);while(ye);return De}function mn(W,ye){return Ks(Bl(W,ye,Mi),W+"")}function Os(W){return ts(ta(W))}function Kr(W,ye){var De=ta(W);return ps(De,In(ye,0,De.length))}function So(W,ye,De,Ye){if(!Hn(W))return W;for(var Qe=-1,st=(ye=Vn(ye,W)).length,pt=st-1,_t=W;_t!=null&&++Qe<st;){var At=so(ye[Qe]),Dt=De;if(At==="__proto__"||At==="constructor"||At==="prototype")return W;if(Qe!=pt){var Lt=_t[At];(Dt=Ye?Ye(Lt,At,_t):o)===o&&(Dt=Hn(Lt)?Lt:Mo(ye[Qe+1])?[]:{})}pr(_t,At,Dt),_t=_t[At]}return W}var Po=dr?function(W,ye){return dr.set(W,ye),W}:Mi,as=yo?function(W,ye){return yo(W,"toString",{configurable:!0,enumerable:!1,value:al(ye),writable:!0})}:Mi;function Se(W){return ps(ta(W))}function Ne(W,ye,De){var Ye=-1,Qe=W.length;ye<0&&(ye=-ye>Qe?0:Qe+ye),(De=De>Qe?Qe:De)<0&&(De+=Qe),Qe=ye>De?0:De-ye>>>0,ye>>>=0;for(var st=Wt(Qe);++Ye<Qe;)st[Ye]=W[Ye+ye];return st}function Ze(W,ye){var De;return ai(W,function(Ye,Qe,st){return!(De=ye(Ye,Qe,st))}),!!De}function lt(W,ye,De){var Ye=0,Qe=W==null?Ye:W.length;if(typeof ye=="number"&&ye==ye&&Qe<=2147483647){for(;Ye<Qe;){var st=Ye+Qe>>>1,pt=W[st];pt!==null&&!Ri(pt)&&(De?pt<=ye:pt<ye)?Ye=st+1:Qe=st}return Qe}return ft(W,ye,Mi,De)}function ft(W,ye,De,Ye){var Qe=0,st=W==null?0:W.length;if(st===0)return 0;for(var pt=(ye=De(ye))!=ye,_t=ye===null,At=Ri(ye),Dt=ye===o;Qe<st;){var Lt=lr((Qe+st)/2),Ht=De(W[Lt]),Kt=Ht!==o,Qt=Ht===null,rn=Ht==Ht,Nt=Ri(Ht);if(pt)var zt=Ye||rn;else zt=Dt?rn&&(Ye||Kt):_t?rn&&Kt&&(Ye||!Qt):At?rn&&Kt&&!Qt&&(Ye||!Nt):!Qt&&!Nt&&(Ye?Ht<=ye:Ht<ye);zt?Qe=Lt+1:st=Lt}return Jn(st,4294967294)}function Et(W,ye){for(var De=-1,Ye=W.length,Qe=0,st=[];++De<Ye;){var pt=W[De],_t=ye?ye(pt):pt;if(!De||!Ji(_t,At)){var At=_t;st[Qe++]=pt===0?0:pt}}return st}function $t(W){return typeof W=="number"?W:Ri(W)?x:+W}function Ot(W){if(typeof W=="string")return W;if(fn(W))return Bn(W,Ot)+"";if(Ri(W))return zr?zr.call(W):"";var ye=W+"";return ye=="0"&&1/W==-1/0?"-0":ye}function Xt(W,ye,De){var Ye=-1,Qe=Lo,st=W.length,pt=!0,_t=[],At=_t;if(De)pt=!1,Qe=Qo;else if(st>=200){var Dt=ye?null:_c(W);if(Dt)return po(Dt);pt=!1,Qe=Oo,At=new Co}else At=ye?[]:_t;e:for(;++Ye<st;){var Lt=W[Ye],Ht=ye?ye(Lt):Lt;if(Lt=De||Lt!==0?Lt:0,pt&&Ht==Ht){for(var Kt=At.length;Kt--;)if(At[Kt]===Ht)continue e;ye&&At.push(Ht),_t.push(Lt)}else Qe(At,Ht,De)||(At!==_t&&At.push(Ht),_t.push(Lt))}return _t}function qt(W,ye){return(W=Vl(W,ye=Vn(ye,W)))==null||delete W[so(Fi(ye))]}function bn(W,ye,De,Ye){return So(W,ye,De(Ii(W,ye)),Ye)}function _n(W,ye,De,Ye){for(var Qe=W.length,st=Ye?Qe:-1;(Ye?st--:++st<Qe)&&ye(W[st],st,W););return De?Ne(W,Ye?0:st,Ye?st+1:Qe):Ne(W,Ye?st+1:0,Ye?Qe:st)}function yn(W,ye){var De=W;return De instanceof gn&&(De=De.value()),aa(ye,function(Ye,Qe){return Qe.func.apply(Qe.thisArg,ji([Ye],Qe.args))},De)}function Fn(W,ye,De){var Ye=W.length;if(Ye<2)return Ye?Xt(W[0]):[];for(var Qe=-1,st=Wt(Ye);++Qe<Ye;)for(var pt=W[Qe],_t=-1;++_t<Ye;)_t!=Qe&&(st[Qe]=xi(st[Qe]||pt,W[_t],ye,De));return Xt(Kn(st,1),ye,De)}function mi(W,ye,De){for(var Ye=-1,Qe=W.length,st=ye.length,pt={};++Ye<Qe;){var _t=Ye<st?ye[Ye]:o;De(pt,W[Ye],_t)}return pt}function ci(W){return Yn(W)?W:[]}function ki(W){return typeof W=="function"?W:Mi}function Vn(W,ye){return fn(W)?W:Gs(W,ye)?[W]:Nl(An(W))}var Ki=mn;function jn(W,ye,De){var Ye=W.length;return De=De===o?Ye:De,!ye&&De>=Ye?W:Ne(W,ye,De)}var ao=pa||function(W){return Wn.clearTimeout(W)};function Tn(W,ye){if(ye)return W.slice();var De=W.length,Ye=fa?fa(De):new W.constructor(De);return W.copy(Ye),Ye}function sn(W){var ye=new W.constructor(W.byteLength);return new Dr(ye).set(new Dr(W)),ye}function xn(W,ye){var De=ye?sn(W.buffer):W.buffer;return new W.constructor(De,W.byteOffset,W.length)}function Ln(W,ye){if(W!==ye){var De=W!==o,Ye=W===null,Qe=W==W,st=Ri(W),pt=ye!==o,_t=ye===null,At=ye==ye,Dt=Ri(ye);if(!_t&&!Dt&&!st&&W>ye||st&&pt&&At&&!_t&&!Dt||Ye&&pt&&At||!De&&At||!Qe)return 1;if(!Ye&&!st&&!Dt&&W<ye||Dt&&De&&Qe&&!Ye&&!st||_t&&De&&Qe||!pt&&Qe||!At)return-1}return 0}function Si(W,ye,De,Ye){for(var Qe=-1,st=W.length,pt=De.length,_t=-1,At=ye.length,Dt=On(st-pt,0),Lt=Wt(At+Dt),Ht=!Ye;++_t<At;)Lt[_t]=ye[_t];for(;++Qe<pt;)(Ht||Qe<st)&&(Lt[De[Qe]]=W[Qe]);for(;Dt--;)Lt[_t++]=W[Qe++];return Lt}function Zi(W,ye,De,Ye){for(var Qe=-1,st=W.length,pt=-1,_t=De.length,At=-1,Dt=ye.length,Lt=On(st-_t,0),Ht=Wt(Lt+Dt),Kt=!Ye;++Qe<Lt;)Ht[Qe]=W[Qe];for(var Qt=Qe;++At<Dt;)Ht[Qt+At]=ye[At];for(;++pt<_t;)(Kt||Qe<st)&&(Ht[Qt+De[pt]]=W[Qe++]);return Ht}function Gn(W,ye){var De=-1,Ye=W.length;for(ye||(ye=Wt(Ye));++De<Ye;)ye[De]=W[De];return ye}function Pi(W,ye,De,Ye){var Qe=!De;De||(De={});for(var st=-1,pt=ye.length;++st<pt;){var _t=ye[st],At=Ye?Ye(De[_t],W[_t],_t,De,W):o;At===o&&(At=W[_t]),Qe?Xi(De,_t,At):pr(De,_t,At)}return De}function ss(W,ye){return function(De,Ye){var Qe=fn(De)?ra:Ds,st=ye?ye():{};return Qe(De,W,an(Ye,2),st)}}function Zr(W){return mn(function(ye,De){var Ye=-1,Qe=De.length,st=Qe>1?De[Qe-1]:o,pt=Qe>2?De[2]:o;for(st=W.length>3&&typeof st=="function"?(Qe--,st):o,pt&&vi(De[0],De[1],pt)&&(st=Qe<3?o:st,Qe=1),ye=Mn(ye);++Ye<Qe;){var _t=De[Ye];_t&&W(ye,_t,Ye,st)}return ye})}function gl(W,ye){return function(De,Ye){if(De==null)return De;if(!Ei(De))return W(De,Ye);for(var Qe=De.length,st=ye?Qe:-1,pt=Mn(De);(ye?st--:++st<Qe)&&Ye(pt[st],st,pt)!==!1;);return De}}function ml(W){return function(ye,De,Ye){for(var Qe=-1,st=Mn(ye),pt=Ye(ye),_t=pt.length;_t--;){var At=pt[W?_t:++Qe];if(De(st[At],At,st)===!1)break}return ye}}function vl(W){return function(ye){var De=Fo(ye=An(ye))?pi(ye):o,Ye=De?De[0]:ye.charAt(0),Qe=De?jn(De,1).join(""):ye.slice(1);return Ye[W]()+Qe}}function Jr(W){return function(ye){return aa(fc(hc(ye).replace(zn,"")),W,"")}}function La(W){return function(){var ye=arguments;switch(ye.length){case 0:return new W;case 1:return new W(ye[0]);case 2:return new W(ye[0],ye[1]);case 3:return new W(ye[0],ye[1],ye[2]);case 4:return new W(ye[0],ye[1],ye[2],ye[3]);case 5:return new W(ye[0],ye[1],ye[2],ye[3],ye[4]);case 6:return new W(ye[0],ye[1],ye[2],ye[3],ye[4],ye[5]);case 7:return new W(ye[0],ye[1],ye[2],ye[3],ye[4],ye[5],ye[6])}var De=Bi(W.prototype),Ye=W.apply(De,ye);return Hn(Ye)?Ye:De}}function yl(W){return function(ye,De,Ye){var Qe=Mn(ye);if(!Ei(ye)){var st=an(De,3);ye=ii(ye),De=function(_t){return st(Qe[_t],_t,Qe)}}var pt=W(ye,De,Ye);return pt>-1?Qe[st?ye[pt]:pt]:o}}function _l(W){return Ao(function(ye){var De=ye.length,Ye=De,Qe=wi.prototype.thru;for(W&&ye.reverse();Ye--;){var st=ye[Ye];if(typeof st!="function")throw new bi(r);if(Qe&&!pt&&hs(st)=="wrapper")var pt=new wi([],!0)}for(Ye=pt?Ye:De;++Ye<De;){var _t=hs(st=ye[Ye]),At=_t=="wrapper"?js(st):o;pt=At&&Ys(At[0])&&At[1]==424&&!At[4].length&&At[9]==1?pt[hs(At[0])].apply(pt,At[3]):st.length==1&&Ys(st)?pt[_t]():pt.thru(st)}return function(){var Dt=arguments,Lt=Dt[0];if(pt&&Dt.length==1&&fn(Lt))return pt.plant(Lt).value();for(var Ht=0,Kt=De?ye[Ht].apply(this,Dt):Lt;++Ht<De;)Kt=ye[Ht].call(this,Kt);return Kt}})}function ls(W,ye,De,Ye,Qe,st,pt,_t,At,Dt){var Lt=ye&g,Ht=1&ye,Kt=2&ye,Qt=24&ye,rn=512&ye,Nt=Kt?o:La(W);return function zt(){for(var ln=arguments.length,Yt=Wt(ln),pn=ln;pn--;)Yt[pn]=arguments[pn];if(Qt)var hn=Qr(zt),Pn=function(Xn,yi){for(var Dn=Xn.length,di=0;Dn--;)Xn[Dn]===yi&&++di;return di}(Yt,hn);if(Ye&&(Yt=Si(Yt,Ye,Qe,Qt)),st&&(Yt=Zi(Yt,st,pt,Qt)),ln-=Pn,Qt&&ln<Dt){var tn=fi(Yt,hn);return xl(W,ye,ls,zt.placeholder,De,Yt,tn,_t,At,Dt-ln)}var cn=Ht?De:this,Qn=Kt?cn[W]:W;return ln=Yt.length,_t?Yt=function(Xn,yi){for(var Dn=Xn.length,di=Jn(yi.length,Dn),lo=Gn(Xn);di--;){var Yo=yi[di];Xn[di]=Mo(Yo,Dn)?lo[Yo]:o}return Xn}(Yt,_t):rn&&ln>1&&Yt.reverse(),Lt&&At<ln&&(Yt.length=At),this&&this!==Wn&&this instanceof zt&&(Qn=Nt||La(Qn)),Qn.apply(cn,Yt)}}function bl(W,ye){return function(De,Ye){return function(Qe,st,pt,_t){return Li(Qe,function(At,Dt,Lt){st(_t,pt(At),Dt,Lt)}),_t}(De,W,ye(Ye),{})}}function cs(W,ye){return function(De,Ye){var Qe;if(De===o&&Ye===o)return ye;if(De!==o&&(Qe=De),Ye!==o){if(Qe===o)return Ye;typeof De=="string"||typeof Ye=="string"?(De=Ot(De),Ye=Ot(Ye)):(De=$t(De),Ye=$t(Ye)),Qe=W(De,Ye)}return Qe}}function Fs(W){return Ao(function(ye){return ye=Bn(ye,hi(an())),mn(function(De){var Ye=this;return W(ye,function(Qe){return ei(Qe,Ye,De)})})})}function us(W,ye){var De=(ye=ye===o?" ":Ot(ye)).length;if(De<2)return De?Va(ye,W):ye;var Ye=Va(ye,bo(W/Ho(ye)));return Fo(ye)?jn(pi(Ye),0,W).join(""):Ye.slice(0,W)}function wl(W){return function(ye,De,Ye){return Ye&&typeof Ye!="number"&&vi(ye,De,Ye)&&(De=Ye=o),ye=To(ye),De===o?(De=ye,ye=0):De=To(De),function(Qe,st,pt,_t){for(var At=-1,Dt=On(bo((st-Qe)/(pt||1)),0),Lt=Wt(Dt);Dt--;)Lt[_t?Dt:++At]=Qe,Qe+=pt;return Lt}(ye,De,Ye=Ye===o?ye<De?1:-1:To(Ye),W)}}function ds(W){return function(ye,De){return typeof ye=="string"&&typeof De=="string"||(ye=Hi(ye),De=Hi(De)),W(ye,De)}}function xl(W,ye,De,Ye,Qe,st,pt,_t,At,Dt){var Lt=8&ye;ye|=Lt?m:v,4&(ye&=~(Lt?v:m))||(ye&=-4);var Ht=[W,ye,Qe,Lt?st:o,Lt?pt:o,Lt?o:st,Lt?o:pt,_t,At,Dt],Kt=De.apply(o,Ht);return Ys(W)&&Ll(Kt,Ht),Kt.placeholder=Ye,Rl(Kt,W,ye)}function Hs(W){var ye=gi[W];return function(De,Ye){if(De=Hi(De),(Ye=Ye==null?0:Jn(vn(Ye),292))&&Xa(De)){var Qe=(An(De)+"e").split("e");return+((Qe=(An(ye(Qe[0]+"e"+(+Qe[1]+Ye)))+"e").split("e"))[0]+"e"+(+Qe[1]-Ye))}return ye(De)}}var _c=qo&&1/po(new qo([,-0]))[1]==f?function(W){return new qo(W)}:cl;function Cl(W){return function(ye){var De=ui(ye);return De==O?Vr(ye):De==ne?Ua(ye):function(Ye,Qe){return Bn(Qe,function(st){return[st,Ye[st]]})}(ye,W(ye))}}function Eo(W,ye,De,Ye,Qe,st,pt,_t){var At=2&ye;if(!At&&typeof W!="function")throw new bi(r);var Dt=Ye?Ye.length:0;if(Dt||(ye&=-97,Ye=Qe=o),pt=pt===o?pt:On(vn(pt),0),_t=_t===o?_t:vn(_t),Dt-=Qe?Qe.length:0,ye&v){var Lt=Ye,Ht=Qe;Ye=Qe=o}var Kt=At?o:js(W),Qt=[W,ye,De,Ye,Qe,Lt,Ht,st,pt,_t];if(Kt&&function(Nt,zt){var ln=Nt[1],Yt=zt[1],pn=ln|Yt,hn=pn<131,Pn=Yt==g&&ln==8||Yt==g&&ln==d&&Nt[7].length<=zt[8]||Yt==384&&zt[7].length<=zt[8]&&ln==8;if(!hn&&!Pn)return Nt;1&Yt&&(Nt[2]=zt[2],pn|=1&ln?0:4);var tn=zt[3];if(tn){var cn=Nt[3];Nt[3]=cn?Si(cn,tn,zt[4]):tn,Nt[4]=cn?fi(Nt[3],s):zt[4]}(tn=zt[5])&&(cn=Nt[5],Nt[5]=cn?Zi(cn,tn,zt[6]):tn,Nt[6]=cn?fi(Nt[5],s):zt[6]),(tn=zt[7])&&(Nt[7]=tn),Yt&g&&(Nt[8]=Nt[8]==null?zt[8]:Jn(Nt[8],zt[8])),Nt[9]==null&&(Nt[9]=zt[9]),Nt[0]=zt[0],Nt[1]=pn}(Qt,Kt),W=Qt[0],ye=Qt[1],De=Qt[2],Ye=Qt[3],Qe=Qt[4],!(_t=Qt[9]=Qt[9]===o?At?0:W.length:On(Qt[9]-Dt,0))&&24&ye&&(ye&=-25),ye&&ye!=1)rn=ye==8||ye==w?function(Nt,zt,ln){var Yt=La(Nt);return function pn(){for(var hn=arguments.length,Pn=Wt(hn),tn=hn,cn=Qr(pn);tn--;)Pn[tn]=arguments[tn];var Qn=hn<3&&Pn[0]!==cn&&Pn[hn-1]!==cn?[]:fi(Pn,cn);return(hn-=Qn.length)<ln?xl(Nt,zt,ls,pn.placeholder,o,Pn,Qn,o,o,ln-hn):ei(this&&this!==Wn&&this instanceof pn?Yt:Nt,this,Pn)}}(W,ye,_t):ye!=m&&ye!=33||Qe.length?ls.apply(o,Qt):function(Nt,zt,ln,Yt){var pn=1&zt,hn=La(Nt);return function Pn(){for(var tn=-1,cn=arguments.length,Qn=-1,Xn=Yt.length,yi=Wt(Xn+cn),Dn=this&&this!==Wn&&this instanceof Pn?hn:Nt;++Qn<Xn;)yi[Qn]=Yt[Qn];for(;cn--;)yi[Qn++]=arguments[++tn];return ei(Dn,pn?ln:this,yi)}}(W,ye,De,Ye);else var rn=function(Nt,zt,ln){var Yt=1&zt,pn=La(Nt);return function hn(){return(this&&this!==Wn&&this instanceof hn?pn:Nt).apply(Yt?ln:this,arguments)}}(W,ye,De);return Rl((Kt?Po:Ll)(rn,Qt),W,ye)}function kl(W,ye,De,Ye){return W===o||Ji(W,Wo[De])&&!Sn.call(Ye,De)?ye:W}function Sl(W,ye,De,Ye,Qe,st){return Hn(W)&&Hn(ye)&&(st.set(ye,W),ko(W,ye,o,Sl,st),st.delete(ye)),W}function bc(W){return Na(W)?o:W}function Pl(W,ye,De,Ye,Qe,st){var pt=1&De,_t=W.length,At=ye.length;if(_t!=At&&!(pt&&At>_t))return!1;var Dt=st.get(W),Lt=st.get(ye);if(Dt&&Lt)return Dt==ye&&Lt==W;var Ht=-1,Kt=!0,Qt=2&De?new Co:o;for(st.set(W,ye),st.set(ye,W);++Ht<_t;){var rn=W[Ht],Nt=ye[Ht];if(Ye)var zt=pt?Ye(Nt,rn,Ht,ye,W,st):Ye(rn,Nt,Ht,W,ye,st);if(zt!==o){if(zt)continue;Kt=!1;break}if(Qt){if(!er(ye,function(ln,Yt){if(!Oo(Qt,Yt)&&(rn===ln||Qe(rn,ln,De,Ye,st)))return Qt.push(Yt)})){Kt=!1;break}}else if(rn!==Nt&&!Qe(rn,Nt,De,Ye,st)){Kt=!1;break}}return st.delete(W),st.delete(ye),Kt}function Ao(W){return Ks(Bl(W,o,Hl),W+"")}function zs(W){return Sa(W,ii,qs)}function Ws(W){return Sa(W,Ai,El)}var js=dr?function(W){return dr.get(W)}:cl;function hs(W){for(var ye=W.name+"",De=li[ye],Ye=Sn.call(li,ye)?De.length:0;Ye--;){var Qe=De[Ye],st=Qe.func;if(st==null||st==W)return Qe.name}return ye}function Qr(W){return(Sn.call(at,"placeholder")?at:W).placeholder}function an(){var W=at.iteratee||sl;return W=W===sl?Yr:W,arguments.length?W(arguments[0],arguments[1]):W}function fs(W,ye){var De=W.__data__;return function(Ye){var Qe=_typeof$1(Ye);return Qe=="string"||Qe=="number"||Qe=="symbol"||Qe=="boolean"?Ye!=="__proto__":Ye===null}(ye)?De[typeof ye=="string"?"string":"hash"]:De.map}function Us(W){for(var ye=ii(W),De=ye.length;De--;){var Ye=ye[De],Qe=W[Ye];ye[De]=[Ye,Qe,$l(Qe)]}return ye}function kr(W,ye){var De=function(Ye,Qe){return Ye==null?o:Ye[Qe]}(W,ye);return Aa(De)?De:o}var qs=ga?function(W){return W==null?[]:(W=Mn(W),Ni(ga(W),function(ye){return jo.call(W,ye)}))}:ul,El=ga?function(W){for(var ye=[];W;)ji(ye,qs(W)),W=Nr(W);return ye}:ul,ui=ni;function Al(W,ye,De){for(var Ye=-1,Qe=(ye=Vn(ye,W)).length,st=!1;++Ye<Qe;){var pt=so(ye[Ye]);if(!(st=W!=null&&De(W,pt)))break;W=W[pt]}return st||++Ye!=Qe?st:!!(Qe=W==null?0:W.length)&&bs(Qe)&&Mo(pt,Qe)&&(fn(W)||Pr(W))}function Ml(W){return typeof W.constructor!="function"||Ra(W)?{}:Bi(Nr(W))}function wc(W){return fn(W)||Pr(W)||!!(Ya&&W&&W[Ya])}function Mo(W,ye){var De=_typeof$1(W);return!!(ye=ye==null?y:ye)&&(De=="number"||De!="symbol"&&tt.test(W))&&W>-1&&W%1==0&&W<ye}function vi(W,ye,De){if(!Hn(De))return!1;var Ye=_typeof$1(ye);return!!(Ye=="number"?Ei(De)&&Mo(ye,De.length):Ye=="string"&&ye in De)&&Ji(De[ye],W)}function Gs(W,ye){if(fn(W))return!1;var De=_typeof$1(W);return!(De!="number"&&De!="symbol"&&De!="boolean"&&W!=null&&!Ri(W))||Ve.test(W)||!Be.test(W)||ye!=null&&W in Mn(ye)}function Ys(W){var ye=hs(W),De=at[ye];if(typeof De!="function"||!(ye in gn.prototype))return!1;if(W===De)return!0;var Ye=js(De);return!!Ye&&W===Ye[0]}(ya&&ui(new ya(new ArrayBuffer(1)))!=j||Uo&&ui(new Uo)!=O||ba&&ui(ba.resolve())!=Y||qo&&ui(new qo)!=ne||cr&&ui(new cr)!=fe)&&(ui=function(W){var ye=ni(W),De=ye==q?W.constructor:o,Ye=De?Sr(De):"";if(Ye)switch(Ye){case Fr:return j;case hr:return O;case Qa:return Y;case Hr:return ne;case wo:return fe}return ye});var xc=or?$o:dl;function Ra(W){var ye=W&&W.constructor;return W===(typeof ye=="function"&&ye.prototype||Wo)}function $l(W){return W==W&&!Hn(W)}function Tl(W,ye){return function(De){return De!=null&&De[W]===ye&&(ye!==o||W in Mn(De))}}function Bl(W,ye,De){return ye=On(ye===o?W.length-1:ye,0),function(){for(var Ye=arguments,Qe=-1,st=On(Ye.length-ye,0),pt=Wt(st);++Qe<st;)pt[Qe]=Ye[ye+Qe];Qe=-1;for(var _t=Wt(ye+1);++Qe<ye;)_t[Qe]=Ye[Qe];return _t[ye]=De(pt),ei(W,this,_t)}}function Vl(W,ye){return ye.length<2?W:Ii(W,Ne(ye,0,-1))}function Xs(W,ye){if((ye!=="constructor"||typeof W[ye]!="function")&&ye!="__proto__")return W[ye]}var Ll=Dl(Po),Da=sr||function(W,ye){return Wn.setTimeout(W,ye)},Ks=Dl(as);function Rl(W,ye,De){var Ye=ye+"";return Ks(W,function(Qe,st){var pt=st.length;if(!pt)return Qe;var _t=pt-1;return st[_t]=(pt>1?"& ":"")+st[_t],st=st.join(pt>2?", ":" "),Qe.replace(Ke,`{
/* [wrapped with `+st+`] */
`)}(Ye,function(Qe,st){return si(P,function(pt){var _t="_."+pt[0];st&pt[1]&&!Lo(Qe,_t)&&Qe.push(_t)}),Qe.sort()}(function(Qe){var st=Qe.match(Je);return st?st[1].split(rt):[]}(Ye),De)))}function Dl(W){var ye=0,De=0;return function(){var Ye=Za(),Qe=16-(Ye-De);if(De=Ye,Qe>0){if(++ye>=800)return arguments[0]}else ye=0;return W.apply(o,arguments)}}function ps(W,ye){var De=-1,Ye=W.length,Qe=Ye-1;for(ye=ye===o?Ye:ye;++De<ye;){var st=Ba(De,Qe),pt=W[st];W[st]=W[De],W[De]=pt}return W.length=ye,W}var Nl=function(W){var ye=ys(W,function(Ye){return De.size===500&&De.clear(),Ye}),De=ye.cache;return ye}(function(W){var ye=[];return W.charCodeAt(0)===46&&ye.push(""),W.replace(Oe,function(De,Ye,Qe,st){ye.push(Qe?st.replace(Ct,"$1"):Ye||De)}),ye});function so(W){if(typeof W=="string"||Ri(W))return W;var ye=W+"";return ye=="0"&&1/W==-1/0?"-0":ye}function Sr(W){if(W!=null){try{return Rr.call(W)}catch{}try{return W+""}catch{}}return""}function Il(W){if(W instanceof gn)return W.clone();var ye=new wi(W.__wrapped__,W.__chain__);return ye.__actions__=Gn(W.__actions__),ye.__index__=W.__index__,ye.__values__=W.__values__,ye}var Cc=mn(function(W,ye){return Yn(W)?xi(W,Kn(ye,1,Yn,!0)):[]}),kc=mn(function(W,ye){var De=Fi(ye);return Yn(De)&&(De=o),Yn(W)?xi(W,Kn(ye,1,Yn,!0),an(De,2)):[]}),Sc=mn(function(W,ye){var De=Fi(ye);return Yn(De)&&(De=o),Yn(W)?xi(W,Kn(ye,1,Yn,!0),o,De):[]});function Ol(W,ye,De){var Ye=W==null?0:W.length;if(!Ye)return-1;var Qe=De==null?0:vn(De);return Qe<0&&(Qe=On(Ye+Qe,0)),tr(W,an(ye,3),Qe)}function Fl(W,ye,De){var Ye=W==null?0:W.length;if(!Ye)return-1;var Qe=Ye-1;return De!==o&&(Qe=vn(De),Qe=De<0?On(Ye+Qe,0):Jn(Qe,Ye-1)),tr(W,an(ye,3),Qe,!0)}function Hl(W){return W!=null&&W.length?Kn(W,1):[]}function zl(W){return W&&W.length?W[0]:o}var Pc=mn(function(W){var ye=Bn(W,ci);return ye.length&&ye[0]===W[0]?Ea(ye):[]}),Ec=mn(function(W){var ye=Fi(W),De=Bn(W,ci);return ye===Fi(De)?ye=o:De.pop(),De.length&&De[0]===W[0]?Ea(De,an(ye,2)):[]}),Ac=mn(function(W){var ye=Fi(W),De=Bn(W,ci);return(ye=typeof ye=="function"?ye:o)&&De.pop(),De.length&&De[0]===W[0]?Ea(De,o,ye):[]});function Fi(W){var ye=W==null?0:W.length;return ye?W[ye-1]:o}var Mc=mn(Wl);function Wl(W,ye){return W&&W.length&&ye&&ye.length?Ta(W,ye):W}var $c=Ao(function(W,ye){var De=W==null?0:W.length,Ye=Ca(W,ye);return rs(W,Bn(ye,function(Qe){return Mo(Qe,De)?+Qe:Qe}).sort(Ln)),Ye});function Zs(W){return W==null?W:va.call(W)}var Tc=mn(function(W){return Xt(Kn(W,1,Yn,!0))}),Bc=mn(function(W){var ye=Fi(W);return Yn(ye)&&(ye=o),Xt(Kn(W,1,Yn,!0),an(ye,2))}),Vc=mn(function(W){var ye=Fi(W);return ye=typeof ye=="function"?ye:o,Xt(Kn(W,1,Yn,!0),o,ye)});function Js(W){if(!W||!W.length)return[];var ye=0;return W=Ni(W,function(De){if(Yn(De))return ye=On(De.length,ye),!0}),la(ye,function(De){return Bn(W,No(De))})}function jl(W,ye){if(!W||!W.length)return[];var De=Js(W);return ye==null?De:Bn(De,function(Ye){return ei(ye,o,Ye)})}var Lc=mn(function(W,ye){return Yn(W)?xi(W,ye):[]}),Rc=mn(function(W){return Fn(Ni(W,Yn))}),Dc=mn(function(W){var ye=Fi(W);return Yn(ye)&&(ye=o),Fn(Ni(W,Yn),an(ye,2))}),Nc=mn(function(W){var ye=Fi(W);return ye=typeof ye=="function"?ye:o,Fn(Ni(W,Yn),o,ye)}),Ic=mn(Js),Oc=mn(function(W){var ye=W.length,De=ye>1?W[ye-1]:o;return De=typeof De=="function"?(W.pop(),De):o,jl(W,De)});function Ul(W){var ye=at(W);return ye.__chain__=!0,ye}function gs(W,ye){return ye(W)}var Fc=Ao(function(W){var ye=W.length,De=ye?W[0]:0,Ye=this.__wrapped__,Qe=function(st){return Ca(st,W)};return!(ye>1||this.__actions__.length)&&Ye instanceof gn&&Mo(De)?((Ye=Ye.slice(De,+De+(ye?1:0))).__actions__.push({func:gs,args:[Qe],thisArg:o}),new wi(Ye,this.__chain__).thru(function(st){return ye&&!st.length&&st.push(o),st})):this.thru(Qe)}),Hc=ss(function(W,ye,De){Sn.call(W,De)?++W[De]:Xi(W,De,1)}),zc=yl(Ol),Wc=yl(Fl);function ql(W,ye){return(fn(W)?si:ai)(W,an(ye,3))}function Gl(W,ye){return(fn(W)?Jo:Ci)(W,an(ye,3))}var jc=ss(function(W,ye,De){Sn.call(W,De)?W[De].push(ye):Xi(W,De,[ye])}),Uc=mn(function(W,ye,De){var Ye=-1,Qe=typeof ye=="function",st=Ei(W)?Wt(W.length):[];return ai(W,function(pt){st[++Ye]=Qe?ei(ye,pt,De):_r(pt,ye,De)}),st}),qc=ss(function(W,ye,De){Xi(W,De,ye)});function ms(W,ye){return(fn(W)?Bn:Cr)(W,an(ye,3))}var Gc=ss(function(W,ye,De){W[De?0:1].push(ye)},function(){return[[],[]]}),Yc=mn(function(W,ye){if(W==null)return[];var De=ye.length;return De>1&&vi(W,ye[0],ye[1])?ye=[]:De>2&&vi(ye[0],ye[1],ye[2])&&(ye=[ye[0]]),os(W,Kn(ye,1),[])}),vs=_o||function(){return Wn.Date.now()};function Yl(W,ye,De){return ye=De?o:ye,ye=W&&ye==null?W.length:ye,Eo(W,g,o,o,o,o,ye)}function Xl(W,ye){var De;if(typeof ye!="function")throw new bi(r);return W=vn(W),function(){return--W>0&&(De=ye.apply(this,arguments)),W<=1&&(ye=o),De}}var Qs=mn(function(W,ye,De){var Ye=1;if(De.length){var Qe=fi(De,Qr(Qs));Ye|=m}return Eo(W,Ye,ye,De,Qe)}),Kl=mn(function(W,ye,De){var Ye=3;if(De.length){var Qe=fi(De,Qr(Kl));Ye|=m}return Eo(ye,Ye,W,De,Qe)});function Zl(W,ye,De){var Ye,Qe,st,pt,_t,At,Dt=0,Lt=!1,Ht=!1,Kt=!0;if(typeof W!="function")throw new bi(r);function Qt(Yt){var pn=Ye,hn=Qe;return Ye=Qe=o,Dt=Yt,pt=W.apply(hn,pn)}function rn(Yt){var pn=Yt-At;return At===o||pn>=ye||pn<0||Ht&&Yt-Dt>=st}function Nt(){var Yt=vs();if(rn(Yt))return zt(Yt);_t=Da(Nt,function(pn){var hn=ye-(pn-At);return Ht?Jn(hn,st-(pn-Dt)):hn}(Yt))}function zt(Yt){return _t=o,Kt&&Ye?Qt(Yt):(Ye=Qe=o,pt)}function ln(){var Yt=vs(),pn=rn(Yt);if(Ye=arguments,Qe=this,At=Yt,pn){if(_t===o)return function(hn){return Dt=hn,_t=Da(Nt,ye),Lt?Qt(hn):pt}(At);if(Ht)return ao(_t),_t=Da(Nt,ye),Qt(At)}return _t===o&&(_t=Da(Nt,ye)),pt}return ye=Hi(ye)||0,Hn(De)&&(Lt=!!De.leading,st=(Ht="maxWait"in De)?On(Hi(De.maxWait)||0,ye):st,Kt="trailing"in De?!!De.trailing:Kt),ln.cancel=function(){_t!==o&&ao(_t),Dt=0,Ye=At=Qe=_t=o},ln.flush=function(){return _t===o?pt:zt(vs())},ln}var Xc=mn(function(W,ye){return jr(W,1,ye)}),Kc=mn(function(W,ye,De){return jr(W,Hi(ye)||0,De)});function ys(W,ye){if(typeof W!="function"||ye!=null&&typeof ye!="function")throw new bi(r);var De=function Ye(){var Qe=arguments,st=ye?ye.apply(this,Qe):Qe[0],pt=Ye.cache;if(pt.has(st))return pt.get(st);var _t=W.apply(this,Qe);return Ye.cache=pt.set(st,_t)||pt,_t};return De.cache=new(ys.Cache||Yi),De}function _s(W){if(typeof W!="function")throw new bi(r);return function(){var ye=arguments;switch(ye.length){case 0:return!W.call(this);case 1:return!W.call(this,ye[0]);case 2:return!W.call(this,ye[0],ye[1]);case 3:return!W.call(this,ye[0],ye[1],ye[2])}return!W.apply(this,ye)}}ys.Cache=Yi;var Zc=Ki(function(W,ye){var De=(ye=ye.length==1&&fn(ye[0])?Bn(ye[0],hi(an())):Bn(Kn(ye,1),hi(an()))).length;return mn(function(Ye){for(var Qe=-1,st=Jn(Ye.length,De);++Qe<st;)Ye[Qe]=ye[Qe].call(this,Ye[Qe]);return ei(W,this,Ye)})}),el=mn(function(W,ye){var De=fi(ye,Qr(el));return Eo(W,m,o,ye,De)}),Jl=mn(function(W,ye){var De=fi(ye,Qr(Jl));return Eo(W,v,o,ye,De)}),Jc=Ao(function(W,ye){return Eo(W,d,o,o,o,ye)});function Ji(W,ye){return W===ye||W!=W&&ye!=ye}var Qc=ds(Pa),eu=ds(function(W,ye){return W>=ye}),Pr=br(function(){return arguments}())?br:function(W){return Un(W)&&Sn.call(W,"callee")&&!jo.call(W,"callee")},fn=Wt.isArray,tu=oi?hi(oi):function(W){return Un(W)&&ni(W)==Z};function Ei(W){return W!=null&&bs(W.length)&&!$o(W)}function Yn(W){return Un(W)&&Ei(W)}var Go=ma||dl,nu=Ko?hi(Ko):function(W){return Un(W)&&ni(W)==T};function tl(W){if(!Un(W))return!1;var ye=ni(W);return ye==D||ye=="[object DOMException]"||typeof W.message=="string"&&typeof W.name=="string"&&!Na(W)}function $o(W){if(!Hn(W))return!1;var ye=ni(W);return ye==N||ye==I||ye=="[object AsyncFunction]"||ye=="[object Proxy]"}function Ql(W){return typeof W=="number"&&W==vn(W)}function bs(W){return typeof W=="number"&&W>-1&&W%1==0&&W<=y}function Hn(W){var ye=_typeof$1(W);return W!=null&&(ye=="object"||ye=="function")}function Un(W){return W!=null&&_typeof$1(W)=="object"}var ec=Vo?hi(Vo):function(W){return Un(W)&&ui(W)==O};function tc(W){return typeof W=="number"||Un(W)&&ni(W)==F}function Na(W){if(!Un(W)||ni(W)!=q)return!1;var ye=Nr(W);if(ye===null)return!0;var De=Sn.call(ye,"constructor")&&ye.constructor;return typeof De=="function"&&De instanceof De&&Rr.call(De)==ha}var nl=Zo?hi(Zo):function(W){return Un(W)&&ni(W)==_e},nc=uo?hi(uo):function(W){return Un(W)&&ui(W)==ne};function ws(W){return typeof W=="string"||!fn(W)&&Un(W)&&ni(W)==ve}function Ri(W){return _typeof$1(W)=="symbol"||Un(W)&&ni(W)==J}var ea=ho?hi(ho):function(W){return Un(W)&&bs(W.length)&&!!En[ni(W)]},iu=ds(Oi),ou=ds(function(W,ye){return W<=ye});function ic(W){if(!W)return[];if(Ei(W))return ws(W)?pi(W):Gn(W);if(vo&&W[vo])return function(De){for(var Ye,Qe=[];!(Ye=De.next()).done;)Qe.push(Ye.value);return Qe}(W[vo]());var ye=ui(W);return(ye==O?Vr:ye==ne?po:ta)(W)}function To(W){return W?(W=Hi(W))===f||W===-1/0?17976931348623157e292*(W<0?-1:1):W==W?W:0:W===0?W:0}function vn(W){var ye=To(W),De=ye%1;return ye==ye?De?ye-De:ye:0}function oc(W){return W?In(vn(W),0,k):0}function Hi(W){if(typeof W=="number")return W;if(Ri(W))return x;if(Hn(W)){var ye=typeof W.valueOf=="function"?W.valueOf():W;W=Hn(ye)?ye+"":ye}if(typeof W!="string")return W===0?W:+W;W=Ha(W);var De=bt.test(W);return De||gt.test(W)?ia(W.slice(2),De?2:8):Vt.test(W)?x:+W}function rc(W){return Pi(W,Ai(W))}function An(W){return W==null?"":Ot(W)}var ru=Zr(function(W,ye){if(Ra(ye)||Ei(ye))Pi(ye,ii(ye),W);else for(var De in ye)Sn.call(ye,De)&&pr(W,De,ye[De])}),ac=Zr(function(W,ye){Pi(ye,Ai(ye),W)}),xs=Zr(function(W,ye,De,Ye){Pi(ye,Ai(ye),W,Ye)}),au=Zr(function(W,ye,De,Ye){Pi(ye,ii(ye),W,Ye)}),su=Ao(Ca),lu=mn(function(W,ye){W=Mn(W);var De=-1,Ye=ye.length,Qe=Ye>2?ye[2]:o;for(Qe&&vi(ye[0],ye[1],Qe)&&(Ye=1);++De<Ye;)for(var st=ye[De],pt=Ai(st),_t=-1,At=pt.length;++_t<At;){var Dt=pt[_t],Lt=W[Dt];(Lt===o||Ji(Lt,Wo[Dt])&&!Sn.call(W,Dt))&&(W[Dt]=st[Dt])}return W}),cu=mn(function(W){return W.push(o,Sl),ei(sc,o,W)});function il(W,ye,De){var Ye=W==null?o:Ii(W,ye);return Ye===o?De:Ye}function ol(W,ye){return W!=null&&Al(W,ye,Is)}var uu=bl(function(W,ye,De){ye!=null&&typeof ye.toString!="function"&&(ye=Ui.call(ye)),W[ye]=De},al(Mi)),du=bl(function(W,ye,De){ye!=null&&typeof ye.toString!="function"&&(ye=Ui.call(ye)),Sn.call(W,ye)?W[ye].push(De):W[ye]=[De]},an),hu=mn(_r);function ii(W){return Ei(W)?es(W):xr(W)}function Ai(W){return Ei(W)?es(W,!0):Xr(W)}var fu=Zr(function(W,ye,De){ko(W,ye,De)}),sc=Zr(function(W,ye,De,Ye){ko(W,ye,De,Ye)}),pu=Ao(function(W,ye){var De={};if(W==null)return De;var Ye=!1;ye=Bn(ye,function(st){return st=Vn(st,W),Ye||(Ye=st.length>1),st}),Pi(W,Ws(W),De),Ye&&(De=ti(De,7,bc));for(var Qe=ye.length;Qe--;)qt(De,ye[Qe]);return De}),gu=Ao(function(W,ye){return W==null?{}:function(De,Ye){return $a(De,Ye,function(Qe,st){return ol(De,st)})}(W,ye)});function lc(W,ye){if(W==null)return{};var De=Bn(Ws(W),function(Ye){return[Ye]});return ye=an(ye),$a(W,De,function(Ye,Qe){return ye(Ye,Qe[0])})}var cc=Cl(ii),uc=Cl(Ai);function ta(W){return W==null?[]:ca(W,ii(W))}var mu=Jr(function(W,ye,De){return ye=ye.toLowerCase(),W+(De?dc(ye):ye)});function dc(W){return rl(An(W).toLowerCase())}function hc(W){return(W=An(W))&&W.replace(ut,$s).replace(_i,"")}var vu=Jr(function(W,ye,De){return W+(De?"-":"")+ye.toLowerCase()}),yu=Jr(function(W,ye,De){return W+(De?" ":"")+ye.toLowerCase()}),_u=vl("toLowerCase"),bu=Jr(function(W,ye,De){return W+(De?"_":"")+ye.toLowerCase()}),wu=Jr(function(W,ye,De){return W+(De?" ":"")+rl(ye)}),xu=Jr(function(W,ye,De){return W+(De?" ":"")+ye.toUpperCase()}),rl=vl("toUpperCase");function fc(W,ye,De){return W=An(W),(ye=De?o:ye)===o?function(Ye){return Mr.test(Ye)}(W)?function(Ye){return Ye.match(Bo)||[]}(W):function(Ye){return Ye.match(ht)||[]}(W):W.match(ye)||[]}var pc=mn(function(W,ye){try{return ei(W,o,ye)}catch(De){return tl(De)?De:new wn(De)}}),Cu=Ao(function(W,ye){return si(ye,function(De){De=so(De),Xi(W,De,Qs(W[De],W))}),W});function al(W){return function(){return W}}var ku=_l(),Su=_l(!0);function Mi(W){return W}function sl(W){return Yr(typeof W=="function"?W:ti(W,1))}var Pu=mn(function(W,ye){return function(De){return _r(De,W,ye)}}),Eu=mn(function(W,ye){return function(De){return _r(W,De,ye)}});function ll(W,ye,De){var Ye=ii(ye),Qe=yr(ye,Ye);De!=null||Hn(ye)&&(Qe.length||!Ye.length)||(De=ye,ye=W,W=this,Qe=yr(ye,ii(ye)));var st=!(Hn(De)&&"chain"in De&&!De.chain),pt=$o(W);return si(Qe,function(_t){var At=ye[_t];W[_t]=At,pt&&(W.prototype[_t]=function(){var Dt=this.__chain__;if(st||Dt){var Lt=W(this.__wrapped__);return(Lt.__actions__=Gn(this.__actions__)).push({func:At,args:arguments,thisArg:W}),Lt.__chain__=Dt,Lt}return At.apply(W,ji([this.value()],arguments))})}),W}function cl(){}var Au=Fs(Bn),Mu=Fs(Qi),$u=Fs(er);function gc(W){return Gs(W)?No(so(W)):function(ye){return function(De){return Ii(De,ye)}}(W)}var Tu=wl(),Bu=wl(!0);function ul(){return[]}function dl(){return!1}var Vu=cs(function(W,ye){return W+ye},0),Lu=Hs("ceil"),Ru=cs(function(W,ye){return W/ye},1),Du=Hs("floor"),hl,Nu=cs(function(W,ye){return W*ye},1),Iu=Hs("round"),Ou=cs(function(W,ye){return W-ye},0);return at.after=function(W,ye){if(typeof ye!="function")throw new bi(r);return W=vn(W),function(){if(--W<1)return ye.apply(this,arguments)}},at.ary=Yl,at.assign=ru,at.assignIn=ac,at.assignInWith=xs,at.assignWith=au,at.at=su,at.before=Xl,at.bind=Qs,at.bindAll=Cu,at.bindKey=Kl,at.castArray=function(){if(!arguments.length)return[];var W=arguments[0];return fn(W)?W:[W]},at.chain=Ul,at.chunk=function(W,ye,De){ye=(De?vi(W,ye,De):ye===o)?1:On(vn(ye),0);var Ye=W==null?0:W.length;if(!Ye||ye<1)return[];for(var Qe=0,st=0,pt=Wt(bo(Ye/ye));Qe<Ye;)pt[st++]=Ne(W,Qe,Qe+=ye);return pt},at.compact=function(W){for(var ye=-1,De=W==null?0:W.length,Ye=0,Qe=[];++ye<De;){var st=W[ye];st&&(Qe[Ye++]=st)}return Qe},at.concat=function(){var W=arguments.length;if(!W)return[];for(var ye=Wt(W-1),De=arguments[0],Ye=W;Ye--;)ye[Ye-1]=arguments[Ye];return ji(fn(De)?Gn(De):[De],Kn(ye,1))},at.cond=function(W){var ye=W==null?0:W.length,De=an();return W=ye?Bn(W,function(Ye){if(typeof Ye[1]!="function")throw new bi(r);return[De(Ye[0]),Ye[1]]}):[],mn(function(Ye){for(var Qe=-1;++Qe<ye;){var st=W[Qe];if(ei(st[0],this,Ye))return ei(st[1],this,Ye)}})},at.conforms=function(W){return function(ye){var De=ii(ye);return function(Ye){return ka(Ye,ye,De)}}(ti(W,1))},at.constant=al,at.countBy=Hc,at.create=function(W,ye){var De=Bi(W);return ye==null?De:xa(De,ye)},at.curry=function W(ye,De,Ye){var Qe=Eo(ye,8,o,o,o,o,o,De=Ye?o:De);return Qe.placeholder=W.placeholder,Qe},at.curryRight=function W(ye,De,Ye){var Qe=Eo(ye,w,o,o,o,o,o,De=Ye?o:De);return Qe.placeholder=W.placeholder,Qe},at.debounce=Zl,at.defaults=lu,at.defaultsDeep=cu,at.defer=Xc,at.delay=Kc,at.difference=Cc,at.differenceBy=kc,at.differenceWith=Sc,at.drop=function(W,ye,De){var Ye=W==null?0:W.length;return Ye?Ne(W,(ye=De||ye===o?1:vn(ye))<0?0:ye,Ye):[]},at.dropRight=function(W,ye,De){var Ye=W==null?0:W.length;return Ye?Ne(W,0,(ye=Ye-(ye=De||ye===o?1:vn(ye)))<0?0:ye):[]},at.dropRightWhile=function(W,ye){return W&&W.length?_n(W,an(ye,3),!0,!0):[]},at.dropWhile=function(W,ye){return W&&W.length?_n(W,an(ye,3),!0):[]},at.fill=function(W,ye,De,Ye){var Qe=W==null?0:W.length;return Qe?(De&&typeof De!="number"&&vi(W,ye,De)&&(De=0,Ye=Qe),function(st,pt,_t,At){var Dt=st.length;for((_t=vn(_t))<0&&(_t=-_t>Dt?0:Dt+_t),(At=At===o||At>Dt?Dt:vn(At))<0&&(At+=Dt),At=_t>At?0:oc(At);_t<At;)st[_t++]=pt;return st}(W,ye,De,Ye)):[]},at.filter=function(W,ye){return(fn(W)?Ni:ro)(W,an(ye,3))},at.flatMap=function(W,ye){return Kn(ms(W,ye),1)},at.flatMapDeep=function(W,ye){return Kn(ms(W,ye),f)},at.flatMapDepth=function(W,ye,De){return De=De===o?1:vn(De),Kn(ms(W,ye),De)},at.flatten=Hl,at.flattenDeep=function(W){return W!=null&&W.length?Kn(W,f):[]},at.flattenDepth=function(W,ye){return W!=null&&W.length?Kn(W,ye=ye===o?1:vn(ye)):[]},at.flip=function(W){return Eo(W,512)},at.flow=ku,at.flowRight=Su,at.fromPairs=function(W){for(var ye=-1,De=W==null?0:W.length,Ye={};++ye<De;){var Qe=W[ye];Ye[Qe[0]]=Qe[1]}return Ye},at.functions=function(W){return W==null?[]:yr(W,ii(W))},at.functionsIn=function(W){return W==null?[]:yr(W,Ai(W))},at.groupBy=jc,at.initial=function(W){return W!=null&&W.length?Ne(W,0,-1):[]},at.intersection=Pc,at.intersectionBy=Ec,at.intersectionWith=Ac,at.invert=uu,at.invertBy=du,at.invokeMap=Uc,at.iteratee=sl,at.keyBy=qc,at.keys=ii,at.keysIn=Ai,at.map=ms,at.mapKeys=function(W,ye){var De={};return ye=an(ye,3),Li(W,function(Ye,Qe,st){Xi(De,ye(Ye,Qe,st),Ye)}),De},at.mapValues=function(W,ye){var De={};return ye=an(ye,3),Li(W,function(Ye,Qe,st){Xi(De,Qe,ye(Ye,Qe,st))}),De},at.matches=function(W){return ns(ti(W,1))},at.matchesProperty=function(W,ye){return is(W,ti(ye,1))},at.memoize=ys,at.merge=fu,at.mergeWith=sc,at.method=Pu,at.methodOf=Eu,at.mixin=ll,at.negate=_s,at.nthArg=function(W){return W=vn(W),mn(function(ye){return Ma(ye,W)})},at.omit=pu,at.omitBy=function(W,ye){return lc(W,_s(an(ye)))},at.once=function(W){return Xl(2,W)},at.orderBy=function(W,ye,De,Ye){return W==null?[]:(fn(ye)||(ye=ye==null?[]:[ye]),fn(De=Ye?o:De)||(De=De==null?[]:[De]),os(W,ye,De))},at.over=Au,at.overArgs=Zc,at.overEvery=Mu,at.overSome=$u,at.partial=el,at.partialRight=Jl,at.partition=Gc,at.pick=gu,at.pickBy=lc,at.property=gc,at.propertyOf=function(W){return function(ye){return W==null?o:Ii(W,ye)}},at.pull=Mc,at.pullAll=Wl,at.pullAllBy=function(W,ye,De){return W&&W.length&&ye&&ye.length?Ta(W,ye,an(De,2)):W},at.pullAllWith=function(W,ye,De){return W&&W.length&&ye&&ye.length?Ta(W,ye,o,De):W},at.pullAt=$c,at.range=Tu,at.rangeRight=Bu,at.rearg=Jc,at.reject=function(W,ye){return(fn(W)?Ni:ro)(W,_s(an(ye,3)))},at.remove=function(W,ye){var De=[];if(!W||!W.length)return De;var Ye=-1,Qe=[],st=W.length;for(ye=an(ye,3);++Ye<st;){var pt=W[Ye];ye(pt,Ye,W)&&(De.push(pt),Qe.push(Ye))}return rs(W,Qe),De},at.rest=function(W,ye){if(typeof W!="function")throw new bi(r);return mn(W,ye=ye===o?ye:vn(ye))},at.reverse=Zs,at.sampleSize=function(W,ye,De){return ye=(De?vi(W,ye,De):ye===o)?1:vn(ye),(fn(W)?Ls:Kr)(W,ye)},at.set=function(W,ye,De){return W==null?W:So(W,ye,De)},at.setWith=function(W,ye,De,Ye){return Ye=typeof Ye=="function"?Ye:o,W==null?W:So(W,ye,De,Ye)},at.shuffle=function(W){return(fn(W)?Rs:Se)(W)},at.slice=function(W,ye,De){var Ye=W==null?0:W.length;return Ye?(De&&typeof De!="number"&&vi(W,ye,De)?(ye=0,De=Ye):(ye=ye==null?0:vn(ye),De=De===o?Ye:vn(De)),Ne(W,ye,De)):[]},at.sortBy=Yc,at.sortedUniq=function(W){return W&&W.length?Et(W):[]},at.sortedUniqBy=function(W,ye){return W&&W.length?Et(W,an(ye,2)):[]},at.split=function(W,ye,De){return De&&typeof De!="number"&&vi(W,ye,De)&&(ye=De=o),(De=De===o?k:De>>>0)?(W=An(W))&&(typeof ye=="string"||ye!=null&&!nl(ye))&&!(ye=Ot(ye))&&Fo(W)?jn(pi(W),0,De):W.split(ye,De):[]},at.spread=function(W,ye){if(typeof W!="function")throw new bi(r);return ye=ye==null?0:On(vn(ye),0),mn(function(De){var Ye=De[ye],Qe=jn(De,0,ye);return Ye&&ji(Qe,Ye),ei(W,this,Qe)})},at.tail=function(W){var ye=W==null?0:W.length;return ye?Ne(W,1,ye):[]},at.take=function(W,ye,De){return W&&W.length?Ne(W,0,(ye=De||ye===o?1:vn(ye))<0?0:ye):[]},at.takeRight=function(W,ye,De){var Ye=W==null?0:W.length;return Ye?Ne(W,(ye=Ye-(ye=De||ye===o?1:vn(ye)))<0?0:ye,Ye):[]},at.takeRightWhile=function(W,ye){return W&&W.length?_n(W,an(ye,3),!1,!0):[]},at.takeWhile=function(W,ye){return W&&W.length?_n(W,an(ye,3)):[]},at.tap=function(W,ye){return ye(W),W},at.throttle=function(W,ye,De){var Ye=!0,Qe=!0;if(typeof W!="function")throw new bi(r);return Hn(De)&&(Ye="leading"in De?!!De.leading:Ye,Qe="trailing"in De?!!De.trailing:Qe),Zl(W,ye,{leading:Ye,maxWait:ye,trailing:Qe})},at.thru=gs,at.toArray=ic,at.toPairs=cc,at.toPairsIn=uc,at.toPath=function(W){return fn(W)?Bn(W,so):Ri(W)?[W]:Gn(Nl(An(W)))},at.toPlainObject=rc,at.transform=function(W,ye,De){var Ye=fn(W),Qe=Ye||Go(W)||ea(W);if(ye=an(ye,4),De==null){var st=W&&W.constructor;De=Qe?Ye?new st:[]:Hn(W)&&$o(st)?Bi(Nr(W)):{}}return(Qe?si:Li)(W,function(pt,_t,At){return ye(De,pt,_t,At)}),De},at.unary=function(W){return Yl(W,1)},at.union=Tc,at.unionBy=Bc,at.unionWith=Vc,at.uniq=function(W){return W&&W.length?Xt(W):[]},at.uniqBy=function(W,ye){return W&&W.length?Xt(W,an(ye,2)):[]},at.uniqWith=function(W,ye){return ye=typeof ye=="function"?ye:o,W&&W.length?Xt(W,o,ye):[]},at.unset=function(W,ye){return W==null||qt(W,ye)},at.unzip=Js,at.unzipWith=jl,at.update=function(W,ye,De){return W==null?W:bn(W,ye,ki(De))},at.updateWith=function(W,ye,De,Ye){return Ye=typeof Ye=="function"?Ye:o,W==null?W:bn(W,ye,ki(De),Ye)},at.values=ta,at.valuesIn=function(W){return W==null?[]:ca(W,Ai(W))},at.without=Lc,at.words=fc,at.wrap=function(W,ye){return el(ki(ye),W)},at.xor=Rc,at.xorBy=Dc,at.xorWith=Nc,at.zip=Ic,at.zipObject=function(W,ye){return mi(W||[],ye||[],pr)},at.zipObjectDeep=function(W,ye){return mi(W||[],ye||[],So)},at.zipWith=Oc,at.entries=cc,at.entriesIn=uc,at.extend=ac,at.extendWith=xs,ll(at,at),at.add=Vu,at.attempt=pc,at.camelCase=mu,at.capitalize=dc,at.ceil=Lu,at.clamp=function(W,ye,De){return De===o&&(De=ye,ye=o),De!==o&&(De=(De=Hi(De))==De?De:0),ye!==o&&(ye=(ye=Hi(ye))==ye?ye:0),In(Hi(W),ye,De)},at.clone=function(W){return ti(W,4)},at.cloneDeep=function(W){return ti(W,5)},at.cloneDeepWith=function(W,ye){return ti(W,5,ye=typeof ye=="function"?ye:o)},at.cloneWith=function(W,ye){return ti(W,4,ye=typeof ye=="function"?ye:o)},at.conformsTo=function(W,ye){return ye==null||ka(W,ye,ii(ye))},at.deburr=hc,at.defaultTo=function(W,ye){return W==null||W!=W?ye:W},at.divide=Ru,at.endsWith=function(W,ye,De){W=An(W),ye=Ot(ye);var Ye=W.length,Qe=De=De===o?Ye:In(vn(De),0,Ye);return(De-=ye.length)>=0&&W.slice(De,Qe)==ye},at.eq=Ji,at.escape=function(W){return(W=An(W))&&oe.test(W)?W.replace(Le,no):W},at.escapeRegExp=function(W){return(W=An(W))&&Ge.test(W)?W.replace(je,"\\$&"):W},at.every=function(W,ye,De){var Ye=fn(W)?Qi:gr;return De&&vi(W,ye,De)&&(ye=o),Ye(W,an(ye,3))},at.find=zc,at.findIndex=Ol,at.findKey=function(W,ye){return to(W,an(ye,3),Li)},at.findLast=Wc,at.findLastIndex=Fl,at.findLastKey=function(W,ye){return to(W,an(ye,3),qr)},at.floor=Du,at.forEach=ql,at.forEachRight=Gl,at.forIn=function(W,ye){return W==null?W:Ur(W,an(ye,3),Ai)},at.forInRight=function(W,ye){return W==null?W:vr(W,an(ye,3),Ai)},at.forOwn=function(W,ye){return W&&Li(W,an(ye,3))},at.forOwnRight=function(W,ye){return W&&qr(W,an(ye,3))},at.get=il,at.gt=Qc,at.gte=eu,at.has=function(W,ye){return W!=null&&Al(W,ye,Ns)},at.hasIn=ol,at.head=zl,at.identity=Mi,at.includes=function(W,ye,De,Ye){W=Ei(W)?W:ta(W),De=De&&!Ye?vn(De):0;var Qe=W.length;return De<0&&(De=On(Qe+De,0)),ws(W)?De<=Qe&&W.indexOf(ye,De)>-1:!!Qe&&Ro(W,ye,De)>-1},at.indexOf=function(W,ye,De){var Ye=W==null?0:W.length;if(!Ye)return-1;var Qe=De==null?0:vn(De);return Qe<0&&(Qe=On(Ye+Qe,0)),Ro(W,ye,Qe)},at.inRange=function(W,ye,De){return ye=To(ye),De===o?(De=ye,ye=0):De=To(De),function(Ye,Qe,st){return Ye>=Jn(Qe,st)&&Ye<On(Qe,st)}(W=Hi(W),ye,De)},at.invoke=hu,at.isArguments=Pr,at.isArray=fn,at.isArrayBuffer=tu,at.isArrayLike=Ei,at.isArrayLikeObject=Yn,at.isBoolean=function(W){return W===!0||W===!1||Un(W)&&ni(W)==M},at.isBuffer=Go,at.isDate=nu,at.isElement=function(W){return Un(W)&&W.nodeType===1&&!Na(W)},at.isEmpty=function(W){if(W==null)return!0;if(Ei(W)&&(fn(W)||typeof W=="string"||typeof W.splice=="function"||Go(W)||ea(W)||Pr(W)))return!W.length;var ye=ui(W);if(ye==O||ye==ne)return!W.size;if(Ra(W))return!xr(W).length;for(var De in W)if(Sn.call(W,De))return!1;return!0},at.isEqual=function(W,ye){return wr(W,ye)},at.isEqualWith=function(W,ye,De){var Ye=(De=typeof De=="function"?De:o)?De(W,ye):o;return Ye===o?wr(W,ye,o,De):!!Ye},at.isError=tl,at.isFinite=function(W){return typeof W=="number"&&Xa(W)},at.isFunction=$o,at.isInteger=Ql,at.isLength=bs,at.isMap=ec,at.isMatch=function(W,ye){return W===ye||Gr(W,ye,Us(ye))},at.isMatchWith=function(W,ye,De){return De=typeof De=="function"?De:o,Gr(W,ye,Us(ye),De)},at.isNaN=function(W){return tc(W)&&W!=+W},at.isNative=function(W){if(xc(W))throw new wn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Aa(W)},at.isNil=function(W){return W==null},at.isNull=function(W){return W===null},at.isNumber=tc,at.isObject=Hn,at.isObjectLike=Un,at.isPlainObject=Na,at.isRegExp=nl,at.isSafeInteger=function(W){return Ql(W)&&W>=-9007199254740991&&W<=y},at.isSet=nc,at.isString=ws,at.isSymbol=Ri,at.isTypedArray=ea,at.isUndefined=function(W){return W===o},at.isWeakMap=function(W){return Un(W)&&ui(W)==fe},at.isWeakSet=function(W){return Un(W)&&ni(W)=="[object WeakSet]"},at.join=function(W,ye){return W==null?"":Ka.call(W,ye)},at.kebabCase=vu,at.last=Fi,at.lastIndexOf=function(W,ye,De){var Ye=W==null?0:W.length;if(!Ye)return-1;var Qe=Ye;return De!==o&&(Qe=(Qe=vn(De))<0?On(Ye+Qe,0):Jn(Qe,Ye-1)),ye==ye?function(st,pt,_t){for(var At=_t+1;At--;)if(st[At]===pt)return At;return At}(W,ye,Qe):tr(W,nr,Qe,!0)},at.lowerCase=yu,at.lowerFirst=_u,at.lt=iu,at.lte=ou,at.max=function(W){return W&&W.length?mr(W,Mi,Pa):o},at.maxBy=function(W,ye){return W&&W.length?mr(W,an(ye,2),Pa):o},at.mean=function(W){return Do(W,Mi)},at.meanBy=function(W,ye){return Do(W,an(ye,2))},at.min=function(W){return W&&W.length?mr(W,Mi,Oi):o},at.minBy=function(W,ye){return W&&W.length?mr(W,an(ye,2),Oi):o},at.stubArray=ul,at.stubFalse=dl,at.stubObject=function(){return{}},at.stubString=function(){return""},at.stubTrue=function(){return!0},at.multiply=Nu,at.nth=function(W,ye){return W&&W.length?Ma(W,vn(ye)):o},at.noConflict=function(){return Wn._===this&&(Wn._=Ga),this},at.noop=cl,at.now=vs,at.pad=function(W,ye,De){W=An(W);var Ye=(ye=vn(ye))?Ho(W):0;if(!ye||Ye>=ye)return W;var Qe=(ye-Ye)/2;return us(lr(Qe),De)+W+us(bo(Qe),De)},at.padEnd=function(W,ye,De){W=An(W);var Ye=(ye=vn(ye))?Ho(W):0;return ye&&Ye<ye?W+us(ye-Ye,De):W},at.padStart=function(W,ye,De){W=An(W);var Ye=(ye=vn(ye))?Ho(W):0;return ye&&Ye<ye?us(ye-Ye,De)+W:W},at.parseInt=function(W,ye,De){return De||ye==null?ye=0:ye&&(ye=+ye),Vs(An(W).replace(Xe,""),ye||0)},at.random=function(W,ye,De){if(De&&typeof De!="boolean"&&vi(W,ye,De)&&(ye=De=o),De===o&&(typeof ye=="boolean"?(De=ye,ye=o):typeof W=="boolean"&&(De=W,W=o)),W===o&&ye===o?(W=0,ye=1):(W=To(W),ye===o?(ye=W,W=0):ye=To(ye)),W>ye){var Ye=W;W=ye,ye=Ye}if(De||W%1||ye%1){var Qe=Ja();return Jn(W+Qe*(ye-W+na("1e-"+((Qe+"").length-1))),ye)}return Ba(W,ye)},at.reduce=function(W,ye,De){var Ye=fn(W)?aa:Fa,Qe=arguments.length<3;return Ye(W,an(ye,4),De,Qe,ai)},at.reduceRight=function(W,ye,De){var Ye=fn(W)?Ia:Fa,Qe=arguments.length<3;return Ye(W,an(ye,4),De,Qe,Ci)},at.repeat=function(W,ye,De){return ye=(De?vi(W,ye,De):ye===o)?1:vn(ye),Va(An(W),ye)},at.replace=function(){var W=arguments,ye=An(W[0]);return W.length<3?ye:ye.replace(W[1],W[2])},at.result=function(W,ye,De){var Ye=-1,Qe=(ye=Vn(ye,W)).length;for(Qe||(Qe=1,W=o);++Ye<Qe;){var st=W==null?o:W[so(ye[Ye])];st===o&&(Ye=Qe,st=De),W=$o(st)?st.call(W):st}return W},at.round=Iu,at.runInContext=Mt,at.sample=function(W){return(fn(W)?ts:Os)(W)},at.size=function(W){if(W==null)return 0;if(Ei(W))return ws(W)?Ho(W):W.length;var ye=ui(W);return ye==O||ye==ne?W.size:xr(W).length},at.snakeCase=bu,at.some=function(W,ye,De){var Ye=fn(W)?er:Ze;return De&&vi(W,ye,De)&&(ye=o),Ye(W,an(ye,3))},at.sortedIndex=function(W,ye){return lt(W,ye)},at.sortedIndexBy=function(W,ye,De){return ft(W,ye,an(De,2))},at.sortedIndexOf=function(W,ye){var De=W==null?0:W.length;if(De){var Ye=lt(W,ye);if(Ye<De&&Ji(W[Ye],ye))return Ye}return-1},at.sortedLastIndex=function(W,ye){return lt(W,ye,!0)},at.sortedLastIndexBy=function(W,ye,De){return ft(W,ye,an(De,2),!0)},at.sortedLastIndexOf=function(W,ye){if(W!=null&&W.length){var De=lt(W,ye,!0)-1;if(Ji(W[De],ye))return De}return-1},at.startCase=wu,at.startsWith=function(W,ye,De){return W=An(W),De=De==null?0:In(vn(De),0,W.length),ye=Ot(ye),W.slice(De,De+ye.length)==ye},at.subtract=Ou,at.sum=function(W){return W&&W.length?sa(W,Mi):0},at.sumBy=function(W,ye){return W&&W.length?sa(W,an(ye,2)):0},at.template=function(W,ye,De){var Ye=at.templateSettings;De&&vi(W,ye,De)&&(ye=o),W=An(W),ye=xs({},ye,Ye,kl);var Qe,st,pt=xs({},ye.imports,Ye.imports,kl),_t=ii(pt),At=ca(pt,_t),Dt=0,Lt=ye.interpolate||Re,Ht="__p += '",Kt=Ti((ye.escape||Re).source+"|"+Lt.source+"|"+(Lt===Ee?kt:Re).source+"|"+(ye.evaluate||Re).source+"|$","g"),Qt="//# sourceURL="+(Sn.call(ye,"sourceURL")?(ye.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Tr+"]")+`
`;W.replace(Kt,function(zt,ln,Yt,pn,hn,Pn){return Yt||(Yt=pn),Ht+=W.slice(Dt,Pn).replace(Te,ja),ln&&(Qe=!0,Ht+=`' +
__e(`+ln+`) +
'`),hn&&(st=!0,Ht+=`';
`+hn+`;
__p += '`),Yt&&(Ht+=`' +
((__t = (`+Yt+`)) == null ? '' : __t) +
'`),Dt=Pn+zt.length,zt}),Ht+=`';
`;var rn=Sn.call(ye,"variable")&&ye.variable;if(rn){if(vt.test(rn))throw new wn("Invalid `variable` option passed into `_.template`")}else Ht=`with (obj) {
`+Ht+`
}
`;Ht=(st?Ht.replace(Ae,""):Ht).replace($e,"$1").replace(Me,"$1;"),Ht="function("+(rn||"obj")+`) {
`+(rn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Qe?", __e = _.escape":"")+(st?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ht+`return __p
}`;var Nt=pc(function(){return qn(_t,Qt+"return "+Ht).apply(o,At)});if(Nt.source=Ht,tl(Nt))throw Nt;return Nt},at.times=function(W,ye){if((W=vn(W))<1||W>y)return[];var De=k,Ye=Jn(W,k);ye=an(ye),W-=k;for(var Qe=la(Ye,ye);++De<W;)ye(De);return Qe},at.toFinite=To,at.toInteger=vn,at.toLength=oc,at.toLower=function(W){return An(W).toLowerCase()},at.toNumber=Hi,at.toSafeInteger=function(W){return W?In(vn(W),-9007199254740991,y):W===0?W:0},at.toString=An,at.toUpper=function(W){return An(W).toUpperCase()},at.trim=function(W,ye,De){if((W=An(W))&&(De||ye===o))return Ha(W);if(!W||!(ye=Ot(ye)))return W;var Ye=pi(W),Qe=pi(ye);return jn(Ye,za(Ye,Qe),Wa(Ye,Qe)+1).join("")},at.trimEnd=function(W,ye,De){if((W=An(W))&&(De||ye===o))return W.slice(0,Lr(W)+1);if(!W||!(ye=Ot(ye)))return W;var Ye=pi(W);return jn(Ye,0,Wa(Ye,pi(ye))+1).join("")},at.trimStart=function(W,ye,De){if((W=An(W))&&(De||ye===o))return W.replace(Xe,"");if(!W||!(ye=Ot(ye)))return W;var Ye=pi(W);return jn(Ye,za(Ye,pi(ye))).join("")},at.truncate=function(W,ye){var De=30,Ye="...";if(Hn(ye)){var Qe="separator"in ye?ye.separator:Qe;De="length"in ye?vn(ye.length):De,Ye="omission"in ye?Ot(ye.omission):Ye}var st=(W=An(W)).length;if(Fo(W)){var pt=pi(W);st=pt.length}if(De>=st)return W;var _t=De-Ho(Ye);if(_t<1)return Ye;var At=pt?jn(pt,0,_t).join(""):W.slice(0,_t);if(Qe===o)return At+Ye;if(pt&&(_t+=At.length-_t),nl(Qe)){if(W.slice(_t).search(Qe)){var Dt,Lt=At;for(Qe.global||(Qe=Ti(Qe.source,An(mt.exec(Qe))+"g")),Qe.lastIndex=0;Dt=Qe.exec(Lt);)var Ht=Dt.index;At=At.slice(0,Ht===o?_t:Ht)}}else if(W.indexOf(Ot(Qe),_t)!=_t){var Kt=At.lastIndexOf(Qe);Kt>-1&&(At=At.slice(0,Kt))}return At+Ye},at.unescape=function(W){return(W=An(W))&&le.test(W)?W.replace(Ie,ua):W},at.uniqueId=function(W){var ye=++qa;return An(W)+ye},at.upperCase=xu,at.upperFirst=rl,at.each=ql,at.eachRight=Gl,at.first=zl,ll(at,(hl={},Li(at,function(W,ye){Sn.call(at.prototype,ye)||(hl[ye]=W)}),hl),{chain:!1}),at.VERSION="4.17.21",si(["bind","bindKey","curry","curryRight","partial","partialRight"],function(W){at[W].placeholder=at}),si(["drop","take"],function(W,ye){gn.prototype[W]=function(De){De=De===o?1:On(vn(De),0);var Ye=this.__filtered__&&!ye?new gn(this):this.clone();return Ye.__filtered__?Ye.__takeCount__=Jn(De,Ye.__takeCount__):Ye.__views__.push({size:Jn(De,k),type:W+(Ye.__dir__<0?"Right":"")}),Ye},gn.prototype[W+"Right"]=function(De){return this.reverse()[W](De).reverse()}}),si(["filter","map","takeWhile"],function(W,ye){var De=ye+1,Ye=De==1||De==3;gn.prototype[W]=function(Qe){var st=this.clone();return st.__iteratees__.push({iteratee:an(Qe,3),type:De}),st.__filtered__=st.__filtered__||Ye,st}}),si(["head","last"],function(W,ye){var De="take"+(ye?"Right":"");gn.prototype[W]=function(){return this[De](1).value()[0]}}),si(["initial","tail"],function(W,ye){var De="drop"+(ye?"":"Right");gn.prototype[W]=function(){return this.__filtered__?new gn(this):this[De](1)}}),gn.prototype.compact=function(){return this.filter(Mi)},gn.prototype.find=function(W){return this.filter(W).head()},gn.prototype.findLast=function(W){return this.reverse().find(W)},gn.prototype.invokeMap=mn(function(W,ye){return typeof W=="function"?new gn(this):this.map(function(De){return _r(De,W,ye)})}),gn.prototype.reject=function(W){return this.filter(_s(an(W)))},gn.prototype.slice=function(W,ye){W=vn(W);var De=this;return De.__filtered__&&(W>0||ye<0)?new gn(De):(W<0?De=De.takeRight(-W):W&&(De=De.drop(W)),ye!==o&&(De=(ye=vn(ye))<0?De.dropRight(-ye):De.take(ye-W)),De)},gn.prototype.takeRightWhile=function(W){return this.reverse().takeWhile(W).reverse()},gn.prototype.toArray=function(){return this.take(k)},Li(gn.prototype,function(W,ye){var De=/^(?:filter|find|map|reject)|While$/.test(ye),Ye=/^(?:head|last)$/.test(ye),Qe=at[Ye?"take"+(ye=="last"?"Right":""):ye],st=Ye||/^find/.test(ye);Qe&&(at.prototype[ye]=function(){var pt=this.__wrapped__,_t=Ye?[1]:arguments,At=pt instanceof gn,Dt=_t[0],Lt=At||fn(pt),Ht=function(ln){var Yt=Qe.apply(at,ji([ln],_t));return Ye&&Kt?Yt[0]:Yt};Lt&&De&&typeof Dt=="function"&&Dt.length!=1&&(At=Lt=!1);var Kt=this.__chain__,Qt=!!this.__actions__.length,rn=st&&!Kt,Nt=At&&!Qt;if(!st&&Lt){pt=Nt?pt:new gn(this);var zt=W.apply(pt,_t);return zt.__actions__.push({func:gs,args:[Ht],thisArg:o}),new wi(zt,Kt)}return rn&&Nt?W.apply(this,_t):(zt=this.thru(Ht),rn?Ye?zt.value()[0]:zt.value():zt)})}),si(["pop","push","shift","sort","splice","unshift"],function(W){var ye=ir[W],De=/^(?:push|sort|unshift)$/.test(W)?"tap":"thru",Ye=/^(?:pop|shift)$/.test(W);at.prototype[W]=function(){var Qe=arguments;if(Ye&&!this.__chain__){var st=this.value();return ye.apply(fn(st)?st:[],Qe)}return this[De](function(pt){return ye.apply(fn(pt)?pt:[],Qe)})}}),Li(gn.prototype,function(W,ye){var De=at[ye];if(De){var Ye=De.name+"";Sn.call(li,Ye)||(li[Ye]=[]),li[Ye].push({name:ye,func:De})}}),li[ls(o,2).name]=[{name:"wrapper",func:o}],gn.prototype.clone=function(){var W=new gn(this.__wrapped__);return W.__actions__=Gn(this.__actions__),W.__dir__=this.__dir__,W.__filtered__=this.__filtered__,W.__iteratees__=Gn(this.__iteratees__),W.__takeCount__=this.__takeCount__,W.__views__=Gn(this.__views__),W},gn.prototype.reverse=function(){if(this.__filtered__){var W=new gn(this);W.__dir__=-1,W.__filtered__=!0}else(W=this.clone()).__dir__*=-1;return W},gn.prototype.value=function(){var W=this.__wrapped__.value(),ye=this.__dir__,De=fn(W),Ye=ye<0,Qe=De?W.length:0,st=function(Pn,tn,cn){for(var Qn=-1,Xn=cn.length;++Qn<Xn;){var yi=cn[Qn],Dn=yi.size;switch(yi.type){case"drop":Pn+=Dn;break;case"dropRight":tn-=Dn;break;case"take":tn=Jn(tn,Pn+Dn);break;case"takeRight":Pn=On(Pn,tn-Dn)}}return{start:Pn,end:tn}}(0,Qe,this.__views__),pt=st.start,_t=st.end,At=_t-pt,Dt=Ye?_t:pt-1,Lt=this.__iteratees__,Ht=Lt.length,Kt=0,Qt=Jn(At,this.__takeCount__);if(!De||!Ye&&Qe==At&&Qt==At)return yn(W,this.__actions__);var rn=[];e:for(;At--&&Kt<Qt;){for(var Nt=-1,zt=W[Dt+=ye];++Nt<Ht;){var ln=Lt[Nt],Yt=ln.iteratee,pn=ln.type,hn=Yt(zt);if(pn==2)zt=hn;else if(!hn){if(pn==1)continue e;break e}}rn[Kt++]=zt}return rn},at.prototype.at=Fc,at.prototype.chain=function(){return Ul(this)},at.prototype.commit=function(){return new wi(this.value(),this.__chain__)},at.prototype.next=function(){this.__values__===o&&(this.__values__=ic(this.value()));var W=this.__index__>=this.__values__.length;return{done:W,value:W?o:this.__values__[this.__index__++]}},at.prototype.plant=function(W){for(var ye,De=this;De instanceof fr;){var Ye=Il(De);Ye.__index__=0,Ye.__values__=o,ye?Qe.__wrapped__=Ye:ye=Ye;var Qe=Ye;De=De.__wrapped__}return Qe.__wrapped__=W,ye},at.prototype.reverse=function(){var W=this.__wrapped__;if(W instanceof gn){var ye=W;return this.__actions__.length&&(ye=new gn(this)),(ye=ye.reverse()).__actions__.push({func:gs,args:[Zs],thisArg:o}),new wi(ye,this.__chain__)}return this.thru(Zs)},at.prototype.toJSON=at.prototype.valueOf=at.prototype.value=function(){return yn(this.__wrapped__,this.__actions__)},at.prototype.first=at.prototype.head,vo&&(at.prototype[vo]=function(){return this}),at}();zi?((zi.exports=zo)._=zo,Di._=zo):Wn._=zo}).call(commonjsGlobal$1)})(lodash,lodashExports);var _=lodashExports,getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&!(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}for(var byteToHex=[],i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return byteToHex[e[n+0]]+byteToHex[e[n+1]]+byteToHex[e[n+2]]+byteToHex[e[n+3]]+"-"+byteToHex[e[n+4]]+byteToHex[e[n+5]]+"-"+byteToHex[e[n+6]]+byteToHex[e[n+7]]+"-"+byteToHex[e[n+8]]+byteToHex[e[n+9]]+"-"+byteToHex[e[n+10]]+byteToHex[e[n+11]]+byteToHex[e[n+12]]+byteToHex[e[n+13]]+byteToHex[e[n+14]]+byteToHex[e[n+15]]}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(e,n,o){if(native.randomUUID&&!n&&!e)return native.randomUUID();var r=(e=e||{}).random||(e.rng||rng)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){o=o||0;for(var u=0;u<16;++u)n[o+u]=r[u];return n}return unsafeStringify(r)}var DEFAULT_SCALE_VALUE="page-fit",DEFAULT_SCALE=1,DEFAULT_SCALE_DELTA=1.1,MIN_SCALE=.05,MAX_SCALE=10,UNKNOWN_SCALE=0,MAX_AUTO_SCALE=1.25,SCROLLBAR_PADDING=40,VERTICAL_PADDING=5,RenderingStates$1={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},SidebarView={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4},RendererType={CANVAS:"canvas",SVG:"svg"},TextLayerMode={DISABLE:0,ENABLE:1},ScrollMode={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},SpreadMode={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2},CheckStyle=["Check","Circle","Cross","Diamond","Square","Star"],CheckStyleNumber={Check:0,Circle:1,Cross:2,Diamond:3,Square:4,Star:5},userAgent$1=navigator.userAgent||"",platform=navigator.platform||"",maxTouchPoints=navigator.maxTouchPoints||1,maxCanvasPixels=16777216,isAndroid$1=/Android/.test(userAgent$1),isIOS$2=/\b(iPad|iPhone|iPod)(?=;)/.test(userAgent$1)||platform==="MacIntel"&&maxTouchPoints>1;(isIOS$2||isAndroid$1)&&(maxCanvasPixels=5242880);var isMobileDevice$1=isIOS$2||isAndroid$1||/webOS|BlackBerry|IEMobile|Opera Mini/i.test(userAgent$1),isMobile$1=window.innerWidth<640,OutputScale=function(){return _createClass(function e(){_classCallCheck(this,e);var n=window.devicePixelRatio||1;this.sx=n,this.sy=n},[{key:"scaled",get:function(){return this.sx!==1||this.sy!==1}}])}(),PromiseExt=_createClass(function e(){var n=this;_classCallCheck(this,e),this.promise=new Promise(function(o,r){n.resolve=function(u){o(u)},n.reject=function(u){r(u)}})});function BaseException(e,n){this.constructor===BaseException&&unreachable("Cannot initialize BaseException."),this.message=e,this.name=n}BaseException.prototype=new Error,BaseException.constructor=BaseException;var EventBus=function(){return _createClass(function e(){_classCallCheck(this,e),this._listeners=Object.create(null)},[{key:"on",value:function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this._on(e,n,{external:!0,once:o==null?void 0:o.once})}},{key:"off",value:function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this._off(e,n,{external:!0,once:o==null?void 0:o.once})}},{key:"dispatch",value:function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",r=this._listeners[e];if(r&&r.length!==0){var u,s,w=_createForOfIteratorHelper(r.slice(0));try{for(w.s();!(s=w.n()).done;){var m=s.value,v=m.listener,g=m.external;m.once&&this._off(e,v),g?(u||(u=[])).push(v):v(n,o)}}catch(y){w.e(y)}finally{w.f()}if(u){var d,f=_createForOfIteratorHelper(u);try{for(f.s();!(d=f.n()).done;)(0,d.value)(n)}catch(y){f.e(y)}finally{f.f()}u=null}}}},{key:"_on",value:function(e,n){var o,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;((o=this._listeners)[e]||(o[e]=[])).push({listener:n,external:(r==null?void 0:r.external)===!0,once:(r==null?void 0:r.once)===!0})}},{key:"_off",value:function(e,n){var o=this._listeners[e];if(o){for(var r=0,u=o.length;r<u;r++)if(o[r].listener===n)return void o.splice(r,1)}}}])}();function scrollIntoView(e,n){var o=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=e.offsetParent;if(r){for(var u=e.offsetTop+e.clientTop,s=e.offsetLeft+e.clientLeft;r.clientHeight===r.scrollHeight&&r.clientWidth===r.scrollWidth||o&&(r.classList.contains("markedContent")||getComputedStyle(r).overflow==="hidden");)if(u+=r.offsetTop,s+=r.offsetLeft,!(r=r.offsetParent))return;n&&(n.top!==void 0&&(u+=n.top),n.left!==void 0&&(s+=n.left,r.scrollLeft=s)),r.scrollTop=u}else console.error("offsetParent is not set -- cannot scroll")}function watchScroll(e,n){var o=_.debounce(function(s){u||(u=window.requestAnimationFrame(function(){u=null;var w=e.scrollLeft,m=r.lastX;w!==m&&(r.right=w>m),r.lastX=w;var v=e.scrollTop,g=r.lastY;v!==g&&(r.down=v>g),r.lastY=v,n(r)}))},100),r={right:!0,down:!0,lastX:e.scrollLeft,lastY:e.scrollTop,_eventHandler:o},u=null;return e.addEventListener("scroll",o,!0),r}function binarySearchFirstItem(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=e.length-1;if(r<0||!n(e[r]))return e.length;if(n(e[o]))return o;for(;o<r;){var u=o+r>>1;n(e[u])?r=u:o=u+1}return o}function backtrackBeforeAllVisibleElements(e,n,o){if(e<2)return e;var r=n[e].div,u=r.offsetTop+r.clientTop;u>=o&&(u=(r=n[e-1].div).offsetTop+r.clientTop);for(var s=e-2;s>=0&&!((r=n[s].div).offsetTop+r.clientTop+r.clientHeight<=u);--s)e=s;return e}function getVisibleElements(e){var n=e.scrollEl,o=e.views,r=e.sortByVisibility,u=r!==void 0&&r,s=e.horizontal,w=s!==void 0&&s,m=e.rtl,v=m!==void 0&&m,g=n.scrollTop,d=g+n.clientHeight,f=n.scrollLeft,y=f+n.clientWidth,x=[],k=new Set,P=o.length,S=binarySearchFirstItem(o,w?function(Z){var j=Z.div,X=j.offsetLeft+j.clientLeft,H=X+j.clientWidth;return v?X<y:H>f}:function(Z){var j=Z.div;return j.offsetTop+j.clientTop+j.clientHeight>g});S>0&&S<P&&!w&&(S=backtrackBeforeAllVisibleElements(S,o,g));for(var E=w?y:-1,M=S;M<P;M++){var T=o[M],D=T.div,N=D.offsetLeft+D.clientLeft,I=D.offsetTop+D.clientTop,O=D.clientWidth,F=D.clientHeight,q=N+O,Y=I+F;if(E===-1)Y>=d&&(E=Y);else if((w?N:I)>E)break;if(!(Y<=g||I>=d||q<=f||N>=y)){var _e=Math.max(0,g-I)+Math.max(0,Y-d),ne=(O-(Math.max(0,f-N)+Math.max(0,q-y)))/O,ve=(F-_e)/F*ne*100|0;x.push({id:T.id,x:N,y:I,view:T,percent:ve,widthPercent:100*ne|0}),k.add(T.id)}}var J=x[0],fe=x.at(-1);return u&&x.sort(function(Z,j){var X=Z.percent-j.percent;return Math.abs(X)>.001?-X:Z.id-j.id}),{first:J,last:fe,views:x,ids:k}}function normalizeWheelEventDirection(e){var n=Math.hypot(e.deltaX,e.deltaY),o=Math.atan2(e.deltaY,e.deltaX);return-.25*Math.PI<o&&o<.75*Math.PI&&(n=-n),n}function normalizeWheelEventDelta(e){var n=normalizeWheelEventDirection(e);return e.deltaMode===0?n/=900:e.deltaMode===1&&(n/=30),n}function isValidRotation(e){return Number.isInteger(e)&&e%90==0}function isValidScrollMode(e){return Number.isInteger(e)&&Object.values(ScrollMode).includes(e)&&e!==ScrollMode.UNKNOWN}function isValidSpreadMode(e){return Number.isInteger(e)&&Object.values(SpreadMode).includes(e)&&e!==SpreadMode.UNKNOWN}function isPortraitOrientation(e){return e.width<=e.height}typeof document<"u"&&document.documentElement.style;var xmlParser=function(e){return new window.DOMParser().parseFromString(e,"text/xml")},getElementsByTagName=function(e,n){var o=Array.prototype.slice.call(e.childNodes),r=null;return o.forEach(function(u){u.tagName===n&&(r=u.childNodes)}),r};function bindEvents(e,n,o){var r,u=_createForOfIteratorHelper(o);try{for(u.s();!(r=u.n()).done;){var s=r.value;n.addEventListener(s,e[s].bind(e))}}catch(w){u.e(w)}finally{u.f()}}function getFontAttribute(e){var n=null;return Array.prototype.slice.call(e.childNodes).forEach(function(o){if(o.tagName==="defaultappearance"){var r=(o.innerHTML||o.textContent||"").split(" ");n={"font-size":parseInt(r[5],10),"font-name":r[4].substr(1),"font-color":rgbToHex(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]))}}else if(o.tagName==="contents-richtext"){var u=o.innerHTML||o.textContent||"";u=u.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&quot;",'"').replaceAll("&#39;","'").replaceAll("&amp;","&");var s=new window.DOMParser().parseFromString(u,"text/xml").getElementsByTagName("body")[0].getAttribute("style"),w={};s.split(";").forEach(function(m){var v=_slicedToArray(m.split(":").map(function(f){return f.trim()}),2),g=v[0],d=v[1];g&&d&&(w[g]=d)})}}),n&&{fontName:n["font-name"],fontSize:parseFloat(n["font-size"]),fontColor:n.color}}var ANNOTATION_TYPE={ink:"ink",freetext:"freetext",text:"text",square:"square",circle:"circle",line:"line",arrow:"line",image:"image",highlight:"highlight",underline:"underline",strikeout:"strikeout",squiggly:"squiggly",stamp:"stamp",redact:"redact"},parseAnnotationFromXml=function(e){if(!e)return[];for(var n=xmlParser(e),o=n.firstElementChild||n.firstChild,r=getElementsByTagName(o,"annots")||[],u=Array.prototype.slice.call(r),s=[],w=0;w<u.length;w++){var m=u[w],v=ANNOTATION_TYPE[m.tagName],g=m.attributes;if(v){var d={date:g.date?g.date.value:g.creationdate?g.creationdate.value:void 0,color:g.color?g.color.value:void 0,flags:g.flags?g.flags.value:void 0,rect:g.rect?g.rect.value:void 0,name:g.name?g.name.value:v4(),width:g.width?g.width.value:void 0,"interior-color":g["interior-color"]?g["interior-color"].value:void 0,page:g.page?g.page.value:void 0,opacity:g.opacity?g.opacity.value:1,type:v};if(d.flags&&d.flags.indexOf("hidden")>-1&&(d.isHidden=1),["highlight","underline","strikeout","squiggly"].includes(v)){var f=getContent(m);f&&(d.content=f),d.coords=g.coords?g.coords.value:void 0}if(v==="line"){if(!d.rect)continue;d.start=g.start?g.start.value:void 0,d.end=g.end?g.end.value:void 0}if(v==="line"&&g.tail&&g.tail.value==="openarrow"&&(d.tail="openarrow",d.head="none"),(v==="square"||v==="circle"||v==="text"||v==="line")&&!d.rect)continue;if(v==="ink"){var y=getPosition(m);if(!y)continue;!d.inklist&&(d.inklist={}),d.inklist.gesture=y}if(v==="text"||v==="freetext"){if(!d.rect)continue;var x=getContent(m);x&&(d.content=x)}if(v==="freetext"){d.justification=g.justification?g.justification.value:void 0;var k=getFontAttribute(m);k&&(d.textStyle=k)}if(v==="stamp"){if(!g["stamp-type"]||g["stamp-type"].value==="image")continue;d["stamp-type"]=g["stamp-type"]?g["stamp-type"].value:void 0,d.icon=g.icon?g.icon.value:void 0}s.push(d)}}return s},getPosition=function(e){var n=[],o=e.children[0].children;return Array.prototype.slice.call(o).forEach(function(r){r.tagName==="gesture"&&n.push(r.innerHTML||r.textContent||"")}),n.length===0&&(n=""),n},getContent=function(e){var n="";return Array.prototype.slice.call(e.childNodes).forEach(function(o){if(o.tagName==="contents")n=o.innerHTML||o.textContent||"";else if(o.tagName==="contents-richtext"){var r=o.innerHTML||o.textContent||"";r=r.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&quot;",'"').replaceAll("&#39;","'").replaceAll("&amp;","&");var u=new window.DOMParser().parseFromString(r,"text/xml");n=u.firstElementChild.innerText}}),n};function unreachable(e){throw new Error(e)}function assert(e,n){e||unreachable(n)}function shadow$1(e,n,o){var r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return(typeof PDFJSDev>"u"||PDFJSDev.test("!PRODUCTION || TESTING"))&&assert(n in e,'shadow: Property "'.concat(n&&n.toString(),'" not found in object.')),Object.defineProperty(e,n,{value:o,enumerable:!r,configurable:!0,writable:!1}),o}var Util=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"makeHexColor",value:function(n,o,r){return"#".concat(hexNumbers[n]).concat(hexNumbers[o]).concat(hexNumbers[r])}},{key:"scaleMinMax",value:function(n,o){var r;n[0]?(n[0]<0&&(r=o[0],o[0]=o[1],o[1]=r),o[0]*=n[0],o[1]*=n[0],n[3]<0&&(r=o[2],o[2]=o[3],o[3]=r),o[2]*=n[3],o[3]*=n[3]):(r=o[0],o[0]=o[2],o[2]=r,r=o[1],o[1]=o[3],o[3]=r,n[1]<0&&(r=o[2],o[2]=o[3],o[3]=r),o[2]*=n[1],o[3]*=n[1],n[2]<0&&(r=o[0],o[0]=o[1],o[1]=r),o[0]*=n[2],o[1]*=n[2]),o[0]+=n[4],o[1]+=n[4],o[2]+=n[5],o[3]+=n[5]}},{key:"transform",value:function(n,o){return[n[0]*o[0]+n[2]*o[1],n[1]*o[0]+n[3]*o[1],n[0]*o[2]+n[2]*o[3],n[1]*o[2]+n[3]*o[3],n[0]*o[4]+n[2]*o[5]+n[4],n[1]*o[4]+n[3]*o[5]+n[5]]}},{key:"applyTransform",value:function(n,o){return[n[0]*o[0]+n[1]*o[2]+o[4],n[0]*o[1]+n[1]*o[3]+o[5]]}},{key:"applyInverseTransform",value:function(n,o){var r=o[0]*o[3]-o[1]*o[2];return[(n[0]*o[3]-n[1]*o[2]+o[2]*o[5]-o[4]*o[3])/r,(-n[0]*o[1]+n[1]*o[0]+o[4]*o[1]-o[5]*o[0])/r]}},{key:"getAxialAlignedBoundingBox",value:function(n,o){var r=e.applyTransform(n,o),u=e.applyTransform(n.slice(2,4),o),s=e.applyTransform([n[0],n[3]],o),w=e.applyTransform([n[2],n[1]],o);return[Math.min(r[0],u[0],s[0],w[0]),Math.min(r[1],u[1],s[1],w[1]),Math.max(r[0],u[0],s[0],w[0]),Math.max(r[1],u[1],s[1],w[1])]}},{key:"inverseTransform",value:function(n){var o=n[0]*n[3]-n[1]*n[2];return[n[3]/o,-n[1]/o,-n[2]/o,n[0]/o,(n[2]*n[5]-n[4]*n[3])/o,(n[4]*n[1]-n[5]*n[0])/o]}},{key:"singularValueDecompose2dScale",value:function(n){var o=[n[0],n[2],n[1],n[3]],r=n[0]*o[0]+n[1]*o[2],u=n[0]*o[1]+n[1]*o[3],s=n[2]*o[0]+n[3]*o[2],w=n[2]*o[1]+n[3]*o[3],m=(r+w)/2,v=Math.sqrt(Math.pow(r+w,2)-4*(r*w-s*u))/2,g=m+v||1,d=m-v||1;return[Math.sqrt(g),Math.sqrt(d)]}},{key:"normalizeRect",value:function(n){var o=n.slice(0);return n[0]>n[2]&&(o[0]=n[2],o[2]=n[0]),n[1]>n[3]&&(o[1]=n[3],o[3]=n[1]),o}},{key:"intersect",value:function(n,o){var r=Math.max(Math.min(n[0],n[2]),Math.min(o[0],o[2])),u=Math.min(Math.max(n[0],n[2]),Math.max(o[0],o[2]));if(r>u)return null;var s=Math.max(Math.min(n[1],n[3]),Math.min(o[1],o[3])),w=Math.min(Math.max(n[1],n[3]),Math.max(o[1],o[3]));return s>w?null:[r,s,u,w]}},{key:"bezierBoundingBox",value:function(n,o,r,u,s,w,m,v){for(var g,d,f,y,x,k,P,S,E=[],M=[[],[]],T=0;T<2;++T)if(T===0?(d=6*n-12*r+6*s,g=-3*n+9*r-9*s+3*m,f=3*r-3*n):(d=6*o-12*u+6*w,g=-3*o+9*u-9*w+3*v,f=3*u-3*o),Math.abs(g)<1e-12){if(Math.abs(d)<1e-12)continue;0<(y=-f/d)&&y<1&&E.push(y)}else P=d*d-4*f*g,S=Math.sqrt(P),P<0||(0<(x=(-d+S)/(2*g))&&x<1&&E.push(x),0<(k=(-d-S)/(2*g))&&k<1&&E.push(k));for(var D,N=E.length,I=N;N--;)D=1-(y=E[N]),M[0][N]=D*D*D*n+3*D*D*y*r+3*D*y*y*s+y*y*y*m,M[1][N]=D*D*D*o+3*D*D*y*u+3*D*y*y*w+y*y*y*v;return M[0][I]=n,M[1][I]=o,M[0][I+1]=m,M[1][I+1]=v,M[0].length=M[1].length=I+2,[Math.min.apply(Math,_toConsumableArray$1(M[0])),Math.min.apply(Math,_toConsumableArray$1(M[1])),Math.max.apply(Math,_toConsumableArray$1(M[0])),Math.max.apply(Math,_toConsumableArray$1(M[1]))]}},{key:"getBoundingBox",value:function(n,o,r,u){return[Math.abs(n-r),Math.abs(o-u)]}}])}();function getColorFormat(e){return e.startsWith("#")?"hex":e.startsWith("rgb(")?"rgb":e.startsWith("hsl")?"hsl":"unknown"}function convertColorToRGB(e){var n=getColorFormat(e);if(n==="hex")return hexToRgb(e);if(n==="rgb"){var o=e.match(/(\d+),\s*(\d+),\s*(\d+)/);return o?{R:parseInt(o[1]),G:parseInt(o[2]),B:parseInt(o[3])}:{error:"Invalid RGB format"}}if(n==="hsl"){var r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return{error:"Invalid HSL format"};var u=parseInt(r[1]),s=parseInt(r[2])/100,w=parseInt(r[3])/100;return hslToRgb$1(u,s,w)}console.error({message:"Invalid color value"})}function rgbToHex(e,n,o){var r=(16777216|e<<16|n<<8|o).toString(16).slice(1).toUpperCase();return"#".concat(r)}var onClickOutside$1=function(e,n){var o=function r(u){var s=!0;if(Array.isArray(e))e.forEach(function(w){w&&!w.contains(u.target)||(s=!1)});else if(!e||e.contains(u.target))return;s&&(n&&n(u),document.removeEventListener(isMobileDevice$1?"touchstart":"mousedown",r))};return document.addEventListener(isMobileDevice$1?"touchstart":"mousedown",o),o},onClickOutsideUp=function(e,n){var o=function r(u){var s=!0;if(Array.isArray(e))e.forEach(function(w){w&&!w.contains(u.target)||(s=!1)});else if(!e||e.contains(u.target))return;s&&(n&&n(u),document.removeEventListener(isMobileDevice$1?"touchend":"mouseup",r))};return document.addEventListener(isMobileDevice$1?"touchend":"mouseup",o),o};function hexToRgb(e){var n=e.slice(1),o=parseInt(n,16);return{R:o>>16&255,G:o>>8&255,B:255&o}}var hslToRgb$1=function(e,n,o){var r,u,s;if(e/=360,n===0)r=u=s=Math.round(255*o);else{var w=function(g,d,f){return f<0&&(f+=1),f>1&&(f-=1),f<.16666666666666666?g+6*(d-g)*f:f<.5?d:f<.6666666666666666?g+(d-g)*(.6666666666666666-f)*6:g},m=o<.5?o*(1+n):o+n-o*n,v=2*o-m;r=Math.round(255*w(v,m,e+1/3)),u=Math.round(255*w(v,m,e)),s=Math.round(255*w(v,m,e-1/3))}return{R:r,G:u,B:s}},setCss=function(e,n){if(e&&n)for(var o in n)e.style[o]=n[o]},_pagesRefCache=new WeakMap,PDFLinkService=function(){return _createClass(function e(){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_pagesRefCache,new Map),this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null},[{key:"setDocument",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.baseUrl=n,this.pdfDocument=e,_classPrivateFieldGet2(_pagesRefCache,this).clear()}},{key:"setViewer",value:function(e){this.pdfViewer=e}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(e){this.pdfViewer.currentPageNumber=e}},{key:"rotation",get:function(){return this.pdfViewer.pagesRotation},set:function(e){this.pdfViewer.pagesRotation=e}},{key:"goToPage",value:function(e){if(this.pdfDocument){var n=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||0|e;Number.isInteger(n)&&n>0&&n<=this.pagesCount?this.pdfViewer.scrollPageIntoView({pageNumber:n}):console.error('PDFLinkService.goToPage: "'.concat(e,'" is not a valid page.'))}}},{key:"cachePageRef",value:function(e,n){if(n){var o=n.gen===0?"".concat(n.num,"R"):"".concat(n.num,"R").concat(n.gen);_classPrivateFieldGet2(_pagesRefCache,this).set(o,e)}}},{key:"_cachedPageNumber",value:function(e){if(!e)return null;var n=e.gen===0?"".concat(e.num,"R"):"".concat(e.num,"R").concat(e.gen);return _classPrivateFieldGet2(_pagesRefCache,this).get(n)||null}},{key:"isPageVisible",value:function(e){return this.pdfViewer.isPageVisible(e)}},{key:"isPageCached",value:function(e){return this.pdfViewer.isPageCached(e)}}])}(),_activeCapability=new WeakMap,_updateCallback=new WeakMap,_callback=new WeakMap,_reason=new WeakMap,_active=new WeakMap,_PasswordPrompt_brand=new WeakSet,PasswordPrompt=function(){return _createClass(function r(u){var s=this;_classCallCheck(this,r),_classPrivateMethodInitSpec(this,_PasswordPrompt_brand),_classPrivateFieldInitSpec(this,_activeCapability,null),_classPrivateFieldInitSpec(this,_updateCallback,null),_classPrivateFieldInitSpec(this,_callback,null),_classPrivateFieldInitSpec(this,_reason,null),_classPrivateFieldInitSpec(this,_active,!1),this.dialog=u.dialog,this.label=u.label,this.input=u.input,this.submitButton=u.submitButton,this.cancelButton=u.cancelButton,this.$t=u.$t,this.submitButton.addEventListener("click",_assertClassBrand(_PasswordPrompt_brand,this,_verify).bind(this)),this.cancelButton.addEventListener("click",this.close.bind(this)),this.input.addEventListener("keyup",function(w){w.keyCode===13&&_assertClassBrand(_PasswordPrompt_brand,s,_verify).call(s),s.label.textContent="",s.input.value===""?s.submitButton.classList.add("disabled"):s.submitButton.classList.remove("disabled")})},[{key:"open",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(){var u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!_classPrivateFieldGet2(_activeCapability,this)){s.next=3;break}return s.next=3,_classPrivateFieldGet2(_activeCapability,this).promise;case 3:_classPrivateFieldSet2(_activeCapability,this,pdfExports.createPromiseCapability()),s.prev=4,this.dialog.classList.add("show"),this.submitButton.classList.add("disabled"),_classPrivateFieldSet2(_active,this,!0),s.next=14;break;case 10:throw s.prev=10,s.t0=s.catch(4),_classPrivateFieldSet2(_activeCapability,this,null),s.t0;case 14:(u=_classPrivateFieldGet2(_reason,this)===pdfExports.PasswordResponses.INCORRECT_PASSWORD)&&this.input.focus(),u?(this.label.textContent=this.$t("passwordDialog.wrongPwd"),this.label.style.color="red"):(this.label.style.color="",this.label.textContent="");case 17:case"end":return s.stop()}},r,this,[[4,10]])})),function(){return o.apply(this,arguments)})},{key:"close",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function r(){var u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:_classPrivateFieldGet2(_active,this)&&((u=new Event("click")).param=!1,document.getElementById("eyeVisible").dispatchEvent(u),this.dialog.classList.remove("show"),_classPrivateFieldSet2(_active,this,!1),_assertClassBrand(_PasswordPrompt_brand,this,_cancel).call(this));case 1:case"end":return s.stop()}},r,this)})),function(){return n.apply(this,arguments)})},{key:"setUpdateCallback",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function r(u,s,w){return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!_classPrivateFieldGet2(_activeCapability,this)){m.next=3;break}return m.next=3,_classPrivateFieldGet2(_activeCapability,this).promise;case 3:_classPrivateFieldSet2(_updateCallback,this,u),_classPrivateFieldSet2(_reason,this,s),_classPrivateFieldSet2(_callback,this,w);case 6:case"end":return m.stop()}},r,this)})),function(r,u,s){return e.apply(this,arguments)})}]);var e,n,o}();function _verify(){var e=this.input.value;(e==null?void 0:e.length)>0&&_assertClassBrand(_PasswordPrompt_brand,this,_invokeCallback).call(this,e)}function _cancel(){_assertClassBrand(_PasswordPrompt_brand,this,_invokeCallback).call(this,new Error("PasswordPrompt cancelled.")),_classPrivateFieldGet2(_activeCapability,this).resolve()}function _invokeCallback(e){_classPrivateFieldGet2(_updateCallback,this)&&(this.input.value="",_classPrivateFieldGet2(_updateCallback,this).call(this,e),_classPrivateFieldGet2(_callback,this).call(this,e),_classPrivateFieldSet2(_callback,this,null),_classPrivateFieldSet2(_updateCallback,this,null),this.close())}var RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},MARGIN_DISTANCE=10,AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1({1:"none",0:"check"},"1","circle"),2,"cross"),3,"diamond"),4,"square"),5,"star");var PixelsPerInch=_createClass(function e(){_classCallCheck(this,e)});_defineProperty$1(PixelsPerInch,"CSS",96),_defineProperty$1(PixelsPerInch,"PDF",72),_defineProperty$1(PixelsPerInch,"PDF_TO_CSS_UNITS",1);var KeyboardManager=function(){return _createClass(function e(n){_classCallCheck(this,e),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;var o,r=e.platform.isMac,u=_createForOfIteratorHelper(n);try{for(u.s();!(o=u.n()).done;){var s,w=_slicedToArray(o.value,2),m=w[0],v=w[1],g=_createForOfIteratorHelper(m);try{for(g.s();!(s=g.n()).done;){var d=s.value,f=d.startsWith("mac+");r&&f?(this.callbacks.set(d.slice(4),v),this.allKeys.add(d.split("+").at(-1))):r||f||(this.callbacks.set(d,v),this.allKeys.add(d.split("+").at(-1)))}}catch(y){g.e(y)}finally{g.f()}}}catch(y){u.e(y)}finally{u.f()}},[{key:"_serialize",value:function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);var n=this.buffer.join("+");return this.buffer.length=0,n}},{key:"exec",value:function(e,n){if(this.allKeys.has(n.key)){var o=this.callbacks.get(this._serialize(n));o&&(o.bind(e)(),n.stopPropagation(),n.preventDefault())}}}],[{key:"platform",get:function(){var e=typeof navigator<"u"?navigator.platform:"";return shadow$1(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}}])}();function opacityToHex(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")}var dayjs_minExports={},dayjs_min$1={get exports(){return dayjs_minExports},set exports(e){dayjs_minExports=e}};dayjs_min$1.exports=function(){var e=1e3,n=6e4,o=36e5,r="millisecond",u="second",s="minute",w="hour",m="day",v="week",g="month",d="quarter",f="year",y="date",x="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,S={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(ne){var ve=["th","st","nd","rd"],J=ne%100;return"["+ne+(ve[(J-20)%10]||ve[J]||ve[0])+"]"}},E=function(ne,ve,J){var fe=String(ne);return!fe||fe.length>=ve?ne:""+Array(ve+1-fe.length).join(J)+ne},M={s:E,z:function(ne){var ve=-ne.utcOffset(),J=Math.abs(ve),fe=Math.floor(J/60),Z=J%60;return(ve<=0?"+":"-")+E(fe,2,"0")+":"+E(Z,2,"0")},m:function ne(ve,J){if(ve.date()<J.date())return-ne(J,ve);var fe=12*(J.year()-ve.year())+(J.month()-ve.month()),Z=ve.clone().add(fe,g),j=J-Z<0,X=ve.clone().add(fe+(j?-1:1),g);return+(-(fe+(J-Z)/(j?Z-X:X-Z))||0)},a:function(ne){return ne<0?Math.ceil(ne)||0:Math.floor(ne)},p:function(ne){return{M:g,y:f,w:v,d:m,D:y,h:w,m:s,s:u,ms:r,Q:d}[ne]||String(ne||"").toLowerCase().replace(/s$/,"")},u:function(ne){return ne===void 0}},T="en",D={};D[T]=S;var N="$isDayjsObject",I=function(ne){return ne instanceof Y||!(!ne||!ne[N])},O=function ne(ve,J,fe){var Z;if(!ve)return T;if(typeof ve=="string"){var j=ve.toLowerCase();D[j]&&(Z=j),J&&(D[j]=J,Z=j);var X=ve.split("-");if(!Z&&X.length>1)return ne(X[0])}else{var H=ve.name;D[H]=ve,Z=H}return!fe&&Z&&(T=Z),Z||!fe&&T},F=function(ne,ve){if(I(ne))return ne.clone();var J=_typeof$1(ve)=="object"?ve:{};return J.date=ne,J.args=arguments,new Y(J)},q=M;q.l=O,q.i=I,q.w=function(ne,ve){return F(ne,{locale:ve.$L,utc:ve.$u,x:ve.$x,$offset:ve.$offset})};var Y=function(){function ne(J){this.$L=O(J.locale,null,!0),this.parse(J),this.$x=this.$x||J.x||{},this[N]=!0}var ve=ne.prototype;return ve.parse=function(J){this.$d=function(fe){var Z=fe.date,j=fe.utc;if(Z===null)return new Date(NaN);if(q.u(Z))return new Date;if(Z instanceof Date)return new Date(Z);if(typeof Z=="string"&&!/Z$/i.test(Z)){var X=Z.match(k);if(X){var H=X[2]-1||0,U=(X[7]||"0").substring(0,3);return j?new Date(Date.UTC(X[1],H,X[3]||1,X[4]||0,X[5]||0,X[6]||0,U)):new Date(X[1],H,X[3]||1,X[4]||0,X[5]||0,X[6]||0,U)}}return new Date(Z)}(J),this.init()},ve.init=function(){var J=this.$d;this.$y=J.getFullYear(),this.$M=J.getMonth(),this.$D=J.getDate(),this.$W=J.getDay(),this.$H=J.getHours(),this.$m=J.getMinutes(),this.$s=J.getSeconds(),this.$ms=J.getMilliseconds()},ve.$utils=function(){return q},ve.isValid=function(){return this.$d.toString()!==x},ve.isSame=function(J,fe){var Z=F(J);return this.startOf(fe)<=Z&&Z<=this.endOf(fe)},ve.isAfter=function(J,fe){return F(J)<this.startOf(fe)},ve.isBefore=function(J,fe){return this.endOf(fe)<F(J)},ve.$g=function(J,fe,Z){return q.u(J)?this[fe]:this.set(Z,J)},ve.unix=function(){return Math.floor(this.valueOf()/1e3)},ve.valueOf=function(){return this.$d.getTime()},ve.startOf=function(J,fe){var Z=this,j=!!q.u(fe)||fe,X=q.p(J),H=function(Ae,$e){var Me=q.w(Z.$u?Date.UTC(Z.$y,$e,Ae):new Date(Z.$y,$e,Ae),Z);return j?Me:Me.endOf(m)},U=function(Ae,$e){return q.w(Z.toDate()[Ae].apply(Z.toDate("s"),(j?[0,0,0,0]:[23,59,59,999]).slice($e)),Z)},te=this.$W,Q=this.$M,re=this.$D,Pe="set"+(this.$u?"UTC":"");switch(X){case f:return j?H(1,0):H(31,11);case g:return j?H(1,Q):H(0,Q+1);case v:var be=this.$locale().weekStart||0,we=(te<be?te+7:te)-be;return H(j?re-we:re+(6-we),Q);case m:case y:return U(Pe+"Hours",0);case w:return U(Pe+"Minutes",1);case s:return U(Pe+"Seconds",2);case u:return U(Pe+"Milliseconds",3);default:return this.clone()}},ve.endOf=function(J){return this.startOf(J,!1)},ve.$set=function(J,fe){var Z,j=q.p(J),X="set"+(this.$u?"UTC":""),H=(Z={},Z[m]=X+"Date",Z[y]=X+"Date",Z[g]=X+"Month",Z[f]=X+"FullYear",Z[w]=X+"Hours",Z[s]=X+"Minutes",Z[u]=X+"Seconds",Z[r]=X+"Milliseconds",Z)[j],U=j===m?this.$D+(fe-this.$W):fe;if(j===g||j===f){var te=this.clone().set(y,1);te.$d[H](U),te.init(),this.$d=te.set(y,Math.min(this.$D,te.daysInMonth())).$d}else H&&this.$d[H](U);return this.init(),this},ve.set=function(J,fe){return this.clone().$set(J,fe)},ve.get=function(J){return this[q.p(J)]()},ve.add=function(J,fe){var Z,j=this;J=Number(J);var X=q.p(fe),H=function(Q){var re=F(j);return q.w(re.date(re.date()+Math.round(Q*J)),j)};if(X===g)return this.set(g,this.$M+J);if(X===f)return this.set(f,this.$y+J);if(X===m)return H(1);if(X===v)return H(7);var U=(Z={},Z[s]=n,Z[w]=o,Z[u]=e,Z)[X]||1,te=this.$d.getTime()+J*U;return q.w(te,this)},ve.subtract=function(J,fe){return this.add(-1*J,fe)},ve.format=function(J){var fe=this,Z=this.$locale();if(!this.isValid())return Z.invalidDate||x;var j=J||"YYYY-MM-DDTHH:mm:ssZ",X=q.z(this),H=this.$H,U=this.$m,te=this.$M,Q=Z.weekdays,re=Z.months,Pe=Z.meridiem,be=function($e,Me,Ie,Le){return $e&&($e[Me]||$e(fe,j))||Ie[Me].slice(0,Le)},we=function($e){return q.s(H%12||12,$e,"0")},Ae=Pe||function($e,Me,Ie){var Le=$e<12?"AM":"PM";return Ie?Le.toLowerCase():Le};return j.replace(P,function($e,Me){return Me||function(Ie){switch(Ie){case"YY":return String(fe.$y).slice(-2);case"YYYY":return q.s(fe.$y,4,"0");case"M":return te+1;case"MM":return q.s(te+1,2,"0");case"MMM":return be(Z.monthsShort,te,re,3);case"MMMM":return be(re,te);case"D":return fe.$D;case"DD":return q.s(fe.$D,2,"0");case"d":return String(fe.$W);case"dd":return be(Z.weekdaysMin,fe.$W,Q,2);case"ddd":return be(Z.weekdaysShort,fe.$W,Q,3);case"dddd":return Q[fe.$W];case"H":return String(H);case"HH":return q.s(H,2,"0");case"h":return we(1);case"hh":return we(2);case"a":return Ae(H,U,!0);case"A":return Ae(H,U,!1);case"m":return String(U);case"mm":return q.s(U,2,"0");case"s":return String(fe.$s);case"ss":return q.s(fe.$s,2,"0");case"SSS":return q.s(fe.$ms,3,"0");case"Z":return X}return null}($e)||X.replace(":","")})},ve.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ve.diff=function(J,fe,Z){var j,X=this,H=q.p(fe),U=F(J),te=(U.utcOffset()-this.utcOffset())*n,Q=this-U,re=function(){return q.m(X,U)};switch(H){case f:j=re()/12;break;case g:j=re();break;case d:j=re()/3;break;case v:j=(Q-te)/6048e5;break;case m:j=(Q-te)/864e5;break;case w:j=Q/o;break;case s:j=Q/n;break;case u:j=Q/e;break;default:j=Q}return Z?j:q.a(j)},ve.daysInMonth=function(){return this.endOf(g).$D},ve.$locale=function(){return D[this.$L]},ve.locale=function(J,fe){if(!J)return this.$L;var Z=this.clone(),j=O(J,fe,!0);return j&&(Z.$L=j),Z},ve.clone=function(){return q.w(this.$d,this)},ve.toDate=function(){return new Date(this.valueOf())},ve.toJSON=function(){return this.isValid()?this.toISOString():null},ve.toISOString=function(){return this.$d.toISOString()},ve.toString=function(){return this.$d.toUTCString()},ne}(),_e=Y.prototype;return F.prototype=_e,[["$ms",r],["$s",u],["$m",s],["$H",w],["$W",m],["$M",g],["$y",f],["$D",y]].forEach(function(ne){_e[ne[1]]=function(ve){return this.$g(ve,ne[0],ne[1])}}),F.extend=function(ne,ve){return ne.$i||(ne(ve,Y,F),ne.$i=!0),F},F.locale=O,F.isDayjs=I,F.unix=function(ne){return F(1e3*ne)},F.en=D[T],F.Ls=D,F.p={},F}();var dayjs$1=dayjs_minExports,PDFAnnotation=function(){return _createClass(function e(n){_classCallCheck(this,e),this._boundFocusin=this.focusin.bind(this),this._boundFocusout=this.focusout.bind(this),this._hasBeenSelected=!1,this._isEditing=!1,this._isInEditMode=!1,this.annotation=n.annotation||null,this.parent=n.parent,this.id=n.id,this.width=this.height=null,this.pageIndex=n.parent.pageIndex,this.name=n.name,this.div=null,this.viewport=this.parent.viewport;var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1];this.x=n.x/r,this.y=n.y/u,this.rotation=this.viewport.rotation,this.isAttachedToDOM=!1},[{key:"setInBackground",value:function(){this.div.style.zIndex=0}},{key:"focusin",value:function(){this._hasBeenSelected?this._hasBeenSelected=!1:this.parent.setSelected(this)}},{key:"focusout",value:function(e){if(this.isAttachedToDOM){var n=e.relatedTarget;n!=null&&n.closest("#".concat(this.id))||(e.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove(),this.parent.unselect(this))}}},{key:"commitOrRemove",value:function(){this.isEmpty()?this.remove():this.commit()}},{key:"fixDims",value:function(){var e=this.div.style,n=e.height,o=e.width,r=o.endsWith("%"),u=n.endsWith("%");if(!r||!u){var s=_slicedToArray(this.parent.viewportBaseDimensions,2),w=s[0],m=s[1];r||(e.width="".concat(100*parseFloat(o)/w,"%")),u||(e.height="".concat(100*parseFloat(n)/m,"%"))}}},{key:"commit",value:function(){this.parent.addToAnnotationStorage(this)}},{key:"dragstart",value:function(e){var n=this.parent.div.getBoundingClientRect();this.startX=e.clientX-n.x,this.startY=e.clientY-n.y,e.dataTransfer.setData("text/plain",this.id),e.dataTransfer.effectAllowed="move"}},{key:"setAt",value:function(e,n,o,r){var u=_slicedToArray(this.parent.viewportBaseDimensions,2),s=u[0],w=u[1],m=_slicedToArray(this.screenToPageTranslation(o,r),2);o=m[0],r=m[1],this.x=(e+o)/s,this.y=(n+r)/w,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"translate",value:function(e,n){var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1],s=_slicedToArray(this.screenToPageTranslation(e,n),2);e=s[0],n=s[1],this.x+=e/r,this.y+=n/u,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"screenToPageTranslation",value:function(e,n){switch(this.parent.viewport.rotation){case 90:return[n,-e];case 180:return[-e,-n];case 270:return[-n,e];default:return[e,n]}}},{key:"setDims",value:function(e,n){var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1];this.div.style.width="".concat(100*e/r,"%"),this.div.style.height="".concat(100*n/u,"%")}},{key:"getInitialTranslation",value:function(){return[0,0]}},{key:"render",value:function(){if(this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.div.addEventListener("focusin",this._boundFocusin),this.div.addEventListener("focusout",this._boundFocusout),this.annotation){var e=this.rectCalc(position,this.parent.viewport.height,scale);this.div.style.top=e.top+"px",this.div.style.left=e.left+"px"}else{var n=_slicedToArray(this.getInitialTranslation(),2),o=n[0],r=n[1];this.translate(o,r)}return bindEvents(this,this.div,["dragstart","pointerdown"]),this.div}},{key:"rectCalc",value:function(e,n,o){return{top:n-e.top*o,left:e.left*o,width:(e.right-e.left)*o,height:(e.top-e.bottom)*o}}},{key:"pointerdown",value:function(e){var n=KeyboardManager.platform.isMac;e.button!==0||e.ctrlKey&&n?e.preventDefault():(e.ctrlKey&&!n||e.shiftKey||e.metaKey&&n?this.parent.toggleSelected(this):this.parent.setSelected(this),this._hasBeenSelected=!0)}},{key:"getRect",value:function(e,n){var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1],s=_slicedToArray(this.parent.pageDimensions,2),w=s[0],m=s[1],v=w*e/r,g=m*n/u,d=this.x*w,f=this.y*m,y=this.width*w,x=this.height*m;switch(this.rotation){case 0:return[d+v,m-f-g-x,d+v+y,m-f-g];case 90:return[d+g,m-f+v,d+g+x,m-f+v+y];case 180:return[d-v-y,m-f+g,d-v,m-f+g+x];case 270:return[d-g-x,m-f-v-y,d-g,m-f-v];default:throw new Error("Invalid rotation")}}},{key:"getRectInCurrentCoords",value:function(e,n){var o=_slicedToArray(e,4),r=o[0],u=o[1],s=o[2],w=o[3],m=s-r,v=w-u;switch(this.rotation){case 0:return[r,n-w,m,v];case 90:return[r,n-u,v,m];case 180:return[s,n-u,m,v];case 270:return[s,n-w,v,m];default:throw new Error("Invalid rotation")}}},{key:"enableEditMode",value:function(){this._isInEditMode=!0}},{key:"disableEditMode",value:function(){this._isInEditMode=!1}},{key:"isInEditMode",value:function(){return this._isInEditMode}},{key:"shouldGetKeyboardEvents",value:function(){return!1}},{key:"needsToBeRebuilt",value:function(){return this.div&&!this.isAttachedToDOM}},{key:"rebuild",value:function(){var e;(e=this.div)===null||e===void 0||e.addEventListener("focusin",this._boundFocusin)}},{key:"remove",value:function(){this.div.removeEventListener("focusin",this._boundFocusin),this.div.removeEventListener("focusout",this._boundFocusout),this.isEmpty()||this.commit(),this.parent.remove(this)}},{key:"select",value:function(){var e;(e=this.div)===null||e===void 0||e.classList.add("selectedAnnotation")}},{key:"unselect",value:function(){var e;(e=this.div)===null||e===void 0||e.classList.remove("selectedAnnotation")}},{key:"updateParams",value:function(e,n){}},{key:"disableEditing",value:function(){}},{key:"enableEditing",value:function(){}},{key:"propertiesToUpdate",get:function(){return{}}},{key:"contentDiv",get:function(){return this.div}},{key:"isEditing",get:function(){return this._isEditing},set:function(e){this._isEditing=e,e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}],[{key:"deserialize",value:function(e,n){var o=new this.prototype.constructor({parent:n,id:n.getNextId()});o.rotation=e.rotation;var r=_slicedToArray(n.pageDimensions,2),u=r[0],s=r[1],w=_slicedToArray(o.getRectInCurrentCoords(e.rect,s),4),m=w[0],v=w[1],g=w[2],d=w[3];return o.x=m/u,o.y=v/s,o.width=g/u,o.height=d/s,o}},{key:"renderImportAnnotations",value:function(e,n){var o=new this.prototype.constructor({parent:n,id:n.getNextId()});o.rotation=e.rotation;var r=_slicedToArray(n.pageDimensions,2),u=r[0],s=r[1],w=this.prototype.rectCalc(e.position,n.viewport.height,n.scaleFactor);return o.x=w.top/u,o.y=w.left/s,o.width=w.width/u,o.height=w.height/s,o}}])}(),_PDFAnnotationSticky;_defineProperty$1(PDFAnnotation,"_zIndex",1),_defineProperty$1(PDFAnnotation,"_defaultLineColor","#ff0000");var PDFAnnotationSticky=function(e){function n(o){var r;return _classCallCheck(this,n),(r=_callSuper(this,n,[_objectSpread2$1(_objectSpread2$1({},o),{},{name:"stickyAnnotation"})]))._boundEditorDivBlur=r.editorDivBlur.bind(r),r._boundEditorDivFocus=r.editorDivFocus.bind(r),r._boundEditorDivInput=r.editorDivInput.bind(r),r._boundEditorDivKeydown=r.editorDivKeydown.bind(r),r._content="",r._editorDivId="".concat(r.id,"-editor"),r._hasAlreadyBeenCommitted=!1,r.annotationObj=null,r._color=o.color||n._defaultColor,r._fontSize=o.fontSize||n._defaultFontSize,r._internalPadding=o.internalPadding||n._defaultInternalPadding,r._stickyWidth=20,r}return _inherits(n,PDFAnnotation),_createClass(n,[{key:"updateParams",value:function(o,r){switch(o){case AnnotationEditorParamsType.FREETEXT_SIZE:this._updateFontSize(r);break;case AnnotationEditorParamsType.FREETEXT_COLOR:this._updateColor(r)}}},{key:"propertiesToUpdate",get:function(){return[[AnnotationEditorParamsType.FREETEXT_SIZE,this._fontSize],[AnnotationEditorParamsType.FREETEXT_COLOR,this._color]]}},{key:"_updateFontSize",value:function(o){this.editorDiv.style.fontSize="".concat(o,"px"),this.translate(0,-(o-this._fontSize)*this.parent.scaleFactor),this._fontSize=o,this._setEditorDimensions()}},{key:"_updateColor",value:function(o){this._color=o,this.editorDiv.style.color=o}},{key:"getInitialTranslation",value:function(){return[-this._internalPadding*this.parent.scaleFactor,-(this._internalPadding+this._fontSize)*this.parent.scaleFactor]}},{key:"rebuild",value:function(){_get(_getPrototypeOf(n.prototype),"rebuild",this).call(this),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}},{key:"enableEditMode",value:function(){this.isInEditMode()||(this.parent.setEditingState(!1),_get(_getPrototypeOf(n.prototype),"enableEditMode",this).call(this),this.overlayDiv.classList.remove("enabled"),this.editorDiv.style.display="initial",this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("focus",this._boundEditorDivFocus),this.editorDiv.addEventListener("blur",this._boundEditorDivBlur),this.editorDiv.addEventListener("input",this._boundEditorDivInput))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&(this.parent.setEditingState(!0),_get(_getPrototypeOf(n.prototype),"disableEditMode",this).call(this),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this._editorDivId),this.editorDiv.style.display="none",this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this._boundEditorDivKeydown),this.editorDiv.removeEventListener("focus",this._boundEditorDivFocus),this.editorDiv.removeEventListener("blur",this._boundEditorDivBlur),this.editorDiv.removeEventListener("input",this._boundEditorDivInput),this.div.focus(),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}},{key:"focusin",value:function(o){_get(_getPrototypeOf(n.prototype),"focusin",this).call(this,o),o.target!==this.editorDiv&&this.editorDiv.focus()}},{key:"onceAdded",value:function(){this.width||(this.enableEditMode(),this.editorDiv.focus())}},{key:"isEmpty",value:function(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}},{key:"remove",value:function(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),_get(_getPrototypeOf(n.prototype),"remove",this).call(this)}},{key:"_extractText",value:function(){var o,r=this.editorDiv.getElementsByTagName("div");if(r.length===0)return this.editorDiv.innerText;var u=[];((o=this.editorDiv.firstChild)===null||o===void 0?void 0:o.nodeName)==="#text"&&u.push(this.editorDiv.firstChild.data);var s,w=_createForOfIteratorHelper(r);try{for(w.s();!(s=w.n()).done;){var m=s.value.firstChild;(m==null?void 0:m.nodeName)==="#text"?u.push(m.data):u.push("")}}catch(v){w.e(v)}finally{w.f()}return u.join(`
`)}},{key:"_setEditorDimensions",value:function(){var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1],s=this.div.getBoundingClientRect();this.width=s.width/r,this.height=s.height/u}},{key:"commit",value:function(){this._content=this._extractText().trimEnd();var o=_slicedToArray(this.parent.viewportBaseDimensions,2),r=o[0],u=o[1],s={left:this.x*r,bottom:this.y*u+this._stickyWidth,right:this.x*r+this._stickyWidth,top:this.y*u};this.annotationObj={id:v4(),obj_type:"Text",obj_attr:{bdcolor:"#FF2600",content:this._content||void 0,date:dayjs$1().format("YYYY-MM-DD_HH:mm:ss"),ftransparency:1,page:this.pageIndex,position:this.parsePositionForBackend(s,this.viewport.height,this.parent.scale),transparency:1}},_get(_getPrototypeOf(n.prototype),"commit",this).call(this),this._hasAlreadyBeenCommitted||(this._hasAlreadyBeenCommitted=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this._setEditorDimensions()}},{key:"parsePositionForBackend",value:function(o,r,u){return{left:Math.round(1e3*o.left/u)/1e3,bottom:Math.round(1e3*(r-o.bottom)/u)/1e3,right:Math.round(1e3*o.right/u)/1e3,top:Math.round(1e3*(r-o.top)/u)/1e3}}},{key:"shouldGetKeyboardEvents",value:function(){return this.isInEditMode()}},{key:"dblclick",value:function(){this.enableEditMode(),this.editorDiv.focus()}},{key:"keydown",value:function(o){o.target===this.div&&o.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}},{key:"editorDivKeydown",value:function(o){n._keyboardManager.exec(this,o)}},{key:"editorDivFocus",value:function(){this.isEditing=!0}},{key:"editorDivBlur",value:function(){this.isEditing=!1}},{key:"editorDivInput",value:function(o){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}},{key:"disableEditing",value:function(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}},{key:"enableEditing",value:function(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}},{key:"render",value:function(){if(this.div)return this.div;var o,r;this.width&&(o=this.x,r=this.y),_get(_getPrototypeOf(n.prototype),"render",this).call(this),this.iconDiv=document.createElement("div"),this.iconDiv.classList="icon-wrapper",this.iconDiv.innerHTML='<svg data-status="normal" width="32" height="32" viewBox="0 0 32 32"><g fill="none" fill-rule="evenodd"><path d="M0 0h32v32H0z"></path><path d="M28 5.333V24H14.667L8 28v-4H4V5.333h24zM18.667 18H9.333v1.333h9.334V18zm4-4H9.333v1.333h13.334V14zm0-4H9.333v1.333h13.334V10z" fill="#BE0C0E"></path></g></svg>',this.div.append(this.iconDiv),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal editor-container",this.editorDiv.setAttribute("id",this._editorDivId),this.enableEditing(),this.editorDiv.contentEditable=!0;var u=this.editorDiv.style;if(u.fontSize="".concat(this._fontSize,"px"),u.color=this._color,u.top="36px",u.left="50%",this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),bindEvents(this,this.div,["dblclick","keydown"]),this.width){this.setAt(o,r,this.width,this.height);var s,w=_createForOfIteratorHelper(this._content.split(`
`));try{for(w.s();!(s=w.n()).done;){var m=s.value,v=document.createElement("div");v.append(m?document.createTextNode(m):document.createElement("br")),this.editorDiv.append(v)}}catch(g){w.e(g)}finally{w.f()}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}},{key:"contentDiv",get:function(){return this.editorDiv}},{key:"serialize",value:function(){if(this.isEmpty())return null;var o=this._internalPadding*this.parent.scaleFactor,r=this.getRect(o,o);return{annotationType:AnnotationEditorType.FREETEXT,color:this._color,fontSize:this._fontSize,value:this._content,pageIndex:this.parent.pageIndex,rect:r,rotation:this.rotation}}}],[{key:"updateDefaultParams",value:function(o,r){switch(o){case AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=r;break;case AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=r}}},{key:"defaultPropertiesToUpdate",get:function(){return[[AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||n._defaultLineColor]]}},{key:"deserialize",value:function(o,r){var u;return(u=o.type==="custom"?_get(_getPrototypeOf(n),"renderImportAnnotations",this).call(this,o,r):_get(_getPrototypeOf(n),"deserialize",this).call(this,o,r))._fontSize=o.fontSize,u._color=this._color,u._content=o.value,u}}])}(),_InkEditor;_PDFAnnotationSticky=PDFAnnotationSticky,_defineProperty$1(PDFAnnotationSticky,"_defaultColor","#000"),_defineProperty$1(PDFAnnotationSticky,"_defaultFontSize",10),_defineProperty$1(PDFAnnotationSticky,"_defaultInternalPadding",2),_defineProperty$1(PDFAnnotationSticky,"_keyboardManager",new KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],_PDFAnnotationSticky.prototype.commitOrRemove]]));var RESIZER_SIZE=16,TIME_TO_WAIT_BEFORE_FIXING_DIMS=100,_InkEditor_brand=new WeakSet,InkEditor=function(e){function n(o){var r;return _classCallCheck(this,n),_classPrivateMethodInitSpec(r=_callSuper(this,n,[_objectSpread2$1(_objectSpread2$1({},o),{},{name:"inkEditor"})]),_InkEditor_brand),r._aspectRatio=0,r._zIndexForeground=n._zIndex++,r._baseHeight=0,r._baseWidth=0,r._boundCanvasPointermove=r.canvasPointermove.bind(r),r._boundCanvasPointerleave=r.canvasPointerleave.bind(r),r._boundCanvasPointerup=r.canvasPointerup.bind(r),r._boundCanvasPointerdown=r.canvasPointerdown.bind(r),r._disableEditing=!1,r._isCanvasInitialized=!1,r._lastPoint=null,r._observer=null,r._realWidth=0,r._realHeight=0,r._requestFrameCallback=null,r.color=o.color||null,r.thickness=o.thickness||null,r.opacity=o.opacity||null,r.paths=[],r.bezierPath2D=[],r.currentPath=[],r.arrowPoints=[],r.scaleFactor=1,r.translationX=r.translationY=0,r.x=0,r.y=0,r}return _inherits(n,PDFAnnotation),_createClass(n,[{key:"updateParams",value:function(o,r){switch(o){case AnnotationEditorParamsType.INK_THICKNESS:this._updateThickness(r);break;case AnnotationEditorParamsType.INK_COLOR:this._updateColor(r);break;case AnnotationEditorParamsType.INK_OPACITY:this._updateOpacity(r)}}},{key:"propertiesToUpdate",get:function(){var o;return[[AnnotationEditorParamsType.INK_THICKNESS,this.thickness||n._defaultThickness],[AnnotationEditorParamsType.INK_COLOR,this.color||n._defaultColor||PDFAnnotation._defaultLineColor],[AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((o=this.opacity)!==null&&o!==void 0?o:n._defaultOpacity))]]}},{key:"_updateThickness",value:function(o){this.thickness=o,_assertClassBrand(_InkEditor_brand,this,_fitToContent).call(this)}},{key:"_updateColor",value:function(o){var r=this,u=this.color;this.parent.addCommands({cmd:function(){r.color=o,_assertClassBrand(_InkEditor_brand,r,_redraw).call(r)},undo:function(){r.color=u,_assertClassBrand(_InkEditor_brand,r,_redraw).call(r)},mustExec:!0,type:AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}},{key:"_updateOpacity",value:function(o){var r=this;o/=100;var u=this.opacity;this.parent.addCommands({cmd:function(){r.opacity=o,_assertClassBrand(_InkEditor_brand,r,_redraw).call(r)},undo:function(){r.opacity=u,_assertClassBrand(_InkEditor_brand,r,_redraw).call(r)},mustExec:!0,type:AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}},{key:"rebuild",value:function(){_get(_getPrototypeOf(n.prototype),"rebuild",this).call(this),this.div!==null&&(this.canvas||_assertClassBrand(_InkEditor_brand,this,_createCanvas).call(this),this.isAttachedToDOM||(this.parent.add(this),_assertClassBrand(_InkEditor_brand,this,_setCanvasDims).call(this)),_assertClassBrand(_InkEditor_brand,this,_fitToContent).call(this))}},{key:"remove",value:function(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this._observer.disconnect(),this._observer=null,_get(_getPrototypeOf(n.prototype),"remove",this).call(this))}},{key:"enableEditMode",value:function(){this._disableEditing||this.canvas===null||(_get(_getPrototypeOf(n.prototype),"enableEditMode",this).call(this),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this._boundCanvasPointerdown),this.canvas.addEventListener("pointerup",this._boundCanvasPointerup))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&this.canvas!==null&&(_get(_getPrototypeOf(n.prototype),"disableEditMode",this).call(this),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerup",this._boundCanvasPointerup))}},{key:"onceAdded",value:function(){this.div.draggable=!this.isEmpty()}},{key:"isEmpty",value:function(){return!this.paths||this.paths.length<2}},{key:"drawLine",value:function(o,r){var u,s,w,m=o[0]-r[0],v=o[1]-r[1],g=Math.atan(v/m),d=[(o[0]+r[0])/2,(o[1]+r[1])/2];this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),(u=this.ctx).moveTo.apply(u,_toConsumableArray$1(o)),(s=this.ctx).lineTo.apply(s,_toConsumableArray$1(r)),this.ctx.stroke(),this.drawStartLineArrow.apply(this,_toConsumableArray$1(o).concat(_toConsumableArray$1(r))),this.drawEndLineArrow.apply(this,_toConsumableArray$1(o).concat(_toConsumableArray$1(r))),this._move&&this.drawCircle(o,r,g),this.ctx.save(),(w=this.ctx).translate.apply(w,d),this.ctx.beginPath(),this.ctx.rotate(g);var f=Math.round(10*Math.sqrt(m*m+v*v))/10;this.ctx.fillStyle="blue",this.ctx.font="12px Arial";var y=this.ctx.measureText(f+" pt").width;this.ctx.fillText(f+" pt",-y*Math.cos(g)/2,0),this.ctx.restore(),this.ctx.save(),this.parent._uiManager._eventBus.dispatch("distanceChanged",{distance:f})}},{key:"drawCircle",value:function(o,r){var u=o[0]-r[0],s=o[1]-r[1],w=Math.atan(s/u),m=o[0]+10*Math.cos(w),v=o[1]+10*Math.sin(w),g=this.ctx,d="#0097ff";g.fillStyle=d,g.beginPath(),g.arc(m,v,6,0,2*Math.PI,!0),g.fill(),g.stroke();var f=r[0]-10*Math.cos(w),y=r[1]-10*Math.sin(w);g.fillStyle=d,g.beginPath(),g.arc(f,y,6,0,2*Math.PI,!0),g.fill(),g.stroke(),this._dragStartPoint=[m,v],this._dragEndPoint=[f,y]}},{key:"drawStartLineArrow",value:function(o,r,u,s){var w,m,v=180*Math.atan2(s-r,u-o)/Math.PI,g=(v+30)*Math.PI/180,d=(v-30)*Math.PI/180,f=10*Math.cos(g),y=10*Math.sin(g),x=10*Math.cos(d),k=10*Math.sin(d);w=o+f,m=r+y,this.arrowPoints[0]=[w,m],this.ctx.moveTo(w,m),this.ctx.lineTo(o,r),w=o+x,m=r+k,this.arrowPoints[1]=[w,m],this.ctx.lineTo(w,m),this.ctx.stroke()}},{key:"drawEndLineArrow",value:function(o,r,u,s){var w,m,v=180*Math.atan2(r-s,o-u)/Math.PI,g=(v+30)*Math.PI/180,d=(v-30)*Math.PI/180,f=10*Math.cos(g),y=10*Math.sin(g),x=10*Math.cos(d),k=10*Math.sin(d);w=u+f,m=s+y,this.arrowPoints[2]=[w,m],this.ctx.moveTo(w,m),this.ctx.lineTo(u,s),w=u+x,m=s+k,this.arrowPoints[3]=[w,m],this.ctx.lineTo(w,m),this.ctx.stroke()}},{key:"commit",value:function(){this._disableEditing||(_get(_getPrototypeOf(n.prototype),"commit",this).call(this),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this._disableEditing=!0,this.div.classList.add("disabled"),_assertClassBrand(_InkEditor_brand,this,_fitToContent).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}},{key:"focusin",value:function(o){_get(_getPrototypeOf(n.prototype),"focusin",this).call(this,o),this.enableEditMode()}},{key:"canvasPointerdown",value:function(o){o.button===0&&this.isInEditMode()&&!this._disableEditing&&(this.setInForeground(),o.type!=="mouse"&&this.div.focus(),o.stopPropagation(),this.canvas.addEventListener("pointerleave",this._boundCanvasPointerleave),this.canvas.addEventListener("pointermove",this._boundCanvasPointermove),_assertClassBrand(_InkEditor_brand,this,_startDrawing).call(this,o.offsetX,o.offsetY))}},{key:"canvasPointermove",value:function(o){o.stopPropagation(),_assertClassBrand(_InkEditor_brand,this,_draw).call(this,o.offsetX,o.offsetY)}},{key:"canvasPointerup",value:function(o){if(o.button===0&&(this.isInEditMode()&&this.currentPath.length!==0&&(o.stopPropagation(),_assertClassBrand(_InkEditor_brand,this,_endDrawing).call(this,o),this.setInBackground()),this.isAttachedToDOM&&!(this.currentPath.length<2))){var r=o.relatedTarget;r!=null&&r.closest("#".concat(this.id))||(o.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove(),this.parent.unselect(this))}}},{key:"canvasPointerleave",value:function(o){_assertClassBrand(_InkEditor_brand,this,_endDrawing).call(this,o),this.setInBackground()}},{key:"setInForeground",value:function(){this.div.style.zIndex=this._zIndexForeground}},{key:"render",value:function(){if(this.div)return this.div;var o,r;this.width&&(o=this.x,r=this.y),_get(_getPrototypeOf(n.prototype),"render",this).call(this);var u=_slicedToArray(_assertClassBrand(_InkEditor_brand,this,_getInitialBBox).call(this),4),s=u[0],w=u[1],m=u[2],v=u[3];if(this.setAt(s,w,0,0),this.setDims(m,v),_assertClassBrand(_InkEditor_brand,this,_createCanvas).call(this),this.width){var g=_slicedToArray(this.parent.viewportBaseDimensions,2),d=g[0],f=g[1];this.setAt(o*d,r*f,this.width*d,this.height*f),this._isCanvasInitialized=!0,_assertClassBrand(_InkEditor_brand,this,_setCanvasDims).call(this),this.setDims(this.width*d,this.height*f),_assertClassBrand(_InkEditor_brand,this,_redraw).call(this),_assertClassBrand(_InkEditor_brand,this,_setMinDims).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return _assertClassBrand(_InkEditor_brand,this,_createObserver).call(this),this.div}},{key:"setDimensions",value:function(o,r){var u=Math.round(o),s=Math.round(r);if(this._realWidth!==u||this._realHeight!==s){this._realWidth=u,this._realHeight=s,this.canvas.style.visibility="hidden",this._aspectRatio&&Math.abs(this._aspectRatio-o/r)>.01&&(r=Math.ceil(o/this._aspectRatio),this.setDims(o,r));var w=_slicedToArray(this.parent.viewportBaseDimensions,2),m=w[0],v=w[1];this.width=o/m,this.height=r/v,this._disableEditing&&_assertClassBrand(_InkEditor_brand,this,_setScaleFactor).call(this,o,r),_assertClassBrand(_InkEditor_brand,this,_setCanvasDims).call(this),_assertClassBrand(_InkEditor_brand,this,_redraw).call(this),this.canvas.style.visibility="visible"}}},{key:"serialize",value:function(){if(this.isEmpty())return null;var o=this.getRect(0,0),r=this.rotation%180==0?o[3]-o[1]:o[2]-o[0],u=PDFAnnotation._defaultLineColor;return{annotationType:AnnotationEditorType.INK,color:u,thickness:this.thickness,opacity:this.opacity,paths:_assertClassBrand(_InkEditor_brand,this,_serializePaths).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,r),pageIndex:this.parent.pageIndex,rect:o,rotation:this.rotation}}}],[{key:"updateDefaultParams",value:function(o,r){switch(o){case AnnotationEditorParamsType.INK_THICKNESS:n._defaultThickness=r;break;case AnnotationEditorParamsType.INK_COLOR:n._defaultColor=r;break;case AnnotationEditorParamsType.INK_OPACITY:n._defaultOpacity=r/100}}},{key:"defaultPropertiesToUpdate",get:function(){return[[AnnotationEditorParamsType.INK_THICKNESS,n._defaultThickness],[AnnotationEditorParamsType.INK_COLOR,n._defaultColor||PDFAnnotation._defaultLineColor],[AnnotationEditorParamsType.INK_OPACITY,Math.round(100*n._defaultOpacity)]]}},{key:"deserialize",value:function(o,r){var u=_get(_getPrototypeOf(n),"deserialize",this).call(this,o,r);u.thickness=o.thickness,u.color=Util.makeHexColor.apply(Util,_toConsumableArray$1(o.color)),u.opacity=o.opacity;var s=_slicedToArray(r.pageDimensions,2),w=s[0],m=s[1],v=u.width*w,g=u.height*m,d=r.scaleFactor,f=o.thickness/2;u._aspectRatio=v/g,u._disableEditing=!0,u._realWidth=Math.round(v),u._realHeight=Math.round(g);var y,x=_createForOfIteratorHelper(o.paths);try{for(x.s();!(y=x.n()).done;){var k=y.value.bezier,P=[];u.paths.push(P);for(var S=d*(k[0]-f),E=d*(g-k[1]-f),M=2,T=k.length;M<T;M+=6){var D=d*(k[M]-f),N=d*(g-k[M+1]-f),I=d*(k[M+2]-f),O=d*(g-k[M+3]-f),F=d*(k[M+4]-f),q=d*(g-k[M+5]-f);P.push([[S,E],[D,N],[I,O],[F,q]]),S=F,E=q}var Y=_assertClassBrand(n,this,_buildPath2D).call(this,P);u.bezierPath2D.push(Y)}}catch(ne){x.e(ne)}finally{x.f()}var _e=_assertClassBrand(_InkEditor_brand,u,_getBbox).call(u);return u._baseWidth=Math.max(RESIZER_SIZE,_e[2]-_e[0]),u._baseHeight=Math.max(RESIZER_SIZE,_e[3]-_e[1]),_assertClassBrand(_InkEditor_brand,u,_setScaleFactor).call(u,v,g),u}}])}();function _getInitialBBox(){var e=this.parent.viewport,n=e.width,o=e.height;switch(e.rotation){case 90:return[0,n,n,o];case 180:return[n,o,n,o];case 270:return[o,0,n,o];default:return[0,0,n,o]}}function _setStroke(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle="".concat(this.color).concat(opacityToHex(this.opacity))}function _startDrawing(e,n){var o,r=this;this.isEditing=!0,this._isCanvasInitialized||(this._isCanvasInitialized=!0,_assertClassBrand(_InkEditor_brand,this,_setCanvasDims).call(this),this.thickness||(this.thickness=_InkEditor._defaultThickness),this.color||(this.color=_InkEditor._defaultColor||PDFAnnotation._defaultLineColor),(o=this.opacity)!==null&&o!==void 0||(this.opacity=_InkEditor._defaultOpacity)),this.currentPath[0]=[e,n],this._lastPoint=null,_assertClassBrand(_InkEditor_brand,this,_setStroke).call(this),this._requestFrameCallback=function(){r._requestFrameCallback&&(r._lastPoint&&(r.drawLine(r.currentPath[0],r._lastPoint),r._lastPoint=null),window.requestAnimationFrame(r._requestFrameCallback))},window.requestAnimationFrame(this._requestFrameCallback)}function _draw(e,n){var o=_slicedToArray(this.currentPath.at(-1),2),r=o[0],u=o[1];e===r&&n===u||(this.currentPath[1]=[e,n],this._lastPoint=[e,n])}function _stopDrawing(e,n){this.ctx.closePath(),this._requestFrameCallback=null,e=Math.min(Math.max(e,0),this.canvas.width),n=Math.min(Math.max(n,0),this.canvas.height);var o=_slicedToArray(this.currentPath.at(-1),2),r=o[0],u=o[1];e===r&&n===u||(this.currentPath[1]=[e,n]),this.currentPath.length!==0&&(this.paths=_toConsumableArray$1(this.currentPath),this.rebuild())}function _redraw(){this.isEmpty()?_assertClassBrand(_InkEditor_brand,this,_updateTransform).call(this):(_assertClassBrand(_InkEditor_brand,this,_setStroke).call(this),this.canvas,this.ctx.setTransform(1,0,0,1,0,0),_assertClassBrand(_InkEditor_brand,this,_updateTransform).call(this),this.drawLine(this.currentPath[0],this.currentPath[1]))}function _endDrawing(e){_assertClassBrand(_InkEditor_brand,this,_stopDrawing).call(this,e.offsetX,e.offsetY),this.canvas.removeEventListener("pointerleave",this._boundCanvasPointerleave),this.canvas.removeEventListener("pointermove",this._boundCanvasPointermove),this.parent.addToAnnotationStorage(this)}function _createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d"),this.textCtx=this.canvas.getContext("2d")}function _createObserver(){var e=this,n=null;this._observer=new ResizeObserver(function(o){var r=o[0].contentRect;r.width&&r.height&&(n!==null&&clearTimeout(n),n=setTimeout(function(){e.fixDims(),n=null},TIME_TO_WAIT_BEFORE_FIXING_DIMS),e.setDimensions(r.width,r.height))}),this._observer.observe(this.div)}function _setCanvasDims(){if(this._isCanvasInitialized){var e=_slicedToArray(this.parent.viewportBaseDimensions,2),n=e[0],o=e[1];this.canvas.width=Math.ceil(this.width*n),this.canvas.height=Math.ceil(this.height*o),_assertClassBrand(_InkEditor_brand,this,_updateTransform).call(this)}}function _setScaleFactor(e,n){var o=_assertClassBrand(_InkEditor_brand,this,_getPadding).call(this),r=(e-o)/this._baseWidth,u=(n-o)/this._baseHeight;this.scaleFactor=Math.min(r,u)}function _updateTransform(){var e=_assertClassBrand(_InkEditor_brand,this,_getPadding).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}function _buildPath2D(e){for(var n=new Path2D,o=0,r=e.length;o<r;o++){var u=_slicedToArray(e[o],4),s=u[0],w=u[1],m=u[2],v=u[3];o===0&&n.moveTo.apply(n,_toConsumableArray$1(s)),n.bezierCurveTo(w[0],w[1],m[0],m[1],v[0],v[1])}return n}function _serializePaths(e,n,o,r){var u,s,w,m=[],v=this.thickness/2,g=_createForOfIteratorHelper(this.paths);try{for(g.s();!(w=g.n()).done;){var d=w.value;u=[],s=[];for(var f=0,y=d.length;f<y;f++){var x=_slicedToArray(d[f],4),k=x[0],P=x[1],S=x[2],E=x[3],M=e*(k[0]+n)+v,T=r-e*(k[1]+o)-v,D=e*(P[0]+n)+v,N=r-e*(P[1]+o)-v,I=e*(S[0]+n)+v,O=r-e*(S[1]+o)-v,F=e*(E[0]+n)+v,q=r-e*(E[1]+o)-v;f===0&&(u.push(M,T),s.push(M,T)),u.push(D,N,I,O,F,q),_assertClassBrand(_InkEditor_brand,this,_extractPointsOnBezier).call(this,M,T,D,N,I,O,F,q,4,s)}m.push({bezier:u,points:s})}}catch(Y){g.e(Y)}finally{g.f()}return m}function _extractPointsOnBezier(e,n,o,r,u,s,w,m,v,g){if(_assertClassBrand(_InkEditor_brand,this,_isAlmostFlat).call(this,e,n,o,r,u,s,w,m))g.push(w,m);else{for(var d=1;d<v-1;d++){var f=d/v,y=1-f,x=f*e+y*o,k=f*n+y*r,P=f*o+y*u,S=f*r+y*s;x=f*(x=f*x+y*P)+y*(P=f*P+y*(f*u+y*w)),k=f*(k=f*k+y*S)+y*(S=f*S+y*(f*s+y*m)),g.push(x,k)}g.push(w,m)}}function _isAlmostFlat(e,n,o,r,u,s,w,m){var v=Math.pow(3*o-2*e-w,2),g=Math.pow(3*r-2*n-m,2),d=Math.pow(3*u-e-2*w,2),f=Math.pow(3*s-n-2*m,2);return Math.max(v,d)+Math.max(g,f)<=10}function _getBbox(){var e,n=1/0,o=-1/0,r=1/0,u=-1/0,s=_createForOfIteratorHelper([].concat(_toConsumableArray$1(this.currentPath),_toConsumableArray$1(this.arrowPoints)));try{for(s.s();!(e=s.n()).done;){var w=_slicedToArray(e.value,2),m=w[0],v=w[1];n=Math.min(m,n),r=Math.min(v,r),o=Math.max(m,o),u=Math.max(v,u)}}catch(g){s.e(g)}finally{s.f()}return[n,r,o,u]}function _getPadding(){return this._disableEditing?Math.ceil(this.thickness*this.parent.scaleFactor):0}function _fitToContent(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!this.isEmpty())if(this._disableEditing){var n=_assertClassBrand(_InkEditor_brand,this,_getBbox).call(this),o=_assertClassBrand(_InkEditor_brand,this,_getPadding).call(this);this._baseWidth=Math.max(RESIZER_SIZE,n[2]-n[0]),this._baseHeight=Math.max(RESIZER_SIZE,n[3]-n[1]);var r=Math.ceil(o+this._baseWidth*this.scaleFactor),u=Math.ceil(o+this._baseHeight*this.scaleFactor),s=_slicedToArray(this.parent.viewportBaseDimensions,2),w=s[0],m=s[1];this.width=r/w,this.height=u/m,this._aspectRatio=r/u,_assertClassBrand(_InkEditor_brand,this,_setMinDims).call(this);var v=this.translationX,g=this.translationY;this.translationX=-n[0],this.translationY=-n[1],_assertClassBrand(_InkEditor_brand,this,_setCanvasDims).call(this),_assertClassBrand(_InkEditor_brand,this,_redraw).call(this),this._realWidth=r,this._realHeight=u,this.setDims(r,u);var d=e?o/this.scaleFactor/2:0;this.translate(v-this.translationX-d,g-this.translationY-d)}else _assertClassBrand(_InkEditor_brand,this,_redraw).call(this)}function _setMinDims(){var e=this.div.style;this._aspectRatio>=1?(e.minHeight="".concat(RESIZER_SIZE,"px"),e.minWidth="".concat(Math.round(this._aspectRatio*RESIZER_SIZE),"px")):(e.minWidth="".concat(RESIZER_SIZE,"px"),e.minHeight="".concat(Math.round(RESIZER_SIZE/this._aspectRatio),"px"))}_InkEditor=InkEditor,_defineProperty$1(InkEditor,"_defaultColor",null),_defineProperty$1(InkEditor,"_defaultOpacity",1),_defineProperty$1(InkEditor,"_defaultThickness",1),_defineProperty$1(InkEditor,"_l10nPromise",void 0),_defineProperty$1(InkEditor,"_type","ink"),_defineProperty$1(InkEditor,"_zIndex",1);var PDFAnnotationLayer=function(){return _createClass(function e(n){_classCallCheck(this,e),this._cancelled=!1,this._allowClick=!1,this._boundPointerup=this.pointerup.bind(this),this._boundPointerdown=this.pointerdown.bind(this),this._editors=new Map,this._hadPointerDown=!1,this._isCleaningUp=!1,this._uiManager=n.uiManager,this.pageDiv=n.pageDiv,this.div=null,this.scale=n.scale,this._accessibilityManager=n.accessibilityManager,n.uiManager.registerEditorTypes([PDFAnnotationSticky,InkEditor]),this.annotationStorage=n.annotationStorage||null,this.pageIndex=n.pageIndex},[{key:"updateToolbar",value:function(e){this._uiManager.updateToolbar(e)}},{key:"updateMode",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._uiManager.getMode();this._cleanup(),e===AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this._uiManager.unselectAll(),this.div.classList.toggle("freeTextEditing",e===AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===AnnotationEditorType.INK)}},{key:"moveEditorInDOM",value:function(e){var n;(n=this._accessibilityManager)===null||n===void 0||n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}},{key:"addInkEditorIfNeeded",value:function(e){if(e||this._uiManager.getMode()===AnnotationEditorType.INK){if(!e){var n,o=_createForOfIteratorHelper(this._editors.values());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.isEmpty())return void r.setInBackground()}}catch(u){o.e(u)}finally{o.f()}}this._createAndAddNewEditor({offsetX:0,offsetY:0}).setInBackground()}}},{key:"setEditingState",value:function(e){this._uiManager.setEditingState(e)}},{key:"addCommands",value:function(e){this._uiManager.addCommands(e)}},{key:"enable",value:function(){this.div.style.pointerEvents="auto";var e,n=_createForOfIteratorHelper(this._editors.values());try{for(n.s();!(e=n.n()).done;)e.value.enableEditing()}catch(o){n.e(o)}finally{n.f()}}},{key:"disable",value:function(){this.div.style.pointerEvents="none";var e,n=_createForOfIteratorHelper(this._editors.values());try{for(n.s();!(e=n.n()).done;)e.value.disableEditing()}catch(o){n.e(o)}finally{n.f()}}},{key:"setActiveEditor",value:function(e){this._uiManager.getActive()!==e&&this._uiManager.setActiveEditor(e)}},{key:"enableClick",value:function(){this.div.addEventListener("pointerdown",this._boundPointerdown),this.div.addEventListener("pointerup",this._boundPointerup)}},{key:"disableClick",value:function(){this.div.removeEventListener("pointerdown",this._boundPointerdown),this.div.removeEventListener("pointerup",this._boundPointerup)}},{key:"attach",value:function(e){this._editors.set(e.id,e)}},{key:"detach",value:function(e){this._editors.delete(e.id)}},{key:"remove",value:function(e){var n=this;this._uiManager.removeEditor(e),this.detach(e),this.annotationStorage.remove(e.id),e.div.style.display="none",setTimeout(function(){e.div.style.display="",e.div.remove(),e.isAttachedToDOM=!1,document.activeElement===document.body&&n._uiManager.focusMainContainer()},0),this._isCleaningUp||this.addInkEditorIfNeeded(!1)}},{key:"_changeParent",value:function(e){var n;e.parent!==this&&(this.attach(e),e.pageIndex=this.pageIndex,(n=e.parent)===null||n===void 0||n.detach(e),e.parent=this,e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}},{key:"add",value:function(e){if(this._changeParent(e),this._uiManager.addEditor(e),this.attach(e),!e.isAttachedToDOM){var n=e.render();this.div.append(n),e.isAttachedToDOM=!0}e.onceAdded(),this.addToAnnotationStorage(e)}},{key:"addToAnnotationStorage",value:function(e){e.isEmpty()||this.annotationStorage.has(e.id)||this.annotationStorage.setValue(e.id,e)}},{key:"updateAnnotationStorage",value:function(e){}},{key:"addOrRebuild",value:function(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}},{key:"addUndoableEditor",value:function(e){this.addOrRebuild(e)}},{key:"getNextId",value:function(){return this._uiManager.getId()}},{key:"_createNewEditor",value:function(e){switch(this._uiManager.getMode()){case AnnotationEditorType.FREETEXT:return new PDFAnnotationSticky(e);case AnnotationEditorType.INK:return new InkEditor(e)}return null}},{key:"deserialize",value:function(e){switch(e.annotationType){case AnnotationEditorType.FREETEXT:return PDFAnnotationSticky.deserialize(e,this);case AnnotationEditorType.INK:return InkEditor.deserialize(e,this)}return null}},{key:"_createAndAddNewEditor",value:function(e){var n=this.getNextId(),o=this._createNewEditor({parent:this,id:n,x:e.offsetX,y:e.offsetY});return o&&this.add(o),o}},{key:"setSelected",value:function(e){this._uiManager.setSelected(e)}},{key:"toggleSelected",value:function(e){this._uiManager.toggleSelected(e)}},{key:"isSelected",value:function(e){return this._uiManager.isSelected(e)}},{key:"unselect",value:function(e){this._uiManager.unselect(e)}},{key:"pointerup",value:function(e){var n=KeyboardManager.platform.isMac;e.button!==0||e.ctrlKey&&n||e.target===this.div&&this._hadPointerDown&&(this._hadPointerDown=!1,this._allowClick?this._createAndAddNewEditor(e):this._allowClick=!0)}},{key:"pointerdown",value:function(e){var n=KeyboardManager.platform.isMac;if(!(e.button!==0||e.ctrlKey&&n)&&e.target===this.div){this._hadPointerDown=!0;var o=this._uiManager.getActive();this._allowClick=!o||o.isEmpty()}}},{key:"drop",value:function(e){var n=e.dataTransfer.getData("text/plain"),o=this._uiManager.getEditor(n);if(o){e.preventDefault(),e.dataTransfer.dropEffect="move",this._changeParent(o);var r=this.div.getBoundingClientRect(),u=e.clientX-r.x,s=e.clientY-r.y;o.translate(u-o.startX,s-o.startY),o.div.focus()}}},{key:"dragover",value:function(e){e.preventDefault()}},{key:"_cleanup",value:function(){this._isCleaningUp=!0;var e,n=_createForOfIteratorHelper(this._editors.values());try{for(n.s();!(e=n.n()).done;){var o=e.value;o.isEmpty()&&o.remove()}}catch(r){n.e(r)}finally{n.f()}this._isCleaningUp=!1}},{key:"_removeAll",value:function(){this._isCleaningUp=!0;var e,n=_createForOfIteratorHelper(this._editors.values());try{for(n.s();!(e=n.n()).done;)e.value.remove()}catch(o){n.e(o)}finally{n.f()}this._isCleaningUp=!1}},{key:"render",value:function(e){if(!this._cancelled){var n=e.clone({dontFlip:!0});if(this.div)return this.update({viewport:n}),void this.show();this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div)}}},{key:"cancel",value:function(){this._cancelled=!0,this.destroy()}},{key:"hide",value:function(){this.div&&(this.div.hidden=!0)}},{key:"show",value:function(){this.div&&(this.div.hidden=!1)}},{key:"destroy",value:function(){var e;if(this.div){this.pageDiv=null,((e=this._uiManager.getActive())===null||e===void 0?void 0:e.parent)===this&&this._uiManager.setActiveEditor(null);var n,o=_createForOfIteratorHelper(this._editors.values());try{for(o.s();!(n=o.n()).done;){var r=n.value;r.isAttachedToDOM=!1,r.div.remove(),r.parent=null}}catch(u){o.e(u)}finally{o.f()}this.div.remove(),this.div=null,this._editors.clear(),this._uiManager.removeLayer(this)}}},{key:"removeAllAnnotations",value:function(){var e;((e=this._uiManager.getActive())===null||e===void 0?void 0:e.parent)===this&&this._uiManager.setActiveEditor(null);var n,o=_createForOfIteratorHelper(this._editors.values());try{for(o.s();!(n=o.n()).done;){var r=n.value;this.remove(r)}}catch(u){o.e(u)}finally{o.f()}}},{key:"update",value:function(e){this._uiManager.commitOrRemove(),this.viewport=e.viewport,this.setDimensions(),this.updateMode()}},{key:"scaleFactor",get:function(){return this.viewport.scale}},{key:"pageDimensions",get:function(){var e=_slicedToArray(this.viewport.viewBox,4),n=e[0],o=e[1];return[e[2]-n,e[3]-o]}},{key:"viewportBaseDimensions",get:function(){var e=this.viewport,n=e.width,o=e.height;return e.rotation%180==0?[n,o]:[o,n]}},{key:"setDimensions",value:function(){var e=this.viewport,n=e.width,o=e.height,r=e.rotation%180!=0,u=Math.floor(n)+"px",s=Math.floor(o)+"px";this.div.style.width=r?s:u,this.div.style.height=r?u:s}}])}(),BaseAnnotation=function(){return _createClass(function e(n){var o=n.annotation,r=n.documentViewer;_classCallCheck(this,e),o.name||(o.name=v4()),this.padding=5,this.isDelete=!1,this.documentViewer=r,this.annotation=o,this.replies=[],this.scrollTop=0,this.scrollLeft=0,this.ratio=window.devicePixelRatio||1,this.toggleAttrbutePanel=this.toggleAttrbutePanel.bind(this),this.deleteSvgStr=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path id="ic" fill-rule="evenodd" clip-rule="evenodd" d="M13 2.75V1.25H7V2.75H13ZM19 5.75V4.25H16.75H3.25H1V5.75H3.25V18.75H16.75V5.75H19ZM4.75 17.25V5.75H15.25V17.25H4.75ZM8.75 8.5V14.5H7.25V8.5H8.75ZM12.75 8.5V14.5H11.25V8.5H12.75Z" fill="currentColor"/>
    </svg>`,this.replySvgStr=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.8252 2.743H2.17484V17.4101C2.17484 17.4943 2.27256 17.5408 2.33791 17.4877L6.16578 14.3765H17.8252V2.743Z" stroke="currentColor" stroke-width="1.5"/>
        <path d="M5.00003 6.77402H14" stroke="currentColor" stroke-width="1.5"/>
        <path d="M5.00003 10.2973H11" stroke="currentColor" stroke-width="1.5"/>
      </svg>`,this.attrbuteSvgStr=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.54546 4.375L16.6666 4.375V5.625L8.54546 5.625C8.29821 6.2358 7.69939 6.66667 6.99994 6.66667C6.30049 6.66667 5.70167 6.2358 5.45442 5.625L3.33325 5.625L3.33325 4.375L5.45442 4.375C5.70167 3.7642 6.30049 3.33333 6.99994 3.33333C7.69939 3.33333 8.29821 3.7642 8.54546 4.375ZM3.33325 10.625L11.2877 10.625C11.5349 11.2358 12.1337 11.6667 12.8332 11.6667C13.5326 11.6667 14.1314 11.2358 14.3787 10.625H16.6666V9.375H14.3787C14.1314 8.7642 13.5326 8.33333 12.8332 8.33333C12.1337 8.33333 11.5349 8.7642 11.2877 9.375L3.33325 9.375L3.33325 10.625ZM5.45432 15.625H3.33325L3.33325 14.375H5.45432C5.70156 13.7642 6.30038 13.3333 6.99984 13.3333C7.69929 13.3333 8.29811 13.7642 8.54535 14.375L16.6666 14.375V15.625L8.54535 15.625C8.29811 16.2358 7.69929 16.6667 6.99984 16.6667C6.30038 16.6667 5.70156 16.2358 5.45432 15.625Z" fill="currentColor"/>
      </svg>`},[{key:"setCss",value:function(e,n){if(e&&n)for(var o in n)e.style[o]=n[o]}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAnnotAttrbutePanel")}},{key:"getWidth",value:function(){var e=this.getRect();return Math.abs(e.x2-e.x1)}},{key:"getHeight",value:function(){var e=this.getRect();return Math.abs(e.y2-e.y1)}},{key:"name",get:function(){return this.annotation.name}},{key:"arcPoints",get:function(){return this.annotation.arcPoints}},{key:"measure",get:function(){return this.annotation.measure}},{key:"dateCreated",get:function(){return this.annotation.date}},{key:"X",get:function(){return this.annotation.rect.left}},{key:"Y",get:function(){return this.annotation.rect.top}},{key:"getRect",value:function(){var e=this.annotation.rect;return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom}}},{key:"getPageNumber",value:function(){return this.PageNumber}},{key:"PageNumber",get:function(){return this.annotation.pageIndex+1}},{key:"PrePageNumber",get:function(){var e=this.annotation;return"prePageIndex"in e||(e.prePageIndex=e.pageIndex),this.annotation.prePageIndex+1}},{key:"layer",get:function(){var e=this.PageNumber,n=this.documentViewer.pdfViewer._pages[e-1];return n?n.compdfAnnotationLayer:null}},{key:"draw",value:function(){this.layer&&this.layer.div.append(this.annotationContainer)}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var e=this.annotation.dashes||"2,2",n=this.documentViewer.scale;return e.split(",").map(function(o){return Math.ceil(o*n)}).join(", ")}},{key:"getMouseLocation",value:function(e){var n=this.documentViewer.getScrollViewElement(),o=parseFloat(n.style.marginLeft)||0,r=n.scrollLeft-o||0,u=n.scrollTop||0;return{x:e.pageX+r,y:e.pageY+u}}},{key:"inReplyTo",get:function(){return this.annotation.inReplyTo}},{key:"addReply",value:function(e){this.replies.push(e)}},{key:"getReplies",value:function(){return this.replies}},{key:"isReply",value:function(){return!!this.inReplyTo}},{key:"deleteReplyAnnotation",value:function(e){this.replies.splice(this.replies.indexOf(e),1)}},{key:"getCustomData",value:function(e){return this.annotation.customData&&this.annotation.customData[e]||""}},{key:"setCustomData",value:function(e,n){!this.annotation.customData&&(this.annotation.customData={}),this.annotation.customData[e]=n,this.setAnnotationChanged({customData:JSON.stringify(this.annotation.customData)})}},{key:"deleteCustomData",value:function(e){var n=this.annotation.customData;n&&n[e]&&(delete n[e],this.setAnnotationChanged({customData:JSON.stringify(this.annotation.customData)}))}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"author",get:function(){return this.annotation.author},set:function(e){this.annotation.author=e,this.setAnnotationChanged({author:e})}},{key:"contents",get:function(){return this.annotation.contents},set:function(e){this.annotation.contents=e}},{key:"pagePtr",get:function(){return this.annotation.pagePtr}},{key:"annotPtr",get:function(){return this.annotation.annotPtr}},{key:"pageIndex",get:function(){return this.annotation.pageIndex}},{key:"getStatus",value:function(){var e=this.getReplies();if(!e)return"";for(var n="",o=0;o<e.length;o++){var r=e[o];r.stateModel!=="Marked"&&r.state&&(n=r.state)}return n}},{key:"getMarked",value:function(){var e=this.getReplies();if(!e)return"";for(var n="",o=0;o<e.length;o++){var r=e[o];r.stateModel==="Marked"&&r.state&&(n=r.state)}return n}},{key:"focus",value:function(){var e;this.shapeElement.classList.add("focus");var n=this.documentViewer.annotationManager;this.documentViewer.eventBus.dispatch("focus",this),n.focusedAnnotation&&n.focusedAnnotation===this||((e=n.focusedAnnotation)===null||e===void 0||e.shapeElement.classList.remove("focus"),n.focusedAnnotation=this,this.outSideListener=onClickOutside$1([this.annotationContainer],this.blur.bind(this)))}},{key:"blur",value:function(){this.shapeElement.classList.remove("focus");var e=this.documentViewer.annotationManager;e.focusedAnnotation&&e.focusedAnnotation===this&&(e.focusedAnnotation=null,this.documentViewer.eventBus.dispatch("blur",this)),this.outSideListener&&(document.removeEventListener(isMobileDevice$1?"touchstart":"mousedown",this.outSideListener),this.outSideListener=null)}}])}();function getClickPoint(e){var n=0,o=0;if(e.touches&&e.touches.length){var r=e.touches[0];n=r.pageX,o=r.pageY}else if(e.changedTouches){var u=e.changedTouches[0];n=u.pageX,o=u.pageY}else n=e.pageX,o=e.pageY;return{pageX:n,pageY:o}}function getAbsoluteCoordinate(e,n){var o=getClickPoint(n),r=o.pageX,u=o.pageY,s=e.getBoundingClientRect(),w=window.pageXOffset||window.scrollX||0,m=window.pageYOffset||window.scrollY||0;return{x:r-s.left-w,y:u-s.top-m,width:s.width-w,height:s.height-m}}function createSvg(e,n,o){var r=document.createElementNS("http://www.w3.org/2000/svg",e);if(n)for(var u in n)r.setAttribute(u,n[u]);if(o)for(var s in o)r.style[s]=o[s];return r}function getActualPoint$1(e,n){return{x:e.x*n,y:e.y*n}}function getInitialPoint$1(e,n){return{x:e.x/n,y:e.y/n}}var TO_FIXED_PRECISION=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function med(e,n){return[(e[0]+n[0])/2,(e[1]+n[1])/2]}function getSvgPathFromStroke(e){if(!e.length)return"";var n=e.length-1;return e.reduce(function(o,r,u,s){return u===n?o.push(r,med(r,s[0]),"L",s[0],"Z"):o.push(r,med(r,s[u+1])),o},["M",e[0],"Q"]).join(" ").replace(TO_FIXED_PRECISION,"$1")}var getHtmlToText=function(e){return formatText(replaceToBreak(getHtml(e)))},formatText=function(e){return e.replace(/\<br\/\>/gi,`
`).replace(/\<br\>/gi,`
`).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/<\/?[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")},getHtml=function(e){return e.innerHTML},replaceToBreak=function(e){return e=(e=(e=String(e).replace(/<\/div>/gi,"")).replace(/<div>(<br>)?(<br\/>)?/gi,`
`)).replace(/<br>|<br\/>/gi,`
`)},keepLastIndex=function(e){if(window.getSelection)(n=window.getSelection()).selectAllChildren(e),n.collapseToEnd();else if(document.selection){var n;(n=document.selection.createRange()).moveToElementText(e),n.collapse(!1),n.select()}},createElement=function(e,n,o){var r=document.createElement(e);if(o)for(var u in o)r.setAttribute(u,o[u]);if(n)for(var s in n)r.style[s]=n[s];return r},pastePlainText=function(e){e.preventDefault();var n=(e.originalEvent||e).clipboardData.getData("text");if(n){var o=window.getSelection();o.rangeCount&&(o.deleteFromDocument(),o.getRangeAt(0).insertNode(document.createTextNode(n)),o.collapseToEnd())}};function Zca(e){if(1>e.length)return!1;var n=Math.abs(e[e.length-1].y-e[0].y);return 12358e-8<Math.abs(e[e.length-1].x-e[0].x)||12358e-8<n}function Fza(e){if(!(3>e.length)){for(var n=e[0],o=0,r=1;r<e.length;r++){var u=e[r];o+=(u.x-n.x)*(u.y+n.y),n=u}return 0<=o?1:-1}}function tsa(e,n){return e.x*n.y-e.y*n.x}function lw(e){var n=Math.cos(e);return{m_a:n,m_b:-(e=Math.sin(e)),m_c:e,m_d:n,m_h:0,m_v:0}}function translate(e,n,o){return e.m_h+=n,e.m_v+=o,e}function Bap(e,n,o){return{x:n*e.m_a+o*e.m_c+e.m_h,y:n*e.m_b+o*e.m_d+e.m_v}}function mpa(e,n,o,r,u,s,w,m,v,g,d){0>u&&(u=-u),0>s&&(s=-s);var f=(e-g)/2,y=(n-d)/2,x=Math.cos(w),k=Math.sin(w),P=x*f+k*y,S=s*s,E=P*P,M=(f=-k*f+x*y)*f,T=E/(y=u*u)+M/S;if(1<T&&(y=(u*=Math.sqrt(T))*u,S=(s*=Math.sqrt(T))*s),T=y*M+S*E){if(y=(y*S-y*M-S*E)/T,m=(e+g)/2+(x*(S=u*f/s*(m=(m===v?-1:1)*Math.sqrt(0>y?0:y)))-k*(E=m*(-s*P/u))),x=(n+d)/2+(k*S+x*E),k=(P-S)/u,y=(f-E)/s,S=(-P-S)/u,f=(-f-E)/s,E=Math.sqrt(k*k+y*y),P=(0>y?-1:1)*Math.acos(k/E),E=Math.sqrt((k*k+y*y)*(S*S+f*f)),y=(0>k*f-y*S?-1:1)*Math.acos(Math.max(Math.min((k*S+y*f)/E,1),-1)),!v&&0<y?y-=2*Math.PI:v&&0>y&&(y+=2*Math.PI),f=[],k=!1,1e-9>Math.abs(y))v=4,k=!0,f[0]=u*Math.cos(P),f[1]=s*Math.sin(P),f[2]=u*Math.cos(P+y),f[3]=s*Math.sin(P+y);else{S=0,v=2,M=!1;do{0>y?(T=S,E=.5*-Math.PI,(S-=.5*Math.PI)<=y+.01&&(E=y-T,M=!0)):(T=S,E=.5*Math.PI,(S+=.5*Math.PI)>=y-.01&&(E=y-T,M=!0));var D=Math.cos(E/2),N=Math.sin(E/2),I=4*(1-D)/3,O=N-I*D/N,F=[];for((T=[])[0]=D,F[0]=-N,T[1]=D+I,F[1]=-O,T[2]=D+I,F[2]=O,T[3]=D,F[3]=N,D=Math.sin(P+E/2),N=Math.cos(P+E/2),I=0;4>I;I++)f[v-2+2*I]=u*(T[I]*N-F[I]*D),f[v-1+2*I]=s*(T[I]*D+F[I]*N);v+=6,P+=E}while(!M&&26>v)}for(translate(u=lw(-w),m,x),s=2;s<v-2;s+=2)w=f[s]===void 0?Bap(u,0,0):Bap(u,f[s],f[s+1]),f[s]=w.x,f[s+1]=w.y;if(f[0]=e,f[1]=n,2<v&&(f[v-2]=g,f[v-1]=d),k)r.push("l"),r.push("l"),o.push(f[0]),o.push(f[1]),o.push(f[2]),o.push(f[3]);else for(r.push("l"),o.push(f[0]),o.push(f[1]),e=2;e<v;e+=6)r.push("c"),o.push(f[e]),o.push(f[e+1]),o.push(f[e+2]),o.push(f[e+3]),o.push(f[e+4]),o.push(f[e+5])}}var paths="";function arcTo(e,n,o,r,u,s,w,m,v){var g=[],d=[];for(mpa(e,n,g,d,o,r,u,s,w,m,v),r=o=0;r<d.length;++r)d[r]==="c"?(paths+=" C"+g[o]+","+g[o+1]+" "+g[o+2]+","+g[o+3]+" "+g[o+4]+","+g[o+5],e=g[o+4],n=g[o+5],o+=6):(paths===""&&(paths+="M"+g[o]+","+g[o+1]),e=g[o],n=g[o+1],o+=2);return{yG:e,zG:n}}function cloneObject(e){for(var n=[],o=0;o<e.length;o++)n.push({x:e[o].x,y:e[o].y});return n}function drawPathWithArcs(e,n,o){var r=o===void 0?0<e.ur:o;if(n=cloneObject(n),!r&&Zca(n)&&(n[n.length]={x:n[0].x,y:n[0].y}),paths="",!(!r&&2>=n.length||r&&1>=n.length)){var u=parseInt(e.Intensity);u&&typeof u=="number"||(u=2);var s=1/8092,w=Fza(n);o=Math.round(w)!==1;var m=0,v=6.5*u,g=n[0],d=v,f=v,y={x:n[1].x-n[0].x,y:n[1].y-n[0].y},x={x:n[0].x-n[n.length-2].x,y:n[0].y-n[n.length-2].y};u=!0;for(var k,P,S,E=!1,M=0,T=0;T<n.length-1;++T){var D=n[T],N=n[T+1],I={x:N.x-D.x,y:N.y-D.y},O=Math.sqrt(I.x*I.x+I.y*I.y);if(!(O<=s)){N={x:I.x/O,y:I.y/O};var F=Math.max(Math.floor(O/v),1),q=O/F;if(m=Math.atan2(N.x,N.y),!r&&T===0&&3>=n.length){var Y=Math.sqrt(y.x*y.x+y.y*y.y);if(Y<v)return;if(Y<2*q)return void(k=Y/2)}r&&T===0&&(Y=.25*(d+q),arcTo(n[0].x-N.x*q*.5,n[0].y-N.y*q*.5,Y,Y,m,!1,o,n[0].x+N.x*q*.5,n[0].y+N.y*q*.5)),T===0&&(M=q,k={x:N.x,y:N.y}),D.x-=N.x*q*.5,D.y-=N.y*q*.5,Y=tsa(x,I);var _e=0;for(E||(++_e,f=q,u=0>Y*w,D.x+=N.x*q,D.y+=N.y*q,P=(g=D).x,S=g.y,E=!0),d=.25*(d+q);_e<F;++_e)D.x+=N.x*q,D.y+=N.y*q,P=(S=arcTo(P,S,d,d,m,_e===0&&0>Y*w,o,D.x,D.y)).yG,S=S.zG;x=I,d=q}}E||(P=g.x,S=g.y),k&&!r&&arcTo(P,S,e=.25*(f+d),e,m,u,o,n[n.length-1].x+.5*M*k.x,n[n.length-1].y+.5*M*k.y)}return paths}var _ArrowHelper_brand=new WeakSet,ArrowHelper=function(){return _createClass(function e(n,o){_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_ArrowHelper_brand),this.start=n,this.end=o},[{key:"getArrow",value:function(e,n,o){var r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],u=this.getArrowPoints(e,n,o,r);if(u){var s=_assertClassBrand(_ArrowHelper_brand,this,_isClosedType).call(this,e),w=document.createElementNS("http://www.w3.org/2000/svg",s?"polygon":"polyline"),m=u.map(function(v){return"".concat(v.x,",").concat(v.y)}).join(" ");return w.setAttribute("points",m),w}}},{key:"getArrowPoints",value:function(e,n,o){var r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],u=r?this.end:this.start,s=r?-1:1,w=_assertClassBrand(_ArrowHelper_brand,this,_getNormalize).call(this);switch(e){case"closedarrow":case"openarrow":return _assertClassBrand(_ArrowHelper_brand,this,_getTriangleArrowPoints).call(this,n,o,s,u,!1);case"rclosedarrow":case"ropenarrow":return _assertClassBrand(_ArrowHelper_brand,this,_getTriangleArrowPoints).call(this,n,o,s,u,!0);case"square":return _assertClassBrand(_ArrowHelper_brand,this,_getSquarePoints).call(this,o,s,u,w);case"circle":return _assertClassBrand(_ArrowHelper_brand,this,_getCirclePoints).call(this,o,u,w,s);case"diamond":return _assertClassBrand(_ArrowHelper_brand,this,_getDiamondPoints).call(this,o,s,u,w);case"butt":return _assertClassBrand(_ArrowHelper_brand,this,_getButtPoints).call(this,o,u,w);case"slash":return _assertClassBrand(_ArrowHelper_brand,this,_getSlashPoints).call(this,o,u,w,s);default:return}}}])}();function _getTriangleArrowPoints(e,n,o,r,u){var s=_assertClassBrand(_ArrowHelper_brand,this,_getNormalize).call(this);if(s&&!(n<=0)){var w={x:s.x*n*(u?-1:1),y:s.y*n*(u?-1:1)},m=function(f,y){return{x:f.x*Math.cos(y)-f.y*Math.sin(y),y:f.x*Math.sin(y)+f.y*Math.cos(y)}},v=e*Math.PI/180,g=m(w,v),d=m(w,-v);return[{x:r.x+o*g.x,y:r.y+o*g.y},r,{x:r.x+o*d.x,y:r.y+o*d.y}]}}function _getSquarePoints(e,n,o,r){var u=-r.y,s=r.x,w=e/2;return[{x:o.x+(r.x*w+u*w)*n,y:o.y+(r.y*w+s*w)*n},{x:o.x+(-r.x*w+u*w)*n,y:o.y+(-r.y*w+s*w)*n},{x:o.x+(-r.x*w-u*w)*n,y:o.y+(-r.y*w-s*w)*n},{x:o.x+(r.x*w-u*w)*n,y:o.y+(r.y*w-s*w)*n}]}function _getCirclePoints(e,n,o,r){for(var u=e/2,s=n.x+r*o.x*u,w=n.y+r*o.y*u,m=[],v=0;v<12;v++){var g=2*v*Math.PI/12,d=Math.cos(g)*u,f=Math.sin(g)*u,y=d*o.x-f*o.y,x=d*o.y+f*o.x;m.push({x:s+y,y:w+x})}return m}function _getDiamondPoints(e,n,o,r){var u=-r.y,s=r.x,w=e*Math.sqrt(2)/2;return[{x:o.x+r.x*w*n,y:o.y+r.y*w*n},{x:o.x+u*w*n,y:o.y+s*w*n},{x:o.x-r.x*w*n,y:o.y-r.y*w*n},{x:o.x-u*w*n,y:o.y-s*w*n}]}function _getButtPoints(e,n,o){var r=-o.y,u=o.x,s=e/2;return[{x:n.x+r*s,y:n.y+u*s},{x:n.x-r*s,y:n.y-u*s}]}function _getSlashPoints(e,n,o,r){var u=-45*r*Math.PI/180,s=o.x*Math.cos(u)-o.y*Math.sin(u),w=o.x*Math.sin(u)+o.y*Math.cos(u),m=e/2;return[{x:n.x-s*m,y:n.y-w*m},{x:n.x+s*m,y:n.y+w*m}]}function _isClosedType(e){return["closedarrow","rclosedarrow","square","circle","diamond"].includes(e)}function _getNormalize(){var e=_assertClassBrand(_ArrowHelper_brand,this,_getVector).call(this),n=_assertClassBrand(_ArrowHelper_brand,this,_getLineLength).call(this);return n>0?{x:e.x/n,y:e.y/n}:void 0}function _getVector(){return{x:this.end.x-this.start.x,y:this.end.y-this.start.y}}function _getLineLength(){var e=_assertClassBrand(_ArrowHelper_brand,this,_getVector).call(this);return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}var Line=function(e){function n(d){var f,y=d.annotation,x=d.documentViewer,k=d.show,P=k!==void 0&&k,S=d.enableReply,E=S===void 0||S;return _classCallCheck(this,n),(f=_callSuper(this,n,[{annotation:y,documentViewer:x}])).type="line",f.enableReply=E,f.hidden=!0,f.initial=!1,f.start=null,f.end=null,f.newStart=null,f.newEnd=null,f.svgElement=null,f.startCircle=null,f.middleCircle=null,f.endCircle=null,f.show=P,f.ratio=window.devicePixelRatio||1,f.decimalPlaces=0,f.isPopupShow=!1,f.onMousedown=f.handleMouseDown.bind(f),f.onMouseup=f.handleMouseUp.bind(f),f.onMousemove=f.handleMouseMove.bind(f),f.onDelete=f.handleDelete.bind(f),f.onOpenReply=f.openReply.bind(f),f.handlePropertyPanel=f.handlePropertyPanel.bind(f),f.onHandlePopup=f.handlePopup.bind(f),f.onKeydown=f.handleKeyDown.bind(f),f.annotation.measure?f.renderMeasure():f.render(),f}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var d=this,f=this.annotation,y=this.documentViewer.scale,x=this.getActualPoint(y),k=x.start,P=x.end;this.start=k,this.end=P;var S=this.annotation.borderWidth*y,E=this.calculate(k,P),M=Math.max(3*S,12*y);f.borderColor||(f.borderColor=f.color||"#FF0000");var T={left:E.left-M,top:E.top-M,width:E.width+2*M,height:E.height+2*M};if(T.width||T.height){this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.setAttribute("viewBox","".concat(T.left," ").concat(T.top," ").concat(T.width," ").concat(T.height));var D=this.getDashString(),N=createSvg("line",{mainLine:"",x1:this.start.x,y1:this.start.y,x2:this.end.x,y2:this.end.y,stroke:f.borderColor,"stroke-width":S,"stroke-opacity":f.opacity||1,"stroke-dasharray":f.borderStyle==="dashed"?D:""});if(this.selectionlineEle=createSvg("line",{x1:this.start.x,y1:this.start.y,x2:this.end.x,y2:this.end.y,stroke:f.borderColor,"stroke-width":S+8*y,"stroke-opacity":0}),this.lineEle=N,this.svgElement.append(N),this.svgElement.append(this.selectionlineEle),this.annotation.head||this.annotation.tail){var I=new ArrowHelper(this.start,this.end),O=[],F=["closedarrow","square","circle","diamond","rclosedarrow"];if(this.annotation.head&&this.annotation.head!=="none"){var q=I.getArrow(this.annotation.head,30,M,!1);q&&(q.setAttribute("head",""),q.setAttribute("fill",F.includes(this.annotation.head)?f.borderColor:"none"),O.push(q))}if(this.annotation.tail&&this.annotation.tail!=="none"){var Y=I.getArrow(this.annotation.tail,30,M);Y&&(Y.setAttribute("tail",""),Y.setAttribute("fill",F.includes(this.annotation.tail)?f.borderColor:"none"),O.push(Y))}O.forEach(function(ne){ne&&(ne.setAttribute("stroke",f.borderColor),ne.setAttribute("stroke-width",S),ne.setAttribute("stroke-opacity",f.opacity||1),ne.setAttribute("stroke-dasharray",f.borderStyle==="dashed"?D:""),d.svgElement.append(ne))})}this.annotationContainer=document.createElement("div"),this.annotationContainer.append(this.svgElement),this.annotationContainer.id=f.name,this.annotationContainer.className="annotation",this.annotationContainer.style.top=T.top+"px",this.annotationContainer.style.left=T.left+"px",this.annotationContainer.style.width=T.width+"px",this.annotationContainer.style.height=T.height+"px",this.svgElement.addEventListener("mousedown",this.handleClick.bind(this)),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:T.left+T.width-114+"px",top:T.top+T.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px",borderRadius:"2px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr;var _e=document.createElementNS("http://www.w3.org/2000/svg","svg");_e.setAttribute("data-id","move"),_e.setAttribute("height",T.height),_e.setAttribute("viewBox","".concat(T.left," ").concat(T.top," ").concat(T.width+2*MARGIN_DISTANCE," ").concat(T.height+2*MARGIN_DISTANCE)),_e.style.position="absolute",_e.style.zIndex=1,_e.style.left="".concat(T.left-MARGIN_DISTANCE,"px"),_e.style.top="".concat(T.top-MARGIN_DISTANCE,"px"),_e.style.width="".concat(T.width+2*MARGIN_DISTANCE,"px"),_e.style.height="".concat(T.height+2*MARGIN_DISTANCE,"px"),this.outerLine=_e,this.startCircle=createSvg("circle",{class:"start","data-id":"start",fill:"#1460F3",cx:k.x+MARGIN_DISTANCE,cy:k.y+MARGIN_DISTANCE,r:6}),this.endCircle=createSvg("circle",{class:"end","data-id":"end",fill:"#1460F3",cx:P.x+MARGIN_DISTANCE,cy:P.y+MARGIN_DISTANCE,r:6}),this.moveLine=createSvg("line",{class:"move","data-id":"move",x1:k.x+MARGIN_DISTANCE,y1:k.y+MARGIN_DISTANCE,x2:P.x+MARGIN_DISTANCE,y2:P.y+MARGIN_DISTANCE,fill:"transparent",stroke:"transparent","stroke-width":5}),this.outerLine.append(this.moveLine),this.outerLine.append(this.startCircle),this.outerLine.append(this.endCircle),this.outerLineContainer.append(this.outerLine),this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1}}},{key:"renderMeasure",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee=this;return _regeneratorRuntime().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:if(y=this.annotation,x=this.documentViewer.scale,k=this.getActualPoint(x),P=k.start,S=k.end,this.start=P,this.end=S,y.precision&&(y.precision>1&&(y.precision=Math.pow(10,-Math.floor(Math.log10(y.precision)))),this.decimalPlaces=((E=Math.abs(y.precision).toString().split(".")[1])===null||E===void 0?void 0:E.length)||0),y.borderColor||(y.borderColor=y.color||"#FF0000"),y.factor){Be.next=11;break}return Be.next=10,this.documentViewer.messageHandler.sendWithPromise("GetFactor",y.rulerPtr);case 10:y.factor=Be.sent;case 11:if(y.X||(M=this.getInitialPoint(),y.X=(Math.abs(M.end.x-M.start.x)*y.factor).toFixed(this.decimalPlaces)),y.Y||(T=this.getInitialPoint(),y.Y=(Math.abs(T.end.y-T.start.y)*y.factor).toFixed(this.decimalPlaces)),y.angle||(D=Math.atan2(P.y-S.y,S.x-P.x)/Math.PI*180,y.angle=Math.round(D)),y.fontStyle||(y.fontStyle="regular"),y.length&&(y.length=this.formatValue(y.length)),y.contents||this.getResult(),N=y.leadLength*x,I=y.leadExtension*x,O=S.x-P.x,F=S.y-P.y,q=Math.sqrt(O*O+F*F),ne=-(_e=F/q),ve=Y=O/q,J={x:P.x+ne*N,y:P.y+ve*N},fe={x:S.x+ne*N,y:S.y+ve*N},Z={x:P.x-ne*I,y:P.y-ve*I},j={x:S.x-ne*I,y:S.y-ve*I},X=this.maxRect([J,fe,Z,j]),H=this.annotation.borderWidth*x,U=Math.max(3*H,10*x),(te={left:X.left-U,top:X.top-U,width:X.width+2*U,height:X.height+2*U}).width||te.height){Be.next=36;break}return Be.abrupt("return");case 36:this.rect=te,this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.setAttribute("viewBox","".concat(te.left," ").concat(te.top," ").concat(te.width," ").concat(te.height)),this.svgElement.style.pointerEvents="all",this.svgElement.style.overflow="visible",y.opacity&&(this.svgElement.style.opacity=y.opacity),Q={x:(P.x+S.x)/2,y:(P.y+S.y)/2},re=Math.atan2(S.y-P.y,S.x-P.x)/Math.PI*180,Pe=Math.abs(re)>90?re-180:re,this.textEle=createSvg("text",{fill:y.color||y.borderColor,"text-anchor":"middle","dominant-baseline":"middle",x:Q.x,y:Q.y,transform:"rotate(".concat(Pe," ").concat(Q.x," ").concat(Q.y,")")},{"font-size":"calc(var(--scale-factor) * ".concat(y.fontSize,"px)"),pointerEvents:"none"}),this.textEle.textContent=y.contents,this.svgElement.append(this.textEle),be=this.getTextWidth(),we={x:P.x+Y*(q/2-be/2),y:P.y+_e*(q/2-be/2)},Ae={x:P.x+Y*(q/2+be/2),y:P.y+_e*(q/2+be/2)},$e=this.getDashString(),[{startLine:"",x1:P.x,y1:P.y,x2:we.x,y2:we.y,"stroke-dasharray":y.borderStyle==="dashed"?$e:""},{endLine:"",x1:Ae.x,y1:Ae.y,x2:S.x,y2:S.y,"stroke-dasharray":y.borderStyle==="dashed"?$e:""},{startLead:"",x1:P.x,y1:P.y,x2:J.x,y2:J.y},{endLead:"",x1:S.x,y1:S.y,x2:fe.x,y2:fe.y},{startLeadExtension:"",x1:P.x,y1:P.y,x2:Z.x,y2:Z.y},{endLeadExtension:"",x1:S.x,y1:S.y,x2:j.x,y2:j.y}].forEach(function(Ve){var Oe=createSvg("line",_objectSpread2$1(_objectSpread2$1({},Ve),{},{stroke:y.borderColor,"stroke-width":H}),{"stroke-linecap":"butt"});Ee.svgElement.append(Oe)}),(this.annotation.head||this.annotation.tail)&&(Me=new ArrowHelper(this.start,this.end),Ie=[],Le=["closedarrow","square","circle","diamond","rclosedarrow"],this.annotation.head&&this.annotation.head!=="none"&&(le=Me.getArrow(this.annotation.head,45,U,!1))&&(le.setAttribute("head",""),le.setAttribute("fill",Le.includes(this.annotation.head)?y.borderColor:"none"),Ie.push(le)),this.annotation.tail&&this.annotation.tail!=="none"&&(oe=Me.getArrow(this.annotation.tail,45,U))&&(oe.setAttribute("tail",""),oe.setAttribute("fill",Le.includes(this.annotation.tail)?y.borderColor:"none"),Ie.push(oe)),Ie.forEach(function(Ve){Ve&&(Ve.setAttribute("stroke",y.borderColor),Ve.setAttribute("stroke-width",H),Ve.setAttribute("stroke-dasharray",y.borderStyle==="dashed"?$e:""),Ee.svgElement.append(Ve))})),this.annotationContainer=document.createElement("div"),this.annotationContainer.append(this.svgElement),this.annotationContainer.id=y.name,this.annotationContainer.className="annotation",this.annotationContainer.style.top=te.top+"px",this.annotationContainer.style.left=te.left+"px",this.annotationContainer.style.width=te.width+"px",this.annotationContainer.style.height=te.height+"px",this.svgElement.addEventListener("mousedown",this.handleClick.bind(this)),(f=this.layer)===null||f===void 0||f.div.append(this.annotationContainer),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",(ke=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("data-id","move"),ke.setAttribute("width",te.width),ke.setAttribute("height",te.height),ke.setAttribute("viewBox","".concat(te.left," ").concat(te.top," ").concat(te.width," ").concat(te.height)),ke.style.position="absolute",ke.style.zIndex=1,ke.style.left="".concat(te.left,"px"),ke.style.top="".concat(te.top,"px"),ke.style.width="".concat(te.width,"px"),ke.style.height="".concat(te.height,"px"),ke.style.border="".concat(parseFloat(x.toFixed(1)),"px dashed #1460F3"),ke.style.boxSizing="content-box",ke.style.pointerEvents="all",ke.style.cursor="all-scroll",this.outerLine=ke,Ce=this.annotation.leadLength>this.annotation.leadExtension,this.startCircle=createSvg("circle",{class:"start","data-id":"start",fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:Ce?J.x:Z.x,cy:Ce?J.y:Z.y,r:6},{cursor:"default"}),this.middleCircle=createSvg("circle",{class:"middle","data-id":"middle",fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:Q.x,cy:Q.y,r:6},{cursor:"default"}),this.endCircle=createSvg("circle",{class:"end","data-id":"end",fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:Ce?fe.x:j.x,cy:Ce?fe.y:j.y,r:6},{cursor:"default"}),this.moveLine=createSvg("line",{class:"move","data-id":"move",x1:P.x,y1:P.y,x2:S.x,y2:S.y,fill:"transparent",stroke:"transparent","stroke-width":5}),this.outerLine.append(this.moveLine),this.outerLine.append(this.startCircle),this.outerLine.append(this.middleCircle),this.outerLine.append(this.endCircle),this.outerLineContainer.append(this.outerLine),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 96:case"end":return Be.stop()}},d,this)})),function(){return g.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleClick",value:function(d){var f,y,x,k=this.documentViewer.scale,P=this.annotation.borderWidth*k,S=Math.max(3*P,12*k),E=this.calculate(this.start,this.end),M=E.left-S,T=(E.top,E.width+2*S);if(E.height,this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((y=this.layer)===null||y===void 0||y.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:M+T-114+"px"})):((x=this.layer)===null||x===void 0||x.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:M+T-46+"px"})),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes((f=this.layer)===null||f===void 0?void 0:f.tool)&&!document.querySelector(".compare-document-container").contains(d==null?void 0:d.target)){this.hidden=!1,this.updateTool(),this.annotation.measure?(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel),document.addEventListener("keydown",this.onKeydown);var D=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.popupElement&&D.push(this.popupElement);var N=document.getElementById(this.annotation.measure?"measurePropertyPanelButton":"annotationPropertyPanelButton");N&&D.push(N);var I=document.querySelector(".toggle-button");I&&D.push(I),onClickOutside$1(D,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var d,f,y,x,k=this.documentViewer.annotationStore.selectedElementName,P=this.annotation.name;!this.hidden&&this.annotation.measure&&k===P&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(x=this.documentViewer)===null||x===void 0||(x=x.pdfViewer)===null||x===void 0||(x=x.measurementTool)===null||x===void 0||x.updateMeasurePanel(),this.hidePopup()),this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("mousedown",this.onMousedown),(f=this.outerLine)===null||f===void 0||f.removeEventListener("touchstart",this.onMousedown),(y=this.outerLineContainer)===null||y===void 0||y.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure?(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"getActualPoint",value:function(d){var f=this.annotation;!f.linePoints&&f.start&&f.end&&(f.linePoints=f.start+","+f.end);var y=_slicedToArray(f.linePoints,4);return{start:{x:y[0]*d,y:y[1]*d},end:{x:y[2]*d,y:y[3]*d}}}},{key:"getInitialPoint",value:function(){var d=this.documentViewer.scale;return{start:{x:this.start.x/d,y:this.start.y/d},end:{x:this.end.x/d,y:this.end.y/d}}}},{key:"calculate",value:function(d,f){var y=this.rectCalc({start:d,end:f}),x=this.annotation.borderWidth*this.documentViewer.scale;return this.annotation.arrow?{top:y.top-10,left:y.left-10,width:y.width+20,height:y.height+20}:{top:y.top-x/2,left:y.left-x/2,width:y.width+x,height:y.height+x}}},{key:"rectCalc",value:function(d){var f=d.start,y=d.end;return{top:f.y<y.y?f.y:y.y,left:f.x<y.x?f.x:y.x,width:Math.abs(y.x-f.x),height:Math.abs(y.y-f.y)}}},{key:"maxRect",value:function(d){var f=Math.min(d[0].x,d[1].x,d[2].x,d[3].x),y=Math.min(d[0].y,d[1].y,d[2].y,d[3].y);return{left:f,top:y,width:Math.max(d[0].x,d[1].x,d[2].x,d[3].x)-f,height:Math.max(d[0].y,d[1].y,d[2].y,d[3].y)-y}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var d;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var f=this.annotation;this.documentViewer.annotationStore.selectedElementName=f.name;var y=_objectSpread2$1({},f);delete y.annotPtr,delete y.pagePtr,delete y.operate,delete y.targetPage,delete y.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",y)}(d=this.layer)===null||d===void 0||d.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.length,angle:this.annotation.angle,X:this.annotation.X,Y:this.annotation.Y}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var d=this.documentViewer.scale,f=this.getActualPoint(d),y=f.start,x=f.end;this.start=y,this.end=x,this.update({start:y,end:x},!1)}}},{key:"handleMouseDown",value:function(d){var f;if(d.button===0||d.type!=="mousedown"){(f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation();var y=d.target.getAttribute("data-id"),x=this.documentViewer.getScrollViewElement();this.scrollTop=x.scrollTop,this.scrollLeft=x.scrollLeft;var k=getClickPoint(d),P=k.pageX,S=k.pageY;this.startState={operator:y,clickX:P,clickY:S},this.initialPoints={start:this.start,end:this.end},this.initLeadLength=this.annotation.leadLength,this.initLeadExtension=this.annotation.leadExtension,this.hasUpdatedInitialRect=!1,document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(d){var f=this;if(d.button===0||d.type!=="mousemove"){this.hidePopup(),d.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var y=getClickPoint(d),x=y.pageX,k=y.pageY,P=this.documentViewer,S=P.getScrollViewElement(),E=S.scrollTop;x=x+S.scrollLeft-this.scrollLeft,k=k+E-this.scrollTop;var M=this.start,T=this.end,D=this.startState,N=P.scale,I=P.getPageWidth(this.PageNumber)*N,O=P.getPageHeight(this.PageNumber)*N,F=function(He,Fe,ze,We){var Ue=f.annotation.leadLength*N,et=f.annotation.leadExtension*N,it=ze-He,nt=We-Fe,dt=Math.sqrt(it*it+nt*nt),xt=it/dt,yt=-(nt/dt),Bt={x:He+yt*Ue,y:Fe+xt*Ue},Pt={x:ze+yt*Ue,y:We+xt*Ue},Tt={x:He-yt*et,y:Fe-xt*et},ct={x:ze-yt*et,y:We-xt*et},wt={width:Math.abs(M.x-T.x),height:Math.abs(M.y-T.y)},St=Math.min(Bt.x,Pt.x,Tt.x,ct.x),Ft=Math.max(Bt.x,Pt.x,Tt.x,ct.x),Gt=Math.min(Bt.y,Pt.y,Tt.y,ct.y),jt=Math.max(Bt.y,Pt.y,Tt.y,ct.y),Ut=St<0||Ft>I,Jt=Gt<0||jt>O,un=0,nn=0;if(Ut||Jt){var Zt=[M.x,T.x,M.y,T.y];He=Zt[0],ze=Zt[1],Fe=Zt[2],We=Zt[3],un=Ut?St<0?-St:I-Ft:0,nn=Jt?Gt<0?-Gt:O-jt:0}else He<ze?(He=Math.max(0,He),He=Math.min(I-wt.width,He),ze=Math.max(wt.width,ze),ze=Math.min(I,ze)):(ze=Math.max(0,ze),ze=Math.min(I-wt.width,ze),He=Math.max(wt.width,He),He=Math.min(I,He)),Fe<We?(Fe=Math.max(0,Fe),Fe=Math.min(O-wt.height,Fe),We=Math.max(wt.height,We),We=Math.min(O,We)):(We=Math.max(0,We),We=Math.min(O-wt.height,We),Fe=Math.max(wt.height,Fe),Fe=Math.min(O,Fe));return{x1:He,x2:ze,y1:Fe,y2:We,outOfBoundsX:un,outOfBoundsY:nn}},q=this.PageNumber;if(D.operator==="start"){var Y=x-(D.clickX-this.start.x),_e=k-(D.clickY-this.start.y);Y=Math.min(I,Y),Y=Math.max(0,Y),_e=Math.min(O,_e);var ne=F(Y,_e=Math.max(0,_e),T.x,T.y);Y=ne.x1,_e=ne.y1,this.update({start:{x:Y,y:_e},end:T},!1)}else if(D.operator==="middle"){x+=this.scrollLeft,k+=this.scrollTop;var ve,J,fe,Z=this.documentViewer.windowToPage({x,y:k},q,!1),j={x:(M.x+T.x)/2,y:(M.y+T.y)/2},X={x:T.x-M.x,y:T.y-M.y},H={x:-X.y,y:X.x},U={x:Z.x-j.x,y:Z.y-j.y},te=(U.x*H.x+U.y*H.y)/(H.x*H.x+H.y*H.y),Q=M.x+te*H.x,re=M.y+te*H.y,Pe=T.x+te*H.x,be=T.y+te*H.y;if(Q=Math.max(0,Math.min(I,Q)),re=Math.max(0,Math.min(O,re)),Pe=Math.max(0,Math.min(I,Pe)),be=Math.max(0,Math.min(O,be)),Q===0||Q===I||re===0||re===O||Pe===0||Pe===I||be===0||be===O)return;var we=function(He,Fe,ze,We){var Ue=(f.initialPoints.start.x+f.initialPoints.end.x)/2,et=(f.initialPoints.start.y+f.initialPoints.end.y)/2;ve=(He+ze)/2-Ue,J=(Fe+We)/2-et,fe=Math.sqrt(ve*ve+J*J)/f.documentViewer.scale};we(Q,re,Pe,be);var Ae=function(){var He=f.svgElement.querySelector("[startLead]"),Fe=f.svgElement.querySelector("[startLeadExtension]"),ze={x:He.getAttribute("x2"),y:He.getAttribute("y2")},We={x:Fe.getAttribute("x2"),y:Fe.getAttribute("y2")},Ue=function(Bt,Pt){return{x:Pt.x-Bt.x,y:Pt.y-Bt.y}},et=function(Bt,Pt){return Bt.x*Pt.x+Bt.y*Pt.y},it=Ue(f.initialPoints.start,ze),nt=Ue(f.initialPoints.start,We),dt=Ue(f.initialPoints.start,{x:Q,y:re}),xt=et(dt,it),yt=et(dt,nt);return xt>yt?"toLead":yt>xt?"toExtension":void 0}();Ae||(Ae=ve>0?"toExtension":ve<0||J<0?"toLead":"toExtension"),Ae==="toExtension"?(this.annotation.leadExtension<=.1&&(this.initLeadExtension===.1||this.annotation.leadExtension!==.1||this.hasUpdatedInitialRect||(this.initialPoints={start:{x:Q,y:re},end:{x:Pe,y:be}},this.hasUpdatedInitialRect=!0,we(Q,re,Pe,be)),this.annotation.leadLength=Math.max(this.initLeadLength+fe,.1),this.initLeadExtension=.1),this.annotation.leadExtension=Math.max(this.initLeadExtension-fe,.1)):Ae==="toLead"&&(this.annotation.leadLength<=.1&&(this.initLeadLength===.1||this.annotation.leadLength!==.1||this.hasUpdatedInitialRect||(this.initialPoints={start:{x:Q,y:re},end:{x:Pe,y:be}},this.hasUpdatedInitialRect=!0,we(Q,re,Pe,be)),this.annotation.leadExtension=Math.max(this.initLeadExtension+fe,.1),this.initLeadLength=.1),this.annotation.leadLength=Math.max(this.initLeadLength-fe,.1)),this.update({start:{x:Q,y:re},end:{x:Pe,y:be}},!1)}else if(D.operator==="end"){var $e=x-(D.clickX-this.end.x),Me=k-(D.clickY-this.end.y);$e=Math.min(I,$e),$e=Math.max(0,$e),Me=Math.min(O,Me),Me=Math.max(0,Me);var Ie=F(M.x,M.y,$e,Me);$e=Ie.x2,Me=Ie.y2,this.update({start:M,end:{x:$e,y:Me}},!1)}else if(D.operator==="move"){var Le,le,oe,ke,Ce=this.documentViewer,Ee=this.getMouseLocation(d),Be=Ce.getSelectedPage(Ee,Ee);if(Be.first&&Be.first!==q){var Ve,Oe=Ce.windowToPage(Ee,Be.first,!1),je=Math.abs(M.x-T.x),Ge=Math.abs(M.y-T.y);if(Ce.pdfViewer.spreadMode===0&&Ce.pdfViewer.scrollMode===0){if(Le=x-(D.clickX-this.start.x),le=Be.first>q?Oe.y:Oe.y-Ge,oe=x-(D.clickX-this.end.x),ke=Be.first>q?Oe.y+Ge:Oe.y,this.annotation.angle>0){var Xe=ke;ke=le,le=Xe}}else if(Ce.pdfViewer.spreadMode===0&&Ce.pdfViewer.scrollMode===1){if(Le=Be.first>q?Oe.x:Oe.x-je,le=k-(D.clickY-this.start.y),oe=Be.first>q?Oe.x+je:Oe.x,ke=k-(D.clickY-this.end.y),this.annotation.angle<-90||this.annotation.angle>90){var qe=oe;oe=Le,Le=qe}}else if(Ce.pdfViewer.spreadMode===1&&Ce.pdfViewer.scrollMode===0){var Ke=Math.min(Be.first,q),Je=Math.max(Be.first,q);if(Je-Ke>2||Ke+1===Je&&Ke%2==0)return;if(Ke+1===Je?(Le=Be.first>q?Oe.x:Oe.x-je,le=k-(D.clickY-this.start.y),oe=Be.first>q?Oe.x+je:Oe.x,ke=k-(D.clickY-this.end.y)):Ke+2===Je&&(Le=x-(D.clickX-this.start.x),le=Be.first>q?Oe.y:Oe.y-Ge,oe=x-(D.clickX-this.end.x),ke=Be.first>q?Oe.y+Ge:Oe.y),this.annotation.angle<-90||this.annotation.angle>90){var rt=oe;oe=Le,Le=rt}}else if(Ce.pdfViewer.spreadMode===2&&Ce.pdfViewer.scrollMode===0){var ht=Math.min(Be.first,q),vt=Math.max(Be.first,q);if(vt-ht>2||ht+1===vt&&(ht!==1||vt!==2)&&vt%2==0||ht===1&&vt===3)return;if(ht+2===vt||ht===1&&vt===2){if(Le=x-(D.clickX-this.start.x),le=Be.first>q?Oe.y:Oe.y-Ge,oe=x-(D.clickX-this.end.x),ke=Be.first>q?Oe.y+Ge:Oe.y,this.annotation.angle>0){var Ct=ke;ke=le,le=Ct}}else if(ht+1===vt&&(Le=Be.first>q?Oe.x:Oe.x-je,le=k-(D.clickY-this.start.y),oe=Be.first>q?Oe.x+je:Oe.x,ke=k-(D.clickY-this.end.y),this.annotation.angle<-90||this.annotation.angle>90)){var kt=oe;oe=Le,Le=kt}}var mt=F(Le,le,oe,ke),Vt=mt.outOfBoundsX,bt=mt.outOfBoundsY;if(Le+=Vt,le+=bt,oe+=Vt,ke+=bt,!Ce.pdfViewer._pages[Be.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=Be.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var ot=(Ve=this.layer)===null||Ve===void 0?void 0:Ve.div;ot==null||ot.append(this.annotationContainer),ot==null||ot.append(this.outerLineContainer)}else{Le=x-(D.clickX-this.start.x),le=k-(D.clickY-this.start.y),oe=x-(D.clickX-this.end.x),ke=k-(D.clickY-this.end.y);var gt=Ce.pageToWindow({x:Le,y:le},q,!1),tt=Ce.pageToWindow({x:oe,y:ke},q,!1),ut=0,Re=0;k>D.clickY?Re=(Re=S.offsetHeight-(tt.y-S.scrollTop-S.offsetTop))<100?5:0:k<D.clickY&&(Re=(Re=gt.y-S.scrollTop-S.offsetTop)<100?-5:0),x>D.clickX?ut=(ut=S.offsetWidth-(tt.x-S.scrollLeft-S.offsetLeft))<100?5:0:x<D.clickX&&(ut=(ut=gt.x-S.scrollLeft-S.offsetLeft)<100?-5:0),(ut||Re)&&(S.scrollTop+=Re,S.scrollLeft+=ut);var Te=F(Le,le,oe,ke);Le=Te.x1,le=Te.y1,oe=Te.x2,ke=Te.y2}this.update({start:{x:Le,y:le},end:{x:oe,y:ke}},!1)}D.clickX=x,D.clickY=k}}},{key:"handleDelete",value:function(d){this.layer&&this.layer.tool&&d&&d.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var d,f;this.handleOutside(),(d=this.annotationContainer)===null||d===void 0||d.remove(),this.annotation.isDelete=!0,this.annotation.name&&((f=this.layer)===null||f===void 0||f.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e;return _regeneratorRuntime().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(f.button===0||f.type!=="mouseup"){ne.next=2;break}return ne.abrupt("return");case 2:if((y=this.layer)!==null&&y!==void 0&&y.tool&&f.stopPropagation(),f.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.startState&&this.update({start:this.start,end:this.end}),this.moving=!1,this.initialPoints=null,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,x=this.annotation,k=this.getInitialPoint(),P=k.start,S=k.end,E=[P.x,P.y,S.x,S.y],x.linePoints=E,M=Math.min(P.x,S.x),T=Math.min(P.y,S.y),D=Math.max(P.x,S.x),N=Math.max(P.y,S.y),I={left:M-6,top:T-6,right:D+6,bottom:N+6},x.rect=I,x.measure&&this.documentViewer.annotationStore.selectedElementName===x.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){ne.next=53;break}if(O={type:"delete",annotation:{operate:"del-annot",name:x.name,pageIndex:x.pageIndex,annotPtr:x.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",O),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(F=Object.assign({},x)).annotPtr,delete F.pagePtr,delete F.name,F.operate="add-annot",F.pageIndex=this.PageNumber-1,!this.annotation.measure){ne.next=41;break}return ne.next=38,this.documentViewer.annotationManager.createMeasurementAnnotation(F);case 38:q=ne.sent,ne.next=44;break;case 41:return ne.next=43,this.documentViewer.annotationManager.createAnnotation(F);case 43:q=ne.sent;case 44:return Y=new n({annotation:q,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),this.documentViewer.annotationManager.addAnnotation(Y),ne.next=49,this.documentViewer.annotationManager.drawAnnotationsFromList(Y);case 49:this.annotationContainer.remove(),this.outerLineContainer.remove(),ne.next=61;break;case 53:if(_e={operate:"mod-annot",name:x.name,pageIndex:this.PageNumber-1,pagePtr:x.pagePtr,annotPtr:x.annotPtr,linePoints:E,rect:I},!this.annotation.measure){ne.next=59;break}return ne.next=57,this.documentViewer.annotationManager.editMeasurementAnnotation(_e);case 57:ne.next=60;break;case 59:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_e});case 60:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 61:case"end":return ne.stop()}},d,this)})),function(d){return v.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"update",value:function(d){var f=this,y=d.start,x=d.end,k=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.start=y,this.end=x,this.annotation.measure&&this.updateMeasure(k);var P,S,E,M,T,D,N,I=this.documentViewer.scale,O=this.annotation.borderWidth*I,F=Math.max(3*O,10*I);if(this.annotation.measure){var q=this.annotation.leadLength*I,Y=this.annotation.leadExtension*I,_e=x.x-y.x,ne=x.y-y.y,ve=Math.sqrt(_e*_e+ne*ne),J=_e/ve,fe=ne/ve,Z=-fe,j=J,X=this.getTextWidth();S={x:y.x+Z*q,y:y.y+j*q},E={x:x.x+Z*q,y:x.y+j*q},M={x:y.x-Z*Y,y:y.y-j*Y},T={x:x.x-Z*Y,y:x.y-j*Y},D={x:y.x+J*(ve/2-X/2),y:y.y+fe*(ve/2-X/2)},N={x:y.x+J*(ve/2+X/2),y:y.y+fe*(ve/2+X/2)};var H=this.maxRect([S,E,M,T]);P={left:H.left-F,top:H.top-F,width:H.width+2*F,height:H.height+2*F}}else{var U=this.calculate(y,x);P={left:U.left-F,top:U.top-F,width:U.width+2*F,height:U.height+2*F}}(this.annotation.measure?["startLine","endLine","startLead","endLead","startLeadExtension","endLeadExtension","head","tail"]:["mainLine","head","tail"]).forEach(function(Je){var rt=f.svgElement.querySelector("[".concat(Je,"]"));rt&&rt.setAttribute("stroke-width",O)}),this.rect=P;var te=this.rect;this.svgElement.setAttribute("width",te.width),this.svgElement.setAttribute("height",te.height),this.svgElement.setAttribute("viewBox","".concat(te.left," ").concat(te.top," ").concat(te.width," ").concat(te.height));var Q=this.svgElement.querySelector("[mainLine]");Q&&(Q.setAttribute("x1",y.x),Q.setAttribute("y1",y.y),Q.setAttribute("x2",x.x),Q.setAttribute("y2",x.y),this.selectionlineEle.setAttribute("x1",y.x),this.selectionlineEle.setAttribute("y1",y.y),this.selectionlineEle.setAttribute("x2",x.x),this.selectionlineEle.setAttribute("y2",x.y)),this.annotationContainer.style.top=te.top+"px",this.annotationContainer.style.left=te.left+"px",this.annotationContainer.style.width=te.width+"px",this.annotationContainer.style.height=te.height+"px";var re=this.annotation.measure?0:MARGIN_DISTANCE;if(this.outerLine.setAttribute("height",te.height),this.outerLine.setAttribute("viewBox","".concat(te.left," ").concat(te.top," ").concat(te.width+2*re," ").concat(te.height+2*re)),this.outerLine.style.left="".concat(te.left-re,"px"),this.outerLine.style.top="".concat(te.top-re,"px"),this.outerLine.style.width="".concat(te.width+2*re,"px"),this.outerLine.style.height="".concat(te.height+2*re,"px"),this.popupElement&&(this.popupElement.style.left=te.left+te.width-114+"px"),this.popupElement&&(this.popupElement.style.top=te.top+te.height+12+"px"),this.annotation.measure){var Pe=this.annotation.leadLength>this.annotation.leadExtension;this.startCircle.setAttribute("cx",Pe?S.x:M.x),this.startCircle.setAttribute("cy",Pe?S.y:M.y),this.endCircle.setAttribute("cx",Pe?E.x:T.x),this.endCircle.setAttribute("cy",Pe?E.y:T.y);var be=this.svgElement.querySelector("[startLine]"),we=this.svgElement.querySelector("[endLine]"),Ae=this.svgElement.querySelector("[startLead]"),$e=this.svgElement.querySelector("[endLead]"),Me=this.svgElement.querySelector("[startLeadExtension]"),Ie=this.svgElement.querySelector("[endLeadExtension]"),Le={x:(y.x+x.x)/2,y:(y.y+x.y)/2};if(be&&(be.setAttribute("x1",y.x),be.setAttribute("y1",y.y),be.setAttribute("x2",D.x),be.setAttribute("y2",D.y)),we&&(we.setAttribute("x1",N.x),we.setAttribute("y1",N.y),we.setAttribute("x2",x.x),we.setAttribute("y2",x.y)),Ae&&(Ae.setAttribute("x1",y.x),Ae.setAttribute("y1",y.y),Ae.setAttribute("x2",S.x),Ae.setAttribute("y2",S.y)),$e&&($e.setAttribute("x1",x.x),$e.setAttribute("y1",x.y),$e.setAttribute("x2",E.x),$e.setAttribute("y2",E.y)),Me&&(Me.setAttribute("x1",y.x),Me.setAttribute("y1",y.y),Me.setAttribute("x2",M.x),Me.setAttribute("y2",M.y)),Ie&&(Ie.setAttribute("x1",x.x),Ie.setAttribute("y1",x.y),Ie.setAttribute("x2",T.x),Ie.setAttribute("y2",T.y)),this.textEle){var le=Math.atan2(x.y-y.y,x.x-y.x)/Math.PI*180,oe=Math.abs(le)>90?le-180:le,ke=Math.atan2(y.y-x.y,x.x-y.x)/Math.PI*180;this.annotation.angle=Math.round(ke),this.textEle.setAttribute("x",Le.x),this.textEle.setAttribute("y",Le.y),this.textEle.setAttribute("transform","rotate(".concat(oe," ").concat(Le.x," ").concat(Le.y,")")),this.textEle.textContent=this.annotation.contents}this.middleCircle.setAttribute("cx",Le.x),this.middleCircle.setAttribute("cy",Le.y)}else this.startCircle.setAttribute("cx",y.x+re),this.startCircle.setAttribute("cy",y.y+re),this.endCircle.setAttribute("cx",x.x+re),this.endCircle.setAttribute("cy",x.y+re);if(this.moveLine.setAttribute("x1",y.x+re),this.moveLine.setAttribute("y1",y.y+re),this.moveLine.setAttribute("x2",x.x+re),this.moveLine.setAttribute("y2",x.y+re),this.annotation.head||this.annotation.tail){var Ce=new ArrowHelper(y,x),Ee=this.annotation.measure?45:30,Be=this.annotation.borderWidth*I,Ve=Math.max(3*Be,(this.annotation.measure?10:12)*I);if(this.annotation.head&&this.annotation.head!=="none"){var Oe=this.svgElement.querySelector("[head]");if(Oe){var je=Ce.getArrowPoints(this.annotation.head,Ee,Ve,!1),Ge="";je&&je.forEach(function(Je){Ge.length>0&&(Ge+=" "),Ge+="".concat(Je.x,",").concat(Je.y)}),Ge.length>0&&Oe.setAttribute("points",Ge)}}if(this.annotation.tail&&this.annotation.tail!=="none"){var Xe=this.svgElement.querySelector("[tail]");if(Xe){var qe=Ce.getArrowPoints(this.annotation.tail,Ee,Ve),Ke="";qe&&qe.forEach(function(Je){Ke.length>0&&(Ke+=" "),Ke+="".concat(Je.x,",").concat(Je.y)}),Ke.length>0&&Xe.setAttribute("points",Ke)}}}}},{key:"updateMeasure",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P,S,E,M;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(y=this.getInitialPoint(),x={left:Math.min(y.start.x,y.end.x),top:Math.min(y.start.y,y.end.y),right:Math.max(y.start.x,y.end.x),bottom:Math.max(y.start.y,y.end.y)},k=[y.start.x,y.start.y,y.end.x,y.end.y],this.annotation.rect=x,this.annotation.linePoints=k,this.getResult(),P=(Math.abs(y.end.x-y.start.x)*this.annotation.factor).toFixed(this.decimalPlaces),S=(Math.abs(y.end.y-y.start.y)*this.annotation.factor).toFixed(this.decimalPlaces),this.annotation.X=P,this.annotation.Y=S,this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.length,angle:this.annotation.angle,X:P,Y:S}),f){T.next=13;break}return T.abrupt("return");case 13:if(!this.startState||this.startState.operator!=="middle"){T.next=20;break}return E={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,leadLength:this.annotation.leadLength,leadExtension:this.annotation.leadExtension,leadOffset:1-this.annotation.leadLength,contents:this.annotation.contents},this.annotation.leadOffset=1-this.annotation.leadLength,T.next=18,this.documentViewer.annotationManager.editMeasurementAnnotation(E);case 18:T.next=25;break;case 20:if(!this.startState||this.startState.operator==="move"){T.next=25;break}return M={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:x,linePoints:k},this.annotation.contents&&(M.contents=this.annotation.contents,M.labelPosition=this.annotation.labelPosition),T.next=25,this.documentViewer.annotationManager.editMeasurementAnnotation(M);case 25:case"end":return T.stop()}},d,this)})),function(d){return m.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(d){var f=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"line",operate:"mod-annot",name:f.name,pageIndex:this.PageNumber-1,pagePtr:f.pagePtr,annotPtr:f.annotPtr},d)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(d){var f=this.documentViewer.scale,y=getActualPoint({x:d.x1,y:d.y1},f),x=getActualPoint({x:d.x2,y:d.y2},f),k=getInitialPoint(y,f),P=getInitialPoint(x,f),S={left:k.x,top:k.y,right:P.x,bottom:P.y};this.annotation.rect=S,this.setAnnotationChanged({rect:S})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(d){if(d!==this.contents){var f=this.annotation;f.contents=d,f.measure&&(this.textEle.textContent=value),this.setAnnotationChanged({contents:d})}}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(d){this.annotation.opacity=d,this.svgElement.style.opacity=d,this.setAnnotationChanged({opacity:d})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(d){var f=this,y=this.annotation;y.dashes=d;var x=this.svgElement.querySelector("[head]"),k=this.svgElement.querySelector("[tail]"),P=y.borderStyle==="dashed"?this.getDashString():"";y.measure?(["startLine","endLine"].forEach(function(S){var E=f.svgElement.querySelector("[".concat(S,"]"));E&&E.setAttribute("stroke-dasharray",P)}),x&&x.setAttribute("stroke-dasharray",P),k&&k.setAttribute("stroke-dasharray",P)):(this.lineEle&&this.lineEle.setAttribute("stroke-dasharray",P),x&&x.setAttribute("stroke-dasharray",P),k&&k.setAttribute("stroke-dasharray",P)),this.setAnnotationChanged({borderWidth:y.borderWidth,borderStyle:y.borderStyle,dashes:d})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(d){var f=this;this.annotation.borderStyle=d;var y=this.svgElement.querySelector("[head]"),x=this.svgElement.querySelector("[tail]"),k=this.annotation;k.measure?["startLine","endLine"].forEach(function(P){var S=f.svgElement.querySelector("[".concat(P,"]"));S&&d==="solid"&&(S.setAttribute("stroke-dasharray",""),y&&y.setAttribute("stroke-dasharray",""),x&&x.setAttribute("stroke-dasharray","")),S&&d==="dashed"&&(S.setAttribute("stroke-dasharray",f.getDashString()),y&&y.setAttribute("stroke-dasharray",f.getDashString()),x&&x.setAttribute("stroke-dasharray",f.getDashString()))}):(this.lineEle&&d==="solid"&&(this.lineEle.setAttribute("stroke-dasharray",""),y&&y.setAttribute("stroke-dasharray",""),x&&x.setAttribute("stroke-dasharray","")),this.lineEle&&d==="dashed"&&(this.lineEle.setAttribute("stroke-dasharray",this.getDashString()),y&&y.setAttribute("stroke-dasharray",this.getDashString()),x&&x.setAttribute("stroke-dasharray",this.getDashString()))),this.setAnnotationChanged({borderStyle:d,dashes:k.dashes,borderWidth:k.borderWidth})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(d){var f=this,y=this.annotation;y.borderWidth=d,(y.measure?["startLine","endLine","startLead","endLead","startLeadExtension","endLeadExtension","head","tail"]:["mainLine","head","tail"]).forEach(function(x){var k=f.svgElement.querySelector("[".concat(x,"]"));k&&k.setAttribute("stroke-width",d*f.documentViewer.scale)}),this.update({start:this.start,end:this.end},!1),this.setAnnotationChanged({borderWidth:d})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(d){var f=this,y=this.annotation;y.borderColor=d,(y.measure?["startLine","endLine","startLead","endLead","startLeadExtension","endLeadExtension","head","tail"]:["mainLine","head","tail"]).forEach(function(x){var k=f.svgElement.querySelector("[".concat(x,"]"));k&&k.setAttribute("stroke",d)}),this.setAnnotationChanged({borderColor:d})}},{key:"getStartStyle",value:function(){return this.annotation.head}},{key:"setStartStyle",value:function(d){var f=this.svgElement.querySelector("[head]"),y=this.annotation;if(f&&d==="none")f.style.display=d!=="none"?"":"none";else{f&&f.remove();var x=y.borderWidth*this.documentViewer.scale,k=Math.max(3*x,(y.measure?10:12)*this.documentViewer.scale),P=new ArrowHelper(this.start,this.end).getArrow(d,this.annotation.measure?45:30,k,!1);P&&(P.setAttribute("head",""),P.setAttribute("stroke",y.borderColor),P.setAttribute("stroke-width",x),P.setAttribute("fill",["closedarrow","square","circle","diamond","rclosedarrow"].includes(this.annotation.head)?y.borderColor:"none"),P.setAttribute("stroke-dasharray",y.borderStyle==="dashed"?this.getDashString():""),this.svgElement.append(P))}this.setAnnotationChanged({head:d,tail:y.tail})}},{key:"getEndStyle",value:function(){return this.annotation.tail}},{key:"setEndStyle",value:function(d){var f=this.annotation,y=this.svgElement.querySelector("[tail]");if(y&&d==="none")y.style.display=d!=="none"?"":"none";else{y&&y.remove();var x=f.borderWidth*this.documentViewer.scale,k=Math.max(3*x,(f.measure?10:12)*this.documentViewer.scale),P=new ArrowHelper(this.start,this.end).getArrow(d,this.annotation.measure?45:30,k);P&&(P.setAttribute("tail",""),P.setAttribute("stroke",f.borderColor),P.setAttribute("stroke-width",x),P.setAttribute("fill",["closedarrow","square","circle","diamond","rclosedarrow"].includes(this.annotation.tail)?f.borderColor:"none"),P.setAttribute("stroke-dasharray",f.borderStyle==="dashed"?this.getDashString():""),this.svgElement.append(P))}this.setAnnotationChanged({tail:d,head:f.head})}},{key:"getStartPoint",value:function(){return{x:this.annotation.linePoints[0],y:this.annotation.linePoints[1]}}},{key:"setStartPoint",value:function(d,f){var y=this.documentViewer.scale,x=this.documentViewer.getPageWidth(this.PageNumber),k=this.documentViewer.getPageHeight(this.PageNumber);d=Math.max(0,d),d=Math.min(d,x),f=Math.max(0,f),f=Math.min(f,k),d*=y,f*=y,this.update({start:{x:d,y:f},end:this.end},!1);var P=this.getInitialPoint(),S=P.start,E=P.end,M=[S.x,S.y,E.x,E.y];this.annotation.linePoints=M;var T={left:Math.min(S.x,E.x)-6,top:Math.min(S.y,E.y)-6,right:Math.max(S.x,E.x)+6,bottom:Math.max(S.y,E.y)+6};this.annotation.rect=T,this.setAnnotationChanged({rect:T,linePoints:M})}},{key:"getEndPoint",value:function(){return{x:this.annotation.linePoints[2],y:this.annotation.linePoints[3]}}},{key:"setEndPoint",value:function(d,f){var y=this.documentViewer.scale,x=this.documentViewer.getPageWidth(this.PageNumber),k=this.documentViewer.getPageHeight(this.PageNumber);d=Math.max(0,d),d=Math.min(d,x),f=Math.max(0,f),f=Math.min(f,k),d*=y,f*=y,this.update({start:this.start,end:{x:d,y:f}},!1);var P=this.getInitialPoint(),S=P.start,E=P.end,M=[S.x,S.y,E.x,E.y];this.annotation.linePoints=M;var T={left:Math.min(S.x,E.x)-6,top:Math.min(S.y,E.y)-6,right:Math.max(S.x,E.x)+6,bottom:Math.max(S.y,E.y)+6};this.annotation.rect=T,this.setAnnotationChanged({rect:T,linePoints:M})}},{key:"handlePropertyPanel",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(y=this.annotation,this.documentViewer.annotationStore.selectedElementName===y.name){P.next=3;break}return P.abrupt("return");case 3:x=0,P.t0=_regeneratorRuntime().keys(f);case 5:if((P.t1=P.t0()).done){P.next=13;break}return k=P.t1.value,P.t2=x,P.next=10,this.setCustomData(k,f[k],!0);case 10:x=P.t2+=P.sent,P.next=5;break;case 13:x>0&&this.sendData(f);case 14:case"end":return P.stop()}},d,this)})),function(d){return w.apply(this,arguments)})},{key:"setCustomData",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function d(f,y){var x,k,P,S,E,M=this,T=arguments;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:x=T.length>2&&T[2]!==void 0&&T[2],k=this.annotation,P=0,S=_regeneratorRuntime().mark(function N(){var I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe,Ke,Je,rt,ht,vt,Ct,kt,mt,Vt,bt,ot,gt,tt,ut,Re,Te,He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt;return _regeneratorRuntime().wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(E!==f||k[E]===y){Pt.next=41;break}if(k[E]=y,P=1,f==="borderColor"&&(k.measure?I=["startLine","endLine","startLead","endLead","startLeadExtension","endLeadExtension","head","tail"]:(I=["mainLine","head","tail"],k.color=y),I.forEach(function(Tt){var ct=M.svgElement.querySelector("[".concat(Tt,"]"));ct&&ct.setAttribute("stroke",y)})),f==="opacity"&&(M.svgElement.style.opacity=y),f==="borderWidth"&&((k.measure?["startLine","endLine","startLead","endLead","startLeadExtension","endLeadExtension","head","tail"]:["mainLine","head","tail"]).forEach(function(Tt){var ct=M.svgElement.querySelector("[".concat(Tt,"]"));ct&&ct.setAttribute("stroke-width",y*M.documentViewer.scale)}),M.update({start:M.start,end:M.end},!1),k.measure&&M.showPopup()),f==="borderStyle"&&(O=M.svgElement.querySelector("[head]"),F=M.svgElement.querySelector("[tail]"),k.measure?["startLine","endLine"].forEach(function(Tt){var ct=M.svgElement.querySelector("[".concat(Tt,"]"));ct&&y==="solid"&&(ct.setAttribute("stroke-dasharray",""),O&&O.setAttribute("stroke-dasharray",""),F&&F.setAttribute("stroke-dasharray","")),ct&&y==="dashed"&&(ct.setAttribute("stroke-dasharray",M.getDashString()),O&&O.setAttribute("stroke-dasharray",M.getDashString()),F&&F.setAttribute("stroke-dasharray",M.getDashString()))}):(M.lineEle&&y==="solid"&&(M.lineEle.setAttribute("stroke-dasharray",""),O&&O.setAttribute("stroke-dasharray",""),F&&F.setAttribute("stroke-dasharray","")),M.lineEle&&y==="dashed"&&(M.lineEle.setAttribute("stroke-dasharray",M.getDashString()),O&&O.setAttribute("stroke-dasharray",M.getDashString()),F&&F.setAttribute("stroke-dasharray",M.getDashString())))),q=k.borderStyle==="dashed"?M.getDashString():"",f==="dashes"&&(Y=M.svgElement.querySelector("[head]"),_e=M.svgElement.querySelector("[tail]"),k.measure?(["startLine","endLine"].forEach(function(Tt){var ct=M.svgElement.querySelector("[".concat(Tt,"]"));ct&&ct.setAttribute("stroke-dasharray",q)}),Y&&Y.setAttribute("stroke-dasharray",q),_e&&_e.setAttribute("stroke-dasharray",q)):(M.lineEle&&M.lineEle.setAttribute("stroke-dasharray",q),Y&&Y.setAttribute("stroke-dasharray",q),_e&&_e.setAttribute("stroke-dasharray",q))),f==="head"&&((ne=M.svgElement.querySelector("[head]"))&&y==="none"?ne.style.display=y!=="none"?"":"none":(ne&&ne.remove(),ve=k.borderWidth*M.documentViewer.scale,J=Math.max(3*ve,(k.measure?10:12)*M.documentViewer.scale),fe=["closedarrow","square","circle","diamond","rclosedarrow"],Z=new ArrowHelper(M.start,M.end),(j=Z.getArrow(y,M.annotation.measure?45:30,J,!1))&&(j.setAttribute("head",""),j.setAttribute("stroke",k.borderColor),j.setAttribute("stroke-width",ve),j.setAttribute("fill",fe.includes(M.annotation.head)?k.borderColor:"none"),j.setAttribute("stroke-dasharray",q),M.svgElement.append(j)))),f==="tail"&&((X=M.svgElement.querySelector("[tail]"))&&y==="none"?X.style.display=y!=="none"?"":"none":(X&&X.remove(),H=k.borderWidth*M.documentViewer.scale,U=Math.max(3*H,(k.measure?10:12)*M.documentViewer.scale),te=["closedarrow","square","circle","diamond","rclosedarrow"],Q=new ArrowHelper(M.start,M.end),(re=Q.getArrow(y,M.annotation.measure?45:30,U))&&(re.setAttribute("tail",""),re.setAttribute("stroke",k.borderColor),re.setAttribute("stroke-width",H),re.setAttribute("fill",te.includes(M.annotation.tail)?k.borderColor:"none"),re.setAttribute("stroke-dasharray",q),M.svgElement.append(re)))),f==="color"&&M.textEle.setAttribute("fill",y),f==="fontSize"&&(M.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(y,"px)")),f==="fontName"&&(M.textEle.style.fontFamily=y),f==="fontStyle"&&(M.textEle.style.fontStyle=y),f==="fontWeight"&&(M.textEle.style.fontWeight=y),f==="contents"&&k.measure&&(M.textEle.textContent=y),f!=="scale"&&f!=="precision"){Pt.next=35;break}return f==="precision"&&(M.decimalPlaces=((Pe=Math.abs(k.precision).toString().split(".")[1])===null||Pe===void 0?void 0:Pe.length)||0),M.getResult(),Pt.next=22,M.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1(_defineProperty$1(_defineProperty$1({rulerPtr:k.rulerPtr},f,y),"annotPtr",k.annotPtr),"contents",k.contents));case 22:return Pt.next=24,M.documentViewer.messageHandler.sendWithPromise("GetFactor",k.rulerPtr);case 24:be=Pt.sent,we=M.getInitialPoint(),Ae=(Math.abs(we.end.x-we.start.x)*be).toFixed(M.decimalPlaces),$e=(Math.abs(we.end.y-we.start.y)*be).toFixed(M.decimalPlaces),k.factor=be,k.X=Ae,k.Y=$e,M.textEle&&(M.textEle.textContent=k.contents),M.documentViewer.annotationStore.selectedElementName!==M.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||M.documentViewer.eventBus.dispatch("measurePropertyChange",M.annotation),M.documentViewer.eventBus.dispatch("updateMeasureData",{scale:k.scale,precision:k.precision,length:k.length,X:Ae,Y:$e}),P=0;case 35:Me=M.documentViewer.scale,Ie=M.documentViewer.getPageWidth(M.PageNumber)*Me,Le=M.documentViewer.getPageHeight(M.PageNumber)*Me,f==="length"&&(le=M.start.x<M.end.x,oe=le?M.start:M.end,ke=oe.x,Ce=oe.y,Ee=le?M.end:M.start,Be=Ee.x,Ve=Ee.y,Oe=Math.hypot(Be-ke,Ve-Ce),je=Be-ke,Ge=Ve-Ce,Xe=y/k.factor*Me/Oe,qe=je>0?(Ie-ke)/je:(0-ke)/je,Ke=Ge>0?(Le-Ce)/Ge:(0-Ce)/Ge,Je=Math.min(qe,Ke),rt=Math.min(Math.max(Xe,0),Je),ht=ke+je*rt,vt=Ce+Ge*rt,M.startState={operator:"end"},Ct=le?{start:M.start,end:{x:ht,y:vt}}:{start:{x:ht,y:vt},end:M.end},M.update(Ct),M.showPopup(),P=0),f==="angle"&&(kt=M.start,mt=kt.x,Vt=kt.y,bt=M.end,ot=bt.x,gt=bt.y,tt=Math.hypot(ot-mt,gt-Vt),ut=y*Math.PI/180,Re=tt*Math.cos(ut),Te=tt*Math.sin(-ut),He=mt+Re,Fe=Vt+Te,He=Math.min(Ie,He),He=Math.max(0,He),Fe=Math.min(Le,Fe),Fe=Math.max(0,Fe),M.startState={operator:"end"},M.update({start:M.start,end:{x:He,y:Fe}}),M.showPopup(),P=0),["fontSize","scale","precision","contents"].includes(f)&&(ze=M.svgElement.querySelector("[startLine]"),We=M.svgElement.querySelector("[endLine]"),Ue=M.end.x-M.start.x,et=M.end.y-M.start.y,it=Math.sqrt(Ue*Ue+et*et),nt=Ue/it,dt=et/it,xt=M.getTextWidth(),ze&&(yt={x:M.start.x+nt*(it/2-xt/2),y:M.start.y+dt*(it/2-xt/2)},ze.setAttribute("x1",M.start.x),ze.setAttribute("y1",M.start.y),ze.setAttribute("x2",yt.x),ze.setAttribute("y2",yt.y)),We&&(Bt={x:M.start.x+nt*(it/2+xt/2),y:M.start.y+dt*(it/2+xt/2)},We.setAttribute("x1",Bt.x),We.setAttribute("y1",Bt.y),We.setAttribute("x2",M.end.x),We.setAttribute("y2",M.end.y)));case 41:case"end":return Pt.stop()}},N)}),D.t0=_regeneratorRuntime().keys(k);case 5:if((D.t1=D.t0()).done){D.next=10;break}return E=D.t1.value,D.delegateYield(S(),"t2",8);case 8:D.next=5;break;case 10:return!x&&this.sendData(_defineProperty$1({},f,y)),D.abrupt("return",P);case 12:case"end":return D.stop()}},d,this)})),function(d,f){return s.apply(this,arguments)})},{key:"sendData",value:function(d){var f=this.annotation;if(f.measure){var y={pagePtr:f.pagePtr,annotPtr:f.annotPtr,rulerPtr:f.rulerPtr,pageIndex:f.pageIndex,contents:f.contents};if(["fontSize","fontName","color","fontStyle"].some(function(M){return d[M]})){y.fontSize=f.fontSize,y.color=f.color;var x={Courier:{normal:"Courier",bold:"Courier-Bold",italic:"Courier-Oblique",boldItalic:"Courier-BoldOblique"},Helvetica:{normal:"Helvetica",bold:"Helvetica-Bold",italic:"Helvetica-Oblique",boldItalic:"Helvetica-BoldOblique"},Times:{normal:"Times",bold:"Times-Bold",italic:"Times-Italic",boldItalic:"Times-BoldItalic"}},k=f.fontName;f.isBold&&f.isItalic?y.fontName=x[k].boldItalic:f.isBold?y.fontName=x[k].bold:f.isItalic?y.fontName=x[k].italic:y.fontName=x[k]?x[k].normal:k,delete d.fontName}(d.hasOwnProperty("head")||d.hasOwnProperty("tail"))&&(y.head=f.head,y.tail=f.tail,delete d.head,delete d.tail),d.dashes&&(y.borderStyle=f.borderStyle,y.borderWidth=f.borderWidth),d.borderStyle&&(y.dashes=d.borderStyle==="solid"?"":f.dashes,y.borderWidth=f.borderWidth);var P=Object.assign({},y,d);this.documentViewer.annotationManager.editMeasurementAnnotation(P)}else{var S={operate:"mod-annot",name:f.name,pageIndex:f.pageIndex,pagePtr:f.pagePtr,annotPtr:f.annotPtr};(d.hasOwnProperty("head")||d.hasOwnProperty("tail"))&&(S.head=f.head,S.tail=f.tail,delete d.head,delete d.tail),d.dashes&&(S.borderStyle=f.borderStyle,S.borderWidth=f.borderWidth),d.borderStyle&&(S.dashes=d.borderStyle==="solid"?"":f.dashes,S.borderWidth=f.borderWidth),d.borderColor&&(S.color=f.color);var E=Object.assign({},S,d);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:E})}}},{key:"getResult",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:f=_slicedToArray(this.annotation.linePoints,4),y=f[0],x=f[1],k=f[2],P=f[3],S=this.formatValue(Math.hypot(y-k,x-P)*this.annotation.factor),this.annotation.length=S,this.annotation.contents=S.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit;case 4:case"end":return E.stop()}},d,this)})),function(){return u.apply(this,arguments)})},{key:"showPopup",value:function(){if(this.layer){var d=this.layer.div.getBoundingClientRect(),f=d.left+this.rect.left,y=this.rect.top+d.top,x={left:f,top:y,right:f+this.rect.width,bottom:y+this.rect.height};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:x}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x=this;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:f==="delete"&&this.handleDelete(),f==="reply"&&(this.openReply(),(y=document.getElementById("leftPanel"))!=null&&y.classList.contains("closed")&&setTimeout(function(){x.showPopup()},350));case 2:case"end":return k.stop()}},d,this)})),function(d){return r.apply(this,arguments)})},{key:"formatValue",value:function(d){return d%1==0?d:Number(d.toFixed(this.decimalPlaces))}},{key:"getTextWidth",value:function(){var d=document.createElement("canvas").getContext("2d");d.font="".concat(this.annotation.fontSize*this.documentViewer.scale,"px ").concat(this.annotation.fontFamily);var f=1.1*d.measureText(this.annotation.contents).width,y=this.end.x-this.start.x,x=this.end.y-this.start.y,k=Math.sqrt(y*y+x*x);return k>f?f:k}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"){x.next=2;break}return x.abrupt("return");case 2:(y=f.keyCode||f.which)!==8&&y!==46||this.handleDelete();case 4:case"end":return x.stop()}},d,this)})),function(d){return o.apply(this,arguments)})}]);var o,r,u,s,w,m,v,g}(),Shape$1=function(e){function n(r){var u,s=r.annotation,w=r.documentViewer,m=r.show,v=m!==void 0&&m,g=r.enableReply,d=g===void 0||g;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:s,documentViewer:w}])).type=s.type,u.type=s.type,u.enableReply=d,u.show=v,u.hidden=!0,u.initial=!1,u.start=null,u.end=null,u.newStart=null,u.newEnd=null,u.svgElement=null,u.startCircle=null,u.endCircle=null,u.selectionOutlinePadding=8,u.selectionOutlinePointWidth=7,u.onMousedown=u.handleMouseDown.bind(u),u.onMouseup=u.handleMouseUp.bind(u),u.onMousemove=u.handleMouseMove.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.handlePropertyPanel=u.handlePropertyPanel.bind(u),u.render(),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var r=this.annotation,u=this.documentViewer.scale,s=this.getActualRect(u),w=s.start,m=s.end;this.start=w,this.end=m,!r.borderStyle&&(r.borderStyle="solid"),!r.borderColor&&(r.borderColor=r.color="#000000"),!r.borderWidth&&(r.borderWidth=0),!("fillTransparency"in r)&&(r.fillTransparency=1),!("opacity"in r)&&(r.opacity=1),r.intensity=r.intensity||1;var v=this.padding,g=r.borderWidth||2,d=Math.max(5,g)+v,f=this.getWidth(),y=this.getHeight(),x=document.createElement("div");x.id=r.name,x.className="annotation",x.style.top="calc(var(--scale-factor) * ".concat(r.rect.top-v,"px)"),x.style.left="calc(var(--scale-factor) * ".concat(r.rect.left-v,"px)"),x.style.width="calc(var(--scale-factor) * ".concat(f+2*v,"px)"),x.style.height="calc(var(--scale-factor) * ".concat(y+2*v,"px)"),this.annotationContainer=x,this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg");var k,P=this.svgElement.style;P.overflow="visible",P.width=f+2*v+"px",P.height=y+2*v+"px",P.transform="scale(var(--scale-factor))",P.transformOrigin="left top",this.svgElement.addEventListener("mousedown",this.handleClick.bind(this)),r.type==="square"?(k=this.createBorderStyle(),this.selectionShapeEle=createSvg("rect",{x:d/2,y:d/2,width:f+2*v-d,height:y+2*v-d,stroke:r.borderColor,"stroke-width":d,"stroke-opacity":0,fill:"none","fill-opacity":0})):(k=createSvg("ellipse",{cx:f/2+v,cy:y/2+v,rx:(f-g)/2,ry:(y-g)/2,stroke:r.borderColor,"stroke-width":g,"stroke-opacity":r.opacity||1,fill:r.fillColor?r.fillColor:"none","fill-opacity":r.opacity||1,"stroke-dasharray":this.getDashString()}),this.selectionShapeEle=createSvg("ellipse",{cx:f/2+v,cy:y/2+v,rx:(f+2*v-d)/2,ry:(y+2*v-d)/2,stroke:r.borderColor,"stroke-width":d,"stroke-opacity":0,fill:"none","fill-opacity":0})),this.shapeEle=k,this.svgElement.append(this.selectionShapeEle),this.svgElement.append(this.shapeEle),this.annotationContainer.append(this.svgElement),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:"calc(var(--scale-factor) * ".concat(r.rect.left+f,"px - 114px)"),top:"calc(var(--scale-factor) * ".concat(r.rect.top+y,"px + 12px)")},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr;var S=3+this.selectionOutlinePointWidth;this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(r.rect.left*u-S,"px)"),top:"".concat(r.rect.top*u-S,"px)"),width:"".concat(f*u+2*S,"px)"),height:"".concat(y*u+2*S,"px)"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"fill-opacity":0,width:f*u+2*S-this.selectionOutlinePointWidth,height:y*u+2*S-this.selectionOutlinePointWidth,x:(this.selectionOutlinePointWidth-1)/2,y:(this.selectionOutlinePointWidth-1)/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:0}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:(y*u+2*S)/2}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:y*u+2*S-this.selectionOutlinePointWidth}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(f*u+2*S)/2,y:y*u+2*S-this.selectionOutlinePointWidth}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f*u+2*S-this.selectionOutlinePointWidth,y:y*u+2*S-this.selectionOutlinePointWidth}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f*u+2*S-this.selectionOutlinePointWidth,y:(y*u+2*S)/2}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f*u+2*S-this.selectionOutlinePointWidth,y:0}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(f*u+2*S)/2,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1}},{key:"getActualRect",value:function(r){var u=this.annotation.rect,s=u.left,w=u.top,m=u.right,v=u.bottom;return{start:getActualPoint$1({x:s,y:w},r),end:getActualPoint$1({x:m,y:v},r)}}},{key:"rectCalc",value:function(r){var u=r.start,s=r.end;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"calculate",value:function(r,u){var s=this.rectCalc({start:r,end:u}),w=(this.annotation.borderWidth||2)*this.documentViewer.scale;return{top:s.top-w,left:s.left-w,width:s.width+2*w,height:s.height+2*w}}},{key:"getInitialPoint",value:function(){var r=this.documentViewer.scale;return{start:{x:this.start.x/r,y:this.start.y/r},end:{x:this.end.x/r,y:this.end.y/r}}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var r;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var u=this.annotation;this.documentViewer.annotationStore.selectedElementName=u.name;var s=_objectSpread2$1({},u);delete s.annotPtr,delete s.pagePtr,delete s.operate,delete s.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",s)}(r=this.layer)===null||r===void 0||(r=r.div)===null||r===void 0||r.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var r,u,s=this.annotation,w=this.getWidth();this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((r=this.layer)===null||r===void 0||r.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:"calc(var(--scale-factor) * ".concat(s.rect.left+w,"px - 114px)")})):((u=this.layer)===null||u===void 0||u.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:"calc(var(--scale-factor) * ".concat(s.rect.left+w,"px - 46px)")}))}},{key:"handleClick",value:function(r){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.documentViewer.activeTool)&&!document.querySelector(".compare-document-container").contains(r==null?void 0:r.target)){this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel);var u=[this.svgElement,this.popupElement,this.outerLine,document.querySelector(".annotation-panel")],s=document.getElementById("annotationPropertyPanelButton");s&&u.push(s);var w=document.querySelector(".toggle-button");w&&u.push(w),onClickOutside$1(u,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var r,u,s;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(r=this.outerLine)===null||r===void 0||r.removeEventListener("mousedown",this.onMousedown),(u=this.outerLine)===null||u===void 0||u.removeEventListener("touchstart",this.onMousedown),(s=this.outerLineContainer)===null||s===void 0||s.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(r){var u;if(r.button===0||r.type!=="mousedown"){(u=this.layer)!==null&&u!==void 0&&u.tool&&r.stopPropagation();var s=r.target.getAttribute("data-id"),w=this.documentViewer.getScrollViewElement();this.scrollTop=w.scrollTop,this.scrollLeft=w.scrollLeft;var m=getClickPoint(r),v=m.pageX,g=m.pageY;this.startState={operator:s,clickX:v,clickY:g},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(r){if(r.button===0||r.type!=="mousemove"){r.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var u=getClickPoint(r),s=u.pageX,w=u.pageY,m=this.documentViewer,v=m.getScrollViewElement(),g=v.scrollTop;s=s+v.scrollLeft-this.scrollLeft,w=w+g-this.scrollTop;var d=this.start,f=this.end,y=this.startState,x=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+this.annotation.borderWidth*this.documentViewer.scale,k=m.scale,P=m.getPageWidth(this.PageNumber)*k,S=m.getPageHeight(this.PageNumber)*k;if(y.operator==="nw-resize"){var E=s-(y.clickX-this.start.x),M=w-(y.clickY-this.start.y);E=Math.min(f.x-5,E),E=Math.max(x,E),M=Math.min(f.y-5,M),M=Math.max(x,M),this.update({start:{x:E,y:M},end:f})}else if(y.operator==="w-resize"){var T=s-(y.clickX-this.start.x);T=Math.min(f.x-5,T),T=Math.max(x,T),this.update({start:{x:T,y:d.y},end:f})}else if(y.operator==="sw-resize"){var D=s-(y.clickX-this.start.x),N=w-(y.clickY-this.end.y);D=Math.min(f.x-5,D),D=Math.max(x,D),N=Math.min(S-x,N),N=Math.max(d.y+5,N),this.update({start:{x:D,y:d.y},end:{x:f.x,y:N}})}else if(y.operator==="s-resize"){var I=w-(y.clickY-this.end.y);I=Math.min(S-x,I),I=Math.max(d.y+5,I),this.update({start:d,end:{x:f.x,y:I}})}else if(y.operator==="se-resize"){var O=s-(y.clickX-this.end.x),F=w-(y.clickY-this.end.y);O=Math.min(P-x,O),O=Math.max(d.x+5,O),F=Math.min(S-x,F),F=Math.max(d.y+5,F),this.update({start:d,end:{x:O,y:F}})}else if(y.operator==="e-resize"){var q=s-(y.clickX-this.end.x);q=Math.min(P-x,q),q=Math.max(d.x+5,q),this.update({start:d,end:{x:q,y:f.y}})}else if(y.operator==="ne-resize"){var Y=s-(y.clickX-this.end.x),_e=w-(y.clickY-this.start.y);Y=Math.min(P-x,Y),Y=Math.max(d.x+5,Y),_e=Math.min(f.y-5,_e),_e=Math.max(x,_e),this.update({start:{x:d.x,y:_e},end:{x:Y,y:f.y}})}else if(y.operator==="n-resize"){var ne=w-(y.clickY-this.start.y);ne=Math.min(f.y-5,ne),ne=Math.max(x,ne),this.update({start:{x:d.x,y:ne},end:f})}else if(y.operator==="move"){var ve,J,fe,Z,j=this.documentViewer,X=this.getMouseLocation(r),H=j.getSelectedPage(X,X),U=this.PageNumber;if(H.first&&H.first!==U){var te,Q=j.windowToPage(X,H.first,!1),re=Math.abs(d.x-f.x),Pe=Math.abs(d.y-f.y);if(j.pdfViewer.spreadMode===0&&j.pdfViewer.scrollMode===0)ve=s-(y.clickX-this.start.x),J=H.first>U?Q.y:Q.y-Pe,fe=s-(y.clickX-this.end.x),Z=H.first>U?Q.y+Pe:Q.y;else if(j.pdfViewer.spreadMode===0&&j.pdfViewer.scrollMode===1)ve=H.first>U?Q.x:Q.x-re,J=w-(y.clickY-this.start.y),fe=H.first>U?Q.x+re:Q.x,Z=w-(y.clickY-this.end.y);else if(j.pdfViewer.spreadMode===1&&j.pdfViewer.scrollMode===0){var be=Math.min(H.first,U),we=Math.max(H.first,U);if(we-be>2||be+1===we&&be%2==0)return;be+1===we?(ve=H.first>U?Q.x:Q.x-re,J=w-(y.clickY-this.start.y),fe=H.first>U?Q.x+re:Q.x,Z=w-(y.clickY-this.end.y)):be+2===we&&(ve=s-(y.clickX-this.start.x),J=H.first>U?Q.y:Q.y-Pe,fe=s-(y.clickX-this.end.x),Z=H.first>U?Q.y+Pe:Q.y)}else if(j.pdfViewer.spreadMode===2&&j.pdfViewer.scrollMode===0){var Ae=Math.min(H.first,U),$e=Math.max(H.first,U);if($e-Ae>2||Ae+1===$e&&(Ae!==1||$e!==2)&&$e%2==0||Ae===1&&$e===3)return;Ae+2===$e||Ae===1&&$e===2?(ve=s-(y.clickX-this.start.x),J=H.first>U?Q.y:Q.y-Pe,fe=s-(y.clickX-this.end.x),Z=H.first>U?Q.y+Pe:Q.y):Ae+1===$e&&(ve=H.first>U?Q.x:Q.x-re,J=w-(y.clickY-this.start.y),fe=H.first>U?Q.x+re:Q.x,Z=w-(y.clickY-this.end.y))}if(!j.pdfViewer._pages[H.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=H.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Me=(te=this.layer)===null||te===void 0?void 0:te.div;Me==null||Me.append(this.annotationContainer),Me==null||Me.append(this.outerLineContainer)}else{J=w-(y.clickY-this.start.y),ve=s-(y.clickX-this.start.x),fe=s-(y.clickX-this.end.x),Z=w-(y.clickY-this.end.y);var Ie=j.pageToWindow({x:ve,y:J},U,!1),Le=j.pageToWindow({x:fe,y:Z},U,!1),le=0,oe=0;w>y.clickY?oe=(oe=v.offsetHeight-(Le.y-v.scrollTop-v.offsetTop))<100?5:0:w<y.clickY&&(oe=(oe=Ie.y-v.scrollTop-v.offsetTop)<100?-5:0),s>y.clickX?le=(le=v.offsetWidth-(Le.x-v.scrollLeft-v.offsetLeft))<100?5:0:s<y.clickX&&(le=(le=Ie.x-v.scrollLeft-v.offsetLeft)<100?-5:0),(le||oe)&&(v.scrollTop+=oe,v.scrollLeft+=le);var ke={width:Math.abs(d.x-f.x),height:Math.abs(d.y-f.y)};ve<fe?(ve=Math.max(x,ve),ve=Math.min(P-ke.width-x,ve),fe=Math.max(ke.width+x,fe),fe=Math.min(P-x,fe)):(fe=Math.max(x,fe),fe=Math.min(P-ke.width-x,fe),ve=Math.max(ke.width+x,ve),ve=Math.min(P-x,ve)),J<Z?(J=Math.max(x,J),J=Math.min(S-ke.height-x,J),Z=Math.max(ke.height+x,Z),Z=Math.min(S-x,Z)):(Z=Math.max(x,Z),Z=Math.min(S-ke.height-x,Z),J=Math.max(ke.height+x,J),J=Math.min(S-x,J))}this.update({start:{x:ve,y:J},end:{x:fe,y:Z}})}y.clickX=s,y.clickY=w}}},{key:"handleDelete",value:function(r){this.layer&&this.layer.tool&&r&&r.stopPropagation(),this.delete();var u={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(u.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",u),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var r,u;this.handleOutside(),(r=this.annotationContainer)===null||r===void 0||r.remove(),this.annotation.isDelete=!0,(u=this.layer)===null||u===void 0||u.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y,x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(u.button===0||u.type!=="mouseup"){S.next=2;break}return S.abrupt("return");case 2:if((s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,w=this.annotation,m=this.getInitialPoint(),v=m.start,g=m.end,(d={left:v.x,top:v.y,right:g.x,bottom:g.y})!==w.rect||this.PrePageNumber!==this.PageNumber){S.next=16;break}return S.abrupt("return");case 16:if(w.rect=d,this.PrePageNumber===this.PageNumber){S.next=40;break}return f={type:"delete",annotation:{operate:"del-annot",name:w.name,pageIndex:w.pageIndex,annotPtr:w.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(y=Object.assign({},w)).annotPtr,delete y.pagePtr,delete y.name,y.operate="add-annot",y.pageIndex=this.PageNumber-1,S.next=30,this.documentViewer.annotationManager.createAnnotation(y);case 30:return x=S.sent,k=new n({annotation:x,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),S.next=35,this.documentViewer.annotationManager.addAnnotation(k);case 35:this.documentViewer.annotationManager.drawAnnotationsFromList(k),this.annotationContainer.remove(),this.outerLineContainer.remove(),S.next=44;break;case 40:P={operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:d,linePoints:[d.left,d.bottom,d.right,d.top]},!w.annotPtr&&(P.linePoints=[d.left,d.bottom,d.right,d.top]),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:P}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 44:case"end":return S.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var r=this.documentViewer.scale,u=this.getActualRect(r),s=u.start,w=u.end;this.update({start:s,end:w})}}},{key:"update",value:function(r){var u=r.start,s=r.end;this.calculate(u,s),this.start=u,this.end=s;var w=this.annotation,m=this.padding,v=this.getInitialPoint(),g=v.start,d=v.end,f=Math.abs(d.x-g.x),y=Math.abs(d.y-g.y),x=this.documentViewer.scale,k=w.borderWidth||2,P=Math.max(5,k)+m,S=m+k/2,E=m+k/2,M=this.annotationContainer.style;if(M.top="calc(var(--scale-factor) * ".concat(g.y-m,"px)"),M.left="calc(var(--scale-factor) * ".concat(g.x-m,"px)"),M.width="calc(var(--scale-factor) * ".concat(f+2*m,"px)"),M.height="calc(var(--scale-factor) * ".concat(y+2*m,"px)"),this.svgElement.style.width=f+2*m+"px",this.svgElement.style.height=y+2*m+"px",w.type==="square"){if(w.borderStyle==="cloudy"){var T=[{x:S,y:E},{x:S+f,y:E},{x:S+f,y:E+y},{x:S,y:E+y}],D=drawPathWithArcs({Intensity:w.intensity,ur:0},T);this.shapeEle.setAttribute("d",D)}else this.shapeEle.setAttribute("width",Math.max(1,f-k)),this.shapeEle.setAttribute("height",Math.max(1,y-k)),this.shapeEle.setAttribute("x",S),this.shapeEle.setAttribute("y",E);this.selectionShapeEle.setAttribute("width",f+2*m-P),this.selectionShapeEle.setAttribute("height",y+2*m-P),this.selectionShapeEle.setAttribute("x",P/2),this.selectionShapeEle.setAttribute("y",P/2)}else this.shapeEle.setAttribute("cx",f/2+m),this.shapeEle.setAttribute("cy",y/2+m),this.shapeEle.setAttribute("rx",(f-k)/2),this.shapeEle.setAttribute("ry",(y-k)/2),this.selectionShapeEle.setAttribute("cx",f/2+m),this.selectionShapeEle.setAttribute("cy",y/2+m),this.selectionShapeEle.setAttribute("rx",(f+2*m-P)/2),this.selectionShapeEle.setAttribute("ry",(y+2*m-P)/2);var N=3+this.selectionOutlinePointWidth;this.outerLine.style.left="".concat(g.x*x-N,"px"),this.outerLine.style.top="".concat(g.y*x-N,"px"),this.outerLine.style.width="".concat(f*x+2*N,"px"),this.outerLine.style.height="".concat(y*x+2*N,"px"),this.popupElement.style.left="calc(var(--scale-factor) * ".concat(g.x+f,"px - 114px)"),this.popupElement.style.top="calc(var(--scale-factor) * ".concat(g.y+y,"px + 12px)"),this.moveRect.setAttribute("width",f*x+2*N-(this.selectionOutlinePointWidth-1)),this.moveRect.setAttribute("height",y*x+2*N-(this.selectionOutlinePointWidth-1)),this.LeftRect.setAttribute("y",(y*x+2*N)/2),this.bottomLeftRect.setAttribute("y",y*x+2*N-this.selectionOutlinePointWidth),this.bottomRect.setAttribute("x",(f*x+2*N)/2),this.bottomRect.setAttribute("y",y*x+2*N-this.selectionOutlinePointWidth),this.bottomRightRect.setAttribute("x",f*x+2*N-this.selectionOutlinePointWidth),this.bottomRightRect.setAttribute("y",y*x+2*N-this.selectionOutlinePointWidth),this.rightRect.setAttribute("x",f*x+2*N-this.selectionOutlinePointWidth),this.rightRect.setAttribute("y",(y*x+2*N)/2),this.topRightRect.setAttribute("x",f*x+2*N-this.selectionOutlinePointWidth),this.topRect.setAttribute("x",(f*x+2*N)/2)}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:this.type,operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(r){var u=this.documentViewer.scale,s=r.x1,w=r.y1,m=r.x2,v=r.y2;if(s>m){var g=s;s=m,m=g}if(w>v){var d=w;w=v,v=d}var f=getActualPoint$1({x:s,y:w},u),y=getActualPoint$1({x:m,y:v},u);this.update({start:f,end:y}),this.start=f,this.end=y;var x=this.getInitialPoint(),k=x.start,P=x.end,S={left:k.x,top:k.y,right:P.x,bottom:P.y};this.annotation.rect=S,this.setAnnotationChanged({rect:S})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(r){r!==this.contents&&(this.annotation.contents=r,this.setAnnotationChanged({contents:r}))}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(r){this.annotation.opacity=r,this.shapeEle.setAttribute("stroke-opacity",r),this.setAnnotationChanged({opacity:r})}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(r){this.shapeEle.setAttribute("fill",r||"none"),this.annotation.fillColor=r,this.setAnnotationChanged({fillColor:r})}},{key:"fillTransparency",get:function(){return this.annotation.fillTransparency},set:function(r){this.shapeEle.setAttribute("fill-opacity",r),this.annotation.fillTransparency=r,this.setAnnotationChanged({fillTransparency:r})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(r){var u=this.annotation;if(u.borderStyle!==r){if(r==="solid"&&u.borderStyle==="dashed")this.shapeEle.setAttribute("stroke-dasharray","");else if(r==="dashed"&&u.borderStyle==="solid")this.shapeEle.setAttribute("stroke-dasharray",this.getDashString());else{var s=this.createBorderStyle(r);this.shapeEle.remove(),this.shapeEle=s,this.svgElement.append(this.shapeEle)}u.borderStyle=r;var w={borderStyle:r};r==="dashed"&&(w.borderWidth=u.borderWidth,w.dashes=u.dashes||"2, 2"),r==="cloudy"&&(w.intensity=u.intensity||1),this.setAnnotationChanged(w)}}},{key:"createBorderStyle",value:function(r){var u=this.annotation,s=this.padding;r=r||u.borderStyle;var w=u.borderWidth||2,m=this.getInitialPoint(),v=m.start,g=m.end,d=Math.abs(g.x-v.x),f=Math.abs(g.y-v.y),y=s+w/2,x=s+w/2,k=null;if(r==="cloudy"){var P=[{x:y+0,y:x+0},{x:y+d-0,y:x+0},{x:y+d-0,y:x+f-0},{x:y+0,y:x+f-0}];k=createSvg("path",{d:drawPathWithArcs({Intensity:u.intensity,ur:0},P),"stroke-linejoin":"round",stroke:u.borderColor,"stroke-width":w,"stroke-opacity":u.opacity||1,fill:u.fillColor?u.fillColor:"none","fill-opacity":u.fillTransparency||1})}else k=createSvg("rect",{x:y,y:x,width:Math.max(1,d-w),height:Math.max(1,f-w),stroke:u.borderColor,"stroke-width":w,"stroke-opacity":u.opacity||1,fill:u.fillColor?u.fillColor:"none","fill-opacity":u.opacity||1,"stroke-dasharray":this.getDashString()});return k}},{key:"intensity",get:function(){return this.annotation.intensity},set:function(r){var u=this.annotation;u.intensity=r,this.setAnnotationChanged({borderStyle:u.borderStyle,intensity:r})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(r){var u=this.annotation;this.annotation.dashes=r,this.shapeEle.setAttribute("stroke-dasharray",u.borderStyle==="dashed"?this.getDashString():""),this.setAnnotationChanged({borderStyle:u.borderStyle,borderWidth:u.borderWidth,dashes:r})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(r){this.annotation.borderWidth=r;var u=this.padding,s=this.getWidth(),w=this.getHeight(),m=Math.max(5,r)+u;this.shapeEle.setAttribute("width",Math.max(1,s-r)),this.shapeEle.setAttribute("height",Math.max(1,w-r)),this.shapeEle.setAttribute("x",u+r/2),this.shapeEle.setAttribute("y",u+r/2),this.shapeEle.setAttribute("stroke-width",r),this.selectionShapeEle.setAttribute("x",m/2),this.selectionShapeEle.setAttribute("y",m/2),this.selectionShapeEle.setAttribute("stroke-width",m),this.update({start:this.start,end:this.end}),this.setAnnotationChanged({borderWidth:r})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(r){this.shapeEle.setAttribute("stroke",r),this.annotation.borderColor=r,this.setAnnotationChanged({borderColor:r})}},{key:"handlePropertyPanel",value:function(r){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var u=this.annotation,s=0;for(var w in r)for(var m in u){var v=r[w];if(m===w&&u[m]!==v){var g=u[w];if(u[w]=v,s++,w==="fillColor"&&this.shapeEle.setAttribute("fill",v||"none"),w==="fillTransparency"&&this.shapeEle.setAttribute("fill-opacity",v),w==="borderColor"&&(u.color=v,this.shapeEle.setAttribute("stroke",v)),w==="opacity"&&this.shapeEle.setAttribute("stroke-opacity",v),w==="borderWidth"){var d=this.padding,f=this.getWidth(),y=this.getHeight(),x=Math.max(5,v)+d;this.shapeEle.setAttribute("width",Math.max(1,f-v)),this.shapeEle.setAttribute("height",Math.max(1,y-v)),this.shapeEle.setAttribute("x",d+v/2),this.shapeEle.setAttribute("y",d+v/2),this.shapeEle.setAttribute("stroke-width",v),this.selectionShapeEle.setAttribute("x",x/2),this.selectionShapeEle.setAttribute("y",x/2),this.selectionShapeEle.setAttribute("stroke-width",x),this.update({start:this.start,end:this.end})}if(w==="borderStyle")if(g!=="cloudy"&&v!=="cloudy")v==="solid"&&this.shapeEle.setAttribute("stroke-dasharray",""),v==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString());else{var k=this.createBorderStyle(v);this.shapeEle.remove(),this.svgElement.append(k),this.shapeEle=k}if(w==="dashes"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),w==="intensity"){var P=u.borderWidth||2,S=this.padding,E=this.getInitialPoint(),M=E.start,T=E.end,D=Math.abs(T.x-M.x),N=Math.abs(T.y-M.y),I=S+P/2,O=S+P/2,F=[{x:I,y:O},{x:I+D,y:O},{x:I+D,y:O+N},{x:I,y:O+N}],q=drawPathWithArcs({Intensity:u.intensity,ur:0},F);this.shapeEle.setAttribute("d",q)}}}if(s>0){var Y={operate:"mod-annot",name:u.name,pageIndex:this.layer.page,pagePtr:u.pagePtr,annotPtr:u.annotPtr};r.dashes&&(Y.borderStyle=u.borderStyle,Y.borderWidth=u.borderWidth),r.borderStyle&&(Y.dashes=r.borderStyle==="solid"?"":u.dashes,Y.borderWidth=u.borderWidth),r.borderColor&&(Y.color=u.color);var _e=Object.assign({},Y,r);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_e}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var r=this.annotation.dashes||"2,2",u=this.documentViewer.scale;return r.split(",").map(function(s){return Math.ceil(s*u)}).join(", ")}}]);var o}(),Ink=function(e){function n(r){var u,s=r.annotation,w=r.documentViewer,m=r.show,v=m!==void 0&&m,g=r.enableReply,d=g===void 0||g;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:s,documentViewer:w}])).type="ink",u.enableReply=d,u.show=v,u.hidden=!0,u.initial=!1,u.start=null,u.end=null,u.rect=null,u.newStart=null,u.newEnd=null,u.svgElement=null,u.startCircle=null,u.endCircle=null,u.startState=null,u.selectionOutlinePadding=8,u.selectionOutlinePointWidth=6,u.onMousedown=u.handleMouseDown.bind(u),u.onMouseup=u.handleMouseUp.bind(u),u.onMousemove=u.handleMouseMove.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.onKeydown=u.handleKeyDown.bind(u),u.handlePropertyPanel=u.handlePropertyPanel.bind(u),u.inkPath=[],u.render(),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"formatePoint",value:function(r,u){var s=getActualPoint$1({x:r,y:u},this.documentViewer.scale);return[s.x,s.y]}},{key:"rectCalc",value:function(r){var u=r.start,s=r.end;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"calculate",value:function(r,u){var s=this.rectCalc({start:r,end:u});return{top:s.top,left:s.left,width:s.width,height:s.height}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var r;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var u=this.annotation;this.documentViewer.annotationStore.selectedElementName=u.name;var s=_objectSpread2$1({},u);delete s.annotPtr,delete s.pagePtr,delete s.operate,delete s.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",s)}(r=this.layer)===null||r===void 0||r.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var r,u,s=this.rect;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((r=this.layer)===null||r===void 0||r.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:s.left+s.width-114+"px"})):((u=this.layer)===null||u===void 0||u.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:s.left+s.width-46+"px"}))}},{key:"handleClick",value:function(r){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.layer.tool)&&!document.querySelector(".compare-document-container").contains(r==null?void 0:r.target)){this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel);var u=[this.svgElement,,this.popupElement,this.outerLine,document.querySelector(".annotation-panel")],s=document.getElementById("annotationPropertyPanelButton");s&&u.push(s);var w=document.querySelector(".toggle-button");w&&u.push(w),onClickOutside$1(u,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var r,u,s;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(r=this.outerLine)===null||r===void 0||r.removeEventListener("mousedown",this.onMousedown),(u=this.outerLine)===null||u===void 0||u.removeEventListener("touchstart",this.onMousedown),(s=this.outerLineContainer)===null||s===void 0||s.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(r){var u;if(r.button===0||r.type!=="mousedown"){(u=this.layer)!==null&&u!==void 0&&u.tool&&r.stopPropagation(),this.ratioRateX=this.rect.height/this.rect.width,this.ratioRateY=this.rect.width/this.rect.height;var s=r.target.getAttribute("data-id"),w=this.documentViewer.getScrollViewElement();this.scrollTop=w.scrollTop,this.scrollLeft=w.scrollLeft;var m=getClickPoint(r),v=m.pageX,g=m.pageY;this.startState={operator:s,clickX:v,clickY:g},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(r){if(r.button===0||r.type!=="mousemove"){r.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var u=getClickPoint(r),s=u.pageX,w=u.pageY,m=this.documentViewer,v=m.getScrollViewElement(),g=v.scrollTop;s=s+v.scrollLeft-this.scrollLeft,w=w+g-this.scrollTop;var d=this.start,f=this.end,y=this.startState,x=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,k=m.scale,P=m.getPageWidth(this.PageNumber)*k,S=m.getPageHeight(this.PageNumber)*k;if(y.operator==="nw-resize"){var E=s-(y.clickX-this.start.x),M=w-(y.clickY-this.start.y);if(E=Math.min(f.x-5,E),E=Math.max(x,E),M=Math.min(f.y-5,M),M=Math.max(x,M),(r.shiftKey||r.type==="touchmove")&&this.ratioRateX){var T=(E-this.start.x)*this.ratioRateX;if((M=this.start.y+T)<x||E<x)return}this.update({start:{x:E,y:M},end:f})}else if(y.operator==="w-resize"){var D=s-(y.clickX-this.start.x);D=Math.min(f.x-5,D),D=Math.max(x,D);var N=d.y;if((r.shiftKey||r.type==="touchmove")&&(N=Math.max(S,N),N=Math.min(f.y-5,N),this.ratioRateX)){var I=(D-this.start.x)*this.ratioRateX;if((N=this.start.y+I)>=S-x||D<x)return}this.update({start:{x:D,y:N},end:f})}else if(y.operator==="sw-resize"){var O=s-(y.clickX-this.start.x),F=w-(y.clickY-this.end.y);if(O=Math.min(f.x-5,O),O=Math.max(x,O),F=Math.min(S-x,F),F=Math.max(d.y+5,F),(r.shiftKey||r.type==="touchmove")&&this.ratioRateX){var q=(O-this.start.x)*this.ratioRateX;if((F=this.end.y-q)>=S-x||O<x)return}this.update({start:{x:O,y:d.y},end:{x:f.x,y:F}})}else if(y.operator==="s-resize"){var Y=w-(y.clickY-this.end.y);if(Y=Math.min(S-x,Y),Y=Math.max(d.y+5,Y),r.shiftKey||r.type==="touchmove"){if(this.ratioRateX){var _e=(Y-this.end.y)*this.ratioRateY,ne=this.end.x+_e;if(ne=Math.min(P,ne),ne=Math.max(d.x+5,ne),Y>=S-x||ne>=P-x)return;this.update({start:d,end:{x:ne,y:Y}})}}else this.update({start:d,end:{x:f.x,y:Y}})}else if(y.operator==="se-resize"){var ve=s-(y.clickX-this.end.x),J=w-(y.clickY-this.end.y);if(ve=Math.min(P-x,ve),ve=Math.max(d.x+5,ve),J=Math.min(S-x,J),J=Math.max(d.y+5,J),(r.shiftKey||r.type==="touchmove")&&this.ratioRateX){var fe=(this.end.x-ve)*this.ratioRateX;if((J=this.end.y-fe)>=S-x||ve>=P-x)return}this.update({start:d,end:{x:ve,y:J}})}else if(y.operator==="e-resize"){var Z=s-(y.clickX-this.end.x);if(Z=Math.min(P-x,Z),Z=Math.max(d.x+5,Z),r.shiftKey||r.type==="touchmove"){if(this.ratioRateX){var j=w-(y.clickY-this.end.y);j=Math.min(S,j),j=Math.max(d.y+5,j);var X=(this.end.x-Z)*this.ratioRateX;if((j=this.end.y-X)>=S-x||Z>=P-x)return;this.update({start:d,end:{x:Z,y:j}})}}else this.update({start:d,end:{x:Z,y:f.y}})}else if(y.operator==="ne-resize"){var H=s-(y.clickX-this.end.x),U=w-(y.clickY-this.start.y);if(H=Math.min(P-x,H),H=Math.max(d.x+5,H),U=Math.min(f.y-5,U),U=Math.max(x,U),(r.shiftKey||r.type==="touchmove")&&this.ratioRateX){var te=(this.end.x-H)*this.ratioRateX;if((U=this.start.y+te)<=x||H>=P-x)return}this.update({start:{x:d.x,y:U},end:{x:H,y:f.y}})}else if(y.operator==="n-resize"){var Q=w-(y.clickY-this.start.y);if(Q=Math.min(f.y-5,Q),Q=Math.max(x,Q),r.shiftKey||r.type==="touchmove"){if(this.ratioRateX){var re=(Q-this.start.y)*this.ratioRateY,Pe=this.end.x-re;if(Pe=Math.min(P,Pe),Pe=Math.max(d.x+5,Pe),Q>=S-x||Pe>=P-x)return;this.update({start:{x:d.x,y:Q},end:{x:Pe,y:f.y}})}}else this.update({start:{x:d.x,y:Q},end:f})}else if(y.operator==="move"){var be,we,Ae,$e,Me=this.documentViewer,Ie=this.getMouseLocation(r),Le=Me.getSelectedPage(Ie,Ie),le=this.getPageNumber();if(Le.first&&Le.first!==le){var oe,ke=Me.windowToPage(Ie,Le.first,!1),Ce=Math.abs(d.x-f.x),Ee=Math.abs(d.y-f.y);if(Me.pdfViewer.spreadMode===0&&Me.pdfViewer.scrollMode===0)be=s-(y.clickX-this.start.x),we=Le.first>le?ke.y:ke.y-Ee,Ae=s-(y.clickX-this.end.x),$e=Le.first>le?ke.y+Ee:ke.y;else if(Me.pdfViewer.spreadMode===0&&Me.pdfViewer.scrollMode===1)be=Le.first>le?ke.x:ke.x-Ce,we=w-(y.clickY-this.start.y),Ae=Le.first>le?ke.x+Ce:ke.x,$e=w-(y.clickY-this.end.y);else if(Me.pdfViewer.spreadMode===1&&Me.pdfViewer.scrollMode===0){var Be=Math.min(Le.first,le),Ve=Math.max(Le.first,le);if(Ve-Be>2||Be+1===Ve&&Be%2==0)return;Be+1===Ve?(be=Le.first>le?ke.x:ke.x-Ce,we=w-(y.clickY-this.start.y),Ae=Le.first>le?ke.x+Ce:ke.x,$e=w-(y.clickY-this.end.y)):Be+2===Ve&&(be=s-(y.clickX-this.start.x),we=Le.first>le?ke.y:ke.y-Ee,Ae=s-(y.clickX-this.end.x),$e=Le.first>le?ke.y+Ee:ke.y)}else if(Me.pdfViewer.spreadMode===2&&Me.pdfViewer.scrollMode===0){var Oe=Math.min(Le.first,le),je=Math.max(Le.first,le);if(je-Oe>2||Oe+1===je&&(Oe!==1||je!==2)&&je%2==0||Oe===1&&je===3)return;Oe+2===je||Oe===1&&je===2?(be=s-(y.clickX-this.start.x),we=Le.first>le?ke.y:ke.y-Ee,Ae=s-(y.clickX-this.end.x),$e=Le.first>le?ke.y+Ee:ke.y):Oe+1===je&&(be=Le.first>le?ke.x:ke.x-Ce,we=w-(y.clickY-this.start.y),Ae=Le.first>le?ke.x+Ce:ke.x,$e=w-(y.clickY-this.end.y))}if(!Me.pdfViewer._pages[Le.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=Le.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ge=(oe=this.layer)===null||oe===void 0?void 0:oe.div;Ge==null||Ge.append(this.annotationContainer),Ge==null||Ge.append(this.outerLineContainer)}else{be=s-(y.clickX-d.x),we=w-(y.clickY-d.y),Ae=s-(y.clickX-f.x),$e=w-(y.clickY-f.y);var Xe=Me.pageToWindow({x:be,y:we},le,!1),qe=Me.pageToWindow({x:Ae,y:$e},le,!1),Ke=0,Je=0;w>y.clickY?Je=(Je=v.offsetHeight-(qe.y-v.scrollTop-v.offsetTop))<100?5:0:w<y.clickY&&(Je=(Je=Xe.y-v.scrollTop-v.offsetTop)<100?-5:0),s>y.clickX?Ke=(Ke=v.offsetWidth-(qe.x-v.scrollLeft-v.offsetLeft))<100?5:0:s<y.clickX&&(Ke=(Ke=Xe.x-v.scrollLeft-v.offsetLeft)<100?-5:0),(Ke||Je)&&(v.scrollTop+=Je,v.scrollLeft+=Ke);var rt={width:Math.abs(d.x-f.x),height:Math.abs(d.y-f.y)};be<Ae?(be=Math.max(x,be),be=Math.min(P-rt.width-x,be),Ae=Math.max(rt.width+x,Ae),Ae=Math.min(P-x,Ae)):(Ae=Math.max(x,Ae),Ae=Math.min(P-rt.width-x,Ae),be=Math.max(rt.width+x,be),be=Math.min(P-x,be)),we<$e?(we=Math.max(x,we),we=Math.min(S-rt.height-x,we),$e=Math.max(rt.height+x,$e),$e=Math.min(S-x,$e)):($e=Math.max(x,$e),$e=Math.min(S-rt.height-x,$e),we=Math.max(rt.height+x,we),we=Math.min(S-x,we))}this.update({start:{x:be,y:we},end:{x:Ae,y:$e}})}y.clickX=s,y.clickY=w}}},{key:"handleDelete",value:function(r){this.layer&&this.layer.tool&&r&&r.stopPropagation(),this.delete();var u={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(u.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",u),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var r,u;this.handleOutside(),(r=this.annotationContainer)===null||r===void 0||r.remove(),this.annotation.isDelete=!0,(u=this.layer)===null||u===void 0||u.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleKeyDown",value:function(r){}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y,x,k,P,S,E,M;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(u.button===0||u.type!=="mouseup"){T.next=2;break}return T.abrupt("return");case 2:if((s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,this.startState=null,w=this.documentViewer.scale,m=getInitialPoint$1(this.start,w),v=getInitialPoint$1(this.end,w),g={left:m.x,top:m.y,right:v.x,bottom:v.y},d=this.annotation,g!==d.rect||this.PrePageNumber!==this.PageNumber){T.next=19;break}return T.abrupt("return");case 19:for(d.rect=g,f=[],y=0;y<this.inkPath.length;y++){for(x=[],k=0;k<this.inkPath[y].length;k++)x.push({PointX:this.inkPath[y][k].x+m.x,PointY:m.y+this.inkPath[y][k].y});f.push(x)}if(d.inkPointes=f,this.PrePageNumber===this.PageNumber){T.next=46;break}return P={type:"delete",annotation:{operate:"del-annot",name:d.name,pageIndex:d.pageIndex,annotPtr:d.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",P),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(S=Object.assign({},d)).annotPtr,delete S.pagePtr,delete S.name,S.operate="add-annot",S.pageIndex=this.PageNumber-1,T.next=36,this.documentViewer.annotationManager.createAnnotation(S);case 36:return E=T.sent,M=new n({annotation:E,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),T.next=41,this.documentViewer.annotationManager.addAnnotation(M);case 41:this.documentViewer.annotationManager.drawAnnotationsFromList(M),this.annotationContainer.remove(),this.outerLineContainer.remove(),T.next=48;break;case 46:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,inkPointes:f,rect:g}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 48:case"end":return T.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"handlePoint",value:function(r){var u=this.rect,s=getInitialPoint$1({x:r[0]+u.left,y:r[1]+u.top},this.documentViewer.scale);return s.x+","+s.y}},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var r=this.annotation.rect,u=r.left,s=r.top,w=r.right,m=r.bottom;u=parseFloat(u*this.documentViewer.scale),m=parseFloat(m*this.documentViewer.scale),w=parseFloat(w*this.documentViewer.scale);var v={left:u,top:s=parseFloat(s*this.documentViewer.scale),bottom:m,right:w,width:w-u,height:m-s};this.rect=v,this.start={x:v.left,y:v.top},this.end={x:v.right,y:v.bottom},this.update({start:this.start,end:this.end})}}},{key:"update",value:function(r){var u=r.start,s=r.end,w=this.calculate(u,s);if(this.startState&&this.startState.operator!=="move")for(var m=w.width/this.rect.width,v=w.height/this.rect.height,g=0;g<this.inkPath.length;g++)for(var d=0;d<this.inkPath[g].length;d++)this.inkPath[g][d].x=m*this.inkPath[g][d].x,this.inkPath[g][d].y=v*this.inkPath[g][d].y;this.rect=w,this.start=u,this.end=s;var f=this.annotation,y=this.annotation.borderWidth*this.documentViewer.scale,x=this.documentViewer.scale,k=f.borderWidth||2,P=this.padding,S=getInitialPoint$1(u,x),E=getInitialPoint$1(s,x),M=Math.abs(E.x-S.x),T=Math.abs(E.y-S.y),D=this.annotationContainer.style;D.top="calc(var(--scale-factor) * ".concat(S.y-P,"px)"),D.left="calc(var(--scale-factor) * ".concat(S.x-P,"px)"),D.width="calc(var(--scale-factor) * ".concat(M+2*P,"px)"),D.height="calc(var(--scale-factor) * ".concat(T+2*P,"px)"),this.svgElement.innerHTML="",this.svgElement.style.width=M+2*P+"px",this.svgElement.style.height=T+2*P+"px";for(var N=0;N<this.inkPath.length;N++)if(this.inkPath[N].length>1){for(var I=document.createElementNS("http://www.w3.org/2000/svg","path"),O="M "+(this.inkPath[N][0].x+P+k/2).toFixed(2)+" "+(this.inkPath[N][0].y+P+k/2).toFixed(2),F=1;F<this.inkPath[N].length;F++)O=O+" L "+(this.inkPath[N][F].x+P+k/2).toFixed(2)+" "+(this.inkPath[N][F].y+P+k/2).toFixed(2);if(I.setAttribute("d",O),I.setAttribute("stroke",f.borderColor),I.setAttribute("stroke-width",f.borderWidth),I.setAttribute("stroke-opacity",f.opacity||1),I.setAttribute("fill","none"),I.setAttribute("fill-opacity",0),y<5){var q=document.createElementNS("http://www.w3.org/2000/svg","path");q.setAttribute("d",O),q.setAttribute("stroke",f.borderColor),q.setAttribute("stroke-width",y+8*this.documentViewer.scale),q.setAttribute("stroke-opacity",0),q.setAttribute("fill","none"),q.setAttribute("fill-opacity",0),I.style.pointerEvents="none",this.svgElement.append(q)}this.svgElement.append(I)}else if(this.inkPath[N].length==1){var Y=document.createElementNS("http://www.w3.org/2000/svg","circle");Y.setAttribute("cx",this.inkPath[N][0].x.toFixed(2)),Y.setAttribute("cy",this.inkPath[N][0].y.toFixed(2)),Y.setAttribute("r",f.borderWidth/2),Y.setAttribute("fill",f.borderColor),this.svgElement.append(Y)}var _e=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2;this.outerLine.style.left="".concat(w.left-_e,"px"),this.outerLine.style.top="".concat(w.top-_e,"px"),this.outerLine.style.width="".concat(w.width+2*_e,"px"),this.outerLine.style.height="".concat(w.height+2*_e,"px"),this.popupElement.style.left=w.left+w.width-114+"px",this.popupElement.style.top=w.top+w.height+12+"px",this.moveRect.setAttribute("width",w.width+this.selectionOutlinePadding),this.moveRect.setAttribute("height",w.height+this.selectionOutlinePadding),this.LeftRect.setAttribute("y",(w.height+this.selectionOutlinePadding)/2),this.bottomLeftRect.setAttribute("y",w.height+this.selectionOutlinePadding),this.bottomRect.setAttribute("x",(w.width+this.selectionOutlinePadding)/2),this.bottomRect.setAttribute("y",w.height+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("x",w.width+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("y",w.height+this.selectionOutlinePadding),this.rightRect.setAttribute("x",w.width+this.selectionOutlinePadding),this.rightRect.setAttribute("y",(w.height+this.selectionOutlinePadding)/2),this.topRightRect.setAttribute("x",w.width+this.selectionOutlinePadding),this.topRect.setAttribute("x",(w.width+this.selectionOutlinePadding)/2)}},{key:"render",value:function(){var r=this.annotation,u=r.rect,s=u.left,w=u.top,m=u.right,v=u.bottom;s=parseFloat(s*this.documentViewer.scale),v=parseFloat(v*this.documentViewer.scale),m=parseFloat(m*this.documentViewer.scale);var g={left:s,top:w=parseFloat(w*this.documentViewer.scale),bottom:v,right:m,width:m-s,height:v-w};this.rect=g,this.start={x:g.left,y:g.top},this.end={x:g.right,y:g.bottom},r.borderColor||(r.borderColor="#000000");for(var d=r.inkPointes,f=0;f<d.length;f++){for(var y=d[f],x=[],k=0;k<y.length;k++){var P=y[k],S=[parseFloat(P.PointX),parseFloat(P.PointY)];x.push({x:parseFloat(S[0].toFixed(2))-r.rect.left,y:parseFloat(S[1].toFixed(2))-r.rect.top})}x.length>0&&this.inkPath.push(x)}var E=this.annotation.borderWidth*this.documentViewer.scale,M=this.padding,T=r.borderWidth||2,D=this.getWidth(),N=this.getHeight(),I=document.createElement("div");I.id=r.name,I.className="annotation",I.style.top="calc(var(--scale-factor) * ".concat(r.rect.top-M,"px)"),I.style.left="calc(var(--scale-factor) * ".concat(r.rect.left-M,"px)"),I.style.width="calc(var(--scale-factor) * ".concat(D+2*M,"px)"),I.style.height="calc(var(--scale-factor) * ".concat(N+2*M,"px)"),this.annotationContainer=I,this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg");var O=this.svgElement.style;O.width=D+2*M+"px",O.height=N+2*M+"px",O.transform="scale(var(--scale-factor))",O.transformOrigin="left top",this.svgElement.addEventListener("mousedown",this.handleClick.bind(this));for(var F=0;F<this.inkPath.length;F++)if(this.inkPath[F].length>1){for(var q=document.createElementNS("http://www.w3.org/2000/svg","path"),Y="M "+(this.inkPath[F][0].x+M+T/2).toFixed(2)+" "+(this.inkPath[F][0].y+M+T/2).toFixed(2),_e=1;_e<this.inkPath[F].length;_e++)Y=Y+" L "+(this.inkPath[F][_e].x+M+T/2).toFixed(2)+" "+(this.inkPath[F][_e].y+M+T/2).toFixed(2);if(q.setAttribute("d",Y),q.setAttribute("stroke",r.borderColor),q.setAttribute("stroke-width",r.borderWidth),q.setAttribute("stroke-opacity",r.opacity||1),q.setAttribute("fill","none"),q.setAttribute("fill-opacity",0),E<5){var ne=document.createElementNS("http://www.w3.org/2000/svg","path");ne.setAttribute("d",Y),ne.setAttribute("stroke",r.borderColor),ne.setAttribute("stroke-width",E+8*this.documentViewer.scale),ne.setAttribute("stroke-opacity",0),ne.setAttribute("fill","none"),ne.setAttribute("fill-opacity",0),q.style.pointerEvents="none",this.svgElement.append(ne)}this.svgElement.append(q)}else if(this.inkPath[F].length==1){var ve=document.createElementNS("http://www.w3.org/2000/svg","circle");ve.setAttribute("cx",this.inkPath[F][0].x.toFixed(2)),ve.setAttribute("cy",this.inkPath[F][0].y.toFixed(2)),ve.setAttribute("r",r.borderWidth/2),ve.setAttribute("fill",r.borderColor),this.svgElement.append(ve)}this.annotationContainer.append(this.svgElement),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:g.left+g.width-114+"px",top:g.top+g.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr;var J=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2;this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(g.left-J,"px"),top:"".concat(g.top-J,"px"),width:"".concat(g.width+2*J,"px"),height:"".concat(g.height+2*J,"px"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"fill-opacity":0,width:g.width+this.selectionOutlinePadding,height:g.height+this.selectionOutlinePadding,x:this.selectionOutlinePointWidth/2,y:this.selectionOutlinePointWidth/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:0}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:(g.height+this.selectionOutlinePadding)/2}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:g.height+this.selectionOutlinePadding}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(g.width+this.selectionOutlinePadding)/2,y:g.height+this.selectionOutlinePadding}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:g.width+this.selectionOutlinePadding,y:g.height+this.selectionOutlinePadding}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:g.width+this.selectionOutlinePadding,y:(g.height+this.selectionOutlinePadding)/2}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:g.width+this.selectionOutlinePadding,y:0}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(g.width+this.selectionOutlinePadding)/2,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"ink",operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(r){var u=this.documentViewer.scale,s=getActualPoint$1({x:r.x1,y:r.y1},u),w=getActualPoint$1({x:r.x2,y:r.y2},u),m=getInitialPoint$1(s,u),v=getInitialPoint$1(w,u),g={left:m.x,top:m.y,right:v.x,bottom:v.y};this.annotation.rect=g,this.setAnnotationChanged({rect:g})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(r){r!==this.contents&&(this.annotation.contents=r,this.setAnnotationChanged({contents:r}))}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(r){this.annotation.opacity=r,this.update({start:this.start,end:this.end}),this.setAnnotationChanged({opacity:r})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(r){this.annotation.borderWidth=r,this.update({start:this.start,end:this.end}),this.setAnnotationChanged({borderWidth:r})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(r){this.annotation.borderColor=r,this.update({start:this.start,end:this.end}),this.setAnnotationChanged({borderColor:r})}},{key:"handlePropertyPanel",value:function(r){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var u=this.annotation,s=0;for(var w in r)for(var m in u){var v=r[w];m===w&&u[m]!==v&&(u[w]=v,s++,["borderColor","borderWidth","opacity"].includes(w)&&this.update({start:this.start,end:this.end}))}if(s>0){var g={operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr};r.borderColor&&(g.borderColor=u.borderColor);var d=Object.assign({},g,r);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:d}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}}]);var o}(),Freetext$1=function(e){function n(r){var u,s=r.annotation,w=s===void 0?null:s,m=r.documentViewer,v=r.show,g=v!==void 0&&v,d=r.enableReply,f=d===void 0||d;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:w,documentViewer:m}])).type="freetext",u.enableReply=f,u.hidden=!0,u.initial=!1,u.leftTop=null,u.rightBottom=null,u.newLeftTop=null,u.newRightBottom=null,u.startCircle=null,u.endCircle=null,u.show=g,u.editing=!1,u.lastClickTime=null,u.onContainerClick=u.handleContainerClick.bind(u),u.onMousedown=u.handleMouseDown.bind(u),u.onMousemove=u.handleMouseMove.bind(u),u.onMouseup=u.handleMouseUp.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.onBlur=u.handleFreetextEditElementBlur.bind(u),u.onSingleClick=u.onSingleClick.bind(u),u.onDbclick=u.handleElementDbClick.bind(u),u.handleStopPropagation=u.handleStopPropagation.bind(u),u.onPaste=u.handleFreetextEditElementPaste.bind(u),u.render(),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"setCss",value:function(r,u){if(r&&u)for(var s in u)r.style[s]=u[s]}},{key:"render",value:function(){var r=this.documentViewer,u=r.scale,s=r.getPageWidth(this.PageNumber)*u,w=r.getPageHeight(this.PageNumber)*u,m=this.annotation,v=this.getActualRect(u),g=v.leftTop,d=v.rightBottom;this.initialRect={width:Math.abs(g.x-d.x),height:Math.abs(g.y-d.y)},this.leftTop=g,this.rightBottom=d;var f=this.calculate(this.leftTop,this.rightBottom);m.color||(m.color="#000000"),m.fontSize||(m.fontSize=16),m.fontWeight||(m.fontWeight="normal"),m.fontStyle||(m.fontStyle="normal");var y=document.createElement("div");y.className="annotation",this.setCss(y,{top:f.top-2+"px",left:f.left-4+"px"}),this.annotationContainer=y;var x=document.createElement("div");x.setAttribute("role","textbox"),x.setAttribute("contenteditable",!0),x.setAttribute("spellcheck",!1),x.className="freetext";var k=s-this.leftTop.x,P=w-this.leftTop.y,S=m.textAlignment||"left";this.setCss(x,{maxWidth:k+"px",maxHeight:P+"px",width:f.width+"px",height:f.height+"px",fontSize:m.fontSize*u+"px",lineHeight:"1.2em",fontFamily:m.fontName,fontWeight:m.fontWeight,fontStyle:m.fontStyle,color:m.color,opacity:m.opacity,textAlign:S,verticalAlign:"bottom",borderWidth:(m.borderWidth||0)+"px",borderColor:m.borderColor?m.borderColor:"#000000",borderStyle:m.borderStyle?m.borderStyle:"solid",overflow:"auto",backgroundColor:m.fillColor?m.fillColor:"transparent","-webkit-user-select":"text"}),this.freetextEditElement=x;var E=document.createElement("div");if(E.className="freetext",this.setCss(E,{width:f.width+"px",height:f.height+"px",fontFamily:m.fontName,fontWeight:m.fontWeight,fontStyle:m.fontStyle,opacity:m.opacity,lineHeight:"1.2em",color:m.color,fontSize:m.fontSize*u+"px",textAlign:S,verticalAlign:"bottom",borderWidth:(m.borderWidth||0)+"px",borderColor:m.borderColor?m.borderColor:"#000000",borderStyle:m.borderStyle?m.borderStyle:"solid",overflow:"hidden",backgroundColor:m.fillColor?m.fillColor:"transparent"}),m.contents)E.innerHTML=m.contents,x.innerHTML=m.contents;else if(m["contents-richtext"]){var M=new window.DOMParser().parseFromString(m["contents-richtext"],"text/xml");M.getElementsByTagName("parsererror").length>0?(E.innerHTML=m["contents-richtext"],x.innerHTML=m["contents-richtext"]):(E.innerHTML=M.firstElementChild.innerText,x.innerHTML=M.firstElementChild.innerText)}this.freetextElement=E,this.appendOrRemoveFreetextElement("append"),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container";var T=createSvg("svg",null,{position:"absolute",zIndex:1,left:"".concat(f.left-12,"px"),top:"".concat(f.top-9,"px"),width:"".concat(f.width+16,"px"),height:"".concat(f.height+15,"px")});this.outerLine=T,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"fill-opacity":0,width:f.width+10,height:f.height+9,x:3,y:3}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:0,y:0}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:0,y:f.height/2+4}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:0,y:f.height+9}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:f.width/2+5,y:f.height+9}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:f.width+10,y:f.height+9}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:f.width+10,y:f.height/2+4}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:f.width+10,y:0}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#1460F3",stroke:"none",width:6,height:6,x:f.width/2+5,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.handleElementSelect(),this.show=!1}},{key:"handleElementDbClick",value:function(r){r&&r.stopPropagation(),r&&r.preventDefault(),this.freetextEditElement&&(this.outerLine.removeEventListener("mousedown",this.onMousedown),this.outerLine.removeEventListener("touchstart",this.onMousedown),this.outerLine.removeEventListener("dblclick",this.onDbclick),this.outerLine.removeEventListener("dblclick",this.onSingleClick),this.outerLineContainer.remove(),this.appendOrRemoveFreetextElement("remove"),this.appendOrRemoveFreetextEditElement("append"),this.editing=!0)}},{key:"getFreetextRectPoint",value:function(){var r=this.freetextEditElement.getBoundingClientRect(),u=r.width,s=r.height,w=this.leftTop,m=w.x+u,v=w.y+s,g=m>this.rightBottom.x?m:this.rightBottom.x,d=v>this.rightBottom.y?v:this.rightBottom.y;this.rightBottom={x:g,y:d}}},{key:"getFreetextRect",value:function(){var r=this.documentViewer.scale;this.getFreetextRectPoint();var u=getInitialPoint$1(this.leftTop,r),s=getInitialPoint$1(this.rightBottom,r);return{left:u.x,top:u.y,right:s.x,bottom:s.y}}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"freetext",operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(r){var u=this.annotation;this.annotation.fontName!==r&&(this.setCss(this.freetextEditElement,{fontFamily:r}),this.setCss(this.freetextElement,{fontFamily:r}),this.annotation.fontName=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:r,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(r){var u=this.annotation;r!==u.fontStyle&&(this.setCss(this.freetextEditElement,{fontStyle:r}),this.setCss(this.freetextElement,{fontStyle:r}),this.annotation.fontStyle=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:r,fontSize:u.fontSize,color:u.color}))}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(r){var u=this.annotation;r!==u.fontWeight&&(this.setCss(this.freetextEditElement,{fontWeight:r}),this.setCss(this.freetextElement,{fontWeight:r}),this.annotation.fontWeight=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:r,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(r){var u=this.annotation;if(u.fontSize!==r){var s=this.documentViewer.scale;this.setCss(this.freetextEditElement,{fontSize:r*s+"px"}),this.setCss(this.freetextElement,{fontSize:r*s+"px"}),u.fontSize=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:r,color:u.color})}}},{key:"textAlignment",get:function(){return this.annotation.textAlignment},set:function(r){var u=this.annotation;u.textAlignment!==r&&(this.setCss(this.freetextEditElement,{textAlign:r}),this.setCss(this.freetextElement,{textAlign:r}),u.textAlignment=r,this.setAnnotationChanged({contents:u.contents,textAlignment:r,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"color",get:function(){return this.annotation.color},set:function(r){var u=this.annotation;u.color!==r&&(this.setCss(this.freetextEditElement,{color:r}),this.setCss(this.freetextElement,{color:r}),u.color=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:r}))}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(r){var u=this.annotation;r==="solid"?this.shapeEle.setAttribute("stroke-dasharray",""):r==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),u.borderStyle=r,this.setAnnotationChanged({borderStyle:r,borderWidth:u.borderWidth,dashes:u.dashes||"2, 2"})}},{key:"dashes",get:function(){return this.annotation.borderStyle},set:function(r){var u=this.annotation;u.dashes=r;var s=this.getDashString();u.borderStyle==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",s),this.setAnnotationChanged({borderStyle:u.borderStyle,borderWidth:u.borderWidth,dashes:r})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(r){var u=this.annotation;u.borderWidth!==r&&(this.setCss(this.freetextEditElement,{borderWidth:r+"px",borderColor:u.borderColor?u.borderColor:"#000000",borderStyle:u.borderStyle?u.borderStyle:"solid"}),this.setCss(this.freetextElement,{borderWidth:r+"px",borderColor:u.borderColor?u.borderColor:"#000000",borderStyle:u.borderStyle?u.borderStyle:"solid"}),u.borderWidth=r,this.setAnnotationChanged({borderWidth:r}))}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(r){var u=this.annotation;u.borderColor!==r&&(this.setCss(this.freetextEditElement,{borderColor:r}),this.setCss(this.freetextElement,{borderColor:r}),u.borderColor=r,this.setAnnotationChanged({borderColor:r}))}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(r){var u=this.annotation;u.fillColor!==r&&(this.setCss(this.freetextEditElement,{backgroundColor:r&&r!=="transparent"?r:"transparent"}),this.setCss(this.freetextElement,{backgroundColor:r&&r!=="transparent"?r:"transparent"}),u.fillColor=r,this.setAnnotationChanged({fillColor:r}))}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(r){var u=this.annotation;u.opacity!==r&&(this.setCss(this.freetextEditElement,{opacity:r}),this.setCss(this.freetextElement,{opacity:r}),u.opacity=r,this.setAnnotationChanged({opacity:r}))}},{key:"contents",get:function(){return this.annotation.contents},set:function(r){this.setContents(r)}},{key:"setContents",value:function(r){var u=this.annotation;r!==u.contents&&(u.contents=r,this.freetextElement.innerHTML=u.contents,this.freetextEditElement.innerHTML=u.contents,this.setAnnotationChanged({contents:r,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"handleFreetextEditElementBlur",value:function(){var r=this.freetextEditElement;if(r&&r.innerText!==this.annotation.contents){var u=this.getFreetextRect(),s=this.annotation,w=getHtmlToText(r);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{type:"freetext",operate:"mod-annot",name:s.name,pageIndex:this.PageNumber-1,pagePtr:s.pagePtr,annotPtr:s.annotPtr,contents:w,rect:u,textAlignment:s.textAlignment,fontName:s.fontName,fontWeight:s.fontWeight,fontStyle:s.fontStyle,fontSize:s.fontSize,color:s.color}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.update({leftTop:this.leftTop,rightBottom:this.rightBottom}),this.annotation.contents=w,this.freetextElement.innerText=w}this.appendOrRemoveFreetextEditElement("remove"),this.appendOrRemoveFreetextElement("append"),this.handleContainerClick(),this.editing=!1}},{key:"appendOrRemoveFreetextElement",value:function(r){var u=this.freetextElement;r==="append"?(u.addEventListener("mousedown",this.onContainerClick),this.annotationContainer.append(u)):(u.removeEventListener("mousedown",this.onContainerClick),u.remove())}},{key:"appendOrRemoveFreetextEditElement",value:function(r){var u=this.freetextEditElement;r==="append"?(u.addEventListener("blur",this.onBlur),u.addEventListener("click",this.handleStopPropagation),u.addEventListener("paste",this.onPaste),this.annotationContainer.append(u),u.focus(),keepLastIndex(u)):(u.removeEventListener("blur",this.onBlur),u.removeEventListener("click",this.handleStopPropagation),u.removeEventListener("paste",this.onPaste),u.remove())}},{key:"handleElementSelect",value:function(){this.hidden=!1,this.show&&this.updateTool();var r=[this.freetextElement,this.outerLine,document.querySelector(".toggle-button"),document.querySelector(".sidebar-style"),document.querySelector(".freetext-panel")],u=document.querySelector(".freetext-popup");u&&r.push(u),onClickOutside$1(r,this.handleOutside.bind(this))}},{key:"getActualRect",value:function(r){var u=this.annotation.rect,s=u.left,w=u.top,m=u.right,v=u.bottom,g=getActualPoint$1({x:s,y:w},r),d=getActualPoint$1({x:m,y:v},r);return{leftTop:{x:Math.min(g.x,d.x),y:Math.min(g.y,d.y)},rightBottom:{x:Math.max(g.x,d.x),y:Math.max(g.y,d.y)}}}},{key:"rectCalc",value:function(r){var u=r.leftTop,s=r.rightBottom;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"calculate",value:function(r,u){var s=this.rectCalc({leftTop:r,rightBottom:u});return{top:s.top,left:s.left,width:s.width,height:s.height}}},{key:"getInitialPoint",value:function(){var r=this.leftTop.x,u=this.leftTop.y,s=this.rightBottom.x,w=this.rightBottom.y,m=this.documentViewer.scale;return{leftTop:{x:r/m,y:u/m},rightBottom:{x:s/m,y:w/m}}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleContainerClick()}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.outerLineContainer.remove(),this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null);else{var r;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var u=this.annotation;this.documentViewer.annotationStore.selectedElementName=u.name;var s=_objectSpread2$1({},u);delete s.annotPtr,delete s.pagePtr,delete s.operate,delete s.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",s),this.documentViewer.eventBus.dispatch("annotationSelectedAttr",this)}(r=this.layer)===null||r===void 0||r.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("dblclick",this.onDbclick),this.outerLine.addEventListener("click",this.onSingleClick),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"onSingleClick",value:function(r){var u=new Date().getTime();u-this.lastClickTime<300&&this.onDbclick(),this.lastClickTime=u}},{key:"handleContainerClick",value:function(r){if(this.layer){var u,s;if(this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(u=this.layer)===null||u===void 0||u.div.classList.remove("no-edit"):(s=this.layer)===null||s===void 0||s.div.classList.add("no-edit"),!(!this.hidden||this.layer.addMode||this.documentViewer.annotationStore.creating||["redaction","remove"].includes(this.layer.tool)||document.querySelector(".compare-document-container").contains(r==null?void 0:r.target))){this.hidden=!1,this.updateTool();var w=[this.freetextElement,this.outerLine,document.querySelector(".toggle-button"),document.querySelector(".sidebar-style"),document.querySelector(".freetext-panel")],m=document.querySelector(".freetext-popup");m&&w.push(m),onClickOutside$1(w,this.handleOutside.bind(this))}}}},{key:"handleOutside",value:function(){var r,u,s,w,m;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(r=this.outerLine)===null||r===void 0||r.removeEventListener("mousedown",this.onMousedown),(u=this.outerLine)===null||u===void 0||u.removeEventListener("touchstart",this.onMousedown),(s=this.outerLine)===null||s===void 0||s.removeEventListener("dblclick",this.onDbclick),(w=this.outerLine)===null||w===void 0||w.addEventListener("click",this.onSingleClick),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto"}},{key:"handleStopPropagation",value:function(r){r.stopPropagation()}},{key:"handleMouseDown",value:function(r){var u;if(r.button===0||r.type!=="mousedown"){(u=this.layer)!==null&&u!==void 0&&u.tool&&r.stopPropagation();var s=r.target.getAttribute("data-id"),w=this.documentViewer.getScrollViewElement();this.scrollTop=w.scrollTop,this.scrollLeft=w.scrollLeft;var m=getClickPoint(r),v=m.pageX,g=m.pageY;this.startState={operator:s,clickX:v,clickY:g},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(r){if(r.button===0||r.type!=="mousemove"){r.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var u=getClickPoint(r),s=u.pageX,w=u.pageY,m=this.documentViewer,v=m.getScrollViewElement(),g=v.scrollTop;s=s+v.scrollLeft-this.scrollLeft,w=w+g-this.scrollTop;var d=this.leftTop,f=this.rightBottom,y=this.startState,x=this.documentViewer.scale,k=m.getPageWidth(this.PageNumber)*x,P=m.getPageHeight(this.PageNumber)*x,S=10,E=10;if(y.operator==="nw-resize"){var M=s-(y.clickX-d.x),T=w-(y.clickY-d.y);M=Math.min(f.x-S,M),M=Math.max(12,M),T=Math.min(f.y-E,T),T=Math.max(9,T),this.update({leftTop:{x:M,y:T},rightBottom:f})}else if(y.operator==="w-resize"){var D=s-(y.clickX-d.x);D=Math.min(f.x-S,D),D=Math.max(12,D),this.update({leftTop:{x:D,y:d.y},rightBottom:f})}else if(y.operator==="sw-resize"){var N=s-(y.clickX-d.x),I=w-(y.clickY-f.y);N=Math.min(f.x-S,N),N=Math.max(12,N),I=Math.min(P-6,I),I=Math.max(d.y+E,I),this.update({leftTop:{x:N,y:d.y},rightBottom:{x:f.x,y:I}})}else if(y.operator==="s-resize"){var O=w-(y.clickY-f.y);O=Math.min(P-6,O),O=Math.max(d.y+E,O),this.update({leftTop:d,rightBottom:{x:f.x,y:O}})}else if(y.operator==="se-resize"){var F=s-(y.clickX-f.x),q=w-(y.clickY-f.y);F=Math.min(k-4,F),F=Math.max(d.x+S,F),q=Math.min(P-6,q),q=Math.max(d.y+E,q),this.update({leftTop:d,rightBottom:{x:F,y:q}})}else if(y.operator==="e-resize"){var Y=s-(y.clickX-f.x);Y=Math.min(k-4,Y),Y=Math.max(d.x+S,Y),this.update({leftTop:d,rightBottom:{x:Y,y:f.y}})}else if(y.operator==="ne-resize"){var _e=s-(y.clickX-f.x),ne=w-(y.clickY-d.y);_e=Math.min(k-4,_e),_e=Math.max(d.x+S,_e),ne=Math.min(f.y-E,ne),ne=Math.max(9,ne),this.update({leftTop:{x:d.x,y:ne},rightBottom:{x:_e,y:f.y}})}else if(y.operator==="n-resize"){var ve=w-(y.clickY-d.y);ve=Math.min(f.y-E,ve),ve=Math.max(9,ve),this.update({leftTop:{x:d.x,y:ve},rightBottom:f})}else if(y.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(r),U=X.getSelectedPage(H,H),te=this.getPageNumber();if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(d.x-f.x),be=Math.abs(d.y-f.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=s-(y.clickX-d.x),fe=U.first>te?re.y:re.y-be,Z=s-(y.clickX-f.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=w-(y.clickY-d.y),Z=U.first>te?re.x+Pe:re.x,j=w-(y.clickY-f.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=w-(y.clickY-d.y),Z=U.first>te?re.x+Pe:re.x,j=w-(y.clickY-f.y)):we+2===Ae&&(J=s-(y.clickX-d.x),fe=U.first>te?re.y:re.y-be,Z=s-(y.clickX-f.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=s-(y.clickX-d.x),fe=U.first>te?re.y:re.y-be,Z=s-(y.clickX-f.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=w-(y.clickY-d.y),Z=U.first>te?re.x+Pe:re.x,j=w-(y.clickY-f.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=s-(y.clickX-d.x),fe=w-(y.clickY-d.y),Z=s-(y.clickX-f.x),j=w-(y.clickY-f.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;w>y.clickY?ke=(ke=v.offsetHeight-(le.y-v.scrollTop-v.offsetTop))<100?5:0:w<y.clickY&&(ke=(ke=Le.y-v.scrollTop-v.offsetTop)<100?-5:0),s>y.clickX?oe=(oe=v.offsetWidth-(le.x-v.scrollLeft-v.offsetLeft))<100?5:0:s<y.clickX&&(oe=(oe=Le.x-v.scrollLeft-v.offsetLeft)<100?-5:0),(oe||ke)&&(v.scrollTop+=ke,v.scrollLeft+=oe);var Ce={width:Math.abs(J-Z),height:Math.abs(j-fe)};J<Z?(J=Math.max(12,J),J=Math.min(k-Ce.width-4,J),Z=Math.max(Ce.width+12,Z),Z=Math.min(k-4,Z)):(Z=Math.max(4,Z),Z=Math.min(k-Ce.width-12,Z),J=Math.max(Ce.width+4,J),J=Math.min(k-12,J)),j<fe?(j=Math.max(6,j),j=Math.min(P-Ce.height-9,j),fe=Math.max(Ce.height+6,fe),fe=Math.min(P-9,fe)):(fe=Math.max(9,fe),fe=Math.min(P-Ce.height-6,fe),j=Math.max(Ce.height+9,j),j=Math.min(P-6,j))}this.update({leftTop:{x:J,y:fe},rightBottom:{x:Z,y:j}})}y.clickX=s,y.clickY=w;var Ee=this.getInitialPoint();this.documentViewer.eventBus.dispatch("mouseMoving",{rect:{left:Ee.leftTop.x,top:Ee.leftTop.y,right:Ee.rightBottom.x,bottom:Ee.rightBottom.y},pageNumber:this.annotation.pageIndex+1})}}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(u.button===0||u.type!=="mouseup"){P.next=2;break}return P.abrupt("return");case 2:if((s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,w=this.annotation,m=this.getInitialPoint(),v=m.leftTop,g=m.rightBottom,(d={left:v.x,top:v.y,right:g.x,bottom:g.y})!==w.rect||this.PrePageNumber!==this.PageNumber){P.next=16;break}return P.abrupt("return");case 16:if(w.rect=d,this.PrePageNumber===this.PageNumber){P.next=39;break}return f={type:"delete",annotation:{operate:"del-annot",name:w.name,pageIndex:w.pageIndex,annotPtr:w.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(y=Object.assign({},w)).annotPtr,delete y.pagePtr,delete y.name,y.operate="add-annot",y.pageIndex=this.PageNumber-1,P.next=30,this.documentViewer.annotationManager.createAnnotation(y);case 30:x=P.sent,k=new n({annotation:x,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),this.documentViewer.annotationManager.addAnnotation(k),this.documentViewer.annotationManager.drawAnnotationsFromList(k),this.annotationContainer.remove(),this.outerLineContainer.remove(),P.next=41;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{type:"freetext",operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:d}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 41:case"end":return P.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var r=this.getActualRect(this.documentViewer.scale),u=r.leftTop,s=r.rightBottom;this.update({leftTop:u,rightBottom:s})}}},{key:"update",value:function(r){var u=r.leftTop,s=r.rightBottom,w=this.layer.viewport,m=w.width,v=w.height,g=this.calculate(u,s);this.leftTop=u,this.rightBottom=s,this.setCss(this.annotationContainer,{top:g.top-2+"px",left:g.left-4+"px"});var d=m-u.x,f=v-u.y,y=this.annotation.fontSize*this.documentViewer.scale;this.setCss(this.freetextEditElement,{maxWidth:d+"px",maxHeight:f+"px",width:g.width+"px",height:g.height+"px",fontSize:y+"px"}),this.setCss(this.freetextElement,{width:g.width+"px",height:g.height+"px",fontSize:y+"px"}),this.setCss(this.outerLine,{left:"".concat(g.left-12,"px"),top:"".concat(g.top-9,"px"),width:"".concat(g.width+16,"px"),height:"".concat(g.height+15,"px")}),this.moveRect.setAttribute("width",g.width+10),this.moveRect.setAttribute("height",g.height+9),this.LeftRect.setAttribute("y",g.height/2+4),this.bottomLeftRect.setAttribute("y",g.height+9),this.bottomRect.setAttribute("x",g.width/2+5),this.bottomRect.setAttribute("y",g.height+9),this.bottomRightRect.setAttribute("x",g.width+10),this.bottomRightRect.setAttribute("y",g.height+9),this.rightRect.setAttribute("x",g.width+10),this.rightRect.setAttribute("y",g.height/2+4),this.topRightRect.setAttribute("x",g.width+10),this.topRect.setAttribute("x",g.width/2+5)}},{key:"handleDelete",value:function(r){if(!this.editing){this.layer&&this.layer.tool&&r&&r.stopPropagation(),this.delete();var u={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(u.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",u),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}}},{key:"delete",value:function(){var r,u;this.handleOutside(),(r=this.annotationContainer)===null||r===void 0||r.remove(),this.annotation.isDelete=!0,(u=this.layer)===null||u===void 0||u.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"handleFreetextEditElementPaste",value:function(r){pastePlainText(r)}}]);var o}(),Text$1=function(e){function n(r){var u,s=r.annotation,w=r.documentViewer,m=r.show,v=m!==void 0&&m,g=r.enableReply,d=g===void 0||g;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:s,documentViewer:w}])).type="text",u.enableReply=d,u.textNoteStr=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M2.39961 3.60004H21.5996V18H11.9996L5.99961 21.6V18H2.39961V3.60004Z" fill="currentColor"/>
      <rect x="5.99902" y="7.20001" width="7.2" height="1.8" fill="white"/>
      <rect x="5.99902" y="11.4" width="12" height="1.8" fill="white"/>
    </svg>`,u.deleteSvgStr='<path id="ic" fill-rule="evenodd" clip-rule="evenodd" d="M13 2.75V1.25H7V2.75H13ZM19 5.75V4.25H16.75H3.25H1V5.75H3.25V18.75H16.75V5.75H19ZM4.75 17.25V5.75H15.25V17.25H4.75ZM8.75 8.5V14.5H7.25V8.5H8.75ZM12.75 8.5V14.5H11.25V8.5H12.75Z" fill="currentColor"/>',u.hidden=!0,u.initial=!1,u.rect=null,u.start=null,u.end=null,u.newStart=null,u.newEnd=null,u.show=v,u.popShow=!1,u.onClick=u.handleClick.bind(u),u.handleBlur=u.handleBlur.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.onMousedown=u.handleMouseDown.bind(u),u.onMousemove=u.handleMouseMove.bind(u),u.onMouseup=u.handleMouseUp.bind(u),u.handleStopPropagation=u.handlestopPropagation.bind(u),u.onPaste=u.handlePaste.bind(u),u.handlePropertyPanel=u.handlePropertyPanel.bind(u),u.render(),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){this.annotation.isHidden||(this.renderTextElement(),this.renderTextEditor())}},{key:"handleDelete",value:function(r){var u;(u=this.layer)!==null&&u!==void 0&&u.tool&&r&&r.stopPropagation(),this.delete();var s={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(s.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",s),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var r,u,s,w,m;this.handleClickOutside(),(r=this.textEditorContainer)===null||r===void 0||r.removeEventListener("click",this.handleStopPropagation),(u=this.textEditorContainer)===null||u===void 0||u.removeEventListener("paste",this.onPaste),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.textEditorContainer)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handlestopPropagation",value:function(r){r.stopPropagation()}},{key:"handleBlur",value:function(){var r=this.annotation,u=getHtmlToText(this.textEditorElement);u!==r.contents&&(this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:r.name,pageIndex:this.PageNumber-1,pagePtr:r.pagePtr,annotPtr:r.annotPtr,contents:u}}),r.contents=u,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")),this.textEditorContainer.removeEventListener("click",this.handleStopPropagation),this.textEditorContainer.removeEventListener("paste",this.onPaste),this.textEditorContainer.remove(),(!this.moving||this.popShow)&&this.annotationContainer.classList.remove("selected")}},{key:"handleMouseDown",value:function(r){var u;if(!(r.button!==0&&r.type==="mousedown"||(u=this.layer)!==null&&u!==void 0&&u.addMode)){this.moving=!1,this.annotationContainer.classList.add("selected");var s=this.documentViewer.getScrollViewElement();this.scrollTop=s.scrollTop,this.scrollLeft=s.scrollLeft;var w=getClickPoint(r),m=w.pageX,v=w.pageY;this.startState={clickX:m,clickY:v},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(r){if(r.button===0||r.type!=="mousemove"){r.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none");var u=getClickPoint(r),s=u.pageX,w=u.pageY,m=this.documentViewer,v=m.getScrollViewElement(),g=v.scrollTop;if(s=s+v.scrollLeft-this.scrollLeft,w=w+g-this.scrollTop,s!==this.startState.clickX||w!==this.startState.clickY){this.moving=!0;var d,f,y,x,k=this.start,P=this.end,S=this.startState,E=m.scale,M=m.getPageWidth(this.PageNumber)*E,T=m.getPageHeight(this.PageNumber)*E,D=this.getMouseLocation(r),N=m.getSelectedPage(D,D),I=this.PageNumber;if(N.first&&N.first!==I){var O,F=m.windowToPage(D,N.first,!1),q=Math.abs(k.x-P.x),Y=Math.abs(k.y-P.y);if(m.pdfViewer.spreadMode===0&&m.pdfViewer.scrollMode===0)d=s-(S.clickX-this.start.x),f=N.first>I?F.y:F.y-Y,y=s-(S.clickX-this.end.x),x=N.first>I?F.y+Y:F.y;else if(m.pdfViewer.spreadMode===0&&m.pdfViewer.scrollMode===1)d=N.first>I?F.x:F.x-q,f=w-(S.clickY-this.start.y),y=N.first>I?F.x+q:F.x,x=w-(S.clickY-this.end.y);else if(m.pdfViewer.spreadMode===1&&m.pdfViewer.scrollMode===0){var _e=Math.min(N.first,I),ne=Math.max(N.first,I);if(ne-_e>2||_e+1===ne&&_e%2==0)return;_e+1===ne?(d=N.first>I?F.x:F.x-q,f=w-(S.clickY-this.start.y),y=N.first>I?F.x+q:F.x,x=w-(S.clickY-this.end.y)):_e+2===ne&&(d=s-(S.clickX-this.start.x),f=N.first>I?F.y:F.y-Y,y=s-(S.clickX-this.end.x),x=N.first>I?F.y+Y:F.y)}else if(m.pdfViewer.spreadMode===2&&m.pdfViewer.scrollMode===0){var ve=Math.min(N.first,I),J=Math.max(N.first,I);if(J-ve>2||ve+1===J&&(ve!==1||J!==2)&&J%2==0||ve===1&&J===3)return;ve+2===J||ve===1&&J===2?(d=s-(S.clickX-this.start.x),f=N.first>I?F.y:F.y-Y,y=s-(S.clickX-this.end.x),x=N.first>I?F.y+Y:F.y):ve+1===J&&(d=N.first>I?F.x:F.x-q,f=w-(S.clickY-this.start.y),y=N.first>I?F.x+q:F.x,x=w-(S.clickY-this.end.y))}if(!m.pdfViewer._pages[N.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=N.first-1,this.annotationContainer.remove();var fe=(O=this.layer)===null||O===void 0?void 0:O.div;fe==null||fe.append(this.annotationContainer)}else{d=s-(S.clickX-this.start.x),f=w-(S.clickY-this.start.y),y=s-(S.clickX-this.end.x),x=w-(S.clickY-this.end.y);var Z=m.pageToWindow({x:d,y:f},I,!1),j=m.pageToWindow({x:y,y:x},I,!1),X=0,H=0;w>S.clickY?H=(H=v.offsetHeight-(j.y-v.scrollTop-v.offsetTop))<100?5:0:w<S.clickY&&(H=(H=Z.y-v.scrollTop-v.offsetTop)<100?-5:0),s>S.clickX?X=(X=v.offsetWidth-(j.x-v.scrollLeft-v.offsetLeft))<100?5:0:s<S.clickX&&(X=(X=Z.x-v.scrollLeft-v.offsetLeft)<100?-5:0),(X||H)&&(v.scrollTop+=H,v.scrollLeft+=X);var U={width:Math.abs(k.x-P.x),height:Math.abs(k.y-P.y)};d<y?(d=Math.max(0,d),d=Math.min(M-U.width,d),y=Math.max(U.width,y),y=Math.min(M,y)):(y=Math.max(0,y),y=Math.min(M-U.width,y),d=Math.max(U.width,d),d=Math.min(M,d)),f<x?(f=Math.max(0,f),f=Math.min(T-U.height,f),x=Math.max(U.height,x),x=Math.min(T,x)):(x=Math.max(0,x),x=Math.min(T-U.height,x),f=Math.max(U.height,f),f=Math.min(T,f))}this.update({start:{x:d,y:f},end:{x:y,y:x}}),S.clickX=s,S.clickY=w}}}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(u.button===0||u.type!=="mouseup"){k.next=2;break}return k.abrupt("return");case 2:if((s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.moving&&!this.popShow&&this.annotationContainer.classList.remove("selected"),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.scrollLeft=0,this.scrollTop=0,this.moving=!1,w=this.annotation,m=getInitialPoint$1(this.start,this.documentViewer.scale),v=getInitialPoint$1(this.end,this.documentViewer.scale),(g={left:m.x,top:m.y,right:v.x,bottom:v.y})!==w.rect||this.PrePageNumber!==this.PageNumber){k.next=21;break}return k.abrupt("return");case 21:if(w.rect=g,this.PrePageNumber===this.PageNumber){k.next=44;break}return d={type:"delete",annotation:{operate:"del-annot",name:w.name,pageIndex:w.pageIndex,annotPtr:w.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",d),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(f=Object.assign({},w)).annotPtr,delete f.pagePtr,delete f.name,f.operate="add-annot",f.pageIndex=this.PageNumber-1,k.next=35,this.documentViewer.annotationManager.createAnnotation(f);case 35:return y=k.sent,x=new n({annotation:y,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),k.next=40,this.documentViewer.annotationManager.addAnnotation(x);case 40:this.documentViewer.annotationManager.drawAnnotationsFromList(x),this.annotationContainer.remove(),k.next=46;break;case 44:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:g}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 46:case"end":return k.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.popShow&&this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&this.layer.div.append(this.textEditorContainer);var r=this.documentViewer.scale,u=this.getActualRect(r),s=u.start,w=u.end;this.update({start:s,end:w})}}},{key:"getInitialPoint",value:function(){var r=this.documentViewer.scale;return{start:{x:this.start.x/r,y:this.start.y/r},end:{x:this.end.x/r,y:this.end.y/r}}}},{key:"update",value:function(r){var u=r.start,s=r.end,w=this.rectCalc({start:u,end:s});this.start=u,this.end=s;var m=this.getInitialPoint().start;this.annotationContainer.style.top="calc(var(--scale-factor) * ".concat(m.y,"px)"),this.annotationContainer.style.left="calc(var(--scale-factor) * ".concat(m.x,"px)"),this.textEditorContainer.style.top=w.top+28+"px",this.textEditorContainer.style.left=w.left+16+"px"}},{key:"rectCalc",value:function(r){var u=r.start,s=r.end;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"getActualRect",value:function(r){var u=this.annotation.rect,s=u.left,w=u.top,m=u.right,v=u.bottom;return{start:getActualPoint$1({x:s,y:w},r),end:getActualPoint$1({x:m,y:v},r)}}},{key:"handleClickOutside",value:function(r){r!==this.annotationContainer&&this.popShow&&(this.popShow=!1,this.annotationContainer.style.zIndex=2,this.handleBlur(),this.updateTool())}},{key:"setCss",value:function(r,u){if(r&&u)for(var s in u)r.style[s]=u[s]}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var r,u;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(r=this.layer)===null||r===void 0||r.div.classList.remove("no-edit"):(u=this.layer)===null||u===void 0||u.div.classList.add("no-edit")}},{key:"handleClick",value:function(r){var u,s,w;if(this.setPopupElementStyle(),!((u=this.layer)!==null&&u!==void 0&&u.addMode||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((s=this.layer)===null||s===void 0?void 0:s.tool)||document.querySelector(".compare-document-container").contains(r==null?void 0:r.target)||this.moving||(r&&this.documentViewer.eventBus.dispatch("closeTextEditor",r.target.closest(".annotation.text")),this.popShow))){this.popShow=!0,(w=this.layer)===null||w===void 0||w.pageDiv.append(this.textEditorContainer),this.updateTool(),this.textEditorContainer.addEventListener("click",this.handleStopPropagation),this.textEditorContainer.addEventListener("paste",this.onPaste),this.textEditorElement.focus(),keepLastIndex(this.textEditorElement);var m=[this.annotationContainer,this.textEditorContainer,document.querySelector(".annotation-panel")],v=document.querySelector(".toggle-button");v&&m.push(v);var g=document.getElementById("annotationPropertyPanelButton");g&&m.push(g),onClickOutside$1(m,this.handleClickOutside.bind(this))}}},{key:"updateTool",value:function(){if(this.popShow){if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var r=this.annotation;this.documentViewer.annotationStore.selectedElementName=r.name;var u=_objectSpread2$1({},r);delete u.annotPtr,delete u.pagePtr,delete u.operate,delete u.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",u)}this.documentViewer.getScrollViewElement().style.touchAction="none",this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel)}else this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null,this.documentViewer.eventBus.dispatch("annotationDeselected",this)),this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"renderTextElement",value:function(){var r=this.getActualRect(this.documentViewer.scale),u=r.start,s=r.end;this.start=u,this.end=s;var w=this.annotation;w.color||(w.color="#FF0000");var m=this.rectCalc({start:u,end:s});this.rect=m;var v=document.createElement("div");v.id=w.name,v.className="annotation text",this.setCss(v,{position:"absolute",left:"calc(var(--scale-factor) * ".concat(w.rect.top,"px)"),top:"calc(var(--scale-factor) * ".concat(w.rect.left,"px)"),width:"24px",height:"24px",color:w.color,opacity:w.opacity||1}),v.innerHTML=this.textNoteStr,v.addEventListener("mousedown",this.onClick),v.addEventListener("mousedown",this.onMousedown),v.addEventListener("touchstart",this.onMousedown),this.annotationContainer=v}},{key:"renderTextEditor",value:function(){var r=document.createElement("div");this.textEditorContainer=r,this.setCss(r,{position:"absolute",left:this.rect.left+16+"px",top:this.rect.top+28+"px",zIndex:2,border:"2px solid",borderColor:this.annotation.color,outline:"none",padding:"0 8px 28px",borderRadius:"4px",background:"#FFFFFF"}),this.textEditorContainer.className="text-editor-container";var u=document.createElement("div");u.className="text-title",u.innerText=this.documentViewer.annotationStore.$t("toolbar.annotationTools.note"),r.append(u);var s=document.createElement("div");if(s.setAttribute("role","textbox"),s.setAttribute("contenteditable",!0),s.setAttribute("spellcheck",!1),this.setCss(s,{width:"290px",height:"110px",fontSize:"16px",color:"#000",lineHeight:"1.2em",outline:"none",overflow:"auto",whiteSpace:"pre-wrap",textAlign:"left","-webkit-user-select":"text"}),s.className="text-editor",this.annotation.contents)s.innerHTML=this.annotation.contents;else if(this.annotation["contents-richtext"]){var w=new window.DOMParser().parseFromString(this.annotation["contents-richtext"],"text/xml");w.getElementsByTagName("parsererror").length>0?s.innerHTML=this.annotation["contents-richtext"]:s.innerHTML=w.firstElementChild.innerText}this.textEditorElement=s,r.append(s);var m=createSvg("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",class:"delete-button"},{width:"20px",height:"20px",position:"absolute",right:"10px",bottom:"10px"});m.innerHTML=this.deleteSvgStr,this.deletetButton=m,r.append(m),this.deletetButton.addEventListener("click",this.onDelete),this.replyButton=createElement("div",{position:"absolute",right:"40px",bottom:"10px",width:"20px",height:"20px"},{class:"reply-button"}),this.replyButton.innerHTML=this.replySvgStr,this.enableReply&&r.append(this.replyButton),this.replyButton.addEventListener("click",this.onOpenReply)}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"handlePaste",value:function(r){pastePlainText(r)}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"text",operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(r){var u=this.documentViewer.scale,s=getActualPoint$1({x:r.x1,y:r.y1},u),w=getActualPoint$1({x:r.x2,y:r.y2},u);this.update({start:s,end:w});var m=getInitialPoint$1(this.start,u),v=getInitialPoint$1(this.end,u),g={left:m.x,top:m.y,right:v.x,bottom:v.y};this.annotation.rect=g,this.setAnnotationChanged({rect:g})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(r){r!==this.contents&&(this.annotation.contents=r,this.textEditorElement.innerHTML=r,this.setAnnotationChanged({contents:r}))}},{key:"color",get:function(){return this.annotation.color},set:function(r){this.annotation.color=r,this.annotationContainer.style.color=r,this.textEditorContainer.style.borderColor=r,this.setAnnotationChanged({borderColor:r})}},{key:"state",get:function(){return this.annotation.state},set:function(r){this.annotation.state=r,this.setAnnotationChanged({state:r})}},{key:"stateModel",get:function(){return this.annotation.stateModel}},{key:"getState",value:function(){return this.annotation.state}},{key:"setState",value:function(r){this.annotation.state=r,this.setAnnotationChanged({state:r})}},{key:"handlePropertyPanel",value:function(r){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var u=this.annotation,s=0;for(var w in r)for(var m in u){var v=r[w];m===w&&u[m]!==v&&(u[w]=v,s++,w==="color"&&(this.annotationContainer.style.color=v,this.textEditorContainer.style.borderColor=v),w==="contents"&&(this.textEditorElement.innerHTML=v))}if(s>0){var g={operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},d=Object.assign({},g,r);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:d}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}}]);var o}(),Stamp=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.enableReply,y=f===void 0||f;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="stamp",w.enableReply=y,w.show=d,w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.ratio=window.devicePixelRatio||1,w.selectionOutlinePadding=8,w.selectionOutlinePointWidth=6,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.onOpenReply=w.openReply.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N;return _regeneratorRuntime().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(w=this.annotation,m=document.createElement("div"),this.annotationContainer=m,this.scale=this.documentViewer.scale,w.rect){I.next=21;break}return I.next=7,this.documentViewer.messageHandler.sendWithPromise("GetAnnotRect",{pagePtr:w.pagePtr,annotPtr:w.annotPtr});case 7:return v=I.sent,g=documentViewer.getPageWidth(this.PageNumber),d=documentViewer.getPageHeight(this.PageNumber),f=v.right-v.left,y=v.bottom-v.top,x={left:(g-f)/2,top:(d-y)/2,right:(g+f)/2,bottom:(d+y)/2},this.scale=this.documentViewer.scale,I.next=20,this.documentViewer.messageHandler.sendWithPromise("SetAnnotRect",{pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:x});case 20:w.rect=x;case 21:if(k=this.getActualRect(this.documentViewer.scale),P=k.start,S=k.end,this.start=P,this.end=S,E=this.calculate(P,S),this.ratioRate=E.height/E.width,M=this.getWidth(),T=this.getHeight(),m.id=w.name,m.className="annotation",m.style.top="calc(var(--scale-factor) * ".concat(w.rect.top,"px)"),m.style.left="calc(var(--scale-factor) * ".concat(w.rect.left,"px)"),m.style.width="calc(var(--scale-factor) * ".concat(M,"px)"),m.style.height="calc(var(--scale-factor) * ".concat(T,"px)"),m.style.fontSize="0",D=null,(D=document.createElement("img")).style.width="100%",D.style.height="100%",this.imgEle=D,!w.image){I.next=44;break}w.imageBase64=D.src=w.image,I.next=47;break;case 44:if(w.stampType!=="standard"&&w.stampType!=="image"&&w.stampType!=="text"){I.next=47;break}return I.next=47,this.getAnnotImage();case 47:m.append(this.imgEle),this.imgEle.addEventListener("mousedown",this.handleClick.bind(this)),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:E.left+E.width-114+"px",top:E.top+E.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px",borderRadius:"2px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr,N=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(E.left-N,"px"),top:"".concat(E.top-N,"px"),width:"".concat(E.width+2*N,"px"),height:"".concat(E.height+2*N,"px"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"fill-opacity":0,width:E.width+this.selectionOutlinePadding,height:E.height+this.selectionOutlinePadding,x:this.selectionOutlinePointWidth/2,y:this.selectionOutlinePointWidth/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:0}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:E.height+this.selectionOutlinePadding}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:E.width+this.selectionOutlinePadding,y:E.height+this.selectionOutlinePadding}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:E.width+this.selectionOutlinePadding,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.topRightRect),this.outerLineContainer.append(this.outerLine),this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.eventBus.dispatch("imageChange"),this.documentViewer.annotationStore.creating=!1,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 84:case"end":return I.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getAnnotImage",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return w=this.annotation,m=this.calculate(this.start,this.end),v={width:Math.ceil(m.width*this.ratio),height:Math.ceil(m.height*this.ratio)},k.next=5,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:w.pagePtr,annotPtr:w.annotPtr,width:v.width,height:v.height});case 5:return g=k.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,f=d.getContext("2d"),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle&&(this.imgEle.src=x),this.annotation.imageBase64=x,k.abrupt("return",x);case 19:case"end":return k.stop()}},s,this)})),function(){return r.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});return{top:m.top,left:m.left,width:m.width,height:m.height}}},{key:"getInitialPoint",value:function(){var s=this.documentViewer.scale;return{start:{x:this.start.x/s,y:this.start.y/s},end:{x:this.end.x/s,y:this.end.y/s}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m)}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var s,w,m=this.calculate(this.start,this.end);this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:m.left+m.width-114+"px"})):((w=this.layer)===null||w===void 0||w.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:m.left+m.width-46+"px"}))}},{key:"handleClick",value:function(s){var w,m;if(this.setPopupElementStyle(),(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.preventDefault(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes((m=this.layer)===null||m===void 0?void 0:m.tool)&&!document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)){this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel);var v=[this.annotationContainer,this.popupElement,this.outerLine,document.querySelector(".annotation-panel")],g=document.getElementById("annotationPropertyPanelButton");g&&v.push(g);var d=document.querySelector(".toggle-button");d&&v.push(d),onClickOutside$1(v,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var s,w,m;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;if(s.button===0||s.type!=="mousedown"){(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation(),s.type==="touchstart"&&(this.layer&&(this.layer.pageDiv.style.touchAction="none"),document.body.style.userSelect="none",document.getElementById("app").style.touchAction="none");var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(s){var w;if(s.button===0||s.type!=="mousemove"){(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation(),this.moving=!0;var m=getClickPoint(s),v=m.pageX,g=m.pageY,d=this.documentViewer,f=d.getScrollViewElement(),y=f.scrollTop;v=v+f.scrollLeft-this.scrollLeft,g=g+y-this.scrollTop;var x=this.start,k=this.end,P=this.startState,S=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,E=this.documentViewer.scale,M=d.getPageWidth(this.PageNumber)*E,T=d.getPageHeight(this.PageNumber)*E;if(P.operator==="nw-resize"){var D=v-(P.clickX-this.start.x),N=g-(P.clickY-this.start.y);if(D=Math.min(k.x-5,D),D=Math.max(S,D),N=Math.min(k.y-5,N),N=Math.max(S,N),this.ratioRate){var I=(D-this.start.x)*this.ratioRate;if((N=this.start.y+I)<S||D<S)return}this.update({start:{x:D,y:N},end:k})}else if(P.operator==="sw-resize"){var O=v-(P.clickX-this.start.x),F=g-(P.clickY-this.end.y);if(O=Math.min(k.x-5,O),O=Math.max(S,O),F=Math.min(T-S,F),F=Math.max(x.y+5,F),this.ratioRate){var q=(O-this.start.x)*this.ratioRate;if((F=this.end.y-q)>=T-S||O<S)return}this.update({start:{x:O,y:x.y},end:{x:k.x,y:F}})}else if(P.operator==="se-resize"){var Y=v-(P.clickX-this.end.x),_e=g-(P.clickY-this.end.y);if(Y=Math.min(M-S,Y),Y=Math.max(x.x+5,Y),_e=Math.min(T-S,_e),_e=Math.max(x.y+5,_e),this.ratioRate){var ne=(this.end.x-Y)*this.ratioRate;if((_e=this.end.y-ne)>=T-S||Y>=M-S)return}this.update({start:x,end:{x:Y,y:_e}})}else if(P.operator==="ne-resize"){var ve=v-(P.clickX-this.end.x),J=g-(P.clickY-this.start.y);if(ve=Math.min(M-S,ve),ve=Math.max(x.x+5,ve),J=Math.min(k.y-5,J),J=Math.max(S,J),this.ratioRate){var fe=(this.end.x-ve)*this.ratioRate;if((J=this.start.y+fe)<=S||ve>=M-S)return}this.update({start:{x:x.x,y:J},end:{x:ve,y:k.y}})}else if(P.operator==="move"){var Z,j,X,H,U=this.documentViewer,te=this.getMouseLocation(s),Q=U.getSelectedPage(te,te),re=this.PageNumber;if(Q.first&&Q.first!==re){var Pe,be=U.windowToPage(te,Q.first,!1),we=Math.abs(x.x-k.x),Ae=Math.abs(x.y-k.y);if(U.pdfViewer.spreadMode===0&&U.pdfViewer.scrollMode===0)Z=v-(P.clickX-this.start.x),j=Q.first>re?be.y:be.y-Ae,X=v-(P.clickX-this.end.x),H=Q.first>re?be.y+Ae:be.y;else if(U.pdfViewer.spreadMode===0&&U.pdfViewer.scrollMode===1)Z=Q.first>re?be.x:be.x-we,j=g-(P.clickY-this.start.y),X=Q.first>re?be.x+we:be.x,H=g-(P.clickY-this.end.y);else if(U.pdfViewer.spreadMode===1&&U.pdfViewer.scrollMode===0){var $e=Math.min(Q.first,re),Me=Math.max(Q.first,re);if(Me-$e>2||$e+1===Me&&$e%2==0)return;$e+1===Me?(Z=Q.first>re?be.x:be.x-we,j=g-(P.clickY-this.start.y),X=Q.first>re?be.x+we:be.x,H=g-(P.clickY-this.end.y)):$e+2===Me&&(Z=v-(P.clickX-this.start.x),j=Q.first>re?be.y:be.y-Ae,X=v-(P.clickX-this.end.x),H=Q.first>re?be.y+Ae:be.y)}else if(U.pdfViewer.spreadMode===2&&U.pdfViewer.scrollMode===0){var Ie=Math.min(Q.first,re),Le=Math.max(Q.first,re);if(Le-Ie>2||Ie+1===Le&&(Ie!==1||Le!==2)&&Le%2==0||Ie===1&&Le===3)return;Ie+2===Le||Ie===1&&Le===2?(Z=v-(P.clickX-this.start.x),j=Q.first>re?be.y:be.y-Ae,X=v-(P.clickX-this.end.x),H=Q.first>re?be.y+Ae:be.y):Ie+1===Le&&(Z=Q.first>re?be.x:be.x-we,j=g-(P.clickY-this.start.y),X=Q.first>re?be.x+we:be.x,H=g-(P.clickY-this.end.y))}if(!U.pdfViewer._pages[Q.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=Q.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var le=(Pe=this.layer)===null||Pe===void 0?void 0:Pe.div;le==null||le.append(this.annotationContainer),le==null||le.append(this.outerLineContainer)}else{Z=v-(P.clickX-this.start.x),j=g-(P.clickY-this.start.y),X=v-(P.clickX-this.end.x),H=g-(P.clickY-this.end.y);var oe=U.pageToWindow({x:Z,y:j},re,!1),ke=U.pageToWindow({x:X,y:H},re,!1),Ce=0,Ee=0;g>P.clickY?Ee=(Ee=f.offsetHeight-(ke.y-f.scrollTop-f.offsetTop))<100?5:0:g<P.clickY&&(Ee=(Ee=oe.y-f.scrollTop-f.offsetTop)<100?-5:0),v>P.clickX?Ce=(Ce=f.offsetWidth-(ke.x-f.scrollLeft-f.offsetLeft))<100?5:0:v<P.clickX&&(Ce=(Ce=oe.x-f.scrollLeft-f.offsetLeft)<100?-5:0),(Ce||Ee)&&(f.scrollTop+=Ee,f.scrollLeft+=Ce);var Be={width:Math.abs(x.x-k.x),height:Math.abs(x.y-k.y)};Z<X?(Z=Math.max(S,Z),Z=Math.min(M-Be.width-S,Z),X=Math.max(Be.width+S,X),X=Math.min(M-S,X)):(X=Math.max(S,X),X=Math.min(M-Be.width-S,X),Z=Math.max(Be.width+S,Z),Z=Math.min(M-S,Z)),j<H?(j=Math.max(S,j),j=Math.min(T-Be.height-S,j),H=Math.max(Be.height+S,H),H=Math.min(T-S,H)):(H=Math.max(S,H),H=Math.min(T-Be.height-S,H),j=Math.max(Be.height+S,j),j=Math.min(T-S,j))}this.update({start:{x:Z,y:j},end:{x:X,y:H}})}P.clickX=v,P.clickY=g}}},{key:"handleDelete",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.stopPropagation(),this.delete();var m={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(m.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",m),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),this.annotation.isDelete=!0,(w=this.layer)===null||w===void 0||w.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(w.button===0||w.type!=="mouseup"){E.next=2;break}return E.abrupt("return");case 2:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&(this.layer&&(this.layer.pageDiv.style.touchAction=""),document.body.style.userSelect="auto",document.getElementById("app").style.touchAction="auto",this.layer&&(this.layer.pageDiv.style.touchAction="")),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=16;break}return E.abrupt("return");case 16:return E.next=18,this.getAnnotImage();case 18:if(v.rect=y,this.PrePageNumber===this.PageNumber){E.next=42;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-annot",k.pageIndex=this.PageNumber-1,E.next=32,this.documentViewer.annotationManager.createAnnotation(k);case 32:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=37,this.documentViewer.annotationManager.addAnnotation(S);case 37:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=44;break;case 42:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:v.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 44:case"end":return E.stop()}},s,this)})),function(s){return o.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale,w=this.getActualRect(s),m=w.start,v=w.end;s!==this.scale&&(this.update({start:m,end:v}),this.scale=s,this.getAnnotImage())}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.imgEle.style.width="calc(var(--scale-factor) * ".concat(y,"px)"),this.imgEle.style.height="calc(var(--scale-factor) * ".concat(x,"px)");var P=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2;this.outerLine.style.left="".concat(v.left-P,"px"),this.outerLine.style.top="".concat(v.top-P,"px"),this.outerLine.style.width="".concat(v.width+2*P,"px"),this.outerLine.style.height="".concat(v.height+2*P,"px"),this.popupElement.style.left=v.left+v.width-114+"px",this.popupElement.style.top=v.top+v.height+12+"px",this.moveRect.setAttribute("width",v.width+this.selectionOutlinePadding),this.moveRect.setAttribute("height",v.height+this.selectionOutlinePadding),this.bottomLeftRect.setAttribute("y",v.height+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("x",v.width+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("y",v.height+this.selectionOutlinePadding),this.topRightRect.setAttribute("x",v.width+this.selectionOutlinePadding)}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"stamp",operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v});var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(s){s!==this.contents&&(this.annotation.contents=s,this.setAnnotationChanged({contents:s}))}},{key:"handlePropertyPanel",value:function(s){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var w=this.annotation;w.contents=s.contents;var m={operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,contents:w.contents};this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:m}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}]);var o,r,u}(),Freetext=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.freetextElement=null,this.start=null,this.end=null,this.onClick=this.handleClick.bind(this),this.onBlur=this.handleBlur.bind(this),this.onPaste=this.handlePaste.bind(this),this.init()},[{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||this.reset(),this._tool=e)}},{key:"reset",value:function(){var e=this.freetextElement;this.layer.pageDiv.removeEventListener("click",this.onClick),e&&this.handleFreetext(),this.start=null,this.end=null}},{key:"init",value:function(){this.layer.pageDiv.removeEventListener("click",this.onClick),this.layer.pageDiv.addEventListener("click",this.onClick)}},{key:"getFreetextRectPoint",value:function(){var e=this.start,n=this.end;return{start:{x:e.x,y:e.y},end:{x:n.x,y:n.y}}}},{key:"getFreetextRect",value:function(){var e=this.layer.viewport.scale,n=this.getFreetextRectPoint(),o=getInitialPoint$1(n.start,e),r=getInitialPoint$1(n.end,e);return{left:o.x,top:o.y,right:r.x,bottom:r.y}}},{key:"handleFreetext",value:function(){this.layer.addMode=!1;var e=this.freetextElement;if(e.innerText){var n=e.getBoundingClientRect();this.end={x:this.start.x+n.width+1,y:this.start.y+n.height-4};var o=this.getFreetextRect(),r=getHtmlToText(e),u=this.layer.annotationStore.freetextDefault,s={operate:"add-annot",type:"freetext",pageIndex:this.layer.page,date:new Date,color:u.color,fontSize:u.fontSize,fontName:u.fontName,fontStyle:u.fontStyle,fontWeight:u.fontWeight,textAlignment:u.textAlignment,borderWidth:u.borderWidth,borderColor:u.borderColor,fillColor:u.fillColor,contents:r,rect:o};this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:s})}e.removeEventListener("blur",this.onBlur),e.removeEventListener("paste",this.onPaste),e.remove(),this.freetextElement=null}},{key:"handleBlur",value:function(){this.handleFreetext()}},{key:"handleClick",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=this.freetextElement;n&&e.target===n||n||this.layer.annotationStore.selectedElementName||(this.layer.addMode=!0,this.renderFreetext(e))}}},{key:"setCss",value:function(e,n){if(e&&n)for(var o in n)e.style[o]=n[o]}},{key:"renderFreetext",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e);if(this.start=n,!this.freetextElement){var o=this.layer.viewport,r=o.width,u=o.height,s=r-this.start.x,w=u-this.start.y,m=document.createElement("div");m.setAttribute("role","textbox"),m.setAttribute("contenteditable",!0),m.setAttribute("spellcheck",!1);var v=this.layer.annotationStore.freetextDefault,g=v.color,d=v.fontSize,f=v.fontName,y=v.fontStyle,x=v.fontWeight,k=v.textAlignment,P=v.borderWidth,S=v.borderColor,E=v.fillColor,M=this.layer.viewport.scale;this.setCss(m,_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1(_defineProperty$1({position:"absolute",left:n.x-4+"px",top:n.y-4+"px",maxWidth:s+"px",maxHeight:w+"px",minWidth:"20px",textAlign:"left",whiteSpace:"pre-wrap",fontFamily:f,color:g,fontSize:d*M+"px",fontStyle:y,fontWeight:x},"textAlign",k),"borderWidth",P+"px"),"borderColor",S||"rgb(0, 0, 0)"),"borderStyle","solid"),"backgroundColor",E||"transparent"),"lineHeight","1.2em"),"padding","3px"),"overflow","auto"),"-webkit-user-select","text")),m.className="freetext",m.addEventListener("blur",this.onBlur),m.addEventListener("paste",this.onPaste),this.freetextElement=m,this.layer.pageDiv.append(m),m.focus()}}},{key:"handlePaste",value:function(e){pastePlainText(e)}}])}();function $(e,n,o,r=u=>u){return e*r(.5-n*(.5-o))}function se(e){return[-e[0],-e[1]]}function l(e,n){return[e[0]+n[0],e[1]+n[1]]}function a(e,n){return[e[0]-n[0],e[1]-n[1]]}function b(e,n){return[e[0]*n,e[1]*n]}function he(e,n){return[e[0]/n,e[1]/n]}function R(e){return[e[1],-e[0]]}function B(e,n){return e[0]*n[0]+e[1]*n[1]}function ue(e,n){return e[0]===n[0]&&e[1]===n[1]}function ge(e){return Math.hypot(e[0],e[1])}function de(e){return e[0]*e[0]+e[1]*e[1]}function A(e,n){return de(a(e,n))}function G(e){return he(e,ge(e))}function ie(e,n){return Math.hypot(e[1]-n[1],e[0]-n[0])}function L(e,n,o){let r=Math.sin(o),u=Math.cos(o),s=e[0]-n[0],w=e[1]-n[1],m=s*r+w*u;return[s*u-w*r+n[0],m+n[1]]}function K(e,n,o){return l(e,b(a(n,e),o))}function ee(e,n,o){return l(e,b(n,o))}var{min:C,PI:xe}=Math,pe=.275,V=xe+1e-4;function ce(e,n={}){let{size:o=16,smoothing:r=.5,thinning:u=.5,simulatePressure:s=!0,easing:w=j=>j,start:m={},end:v={},last:g=!1}=n,{cap:d=!0,easing:f=j=>j*(2-j)}=m,{cap:y=!0,easing:x=j=>--j*j*j+1}=v;if(e.length===0||o<=0)return[];let k,P=e[e.length-1].runningLength,S=m.taper===!1?0:m.taper===!0?Math.max(o,P):m.taper,E=v.taper===!1?0:v.taper===!0?Math.max(o,P):v.taper,M=Math.pow(o*r,2),T=[],D=[],N=e.slice(0,10).reduce((j,X)=>{let H=X.pressure;if(s){let U=C(1,X.distance/o),te=C(1,1-U);H=C(1,j+U*pe*(te-j))}return(j+H)/2},e[0].pressure),I=$(o,u,e[e.length-1].pressure,w),O=e[0].vector,F=e[0].point,q=F,Y=F,_e=q,ne=!1;for(let j=0;j<e.length;j++){let{pressure:X}=e[j],{point:H,vector:U,distance:te,runningLength:Q}=e[j];if(j<e.length-1&&P-Q<3)continue;if(u){if(s){let Me=C(1,te/o),Ie=C(1,1-Me);X=C(1,N+Me*pe*(Ie-N))}I=$(o,u,X,w)}else I=o/2;k===void 0&&(k=I);let re=Q<S?f(Q/S):1,Pe=P-Q<E?x((P-Q)/E):1;I=Math.max(.01,I*Math.min(re,Pe));let be=(j<e.length-1?e[j+1]:e[j]).vector,we=j<e.length-1?B(U,be):1,Ae=we!==null&&we<0;if(B(U,O)<0&&!ne||Ae){let Me=b(R(O),I);for(let Ie=1/13,Le=0;Le<=1;Le+=Ie)Y=L(a(H,Me),H,V*Le),T.push(Y),_e=L(l(H,Me),H,V*-Le),D.push(_e);F=Y,q=_e,Ae&&(ne=!0);continue}if(ne=!1,j===e.length-1){let Me=b(R(U),I);T.push(a(H,Me)),D.push(l(H,Me));continue}let $e=b(R(K(be,U,we)),I);Y=a(H,$e),(j<=1||A(F,Y)>M)&&(T.push(Y),F=Y),_e=l(H,$e),(j<=1||A(q,_e)>M)&&(D.push(_e),q=_e),N=X,O=U}let ve=e[0].point.slice(0,2),J=e.length>1?e[e.length-1].point.slice(0,2):l(e[0].point,[1,1]),fe=[],Z=[];if(e.length===1){if(!S&&!E||g){let j=ee(ve,G(R(a(ve,J))),-(k||I)),X=[];for(let H=1/13,U=H;U<=1;U+=H)X.push(L(j,ve,2*V*U));return X}}else{if(!(S||E&&e.length===1))if(d)for(let X=1/13,H=X;H<=1;H+=X){let U=L(D[0],ve,V*H);fe.push(U)}else{let X=a(T[0],D[0]),H=b(X,.5),U=b(X,.51);fe.push(a(ve,H),a(ve,U),l(ve,U),l(ve,H))}let j=R(se(e[e.length-1].vector));if(E||S&&e.length===1)Z.push(J);else if(y){let X=ee(J,j,I);for(let H=1/29,U=H;U<1;U+=H)Z.push(L(X,J,3*V*U))}else Z.push(l(J,b(j,I)),l(J,b(j,.99*I)),a(J,b(j,.99*I)),a(J,b(j,I)))}return T.concat(Z,D.reverse(),fe)}function me(e,n={}){var o;let{streamline:r=.5,size:u=16,last:s=!1}=n;if(e.length===0)return[];let w=.15+.85*(1-r),m=Array.isArray(e[0])?e:e.map(({x,y:k,pressure:P=.5})=>[x,k,P]);if(m.length===2){let x=m[1];m=m.slice(0,-1);for(let k=1;k<5;k++)m.push(K(m[0],x,k/4))}m.length===1&&(m=[...m,[...l(m[0],[1,1]),...m[0].slice(2)]]);let v=[{point:[m[0][0],m[0][1]],pressure:m[0][2]>=0?m[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],g=!1,d=0,f=v[0],y=m.length-1;for(let x=1;x<m.length;x++){let k=s&&x===y?m[x].slice(0,2):K(f.point,m[x],w);if(ue(f.point,k))continue;let P=ie(k,f.point);if(d+=P,x<y&&!g){if(d<u)continue;g=!0}f={point:k,pressure:m[x][2]>=0?m[x][2]:.5,vector:G(a(f.point,k)),distance:P,runningLength:d},v.push(f)}return v[0].vector=((o=v[1])==null?void 0:o.vector)||[0,0],v}function ae(e,n={}){return ce(me(e,n),n)}var PaintShape=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||this.reset(),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)}},{key:"checkSvgChild",value:function(e){switch(e){case"square":return"rect";case"circle":return"ellipse";case"ink":return"path";default:return"line"}}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale),u=Math.min(o.x,r.x),s=Math.min(o.y,r.y),w=Math.max(o.x,r.x),m=Math.max(o.y,r.y),v={left:u,top:s,right:w,bottom:m},g=this.color,d={operate:"add-annot",type:this.tool==="arrow"?"line":this.tool,pageIndex:this.layer.page,date:new Date,borderWidth:2,opacity:1,borderColor:g,color:g,rect:v,borderStyle:"solid",dashes:"",contents:""};if(this.tool==="arrow"&&(d.arrow=!0),d.type=="line"){var f=[o.x,o.y,r.x,r.y];d.linePoints=f,d.rect={left:u-6,top:s-6,right:w+6,bottom:m+6},d.tail="none",d.head="none",this.tool==="arrow"&&(d.tail="openarrow",d.arrow=!0)}else if(this.tool==="ink"){var y=this.formatPath(),x=y.inkPointes,k=y.rect;d.rect=k,d.inkPointes=x}else{var P=[u,m,w,s];d.linePoints=P,d.fillTransparency=1,d.fillColor=""}(this.tool==="ink"&&d.inkPointes.length||this.tool!=="ink")&&this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:d})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height,m=this.layer.viewport.scale;if(o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x===this.initEndPoint.x&&(this.initEndPoint.x=this.initEndPoint.x+1),this.initStartPoint.y===this.initEndPoint.y&&(this.initEndPoint.y=this.initEndPoint.y+1),this.shapeEle){if(e.shiftKey&&(this.tool==="circle"||this.tool==="square")){var v=this.initStartPoint,g=this.initEndPoint,d=Math.abs(g.x-v.x),f=Math.abs(g.y-v.y),y=Math.min(d,f);v.x<g.x?g.x=v.x+y:g.x=v.x-y,v.y<g.y?g.y=v.y+y:g.y=v.y-y}var x=this.calculate(this.initStartPoint,this.initEndPoint),k=this.shapeEle;if(this.tool==="circle")k.setAttribute("cx",x.left+x.width/2),k.setAttribute("cy",x.top+x.height/2),k.setAttribute("rx",(x.width-1)/2),k.setAttribute("ry",(x.height-1)/2);else if(this.tool==="square")k.setAttribute("x",x.left+.5),k.setAttribute("y",x.top-.5),k.setAttribute("width","".concat(Math.abs(x.width-1),"px")),k.setAttribute("height","".concat(Math.abs(x.height-1),"px"));else if(this.tool==="line"||this.tool==="arrow"){if(k.setAttribute("x1",this.initStartPoint.x),k.setAttribute("y1",this.initStartPoint.y),k.setAttribute("x2",this.initEndPoint.x),k.setAttribute("y2",this.initEndPoint.y),this.tool==="arrow"){var P=this.layer.svgElement.querySelector("[tail]");if(P){var S=12*m,E=new ArrowHelper(this.initStartPoint,this.initEndPoint).getArrowPoints("openarrow",30,S),M="";E.forEach(function(O){M.length>0&&(M+=" "),M+="".concat(O.x,",").concat(O.y)}),M.length>0&&P.setAttribute("points",M)}}}else if(this.tool==="ink"){this.path.push([o,r]);var T=this.getFreeDrawSvgPath();k.setAttribute("d",T)}}else{var D=createSvg(this.checkSvgChild(this.tool),{fill:"none",stroke:this.color,"stroke-width":2*m,"stroke-opacity":1});if(this.tool==="arrow"){var N=12*m,I=new ArrowHelper(this.initStartPoint,this.initEndPoint).getArrow("openarrow",30,N);I&&(this.tail="openarrow",I.setAttribute("tail",""),I.setAttribute("stroke",this.color),I.setAttribute("stroke-width",2*m),I.setAttribute("fill","none"),I.setAttribute("stroke-opacity",1),this.layer.svgElement.append(I))}this.shapeEle=D,this.layer.svgElement.append(this.shapeEle)}}},{key:"getFreeDrawSvgPath",value:function(){var e={simulatePressure:!1,size:1,thinning:0,smoothing:.3,streamline:.5,easing:function(n){return Math.sin(n*Math.PI/2)},last:!1};return getSvgPathFromStroke(ae(this.path,e))}},{key:"handlePoint",value:function(e){var n=getInitialPoint$1({x:e[0],y:e[1]},this.layer.viewport.scale);return{x:n.x,y:n.y}}},{key:"formatPath",value:function(){for(var e=[],n=this.path.length,o=[],r=[],u=[],s=0;s<n;s++){var w=this.handlePoint(this.path[s]);o.push(w.x),r.push(w.y),e.push({PointX:w.x.toFixed(2),PointY:w.y.toFixed(2)})}return u.push(e),{inkPointes:u,rect:{left:Math.min.apply(Math,o),bottom:Math.max.apply(Math,r),right:Math.max.apply(Math,o),top:Math.min.apply(Math,r)}}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}}])}(),Text=function(){return _createClass(function e(n){var o=n.tool,r=n.layer;_classCallCheck(this,e),this.textNoteStr=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M2.39961 3.60004H21.5996V18H11.9996L5.99961 21.6V18H2.39961V3.60004Z" fill="currentColor"/>
      <rect x="5.99902" y="7.20001" width="7.2" height="1.8" fill="white"/>
      <rect x="5.99902" y="11.4" width="12" height="1.8" fill="white"/>
    </svg>`,this.deleteSvgStr=`<path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" d="M14 1.5V4.5H19V5.5H16.5V18.5H3.5V5.5H1V4.5H6V1.5H14ZM4.5 5.5V17.5H15.5V5.5H4.5ZM13 2.5V4.5H7V2.5H13ZM8.5 8V15H7.5V8H8.5ZM12.5 15V8H11.5V15H12.5Z" fill="#333333"/>
    `,this.layer=r,this._tool=o,this.color="#FF0000",this.freetextElement=null,this.start=null,this.end=null,this.onClick=this.handleClick.bind(this),this.onBlur=this.handleBlur.bind(this),this.onPaste=this.handlePaste.bind(this),this.init()},[{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||this.reset(),this._tool=e)}},{key:"reset",value:function(){this.start=null,this.end=null,this.layer.pageDiv.removeEventListener("click",this.onClick);var e=this.textElement,n=this.textEditorElement;n&&(n.remove(),n.removeEventListener("blur",this.onBlur),n.removeEventListener("paste",this.onPaste),this.textEditorElement=null),e&&(e.remove(),this.textElement=null)}},{key:"init",value:function(){this.layer.pageDiv.removeEventListener("click",this.onClick),this.layer.pageDiv.addEventListener("click",this.onClick)}},{key:"getTextRect",value:function(){var e=this.layer.viewport.scale,n=getInitialPoint$1(this.start,e);return{left:n.x,top:n.y,right:n.x+18,bottom:n.y+18}}},{key:"handleText",value:function(){var e=this.textEditorElement;if(e.innerText){this.end={x:this.start.x+24,y:this.start.y+24};var n=this.getTextRect(),o=this.color,r=getHtmlToText(e),u={operate:"add-annot",type:"text",pageIndex:this.layer.page,date:new Date,color:o,opacity:1,contents:r,rect:n};this.layer.eventBus.dispatch("annotationChange",{type:"add",annotation:u})}this.layer.addMode=!1,e.remove(),e.removeEventListener("blur",this.onBlur),e.removeEventListener("paste",this.onPaste),this.textElement.remove(),this.textElement=null,this.textEditorElement=null}},{key:"handleBlur",value:function(e){this.textEditorElement&&this.handleText(e)}},{key:"handleClick",value:function(e){this.textElement||this.layer.annotationStore.selectedElementName||(this.layer.addMode=!0,this.renderTextElement(e),this.layer.pageDiv.append(this.textElement),this.textEditorElement.focus())}},{key:"setTextEditor",value:function(){var e=document.createElement("div");this.textElementContainer=e,this.setCss(e,{position:"absolute",left:"16px",top:"28px",border:"2px solid #FF0000",outline:"none",padding:"0 8px 28px",borderRadius:"4px",background:"#FFFFFF",whiteSpace:"pre-wrap",textAlign:"left"});var n=document.createElement("div");n.className="text-title",n.innerText=this.layer.annotationStore.$t("toolbar.annotationTools.note"),e.append(n);var o=document.createElement("div");o.setAttribute("role","textbox"),o.setAttribute("contenteditable",!0),o.setAttribute("spellcheck",!1),this.setCss(o,{width:"290px",height:"110px",fontSize:"16px",color:"#000",lineHeight:"1.2em",outline:"none",overflow:"auto","-webkit-user-select":"text"}),o.className="text-editor",this.textEditorElement=o,e.append(o),o.addEventListener("paste",this.onPaste),onClickOutside$1([this.textElementContainer,this.textElement],this.onBlur.bind(this))}},{key:"setCss",value:function(e,n){if(e&&n)for(var o in n)e.style[o]=n[o]}},{key:"renderTextElement",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e);this.start={x:n.x-12,y:n.y-12};var o=document.createElement("div");this.setCss(o,{position:"absolute",left:n.x-12+"px",top:n.y-12+"px",zIndex:6,color:"#FF0000"}),this.layer.eventBus.dispatch("textAdd",{left:n.x-12,top:n.y-12}),o.innerHTML=this.textNoteStr,o.className="text",this.textElement=o,this.setTextEditor(n),this.textElement.append(this.textElementContainer)}},{key:"handlePaste",value:function(e){pastePlainText(e)}}])}(),TextField=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="textfield",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.onBlur=w.handleBlur.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setProperty=w.setProperty.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var s,w,m,v;this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight);var g=this.annotation;!g.fontStyle&&(g.fontStyle="normal"),!g.fontWeight&&(g.fontWeight="normal"),!g.borderStyle&&(g.borderStyle="solid"),!g.borderColor&&(g.borderColor="#000000"),!g.borderWidth&&(g.borderWidth=0),!g.color&&(g.color="#000000"),!g.fillColor&&(g.fillColor="transparent"),g.required=(s=g.required)!==null&&s!==void 0?s:0,g.indicator=(w=g.indicator)!==null&&w!==void 0&&w,g.indicatorText=(m=g.indicatorText)!==null&&m!==void 0?m:"",g.contents||(g.contents=""),"required"in g||(g.required=0),g.textAlignment||(g.textAlignment="left"),this.scale=this.documentViewer.scale;var d=this.getActualRect(this.documentViewer.scale),f=d.start,y=d.end;this.start=f,this.end=y;var x=this.getWidth(),k=this.getHeight(),P=this.calculate(f,y),S=document.createElement("div");S.id=g.name,S.className="annotation",S.style.top="calc(var(--scale-factor) * ".concat(g.rect.top,"px)"),S.style.left="calc(var(--scale-factor) * ".concat(g.rect.left,"px)"),S.style.width="calc(var(--scale-factor) * ".concat(x,"px)"),S.style.height="calc(var(--scale-factor) * ".concat(k,"px)"),S.style.backgroundColor=this.highlight?"#4982E54D":"",S.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(S.style.display="none"),this.annotationContainer=S,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this));var E=document.createElement("div");E.classList.add("indicator");var M=document.createElement("div");M.innerText=(v=g.indicatorText)!==null&&v!==void 0?v:"",E.append(M),this.setCss(E,{top:"calc(var(--scale-factor) * ".concat((g.rect.top+g.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=E;var T=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative"});this.shapeElement=T,this.getImage(),this.annotationContainer.append(this.shapeElement),this.setMultiLine(g.isMultiLine),this.shapeElement.append(this.textContainer),this.textContainer.addEventListener("blur",this.onBlur),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:P.left+P.width-84+"px",top:P.top+P.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr;var D=document.createElementNS("http://www.w3.org/2000/svg","svg");D.style.position="absolute",D.style.zIndex=1,D.style.left="".concat(P.left-4,"px"),D.style.top="".concat(P.top-4,"px"),D.style.width="".concat(P.width+8,"px"),D.style.height="".concat(P.height+8,"px"),this.outerLine=D,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:P.width,height:P.height,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:P.height/2+1}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:P.height+1}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:P.width/2+1,y:P.height+1}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:P.width+1,y:P.height+1}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:P.width+1,y:P.height/2+1}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:P.width+1,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:P.width/2+1,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(g.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):g.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1}},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"setFieldIndicator",value:function(s,w){var m,v,g=this.annotation,d={};s!==g.indicator&&(g.indicator=s,d.indicator=s,s?this.layer.pageDiv.append(this.indicatorBox):(m=this.indicatorBox)===null||m===void 0||m.remove()),typeof w=="string"&&w!==g.indicatorText&&(g.indicatorText=w,d.indicatorText=w,s?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove(),this.indicatorBox.querySelector("div").innerText=w),("indicator"in d||"indicatorText"in d)&&this.setAnnotationChanged(_objectSpread2$1({},d))}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w,m=this;if(this.setPopupElementStyle(),this.outSideListener&&document.removeEventListener(isMobileDevice$1?"touchstart":"mousedown",this.outSideListener),!(!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)))if(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode())setTimeout(function(){m.textContainer.focus(),m.textContainer.setSelectionRange(m.textContainer.value.length,m.textContainer.value.length)},0),this.textContainer.style.pointerEvents="auto",this.textContainer.style.cursor="text",this.textContainer.style.opacity="",this.imgEle.style.opacity=0,this.focus();else{this.hidden=!1,this.updateTool();var v=[this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("formPropertyPanelButton"),document.getElementsByClassName("right-panel")[0]];this.documentViewer.eventBus._on("textfieldPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1(v,this.handleOutside.bind(this)),this.textContainer.style.pointerEvents="none",this.textContainer.style.cursor="pointer"}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s=this.documentViewer.annotationStore.selectedElementName,w=this.annotation.name;this.hidden||s!==w||(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,s===w&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLine.removeEventListener("mousedown",this.onMousedown),this.outerLine.removeEventListener("touchstart",this.onMousedown),this.outerLineContainer.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("textfieldPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleBlur",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P=this;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:for(w=null,m=0,v=0,this.annotation.contents!==this.textContainer.value&&(this.annotation.contents=this.textContainer.value,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getContents()),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{type:"textfield",operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,contents:this.annotation.contents}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()),this.outSideListener=onClickOutside$1([this.annotationContainer],this.blur.bind(this)),g=this.documentViewer.getAnnotationManager().getAnnotationsList(),d=g.findIndex(function(E){return E.name===P.annotation.name}),f=d+1;f<g.length;f++)(y=g[f]).type!=="textfield"||y.contents||(this.annotation.contents&&!w&&(w=y),m++,y.required&&v++);for(x=0;x<d;x++)(k=g[x]).type!=="textfield"||k.contents||(!w&&(w=k),m++,k.required&&v++);this.documentViewer.isFillConsecutively()&&w&&this.documentViewer.jumpToAnnotation(w),this.annotation.contents||(m++,this.annotation.required&&v++),this.documentViewer.eventBus.dispatch("textfieldsFilledComplete",{unFilledAllNumber:m,unFilledNumber:v}),this.textContainer.style.pointerEvents="none",this.textContainer.style.cursor="pointer",this.textContainer.style.opacity=0,this.imgEle.style.opacity="";case 16:case"end":return S.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(y.x-x.x),be=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y)):we+2===Ae&&(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;v>k.clickY?ke=(ke=d.offsetHeight-(le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(ke=(ke=Le.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?oe=(oe=d.offsetWidth-(le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(oe=(oe=Le.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(oe||ke)&&(d.scrollTop+=ke,d.scrollLeft+=oe);var Ce={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-Ce.width,J),Z=Math.max(Ce.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-Ce.width,Z),J=Math.max(Ce.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-Ce.height,fe),j=Math.max(Ce.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-Ce.height,j),fe=Math.max(Ce.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){this.layer&&this.layer.tool&&s&&s.stopPropagation(),this.delete();var w={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(w.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",w),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w,m;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.indicatorBox)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((v.rect.top+v.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){E.next=39;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=29,this.documentViewer.annotationManager.createAnnotation(k);case 29:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=34,this.documentViewer.annotationManager.addAnnotation(S);case 34:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=42;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 42:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-4,"px"),this.outerLine.style.top="".concat(v.top-4,"px"),this.outerLine.style.width="".concat(v.width+8,"px"),this.outerLine.style.height="".concat(v.height+8,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width),this.moveRect.setAttribute("height",v.height),this.LeftRect.setAttribute("y",v.height/2+1),this.bottomLeftRect.setAttribute("y",v.height+1),this.bottomRect.setAttribute("x",v.width/2+1),this.bottomRect.setAttribute("y",v.height+1),this.bottomRightRect.setAttribute("x",v.width+1),this.bottomRightRect.setAttribute("y",v.height+1),this.rightRect.setAttribute("x",v.width+1),this.rightRect.setAttribute("y",v.height/2+1),this.topRightRect.setAttribute("x",v.width+1),this.topRect.setAttribute("x",v.width/2+1)}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"textfield",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"contents",set:function(s){this.setContents(s)}},{key:"setContents",value:function(s){if(s!==this.contents){var w=this.annotation;w.contents=s,this.textContainer.nodeName==="INPUT"?this.textContainer.value=s:this.textContainer.innerHTML=w.contents,w.contents=s,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getContents()),this.setAnnotationChanged({contents:s})}}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"name",get:function(){return this.annotation.name}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.shapeElement.style.backgroundColor=s,this.textContainer.style.backgroundColor=s,this.annotation.backgroundColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"textAlignment",get:function(){return this.annotation.textAlignment},set:function(s){this.textContainer.style.textAlign=s,this.annotation.textAlignment=s,this.setAnnotationChanged({textAlignment:s})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(s){var w=this.annotation;this.documentViewer.scale,this.textContainer.style.fontSize="calc(var(--scale-factor) * ".concat(s,"px)"),w.fontSize=s,this.setAnnotationChanged({color:w.color,fontSize:s,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"color",get:function(){return this.annotation.color},set:function(s){var w=this.annotation;this.textContainer.style.color=s,w.color=s,this.setAnnotationChanged({color:s,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(s){var w=this.annotation;this.textContainer.style.fontFamily=s,w.fontName=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:s,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(s){var w=this.annotation;this.textContainer.style.fontStyle=s,w.fontStyle=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:s,fontWeight:w.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(s){var w=this.annotation;this.textContainer.style.fontWeight=s,w.fontWeight=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:s})}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isMultiLine",get:function(){return this.annotation.isMultiLine},set:function(s){this.changeElementMultiLine(s),this.annotation.isMultiLine=s,this.setAnnotationChanged({isMultiLine:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotationContainer.style.display=s?"none":"block",this.setAnnotationChanged({isHidden:s?1:0})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(s){this.textContainer.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(s){this.textContainer.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.textContainer.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"fillTransparency",get:function(){return this.annotation.opacity},set:function(s){this.setAnnotationChanged({fillTransparency:s})}},{key:"handlePropertyPanel",value:function(s){var w=this;if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var m=this.annotation,v=0;for(var g in s)for(var d in this.annotation)if(d===g&&this.annotation[d]!==s[g]){var f,y;s.contents!==""&&(this.annotation[d]=s[g],v++),g==="fillColor"&&(this.textContainer.style[g]=s[g]),g==="textAlignment"&&(this.textContainer.style.textAlign=s[g]),g==="fontSize"&&(this.textContainer.style.fontSize="calc(var(--scale-factor) * ".concat(s[g],"px)")),g==="color"&&(this.textContainer.style.color=s[g]),g==="fontName"&&(this.textContainer.style.fontFamily=s[g]),g==="fontStyle"&&(this.textContainer.style.fontStyle=s[g]),g==="fontWeight"&&(this.textContainer.style.fontWeight=s[g]),g==="contents"&&(this.textContainer.nodeName==="INPUT"?this.textContainer.value=s[g]:this.textContainer.innerHTML=this.annotation.contents,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getContents())),g==="isMultiLine"&&this.changeElementMultiLine(s[g]),g==="indicator"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(f=this.indicatorBox)===null||f===void 0||f.remove()),g==="indicatorText"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(y=this.indicatorBox)===null||y===void 0||y.remove(),this.indicatorBox.querySelector("div").innerText=s[g])}if(v>0){var x={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr},k=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(q){return s[q]});k&&(x.fontSize=m.fontSize,x.color=m.color,x.fontName=m.fontName,x.fontStyle=m.fontStyle,x.fontWeight=m.fontWeight);var P=Object.assign({},x,s),S=0,E=0;if("contents"in P&&P.contents){for(var M=this.documentViewer.getAnnotationManager().getAnnotationsList(),T=M.findIndex(function(q){return q.name===w.annotation.name}),D=null,N=T+1;N<M.length;N++){var I=M[N];I.type!=="textfield"||I.contents||(!D&&(D=I),S++,I.required&&E++)}for(var O=0;O<T;O++){var F=M[O];F.type!=="textfield"||F.contents||(!D&&(D=F),S++,F.required&&E++)}this.documentViewer.isFillConsecutively()&&D&&this.documentViewer.jumpToAnnotation(D)}"contents"in P&&(P.contents||(S++,this.annotation.required&&E++),this.documentViewer.eventBus.dispatch("textfieldsFilledComplete",{unFilledAllNumber:S,unFilledNumber:E})),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:P}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}},{key:"changeElementMultiLine",value:function(s){this.textContainer.remove(),this.textContainer=null,this.setMultiLine(s),this.shapeElement.append(this.textContainer),this.textContainer.removeEventListener("blur",this.onBlur),this.textContainer.addEventListener("blur",this.onBlur)}},{key:"setMultiLine",value:function(s){var w=null;s?(w=createElement("textarea",{position:"absolute",left:0,top:0,width:"100%",height:"100%",outline:"none",borderColor:this.annotation.borderColor,borderStyle:this.annotation.borderStyle,borderWidth:this.annotation.borderWidth+"px",borderRadius:0,color:this.annotation.color,backgroundColor:this.annotation.fillColor,pointerEvents:"none",cursor:"pointer",resize:"none",overflowWrap:"break-word",textAlign:this.annotation.textAlignment,fontSize:"calc(var(--scale-factor) * ".concat(this.annotation.fontSize,"px)"),fontWeight:this.annotation.fontWeight,fontStyle:this.annotation.fontStyle,fontFamily:this.annotation.fontName,opacity:0})).innerHTML=this.annotation.contents:w=createElement("input",{position:"absolute",left:0,top:0,width:"100%",height:"100%",outline:"none",borderColor:this.annotation.borderColor,borderStyle:this.annotation.borderStyle,borderWidth:this.annotation.borderWidth+"px",borderRadius:0,color:this.annotation.color,backgroundColor:this.annotation.fillColor,pointerEvents:"none",cursor:"pointer",textAlign:this.annotation.textAlignment,fontSize:"calc(var(--scale-factor) * ".concat(this.annotation.fontSize,"px)"),fontWeight:this.annotation.fontWeight,fontStyle:this.annotation.fontStyle,fontFamily:this.annotation.fontName,opacity:0},{value:this.annotation.contents}),this.textContainer=w,this.annotation.fontStyle}},{key:"setProperty",value:function(s){if(s.name===this.annotation.name){for(var w in s)for(var m in this.annotation)if(m===w&&this.annotation[m]!==s[w]){var v,g;s.contents!==""&&(this.annotation[m]=s[w],updatePropsNum++),w==="fillColor"&&(this.textContainer.style[w]=s[w]),w==="textAlignment"&&(this.textContainer.style.textAlign=s[w]),w==="fontSize"&&(this.textContainer.style.fontSize="calc(var(--scale-factor) * ".concat(s[w],"px)")),w==="color"&&(this.textContainer.style.color=s[w]),w==="fontName"&&(this.textContainer.style.fontFamily=s[w]),w==="fontStyle"&&(annotation.fontStyle=s[w],this.textContainer.style.fontStyle=s[w]),w==="fontWeight"&&(annotation.fontWeight=s[w],this.textContainer.style.fontWeight=s[w]),w==="contents"&&(this.textContainer.nodeName==="INPUT"?this.textContainer.value=s[w]:this.textContainer.innerHTML=this.annotation.contents,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getContents())),w==="isMultiLine"&&this.changeElementMultiLine(s[w]),w==="indicator"&&(s[w]?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove()),w==="indicatorText"&&(s[w]?this.layer.pageDiv.append(this.indicatorBox):(g=this.indicatorBox)===null||g===void 0||g.remove(),this.indicatorBox.querySelector("div").innerText=s[w])}var d={operate:"mod-form",pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr},f=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(x){return s[x]});f&&(d.fontSize=annotation.fontSize,d.color=annotation.color,d.fontName=annotation.fontName,d.fontStyle=annotation.fontStyle,d.fontWeight=annotation.fontWeight);var y=Object.assign({},d,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:y}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio),height:parseInt(m.height*this.ratio)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})},{key:"focus",value:function(){var s;this.shapeElement.classList.add("focus");var w=this.documentViewer.annotationManager;this.documentViewer.eventBus.dispatch("focus",this),w.focusedAnnotation&&w.focusedAnnotation===this||((s=w.focusedAnnotation)===null||s===void 0||s.shapeElement.classList.remove("focus"),w.focusedAnnotation=this,this.handleClick())}}]);var o,r,u}(),AddTextField=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initTextfieldName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initTextfieldName",this.initTextfieldName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initTextfieldName",this.initTextfieldName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"textfield",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,color:"#000000",fontName:"Helvetica",fontSize:14,textAlignment:"left",textFieldSpe:0,isMultiLine:!1};this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.fill")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="textfield"}),r=function(){var s="Text Field"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="Text Field"+e}}])}(),CheckBox$1=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="checkbox",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setProperty=w.setProperty.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight),!(d=this.annotation).borderstyle&&(d.borderstyle="solid"),!d.borderColor&&(d.borderColor="#000000"),!d.borderWidth&&(d.borderWidth=0),!d.color&&(d.color="#000000"),!d.fillColor&&(d.fillColor="transparent"),d.fieldName||(d.fieldName="Check Box_"+d.date.toLocaleString()),d.required=(w=d.required)!==null&&w!==void 0?w:0,d.indicator=(m=d.indicator)!==null&&m!==void 0&&m,d.indicatorText=(v=d.indicatorText)!==null&&v!==void 0?v:"",this.scale=this.documentViewer.scale,f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end,this.start=y,this.end=x,k=this.calculate(y,x),P=this.getWidth(),S=this.getHeight(),(E=document.createElement("div")).id=d.name,E.className="annotation",E.style.top="calc(var(--scale-factor) * ".concat(d.rect.top,"px)"),E.style.left="calc(var(--scale-factor) * ".concat(d.rect.left,"px)"),E.style.width="calc(var(--scale-factor) * ".concat(P,"px)"),E.style.height="calc(var(--scale-factor) * ".concat(S,"px)"),E.style.backgroundColor=this.highlight?"#4982E54D":"",E.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(E.style.display="none"),this.annotationContainer=E,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),(M=document.createElement("div")).classList.add("indicator"),(T=document.createElement("div")).innerText=(g=d.indicatorText)!==null&&g!==void 0?g:"",M.append(T),this.setCss(M,{top:"calc(var(--scale-factor) * ".concat((d.rect.top+d.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=M,D=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative"}),this.shapeElement=D,this.getImage(),this.annotationContainer.append(this.shapeElement),N=createElement("div",{position:"absolute",left:0,top:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",borderColor:d.borderColor,borderWidth:d.borderWidth+"px",borderStyle:d.borderStyle,backgroundColor:d.fillColor,opacity:0}),this.borderElement=N,I=createSvg("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none"},{width:"".concat(k.width/2,"px"),height:"".concat(k.height/2,"px")}),this.svgElement=I,O=createSvg("path",{d:"M14.0908 1.59619 L5.59625 10.0908 L1.00006 5.49457",stroke:"#43474D","stroke-width":"2"}),this.checkPath=O,F=createSvg("path",{d:"M0 7C0 3.13401 3.13401 0 7 0C10.866 0 14 3.13401 14 7C14 10.866 10.866 14 7 14C3.13401 14 0 10.866 0 7Z",fill:"#43474D"}),this.circlePath=F,q=createSvg("path",{d:"M6.00001 7.41421L10.1924 11.6066L11.6066 10.1924L7.41422 6L11.6066 1.80762L10.1924 0.393403L6.00001 4.58579L1.70711 0.292895L0.292897 1.70711L4.58579 6L0.292897 10.2929L1.70711 11.7071L6.00001 7.41421Z",fill:"#43474D","fill-rule":"evenodd","clip-rule":"evenodd"}),this.crossPath=q,Y=createSvg("path",{d:"M0 7.07108L7.07107 8.99256e-06L14.1421 7.07108L7.07107 14.1421L0 7.07108Z",fill:"#43474D"}),this.diamondPath=Y,_e=createSvg("rect",{width:"12",height:"12",fill:"#43474D"}),this.squarePath=_e,ne=createSvg("path",{d:"M8 0L10.3794 4.7251L15.6085 5.52786L11.8499 9.2509L12.7023 14.4721L8 12.048L3.29772 14.4721L4.15012 9.2509L0.391548 5.52786L5.62065 4.7251L8 0Z",fill:"#43474D"}),this.starPath=ne,this.setSelectedShape(d.checkStyle),d.isChecked===0&&(this.svgElement.style.display="none"),this.borderElement.append(this.svgElement),this.shapeElement.append(this.borderElement),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:k.left+k.width-84+"px",top:k.top+k.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(ve=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",ve.style.zIndex=1,ve.style.left="".concat(k.left-4,"px"),ve.style.top="".concat(k.top-4,"px"),ve.style.width="".concat(k.width+8,"px"),ve.style.height="".concat(k.height+8,"px"),this.outerLine=ve,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:k.width,height:k.height,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height/2+1}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height+1}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+1,y:k.height+1}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:k.height+1}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:k.height/2+1}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+1,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(d.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):d.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 106:case"end":return J.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"setFieldIndicator",value:function(s,w){var m,v,g=this.annotation,d={};s!==g.indicator&&(g.indicator=s,d.indicator=s,s?this.layer.pageDiv.append(this.indicatorBox):(m=this.indicatorBox)===null||m===void 0||m.remove()),typeof w=="string"&&w!==g.indicatorText&&(g.indicatorText=w,d.indicatorText=w,s?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove(),this.indicatorBox.querySelector("div").innerText=w),("indicator"in d||"indicatorText"in d)&&this.setAnnotationChanged(_objectSpread2$1({},d))}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w;if(this.setPopupElementStyle(),!(!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)))if(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode()){this.annotation.isChecked=this.annotation.isChecked==0?1:0,this.annotation.isChecked==1?this.svgElement.style.display="block":this.svgElement.style.display="none",this.focus(),this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF");var m={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,type:this.annotation.type,isChecked:this.annotation.isChecked};this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:m}),this.getImage()}else{this.hidden=!1,this.updateTool(),this.judgeCheckboxIsOne(),this.documentViewer.eventBus._on("checkboxPropertyPanelChanged",this.handlePropertyPanel);var v=[this.annotationContainer,this.outerLine,this.popupElement,document.querySelector(".right-panel")],g=document.getElementById("formPropertyPanelButton");g&&v.push(g),onClickOutside$1(v,this.handleOutside.bind(this))}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s,w,m,v=this.documentViewer.annotationStore.selectedElementName,g=this.annotation.name;this.hidden||v!==g||(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,v===g&&(this.documentViewer.annotationStore.selectedElementName=null),(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("checkboxPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(y.x-x.x),be=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y)):we+2===Ae&&(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;v>k.clickY?ke=(ke=d.offsetHeight-(le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(ke=(ke=Le.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?oe=(oe=d.offsetWidth-(le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(oe=(oe=Le.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(oe||ke)&&(d.scrollTop+=ke,d.scrollLeft+=oe);var Ce={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-Ce.width,J),Z=Math.max(Ce.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-Ce.width,Z),J=Math.max(Ce.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-Ce.height,fe),j=Math.max(Ce.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-Ce.height,j),fe=Math.max(Ce.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.judgeCheckboxIsOne(),this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.stopPropagation(),this.delete();var m={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(m.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",m),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w,m;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.indicatorBox)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((v.rect.top+v.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){E.next=39;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=29,this.documentViewer.annotationManager.createAnnotation(k);case 29:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=34,this.documentViewer.annotationManager.addAnnotation(S);case 34:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=42;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 42:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-4,"px"),this.outerLine.style.top="".concat(v.top-4,"px"),this.outerLine.style.width="".concat(v.width+8,"px"),this.outerLine.style.height="".concat(v.height+8,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width),this.moveRect.setAttribute("height",v.height),this.LeftRect.setAttribute("y",v.height/2+1),this.bottomLeftRect.setAttribute("y",v.height+1),this.bottomRect.setAttribute("x",v.width/2+1),this.bottomRect.setAttribute("y",v.height+1),this.bottomRightRect.setAttribute("x",v.width+1),this.bottomRightRect.setAttribute("y",v.height+1),this.rightRect.setAttribute("x",v.width+1),this.rightRect.setAttribute("y",v.height/2+1),this.topRightRect.setAttribute("x",v.width+1),this.topRect.setAttribute("x",v.width/2+1),this.svgElement.style.width="".concat(v.width/2,"px"),this.svgElement.style.height="".concat(v.height/2,"px")}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"checkbox",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents||""}},{key:"setContents",value:function(s){s!==this.contents&&(this.annotation.contents=s,this.setAnnotationChanged({contents:s}))}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.borderElement.style.backgroundColor=s,this.annotation.fillColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotationContainer.style.display=s?"none":"block",this.setAnnotationChanged({isHidden:s?1:0})}},{key:"checkStyle",get:function(){return CheckStyle[this.annotation.checkStyle]},set:function(s){s=CheckStyleNumber[s],this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s),this.annotation.checkStyle=s,this.setAnnotationChanged({checkStyle:s})}},{key:"isChecked",get:function(){return this.annotation.isChecked},set:function(s){this.svgElement.style.display=s?"block":"none",this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF"),this.annotation.isChecked=s,this.setAnnotationChanged({isChecked:s})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle||0},set:function(s){this.borderElement.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth||0},set:function(s){this.borderElement.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.borderElement.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"handlePropertyPanel",value:function(s){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var w=0;for(var m in s)for(var v in this.annotation){if(v===m&&this.annotation[v]!==s[m]&&m!=="fieldName"){var g,d;this.annotation[v]=s[m],w++,m==="fillColor"&&(this.borderElement.style[m]=s[m]),m==="checkStyle"&&(this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s[m])),m==="isChecked"&&(s[m]?this.svgElement.style.display="block":this.svgElement.style.display="none",this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF")),m==="indicator"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(g=this.indicatorBox)===null||g===void 0||g.remove()),m==="indicatorText"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(d=this.indicatorBox)===null||d===void 0||d.remove(),this.indicatorBox.querySelector("div").innerText=s[m])}v===m&&this.annotation[v]!==s[m]&&m==="fieldName"&&(this.judgeCheckboxIsOne(s[m]),this.isOne&&(this.annotation[v]=s[m],w++))}if(w>0){var f={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,type:this.annotation.type},y=Object.assign({},f,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:y}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}},{key:"setSelectedShape",value:function(s){s===1?(this.svgElement.setAttribute("width","14"),this.svgElement.setAttribute("height","14"),this.svgElement.setAttribute("viewBox","0 0 14 14"),this.svgElement.append(this.circlePath)):s===2?(this.svgElement.setAttribute("width","12"),this.svgElement.setAttribute("height","12"),this.svgElement.setAttribute("viewBox","0 0 12 12"),this.svgElement.append(this.crossPath)):s===3?(this.svgElement.setAttribute("width","15"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 15 15"),this.svgElement.append(this.diamondPath)):s===4?(this.svgElement.setAttribute("width","12"),this.svgElement.setAttribute("height","12"),this.svgElement.setAttribute("viewBox","0 0 12 12"),this.svgElement.append(this.squarePath)):s===5?(this.svgElement.setAttribute("width","16"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 16 15"),this.svgElement.append(this.starPath)):(this.svgElement.setAttribute("width","15"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 15 12"),this.svgElement.append(this.checkPath))}},{key:"setProperty",value:function(s){if(s.name===this.annotation.name){var w=this.annotation;for(var m in s)for(var v in w)v===m&&w[v]!==s[m]&&(w[v]=s[m],m==="fillColor"&&(this.borderElement.style[m]=s[m]),m==="checkStyle"&&(this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s[m])),m==="isChecked"&&(s[m]?this.svgElement.style.display="block":this.svgElement.style.display="none",this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF")));var g={operate:"mod-form",pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,type:this.annotation.type},d=Object.assign({},g,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:d}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}},{key:"judgeCheckboxIsOne",value:function(s){var w=s!=null?s:this.annotation.fieldName,m=this.documentViewer.getAnnotationManager().getAnnotationsList();this.isOne=!0;var v,g=_createForOfIteratorHelper(m);try{for(g.s();!(v=g.n()).done;){var d=v.value;if(d.fieldName&&d.fieldName===w&&d.name!==this.annotation.name&&d.type==="checkbox"){this.isOne=!1;break}}}catch(f){g.e(f)}finally{g.f()}this.documentViewer.eventBus.dispatch("judgeCheckboxIsOne",this.isOne)}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio),height:parseInt(m.height*this.ratio)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.position="absolute",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})}]);var o,r,u}(),AddCheckBox=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initCheckboxName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initCheckboxName",this.initCheckboxName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initCheckboxName",this.initCheckboxName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"checkbox",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,isChecked:0,checkStyle:0};this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.fill")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",borderColor:"#43474D",borderWidth:0,borderStyle:"solid",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="checkbox"}),r=function(){var s="Check Box"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="Check Box"+e}}])}(),RadioButton=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="radiobutton",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setProperty=w.setProperty.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight),!(d=this.annotation).borderstyle&&(d.borderstyle="solid"),!d.borderColor&&(d.borderColor="#000000"),!d.borderWidth&&(d.borderWidth=0),!d.color&&(d.color="#000000"),!d.fillColor&&(d.fillColor="transparent"),this.annotation.fieldName||(this.annotation.fieldName="Group_"+this.annotation.date.toLocaleString()),d.required=(w=d.required)!==null&&w!==void 0?w:0,d.indicator=(m=d.indicator)!==null&&m!==void 0&&m,d.indicatorText=(v=d.indicatorText)!==null&&v!==void 0?v:"",this.scale=this.documentViewer.scale,f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end,this.start=y,this.end=x,k=this.calculate(y,x),P=this.getWidth(),S=this.getHeight(),(E=document.createElement("div")).id=d.name,E.className="annotation",E.style.top="calc(var(--scale-factor) * ".concat(d.rect.top,"px)"),E.style.left="calc(var(--scale-factor) * ".concat(d.rect.left,"px)"),E.style.width="calc(var(--scale-factor) * ".concat(P,"px)"),E.style.height="calc(var(--scale-factor) * ".concat(S,"px)"),E.style.backgroundColor=this.highlight?"#4982E54D":"",E.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(E.style.display="none"),this.annotationContainer=E,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),(M=document.createElement("div")).classList.add("indicator"),(T=document.createElement("div")).innerText=(g=d.indicatorText)!==null&&g!==void 0?g:"",M.append(T),this.setCss(M,{top:"calc(var(--scale-factor) * ".concat((d.rect.top+d.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=M,D=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative"}),this.shapeElement=D,this.getImage(),this.annotationContainer.append(this.shapeElement),N=createElement("div",{position:"absolute",left:0,top:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",borderColor:d.borderColor,borderWidth:d.borderWidth+"px",borderStyle:d.borderStyle,borderRadius:"100%",backgroundColor:d.fillColor,opacity:0}),this.borderElement=N,I=createSvg("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none"},{width:"".concat(k.width/2,"px"),height:"".concat(k.height/2,"px")}),this.svgElement=I,O=createSvg("path",{d:"M14.0908 1.59619 L5.59625 10.0908 L1.00006 5.49457",stroke:"#43474D","stroke-width":"2"}),this.checkPath=O,F=createSvg("path",{d:"M0 7C0 3.13401 3.13401 0 7 0C10.866 0 14 3.13401 14 7C14 10.866 10.866 14 7 14C3.13401 14 0 10.866 0 7Z",fill:"#43474D"}),this.circlePath=F,q=createSvg("path",{d:"M6.00001 7.41421L10.1924 11.6066L11.6066 10.1924L7.41422 6L11.6066 1.80762L10.1924 0.393403L6.00001 4.58579L1.70711 0.292895L0.292897 1.70711L4.58579 6L0.292897 10.2929L1.70711 11.7071L6.00001 7.41421Z",fill:"#43474D","fill-rule":"evenodd","clip-rule":"evenodd"}),this.crossPath=q,Y=createSvg("path",{d:"M0 7.07108L7.07107 8.99256e-06L14.1421 7.07108L7.07107 14.1421L0 7.07108Z",fill:"#43474D"}),this.diamondPath=Y,_e=createSvg("rect",{width:"12",height:"12",fill:"#43474D"}),this.squarePath=_e,ne=createSvg("path",{d:"M8 0L10.3794 4.7251L15.6085 5.52786L11.8499 9.2509L12.7023 14.4721L8 12.048L3.29772 14.4721L4.15012 9.2509L0.391548 5.52786L5.62065 4.7251L8 0Z",fill:"#43474D"}),this.starPath=ne,this.setSelectedShape(d.checkStyle),d.isChecked==0&&(this.svgElement.style.display="none"),this.borderElement.append(this.svgElement),this.shapeElement.append(this.borderElement),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:k.left+k.width-84+"px",top:k.top+k.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(ve=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",ve.style.zIndex=1,ve.style.left="".concat(k.left-4,"px"),ve.style.top="".concat(k.top-4,"px"),ve.style.width="".concat(k.width+8,"px"),ve.style.height="".concat(k.height+8,"px"),this.outerLine=ve,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:k.width,height:k.height,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height/2+1}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height+1}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+1,y:k.height+1}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:k.height+1}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:k.height/2+1}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+1,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+1,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(this.annotation.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):this.annotation.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 106:case"end":return J.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"setFieldIndicator",value:function(s,w){var m,v,g=this.annotation,d={};s!==g.indicator&&(g.indicator=s,d.indicator=s,s?this.layer.pageDiv.append(this.indicatorBox):(m=this.indicatorBox)===null||m===void 0||m.remove()),typeof w=="string"&&w!==g.indicatorText&&(g.indicatorText=w,d.indicatorText=w,s?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove(),this.indicatorBox.querySelector("div").innerText=w),("indicator"in d||"indicatorText"in d)&&this.setAnnotationChanged(_objectSpread2$1({},d))}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w;if(this.setPopupElementStyle(),!(!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)))if(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode()){this.annotation.isChecked=this.annotation.isChecked==0?1:0,this.annotation.isChecked==0?this.svgElement.style.display="none":(this.svgElement.style.display="block",this.cancelSameGroupButton()),this.focus(),this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF");var m={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,type:this.annotation.type,isChecked:this.annotation.isChecked};this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:m}),this.getImage()}else this.hidden=!1,this.updateTool(),this.judgeRadioBtnIsOne(),this.documentViewer.eventBus._on("radioButtonPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("formPropertyPanelButton"),document.getElementsByClassName("right-panel")[0]],this.handleOutside.bind(this))}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s,w,m,v=this.documentViewer.annotationStore.selectedElementName,g=this.annotation.name;this.hidden||v!==g||(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,v===g&&(this.documentViewer.annotationStore.selectedElementName=null),(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("radioButtonPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(y.x-x.x),be=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y)):we+2===Ae&&(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;v>k.clickY?ke=(ke=d.offsetHeight-(le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(ke=(ke=Le.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?oe=(oe=d.offsetWidth-(le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(oe=(oe=Le.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(oe||ke)&&(d.scrollTop+=ke,d.scrollLeft+=oe);var Ce={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-Ce.width,J),Z=Math.max(Ce.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-Ce.width,Z),J=Math.max(Ce.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-Ce.height,fe),j=Math.max(Ce.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-Ce.height,j),fe=Math.max(Ce.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.stopPropagation(),this.delete();var m={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(m.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",m),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w,m;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.indicatorBox)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((v.rect.top+v.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){E.next=39;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=29,this.documentViewer.annotationManager.createAnnotation(k);case 29:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=34,this.documentViewer.annotationManager.addAnnotation(S);case 34:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=42;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 42:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-4,"px"),this.outerLine.style.top="".concat(v.top-4,"px"),this.outerLine.style.width="".concat(v.width+8,"px"),this.outerLine.style.height="".concat(v.height+8,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width),this.moveRect.setAttribute("height",v.height),this.LeftRect.setAttribute("y",v.height/2+1),this.bottomLeftRect.setAttribute("y",v.height+1),this.bottomRect.setAttribute("x",v.width/2+1),this.bottomRect.setAttribute("y",v.height+1),this.bottomRightRect.setAttribute("x",v.width+1),this.bottomRightRect.setAttribute("y",v.height+1),this.rightRect.setAttribute("x",v.width+1),this.rightRect.setAttribute("y",v.height/2+1),this.topRightRect.setAttribute("x",v.width+1),this.topRect.setAttribute("x",v.width/2+1),this.svgElement.style.width="".concat(v.width/2,"px"),this.svgElement.style.height="".concat(v.height/2,"px")}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"radiobutton",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents||""}},{key:"setContents",value:function(s){s!==this.contents&&(this.annotation.contents=s,this.setAnnotationChanged({contents:s}))}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.borderElement.style.backgroundColor=s,this.annotation.fillColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotationContainer.style.display=s?"none":"block",this.setAnnotationChanged({isHidden:s?1:0})}},{key:"checkStyle",get:function(){return CheckStyle[this.annotation.checkStyle]},set:function(s){s=CheckStyleNumber[s],this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s),this.annotation.checkStyle=s,this.setAnnotationChanged({checkStyle:s})}},{key:"isChecked",get:function(){return this.annotation.isChecked},set:function(s){s?(this.svgElement.style.display="block",this.cancelSameGroupButton()):this.svgElement.style.display="none",this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF"),this.annotation.isChecked=s,this.setAnnotationChanged({isChecked:s})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(s){this.borderElement.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth||0},set:function(s){this.borderElement.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.borderElement.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"handlePropertyPanel",value:function(s){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var w=0;for(var m in s)for(var v in this.annotation)if(v===m&&this.annotation[v]!==s[m]){var g,d;this.annotation[v]=s[m],w++,m==="fillColor"&&(this.borderElement.style[m]=s[m],s[m]===""&&(s.clearBackgroundColor=!0)),m==="checkStyle"&&(this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s[m])),m==="isChecked"&&(s[m]?(this.svgElement.style.display="block",this.cancelSameGroupButton()):this.svgElement.style.display="none",this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF")),m==="fieldName"&&this.judgeRadioBtnIsOne(),m==="indicator"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(g=this.indicatorBox)===null||g===void 0||g.remove()),m==="indicatorText"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(d=this.indicatorBox)===null||d===void 0||d.remove(),this.indicatorBox.querySelector("div").innerText=s[m])}if(w>0){var f={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,type:this.annotation.type},y=Object.assign({},f,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:y}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}},{key:"setSelectedShape",value:function(s){s===1?(this.svgElement.setAttribute("width","14"),this.svgElement.setAttribute("height","14"),this.svgElement.setAttribute("viewBox","0 0 14 14"),this.svgElement.append(this.circlePath)):s===2?(this.svgElement.setAttribute("width","12"),this.svgElement.setAttribute("height","12"),this.svgElement.setAttribute("viewBox","0 0 12 12"),this.svgElement.append(this.crossPath)):s===3?(this.svgElement.setAttribute("width","15"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 15 15"),this.svgElement.append(this.diamondPath)):s===4?(this.svgElement.setAttribute("width","12"),this.svgElement.setAttribute("height","12"),this.svgElement.setAttribute("viewBox","0 0 12 12"),this.svgElement.append(this.squarePath)):s===5?(this.svgElement.setAttribute("width","16"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 16 15"),this.svgElement.append(this.starPath)):(this.svgElement.setAttribute("width","15"),this.svgElement.setAttribute("height","15"),this.svgElement.setAttribute("viewBox","0 0 15 12"),this.svgElement.append(this.checkPath))}},{key:"setProperty",value:function(s){if(s.name===this.annotation.name){for(var w in s)for(var m in this.annotation)m===w&&this.annotation[m]!==s[w]&&(this.annotation[m]=s[w],w==="fillColor"&&(this.borderElement.style[w]=s[w]),w==="checkStyle"&&(this.svgElement.removeChild(this.svgElement.firstChild),this.setSelectedShape(s[w])),w==="isChecked"&&(s[w]==0?this.svgElement.style.display="none":(this.svgElement.style.display="block",this.cancelSameGroupButton()),this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.isChecked?"ON":"OFF")),w==="fieldName"&&this.judgeRadioBtnIsOne());var v={operate:"mod-form",pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,type:this.annotation.type},g=Object.assign({},v,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:g}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}},{key:"cancelSameGroupButton",value:function(){var s,w=this,m=_createForOfIteratorHelper(this.documentViewer.getAnnotationManager().getAnnotationsList().filter(function(g){return g.fieldName===w.fieldName&&g.name!==w.name&&g.isChecked!=0&&g.type==="radiobutton"}));try{for(m.s();!(s=m.n()).done;){var v=s.value;this.documentViewer.eventBus.dispatch("handleField",{id:v.name,key:"isChecked",value:0})}}catch(g){m.e(g)}finally{m.f()}}},{key:"judgeRadioBtnIsOne",value:function(){var s,w=!0,m=_createForOfIteratorHelper(this.documentViewer.getAnnotationManager().getAnnotationsList());try{for(m.s();!(s=m.n()).done;){var v=s.value;if(v.hasOwnProperty("fieldName")&&v.fieldName===this.annotation.fieldName&&v.name!==this.annotation.name&&v.type==="radiobutton"){w=!1;break}}}catch(g){m.e(g)}finally{m.f()}this.documentViewer.eventBus.dispatch("judgeRadioBtnIsOne",w)}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio+1),height:parseInt(m.height*this.ratio+1)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})}]);var o,r,u}(),AddRadioButton=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initRadioButtonName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initRadioButtonName",this.initRadioButtonName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initRadioButtonName",this.initRadioButtonName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"radiobutton",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,isChecked:0,checkStyle:1};this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.fill")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",borderColor:"#43474D",borderWidth:0,borderStyle:"solid",borderRadius:"100%",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="radiobutton"}),r=function(){var s="Group"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="Group"+e}}])}(),PushButton=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="pushbutton",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setProperty=w.setProperty.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight),!(w=this.annotation).fontStyle&&(w.fontStyle="normal"),!w.fontWeight&&(w.fontWeight="normal"),!w.borderstyle&&(w.borderstyle="solid"),!w.borderColor&&(w.borderColor="#000000"),!w.borderWidth&&(w.borderWidth=0),!w.color&&(w.color="#000000"),!w.fillColor&&(w.fillColor="transparent"),this.scale=this.documentViewer.scale,m=this.getActualRect(this.documentViewer.scale),v=m.start,g=m.end,this.start=v,this.end=g,d=this.calculate(v,g),f=this.getWidth(),y=this.getHeight(),(x=document.createElement("div")).id=w.name,x.className="annotation",x.style.top="calc(var(--scale-factor) * ".concat(w.rect.top,"px)"),x.style.left="calc(var(--scale-factor) * ".concat(w.rect.left,"px)"),x.style.width="calc(var(--scale-factor) * ".concat(f,"px)"),x.style.height="calc(var(--scale-factor) * ".concat(y,"px)"),x.style.backgroundColor=this.highlight?"#4982E54D":"",x.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(x.style.display="none"),this.annotationContainer=x,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),k=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative"}),this.shapeElement=k,this.getImage(),this.annotationContainer.append(this.shapeElement),this.buttonContainer=createElement("a",{position:"absolute",left:0,top:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",outline:"none",borderColor:w.borderColor,borderWidth:w.borderWidth+"px",borderStyle:w.borderStyle,color:w.color,backgroundColor:w.fillColor,fontFamily:w.fontName,fontSize:w.fontSize+"px",fontWeight:w.fontWeight,fontStyle:w.fontStyle,overflow:"hidden",textDecoration:"none",opacity:0}),this.buttonContainer.innerHTML=w.title,this.shapeElement.append(this.buttonContainer),this.buttonContainer.addEventListener("blur",this.onBlur),this.annotation.url&&(this.buttonContainer.setAttribute("href",this.annotation.url),this.buttonContainer.setAttribute("target","_blank")),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:d.left+d.width-84+"px",top:d.top+d.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(P=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",P.style.zIndex=1,P.style.left="".concat(d.left-8,"px"),P.style.top="".concat(d.top-8,"px"),P.style.width="".concat(d.width+16,"px"),P.style.height="".concat(d.height+16,"px"),this.outerLine=P,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:d.width+8,height:d.height+8,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:d.height/2+5}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:d.height+9}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:d.width/2+5,y:d.height+9}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:d.width+9,y:d.height+9}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:d.width+9,y:d.height/2+5}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:d.width+9,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:d.width/2+5,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(this.annotation.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):this.annotation.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&this.layer&&(!this.layer.addMode&&this.selectAnnotation(),this.toggleAttrbutePanel()),this.show=!1;case 82:case"end":return S.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w;if(this.setPopupElementStyle(),!(!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)))if(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode())this.annotation.actionType==1&&this.annotation.destPage?this.documentViewer.eventBus.dispatch("pageNumberChanged",this.annotation.destPage):this.annotation.actionType==6&&this.annotation.url&&this.buttonContainer.click();else{this.hidden=!1,this.updateTool();var m=[this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("formPropertyPanelButton"),document.getElementsByClassName("right-panel")[0]];this.documentViewer.eventBus._on("pushButtonPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1(m,this.handleOutside.bind(this))}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s,w,m,v=this.documentViewer.annotationStore.selectedElementName,g=this.annotation.name;this.hidden||v!==g||(this.documentViewer.eventBus.dispatch("propertyChange",null),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,v===g&&(this.documentViewer.annotationStore.selectedElementName=null),(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("pushButtonPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(y.x-x.x),be=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y)):we+2===Ae&&(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;v>k.clickY?ke=(ke=d.offsetHeight-(le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(ke=(ke=Le.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?oe=(oe=d.offsetWidth-(le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(oe=(oe=Le.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(oe||ke)&&(d.scrollTop+=ke,d.scrollLeft+=oe);var Ce={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-Ce.width,J),Z=Math.max(Ce.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-Ce.width,Z),J=Math.max(Ce.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-Ce.height,fe),j=Math.max(Ce.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-Ce.height,j),fe=Math.max(Ce.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){this.layer&&this.layer.tool&&s&&s.stopPropagation(),this.delete();var w={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(w.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",w),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),this.annotation.isDelete=!0,(w=this.layer)===null||w===void 0||w.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.PrePageNumber===this.PageNumber){E.next=38;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=28,this.documentViewer.annotationManager.createAnnotation(k);case 28:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=33,this.documentViewer.annotationManager.addAnnotation(S);case 33:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=41;break;case 38:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 41:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-8,"px"),this.outerLine.style.top="".concat(v.top-8,"px"),this.outerLine.style.width="".concat(v.width+16,"px"),this.outerLine.style.height="".concat(v.height+16,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width+9),this.moveRect.setAttribute("height",v.height+9),this.LeftRect.setAttribute("y",v.height/2+5),this.bottomLeftRect.setAttribute("y",v.height+9),this.bottomRect.setAttribute("x",v.width/2+5),this.bottomRect.setAttribute("y",v.height+9),this.bottomRightRect.setAttribute("x",v.width+9),this.bottomRightRect.setAttribute("y",v.height+9),this.rightRect.setAttribute("x",v.width+9),this.rightRect.setAttribute("y",v.height/2+5),this.topRightRect.setAttribute("x",v.width+9),this.topRect.setAttribute("x",v.width/2+5)}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"pushbutton",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getTitle",value:function(){return this.annotation.title}},{key:"seTitle",value:function(s){var w=this.annotation;s!==w.title&&(this.buttonContainer.innerHTML=s,w.title=s,this.setAnnotationChanged({title:s}))}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.buttonContainer.style.backgroundColor=s,this.annotation.fillColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(s){var w=this.annotation,m=this.documentViewer.scale;this.buttonContainer.style.fontSize=s*m+"px",w.fontSize=s,this.setAnnotationChanged({color:w.color,fontSize:s,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"color",get:function(){return this.annotation.color},set:function(s){var w=this.annotation;this.buttonContainer.style.color=s,w.color=s,this.setAnnotationChanged({color:s,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(s){var w=this.annotation;this.buttonContainer.style.fontFamily=s,w.fontName=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:s,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(s){var w=this.annotation;this.buttonContainer.style.fontStyle=s,w.fontStyle=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:s,fontWeight:w.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(s){var w=this.annotation;this.buttonContainer.style.fontWeight=s,w.fontWeight=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:s})}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotation.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):this.annotation.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto"),this.setAnnotationChanged({isHidden:s?1:0})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(s){this.buttonContainer.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(s){this.buttonContainer.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.buttonContainer.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"handlePropertyPanel",value:function(s){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var w=this.annotation,m=0;for(var v in s)for(var g in this.annotation)g===v&&this.annotation[g]!==s[v]&&(this.annotation[g]=s[v],m++,v==="fillColor"&&(this.buttonContainer.style[v]=s[v],s[v]===""&&(s.clearBackgroundColor=!0)),v==="fontSize"&&(this.buttonContainer.style.fontSize=s[v]+"px"),v==="color"&&(this.buttonContainer.style.color=s[v]),v==="fontName"&&(this.buttonContainer.style.fontFamily=s[v]),v==="title"&&(this.buttonContainer.innerHTML=s[v]),v==="url"&&(this.buttonContainer.setAttribute("href",this.annotation.url),this.buttonContainer.setAttribute("target","_blank")),v==="fontStyle"&&(this.buttonContainer.style.fontStyle=s[v]),v==="fontWeight"&&(this.buttonContainer.style.fontWeight=s[v]));if(m>0){var d=this.documentViewer.getPageHeight(this.PageNumber),f={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,pageHeight:d};(s.destPage||s.url)&&this.annotation.actionType!=="0"&&(f.actionType=this.annotation.actionType);var y=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(k){return s[k]});y&&(f.fontSize=w.fontSize,f.color=w.color,f.fontName=w.fontName,f.fontStyle=w.fontStyle,f.fontWeight=w.fontWeight);var x=Object.assign({},f,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:x}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}},{key:"setProperty",value:function(s){if(s.name===this.annotation.name){var w=this.annotation,m=0;for(var v in s)for(var g in this.annotation)g===v&&this.annotation[g]!==s[v]&&(this.annotation[g]=s[v],m++,v==="fillColor"&&(this.buttonContainer.style[v]=s[v],s[v]===""&&(s.clearBackgroundColor=!0)),v==="fontSize"&&(this.buttonContainer.style.fontSize=s[v]+"px"),v==="color"&&(this.buttonContainer.style.color=s[v]),v==="fontName"&&(this.buttonContainer.style.fontFamily=s[v]),v==="title"&&(this.buttonContainer.innerHTML=s[v]),v==="url"&&(this.buttonContainer.setAttribute("href",this.annotation.url),this.buttonContainer.setAttribute("target","_blank")),v==="fontStyle"&&(this.buttonContainer.style.fontStyle=s[v]),v==="fontWeight"&&(this.buttonContainer.style.fontWeight=s[v]));if(m>0){var d=this.documentViewer.getPageHeight(this.PageNumber),f={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,pageHeight:d};(s.destPage||s.url)&&this.annotation.actionType!=="0"&&(f.actionType=this.annotation.actionType);var y=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(k){return s[k]});y&&(f.fontSize=w.fontSize,f.color=w.color,f.fontName=w.fontName,f.fontStyle=w.fontStyle,f.fontWeight=w.fontWeight);var x=Object.assign({},f,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:x}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio+1),height:parseInt(m.height*this.ratio+1)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})}]);var o,r,u}(),AddPushButton=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.buttonEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initPushButtonName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initPushButtonName",this.initPushButtonName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.buttonEle&&this.buttonEle.remove(),this.buttonEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initPushButtonName",this.initPushButtonName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"pushbutton",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,color:"#000000",fontName:"Helvetica",fontSize:14,title:"OK",actionType:0,destPage:"",url:""};this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.buttonEle&&this.buttonEle.remove(),this.buttonEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.buttonEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.buttonEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{display:"flex",alignItems:"center",justifyContent:"center",color:"#000000",fontSize:"14px",borderColor:"#001A4E",borderWidth:0,borderStyle:"solid",backgroundColor:"#DDE9FF",position:"absolute",fontFamily:"Helvetica",overflow:"hidden"});k.innerHTML="OK",this.buttonEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.buttonEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="pushbutton"}),r=function(){var s="Button"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="Button"+e}}])}(),ListBox=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="listbox",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.setProperty=w.setProperty.bind(w),w.changeSelectAvailable=w.changeSelectAvailable.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F;return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("toolModeChanged",this.changeSelectAvailable),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight),!(d=this.annotation).fontStyle&&(d.fontStyle="normal"),!d.fontWeight&&(d.fontWeight="normal"),!d.borderStyle&&(d.borderStyle="solid"),!d.borderColor&&(d.borderColor="#000000"),!d.borderWidth&&(d.borderWidth=0),!d.color&&(d.color="#000000"),!d.fillColor&&(d.fillColor="transparent"),d.items||(d.items=[]),d.required=(w=d.required)!==null&&w!==void 0?w:0,d.indicator=(m=d.indicator)!==null&&m!==void 0&&m,d.indicatorText=(v=d.indicatorText)!==null&&v!==void 0?v:"",d.fontName||(d.fontName="Helvetica"),this.annotation.selected||this.annotation.selected===0||(this.annotation.selected=null),this.scale=this.documentViewer.scale,f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end,this.start=y,this.end=x,k=this.calculate(y,x),P=this.getWidth(),S=this.getHeight(),(E=document.createElement("div")).id=d.name,E.className="annotation",E.style.top="calc(var(--scale-factor) * ".concat(d.rect.top,"px)"),E.style.left="calc(var(--scale-factor) * ".concat(d.rect.left,"px)"),E.style.width="calc(var(--scale-factor) * ".concat(P,"px)"),E.style.height="calc(var(--scale-factor) * ".concat(S,"px)"),E.style.backgroundColor=this.highlight?"#4982E54D":"",E.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(E.style.display="none"),this.annotationContainer=E,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),(M=document.createElement("div")).classList.add("indicator"),(T=document.createElement("div")).innerText=(g=d.indicatorText)!==null&&g!==void 0?g:"",M.append(T),this.setCss(M,{top:"calc(var(--scale-factor) * ".concat((d.rect.top+d.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=M,D=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative"}),this.shapeElement=D,this.getImage(),this.annotationContainer.append(this.shapeElement),N=createElement("div",{position:"absolute",left:0,top:0,width:"100%",height:"100%",borderColor:d.borderColor,borderWidth:d.borderWidth+"px",borderStyle:d.borderStyle,backgroundColor:d.fillColor,fontSize:d.fontSize+"px",fontWeight:d.fontWeight,fontStyle:d.fontStyle,fontFamily:d.fontName,color:d.color,overflow:"auto",opacity:0}),this.selectElement=N,this.shapeElement.append(this.selectElement),d.items&&d.items.length>0)for(I=0;I<d.items.length;I++)(O=createElement("div",{width:"100%",height:Math.round(20*this.documentViewer.scale)+"px",lineHeight:Math.round(20*this.documentViewer.scale)+"px",borderBottom:"1px solid #666666",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},{class:"option"})).innerText=d.items[I].String,this.annotation.selected===I&&(O.style.backgroundColor="#dcdcdc"),this.selectElement.appendChild(O);this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:k.left+k.width-84+"px",top:k.top+k.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(F=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",F.style.zIndex=1,F.style.left="".concat(k.left-8,"px"),F.style.top="".concat(k.top-8,"px"),F.style.width="".concat(k.width+16,"px"),F.style.height="".concat(k.height+16,"px"),this.outerLine=F,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:k.width+8,height:k.height+8,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height/2+5}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height+9}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+5,y:k.height+9}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:k.height+9}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:k.height/2+5}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+4,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(this.annotation.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):this.annotation.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&(!this.layer.addMode&&this.selectAnnotation(),this.toggleAttrbutePanel(),this.show=!1);case 94:case"end":return q.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"setFieldIndicator",value:function(s,w){var m,v,g=this.annotation,d={};s!==g.indicator&&(g.indicator=s,d.indicator=s,s?this.layer.pageDiv.append(this.indicatorBox):(m=this.indicatorBox)===null||m===void 0||m.remove()),typeof w=="string"&&w!==g.indicatorText&&(g.indicatorText=w,d.indicatorText=w,s?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove(),this.indicatorBox.querySelector("div").innerText=w),("indicator"in d||"indicatorText"in d)&&this.setAnnotationChanged(_objectSpread2$1({},d))}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w;if(this.setPopupElementStyle(),!(!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)))if(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode()){if(this.focus(),s.target&&s.target.className==="option"){for(var m=s.target.parentNode.children,v=0;v<m.length;v++)if(m[v]===s.target){this.annotation.selected=v,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getSelectedOption());break}this.handleSelectItemBg()}}else this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("listBoxPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("formPropertyPanelButton"),document.getElementsByClassName("right-panel")[0]],this.handleOutside.bind(this))}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s,w,m,v=this.documentViewer.annotationStore.selectedElementName,g=this.annotation.name;this.hidden||v!==g||(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,v===g&&(this.documentViewer.annotationStore.selectedElementName=null),(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("listBoxPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(y.x-x.x),be=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y)):we+2===Ae&&(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=m-(k.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=v-(k.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;v>k.clickY?ke=(ke=d.offsetHeight-(le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(ke=(ke=Le.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?oe=(oe=d.offsetWidth-(le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(oe=(oe=Le.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(oe||ke)&&(d.scrollTop+=ke,d.scrollLeft+=oe);var Ce={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-Ce.width,J),Z=Math.max(Ce.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-Ce.width,Z),J=Math.max(Ce.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-Ce.height,fe),j=Math.max(Ce.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-Ce.height,j),fe=Math.max(Ce.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.stopPropagation(),this.delete();var m={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(m.annotation.annotPtr=this.annotation.annotPtr),s||(m.type="empty"),this.documentViewer.eventBus.dispatch("annotationChange",m),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w,m;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.indicatorBox)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((v.rect.top+v.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){E.next=39;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=29,this.documentViewer.annotationManager.createAnnotation(k);case 29:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=34,this.documentViewer.annotationManager.addAnnotation(S);case 34:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=42;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 42:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-8,"px"),this.outerLine.style.top="".concat(v.top-8,"px"),this.outerLine.style.width="".concat(v.width+16,"px"),this.outerLine.style.height="".concat(v.height+16,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width+9),this.moveRect.setAttribute("height",v.height+9),this.LeftRect.setAttribute("y",v.height/2+5),this.bottomLeftRect.setAttribute("y",v.height+9),this.bottomRect.setAttribute("x",v.width/2+5),this.bottomRect.setAttribute("y",v.height+9),this.bottomRightRect.setAttribute("x",v.width+9),this.bottomRightRect.setAttribute("y",v.height+9),this.rightRect.setAttribute("x",v.width+9),this.rightRect.setAttribute("y",v.height/2+5),this.topRightRect.setAttribute("x",v.width+9),this.topRect.setAttribute("x",v.width/2+5)}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"listbox",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(s){var w=this.annotation;s!==w.contents&&(w.contents=s,this.setAnnotationChanged({contents:s}))}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.selectElement.style.backgroundColor=s,this.annotation.fillColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(s){var w=this.annotation,m=this.documentViewer.scale;this.selectElement.style.fontSize=s*m+"px",w.fontSize=s,this.setAnnotationChanged({color:w.color,fontSize:s,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"color",get:function(){return this.annotation.color},set:function(s){var w=this.annotation;this.selectElement.style.color=s,w.color=s,this.setAnnotationChanged({color:s,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(s){var w=this.annotation;this.selectElement.style.fontFamily=s,w.fontName=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:s,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(s){var w=this.annotation;this.selectElement.style.fontStyle=s,w.fontStyle=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:s,fontWeight:w.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(s){var w=this.annotation;this.selectElement.style.fontWeight=s,w.fontWeight=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:s})}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotationContainer.style.display=s?"none":"block",this.setAnnotationChanged({isHidden:s?1:0})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(s){this.selectElement.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(s){this.selectElement.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.selectElement.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"getFieldOptions",value:function(){return this.annotation.items.map(function(s){return{value:s.Value,displayValue:s.String}})}},{key:"setFieldOptions",value:function(s){var w=s.map(function(g){return{Value:g.value,String:g.displayValue}});this.selectElement.innerHTML="";for(var m=0;m<w.length;m++){var v=createElement("div",{width:"100%",height:"30px",lineHeight:"30px",borderBottom:"1px solid #666666",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},{class:"option"});v.innerText=w[m].String,this.annotation.selected===m&&(v.style.backgroundColor="#dcdcdc"),this.selectElement.appendChild(v)}this.annotation.items=w,this.setAnnotationChanged({items:w})}},{key:"getSelectedOption",value:function(){var s=this.annotation,w=s.items[s.selected];return w?{value:w.Value,displayValue:w.String}:null}},{key:"setSelectedOption",value:function(s){var w=s.value,m=s.displayValue,v=this.annotation.items.findIndex(function(g){return g.Value===w&&g.String===m});v<0||(this.annotation.selected=v,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getSelectedOption()),this.handleSelectItemBg(),this.setAnnotationChanged({selected:v}))}},{key:"handlePropertyPanel",value:function(s,w){if(w===this.PageNumber){var m=this.annotation;if(this.documentViewer.annotationStore.selectedElementName===m.name){var v=0;for(var g in s){for(var d in m)if(d===g&&this.annotation[d]!==s[g]&&g!=="items"){var f,y;this.annotation[d]=s[g],v++,m[d]=s[g],g==="fillColor"&&(s[g]===""&&(s.clearBackgroundColor=!0),this.selectElement.style[g]=s[g]),g==="fontSize"&&(this.selectElement.style.fontSize=s[g]+"px"),g==="color"&&(this.selectElement.style.color=s[g]),g==="fontName"&&(this.selectElement.style.fontFamily=s[g]),g==="fontStyle"&&(this.selectElement.style.fontStyle=s[g]),g==="fontWeight"&&(this.selectElement.style.fontWeight=s[g]),g==="indicator"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(f=this.indicatorBox)===null||f===void 0||f.remove()),g==="indicatorText"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(y=this.indicatorBox)===null||y===void 0||y.remove(),this.indicatorBox.querySelector("div").innerText=s[g])}if(g==="item"){if(m.items.includes(s.item)){delete s.item;continue}v++,m.items.push({Value:s.item,String:s.item});var x=createElement("div",{width:"100%",height:Math.round(20*this.documentViewer.scale)+"px",lineHeight:Math.round(20*this.documentViewer.scale)+"px",borderBottom:"1px solid #666666",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},{class:"option"});x.value=s.item,x.innerHTML=s.item,this.selectElement.appendChild(x),s.item={value:s.item,string:s.item,index:m.items.length-1}}if(g==="deleteItemIndex"){v++;var k=s.deleteItemIndex;m.selected===s.deleteItemIndex&&(m.selected=null),m.items.splice(k,1),this.selectElement.children[k].remove()}if(g==="moveOption"){v++;var P=s.moveOption.fromIndex,S=s.moveOption.toIndex,E=m.items;P>S?E.splice(P-1,2,E[P],E[P-1]):E.splice(P,2,E[P+1],E[P]),s.moveOption.item={Value:E[S].Value,String:E[S].String};var M=this.selectElement.children[P];M.remove(),this.selectElement.insertBefore(M,this.selectElement.children[S])}}if(v>0){var T={operate:"mod-form",name:this.annotation.name,pageIndex:this.PageNumber-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr};m.items.length||(s.clearOption=!0);var D=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(I){return s[I]});D&&(T.fontSize=m.fontSize,T.color=m.color,T.fontName=m.fontName,T.fontStyle=m.fontStyle,T.fontWeight=m.fontWeight);var N=Object.assign({},T,s);!m.annotPtr&&(N.items=m.items),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:N}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}}},{key:"setProperty",value:function(s){var w=this.annotation;if(s.name===w.name){for(var m in s)for(var v in w)if(v===m&&w[v]!==s[m]){var g,d;w[v]=s[m],m==="fillColor"&&(this.selectElement.style[m]=s[m]),m==="indicator"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(g=this.indicatorBox)===null||g===void 0||g.remove()),m==="indicatorText"&&(s[m]?this.layer.pageDiv.append(this.indicatorBox):(d=this.indicatorBox)===null||d===void 0||d.remove(),this.indicatorBox.querySelector("div").innerText=s[m]),m==="selected"&&this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getSelectedOption())}var f={operate:"mod-form",pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr},y=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(k){return s[k]});y&&(f.fontSize=w.fontSize,f.color=w.color,f.fontName=w.fontName,f.fontStyle=w.fontStyle,f.fontWeight=w.fontWeight);var x=Object.assign({},f,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:x}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}},{key:"changeSelectAvailable",value:function(){var s=this.documentViewer.annotationManager.isInFormFieldFillMode();this.documentViewer.toolMode==="form"?this.selectElement.style.pointerEvents=s?"auto":"none":this.selectElement.style.pointerEvents=""}},{key:"handleSelectItemBg",value:function(){var s,w=_createForOfIteratorHelper(this.selectElement.children);try{for(w.s();!(s=w.n()).done;)s.value.style.backgroundColor="unset"}catch(m){w.e(m)}finally{w.f()}this.selectElement.children[this.annotation.selected]&&(this.selectElement.children[this.annotation.selected].style.backgroundColor="#dcdcdc"),this.setProperty({selected:this.annotation.selected,name:this.annotation.name})}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio+1),height:parseInt(m.height*this.ratio+1)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})}]);var o,r,u}(),AddListBox=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initListboxName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initListboxName",this.initListboxName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initListboxName",this.initListboxName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"listbox",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,color:"#000000",fontName:"Helvetica",fontSize:14,items:[{Value:this.layer.annotationStore.$t("panels.right.preferences.item")+"1",String:this.layer.annotationStore.$t("panels.right.preferences.item")+"1"},{Value:this.layer.annotationStore.$t("panels.right.preferences.item")+"2",String:this.layer.annotationStore.$t("panels.right.preferences.item")+"2"}],selected:0};this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.fill")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",borderColor:"#43474D",borderWidth:0,borderStyle:"solid",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="listbox"}),r=function(){var s="List Box"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="List Box"+e}}])}(),ComboBox=function(e){function n(s){var w,m=s.annotation,v=s.documentViewer,g=s.show,d=g!==void 0&&g,f=s.highlight;return _classCallCheck(this,n),(w=_callSuper(this,n,[{annotation:m,documentViewer:v}])).type="combobox",w.hidden=!0,w.initial=!1,w.start=null,w.end=null,w.newStart=null,w.newEnd=null,w.startCircle=null,w.endCircle=null,w.show=d,w.highlight=f,w.onMousedown=w.handleMouseDown.bind(w),w.onMouseup=w.handleMouseUp.bind(w),w.onMousemove=w.handleMouseMove.bind(w),w.onDelete=w.handleDelete.bind(w),w.toggleAttrbutePanel=w.toggleAttrbutePanel.bind(w),w.handlePropertyPanel=w.handlePropertyPanel.bind(w),w.setProperty=w.setProperty.bind(w),w.changeSelectAvailable=w.changeSelectAvailable.bind(w),w.setHighlight=w.setHighlight.bind(w),w.render(),w}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e;return _regeneratorRuntime().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(this.documentViewer.eventBus._on("setProperty",this.setProperty),this.documentViewer.eventBus._on("toolModeChanged",this.changeSelectAvailable),this.documentViewer.eventBus._on("setHighlightForm",this.setHighlight),!(d=this.annotation).fontStyle&&(d.fontStyle="normal"),!d.fontWeight&&(d.fontWeight="normal"),!d.borderStyle&&(d.borderStyle="solid"),!d.borderColor&&(d.borderColor="#000000"),!d.borderWidth&&(d.borderWidth=0),!d.color&&(d.color="#000000"),!d.fillColor&&(d.fillColor="transparent"),d.items||(d.items=[]),d.required=(w=d.required)!==null&&w!==void 0?w:0,d.indicator=(m=d.indicator)!==null&&m!==void 0&&m,d.indicatorText=(v=d.indicatorText)!==null&&v!==void 0?v:"",d.fontName||(d.fontName="Helvetica"),this.annotation.selected||this.annotation.selected===0||(this.annotation.selected=null),this.scale=this.documentViewer.scale,f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end,this.start=y,this.end=x,k=this.calculate(y,x),P=this.getWidth(),S=this.getHeight(),(E=document.createElement("div")).id=d.name,E.className="annotation",E.style.top="calc(var(--scale-factor) * ".concat(d.rect.top,"px)"),E.style.left="calc(var(--scale-factor) * ".concat(d.rect.left,"px)"),E.style.width="calc(var(--scale-factor) * ".concat(P,"px)"),E.style.height="calc(var(--scale-factor) * ".concat(S,"px)"),E.style.backgroundColor=this.highlight?"#4982E54D":"",E.style.overflow="hidden",this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(E.style.display="none"),this.annotationContainer=E,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),(M=document.createElement("div")).classList.add("indicator"),(T=document.createElement("div")).innerText=(g=d.indicatorText)!==null&&g!==void 0?g:"",M.append(T),this.setCss(M,{top:"calc(var(--scale-factor) * ".concat((d.rect.top+d.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=M,D=createElement("div",{left:0,top:0,width:"100%",height:"100%",position:"relative",overflow:"hidden"}),this.shapeElement=D,this.getImage(),this.annotationContainer.append(this.shapeElement),N=createElement("select",{position:"absolute",left:0,top:0,paddingLeft:"4px",width:"100%",height:"100%",borderColor:d.borderColor,borderWidth:d.borderWidth+"px",borderStyle:d.borderStyle,cursor:"pointer",webkitAppearance:"none",appearance:"none",backgroundColor:d.fillColor,fontSize:d.fontSize+"px",fontFamily:d.fontName,color:d.color,fontWeight:d.fontWeight,fontStyle:d.fontStyle,textOverflow:"ellipsis",whiteSpace:"nowrap",opacity:0}),this.documentViewer.toolMode==="form"&&(I=this.documentViewer.annotationManager.isInFormFieldFillMode(),N.style.pointerEvents=I?"auto":"none"),this.selectElement=N,O=createSvg("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},{width:"".concat(k.height/2,"px"),height:"".concat(k.height/2,"px"),position:"absolute",right:"4px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",opacity:0}),F=createSvg("path",{d:"M4 5.51025L8.0041 10.5L12 5.5L4 5.51025Z",fill:"#666"},{pointerEvents:"none"}),this.svgElement=O,this.svgElement.append(F),this.shapeElement.append(this.svgElement),this.shapeElement.append(this.selectElement),d.items&&d.items.length>0)for(q=0;q<d.items.length;q++)(Y=createElement("option")).value=d.items[q].Value,Y.innerHTML=d.items[q].Value,d.selected===q&&(Y.selected=!0),this.selectElement.appendChild(Y);this.selectElement.addEventListener("change",this.handleSelect.bind(this)),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:k.left+k.width-84+"px",top:k.top+k.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(_e=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",_e.style.zIndex=1,_e.style.left="".concat(k.left-8,"px"),_e.style.top="".concat(k.top-8,"px"),_e.style.width="".concat(k.width+16,"px"),_e.style.height="".concat(k.height+16,"px"),this.outerLine=_e,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:k.width+8,height:k.height+8,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height/2+5}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:k.height+9}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+5,y:k.height+9}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:k.height+9}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:k.height/2+5}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width+9,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:k.width/2+4,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.initial=!0,this.documentViewer.toolMode!=="form"&&(this.annotation.isHidden==1?(this.annotationContainer.style.display="none",this.annotationContainer.style.pointerEvents="none"):this.annotation.isHidden==0&&(this.annotationContainer.style.display="block",this.annotationContainer.style.pointerEvents="auto")),this.show&&this.layer&&(!this.layer.addMode&&this.selectAnnotation(),this.toggleAttrbutePanel()),this.show=!1;case 102:case"end":return ne.stop()}},s,this)})),function(){return u.apply(this,arguments)})},{key:"getActualRect",value:function(s){var w=this.annotation.rect,m=w.left,v=w.top,g=w.right,d=w.bottom;return{start:getActualPoint$1({x:m,y:v},s),end:getActualPoint$1({x:g,y:d},s)}}},{key:"rectCalc",value:function(s){var w=s.start,m=s.end;return{top:w.y<m.y?w.y:m.y,left:w.x<m.x?w.x:m.x,width:Math.abs(m.x-w.x),height:Math.abs(m.y-w.y)}}},{key:"calculate",value:function(s,w){var m=this.rectCalc({start:s,end:w});this.initRect=m;var v=this.annotation.borderWidth*this.documentViewer.scale;return{top:m.top-v,left:m.left-v,width:m.width+2*v,height:m.height+2*v}}},{key:"setFieldIndicator",value:function(s,w){var m,v,g=this.annotation,d={};s!==g.indicator&&(g.indicator=s,d.indicator=s,s?this.layer.pageDiv.append(this.indicatorBox):(m=this.indicatorBox)===null||m===void 0||m.remove()),typeof w=="string"&&w!==g.indicatorText&&(g.indicatorText=w,d.indicatorText=w,s?this.layer.pageDiv.append(this.indicatorBox):(v=this.indicatorBox)===null||v===void 0||v.remove(),this.indicatorBox.querySelector("div").innerText=w),("indicator"in d||"indicatorText"in d)&&this.setAnnotationChanged(_objectSpread2$1({},d))}},{key:"getInitialPoint",value:function(){var s,w,m,v,g=this.start.x,d=this.start.y,f=this.end.x,y=this.end.y,x=this.documentViewer,k=x.scale,P=x.getPageWidth(this.PageNumber)*k,S=x.getPageHeight(this.PageNumber)*k,E=this.documentViewer.pagesRotation;return E===0?(s=g/k,w=d/k,m=f/k,v=y/k):E===90?(s=d/k,w=g/k,m=y/k,v=f/k):E===180?(s=(P-g)/k,w=d/k,m=(P-f)/k,v=y/k):(s=(S-d)/k,w=(P-g)/k,m=(S-y)/k,v=(P-f)/k),{start:{x:s,y:w},end:{x:m,y:v}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var s;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var w=this.annotation;this.documentViewer.annotationStore.selectedElementName=w.name;var m=_objectSpread2$1({},w);delete m.annotPtr,delete m.pagePtr,delete m.operate,delete m.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",m),this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled")}(s=this.layer)===null||s===void 0||s.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var s,w;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(s=this.layer)===null||s===void 0||s.div.classList.remove("no-edit"):(w=this.layer)===null||w===void 0||w.div.classList.add("no-edit")}},{key:"handleClick",value:function(s){var w;this.setPopupElementStyle(),!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((w=this.layer)===null||w===void 0?void 0:w.tool)||document.querySelector(".compare-document-container").contains(s==null?void 0:s.target)||(this.documentViewer.toolMode!=="form"||this.documentViewer.annotationManager.isInFormFieldFillMode()?this.focus():(this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("comboBoxPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("formPropertyPanelButton"),document.getElementsByClassName("right-panel")[0]],this.handleOutside.bind(this))))}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"handleOutside",value:function(){var s,w,m,v=this.documentViewer.annotationStore.selectedElementName,g=this.annotation.name;this.hidden||v!==g||(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,v===g&&(this.documentViewer.annotationStore.selectedElementName=null),(s=this.outerLine)===null||s===void 0||s.removeEventListener("mousedown",this.onMousedown),(w=this.outerLine)===null||w===void 0||w.removeEventListener("touchstart",this.onMousedown),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("comboBoxPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s.stopPropagation();var m=s.target.getAttribute("data-id"),v=this.documentViewer.getScrollViewElement();this.scrollTop=v.scrollTop,this.scrollLeft=v.scrollLeft;var g=getClickPoint(s),d=g.pageX,f=g.pageY;this.startState={operator:m,clickX:d,clickY:f},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}},{key:"handleMouseMove",value:function(s){s.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var w=getClickPoint(s),m=w.pageX,v=w.pageY,g=this.documentViewer,d=g.getScrollViewElement(),f=d.scrollTop;m=m+d.scrollLeft-this.scrollLeft,v=v+f-this.scrollTop;var y=this.start,x=this.end,k=this.startState,P=g.scale,S=g.getPageWidth(this.PageNumber)*P,E=g.getPageHeight(this.PageNumber)*P;if(k.operator==="nw-resize"){var M=m-(k.clickX-this.start.x),T=v-(k.clickY-this.start.y);M=Math.min(x.x-5,M),M=Math.max(0,M),T=Math.min(x.y-5,T),T=Math.max(0,T),this.update({start:{x:M,y:T},end:x})}else if(k.operator==="w-resize"){var D=m-(k.clickX-this.start.x);D=Math.min(x.x-5,D),D=Math.max(0,D),this.update({start:{x:D,y:y.y},end:x})}else if(k.operator==="sw-resize"){var N=m-(k.clickX-this.start.x),I=v-(k.clickY-this.end.y);N=Math.min(x.x-5,N),N=Math.max(0,N),I=Math.min(E,I),I=Math.max(y.y+5,I),this.update({start:{x:N,y:y.y},end:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=v-(k.clickY-this.end.y);O=Math.min(E,O),O=Math.max(y.y+5,O),this.update({start:y,end:{x:x.x,y:O}})}else if(k.operator==="se-resize"){var F=m-(k.clickX-this.end.x),q=v-(k.clickY-this.end.y);F=Math.min(S,F),F=Math.max(y.x+5,F),q=Math.min(E,q),q=Math.max(y.y+5,q),this.update({start:y,end:{x:F,y:q}})}else if(k.operator==="e-resize"){var Y=m-(k.clickX-this.end.x);Y=Math.min(S,Y),Y=Math.max(y.x+5,Y),this.update({start:y,end:{x:Y,y:x.y}})}else if(k.operator==="ne-resize"){var _e=m-(k.clickX-this.end.x),ne=v-(k.clickY-this.start.y);_e=Math.min(S,_e),_e=Math.max(y.x+5,_e),ne=Math.min(x.y-5,ne),ne=Math.max(0,ne),this.update({start:{x:y.x,y:ne},end:{x:_e,y:x.y}})}else if(k.operator==="n-resize"){var ve=v-(k.clickY-this.start.y);ve=Math.min(x.y-5,ve),ve=Math.max(0,ve),this.update({start:{x:y.x,y:ve},end:x})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(s),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q=X.windowToPage(H,U.first,!1),re=Math.abs(y.x-x.x),Pe=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=m-(k.clickX-this.start.x),fe=U.first>te?Q.y:Q.y-Pe,Z=m-(k.clickX-this.end.x),j=U.first>te?Q.y+Pe:Q.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?Q.x:Q.x-re,fe=v-(k.clickY-this.start.y),Z=U.first>te?Q.x+re:Q.x,j=v-(k.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var be=Math.min(U.first,te),we=Math.max(U.first,te);if(we-be>2||be+1===we&&be%2==0)return;be+1===we?(J=U.first>te?Q.x:Q.x-re,fe=v-(k.clickY-this.start.y),Z=U.first>te?Q.x+re:Q.x,j=v-(k.clickY-this.end.y)):be+2===we&&(J=m-(k.clickX-this.start.x),fe=U.first>te?Q.y:Q.y-Pe,Z=m-(k.clickX-this.end.x),j=U.first>te?Q.y+Pe:Q.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var Ae=Math.min(U.first,te),$e=Math.max(U.first,te);if($e-Ae>2||Ae+1===$e&&(Ae!==1||$e!==2)&&$e%2==0||Ae===1&&$e===3)return;Ae+2===$e||Ae===1&&$e===2?(J=m-(k.clickX-this.start.x),fe=U.first>te?Q.y:Q.y-Pe,Z=m-(k.clickX-this.end.x),j=U.first>te?Q.y+Pe:Q.y):Ae+1===$e&&(J=U.first>te?Q.x:Q.x-re,fe=v-(k.clickY-this.start.y),Z=U.first>te?Q.x+re:Q.x,j=v-(k.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Me=this.layer.div;Me.append(this.annotationContainer),Me.append(this.outerLineContainer)}else{J=m-(k.clickX-this.start.x),fe=v-(k.clickY-this.start.y),Z=m-(k.clickX-this.end.x),j=v-(k.clickY-this.end.y);var Ie=X.pageToWindow({x:J,y:fe},te,!1),Le=X.pageToWindow({x:Z,y:j},te,!1),le=0,oe=0;v>k.clickY?oe=(oe=d.offsetHeight-(Le.y-d.scrollTop-d.offsetTop))<100?5:0:v<k.clickY&&(oe=(oe=Ie.y-d.scrollTop-d.offsetTop)<100?-5:0),m>k.clickX?le=(le=d.offsetWidth-(Le.x-d.scrollLeft-d.offsetLeft))<100?5:0:m<k.clickX&&(le=(le=Ie.x-d.scrollLeft-d.offsetLeft)<100?-5:0),(le||oe)&&(d.scrollTop+=oe,d.scrollLeft+=le);var ke={width:Math.abs(y.x-x.x),height:Math.abs(y.y-x.y)};J<Z?(J=Math.max(0,J),J=Math.min(S-ke.width,J),Z=Math.max(ke.width,Z),Z=Math.min(S,Z)):(Z=Math.max(0,Z),Z=Math.min(S-ke.width,Z),J=Math.max(ke.width,J),J=Math.min(S,J)),fe<j?(fe=Math.max(0,fe),fe=Math.min(E-ke.height,fe),j=Math.max(ke.height,j),j=Math.min(E,j)):(j=Math.max(0,j),j=Math.min(E-ke.height,j),fe=Math.max(ke.height,fe),fe=Math.min(E,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}k.clickX=m,k.clickY=v}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(s){var w;(w=this.layer)!==null&&w!==void 0&&w.tool&&s&&s.stopPropagation(),this.delete();var m={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(m.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",m),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var s,w,m;this.handleOutside(),(s=this.annotationContainer)===null||s===void 0||s.remove(),(w=this.indicatorBox)===null||w===void 0||w.remove(),this.annotation.isDelete=!0,(m=this.layer)===null||m===void 0||m.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if((m=this.layer)!==null&&m!==void 0&&m.tool&&w.stopPropagation(),w.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,v=this.annotation,g=this.getInitialPoint(),d=g.start,f=g.end,(y={left:d.x,top:d.y,right:f.x,bottom:f.y})!==v.rect||this.PrePageNumber!==this.PageNumber){E.next=14;break}return E.abrupt("return");case 14:if(v.rect=y,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((v.rect.top+v.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){E.next=39;break}return x={type:"delete",annotation:{operate:"del-annot",name:v.name,pageIndex:v.pageIndex,annotPtr:v.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},v)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-form",k.pageIndex=this.PageNumber-1,E.next=29,this.documentViewer.annotationManager.createAnnotation(k);case 29:return P=E.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),E.next=34,this.documentViewer.annotationManager.addAnnotation(S);case 34:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),E.next=42;break;case 39:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",name:v.name,pageIndex:this.PageNumber-1,pagePtr:v.pagePtr,annotPtr:v.annotPtr,rect:y}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage(!0);case 42:case"end":return E.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var s=this.documentViewer.scale;if(s!==this.scale){var w=this.getActualRect(s),m=w.start,v=w.end;this.update({start:m,end:v}),this.scale=s,this.getImage(!0)}}}},{key:"update",value:function(s){var w=s.start,m=s.end,v=this.calculate(w,m);this.start=w,this.end=m;var g=this.getInitialPoint(),d=g.start,f=g.end,y=Math.abs(f.x-d.x),x=Math.abs(f.y-d.y),k=this.annotationContainer.style;k.top="calc(var(--scale-factor) * ".concat(d.y,"px)"),k.left="calc(var(--scale-factor) * ".concat(d.x,"px)"),k.width="calc(var(--scale-factor) * ".concat(y,"px)"),k.height="calc(var(--scale-factor) * ".concat(x,"px)"),this.outerLine.style.left="".concat(v.left-8,"px"),this.outerLine.style.top="".concat(v.top-8,"px"),this.outerLine.style.width="".concat(v.width+16,"px"),this.outerLine.style.height="".concat(v.height+16,"px");var P=v.left+v.width-84+"px",S=v.top+v.height+12+"px";this.popupElement.style.left=P,this.popupElement.style.top=S,this.moveRect.setAttribute("width",v.width+9),this.moveRect.setAttribute("height",v.height+9),this.LeftRect.setAttribute("y",v.height/2+5),this.bottomLeftRect.setAttribute("y",v.height+9),this.bottomRect.setAttribute("x",v.width/2+5),this.bottomRect.setAttribute("y",v.height+9),this.bottomRightRect.setAttribute("x",v.width+9),this.bottomRightRect.setAttribute("y",v.height+9),this.rightRect.setAttribute("x",v.width+9),this.rightRect.setAttribute("y",v.height/2+5),this.topRightRect.setAttribute("x",v.width+9),this.topRect.setAttribute("x",v.width/2+5),this.svgElement.style.width="".concat(v.height/2,"px"),this.svgElement.style.height="".concat(v.height/2,"px")}},{key:"setAnnotationChanged",value:function(s){var w=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"combobox",operate:"mod-form",name:w.name,pageIndex:this.page,pagePtr:w.pagePtr,annotPtr:w.annotPtr},s)}),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}},{key:"setRect",value:function(s){var w=this.documentViewer.scale,m=getActualPoint$1({x:s.x1,y:s.y1},w),v=getActualPoint$1({x:s.x2,y:s.y2},w);this.update({start:m,end:v}),this.start=m,this.end=v;var g=this.getInitialPoint(),d=g.start,f=g.end,y={left:d.x,top:d.y,right:f.x,bottom:f.y};this.annotation.rect=y,this.setAnnotationChanged({rect:y})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(s){var w=this.annotation;s!==w.contents&&(w.contents=s.toString(),this.setAnnotationChanged({contents:s}))}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(s){this.selectElement.style.backgroundColor=s,this.annotation.fillColor=s,this.setAnnotationChanged({fillColor:s})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(s){var w=this.annotation,m=this.documentViewer.scale;this.selectElement.style.fontSize=s*m+"px",w.fontSize=s,this.setAnnotationChanged({color:w.color,fontSize:s,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"color",get:function(){return this.annotation.color},set:function(s){var w=this.annotation;this.selectElement.style.color=s,w.color=s,this.setAnnotationChanged({color:s,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(s){var w=this.annotation;this.selectElement.style.fontFamily=s,w.fontName=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:s,fontStyle:w.fontStyle,fontWeight:w.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(s){var w=this.annotation;this.selectElement.style.fontStyle=s,w.fontStyle=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:s,fontWeight:w.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(s){var w=this.annotation;this.selectElement.style.fontWeight=s,w.fontWeight=s,this.setAnnotationChanged({color:w.color,fontSize:w.fontSize,fontName:w.fontName,fontStyle:w.fontStyle,fontWeight:s})}},{key:"fieldName",get:function(){return this.annotation.fieldName},set:function(s){this.annotation.fieldName=s,this.setAnnotationChanged({fieldName:s})}},{key:"isHidden",get:function(){return!!this.annotation.isHidden},set:function(s){this.annotation.isHidden=s?1:0,this.annotationContainer.style.display=s?"none":"block",this.setAnnotationChanged({isHidden:s?1:0})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(s){this.selectElement.style.borderStyle=s,this.annotation.borderStyle=s,this.setAnnotationChanged({borderStyle:s})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(s){this.selectElement.style.borderWidth=s+"px",this.annotation.borderWidth=s,this.setAnnotationChanged({borderWidth:s})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(s){this.selectElement.style.borderColor=s,this.annotation.borderColor=s,this.setAnnotationChanged({borderColor:s})}},{key:"getFieldOptions",value:function(){return this.annotation.items.map(function(s){return{value:s.Value,displayValue:s.String}})}},{key:"setFieldOptions",value:function(s){var w=s.map(function(g){return{Value:g.value.toString(),String:g.displayValue.toString()}});this.selectElement.innerHTML="";for(var m=0;m<w.length;m++){var v=createElement("option");v.value=w[m].String,v.innerHTML=w[m].String,this.selectElement.appendChild(v)}this.annotation.items=w,this.setAnnotationChanged({items:w,selected:this.annotation.selected})}},{key:"getSelectedOption",value:function(){var s=this.annotation,w=s.items[s.selected];return w?{value:w.Value,displayValue:w.String}:null}},{key:"setSelectedOption",value:function(s){var w=s.value,m=s.displayValue,v=this.annotation.items.findIndex(function(g){return g.Value===w&&g.String===m});v<0||(this.annotation.selected=v,this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getSelectedOption()),this.selectElement.value=m,this.setAnnotationChanged({selected:v}))}},{key:"handlePropertyPanel",value:function(s,w){if(w===this.PageNumber){var m=this.annotation;if(this.documentViewer.annotationStore.selectedElementName===m.name){var v=0;for(var g in s){for(var d in m)if(d===g&&m[d]!==s[g]){var f,y;v++,m[d]=s[g],g==="fillColor"&&(s[g]===""&&(s.clearBackgroundColor=!0),this.selectElement.style[g]=s[g]),g==="fontSize"&&(this.selectElement.style.fontSize=s[g]+"px"),g==="color"&&(this.selectElement.style.color=s[g]),g==="fontName"&&(this.selectElement.style.fontFamily=s[g]),g==="fontStyle"&&(this.selectElement.style.fontStyle=s[g]),g==="fontWeight"&&(this.selectElement.style.fontWeight=s[g]),g==="indicator"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(f=this.indicatorBox)===null||f===void 0||f.remove()),g==="indicatorText"&&(s[g]?this.layer.pageDiv.append(this.indicatorBox):(y=this.indicatorBox)===null||y===void 0||y.remove(),this.indicatorBox.querySelector("div").innerText=s[g])}if(g==="item"){if(m.items.includes(s.item)){delete s.item;continue}v++,m.items.push({Value:s.item,String:s.item});var x=createElement("option");x.value=s.item,x.innerHTML=s.item,this.selectElement.appendChild(x),s.item={value:s.item,string:s.item,index:m.items.length-1},s.selected=m.selected}if(g==="deleteItemIndex"){v++;var k=s.deleteItemIndex;m.selected===s.deleteItemIndex&&(m.selected=null),m.items.splice(k,1),this.selectElement.options[k].remove()}if(g==="moveOption"){v++;var P=s.moveOption.fromIndex,S=s.moveOption.toIndex,E=m.items;P>S?E.splice(P-1,2,E[P],E[P-1]):E.splice(P,2,E[P+1],E[P]),s.moveOption.item={Value:E[S].Value,String:E[S].String},s.selected=0,m.selected=0;var M=this.selectElement.options[P];M.remove(),this.selectElement.insertBefore(M,this.selectElement.options[S]),this.selectElement.selectedIndex=0}}if(v>0){var T={operate:"mod-form",name:m.name,pageIndex:this.PageNumber-1,index:m.items.length-1,pagePtr:m.pagePtr,annotPtr:m.annotPtr};m.items.length||(s.clearOption=!0);var D=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(I){return s[I]});D&&(T.fontSize=m.fontSize,T.color=m.color,T.fontName=m.fontName,T.fontStyle=m.fontStyle,T.fontWeight=m.fontWeight);var N=Object.assign({},T,s);!m.annotPtr&&(N.items=m.items),this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:N}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}}}},{key:"setProperty",value:function(s){var w=this.annotation;if(s.name===w.name){for(var m in s)for(var v in w)v===m&&w[v]!==s[m]&&(w[v]=s[m],m==="fillColor"&&(this.selectElement.style[m]=s[m]),m==="selected"&&this.documentViewer.eventBus.dispatch("fieldChanged",this.fieldName,this.getSelectedOption()));var g={operate:"mod-form",pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr},d=["fontSize","fontName","color","fontStyle","fontWeight"].some(function(y){return s[y]});d&&(g.fontSize=w.fontSize,g.color=w.color,g.fontName=w.fontName,g.fontStyle=w.fontStyle,g.fontWeight=w.fontWeight);var f=Object.assign({},g,s);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:f}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getImage()}}},{key:"changeSelectAvailable",value:function(){var s=this.documentViewer.annotationManager.isInFormFieldFillMode();this.documentViewer.toolMode==="form"?this.selectElement.style.pointerEvents=s?"auto":"none":this.selectElement.style.pointerEvents=""}},{key:"handleSelect",value:function(){var s=this.selectElement.selectedIndex;this.setProperty({selected:s,name:this.annotation.name})}},{key:"setHighlight",value:function(s){this.highlight=s,this.annotationContainer.style.backgroundColor=this.highlight?"#4982E54D":""}},{key:"getImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return m=this.initRect,v={width:parseInt(m.width*this.ratio+1),height:parseInt(m.height*this.ratio+1)},P.next=4,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:v.width,height:v.height});case 4:g=P.sent,(d=document.createElement("canvas")).style.width=v.width+"px",d.style.height=v.height+"px",d.width=v.width,d.height=v.height,(f=d.getContext("2d")).clearRect(0,0,d.width,d.height),(y=f.createImageData(v.width,v.height)).data.set(g),f.putImageData(y,0,0),x=d.toDataURL("image/png",1),this.imgEle?this.imgEle.src=x:((k=document.createElement("img")).style.width="100%",k.style.height="100%",k.style.pointerEvents="none",k.style.display="block",k.src=x,this.imgEle=k,this.shapeElement.append(this.imgEle));case 17:case"end":return P.stop()}},s,this)})),function(s){return o.apply(this,arguments)})}]);var o,r,u}(),AddComboBox=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.initComboboxName=this.setInitProperty.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.eventBus._on("initComboboxName",this.initComboboxName)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initComboboxName",this.initComboboxName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale);this.setInitProperty();var u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"combobox",pageIndex:this.layer.page,date:new Date,rect:w,fillColor:"#DDE9FF",borderColor:"#43474D",borderStyle:"solid",borderWidth:0,fieldName:this.fieldName,isHidden:0,color:"#000000",fontName:"Helvetica",fontSize:14,items:[{Value:this.layer.annotationStore.$t("panels.right.preferences.item")+"1",String:this.layer.annotationStore.$t("panels.right.preferences.item")+"1"},{Value:this.layer.annotationStore.$t("panels.right.preferences.item")+"2",String:this.layer.annotationStore.$t("panels.right.preferences.item")+"2"}],selected:0};this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.fill")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",borderColor:"#43474D",borderWidth:0,borderStyle:"solid",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"setInitProperty",value:function(){var e=1,n=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(n&&n.length)for(var o=n.filter(function(s){return s.type==="combobox"}),r=function(){var s="Combo Box"+(u+1);if(o.every(function(w){return w.fieldName!==s}))return e=u+1,1},u=0;u<=o.length&&!r();u++);this.fieldName="Combo Box"+e}}])}(),MakupAnnotation=function(e){function n(r){var u,s=r.annotation,w=r.documentViewer;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:s,documentViewer:w}])).hidden=!0,u.markupContainer=null,u.outerLineContainer=null,u.ratio=window.devicePixelRatio||1,u.onHandleClick=u.handleClick.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.handlePropertyPanel=u.handlePropertyPanel.bind(u),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"ctx",get:function(){var r;return((r=this.layer)===null||r===void 0||(r=r.pageViewer)===null||r===void 0?void 0:r.canvas)&&this.layer.pageViewer.canvas.getContext("2d",{willReadFrequently:!0})}},{key:"draw",value:function(){var r=this.annotation,u=this.documentViewer.scale,s=this.getActualRect(u),w=s.start,m=s.end,v=this.calculate(w,m);this.rect=v;var g=r.quadPoints;if(g){for(var d=[],f=0;f+3<g.length;f+=4){var y=parseInt(g[f].PointX*u,10),x=parseInt(g[f].PointY*u,10),k=parseInt(g[f+1].PointX*u,10),P=parseInt(g[f+2].PointY*u,10),S=Math.min(y,k),E=Math.max(y,k),M=Math.min(x,P),T=Math.max(x,P),D=parseInt(E-S),N=parseInt(T-M);d.push({left:S,top:M,width:D,height:N})}this.positionArray=d,this.ctx&&(this.ctx.globalCompositeOperation="multiply",this.renderCanvansRect(d),this.markupContainer.addEventListener("mousedown",this.onHandleClick)),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container";var I=createSvg("svg");I.style.left=v.left-6+"px",I.style.top=v.top-6+"px",I.style.width=v.width+12+"px",I.style.height=v.height+12+"px";var O=createSvg("rect",{x:3,y:3,width:v.width+6,height:v.height+6,fill:"#ffffff","fill-opacity":0,"stroke-width":1,stroke:"#1460F3"});I.append(O),this.popupElement=createElement("div",{left:v.left+v.width-114+"px",top:v.top+v.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel);var F=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"});F.addEventListener("click",this.onDelete),F.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px",borderRadius:"2px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr,this.deletetButton=F,this.outerLineContainer.append(I),this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer)}}},{key:"getActualRect",value:function(r){var u=this.annotation,s=this.documentViewer.getPageWidth(this.PageNumber),w=this.documentViewer.getPageHeight(this.PageNumber),m=u.rect,v=m.left,g=m.top,d=m.right,f=m.bottom;return v=Math.min(v,d),v=Math.max(v,0),g=Math.min(g,f),g=Math.max(g,0),d=Math.max(v,d),d=Math.min(d,s),f=Math.max(g,f),f=Math.min(f,w),{start:getActualPoint$1({x:v,y:g},r),end:getActualPoint$1({x:d,y:f},r)}}},{key:"setCss",value:function(r,u){if(r&&u)for(var s in u)r.style[s]=u[s]}},{key:"rectCalc",value:function(r){var u=r.start,s=r.end;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"calculate",value:function(r,u){var s=this.rectCalc({start:r,end:u});return{top:s.top-2,left:s.left-2,width:s.width+4,height:s.height+4}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var r,u,s=this.rect;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((r=this.layer)===null||r===void 0||r.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:s.left+s.width-114+"px"})):((u=this.layer)===null||u===void 0||u.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:s.left+s.width-46+"px"}))}},{key:"handleClick",value:function(r){var u;if(this.setPopupElementStyle(),this.hidden&&!["redaction","remove"].includes((u=this.layer)===null||u===void 0?void 0:u.tool)&&!document.querySelector(".compare-document-container").contains(r==null?void 0:r.target)){this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel);var s=[this.markupContainer,this.popupElement,this.outerLineContainer,this.deletetButton,this.replyButton,document.querySelector(".annotation-panel")],w=document.querySelector(".toggle-button");w&&s.push(w);var m=document.getElementById("annotationPropertyPanelButton");m&&s.push(m),onClickOutside$1(s,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,this.outerLineContainer.remove(),this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"updateTool",value:function(){if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var r;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var u=this.annotation;this.documentViewer.annotationStore.selectedElementName=u.name;var s=_objectSpread2$1({},u);delete s.annotPtr,delete s.pagePtr,delete s.operate,delete s.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",s)}(r=this.layer)===null||r===void 0||r.div.append(this.outerLineContainer)}}},{key:"handleDelete",value:function(r){var u,s;(u=this.layer)!==null&&u!==void 0&&u.tool&&r&&r.stopPropagation(),this.delete();var w={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(w.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",w),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),(s=this.layer)===null||s===void 0||s.redrawMarkups({pageIndex:this.PageNumber-1})}},{key:"delete",value:function(){var r,u;this.handleOutside(),(r=this.markupContainer)===null||r===void 0||r.remove(),this.annotation.isDelete=!0,(u=this.layer)===null||u===void 0||u.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"renderCanvansRect",value:function(r){var u=document.createElement("div");u.className="markup";for(var s=0;s<r.length;s++){var w=r[s],m=document.createElement("div");this.setCss(m,{position:"absolute",top:w.top+"px",left:w.left+"px",width:w.width+"px",height:w.height+"px"}),u.append(m)}this.drawCanvas(r,this.getVisibleRect()),this.layer.div.append(u),this.markupContainer=u}},{key:"getVisibleRect",value:function(){var r=this.documentViewer,u=r.scale,s=this.ratio,w=r.getPageWidth(this.PageNumber),m=r.getPageHeight(this.PageNumber),v=Math.ceil(w*s),g=Math.ceil(m*s),d={x1:0,y1:0,x2:v,y2:g,width:v,height:g};if(u>r.maxViewportZoom){var f=r.getVisibleRegionRect(0,0);d=r.calculatePageVisibility(this.PageNumber,f)}return d}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"reRenderAfterContentEdit",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(s=u.pagePtr,w=u.rect,m=this.rect,v=w,!(m.left>v.left+v.width||m.left+m.width<v.left||m.top>v.top+v.height||m.top+m.height<v.top)){x.next=5;break}return x.abrupt("return");case 5:if(g={left:parseInt(this.rect.left*this.ratio),top:parseInt(this.rect.top*this.ratio),right:parseInt(this.rect.left*this.ratio)+parseInt(this.rect.width*this.ratio),bottom:parseInt(this.rect.top*this.ratio)+parseInt(this.rect.height*this.ratio),width:parseInt(this.rect.width*this.ratio),height:parseInt(this.rect.height*this.ratio)},d=null,!this.documentViewer.renderLayerPermission||!this.documentViewer.layers.length){x.next=13;break}return x.next=10,this.documentViewer.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:s,scale:this.documentViewer.scale*this.ratio,top:g.top,left:g.left,right:g.right,bottom:g.bottom,ocgsPtr:_toConsumableArray$1(this.documentViewer.ocgsPtr)});case 10:d=x.sent,x.next=16;break;case 13:return x.next=15,this.documentViewer.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:s,scale:this.documentViewer.scale*this.ratio,top:g.top,left:g.left,right:g.right,bottom:g.bottom});case 15:d=x.sent;case 16:f=d.imageArray,(y=this.ctx.createImageData(parseInt(g.width),parseInt(g.height))).data.set(f),this.ctx.clearRect(g.left,g.top,g.width,g.height),this.ctx.putImageData(y,g.left,g.top),this.drawCanvas(this.positionArray,this.getVisibleRect());case 22:case"end":return x.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"getIntersection",value:function(r,u){var s=Math.max(r.left,u.left),w=Math.min(r.left+r.width,u.right),m=Math.max(r.top,u.top),v=Math.min(r.top+r.height,u.bottom);return w>s&&v>m?{left:s,top:m,width:w-s,height:v-m}:null}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:this.type,operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(r){var u,s=this.annotation;s.opacity=r,(u=this.layer)===null||u===void 0||u.redrawMarkups({pageIndex:s.pageIndex,afterContentEdit:!1,rect:this.rect,pagePtr:s.pagePtr}),this.setAnnotationChanged({opacity:r})}},{key:"color",get:function(){return this.annotation.color},set:function(r){var u,s=this.annotation;s.color=r,(u=this.layer)===null||u===void 0||u.redrawMarkups({pageIndex:s.pageIndex,afterContentEdit:!1,rect:this.rect,pagePtr:s.pagePtr}),this.setAnnotationChanged({borderColor:r})}},{key:"handlePropertyPanel",value:function(r){if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){var u=this.annotation,s=0;for(var w in r)for(var m in u){var v=r[w];m===w&&u[m]!==v&&(u[w]=v,s++,w!=="opacity"&&w!=="color"||this.documentViewer.eventBus.dispatch("redrawMarkups",{pageIndex:u.pageIndex,afterContentEdit:!1,rect:this.rect,pagePtr:u.pagePtr}))}if(s>0){var g={operate:"mod-annot",type:this.type,name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},d=Object.assign({},g,r);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:d}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}}]);var o}(),TextHighlightAnnotation=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.enableReply,m=w===void 0||w;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="highlight",r.enableReply=m,r.hidden=!0,r.markupContainer=null,r.outerLineContainer=null,r.onHandleClick=r.handleClick.bind(r),r.onDelete=r.handleDelete.bind(r),r.onOpenReply=r.openReply.bind(r),r}return _inherits(n,MakupAnnotation),_createClass(n,[{key:"drawCanvas",value:function(o,r){var u=this.annotation;if(u.color){var s=convertColorToRGB(u.color),w=s.R,m=s.G,v=s.B;this.ctx.fillStyle="rgba(".concat(w,", ").concat(m,", ").concat(v,", ").concat(u.opacity||1,")")}else this.ctx.fillStyle="#FEF87C";for(var g=0;g<o.length;g++){var d=o[g];this.ctx.fillRect(d.left*this.ratio-r.x1,d.top*this.ratio-r.y1,d.width*this.ratio,d.height*this.ratio)}}}])}(),TextSquigglyAnnotation=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.enableReply,m=w===void 0||w;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="squiggly",r.enableReply=m,r.hidden=!0,r.markupContainer=null,r.outerLineContainer=null,r.onHandleClick=r.handleClick.bind(r),r.onDelete=r.handleDelete.bind(r),r.onOpenReply=r.openReply.bind(r),r}return _inherits(n,MakupAnnotation),_createClass(n,[{key:"drawCanvas",value:function(o,r){var u=this.annotation,s=3*this.documentViewer.scale,w=20*this.documentViewer.scale;if(u.color){var m=convertColorToRGB(u.color),v=m.R,g=m.G,d=m.B;this.ctx.strokeStyle="rgba(".concat(v,", ").concat(g,", ").concat(d,", ").concat(u.opacity||1,")")}this.ctx.lineWidth=2*this.documentViewer.scale*this.ratio;for(var f=0;f<o.length;f++){var y=o[f];this.ctx.beginPath();for(var x=y.left*this.ratio-r.x1;x<=(y.left+y.width)*this.ratio-r.x1;x++){var k=(y.top+y.height)*this.ratio-r.y1+s*Math.sin(x/w*2*Math.PI);this.ctx.lineTo(x,k)}this.ctx.stroke()}}}])}(),TextStrikeoutAnnotation=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.enableReply,m=w===void 0||w;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="strikeout",r.enableReply=m,r.hidden=!0,r.markupContainer=null,r.outerLineContainer=null,r.onHandleClick=r.handleClick.bind(r),r.onDelete=r.handleDelete.bind(r),r.onOpenReply=r.openReply.bind(r),r}return _inherits(n,MakupAnnotation),_createClass(n,[{key:"drawCanvas",value:function(o,r){var u=this.annotation;if(u.color){var s=convertColorToRGB(u.color),w=s.R,m=s.G,v=s.B;this.ctx.fillStyle="rgba(".concat(w,", ").concat(m,", ").concat(v,", ").concat(u.opacity||1,")")}for(var g=0;g<o.length;g++){var d=o[g];this.ctx.fillRect(d.left*this.ratio-r.x1,(d.top+d.height/2)*this.ratio-r.y1,d.width*this.ratio,2*this.documentViewer.scale*this.ratio)}}}])}(),TextUnderlineAnnotation=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.enableReply,m=w===void 0||w;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="underline",r.enableReply=m,r}return _inherits(n,MakupAnnotation),_createClass(n,[{key:"drawCanvas",value:function(o,r){var u=this.annotation;if(u.color){var s=convertColorToRGB(u.color),w=s.R,m=s.G,v=s.B;this.ctx.fillStyle="rgba(".concat(w,", ").concat(m,", ").concat(v,", ").concat(u.opacity||1,")")}for(var g=0;g<o.length;g++){var d=o[g];this.ctx.fillRect(d.left*this.ratio-r.x1,(d.top+d.height)*this.ratio-r.y1,d.width*this.ratio,2*this.documentViewer.scale*this.ratio)}}}])}(),PaintLink=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.linkEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.linkEle&&this.linkEle.remove(),this.linkEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale),u={operate:"add-annot",type:"link",pageIndex:this.layer.page,date:new Date},s={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},w={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},m={left:s.x,top:s.y,right:w.x,bottom:w.y};u.rect=m,this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:u})}this.initStartPoint=null,this.initEndPoint=null,this.linkEle&&this.linkEle.remove(),this.linkEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.linkEle){var m=this.calculate(this.initStartPoint,this.initEndPoint),v=this.linkEle;v.style.top="".concat(m.top,"px"),v.style.left="".concat(m.left,"px"),v.style.width="".concat(Math.abs(m.width-1),"px"),v.style.height="".concat(Math.abs(m.height-1),"px")}else{var g=createElement("div",{display:"block",backgroundColor:"#93B9FD",opacity:"0.3",position:"absolute"});this.linkEle=g,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.linkEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}}])}(),Link=function(e){function n(u){var s,w=u.annotation,m=u.documentViewer,v=u.show,g=v!==void 0&&v,d=u.highlight;return _classCallCheck(this,n),(s=_callSuper(this,n,[{annotation:w,documentViewer:m}])).type="link",s.show=g,s.highlight=d,s.hidden=!0,s.initial=!1,s.start=null,s.end=null,s.newStart=null,s.newEnd=null,s.startCircle=null,s.endCircle=null,s.selectionOutlinePadding=8,s.selectionOutlinePointWidth=6,s.onMousedown=s.handleMouseDown.bind(s),s.onMouseup=s.handleMouseUp.bind(s),s.onMousemove=s.handleMouseMove.bind(s),s.onDelete=s.handleDelete.bind(s),s.setHighlight=s.setHighlight.bind(s),s.render(),s}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var u;for(var s in this.documentViewer.eventBus._on("linkPropertyPanelChanged",this.handlePropertyPanel.bind(this)),this.documentViewer.eventBus._on("setProperty",this.setProperty.bind(this)),this.documentViewer.eventBus._on("setHighlightLink",this.setHighlight),this.annotation)s==="background-color"&&(this.annotation.backgroundColor=this.annotation[s],delete this.annotation[s]),s==="OnActivation"&&(this.annotation[s].Action&&this.annotation[s].Action.Dest&&this.annotation[s].Action.Dest.XYZ?(this.annotation.destPage=(parseInt(this.annotation.OnActivation.Action.Dest.XYZ.Page)+1).toString(),this.annotation.url=""):this.annotation[s].Action&&this.annotation[s].Action.URI&&(this.annotation.url=this.annotation.OnActivation.Action.URI.URI,this.annotation.destPage=""),delete this.annotation[s]),s==="Dest"&&(this.annotation[s].XYZ&&this.annotation[s].XYZ.Page&&(this.annotation.destPage=(parseInt(this.annotation.Dest.XYZ.Page)+1).toString(),this.annotation.url=""),delete this.annotation[s]);if((u=this.annotation.url)===null||u===void 0||!u.startsWith("af://")){var w=this.annotation,m=this.getActualRect(this.documentViewer.scale),v=m.start,g=m.end;this.start=v,this.end=g;var d,f=this.calculate(v,g),y=document.createElement("div");y.id=w.name,y.className="annotation",y.style.top=f.top+"px",y.style.left=f.left+"px",y.style.width=f.width+"px",y.style.height=f.height+"px",y.style.backgroundColor=this.highlight?"#93B9FD":"",y.style.opacity=.3,this.annotationContainer=y,this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),d=createElement("div",{left:0,top:0,width:"".concat(Math.abs(f.width),"px"),height:"".concat(Math.abs(f.height),"px"),position:"relative"}),this.shapeElement=d,this.annotationContainer.append(this.shapeElement),this.buttonContainer=createElement("a",{display:"block",width:"100%",height:"100%",outline:"none"}),this.shapeElement.append(this.buttonContainer),this.buttonContainer.addEventListener("blur",this.onBlur),this.annotation.url&&(this.buttonContainer.setAttribute("href",this.annotation.url),this.buttonContainer.setAttribute("target","_blank")),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:f.left+f.width-42+"px",top:f.top+f.height+12+"px"},{class:"popupElement"}),this.deletetButton=createElement("div",{width:"30px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr;var x=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+1;this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(f.left-x,"px"),top:"".concat(f.top-x,"px"),width:"".concat(f.width+2*x,"px"),height:"".concat(f.height+2*x,"px"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:f.width+this.selectionOutlinePadding,height:f.height+this.selectionOutlinePadding,x:this.selectionOutlinePointWidth/2+1,y:this.selectionOutlinePointWidth/2+1}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:1,y:(f.height+this.selectionOutlinePadding)/2+1}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:1,y:f.height+this.selectionOutlinePadding+1}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(f.width+this.selectionOutlinePadding)/2+1,y:f.height+this.selectionOutlinePadding+1}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f.width+this.selectionOutlinePadding+1,y:f.height+this.selectionOutlinePadding+1}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f.width+this.selectionOutlinePadding+1,y:(f.height+this.selectionOutlinePadding)/2+1}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:f.width+this.selectionOutlinePadding+1,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:(f.width+this.selectionOutlinePadding)/2+1,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.outerLineContainer.append(this.popupElement),this.popupElement.append(this.deletetButton),this.initial=!0,this.show&&this.handleClick()}}},{key:"getActualRect",value:function(u){var s=this.annotation.rect,w=s.left,m=s.top,v=s.right,g=s.bottom;return{start:getActualPoint$1({x:w,y:m},u),end:getActualPoint$1({x:v,y:g},u)}}},{key:"rectCalc",value:function(u){var s=u.start,w=u.end;return{top:s.y<w.y?s.y:w.y,left:s.x<w.x?s.x:w.x,width:Math.abs(w.x-s.x),height:Math.abs(w.y-s.y)}}},{key:"calculate",value:function(u,s){var w=this.rectCalc({start:u,end:s});return{top:w.top,left:w.left,width:w.width,height:w.height}}},{key:"getInitialPoint",value:function(){var u=this.documentViewer.scale;return{start:{x:this.start.x/u,y:this.start.y/u},end:{x:this.end.x/u,y:this.end.y/u}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var u=this.annotation;this.documentViewer.annotationStore.selectedElementName=u.name;var s=_objectSpread2$1({},u);delete s.annotPtr,delete s.pagePtr,delete s.operate,delete s.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",s)}this.layer.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("linkPanelChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var u,s;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(u=this.layer)===null||u===void 0||u.div.classList.remove("no-edit"):(s=this.layer)===null||s===void 0||s.div.classList.add("no-edit")}},{key:"handleClick",value:function(u){var s,w;this.setPopupElementStyle(),!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((s=this.layer)===null||s===void 0?void 0:s.tool)||document.querySelector(".compare-document-container").contains(u==null?void 0:u.target)||this.documentViewer.toolMode==="editor"||(this.documentViewer.toolMode==="annotation"&&((w=this.layer)===null||w===void 0?void 0:w.tool)==="link"?(this.hidden=!1,this.updateTool(),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement,document.getElementById("linkPanel")],this.handleOutside.bind(this))):this.annotation.destPage?this.documentViewer.eventBus.dispatch("pageNumberChanged",this.annotation.destPage):this.annotation.url&&this.buttonContainer.click())}},{key:"handleOutside",value:function(){var u,s,w,m=this.documentViewer.annotationStore.selectedElementName,v=this.annotation.name;if(this.hidden||m!==v||(this.documentViewer.eventBus.dispatch("linkPanelChange",null),this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,m===v&&(this.documentViewer.annotationStore.selectedElementName=null),(u=this.outerLine)===null||u===void 0||u.removeEventListener("mousedown",this.onMousedown),(s=this.outerLine)===null||s===void 0||s.removeEventListener("touchstart",this.onMousedown),(w=this.outerLineContainer)===null||w===void 0||w.remove(),!this.annotation.url&&!this.annotation.destPage){var g,d;(g=this.annotationContainer)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,(d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name});var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}this.documentViewer.getScrollViewElement().style.touchAction="auto"}},{key:"handleMouseDown",value:function(u){var s;if(u.button===0||u.type!=="mousedown"){(s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation();var w=u.target.getAttribute("data-id"),m=this.documentViewer.getScrollViewElement();this.scrollTop=m.scrollTop,this.scrollLeft=m.scrollLeft;var v=getClickPoint(u),g=v.pageX,d=v.pageY;this.startState={operator:w,clickX:g,clickY:d},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup),this.handleClick()}}},{key:"handleMouseMove",value:function(u){if(u.button===0||u.type!=="mousemove"){u.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var s=getClickPoint(u),w=s.pageX,m=s.pageY,v=this.documentViewer,g=v.getScrollViewElement(),d=g.scrollTop;w=w+g.scrollLeft-this.scrollLeft,m=m+d-this.scrollTop;var f=this.start,y=this.end,x=this.startState,k=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+1,P=v.scale,S=v.getPageWidth(this.PageNumber)*P,E=v.getPageHeight(this.PageNumber)*P;if(x.operator==="nw-resize"){var M=w-(x.clickX-this.start.x),T=m-(x.clickY-this.start.y);M=Math.min(y.x-5,M),M=Math.max(k,M),T=Math.min(y.y-5,T),T=Math.max(k,T),this.update({start:{x:M,y:T},end:y})}else if(x.operator==="w-resize"){var D=w-(x.clickX-this.start.x);D=Math.min(y.x-5,D),D=Math.max(k,D),this.update({start:{x:D,y:f.y},end:y})}else if(x.operator==="sw-resize"){var N=w-(x.clickX-this.start.x),I=m-(x.clickY-this.end.y);N=Math.min(y.x-5,N),N=Math.max(k,N),I=Math.min(E-k,I),I=Math.max(f.y+5,I),this.update({start:{x:N,y:f.y},end:{x:y.x,y:I}})}else if(x.operator==="s-resize"){var O=m-(x.clickY-this.end.y);O=Math.min(E-k,O),O=Math.max(f.y+5,O),this.update({start:f,end:{x:y.x,y:O}})}else if(x.operator==="se-resize"){var F=w-(x.clickX-this.end.x),q=m-(x.clickY-this.end.y);F=Math.min(S-k,F),F=Math.max(f.x+5,F),q=Math.min(E-k,q),q=Math.max(f.y+5,q),this.update({start:f,end:{x:F,y:q}})}else if(x.operator==="e-resize"){var Y=w-(x.clickX-this.end.x);Y=Math.min(S-k,Y),Y=Math.max(f.x+5,Y),this.update({start:f,end:{x:Y,y:y.y}})}else if(x.operator==="ne-resize"){var _e=w-(x.clickX-this.end.x),ne=m-(x.clickY-this.start.y);_e=Math.min(S-k,_e),_e=Math.max(f.x+5,_e),ne=Math.min(y.y-5,ne),ne=Math.max(k,ne),this.update({start:{x:f.x,y:ne},end:{x:_e,y:y.y}})}else if(x.operator==="n-resize"){var ve=m-(x.clickY-this.start.y);ve=Math.min(y.y-5,ve),ve=Math.max(k,ve),this.update({start:{x:f.x,y:ve},end:y})}else if(x.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(u),U=X.getSelectedPage(H,H),te=this.PageNumber;if(U.first&&U.first!==te){var Q,re=X.windowToPage(H,U.first,!1),Pe=Math.abs(f.x-y.x),be=Math.abs(f.y-y.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=w-(x.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=w-(x.clickX-this.end.x),j=U.first>te?re.y+be:re.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?re.x:re.x-Pe,fe=m-(x.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=m-(x.clickY-this.end.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var we=Math.min(U.first,te),Ae=Math.max(U.first,te);if(Ae-we>2||we+1===Ae&&we%2==0)return;we+1===Ae?(J=U.first>te?re.x:re.x-Pe,fe=m-(x.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=m-(x.clickY-this.end.y)):we+2===Ae&&(J=w-(x.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=w-(x.clickX-this.end.x),j=U.first>te?re.y+be:re.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var $e=Math.min(U.first,te),Me=Math.max(U.first,te);if(Me-$e>2||$e+1===Me&&($e!==1||Me!==2)&&Me%2==0||$e===1&&Me===3)return;$e+2===Me||$e===1&&Me===2?(J=w-(x.clickX-this.start.x),fe=U.first>te?re.y:re.y-be,Z=w-(x.clickX-this.end.x),j=U.first>te?re.y+be:re.y):$e+1===Me&&(J=U.first>te?re.x:re.x-Pe,fe=m-(x.clickY-this.start.y),Z=U.first>te?re.x+Pe:re.x,j=m-(x.clickY-this.end.y))}if(!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ie=(Q=this.layer)===null||Q===void 0?void 0:Q.div;Ie==null||Ie.append(this.annotationContainer),Ie==null||Ie.append(this.outerLineContainer)}else{J=w-(x.clickX-this.start.x),fe=m-(x.clickY-this.start.y),Z=w-(x.clickX-this.end.x),j=m-(x.clickY-this.end.y);var Le=X.pageToWindow({x:J,y:fe},te,!1),le=X.pageToWindow({x:Z,y:j},te,!1),oe=0,ke=0;m>x.clickY?ke=(ke=g.offsetHeight-(le.y-g.scrollTop-g.offsetTop))<100?5:0:m<x.clickY&&(ke=(ke=Le.y-g.scrollTop-g.offsetTop)<100?-5:0),w>x.clickX?oe=(oe=g.offsetWidth-(le.x-g.scrollLeft-g.offsetLeft))<100?5:0:w<x.clickX&&(oe=(oe=Le.x-g.scrollLeft-g.offsetLeft)<100?-5:0),(oe||ke)&&(g.scrollTop+=ke,g.scrollLeft+=oe);var Ce={width:Math.abs(f.x-y.x),height:Math.abs(f.y-y.y)};J<Z?(J=Math.max(k,J),J=Math.min(S-Ce.width-k,J),Z=Math.max(Ce.width+k,Z),Z=Math.min(S-k,Z)):(Z=Math.max(k,Z),Z=Math.min(S-Ce.width-k,Z),J=Math.max(Ce.width+k,J),J=Math.min(S-k,J)),fe<j?(fe=Math.max(k,fe),fe=Math.min(E-Ce.height-k,fe),j=Math.max(Ce.height+k,j),j=Math.min(E-k,j)):(j=Math.max(k,j),j=Math.min(E-Ce.height-k,j),fe=Math.max(Ce.height+k,fe),fe=Math.min(E-k,fe))}this.update({start:{x:J,y:fe},end:{x:Z,y:j}})}x.clickX=w,x.clickY=m}}},{key:"handleDelete",value:function(u){var s;(s=this.layer)!==null&&s!==void 0&&s.tool&&u&&u.stopPropagation(),this.delete();var w={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(w.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",w),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var u,s;this.handleOutside(),(u=this.annotationContainer)===null||u===void 0||u.remove(),this.annotation.isDelete=!0,(s=this.layer)===null||s===void 0||s.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:function(u){var s;if(u.button===0||u.type!=="mouseup"){(s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0;var w=this.annotation,m=this.getInitialPoint(),v=m.start,g=m.end,d={left:v.x,top:v.y,right:g.x,bottom:g.y};if(d!==w.rect||this.PrePageNumber!==this.PageNumber)if(w.rect=d,this.PrePageNumber!==this.PageNumber){var f={type:"delete",annotation:{operate:"del-annot",name:w.name,pageIndex:w.pageIndex,annotPtr:w.annotPtr}};this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this);var y=Object.assign({},w);delete y.annotPtr,delete y.pagePtr,delete y.name,y.operate="add-annot",y.pageIndex=this.PageNumber-1,this.documentViewer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:y}),this.annotationContainer.remove(),this.outerLineContainer.remove()}else this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:d}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var u=this.documentViewer.scale,s=this.getActualRect(u),w=s.start,m=s.end;this.update({start:w,end:m})}}},{key:"update",value:function(u){var s=u.start,w=u.end,m=this.calculate(s,w);this.start=s,this.end=w,this.annotationContainer.style.top=m.top+"px",this.annotationContainer.style.left=m.left+"px",this.annotationContainer.style.width=m.width+"px",this.annotationContainer.style.height=m.height+"px",this.annotationContainer.style.width="".concat(m.width,"px"),this.annotationContainer.style.height="".concat(m.height,"px"),this.shapeElement.style.width="".concat(m.width,"px"),this.shapeElement.style.height="".concat(m.height,"px");var v=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+1;this.outerLine.style.left="".concat(m.left-v,"px"),this.outerLine.style.top="".concat(m.top-v,"px"),this.outerLine.style.width="".concat(m.width+2*v,"px"),this.outerLine.style.height="".concat(m.height+2*v,"px");var g=m.left+m.width-42+"px",d=m.top+m.height+12+"px";this.popupElement.style.left=g,this.popupElement.style.top=d,this.moveRect.setAttribute("width",m.width+this.selectionOutlinePadding+1),this.moveRect.setAttribute("height",m.height+this.selectionOutlinePadding+1),this.LeftRect.setAttribute("y",(m.height+this.selectionOutlinePadding)/2+1),this.bottomLeftRect.setAttribute("y",m.height+this.selectionOutlinePadding+1),this.bottomRect.setAttribute("x",(m.width+this.selectionOutlinePadding)/2+1),this.bottomRect.setAttribute("y",m.height+this.selectionOutlinePadding+1),this.bottomRightRect.setAttribute("x",m.width+this.selectionOutlinePadding+1),this.bottomRightRect.setAttribute("y",m.height+this.selectionOutlinePadding+1),this.rightRect.setAttribute("x",m.width+this.selectionOutlinePadding+1),this.rightRect.setAttribute("y",(m.height+this.selectionOutlinePadding)/2+1),this.topRightRect.setAttribute("x",m.width+this.selectionOutlinePadding+1),this.topRect.setAttribute("x",(m.width+this.selectionOutlinePadding)/2+1)}},{key:"setAnnotationChanged",value:function(u){var s=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"link",operate:"mod-annot",name:s.name,pageIndex:this.PageNumber-1,pagePtr:s.pagePtr,annotPtr:s.annotPtr},u)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"url",get:function(){return this.annotation.url},set:function(u){var s=this.annotation;u!==s.url&&(s.destPage="",s.url=u,this.buttonContainer.setAttribute("href",u),this.buttonContainer.setAttribute("target","_blank"),this.setAnnotationChanged({destPage:"",url:u}))}},{key:"destPage",get:function(){return this.annotation.destPage},set:function(u){var s=this.annotation;u!==s.destPage&&(s.url="",s.destPage=u,this.buttonContainer.setAttribute("href",""),this.setAnnotationChanged({destPage:u,url:""}))}},{key:"handlePropertyPanel",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function u(s){var w,m,v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){y.next=2;break}return y.abrupt("return");case 2:for(v in w=this.annotation,m=0,s){for(g in w)g!==v||w[g]===s[v]||["url","destPage"].includes(v)||(w[g]=s[v],m++);v==="url"&&w[v]!==s[v]&&(this.buttonContainer.setAttribute("href",s[v]),this.buttonContainer.setAttribute("target","_blank"),w.destPage="",w.url=s[v],m++),v==="destPage"&&w[v]!==s[v]&&(w.url="",w.destPage=s[v],m++)}if(!(m>0)){y.next=11;break}return d={operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,url:w.url,destPage:w.destPage},f=Object.assign({},d,s),y.next=10,this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:f});case 10:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 11:this.handleOutside();case 12:case"end":return y.stop()}},u,this)})),function(u){return r.apply(this,arguments)})},{key:"setProperty",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function u(s){var w,m,v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){y.next=2;break}return y.abrupt("return");case 2:for(v in w=this.annotation,m=0,s){for(g in w)g!==v||w[g]===s[v]||["url","destPage"].includes(v)||(w[g]=s[v],m++);v==="url"&&w[v]!==s[v]&&(this.buttonContainer.setAttribute("href",s[v]),this.buttonContainer.setAttribute("target","_blank"),w.destPage="",w.url=s[v],m++),v==="destPage"&&w[v]!==s[v]&&(w.url="",w.destPage=s[v],m++)}if(!(m>0)){y.next=11;break}return d={operate:"mod-annot",name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,url:w.url,destPage:w.destPage},f=Object.assign({},d,s),y.next=10,this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:f});case 10:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 11:case"end":return y.stop()}},u,this)})),function(u){return o.apply(this,arguments)})},{key:"isURL",value:function(u){return/^(?:(?:https?|ftp):\/\/)?(?:www\.)?(?:[\w]+\.){1,3}(?:[a-z]{2,})?(?:\/[\w .-]*)*(?:\?[^\s]*)?$/.test(u)}},{key:"setHighlight",value:function(u){this.highlight=u,this.annotationContainer&&(this.annotationContainer.style.backgroundColor=this.highlight?"#93B9FD":"")}}]);var o,r}(),AddSignField=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.eventBus._off("initTextfieldName",this.initTextfieldName)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName&&!document.getElementById("sign-image-save")){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale),u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={left:u.x,top:u.y,right:s.x,bottom:s.y},m={operate:"add-form",type:"signatureFields",pageIndex:this.layer.page,date:new Date,rect:w,isSigned:0},v=1,g=this.layer.documentViewer.getAnnotationManager().getAnnotationsList();if(g&&g.length)for(var d=g.filter(function(x){return x.type==="signatureFields"}),f=function(){var x="SignatureFormField"+(y+1);if(d.every(function(k){return k.fieldName!==x}))return v=y+1,1},y=0;y<=d.length&&!f();y++);m.fieldName="SignatureFormField"+v,this.layer.documentViewer.getAnnotationManager().showIndicator()&&(m.indicator=!0,m.indicatorText=this.layer.annotationStore.$t("panels.right.general.signHere")),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:m})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.tool==="signatureFields"&&document.getElementById("createSignFieldButton").click()}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height;if(this.layer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#93B9FD",opacity:"0.3",position:"absolute"});this.shapeEle=k,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.layer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}}])}(),SignatureFields=function(e){function n(v){var g,d=v.annotation,f=v.documentViewer;return _classCallCheck(this,n),(g=_callSuper(this,n,[{annotation:d,documentViewer:f}])).type="signatureFields",g.hidden=!0,g.start=null,g.end=null,g.newStart=null,g.newEnd=null,g.startCircle=null,g.endCircle=null,g.ratio=window.devicePixelRatio||1,g.isDigital=!1,g.onMousedown=g.handleMouseDown.bind(g),g.onMouseup=g.handleMouseUp.bind(g),g.onMousemove=g.handleMouseMove.bind(g),g.onDelete=g.handleDelete.bind(g),g.toggleAttrbutePanel=g.toggleAttrbutePanel.bind(g),g.handlePropertyPanel=g.handlePropertyPanel.bind(g),g.render(),g}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function v(){var g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e;return _regeneratorRuntime().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return x=this.annotation,this.documentViewer.eventBus._on("setProperty",this.setProperty.bind(this)),this.documentViewer.eventBus._on("updateSignatureFieldAp",this.updateAp.bind(this)),!x.borderStyle&&(x.borderStyle="solid"),!x.borderColor&&(x.borderColor="#000000"),!x.borderWidth&&(x.borderWidth=0),!x.color&&(x.color="#000000"),!x.fillColor&&(x.fillColor="transparent"),x.required=(g=x.required)!==null&&g!==void 0?g:0,x.indicator=(d=x.indicator)!==null&&d!==void 0&&d,x.indicatorText=(f=x.indicatorText)!==null&&f!==void 0?f:"",this.scale=this.documentViewer.scale,k=this.getActualRect(this.documentViewer.scale),P=k.start,S=k.end,this.start=P,this.end=S,E=this.calculate(P,S),M=this.getWidth(),T=this.getHeight(),(D=document.createElement("div")).id=x.name,D.className="annotation",D.style.top="calc(var(--scale-factor) * ".concat(x.rect.top,"px)"),D.style.left="calc(var(--scale-factor) * ".concat(x.rect.left,"px)"),D.style.width="calc(var(--scale-factor) * ".concat(M,"px)"),D.style.height="calc(var(--scale-factor) * ".concat(T,"px)"),this.isHidden&&this.documentViewer.annotationManager.isInFormFieldFillMode()&&(D.style.display="none"),this.annotationContainer=D,this.scale=this.documentViewer.scale,N=createElement("div",{left:0,top:0,width:"100%",height:"100%",backgroundColor:"rgb(147, 185, 253, 0.3)",position:"relative"}),this.shapeElement=N,x.isSigned||x.isSignedDigitally||((I=createElement("div",{position:"absolute",left:0,top:0,width:"73px",height:"22px",backgroundColor:"#1460F3",fontSize:"12px",fontWeight:"600",color:"white",lineHeight:"22px",textAlign:"center",transformOrigin:"0 0"})).innerText="SIGN HERE",O=Math.min(E.width/73,E.height/22),I.style.transform=O<1?"scale(".concat(O,")"):"",this.tagElement=I),this.signature&&(this.isDigital=this.signature.isDigital),ne.next=34,this.getSignatureImage();case 34:F=ne.sent,x.imageBase64=F,this.annotationContainer.append(this.shapeElement),!x.isSigned&&!x.isSignedDigitally&&this.annotationContainer.append(this.tagElement),this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),(q=document.createElement("div")).classList.add("indicator"),(Y=document.createElement("div")).innerText=(y=x.indicatorText)!==null&&y!==void 0?y:"",q.append(Y),this.setCss(q,{top:"calc(var(--scale-factor) * ".concat((x.rect.top+x.rect.bottom)/2,"px - 20px)")}),this.indicatorBox=q,this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:E.left+E.width-84+"px",top:E.top+E.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,(_e=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",_e.style.zIndex=1,_e.style.left="".concat(E.left-8,"px"),_e.style.top="".concat(E.top-8,"px"),_e.style.width="".concat(E.width+16,"px"),_e.style.height="".concat(E.height+16,"px"),this.outerLine=_e,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:E.width+8,height:E.height+8,x:4,y:4}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:1}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:E.height/2+5}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:1,y:E.height+9}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:E.width/2+5,y:E.height+9}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:E.width+9,y:E.height+9}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:E.width+9,y:E.height/2+5}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:E.width+9,y:1}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#FFFFFF",stroke:"#4982E6","stroke-width":1,width:6,height:6,x:E.width/2+5,y:1}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement),this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 88:case"end":return ne.stop()}},v,this)})),function(){return m.apply(this,arguments)})},{key:"getActualRect",value:function(v){var g=this.annotation.rect,d=g.left,f=g.top,y=g.right,x=g.bottom;return{start:getActualPoint$1({x:d,y:f},v),end:getActualPoint$1({x:y,y:x},v)}}},{key:"rectCalc",value:function(v){var g=v.start,d=v.end;return{top:g.y<d.y?g.y:d.y,left:g.x<d.x?g.x:d.x,width:Math.abs(d.x-g.x),height:Math.abs(d.y-g.y)}}},{key:"calculate",value:function(v,g){var d=this.rectCalc({start:v,end:g});this.initRect=d;var f=this.annotation.borderWidth*this.documentViewer.scale;return{top:d.top-f,left:d.left-f,width:d.width+2*f,height:d.height+2*f}}},{key:"setFieldIndicator",value:function(v,g){var d,f,y=this.annotation,x={};v!==y.indicator&&(y.indicator=v,x.indicator=v,v?this.layer.pageDiv.append(this.indicatorBox):(d=this.indicatorBox)===null||d===void 0||d.remove()),typeof g=="string"&&g!==y.indicatorText&&(y.indicatorText=g,x.indicatorText=g,v?this.layer.pageDiv.append(this.indicatorBox):(f=this.indicatorBox)===null||f===void 0||f.remove(),this.indicatorBox.querySelector("div").innerText=g),("indicator"in x||"indicatorText"in x)&&this.setAnnotationChanged(_objectSpread2$1({},x))}},{key:"getInitialPoint",value:function(){var v=this.documentViewer.scale;return{start:{x:this.start.x/v,y:this.start.y/v},end:{x:this.end.x/v,y:this.end.y/v}}}},{key:"updateTool",value:function(){if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var v;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var g=this.annotation;this.documentViewer.annotationStore.selectedElementName=g.name;var d=_objectSpread2$1({},g);delete d.annotPtr,delete d.pagePtr,delete d.operate,delete d.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",d)}(v=this.layer)===null||v===void 0||v.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.documentViewer.eventBus.dispatch("propertyChange",this.annotation),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var v,g;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(v=this.layer)===null||v===void 0||v.div.classList.remove("no-edit"):(g=this.layer)===null||g===void 0||g.div.classList.add("no-edit")}},{key:"handleClick",value:function(v){var g,d,f;this.setPopupElementStyle(),!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||["redaction","remove"].includes((g=this.layer)===null||g===void 0?void 0:g.tool)||document.querySelector(".compare-document-container").contains(v==null?void 0:v.target)||this.documentViewer.toolMode==="editor"||document.getElementById("sign-image-save")||this.isDigital||((d=this.layer)===null||d===void 0?void 0:d.pageDiv.querySelector(".annotationLayer svg").style.cursor)==="crosshair"&&this.documentViewer.toolMode!=="sign"||(((f=this.layer)===null||f===void 0?void 0:f.tool)==="signatureFields"?(this.hidden=!1,this.updateTool(),this.documentViewer.eventBus._on("signatureFieldsPropertyPanelChanged",this.handlePropertyPanel),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement,document.querySelector(".right-panel")],this.handleOutside.bind(this))):(this.documentViewer.eventBus.dispatch("openSelectSignTypeDialog",this.annotation),this.focus()))}},{key:"isRequired",value:function(){return this.annotation.required}},{key:"isSigned",get:function(){return this.annotation.isSigned||this.annotation.isSignedDigitally}},{key:"signature",get:function(){return this.annotation.signature}},{key:"fieldName",get:function(){return this.annotation.fieldName}},{key:"handleOutside",value:function(){var v,g,d;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null,this.documentViewer.eventBus.dispatch("propertyChange",null)),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(v=this.outerLine)===null||v===void 0||v.removeEventListener("mousedown",this.onMousedown),(g=this.outerLine)===null||g===void 0||g.removeEventListener("touchstart",this.onMousedown),(d=this.outerLineContainer)===null||d===void 0||d.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.documentViewer.eventBus._off("checkboxPropertyPanelChanged",this.handlePropertyPanel)}},{key:"handleMouseDown",value:function(v){var g;if(v.button===0||v.type!=="mousedown"){(g=this.layer)!==null&&g!==void 0&&g.tool&&v.stopPropagation();var d=v.target.getAttribute("data-id"),f=this.documentViewer.getScrollViewElement();this.scrollTop=f.scrollTop,this.scrollLeft=f.scrollLeft;var y=getClickPoint(v),x=y.pageX,k=y.pageY;this.startState={operator:d,clickX:x,clickY:k},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(v){if(v.button===0||v.type!=="mousemove"){v.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var g=getClickPoint(v),d=g.pageX,f=g.pageY,y=this.documentViewer,x=y.getScrollViewElement(),k=x.scrollTop;d=d+x.scrollLeft-this.scrollLeft,f=f+k-this.scrollTop;var P=this.start,S=this.end,E=this.startState,M=y.scale,T=y.getPageWidth(this.PageNumber)*M,D=y.getPageHeight(this.PageNumber)*M;if(E.operator==="nw-resize"){var N=d-(E.clickX-this.start.x),I=f-(E.clickY-this.start.y);N=Math.min(S.x-5,N),N=Math.max(0,N),I=Math.min(S.y-5,I),I=Math.max(0,I),this.update({start:{x:N,y:I},end:S})}else if(E.operator==="w-resize"){var O=d-(E.clickX-this.start.x);O=Math.min(S.x-5,O),O=Math.max(0,O),this.update({start:{x:O,y:P.y},end:S})}else if(E.operator==="sw-resize"){var F=d-(E.clickX-this.start.x),q=f-(E.clickY-this.end.y);F=Math.min(S.x-5,F),F=Math.max(0,F),q=Math.min(D,q),q=Math.max(P.y+5,q),this.update({start:{x:F,y:P.y},end:{x:S.x,y:q}})}else if(E.operator==="s-resize"){var Y=f-(E.clickY-this.end.y);Y=Math.min(D,Y),Y=Math.max(P.y+5,Y),this.update({start:P,end:{x:S.x,y:Y}})}else if(E.operator==="se-resize"){var _e=d-(E.clickX-this.end.x),ne=f-(E.clickY-this.end.y);_e=Math.min(T,_e),_e=Math.max(P.x+5,_e),ne=Math.min(D,ne),ne=Math.max(P.y+5,ne),this.update({start:P,end:{x:_e,y:ne}})}else if(E.operator==="e-resize"){var ve=d-(E.clickX-this.end.x);ve=Math.min(T,ve),ve=Math.max(P.x+5,ve),this.update({start:P,end:{x:ve,y:S.y}})}else if(E.operator==="ne-resize"){var J=d-(E.clickX-this.end.x),fe=f-(E.clickY-this.start.y);J=Math.min(T,J),J=Math.max(P.x+5,J),fe=Math.min(S.y-5,fe),fe=Math.max(0,fe),this.update({start:{x:P.x,y:fe},end:{x:J,y:S.y}})}else if(E.operator==="n-resize"){var Z=f-(E.clickY-this.start.y);Z=Math.min(S.y-5,Z),Z=Math.max(0,Z),this.update({start:{x:P.x,y:Z},end:S})}else if(E.operator==="move"){var j,X,H,U,te=this.documentViewer,Q=this.getMouseLocation(v),re=te.getSelectedPage(Q,Q),Pe=this.PageNumber;if(re.first&&re.first!==Pe){var be,we=te.windowToPage(Q,re.first,!1),Ae=Math.abs(P.x-S.x),$e=Math.abs(P.y-S.y);if(te.pdfViewer.spreadMode===0&&te.pdfViewer.scrollMode===0)j=d-(E.clickX-this.start.x),X=re.first>Pe?we.y:we.y-$e,H=d-(E.clickX-this.end.x),U=re.first>Pe?we.y+$e:we.y;else if(te.pdfViewer.spreadMode===0&&te.pdfViewer.scrollMode===1)j=re.first>Pe?we.x:we.x-Ae,X=f-(E.clickY-this.start.y),H=re.first>Pe?we.x+Ae:we.x,U=f-(E.clickY-this.end.y);else if(te.pdfViewer.spreadMode===1&&te.pdfViewer.scrollMode===0){var Me=Math.min(re.first,Pe),Ie=Math.max(re.first,Pe);if(Ie-Me>2||Me+1===Ie&&Me%2==0)return;Me+1===Ie?(j=re.first>Pe?we.x:we.x-Ae,X=f-(E.clickY-this.start.y),H=re.first>Pe?we.x+Ae:we.x,U=f-(E.clickY-this.end.y)):Me+2===Ie&&(j=d-(E.clickX-this.start.x),X=re.first>Pe?we.y:we.y-$e,H=d-(E.clickX-this.end.x),U=re.first>Pe?we.y+$e:we.y)}else if(te.pdfViewer.spreadMode===2&&te.pdfViewer.scrollMode===0){var Le=Math.min(re.first,Pe),le=Math.max(re.first,Pe);if(le-Le>2||Le+1===le&&(Le!==1||le!==2)&&le%2==0||Le===1&&le===3)return;Le+2===le||Le===1&&le===2?(j=d-(E.clickX-this.start.x),X=re.first>Pe?we.y:we.y-$e,H=d-(E.clickX-this.end.x),U=re.first>Pe?we.y+$e:we.y):Le+1===le&&(j=re.first>Pe?we.x:we.x-Ae,X=f-(E.clickY-this.start.y),H=re.first>Pe?we.x+Ae:we.x,U=f-(E.clickY-this.end.y))}if(!te.pdfViewer._pages[re.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=re.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var oe=(be=this.layer)===null||be===void 0?void 0:be.div;oe==null||oe.append(this.annotationContainer),oe==null||oe.append(this.outerLineContainer)}else{j=d-(E.clickX-this.start.x),X=f-(E.clickY-this.start.y),H=d-(E.clickX-this.end.x),U=f-(E.clickY-this.end.y);var ke=te.pageToWindow({x:j,y:X},Pe,!1),Ce=te.pageToWindow({x:H,y:U},Pe,!1),Ee=0,Be=0;f>E.clickY?Be=(Be=x.offsetHeight-(Ce.y-x.scrollTop-x.offsetTop))<100?5:0:f<E.clickY&&(Be=(Be=ke.y-x.scrollTop-x.offsetTop)<100?-5:0),d>E.clickX?Ee=(Ee=x.offsetWidth-(Ce.x-x.scrollLeft-x.offsetLeft))<100?5:0:d<E.clickX&&(Ee=(Ee=ke.x-x.scrollLeft-x.offsetLeft)<100?-5:0),(Ee||Be)&&(x.scrollTop+=Be,x.scrollLeft+=Ee);var Ve={width:Math.abs(P.x-S.x),height:Math.abs(P.y-S.y)};j<H?(j=Math.max(0,j),j=Math.min(T-Ve.width,j),H=Math.max(Ve.width,H),H=Math.min(T,H)):(H=Math.max(0,H),H=Math.min(T-Ve.width,H),j=Math.max(Ve.width,j),j=Math.min(T,j)),X<U?(X=Math.max(0,X),X=Math.min(D-Ve.height,X),U=Math.max(Ve.height,U),U=Math.min(D,U)):(U=Math.max(0,U),U=Math.min(D-Ve.height,U),X=Math.max(Ve.height,X),X=Math.min(D,X))}this.update({start:{x:j,y:X},end:{x:H,y:U}})}E.clickX=d,E.clickY=f}}},{key:"toggleAttrbutePanel",value:function(){this.documentViewer.eventBus.dispatch("toggleAttrbutePanel")}},{key:"handleDelete",value:function(v){var g,d=v instanceof Event?v:null;if(d||!v||v.signaturePtr===this.annotation.signature.signaturePtr){(g=this.layer)!==null&&g!==void 0&&g.tool&&d&&d.stopPropagation(),this.delete();var f={type:"delete",annotation:{type:this.annotation.type,operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}}},{key:"delete",value:function(){var v,g,d;this.handleOutside(),(v=this.annotationContainer)===null||v===void 0||v.remove(),(g=this.indicatorBox)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,(d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function v(g){var d,f,y,x,k,P,S,E,M,T;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(g.button===0||g.type!=="mouseup"){D.next=2;break}return D.abrupt("return");case 2:if((d=this.layer)!==null&&d!==void 0&&d.tool&&g.stopPropagation(),g.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,f=this.annotation,y=this.getInitialPoint(),x=y.start,k=y.end,(P={left:x.x,top:x.y,right:k.x,bottom:k.y})!==f.rect||this.PrePageNumber!==this.PageNumber){D.next=16;break}return D.abrupt("return");case 16:if(f.rect=P,this.setCss(this.indicatorBox,{top:"calc(var(--scale-factor) * ".concat((f.rect.top+f.rect.bottom)/2,"px - 20px)")}),this.PrePageNumber===this.PageNumber){D.next=41;break}return S={type:"delete",annotation:{type:f.type,operate:"del-annot",name:f.name,pageIndex:f.pageIndex,annotPtr:f.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",S),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(E=Object.assign({},f)).annotPtr,delete E.pagePtr,delete E.name,E.operate="add-form",E.pageIndex=this.PageNumber-1,D.next=31,this.documentViewer.annotationManager.createAnnotation(E);case 31:return M=D.sent,T=new CheckBox({annotation:M,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply,highlight:this.highlight}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),D.next=36,this.documentViewer.annotationManager.addAnnotation(T);case 36:this.documentViewer.annotationManager.drawAnnotationsFromList(T),this.annotationContainer.remove(),this.outerLineContainer.remove(),D.next=44;break;case 41:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-form",type:f.type,name:f.name,pageIndex:this.PageNumber-1,pagePtr:f.pagePtr,annotPtr:f.annotPtr,rect:P}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getSignatureImage(!0);case 44:case"end":return D.stop()}},v,this)})),function(v){return w.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.annotation.indicator&&this.layer.pageDiv.append(this.indicatorBox),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var v=this.documentViewer.scale;if(v!==this.scale){var g=this.getActualRect(v),d=g.start,f=g.end;this.update({start:d,end:f}),this.scale=v,this.getSignatureImage(!0)}}}},{key:"update",value:function(v){var g=v.start,d=v.end,f=this.calculate(g,d);this.start=g,this.end=d;var y=this.getInitialPoint(),x=y.start,k=y.end,P=Math.abs(k.x-x.x),S=Math.abs(k.y-x.y),E=this.annotationContainer.style;E.top="calc(var(--scale-factor) * ".concat(x.y,"px)"),E.left="calc(var(--scale-factor) * ".concat(x.x,"px)"),E.width="calc(var(--scale-factor) * ".concat(P,"px)"),E.height="calc(var(--scale-factor) * ".concat(S,"px)"),this.shapeElement.style.width="".concat(f.width,"px"),this.shapeElement.style.height="".concat(f.height,"px"),this.outerLine.style.left="".concat(f.left-8,"px"),this.outerLine.style.top="".concat(f.top-8,"px"),this.outerLine.style.width="".concat(f.width+16,"px"),this.outerLine.style.height="".concat(f.height+16,"px");var M=f.left+f.width-84+"px",T=f.top+f.height+12+"px";this.popupElement.style.left=M,this.popupElement.style.top=T,this.moveRect.setAttribute("width",f.width+9),this.moveRect.setAttribute("height",f.height+9),this.LeftRect.setAttribute("y",f.height/2+5),this.bottomLeftRect.setAttribute("y",f.height+9),this.bottomRect.setAttribute("x",f.width/2+5),this.bottomRect.setAttribute("y",f.height+9),this.bottomRightRect.setAttribute("x",f.width+9),this.bottomRightRect.setAttribute("y",f.height+9),this.rightRect.setAttribute("x",f.width+9),this.rightRect.setAttribute("y",f.height/2+5),this.topRightRect.setAttribute("x",f.width+9),this.topRect.setAttribute("x",f.width/2+5)}},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function v(g){var d,f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){M.next=2;break}return M.abrupt("return");case 2:for(y in d=this.annotation,f=0,g)for(x in d)x===y&&d[x]!==g[y]&&(d[x]=g[y],f++,y==="indicator"&&(g[y]?this.layer.pageDiv.append(this.indicatorBox):(k=this.indicatorBox)===null||k===void 0||k.remove()),y==="indicatorText"&&(g[y]?this.layer.pageDiv.append(this.indicatorBox):(P=this.indicatorBox)===null||P===void 0||P.remove(),this.indicatorBox.querySelector("div").innerText=g[y]));if(!(f>0)){M.next=12;break}return S={operate:"mod-form",type:d.type,name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr},E=Object.assign({},S,g),M.next=10,this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:E});case 10:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.getSignatureImage();case 12:case"end":return M.stop()}},v,this)})),function(v){return s.apply(this,arguments)})},{key:"setProperty",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function v(g){var d,f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){M.next=2;break}return M.abrupt("return");case 2:for(y in d=this.annotation,f=0,g)for(x in d)x===y&&d[x]!==g[y]&&(d[x]=g[y],f++,y==="indicator"&&(g[y]?this.layer.pageDiv.append(this.indicatorBox):(k=this.indicatorBox)===null||k===void 0||k.remove()),y==="indicatorText"&&(g[y]?this.layer.pageDiv.append(this.indicatorBox):(P=this.indicatorBox)===null||P===void 0||P.remove(),this.indicatorBox.querySelector("div").innerText=g[y]));if(!(f>0)){M.next=11;break}return S={operate:"mod-form",type:d.type,name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr,url:d.url,destPage:d.destPage},E=Object.assign({},S,g),M.next=10,this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:E});case 10:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 11:case"end":return M.stop()}},v,this)})),function(v){return u.apply(this,arguments)})},{key:"getSignatureImage",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function v(){var g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return g=this.initRect,d={width:parseInt(g.width*this.ratio+1),height:parseInt(g.height*this.ratio+1)},E.next=5,this.documentViewer.messageHandler.sendWithPromise("GetRenderAnnot",{pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,width:d.width,height:d.height});case 5:return f=E.sent,(y=document.createElement("canvas")).style.width=d.width+"px",y.style.height=d.height+"px",y.width=d.width,y.height=d.height,x=y.getContext("2d"),(k=x.createImageData(d.width,d.height)).data.set(f),x.putImageData(k,0,0),P=y.toDataURL("image/png",1),this.imgEle?this.imgEle.src=P:((S=document.createElement("img")).style.width="100%",S.style.height="100%",S.style.pointerEvents="none",S.style.display="block",this.isDigital&&(this.annotationContainer.style.zIndex=1,this.shapeElement.style.pointerEvents="none"),this.shapeElement.style.position="absolute",S.src=P,this.imgEle=S,this.annotationContainer.append(this.imgEle)),E.abrupt("return",P);case 18:case"end":return E.stop()}},v,this)})),function(){return r.apply(this,arguments)})},{key:"updateAp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function v(g){var d,f,y,x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(d=g.annotPtr,f=d===void 0?0:d,y=g.signaturePtr,x=y===void 0?0:y,!this.signature||this.signature.signaturePtr!==x){S.next=5;break}this.handleDelete({signaturePtr:x}),S.next=13;break;case 5:if(this.annotation.annotPtr!==f){S.next=13;break}return this.isDigital=!1,this.annotation.isSigned=1,(k=this.tagElement)===null||k===void 0||k.remove(),S.next=11,this.getSignatureImage();case 11:P=S.sent,this.annotation.imageBase64=P;case 13:case"end":return S.stop()}},v,this)})),function(v){return o.apply(this,arguments)})}]);var o,r,u,s,w,m}(),PaintRedaction=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.layer;_classCallCheck(this,e),this.layer=u,this._tool=o,this.color=r,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.linkEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown),this.layer.pageDiv.addEventListener("mousedown",this.onMousedown),this.layer.pageDiv.addEventListener("touchstart",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.linkEle&&this.linkEle.remove(),this.linkEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.layer.pageDiv.removeEventListener("mousedown",this.onMousedown),this.layer.pageDiv.removeEventListener("touchstart",this.onMousedown)}},{key:"handleMouseDown",value:function(e){if(!this.layer.annotationStore.selectedElementName&&!this.layer.pageDiv.classList.contains("text")){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y;this.initStartPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.layer.viewport.scale),r=getInitialPoint$1(n,this.layer.viewport.scale),u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={rect:{left:u.x,top:u.y,right:s.x,bottom:s.y},operate:"add-annot",type:"redact",pageIndex:this.layer.page,date:new Date,erasure:this._tool==="remove"};this._tool==="redaction"&&(w.fillColor="rgb(0, 0, 0)"),this.layer.eventBus.dispatch("annotationChange",{type:"add",show:!0,annotation:w})}this.initStartPoint=null,this.initEndPoint=null,this.linkEle&&this.linkEle.remove(),this.linkEle=null,this.layer.svgElement.innerHTML="",this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.layer.pageDiv,e),o=n.x,r=n.y,u=this.layer.viewport,s=u.width,w=u.height,m=this.layer.viewport.scale;if(o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.linkEle){var v=this.calculate(this.initStartPoint,this.initEndPoint),g=this.linkEle;g.style.top="".concat(v.top,"px"),g.style.left="".concat(v.left,"px"),g.style.width="".concat(Math.abs(v.width-1),"px"),g.style.height="".concat(Math.abs(v.height-1),"px")}else{var d=createElement("div",{display:"block",border:"".concat(2*m,"px solid #FF0000"),position:"absolute"});this.linkEle=d,this.scene=this.layer.pageDiv.querySelector(".annotationLayer"),this.scene.append(this.linkEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n});return{top:o.top,left:o.left,width:o.width,height:o.height}}}])}(),Redaction=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.show,m=w!==void 0&&w;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="redaction",r.hidden=!0,r.initial=!1,r.start=null,r.end=null,r.startCircle=null,r.endCircle=null,r.show=m,r.onMousedown=r.handleMouseDown.bind(r),r.onMouseup=r.handleMouseUp.bind(r),r.onDelete=r.handleDelete.bind(r),r.onKeydown=r.handleKeyDown.bind(r),r.render(),r}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var o=this,r=this.annotation;if(r.hasOwnProperty("rect")){var u=this.getActualRect(this.documentViewer.scale),s=u.start,w=u.end;this.start=s,this.end=w;var m=this.calculate(s,w),v=[];r.rects&&r.rects.length?r.rects.forEach(function(x){var k=o.getActualRect(o.documentViewer.scale,x),P=k.start,S=k.end;v.push(o.calculate(P,S))}):v.push(m);var g=createElement("div",{left:m.left+"px",top:m.top+"px",width:"".concat(Math.abs(m.width),"px"),height:"".concat(Math.abs(m.height),"px")},{id:r.name,class:"annotation redact"});this.annotationContainer=g;var d=(r.borderWidth||2)*this.documentViewer.scale,f=[];v.forEach(function(x){var k=createElement("div",{left:x.left-m.left-(r.erasure?d/2:d)+"px",top:x.top-m.top+"px",width:"".concat(Math.abs(x.width)+(r.erasure?d:2*d),"px"),height:"".concat(Math.abs(x.height),"px"),position:"absolute",border:"".concat(d,"px solid #FF0000"),transition:"none"});r.erasure&&(k.style.backgroundColor="rgba(255, 255, 255)"),f.push(k),o.annotationContainer.append(k)}),this.annotationContainer.addEventListener("mousedown",this.handleClick.bind(this)),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.popupElement=createElement("div",{left:m.left+m.width-42+"px",top:m.top+m.height+12+"px"},{class:"popupElement"}),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr;var y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.style.position="absolute",y.style.zIndex=1,y.style.left="".concat(m.left-8-(r.erasure?d/2:d),"px"),y.style.top="".concat(m.top-8,"px"),y.style.width="".concat(m.width+16+(r.erasure?d:2*d),"px"),y.style.height="".concat(m.height+16,"px"),this.outerLine=y,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#4982E6","stroke-width":1,"fill-opacity":0,width:m.width+8+(r.erasure?d:2*d),height:m.height+8,x:4,y:4},{cursor:"pointer"}),this.outerLine.append(this.moveRect),this.outerLineContainer.append(this.outerLine),this.outerLineContainer.append(this.popupElement),this.popupElement.append(this.deletetButton),r.erasure||(this.annotationContainer.addEventListener("mouseenter",function(){var x;(x=o.layer)!==null&&x!==void 0&&x.pageDiv.classList.contains("selecting")||f.forEach(function(k){k.style.backgroundColor="#000000",k.style.border=""})}),this.annotationContainer.addEventListener("mouseleave",function(){f.forEach(function(x){x.style.backgroundColor="",x.style.border="".concat(d,"px solid #FF0000")})}),this.moveRect.addEventListener("mouseenter",function(){f.forEach(function(x){x.style.backgroundColor="#000000",x.style.border=""})}),this.moveRect.addEventListener("mouseleave",function(){f.forEach(function(x){x.style.backgroundColor="",x.style.border="2px solid #FF0000"})})),this.shapeElements=f,this.initial=!0}}},{key:"draw",value:function(){var o=this;if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var r=this.documentViewer.scale,u=this.getActualRect(r),s=u.start,w=u.end,m=this.calculate(s,w),v=this.annotation,g=[];v.rects&&v.rects.length?v.rects.forEach(function(f){var y=o.getActualRect(r,f),x=y.start,k=y.end;g.push(o.calculate(x,k))}):g.push(m),this.annotationContainer.style.top=m.top+"px",this.annotationContainer.style.left=m.left+"px",this.annotationContainer.style.width=m.width+"px",this.annotationContainer.style.height=m.height+"px";var d=(v.borderWidth||2)*r;this.shapeElements.forEach(function(f,y){var x=g[y];f.style.left=x.left-m.left-(v.erasure?d/2:d)+"px",f.style.top=x.top-m.top+"px",f.style.width="".concat(Math.abs(x.width)+(v.erasure?d:2*d),"px"),f.style.height="".concat(Math.abs(x.height),"px"),f.style.borderWidth="".concat(Math.abs(d),"px")}),this.popupElement.style.left=m.left+m.width-42+"px",this.popupElement.style.top=m.top+m.height+12+"px",this.outerLine.style.left="".concat(m.left-8-(v.erasure?d/2:d),"px"),this.outerLine.style.top="".concat(m.top-8,"px"),this.outerLine.style.width="".concat(m.width+16+(v.erasure?d:2*d),"px"),this.outerLine.style.height="".concat(m.height+16,"px"),this.moveRect.style.width=m.width+8+(v.erasure?d:2*d),this.moveRect.style.height=m.height+8}}},{key:"getActualRect",value:function(o,r){var u=r||this.annotation.rect,s=u.left,w=u.top,m=u.right,v=u.bottom;return{start:getActualPoint$1({x:s,y:w},o),end:getActualPoint$1({x:m,y:v},o)}}},{key:"rectCalc",value:function(o){var r=o.start,u=o.end;return{top:r.y<u.y?r.y:u.y,left:r.x<u.x?r.x:u.x,width:Math.abs(u.x-r.x),height:Math.abs(u.y-r.y)}}},{key:"calculate",value:function(o,r){var u=this.rectCalc({start:o,end:r});return{top:u.top,left:u.left,width:u.width,height:u.height}}},{key:"getInitialPoint",value:function(){var o=this.documentViewer.scale;return{start:{x:this.start.x/o,y:this.start.y/o},end:{x:this.end.x/o,y:this.end.y/o}}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var o;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var r=this.annotation;this.documentViewer.annotationStore.selectedElementName=r.name;var u=_objectSpread2$1({},r);delete u.annotPtr,delete u.pagePtr,delete u.operate,delete u.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",u)}(o=this.layer)===null||o===void 0||o.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown)}}},{key:"setPopupElementStyle",value:function(){var o,r;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(o=this.layer)===null||o===void 0||o.div.classList.remove("no-edit"):(r=this.layer)===null||r===void 0||r.div.classList.add("no-edit")}},{key:"handleClick",value:function(){this.setPopupElementStyle(),!this.hidden||document.fullscreenElement||this.documentViewer.annotationStore.creating||this.documentViewer.toolMode==="editor"||this.documentViewer.toolMode==="redaction"&&(this.hidden=!1,this.updateTool(),onClickOutside$1([this.annotationContainer,this.outerLine,this.popupElement],this.handleOutside.bind(this)))}},{key:"handleOutside",value:function(){var o,r,u,s=this.documentViewer.annotationStore.selectedElementName,w=this.annotation.name;this.hidden||s!==w||(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,s===w&&(this.documentViewer.annotationStore.selectedElementName=null),(o=this.outerLine)===null||o===void 0||o.removeEventListener("mousedown",this.onMousedown),(r=this.outerLine)===null||r===void 0||r.removeEventListener("touchstart",this.onMousedown),(u=this.outerLineContainer)===null||u===void 0||u.remove(),document.removeEventListener("keydown",this.onKeydown)}},{key:"handleMouseDown",value:function(o){var r;if(o.button===0||o.type!=="mousedown"){(r=this.layer)!==null&&r!==void 0&&r.tool&&o.stopPropagation();var u=o.target.getAttribute("data-id"),s=getClickPoint(o),w=s.pageX,m=s.pageY;this.startState={operator:u,clickX:w,clickY:m},document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchend",this.onMouseup),this.handleClick()}}},{key:"handleDelete",value:function(o){var r;(r=this.layer)!==null&&r!==void 0&&r.tool&&o&&o.stopPropagation(),this.delete();var u={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(u.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",u),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var o,r;this.handleOutside(),(o=this.annotationContainer)===null||o===void 0||o.remove(),this.annotation.isDelete=!0,(r=this.layer)===null||r===void 0||r.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:function(o){var r;if(o.button===0||o.type!=="mouseup"){(r=this.layer)!==null&&r!==void 0&&r.tool&&o.stopPropagation(),o.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchend",this.onMouseup);var u=getClickPoint(o),s=u.pageX,w=u.pageY;if(s!==this.startState.clickX||w!==this.startState.clickY){var m=this.annotation,v=this.getInitialPoint(),g=v.start,d=v.end,f={left:g.x,top:g.y,right:d.x,bottom:d.y};this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{operate:"mod-annot",name:m.name,pageIndex:this.PageNumber-1,pagePtr:m.pagePtr,annotPtr:m.annotPtr,rect:f}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}}}},{key:"handleKeyDown",value:function(o){var r=o.keyCode||o.which;r!==8&&r!==46||this.handleDelete(o)}}])}(),Shape=function(e){function n(o){var r,u=o.annotation,s=o.documentViewer,w=o.show,m=w!==void 0&&w,v=o.enableReply,g=v===void 0||v;return _classCallCheck(this,n),(r=_callSuper(this,n,[{annotation:u,documentViewer:s}])).type="custom",r.enableReply=g,r.hidden=!0,r.initial=!1,r.start=null,r.end=null,r.newStart=null,r.newEnd=null,r.startCircle=null,r.endCircle=null,r.show=m,r.handleClick=r.handleClick.bind(r),r.onDelete=r.handleDelete.bind(r),r.render(),r}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:function(){var o=this.annotation,r=this.getActualRect(this.documentViewer.scale),u=r.start,s=r.end;this.start=u,this.end=s;var w=this.calculate(u,s);o.borderColor||(o.borderColor="#000000");var m=document.createElement("div");m.id=o.name,m.className="annotation",m.style.top=w.top+"px",m.style.left=w.left+"px",m.style.width=w.width+"px",m.style.height=w.height+"px",o.borderColor&&o.borderWidth&&(m.style.border="".concat(o.borderWidth,"px solid ").concat(o.borderColor)),o.fillColor&&(m.style.backgroundColor=this.getBackgroundColor(o.fillColor,o.fillTransparency)),"opacity"in o&&(m.style.opacity=o.opacity),m.style.pointerEvents="auto",m.addEventListener("click",this.handleClick),this.annotationContainer=m,this.layer.div.append(this.annotationContainer),this.initial=!0,this.show&&(!this.layer.addMode&&this.selectAnnotation(),this.show=!1)}},{key:"setCss",value:function(o,r){if(o&&r)for(var u in r)o.style[u]=r[u]}},{key:"getActualRect",value:function(o){var r=this.annotation.rect,u=r.left,s=r.top,w=r.right,m=r.bottom;return{start:getActualPoint$1({x:u,y:s},o),end:getActualPoint$1({x:w,y:m},o)}}},{key:"rectCalc",value:function(o){var r=o.start,u=o.end;return{top:r.y<u.y?r.y:u.y,left:r.x<u.x?r.x:u.x,width:Math.abs(u.x-r.x),height:Math.abs(u.y-r.y)}}},{key:"calculate",value:function(o,r){var u=this.rectCalc({start:o,end:r}),s=(this.annotation.borderWidth||2)*this.documentViewer.scale;return{top:u.top-s,left:u.left-s,width:u.width+2*s,height:u.height+2*s}}},{key:"getInitialPoint",value:function(){var o=this.layer.viewport.scale;return{start:{x:this.start.x/o,y:this.start.y/o},end:{x:this.end.x/o,y:this.end.y/o}}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"draw",value:function(){this.layer&&this.layer.div.append(this.annotationContainer)}},{key:"getBackgroundColor",value:function(o){var r,u,s,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(o.startsWith("#")){var m=o.slice(1);if(m.length===3)r=parseInt(m[0]+m[0],16),u=parseInt(m[1]+m[1],16),s=parseInt(m[2]+m[2],16);else{if(m.length!==6)throw new Error("Invalid Hex color format");r=parseInt(m.substring(0,2),16),u=parseInt(m.substring(2,4),16),s=parseInt(m.substring(4,6),16)}}else{if(!o.startsWith("rgb("))return console.warn("Unsupported color format, falling back to black"),"rgba(0, 0, 0, ".concat(w,")");var v=o.replace("rgb(","").replace(")","").split(",").map(function(d){return parseInt(d.trim(),10)});if(v.length!==3)throw new Error("Invalid RGB color format");var g=_slicedToArray(v,3);r=g[0],u=g[1],s=g[2]}return"rgba(".concat(r,", ").concat(u,", ").concat(s,", ").concat(w,")")}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(o){var r=this.annotation;r.borderWidth&&(this.annotationContainer.style.border="".concat(r.borderWidth,"px solid ").concat(o)),r.borderColor=o,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(o){var r=this.annotation;r.borderColor&&(this.annotationContainer.style.border="".concat(o,"px solid ").concat(r.borderColor)),r.borderWidth=o,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(o){this.annotationContainer.style.backgroundColor=this.getBackgroundColor(o,this.annotation.fillTransparency),this.annotation.fillColor=o,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"fillTransparency",get:function(){return this.annotation.fillTransparency},set:function(o){this.annotationContainer.style.backgroundColor=this.getBackgroundColor(this.annotation.fillColor,o),this.annotation.fillTransparency=o,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(o){this.annotationContainer.style.opacity=o,this.annotation.opacity=o,this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null);else{if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var o=this.annotation;this.documentViewer.annotationStore.selectedElementName=o.name,this.setCss(this.annotationContainer,this.annotation.selectedStyle);var r=_objectSpread2$1({},o);delete r.operate,delete r.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",r)}this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleClick",value:function(o){if(this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.documentViewer.activeTool)&&!document.querySelector(".compare-document-container").contains(o==null?void 0:o.target)){this.hidden=!1,this.updateTool();var r=[this.annotationContainer],u=document.querySelector(".toggle-button");u&&r.push(u),onClickOutside$1(r,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var o;this.hidden=!0,this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null,this.documentViewer.eventBus.dispatch("annotationDeselected",this)),this.annotationContainer.remove(),this.annotationContainer=null,this.render(),(o=this.layer)===null||o===void 0||o.div.append(this.annotationContainer),this.documentViewer.getScrollViewElement().style.touchAction="auto"}},{key:"handleDelete",value:function(o){this.layer&&this.layer.tool&&o&&o.stopPropagation(),this.delete();var r={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.layer.page}};this.layer.eventBus.dispatch("annotationChange",r)}},{key:"delete",value:function(){var o,r;this.handleOutside(),(o=this.annotationContainer)===null||o===void 0||o.remove(),this.annotation.isDelete=!0,(r=this.layer)===null||r===void 0||r.deleteAnnotationInLayer({name:this.annotation.name})}}])}(),Polygon=function(e){function n(g){var d,f=g.annotation,y=g.documentViewer,x=g.show,k=x!==void 0&&x,P=g.enableReply,S=P===void 0||P,E=g.creating,M=E!==void 0&&E;return _classCallCheck(this,n),(d=_callSuper(this,n,[{annotation:f,documentViewer:y}])).type="polygon",d.show=k,d.enableReply=S,d.creating=M,d.hidden=!0,d.initial=!1,d.start=null,d.end=null,d.rect=null,d.realVertices=null,d.svgElement=null,d.ratio=window.devicePixelRatio||1,d.decimalPlaces=0,d.showPerimeter=d.documentViewer.annotationStore.polygon.showPerimeter,d.showArea=d.documentViewer.annotationStore.polygon.showArea,d.isPopupShow=!1,d.selectionOutlineBdWidth=1,d.onClick=d.handleClick.bind(d),d.onMousedown=d.handleMouseDown.bind(d),d.onMouseup=d.handleMouseUp.bind(d),d.onMousemove=d.handleMouseMove.bind(d),d.onDelete=d.handleDelete.bind(d),d.onOpenReply=d.openReply.bind(d),d.handlePropertyPanel=d.handlePropertyPanel.bind(d),d.onHandlePopup=d.handlePopup.bind(d),d.onKeydown=d.handleKeyDown.bind(d),d.render(),d}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f,y,x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(d=this.annotation,f=this.documentViewer.scale,this.updateRect(),y=d.rect,this.realVertices=this.annotation.vertices.map(function(E){return getActualPoint$1(E,f)}),d.showPerimeter!==void 0&&(this.showPerimeter=d.showPerimeter,delete d.showPerimeter),d.showArea!==void 0&&(this.showArea=d.showArea,delete d.showArea),!d.contents&&d.measure&&this.getResult(),d.precision&&(d.precision>1&&(d.precision=Math.pow(10,-Math.floor(Math.log10(d.precision)))),this.decimalPlaces=((x=Math.abs(d.precision).toString().split(".")[1])===null||x===void 0?void 0:x.length)||0,d.area=this.formatValue(d.area),d.perimeter=this.formatValue(d.perimeter)),d.borderColor||(d.borderColor=d.color||"#FF0000"),d.factor||!d.measure){S.next=14;break}return S.next=13,this.documentViewer.messageHandler.sendWithPromise("GetFactor",d.rulerPtr);case 13:d.factor=S.sent;case 14:d.fontStyle||(d.fontStyle="regular"),d.intensity=d.intensity||1,d.borderWidth=d.borderWidth||1,k=y.right-y.left,P=y.bottom-y.top,this.annotationContainer=createElement("div",{top:"calc(var(--scale-factor) * ".concat(y.top,"px)"),left:"calc(var(--scale-factor) * ".concat(y.left,"px)"),width:"calc(var(--scale-factor) * ".concat(k,"px)"),height:"calc(var(--scale-factor) * ".concat(P,"px)")},{id:d.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"".concat(y.left," ").concat(y.top," ").concat(k," ").concat(P)},{width:k+"px",height:P+"px",pointerEvents:"all",overflow:"visible",transform:"scale(var(--scale-factor))","transform-origin":"left top"}),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.onClick),this.renderAnnot(),this.outerLineContainer=createElement("div",{top:"calc(var(--scale-factor) * ".concat(y.top,"px)"),left:"calc(var(--scale-factor) * ".concat(y.left,"px)")},{class:"outline-container"}),this.outerLine=createSvg("svg",{"data-id":"move",viewBox:"".concat(y.left," ").concat(y.top," ").concat(k," ").concat(P)},{position:"absolute",zIndex:1,width:"".concat(k,"px"),height:"".concat(P,"px"),border:"".concat(this.selectionOutlineBdWidth,"px ").concat(d.measure?"dashed":"solid"," #1460F3"),pointerEvents:"all",cursor:"all-scroll",overflow:"visible",transform:"scale(var(--scale-factor))","transform-origin":"left top"}),this.outerLineContainer.append(this.outerLine),d.measure||(this.popupElement=createElement("div",{left:"calc(var(--scale-factor) * ".concat(k,"px - 114px)"),top:"calc(var(--scale-factor) * ".concat(k,"px + 12px)")},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr,this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement)),this.updateCircle(),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 32:case"end":return S.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){this.annotation.rect;var g,d,f=this.getWidth();this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((g=this.layer)===null||g===void 0||g.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:"calc(var(--scale-factor) * ".concat(f,"px - 114px)")})):((d=this.layer)===null||d===void 0||d.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:"calc(var(--scale-factor) * ".concat(f,"px - 46px)")}))}},{key:"handleClick",value:function(g){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.layer.tool)&&!document.querySelector(".compare-document-container").contains(g==null?void 0:g.target)){this.hidden=!1,this.updateTool(),this.annotation.measure?(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel),document.addEventListener("keydown",this.onKeydown);var d=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.popupElement&&d.push(this.popupElement);var f=document.getElementById(this.annotation.measure?"measurePropertyPanelButton":"annotationPropertyPanelButton");f&&d.push(f);var y=document.querySelector(".toggle-button");y&&d.push(y),onClickOutside$1(d,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var g,d,f,y,x=this.documentViewer.annotationStore.selectedElementName,k=this.annotation.name;!this.hidden&&this.annotation.measure&&x===k&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(y=this.documentViewer)===null||y===void 0||(y=y.pdfViewer)===null||y===void 0||(y=y.measurementTool)===null||y===void 0||y.updateMeasurePanel(),this.hidePopup()),x===k&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(g=this.outerLine)===null||g===void 0||g.removeEventListener("mousedown",this.onMousedown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("touchstart",this.onMousedown),(f=this.outerLineContainer)===null||f===void 0||f.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure?(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"getActualRect",value:function(g){var d=this.annotation.rect,f=d.left,y=d.top,x=d.right,k=d.bottom;return{start:getActualPoint$1({x:f,y},g),end:getActualPoint$1({x,y:k},g)}}},{key:"getInitialPoint",value:function(){var g=this.documentViewer.scale;return{start:{x:this.start.x/g,y:this.start.y/g},end:{x:this.end.x/g,y:this.end.y/g}}}},{key:"calculate",value:function(g,d){var f=this.rectCalc({start:g,end:d}),y=(this.annotation.borderWidth||2)*this.documentViewer.scale;return{top:f.top-y,left:f.left-y,width:f.width+2*y,height:f.height+2*y}}},{key:"rectCalc",value:function(g){var d=g.start,f=g.end;return{top:d.y<f.y?d.y:f.y,left:d.x<f.x?d.x:f.x,width:Math.abs(f.x-d.x),height:Math.abs(f.y-d.y)}}},{key:"rectCalcByVertices",value:function(g){var d=g.map(function(y){return y.x}),f=g.map(function(y){return y.y});return{left:Math.min.apply(Math,_toConsumableArray$1(d)),top:Math.min.apply(Math,_toConsumableArray$1(f)),right:Math.max.apply(Math,_toConsumableArray$1(d)),bottom:Math.max.apply(Math,_toConsumableArray$1(f))}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var g;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var d=this.annotation;this.documentViewer.annotationStore.selectedElementName=d.name;var f=_objectSpread2$1({},d);delete f.annotPtr,delete f.pagePtr,delete f.operate,delete f.targetPage,delete f.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",f)}(g=this.layer)===null||g===void 0||g.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,area:this.annotation.area||0,perimeter:this.annotation.perimeter,showPerimeter:this.showPerimeter,showArea:this.showArea}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleMouseDown",value:function(g){var d;if(g.button===0||g.type!=="mousedown"){(d=this.layer)!==null&&d!==void 0&&d.tool&&g.stopPropagation();var f=g.target.getAttribute("data-id"),y=this.documentViewer.getScrollViewElement();this.scrollTop=y.scrollTop,this.scrollLeft=y.scrollLeft;var x=getClickPoint(g),k=x.pageX,P=x.pageY;this.startState={operator:f,clickX:k,clickY:P},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(g){if(g.button===0||g.type!=="mousemove"){this.hidePopup(),g.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var d=getClickPoint(g),f=d.pageX,y=d.pageY,x=this.documentViewer,k=x.getScrollViewElement(),P=k.scrollTop;f=f+k.scrollLeft-this.scrollLeft,y=y+P-this.scrollTop;var S=2*this.selectionOutlineBdWidth,E=this.start,M=this.end,T=this.startState,D=x.scale,N=x.getPageWidth(this.PageNumber)*D,I=x.getPageHeight(this.PageNumber)*D,O=/^point(\d+)$/.exec(T.operator);if(O){var F=+O[1],q=this.realVertices[F],Y=f-(T.clickX-q.x),_e=y-(T.clickY-q.y);Y=Math.min(N-S,Y),Y=Math.max(S,Y),_e=Math.min(I-S,_e),_e=Math.max(S,_e),this.setPathPoint(F,Y,_e),this.update(F)}else if(T.operator==="move"){var ne,ve,J,fe,Z=this.documentViewer,j=this.getMouseLocation(g),X=Z.getSelectedPage(j,j),H=this.PageNumber;if(X.first&&X.first!==H){var U,te=Z.windowToPage(j,X.first,!1),Q=Math.abs(E.x-M.x),re=Math.abs(E.y-M.y);if(Z.pdfViewer.spreadMode===0&&Z.pdfViewer.scrollMode===0)ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y;else if(Z.pdfViewer.spreadMode===0&&Z.pdfViewer.scrollMode===1)ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y);else if(Z.pdfViewer.spreadMode===1&&Z.pdfViewer.scrollMode===0){var Pe=Math.min(X.first,H),be=Math.max(X.first,H);if(be-Pe>2||Pe+1===be&&Pe%2==0)return;Pe+1===be?(ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y)):Pe+2===be&&(ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y)}else if(Z.pdfViewer.spreadMode===2&&Z.pdfViewer.scrollMode===0){var we=Math.min(X.first,H),Ae=Math.max(X.first,H);if(Ae-we>2||we+1===Ae&&(we!==1||Ae!==2)&&Ae%2==0||we===1&&Ae===3)return;we+2===Ae||we===1&&Ae===2?(ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y):we+1===Ae&&(ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y))}if(!Z.pdfViewer._pages[X.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=X.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var $e=(U=this.layer)===null||U===void 0?void 0:U.div;$e==null||$e.append(this.annotationContainer),$e==null||$e.append(this.outerLineContainer)}else{ne=f-(T.clickX-this.start.x),ve=y-(T.clickY-this.start.y),J=f-(T.clickX-this.end.x),fe=y-(T.clickY-this.end.y);var Me=Z.pageToWindow({x:ne,y:ve},H,!1),Ie=Z.pageToWindow({x:J,y:fe},H,!1),Le=0,le=0;y>T.clickY?le=(le=k.offsetHeight-(Ie.y-k.scrollTop-k.offsetTop))<100?5:0:y<T.clickY&&(le=(le=Me.y-k.scrollTop-k.offsetTop)<100?-5:0),f>T.clickX?Le=(Le=k.offsetWidth-(Ie.x-k.scrollLeft-k.offsetLeft))<100?5:0:f<T.clickX&&(Le=(Le=Me.x-k.scrollLeft-k.offsetLeft)<100?-5:0),(Le||le)&&(k.scrollTop+=le,k.scrollLeft+=Le);var oe=(this.annotation.borderWidth||2)*this.documentViewer.scale;ne<J?(ne=Math.max(S,ne),ne=Math.min(N-this.rect.width+oe,ne),J=Math.max(this.rect.width,J),J=Math.min(N,J)):(J=Math.max(S,J),J=Math.min(N-this.rect.width+oe,J),ne=Math.max(this.rect.width,ne),ne=Math.min(N,ne)),ve<fe?(ve=Math.max(S,ve),ve=Math.min(I-this.rect.height+oe,ve),fe=Math.max(this.rect.height,fe),fe=Math.min(I,fe)):(fe=Math.max(S,fe),fe=Math.min(I-this.rect.height+oe,fe),ve=Math.max(this.rect.height,ve),ve=Math.min(I,ve))}for(var ke=ne-E.x,Ce=ve-E.y,Ee=0;Ee<this.realVertices.length;Ee++){var Be=this.realVertices[Ee],Ve=Be.x+ke,Oe=Be.y+Ce;this.setPathPoint(Ee,Ve,Oe)}this.update()}T.clickX=f,T.clickY=y}}},{key:"handleDelete",value:function(g){var d;(d=this.layer)!==null&&d!==void 0&&d.tool&&g&&g.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var g,d;this.handleOutside(),(g=this.annotationContainer)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,this.annotation.name&&((d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(d.button===0||d.type!=="mouseup"){M.next=2;break}return M.abrupt("return");case 2:if((f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation(),d.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,(y=this.annotation).measure&&this.documentViewer.annotationStore.selectedElementName===y.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){M.next=42;break}if(x={type:"delete",annotation:{operate:"del-annot",name:y.name,pageIndex:y.pageIndex,annotPtr:y.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},y)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-annot",k.pageIndex=this.PageNumber-1,!this.annotation.measure){M.next=30;break}return M.next=27,this.documentViewer.annotationManager.createMeasurementAnnotation(k);case 27:P=M.sent,M.next=33;break;case 30:return M.next=32,this.documentViewer.annotationManager.createAnnotation(k);case 32:P=M.sent;case 33:return S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),M.next=37,this.documentViewer.annotationManager.addAnnotation(S);case 37:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),M.next=50;break;case 42:if(E={operate:"mod-annot",name:y.name,pageIndex:this.PageNumber-1,pagePtr:y.pagePtr,annotPtr:y.annotPtr,rect:y.rect,vertices:y.vertices},!y.measure){M.next=48;break}return M.next=46,this.documentViewer.annotationManager.editMeasurementAnnotation(E);case 46:M.next=49;break;case 48:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:E});case 49:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 50:case"end":return M.stop()}},g,this)})),function(g){return m.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"draw",value:function(){this.layer&&(this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer),this.update())}},{key:"update",value:function(g){var d,f=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.updateRect();var y=this.annotation.rect,x=y.right-y.left,k=y.bottom-y.top,P=this.documentViewer.scale;if(this.annotationContainer.style.top="calc(var(--scale-factor) * ".concat(y.top,"px)"),this.annotationContainer.style.left="calc(var(--scale-factor) * ".concat(y.left,"px)"),this.annotationContainer.style.width="calc(var(--scale-factor) * ".concat(x,"px)"),this.annotationContainer.style.height="calc(var(--scale-factor) * ".concat(k,"px)"),this.svgElement.setAttribute("width",x),this.svgElement.setAttribute("height",k),this.svgElement.setAttribute("viewBox","".concat(y.left," ").concat(y.top," ").concat(x," ").concat(k)),this.setCss(this.svgElement,{width:x+"px",height:k+"px"}),this.realVertices=this.annotation.vertices.map(function(N){return getActualPoint$1(N,P)}),this.borderStyle==="cloudy"){var S,E=drawPathWithArcs({Intensity:this.annotation.intensity,ur:0},this.annotation.vertices);(S=this.shapeEle)===null||S===void 0||S.setAttribute("d",E)}else{var M,T=this.annotation.vertices.map(function(N){return"".concat(N.x,",").concat(N.y)}).join(" ");(M=this.shapeEle)===null||M===void 0||M.setAttribute("points",T)}if((d=this.shapeEle)===null||d===void 0||d.setAttribute("stroke-width",this.annotation.borderWidth),this.outerLineContainer.style.left="calc(var(--scale-factor) * ".concat(y.left,"px)"),this.outerLineContainer.style.top="calc(var(--scale-factor) * ".concat(y.top,"px)"),this.outerLine.setAttribute("height",k),this.outerLine.setAttribute("viewBox","".concat(y.left," ").concat(y.top," ").concat(x," ").concat(k)),this.outerLine.style.width="".concat(x,"px"),this.outerLine.style.height="".concat(k,"px"),this.popupElement&&(this.popupElement.style.left="calc(var(--scale-factor) * ".concat(x,"px - 114px)")),this.popupElement&&(this.popupElement.style.top="calc(var(--scale-factor) * ".concat(k,"px + 12px)")),this.updateCircle(g!=null?g:null),this.annotation.measure){var D={x:y.left+x/2+this.annotation.borderWidth,y:y.top+k/2+this.annotation.borderWidth};this.getResult(),this.permiterTspan&&(this.permiterTspan.setAttribute("x",D.x),this.permiterTspan.setAttribute("y",D.y),this.permiterTspan.textContent=this.annotation.perimeter.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit),this.areaTspan&&(this.areaTspan.setAttribute("x",D.x),this.areaTspan.setAttribute("y",D.y),this.areaTspan.textContent=this.annotation.area.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit+"\xB2"),f&&this.updateMeasure()}}},{key:"updateMeasure",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.startState||this.startState.operator==="move"){f.next=5;break}return d={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:this.annotation.rect,vertices:this.annotation.vertices},this.annotation.contents&&(d.contents=this.annotation.contents,d.labelPosition=this.annotation.labelPosition),f.next=5,this.documentViewer.annotationManager.editMeasurementAnnotation(d);case 5:if(!this.startState||this.startState.operator!=="move"){f.next=7;break}return f.abrupt("return");case 7:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,area:this.annotation.area||0,perimeter:this.annotation.perimeter});case 8:case"end":return f.stop()}},g,this)})),function(){return w.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(g){var d=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"polygon",operate:"mod-annot",name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr},g)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(g){if(g!==this.contents){var d=this.annotation;d.measure&&(this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:midpoint.x,y:midpoint.y,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=g),d.contents=g,this.setAnnotationChanged({contents:g})}}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(g){var d;this.annotation.opacity=g,this.shapeEle.setAttribute("stroke-opacity",g),(d=this.textEle)===null||d===void 0||d.setAttribute("fill-opacity",g),this.setAnnotationChanged({opacity:g})}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(g){this.shapeEle.setAttribute("fill",g||"none"),this.annotation.fillColor=g,this.setAnnotationChanged({fillColor:g})}},{key:"fillTransparency",get:function(){return this.annotation.fillTransparency},set:function(g){this.shapeEle.setAttribute("fill-opacity",g),this.annotation.fillTransparency=g,this.setAnnotationChanged({fillTransparency:g})}},{key:"color",get:function(){return this.annotation.color},set:function(g){var d,f=this.annotation;(d=this.textEle)===null||d===void 0||d.setAttribute("fill",g),f.color=g,this.setAnnotationChanged({color:g,fontSize:f.fontSize,fontName:f.fontName,fontStyle:f.fontStyle,fontWeight:f.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(g){var d=this.annotation;this.textEle&&(this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(g,"px)")),d.fontSize=g,this.setAnnotationChanged({color:d.color,fontSize:g,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(g){var d=this.annotation;this.textEle&&(this.textEle.style.fontFamily=g),d.fontName=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:g,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(g){var d=this.annotation;this.textEle&&(this.textEle.style.fontStyle=g),d.fontStyle=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:g,fontWeight:d.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(g){var d=this.annotation;this.textEle&&(this.textEle.style.fontWeight=g),d.fontWeight=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:g})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(g){var d=this.annotation;g==="solid"?this.shapeEle.setAttribute("stroke-dasharray",""):g==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),d.borderStyle=g,this.setAnnotationChanged({borderWidth:d.borderWidth,borderStyle:g,dashes:d.dashes,intensity:d.intensity})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(g){var d=this.annotation;d.dashes=g,this.shapeEle.setAttribute("stroke-dasharray",this.borderStyle==="dashed"?this.getDashString():""),this.setAnnotationChanged({borderWidth:d.borderWidth,borderStyle:d.borderStyle,dashes:g})}},{key:"intensity",get:function(){return this.annotation.intensity},set:function(g){var d=this.annotation;d.intensity=g,this.setAnnotationChanged({borderStyle:d.borderStyle,intensity:g})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(g){this.annotation.borderWidth=g,this.shapeEle.setAttribute("stroke-width",g),this.update({start:this.start,end:this.end},!1),this.setAnnotationChanged({borderWidth:g})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(g){this.shapeEle.setAttribute("stroke",g),this.annotation.borderColor=g,this.setAnnotationChanged({borderColor:g})}},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P=this;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.annotation,this.documentViewer.annotationStore.selectedElementName===f.name){S.next=3;break}return S.abrupt("return");case 3:y=0,S.t0=_regeneratorRuntime().keys(d);case 5:if((S.t1=S.t0()).done){S.next=13;break}return x=S.t1.value,S.t2=y,S.next=10,this.setCustomData(x,d[x],!0);case 10:y=S.t2+=S.sent,S.next=5;break;case 13:if(y>0&&this.sendData(d),y!==0||!["showPerimeter","showArea"].some(function(E){return E in d})){S.next=22;break}return this.getResult(),k=[],this.permiterTspan&&k.push(this.permiterTspan),this.areaTspan&&k.push(this.areaTspan),k.forEach(function(E,M){E.setAttribute("dy",M+"em"),P.textEle.appendChild(E)}),S.next=22,this.documentViewer.annotationManager.editMeasurementAnnotation({annotPtr:f.annotPtr,contents:f.contents});case 22:["scale","precision","showPerimeter","showArea"].some(function(E){return E in d})&&this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,area:this.annotation.area||0,perimeter:this.annotation.perimeter,showPerimeter:this.showPerimeter,showArea:this.showArea});case 23:case"end":return S.stop()}},g,this)})),function(g){return s.apply(this,arguments)})},{key:"setCustomData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function g(d,f){var y,x,k,P,S,E,M,T,D,N,I,O,F=arguments;return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(y=F.length>2&&F[2]!==void 0&&F[2],x=this.annotation,k=0,P={x:this.rect.left+this.rect.width/2+this.annotation.borderWidth,y:this.rect.top+this.rect.height/2+this.annotation.borderWidth},d!=="showPerimeter"){q.next=8;break}return this.showPerimeter=f,!f&&this.permiterTspan?(this.permiterTspan.remove(),this.permiterTspan=null):f&&(this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:P.x,y:P.y})),this.permiterTspan.textContent=x.perimeter.toFixed(this.decimalPlaces)+x.scale.translateUnit),q.abrupt("return",0);case 8:if(d!=="showArea"){q.next=12;break}return this.showArea=f,!f&&this.areaTspan?(this.areaTspan.remove(),this.areaTspan=null):f&&(this.areaTspan||(this.areaTspan=createSvg("tspan",{x:P.x,y:P.y})),this.areaTspan.textContent=x.area.toFixed(this.decimalPlaces)+x.scale.translateUnit+"\xB2"),q.abrupt("return",0);case 12:d!=="dashes"||x.dashes||(x.dashes=""),q.t0=_regeneratorRuntime().keys(x);case 14:if((q.t1=q.t0()).done){q.next=48;break}if((S=q.t1.value)!==d||x[S]===f){q.next=46;break}if(x[S]=f,k=1,d==="fillColor"&&this.shapeEle.setAttribute("fill",f||"none"),d==="fillTransparency"&&this.shapeEle.setAttribute("fill-opacity",f),d==="borderColor"&&(this.shapeEle.setAttribute("stroke",f),!x.measure&&(x.color=f)),d==="opacity"&&(this.shapeEle.setAttribute("stroke-opacity",f),(E=this.textEle)===null||E===void 0||E.setAttribute("fill-opacity",f)),d==="borderWidth"&&(this.shapeEle.setAttribute("stroke-width",f),this.update({start:this.start,end:this.end},!1),x.measure&&this.showPopup()),d==="borderStyle"&&(M=x.borderWidth,f==="cloudy"?(T=drawPathWithArcs({Intensity:x.intensity,ur:0},this.annotation.vertices),this.shapeEle.remove(),this.shapeEle=createSvg("path",{d:T,stroke:x.borderColor,"stroke-width":M,"stroke-opacity":x.opacity||1,"stroke-linejoin":"round",fill:x.fillColor?x.fillColor:"none","fill-opacity":x.fillTransparency||1}),this.svgElement.append(this.shapeEle)):(D=this.annotation.vertices.map(function(Y){return"".concat(Y.x,",").concat(Y.y)}).join(" "),this.shapeEle.tagName==="path"?(this.shapeEle.remove(),this.shapeEle=createSvg("polygon",{points:D,stroke:x.borderColor,"stroke-dasharray":this.getDashString(),"stroke-width":M,"stroke-opacity":x.opacity||1,fill:x.fillColor?x.fillColor:"none","fill-opacity":x.fillTransparency||1}),this.svgElement.append(this.shapeEle)):(f==="solid"&&this.shapeEle.setAttribute("stroke-dasharray",""),f==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString())))),d==="dashes"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),d==="intensity"&&x.borderStyle==="cloudy"&&(N=drawPathWithArcs({Intensity:f,ur:0},this.annotation.vertices),this.shapeEle.setAttribute("d",N)),d==="color"&&this.textEle.setAttribute("fill",f),d==="fontSize"&&(this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(f,"px)")),d==="fontName"&&(this.textEle.style.fontFamily=f),d==="fontStyle"&&(this.textEle.style.fontStyle=f),d==="fontWeight"&&(this.textEle.style.fontWeight=f),d==="contents"&&x.measure&&(this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:P.x,y:P.y,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=f),d!=="scale"&&d!=="precision"){q.next=46;break}return d==="precision"&&(this.decimalPlaces=((I=Math.abs(x.precision).toString().split(".")[1])===null||I===void 0?void 0:I.length)||0),q.next=37,this.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1({rulerPtr:x.rulerPtr},d,f));case 37:return q.next=39,this.documentViewer.messageHandler.sendWithPromise("GetFactor",x.rulerPtr);case 39:return O=q.sent,x.factor=O,this.getResult(),this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),q.next=45,this.documentViewer.annotationManager.editMeasurementAnnotation({annotPtr:x.annotPtr,contents:x.contents});case 45:k=0;case 46:q.next=14;break;case 48:return!y&&this.sendData(_defineProperty$1({},d,f)),q.abrupt("return",k);case 50:case"end":return q.stop()}},g,this)})),function(g,d){return u.apply(this,arguments)})},{key:"sendData",value:function(g){var d=this.annotation;if(!d.measure){var f={operate:"mod-annot",name:d.name,pageIndex:d.pageIndex,pagePtr:d.pagePtr,annotPtr:d.annotPtr};g.dashes&&(f.borderStyle=d.borderStyle,f.borderWidth=d.borderWidth),g.borderStyle&&(f.dashes=g.borderStyle==="solid"?"":d.dashes,f.borderWidth=d.borderWidth),g.borderColor&&(f.color=d.color);var y=Object.assign({},f,g);return this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:y}),void this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}var x={pagePtr:d.pagePtr,annotPtr:d.annotPtr,rulerPtr:d.rulerPtr,pageIndex:d.pageIndex,contents:d.contents};["fontSize","fontName","color","fontStyle","fontWeight"].some(function(P){return g[P]})&&(x.fontSize=d.fontSize,x.color=d.color,x.fontName=d.fontName,x.fontStyle=d.fontStyle,x.fontWeight=d.fontWeight),g.dashes&&(x.borderStyle=d.borderStyle,x.borderWidth=d.borderWidth),g.borderStyle&&(x.dashes=g.borderStyle==="solid"?"":d.dashes,x.borderWidth=d.borderWidth);var k=Object.assign({},x,g);this.documentViewer.annotationManager.editMeasurementAnnotation(k),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getResult",value:function(){var g=this.annotation,d=g.vertices,f=g.factor,y=g.scale.translateUnit,x=d.length,k=[],P=0;if(x>=3){P=d[0].y*(d[x-1].x-d[1].x);for(var S=1;S<x;++S)P+=d[S].y*(d[S-1].x-d[(S+1)%x].x)}var E=this.formatValue(Math.abs(P/2)*f*f),M=0;if(x>=2){for(var T=0;T<x-1;T++){var D=d[T],N=d[T+1];M+=Math.sqrt(Math.pow(N.x-D.x,2)+Math.pow(N.y-D.y,2))}var I=d[0],O=d[x-1];M+=Math.sqrt(Math.pow(I.x-O.x,2)+Math.pow(I.y-O.y,2))}var F=this.formatValue(M*f);this.annotation.perimeter=F,this.annotation.area=E,this.showPerimeter&&k.push(this.annotation.perimeter.toFixed(this.decimalPlaces)+y),this.showArea&&k.push(this.annotation.area.toFixed(this.decimalPlaces)+y+"\xB2"),this.annotation.contents=k.join(`
`)}},{key:"showPopup",value:function(){if(this.layer){var g=this.layer.div.getBoundingClientRect(),d=g.left+this.rect.left,f=this.rect.top+g.top,y={left:d,top:f,right:d+this.rect.width,bottom:f+this.rect.height};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:y}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y=this;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d==="delete"&&this.handleDelete(),d==="reply"&&(this.openReply(),(f=document.getElementById("leftPanel"))!=null&&f.classList.contains("closed")&&setTimeout(function(){y.showPopup()},350));case 2:case"end":return x.stop()}},g,this)})),function(g){return r.apply(this,arguments)})},{key:"formatValue",value:function(g){return g%1==0?g:Number(g.toFixed(this.decimalPlaces))}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"){y.next=2;break}return y.abrupt("return");case 2:(f=d.keyCode||d.which)!==8&&f!==46||this.handleDelete();case 4:case"end":return y.stop()}},g,this)})),function(g){return o.apply(this,arguments)})},{key:"updateRect",value:function(){this.annotation.rect=this.rectCalcByVertices(this.annotation.vertices);var g=this.getActualRect(this.documentViewer.scale),d=g.start,f=g.end;this.start=d,this.end=f,this.rect=this.calculate(d,f)}},{key:"renderAnnot",value:function(){var g=this,d=this.annotation;this.documentViewer.scale;var f=d.borderWidth||2,y=this.getDashString();this.svgElement.innerHTML="";var x=d.vertices;if(this.creating){if(this.borderStyle==="cloudy"){var k=createSvg("path",{d:drawPathWithArcs({Intensity:d.intensity,ur:20},x),stroke:d.borderColor,"stroke-dasharray":y,"stroke-width":f,"stroke-linejoin":"round","stroke-opacity":d.opacity||1,fill:"none"});this.svgElement.innerHTML="",this.svgElement.append(k)}else for(var P=0;P<x.length-1;P++){var S=x[P],E=x[P+1],M=createSvg("line",{"data-id":"line"+P,stroke:d.borderColor,"stroke-width":f,"stroke-dasharray":y,"stroke-opacity":d.opacity||1,x1:S.x,y1:S.y,x2:E.x,y2:E.y});this.svgElement.append(M)}this.dashLineEle=createSvg("line",{stroke:d.borderColor,"stroke-width":f,"stroke-dasharray":y||"8","stroke-opacity":d.opacity||1,x1:x[0].x,y1:x[0].y,x2:x[x.length-1].x,y2:x[x.length-1].y}),this.svgElement.append(this.dashLineEle)}else{if(this.borderStyle==="cloudy"){var T=drawPathWithArcs({Intensity:d.intensity,ur:0},x);this.shapeEle=createSvg("path",{d:T,stroke:d.borderColor,"stroke-dasharray":y,"stroke-width":f,"stroke-opacity":d.opacity||1,"stroke-linejoin":"round",fill:d.fillColor?d.fillColor:"none","fill-opacity":d.fillTransparency||1})}else{var D=x.map(function(O){return"".concat(O.x,",").concat(O.y)}).join(" ");this.shapeEle=createSvg("polygon",{points:D,stroke:d.borderColor,"stroke-dasharray":y,"stroke-width":f,"stroke-opacity":d.opacity||1,fill:d.fillColor?d.fillColor:"none","fill-opacity":d.fillTransparency||1})}this.svgElement.append(this.shapeEle)}if(d.measure){var N={x:this.rect.left+this.rect.width/2+this.annotation.borderWidth,y:this.rect.top+this.rect.height/2+this.annotation.borderWidth};this.textEle=createSvg("text",{fill:d.color||d.borderColor,"fill-opacity":d.opacity||1,"text-anchor":"middle","dominant-baseline":"middle"},{"font-size":"calc(var(--scale-factor) * ".concat(d.fontSize,"px)")}),this.svgElement.append(this.textEle);var I=[];this.showPerimeter&&(this.permiterTspan=createSvg("tspan",{x:N.x,y:N.y}),this.permiterTspan.textContent=d.perimeter.toFixed(this.decimalPlaces)+d.scale.translateUnit,I.push(this.permiterTspan)),this.showArea&&(this.areaTspan=createSvg("tspan",{x:N.x,y:N.y}),this.areaTspan.textContent=d.area.toFixed(this.decimalPlaces)+d.scale.translateUnit+"\xB2",I.push(this.areaTspan)),I.forEach(function(O,F){O.setAttribute("dy",F+"em"),g.textEle.appendChild(O)})}}},{key:"updateCircle",value:function(g){var d=this.annotation.vertices;if(Number.isFinite(g)&&g<d.length&&g>=0){var f=d[g],y=f.x,x=f.y,k=this.outerLine.querySelector('circle[data-id="point'+g+'"]');return k==null||k.setAttribute("cx",y),void(k==null||k.setAttribute("cy",x))}this.outerLineContainer.querySelectorAll("circle").forEach(function(D){return D.remove()});var P=[],S={};d.forEach(function(D){var N="".concat(D.x,"-").concat(D.y);S[N]||(S[N]=!0,P.push(D))});for(var E=0;E<P.length;E++){var M=P[E],T=createSvg("circle",{"data-id":"point"+E,fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:M.x,cy:M.y,r:6},{cursor:"default"});this.outerLine.append(T)}}},{key:"addPathPoint",value:function(g,d){var f=this.annotation,y=getInitialPoint$1({x:g,y:d},this.documentViewer.scale);f.vertices.push(y);var x=f.vertices,k=_slicedToArray(x.slice(-2),2),P=k[0],S=P.x,E=P.y,M=k[1],T=M.x,D=M.y;if([S,E,T,D].every(Number.isFinite))if(S===T&&E===D&&(T+=1,D+=1),this.borderStyle==="cloudy"){var N=createSvg("path",{d:drawPathWithArcs({Intensity:f.intensity,ur:20},x),stroke:f.borderColor,"stroke-width":f.borderWidth,"stroke-opacity":f.opacity||1,"stroke-linejoin":"round","stroke-dasharray":this.getDashString(),fill:"none"});this.svgElement.innerHTML="",this.svgElement.append(N)}else{var I=createSvg("line",{"data-id":"line"+(x.length-2),stroke:f.borderColor,"stroke-width":f.borderWidth,"stroke-opacity":f.opacity||1,"stroke-dasharray":this.getDashString(),x1:S,y1:E,x2:T,y2:D},{"stroke-linecap":"round"});this.svgElement.append(I)}}},{key:"setPathPoint",value:function(g,d,f){var y=this.annotation,x=y.vertices;if(!(g>x.length-1||g<0)){var k=getInitialPoint$1({x:d,y:f},this.documentViewer.scale);if(x[g].x=k.x,x[g].y=k.y,this.creating)g===0?this.updateLineElement(g):g===x.length-1?this.updateLineElement(g-1):(this.updateLineElement(g-1),this.updateLineElement(g));else if(this.borderStyle==="cloudy"){var P=drawPathWithArcs({Intensity:y.intensity,ur:0},x);this.shapeEle.setAttribute("d",P)}else{var S=x.map(function(E){return"".concat(E.x,",").concat(E.y)}).join(" ");this.shapeEle.setAttribute("points",S)}}}},{key:"getPathPoint",value:function(g){var d=this.annotation;return{x:d.vertices[g].x,y:d.vertices[g].y}}},{key:"updateLineElement",value:function(g){var d=this.annotation,f=d.vertices,y=f[g],x=y.x,k=y.y,P=f[g+1],S=P.x,E=P.y;if([x,k,S,E].every(Number.isFinite)&&(x!==S||k!==E)){if(this.borderStyle==="cloudy"){var M=createSvg("path",{d:drawPathWithArcs({Intensity:d.intensity,ur:20},f),stroke:d.borderColor,"stroke-width":d.borderWidth,"stroke-opacity":d.opacity||1,"stroke-linejoin":"round","stroke-dasharray":this.getDashString(),fill:"none"});return this.svgElement.innerHTML="",void this.svgElement.append(M)}var T=this.svgElement.querySelector('line[data-id="line'+g+'"]');T.setAttribute("x1",x),T.setAttribute("y1",k),T.setAttribute("x2",S),T.setAttribute("y2",E);var D=f[0],N=f[f.length-1];this.dashLineEle.setAttribute("x1",D.x),this.dashLineEle.setAttribute("y1",D.y),this.dashLineEle.setAttribute("x2",N.x),this.dashLineEle.setAttribute("y2",N.y)}}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var g=this.annotation.dashes||"2,2",d=this.documentViewer.scale;return g.split(",").map(function(f){return Math.ceil(f*d)}).join(", ")}}]);var o,r,u,s,w,m,v}(),Polyline=function(e){function n(g){var d,f=g.annotation,y=g.documentViewer,x=g.show,k=x!==void 0&&x,P=g.enableReply,S=P===void 0||P;return _classCallCheck(this,n),(d=_callSuper(this,n,[{annotation:f,documentViewer:y}])).type="polyline",d.show=k,d.enableReply=S,d.hidden=!0,d.initial=!1,d.start=null,d.end=null,d.rect=null,d.realVertices=null,d.svgElement=null,d.ratio=window.devicePixelRatio||1,d.decimalPlaces=0,d.isPopupShow=!1,d.selectionOutlineBdWidth=1,d.onClick=d.handleClick.bind(d),d.onMousedown=d.handleMouseDown.bind(d),d.onMouseup=d.handleMouseUp.bind(d),d.onMousemove=d.handleMouseMove.bind(d),d.onDelete=d.handleDelete.bind(d),d.onOpenReply=d.openReply.bind(d),d.handlePropertyPanel=d.handlePropertyPanel.bind(d),d.onHandlePopup=d.handlePopup.bind(d),d.onKeydown=d.handleKeyDown.bind(d),d.render(),d}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(d=this.annotation,f=this.documentViewer.scale,this.updateRect(),y=this.rect,this.realVertices=this.annotation.vertices.map(function(P){return getActualPoint$1(P,f)}),d.precision&&(d.precision>1&&(d.precision=Math.pow(10,-Math.floor(Math.log10(d.precision)))),this.decimalPlaces=((x=Math.abs(d.precision).toString().split(".")[1])===null||x===void 0?void 0:x.length)||0),d.borderColor||(d.borderColor=d.color||"#FF0000"),d.factor||!d.measure){k.next=11;break}return k.next=10,this.documentViewer.messageHandler.sendWithPromise("GetFactor",d.rulerPtr);case 10:d.factor=k.sent;case 11:d.fontStyle||(d.fontStyle="regular"),d.perimeter&&(d.perimeter=this.formatValue(d.perimeter)),!d.contents&&d.measure&&this.getResult(),this.annotationContainer=createElement("div",{top:y.top+"px",left:y.left+"px",width:y.width+"px",height:y.height+"px"},{id:d.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"".concat(y.left," ").concat(y.top," ").concat(y.width," ").concat(y.height)},{pointerEvents:"all",overflow:"visible",opacity:d.opacity?d.opacity:""}),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.onClick),this.renderAnnot(),this.outerLineContainer=createElement("div",{},{class:"outline-container"}),this.outerLine=createSvg("svg",{"data-id":"move",width:y.width,height:y.height,viewBox:"".concat(y.left," ").concat(y.top," ").concat(y.width," ").concat(y.height)},{position:"absolute",zIndex:1,left:"".concat(y.left,"px"),top:"".concat(y.top,"px"),width:"".concat(y.width,"px"),height:"".concat(y.height,"px"),border:"".concat(this.selectionOutlineBdWidth,"px ").concat(d.measure?"dashed":"solid"," #1460F3"),pointerEvents:"all",cursor:"all-scroll",overflow:"visible","box-sizing":"content-box"}),this.outerLineContainer.append(this.outerLine),d.measure||(this.popupElement=createElement("div",{left:y.left+y.width-114+"px",top:y.top+y.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr,this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.documentViewer.isAnnotationPopup&&this.outerLineContainer.append(this.popupElement)),this.updateCircle(),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 27:case"end":return k.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var g,d,f=this.rect;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((g=this.layer)===null||g===void 0||g.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:f.left+f.width-114+"px"})):((d=this.layer)===null||d===void 0||d.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:f.left+f.width-46+"px"}))}},{key:"handleClick",value:function(g){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.layer.tool)&&!document.querySelector(".compare-document-container").contains(g==null?void 0:g.target)){this.hidden=!1,this.updateTool(),this.annotation.measure?(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel),document.addEventListener("keydown",this.onKeydown);var d=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.popupElement&&d.push(this.popupElement);var f=document.getElementById(this.annotation.measure?"measurePropertyPanelButton":"annotationPropertyPanelButton");f&&d.push(f);var y=document.querySelector(".toggle-button");y&&d.push(y),onClickOutside$1(d,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var g,d,f,y,x=this.documentViewer.annotationStore.selectedElementName,k=this.annotation.name;!this.hidden&&this.annotation.measure&&x===k&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(y=this.documentViewer)===null||y===void 0||(y=y.pdfViewer)===null||y===void 0||(y=y.measurementTool)===null||y===void 0||y.updateMeasurePanel(),this.hidePopup()),x===k&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(g=this.outerLine)===null||g===void 0||g.removeEventListener("mousedown",this.onMousedown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("touchstart",this.onMousedown),(f=this.outerLineContainer)===null||f===void 0||f.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure?(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"getActualRect",value:function(g){var d=this.annotation.rect,f=d.left,y=d.top,x=d.right,k=d.bottom;return{start:getActualPoint$1({x:f,y},g),end:getActualPoint$1({x,y:k},g)}}},{key:"getInitialPoint",value:function(){var g=this.documentViewer.scale;return{start:{x:this.start.x/g,y:this.start.y/g},end:{x:this.end.x/g,y:this.end.y/g}}}},{key:"calculate",value:function(g,d){var f=this.rectCalc({start:g,end:d}),y=(this.annotation.borderWidth||2)*this.documentViewer.scale;return{top:f.top-y,left:f.left-y,width:f.width+2*y,height:f.height+2*y}}},{key:"rectCalc",value:function(g){var d=g.start,f=g.end;return{top:d.y<f.y?d.y:f.y,left:d.x<f.x?d.x:f.x,width:Math.abs(f.x-d.x),height:Math.abs(f.y-d.y)}}},{key:"rectCalcByVertices",value:function(g){var d=g.map(function(y){return y.x}),f=g.map(function(y){return y.y});return{left:Math.min.apply(Math,_toConsumableArray$1(d)),top:Math.min.apply(Math,_toConsumableArray$1(f)),right:Math.max.apply(Math,_toConsumableArray$1(d)),bottom:Math.max.apply(Math,_toConsumableArray$1(f))}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var g;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var d=this.annotation;this.documentViewer.annotationStore.selectedElementName=d.name;var f=_objectSpread2$1({},d);delete f.annotPtr,delete f.pagePtr,delete f.operate,delete f.targetPage,delete f.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",f)}(g=this.layer)===null||g===void 0||g.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleMouseDown",value:function(g){var d;if(g.button===0||g.type!=="mousedown"){(d=this.layer)!==null&&d!==void 0&&d.tool&&g.stopPropagation();var f=g.target.getAttribute("data-id"),y=this.documentViewer.getScrollViewElement();this.scrollTop=y.scrollTop,this.scrollLeft=y.scrollLeft;var x=getClickPoint(g),k=x.pageX,P=x.pageY;this.startState={operator:f,clickX:k,clickY:P},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(g){if(g.button===0||g.type!=="mousemove"){this.hidePopup(),g.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var d=getClickPoint(g),f=d.pageX,y=d.pageY,x=this.documentViewer,k=x.getScrollViewElement(),P=k.scrollTop;f=f+k.scrollLeft-this.scrollLeft,y=y+P-this.scrollTop;var S=2*this.selectionOutlineBdWidth,E=this.start,M=this.end,T=this.startState,D=this.documentViewer.scale,N=x.getPageWidth(this.PageNumber)*D,I=x.getPageHeight(this.PageNumber)*D,O=/^point(\d+)$/.exec(T.operator);if(O){var F=+O[1],q=this.realVertices[F],Y=f-(T.clickX-q.x),_e=y-(T.clickY-q.y);Y=Math.min(N-S,Y),Y=Math.max(S,Y),_e=Math.min(I-S,_e),_e=Math.max(S,_e),this.setPathPoint(F,Y,_e),this.update(F)}else if(T.operator==="move"){var ne,ve,J,fe,Z=this.documentViewer,j=this.getMouseLocation(g),X=Z.getSelectedPage(j,j),H=this.PageNumber;if(X.first&&X.first!==H){var U,te=Z.windowToPage(j,X.first,!1),Q=Math.abs(E.x-M.x),re=Math.abs(E.y-M.y);if(Z.pdfViewer.spreadMode===0&&Z.pdfViewer.scrollMode===0)ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y;else if(Z.pdfViewer.spreadMode===0&&Z.pdfViewer.scrollMode===1)ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y);else if(Z.pdfViewer.spreadMode===1&&Z.pdfViewer.scrollMode===0){var Pe=Math.min(X.first,H),be=Math.max(X.first,H);if(be-Pe>2||Pe+1===be&&Pe%2==0)return;Pe+1===be?(ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y)):Pe+2===be&&(ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y)}else if(Z.pdfViewer.spreadMode===2&&Z.pdfViewer.scrollMode===0){var we=Math.min(X.first,H),Ae=Math.max(X.first,H);if(Ae-we>2||we+1===Ae&&(we!==1||Ae!==2)&&Ae%2==0||we===1&&Ae===3)return;we+2===Ae||we===1&&Ae===2?(ne=f-(T.clickX-this.start.x),ve=X.first>H?te.y:te.y-re,J=f-(T.clickX-this.end.x),fe=X.first>H?te.y+re:te.y):we+1===Ae&&(ne=X.first>H?te.x:te.x-Q,ve=y-(T.clickY-this.start.y),J=X.first>H?te.x+Q:te.x,fe=y-(T.clickY-this.end.y))}if(!Z.pdfViewer._pages[X.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=X.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var $e=(U=this.layer)===null||U===void 0?void 0:U.div;$e==null||$e.append(this.annotationContainer),$e==null||$e.append(this.outerLineContainer)}else{ne=f-(T.clickX-this.start.x),ve=y-(T.clickY-this.start.y),J=f-(T.clickX-this.end.x),fe=y-(T.clickY-this.end.y);var Me=Z.pageToWindow({x:ne,y:ve},H,!1),Ie=Z.pageToWindow({x:J,y:fe},H,!1),Le=0,le=0;y>T.clickY?le=(le=k.offsetHeight-(Ie.y-k.scrollTop-k.offsetTop))<100?5:0:y<T.clickY&&(le=(le=Me.y-k.scrollTop-k.offsetTop)<100?-5:0),f>T.clickX?Le=(Le=k.offsetWidth-(Ie.x-k.scrollLeft-k.offsetLeft))<100?5:0:f<T.clickX&&(Le=(Le=Me.x-k.scrollLeft-k.offsetLeft)<100?-5:0),(Le||le)&&(k.scrollTop+=le,k.scrollLeft+=Le);var oe=(this.annotation.borderWidth||2)*D;ne<J?(ne=Math.max(S,ne),ne=Math.min(N-this.rect.width+oe,ne),J=Math.max(this.rect.width,J),J=Math.min(N,J)):(J=Math.max(S,J),J=Math.min(N-this.rect.width+oe,J),ne=Math.max(this.rect.width,ne),ne=Math.min(N,ne)),ve<fe?(ve=Math.max(S,ve),ve=Math.min(I-this.rect.height+oe,ve),fe=Math.max(this.rect.height,fe),fe=Math.min(I,fe)):(fe=Math.max(S,fe),fe=Math.min(I-this.rect.height+oe,fe),ve=Math.max(this.rect.height,ve),ve=Math.min(I,ve))}for(var ke=ne-E.x,Ce=ve-E.y,Ee=0;Ee<this.realVertices.length;Ee++){var Be=this.realVertices[Ee],Ve=Be.x+ke,Oe=Be.y+Ce;this.setPathPoint(Ee,Ve,Oe)}this.update()}T.clickX=f,T.clickY=y}}},{key:"handleDelete",value:function(g){var d;(d=this.layer)!==null&&d!==void 0&&d.tool&&g&&g.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var g,d;this.handleOutside(),(g=this.annotationContainer)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,this.annotation.name&&((d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(d.button===0||d.type!=="mouseup"){M.next=2;break}return M.abrupt("return");case 2:if((f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation(),d.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,(y=this.annotation).measure&&this.documentViewer.annotationStore.selectedElementName===y.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){M.next=42;break}if(x={type:"delete",annotation:{operate:"del-annot",name:y.name,pageIndex:y.pageIndex,annotPtr:y.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},y)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-annot",k.pageIndex=this.PageNumber-1,!this.annotation.measure){M.next=30;break}return M.next=27,this.documentViewer.annotationManager.createMeasurementAnnotation(k);case 27:P=M.sent,M.next=33;break;case 30:return M.next=32,this.documentViewer.annotationManager.createAnnotation(k);case 32:P=M.sent;case 33:return S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),M.next=37,this.documentViewer.annotationManager.addAnnotation(S);case 37:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),M.next=50;break;case 42:if(E={operate:"mod-annot",name:y.name,pageIndex:this.PageNumber-1,pagePtr:y.pagePtr,annotPtr:y.annotPtr,rect:y.rect,vertices:y.vertices},!y.measure){M.next=48;break}return M.next=46,this.documentViewer.annotationManager.editMeasurementAnnotation(E);case 46:M.next=49;break;case 48:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:E});case 49:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 50:case"end":return M.stop()}},g,this)})),function(g){return m.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"draw",value:function(){this.layer&&(this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer),this.update())}},{key:"update",value:function(g){var d=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.updateRect();var f=this.rect,y=this.documentViewer.scale;this.annotationContainer.style.top=f.top+"px",this.annotationContainer.style.left=f.left+"px",this.annotationContainer.style.width=f.width+"px",this.annotationContainer.style.height=f.height+"px",this.svgElement.setAttribute("width",f.width),this.svgElement.setAttribute("height",f.height),this.svgElement.setAttribute("viewBox","".concat(f.left," ").concat(f.top," ").concat(f.width," ").concat(f.height)),this.realVertices=this.annotation.vertices.map(function(x){return getActualPoint$1(x,y)}),this.renderAnnot(),this.outerLine.setAttribute("height",f.height),this.outerLine.setAttribute("viewBox","".concat(f.left," ").concat(f.top," ").concat(f.width," ").concat(f.height)),this.outerLine.style.left="".concat(f.left,"px"),this.outerLine.style.top="".concat(f.top,"px"),this.outerLine.style.width="".concat(f.width,"px"),this.outerLine.style.height="".concat(f.height,"px"),this.popupElement&&(this.popupElement.style.left=f.left+f.width-114+"px"),this.popupElement&&(this.popupElement.style.top=f.top+f.height+12+"px"),this.updateCircle(g!=null?g:null),this.annotation.measure&&d&&this.updateMeasure()}},{key:"updateMeasure",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function g(){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.startState&&this.startState.operator!=="move"&&this.getResult(),!this.startState||this.startState.operator!=="move"){d.next=3;break}return d.abrupt("return");case 3:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter});case 4:case"end":return d.stop()}},g,this)})),function(){return w.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(g){var d=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"polyline",operate:"mod-annot",name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr},g)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(g){if(g!==this.contents){var d=this.annotation;d.measure&&(this.totalTextEle.textContent=g),d.contents=g,this.setAnnotationChanged({contents:g})}}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(g){this.annotation.opacity=g,this.svgElement.style.opacity=g,this.setAnnotationChanged({opacity:g})}},{key:"color",get:function(){return this.annotation.color},set:function(g){var d=this.annotation;this.svgElement.querySelectorAll("text").forEach(function(f){f.setAttribute("fill",g)}),d.color=g,this.setAnnotationChanged({color:g,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(g){var d=this.annotation;this.svgElement.querySelectorAll("text").forEach(function(f){f.style.fontSize="calc(var(--scale-factor) * ".concat(g,"px)")}),d.fontSize=g,this.setAnnotationChanged({color:d.color,fontSize:g,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(g){var d=this.annotation;this.svgElement.querySelectorAll("text").forEach(function(f){f.style.fontFamily=g}),d.fontName=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:g,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(g){var d=this.annotation;this.svgElement.querySelectorAll("text").forEach(function(f){f.style.fontStyle=g}),d.fontStyle=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:g,fontWeight:d.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(g){var d=this.annotation;this.svgElement.querySelectorAll("text").forEach(function(f){f.style.fontWeight=g}),d.fontWeight=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:g})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(g){var d=this,f=this.annotation;f.measure?this.svgElement.querySelectorAll("line").forEach(function(y){g==="solid"&&y.setAttribute("stroke-dasharray",""),g==="dashed"&&y.setAttribute("stroke-dasharray",d.getDashString())}):(g==="solid"&&this.polylineEle.setAttribute("stroke-dasharray",""),g==="dashed"&&this.polylineEle.setAttribute("stroke-dasharray",this.getDashString())),this.annotation.borderStyle=g,this.setAnnotationChanged({borderWidth:f.borderWidth,borderStyle:g,dashes:f.dashes})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(g){var d=this,f=this.annotation;f.dashes=g,f.measure?this.svgElement.querySelectorAll("line").forEach(function(y){return y.setAttribute("stroke-dasharray",d.getDashString())}):this.polylineEle.setAttribute("stroke-dasharray",this.getDashString()),this.setAnnotationChanged({borderWidth:f.borderWidth,borderStyle:f.borderStyle,dashes:g})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(g){this.annotation.borderWidth=g,this.renderAnnot(),this.setAnnotationChanged({borderWidth:g})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(g){var d=this.annotation;d.measure?this.svgElement.querySelectorAll("line").forEach(function(f){return f.setAttribute("stroke",g)}):this.polylineEle.setAttribute("stroke",g),d.borderColor=g,this.setAnnotationChanged({borderColor:g})}},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(f=this.annotation,this.documentViewer.annotationStore.selectedElementName===f.name){k.next=3;break}return k.abrupt("return");case 3:y=0,k.t0=_regeneratorRuntime().keys(d);case 5:if((k.t1=k.t0()).done){k.next=13;break}return x=k.t1.value,k.t2=y,k.next=10,this.setCustomData(x,d[x],!0);case 10:y=k.t2+=k.sent,k.next=5;break;case 13:y>0&&this.sendData(d);case 14:case"end":return k.stop()}},g,this)})),function(g){return s.apply(this,arguments)})},{key:"setCustomData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function g(d,f){var y,x,k,P,S,E,M=this,T=arguments;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:y=T.length>2&&T[2]!==void 0&&T[2],x=this.annotation,k=0,D.t0=_regeneratorRuntime().keys(x);case 4:if((D.t1=D.t0()).done){D.next=35;break}if((P=D.t1.value)!==d||x[P]===f){D.next=33;break}if(x[P]=f,k=1,d==="opacity"&&(this.svgElement.style.opacity=f),d==="borderColor"&&(x.measure?this.svgElement.querySelectorAll("line").forEach(function(N){return N.setAttribute("stroke",f)}):(this.polylineEle.setAttribute("stroke",f),x.color=f)),d==="borderWidth"&&this.renderAnnot(),d==="borderStyle"&&(x.measure?this.svgElement.querySelectorAll("line").forEach(function(N){f==="solid"&&N.setAttribute("stroke-dasharray",""),f==="dashed"&&N.setAttribute("stroke-dasharray",M.getDashString())}):(f==="solid"&&this.polylineEle.setAttribute("stroke-dasharray",""),f==="dashed"&&this.polylineEle.setAttribute("stroke-dasharray",this.getDashString()))),d==="dashes"&&(x.measure?this.svgElement.querySelectorAll("line").forEach(function(N){return N.setAttribute("stroke-dasharray",M.getDashString())}):this.polylineEle.setAttribute("stroke-dasharray",this.getDashString())),d==="color"&&this.svgElement.querySelectorAll("text").forEach(function(N){return N.setAttribute("fill",f)}),d==="fontSize"&&this.svgElement.querySelectorAll("text").forEach(function(N){return N.style.fontSize="calc(var(--scale-factor) * ".concat(f,"px)")}),d==="fontName"&&this.svgElement.querySelectorAll("text").forEach(function(N){return N.style.fontFamily=f}),d==="fontStyle"&&this.svgElement.querySelectorAll("text").forEach(function(N){N.style.fontStyle=f}),d==="fontWeight"&&this.svgElement.querySelectorAll("text").forEach(function(N){N.style.fontWeight=f}),d==="contents"&&x.measure&&(this.totalTextEle.textContent=f),d!=="scale"&&d!=="precision"){D.next=33;break}return d==="precision"&&(this.decimalPlaces=((S=Math.abs(x.precision).toString().split(".")[1])===null||S===void 0?void 0:S.length)||0),this.getResult(),D.next=25,this.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1(_defineProperty$1(_defineProperty$1({rulerPtr:x.rulerPtr},d,f),"annotPtr",x.annotPtr),"contents",x.contents));case 25:return D.next=27,this.documentViewer.messageHandler.sendWithPromise("GetFactor",x.rulerPtr);case 27:E=D.sent,x.factor=E,this.renderAnnot(),this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:f,length:x.perimeter}),k=0;case 33:D.next=4;break;case 35:return!y&&this.sendData(_defineProperty$1({},d,f)),D.abrupt("return",k);case 37:case"end":return D.stop()}},g,this)})),function(g,d){return u.apply(this,arguments)})},{key:"sendData",value:function(g){var d=this.annotation;if(d.measure){var f={pagePtr:d.pagePtr,annotPtr:d.annotPtr,rulerPtr:d.rulerPtr,pageIndex:d.pageIndex,contents:d.contents};["fontSize","fontName","color","fontStyle","fontWeight"].some(function(P){return g[P]})&&(f.fontSize=d.fontSize,f.color=d.color,f.fontName=d.fontName,f.fontStyle=d.fontStyle,f.fontWeight=d.fontWeight),g.dashes&&(f.borderStyle=d.borderStyle,f.borderWidth=d.borderWidth),g.borderStyle&&(f.dashes=g.borderStyle==="solid"?"":d.dashes,f.borderWidth=d.borderWidth);var y=Object.assign({},f,g);this.documentViewer.annotationManager.editMeasurementAnnotation(y)}else{var x={operate:"mod-annot",name:d.name,pageIndex:d.pageIndex,pagePtr:d.pagePtr,annotPtr:d.annotPtr};g.dashes&&(x.borderStyle=d.borderStyle,x.borderWidth=d.borderWidth),g.borderStyle&&(x.dashes=g.borderStyle==="solid"?"":d.dashes,x.borderWidth=d.borderWidth),g.borderColor&&(x.color=d.color);var k=Object.assign({},x,g);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:k})}}},{key:"getResult",value:function(){for(var g=this.annotation,d=g.vertices,f=g.factor,y=g.scale.translateUnit,x=0,k=0;k<d.length-1;k++){var P=d[k],S=d[k+1];x+=Math.hypot(S.x-P.x,S.y-P.y)*f}x=this.formatValue(x),this.annotation.perimeter=x,this.annotation.contents=x.toFixed(this.decimalPlaces)+y}},{key:"showPopup",value:function(){if(this.layer){var g=this.layer.div.getBoundingClientRect(),d=g.left+this.rect.left,f=this.rect.top+g.top,y={left:d,top:f,right:d+this.rect.width,bottom:f+this.rect.height};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:y}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y=this;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d==="delete"&&this.handleDelete(),d==="reply"&&(this.openReply(),(f=document.getElementById("leftPanel"))!=null&&f.classList.contains("closed")&&setTimeout(function(){y.showPopup()},350));case 2:case"end":return x.stop()}},g,this)})),function(g){return r.apply(this,arguments)})},{key:"formatValue",value:function(g){return g%1==0?g:Number(g.toFixed(this.decimalPlaces))}},{key:"getTextWidth",value:function(g){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=document.createElement("canvas").getContext("2d"),y=this.documentViewer.scale;f.font="".concat(this.annotation.fontSize*y,"px ").concat(this.annotation.fontFamily);var x=f.measureText(g),k=(this.annotation.borderWidth||2)*y,P=1.1*x.width+k;return d>P?P:d}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"){y.next=2;break}return y.abrupt("return");case 2:(f=d.keyCode||d.which)!==8&&f!==46||this.handleDelete();case 4:case"end":return y.stop()}},g,this)})),function(g){return o.apply(this,arguments)})},{key:"updateRect",value:function(){this.annotation.rect=this.rectCalcByVertices(this.annotation.vertices);var g=this.getActualRect(this.documentViewer.scale),d=g.start,f=g.end;this.start=d,this.end=f;var y=this.calculate(d,f);this.rect=y}},{key:"renderAnnot",value:function(){var g=this.annotation,d=this.documentViewer.scale,f=(g.borderWidth||2)*d,y=this.borderStyle==="dashed"?this.getDashString():"";if(this.svgElement.innerHTML="",!g.measure){var x=this.realVertices.map(function(Z){return"".concat(Z.x,",").concat(Z.y)}).join(" ");return this.polylineEle=createSvg("polyline",{fill:"none",stroke:g.borderColor,"stroke-width":f,"stroke-dasharray":y,points:x}),void this.svgElement.append(this.polylineEle)}this.totalTextEle=null;for(var k=0;k<this.realVertices.length-1;k++){var P=this.realVertices[k],S=this.realVertices[k+1],E={x:(P.x+S.x)/2,y:(P.y+S.y)/2},M=Math.atan2(S.y-P.y,S.x-P.x)/Math.PI*180,T=Math.abs(M)>90?M-180:M,D=S.x-P.x,N=S.y-P.y,I=Math.sqrt(D*D+N*N),O=I&&D/I||0,F=I&&N/I||0,q=D/d,Y=N/d,_e=this.formatValue(Math.sqrt(q*q+Y*Y)*g.factor).toFixed(this.decimalPlaces)+g.scale.translateUnit,ne=this.getTextWidth(_e,I),ve=createSvg("line",{"data-id":"startLine"+k,stroke:g.borderColor,"stroke-width":f,"stroke-dasharray":y,x1:P.x,y1:P.y,x2:P.x+O*(I/2-ne/2),y2:P.y+F*(I/2-ne/2)}),J=createSvg("line",{"data-id":"endLine"+k,stroke:g.borderColor,"stroke-width":f,"stroke-dasharray":y,x1:P.x+O*(I/2+ne/2),y1:P.y+F*(I/2+ne/2),x2:S.x,y2:S.y}),fe=createSvg("text",{"data-id":"text"+k,fill:g.color||g.borderColor,"text-anchor":"middle","dominant-baseline":"middle",x:E.x,y:E.y,transform:"rotate(".concat(T," ").concat(E.x," ").concat(E.y,")")},{"font-size":"calc(var(--scale-factor) * ".concat(g.fontSize,"px)"),pointerEvents:"none"});fe.textContent=_e,this.svgElement.append(ve),this.svgElement.append(J),this.svgElement.append(fe),k===this.realVertices.length-2&&(this.totalTextEle=createSvg("text",{fill:g.color||g.borderColor,"text-anchor":"middle","dominant-baseline":"middle",x:E.x,y:E.y+g.fontSize*d,transform:"rotate(".concat(T," ").concat(E.x," ").concat(E.y,")")},{"font-size":"calc(var(--scale-factor) * ".concat(g.fontSize,"px)"),pointerEvents:"none"}),this.totalTextEle.textContent=g.contents,this.svgElement.append(this.totalTextEle))}}},{key:"updateCircle",value:function(g){if(Number.isFinite(g)&&g<this.realVertices.length&&g>=0){var d=this.realVertices[g],f=d.x,y=d.y,x=this.outerLine.querySelector('circle[data-id="point'+g+'"]');return x==null||x.setAttribute("cx",f),void(x==null||x.setAttribute("cy",y))}this.outerLineContainer.querySelectorAll("circle").forEach(function(E){return E.remove()});for(var k=0;k<this.realVertices.length;k++){var P=this.realVertices[k],S=createSvg("circle",{"data-id":"point"+k,fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:P.x,cy:P.y,r:6},{cursor:"default"});this.outerLine.append(S)}}},{key:"addPathPoint",value:function(g,d){var f=this.annotation,y=this.documentViewer.scale,x=getInitialPoint$1({x:g,y:d},y);f.vertices.push(x),this.realVertices.push({x:g,y:d});var k=_slicedToArray(this.realVertices.slice(-2),2),P=k[0],S=P.x,E=P.y,M=k[1],T=M.x,D=M.y;if([S,E,T,D].every(Number.isFinite))if(f.measure){S===T&&E===D&&(T+=1,D+=1);var N={x:(S+T)/2,y:(E+D)/2},I=Math.atan2(D-E,T-S)/Math.PI*180,O=Math.abs(I)>90?I-180:I,F=T-S,q=D-E,Y=Math.sqrt(F*F+q*q),_e=F/Y,ne=q/Y,ve=F/y,J=q/y,fe=this.formatValue(Math.sqrt(ve*ve+J*J)*f.factor).toFixed(this.decimalPlaces)+f.scale.translateUnit,Z=this.getTextWidth(fe,Y),j=this.getDashString(),X=createSvg("line",{"data-id":"startLine"+(this.realVertices.length-2),stroke:f.borderColor,"stroke-width":2*y,"stroke-dasharray":j,x1:S,y1:E,x2:S+_e*(Y/2-Z/2),y2:E+ne*(Y/2-Z/2)},{"stroke-linecap":"round"}),H=createSvg("line",{"data-id":"endLine"+(this.realVertices.length-2),stroke:f.borderColor,"stroke-width":2*y,"stroke-dasharray":j,x1:S+_e*(Y/2+Z/2),y1:E+ne*(Y/2+Z/2),x2:T,y2:D},{"stroke-linecap":"round"}),U=createSvg("text",{"data-id":"text"+(this.realVertices.length-2),fill:f.color||f.borderColor,"text-anchor":"middle","dominant-baseline":"middle",x:N.x,y:N.y,transform:"rotate(".concat(O," ").concat(N.x," ").concat(N.y,")")},{"font-size":"calc(var(--scale-factor) * ".concat(f.fontSize,"px)")});U.textContent=fe,this.svgElement.append(X),this.svgElement.append(H),this.svgElement.append(U),this.totalTextEle?(this.totalTextEle.setAttribute("x",N.x),this.totalTextEle.setAttribute("y",N.y+f.fontSize*y),this.totalTextEle.setAttribute("transform","rotate(".concat(O," ").concat(N.x," ").concat(N.y,")")),this.getResult(),this.totalTextEle.textContent=f.contents):this.renderAnnot()}else{var te=this.realVertices.map(function(Q){return"".concat(Q.x,",").concat(Q.y)}).join(" ");this.polylineEle.setAttribute("points",te)}}},{key:"setPathPoint",value:function(g,d,f){if(!(g>this.realVertices.length-1||g<0)){var y=this.annotation,x=this.documentViewer.scale,k=getInitialPoint$1({x:d,y:f},x);if(y.vertices[g].x=k.x,y.vertices[g].y=k.y,this.realVertices[g].x=d,this.realVertices[g].y=f,y.measure){g===0?this.updateLineElement(g):g===this.realVertices.length-1?this.updateLineElement(g-1):(this.updateLineElement(g-1),this.updateLineElement(g));var P=_slicedToArray(this.realVertices.slice(-2).map(function(_e){return _e!=null?_e:{x:NaN,y:NaN}}),2),S=P[0],E=S.x,M=S.y,T=P[1],D=T.x,N=T.y;if([E,M,D,N].every(Number.isFinite)&&(E!==D||M!==N))if(this.totalTextEle){var I={x:(E+D)/2,y:(M+N)/2},O=Math.atan2(N-M,D-E)/Math.PI*180,F=Math.abs(O)>90?O-180:O;this.totalTextEle.setAttribute("x",I.x),this.totalTextEle.setAttribute("y",I.y+y.fontSize*x),this.totalTextEle.setAttribute("transform","rotate(".concat(F," ").concat(I.x," ").concat(I.y,")")),this.getResult(),this.totalTextEle.textContent=y.contents;var q=0;this.realVertices.length>=3&&(q=g===0?this.calculateAngle(this.realVertices[g],this.realVertices[g+1],this.realVertices[g+2]):g===this.realVertices.length-1?this.calculateAngle(this.realVertices[g-2],this.realVertices[g-1],this.realVertices[g]):this.calculateAngle(this.realVertices[g-1],this.realVertices[g],this.realVertices[g+1])),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter,angle:q})}else this.renderAnnot()}else{var Y=this.realVertices.map(function(_e){return"".concat(_e.x,",").concat(_e.y)}).join(" ");this.polylineEle.setAttribute("points",Y)}}}},{key:"getPathPoint",value:function(g){var d=this.annotation;return{x:d.vertices[g].x,y:d.vertices[g].y}}},{key:"updateLineElement",value:function(g){var d=this.realVertices[g],f=d.x,y=d.y,x=this.realVertices[g+1],k=x.x,P=x.y;if([f,y,k,P].every(Number.isFinite)&&(f!==k||y!==P)){var S=this.svgElement.querySelector('line[data-id="startLine'+g+'"]'),E=this.svgElement.querySelector('line[data-id="endLine'+g+'"]'),M=this.svgElement.querySelector('text[data-id="text'+g+'"]'),T={x:(f+k)/2,y:(y+P)/2},D=Math.atan2(P-y,k-f)/Math.PI*180,N=Math.abs(D)>90?D-180:D,I=k-f,O=P-y,F=Math.sqrt(I*I+O*O),q=I/F,Y=O/F,_e=I/this.documentViewer.scale,ne=O/this.documentViewer.scale,ve=this.formatValue(Math.sqrt(_e*_e+ne*ne)*this.annotation.factor).toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit,J=this.getTextWidth(ve,F);S.setAttribute("x1",f),S.setAttribute("y1",y),S.setAttribute("x2",f+q*(F/2-J/2)),S.setAttribute("y2",y+Y*(F/2-J/2)),E.setAttribute("x1",f+q*(F/2+J/2)),E.setAttribute("y1",y+Y*(F/2+J/2)),E.setAttribute("x2",k),E.setAttribute("y2",P),M.setAttribute("x",T.x),M.setAttribute("y",T.y),M.setAttribute("transform","rotate(".concat(N," ").concat(T.x," ").concat(T.y,")")),M.textContent=ve}}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var g=this.annotation.dashes||"2,2",d=this.documentViewer.scale;return g.split(",").map(function(f){return Math.ceil(f*d)}).join(", ")}},{key:"calculateAngle",value:function(g,d,f){var y={x:d.x-g.x,y:d.y-g.y},x={x:f.x-d.x,y:f.y-d.y},k=(y.x*x.x+y.y*x.y)/(Math.sqrt(Math.pow(y.x,2)+Math.pow(y.y,2))*Math.sqrt(Math.pow(x.x,2)+Math.pow(x.y,2))),P=Math.max(-1,Math.min(1,k)),S=Math.acos(P)*(180/Math.PI);return Math.round(Math.abs(180-S))}}]);var o,r,u,s,w,m,v}(),Circle=function(e){function n(g){var d,f=g.annotation,y=g.documentViewer,x=g.show,k=x!==void 0&&x,P=g.enableReply,S=P===void 0||P;return _classCallCheck(this,n),(d=_callSuper(this,n,[{annotation:f,documentViewer:y}])).type="circle",d.show=k,d.enableReply=S,d.hidden=!0,d.initial=!1,d.start=null,d.end=null,d.rect=null,d.svgElement=null,d.ratio=window.devicePixelRatio||1,d.decimalPlaces=0,d.isPopupShow=!1,d.showRadius=d.documentViewer.annotationStore.circle.showRadius,d.showPerimeter=d.documentViewer.annotationStore.circle.showPerimeter,d.showArea=d.documentViewer.annotationStore.circle.showArea,d.selectionOutlinePadding=8,d.selectionOutlinePointWidth=6,d.onClick=d.handleClick.bind(d),d.onMousedown=d.handleMouseDown.bind(d),d.onMouseup=d.handleMouseUp.bind(d),d.onMousemove=d.handleMouseMove.bind(d),d.onDelete=d.handleDelete.bind(d),d.onOpenReply=d.openReply.bind(d),d.handlePropertyPanel=d.handlePropertyPanel.bind(d),d.onHandlePopup=d.handlePopup.bind(d),d.onKeydown=d.handleKeyDown.bind(d),d.render(),d}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f,y,x,k,P,S,E=this;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(d=this.annotation).fontStyle&&(d.fontStyle="normal"),!d.fontWeight&&(d.fontWeight="normal"),!d.borderStyle&&(d.borderStyle="solid"),!d.borderColor&&(d.borderColor="#FF0000"),!d.borderWidth&&(d.borderWidth=0),f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end,this.start=y,this.end=x,this.rect=this.calculate(y,x),k=this.rect,["showPerimeter","showArea","showRadius"].forEach(function(T){d[T]!==void 0&&(E[T]=d[T],delete d[T])}),d.precision&&(d.precision>1&&(d.precision=Math.pow(10,-Math.floor(Math.log10(d.precision)))),this.decimalPlaces=((P=Math.abs(d.precision).toString().split(".")[1])===null||P===void 0?void 0:P.length)||0),d.factor){M.next=18;break}return M.next=17,this.documentViewer.messageHandler.sendWithPromise("GetFactor",d.rulerPtr);case 17:d.factor=M.sent;case 18:this.getResult(),this.annotationContainer=createElement("div",{top:k.top+"px",left:k.left+"px",width:k.width+"px",height:k.height+"px"},{id:d.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"0 0 ".concat(k.width," ").concat(k.height)},{pointerEvents:"all",overflow:"visible"}),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.onClick),this.renderAnnot(),this.outerLineContainer=createElement("div",{},{class:"outline-container"}),S=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(k.left-S,"px"),top:"".concat(k.top-S,"px"),width:"".concat(k.width+2*S,"px"),height:"".concat(k.height+2*S,"px"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"stroke-dasharray":"2","fill-opacity":0,width:k.width+this.selectionOutlinePadding,height:k.height+this.selectionOutlinePadding,x:this.selectionOutlinePointWidth/2,y:this.selectionOutlinePointWidth/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:0}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:k.height+this.selectionOutlinePadding}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:k.width+this.selectionOutlinePadding,y:k.height+this.selectionOutlinePadding}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:k.width+this.selectionOutlinePadding,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.topRightRect),this.outerLineContainer.append(this.outerLine),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 41:case"end":return M.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var g,d;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(g=this.layer)===null||g===void 0||g.div.classList.remove("no-edit"):(d=this.layer)===null||d===void 0||d.div.classList.add("no-edit")}},{key:"handleClick",value:function(g){var d;if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes((d=this.layer)===null||d===void 0?void 0:d.tool)&&!document.querySelector(".compare-document-container").contains(g==null?void 0:g.target)){this.hidden=!1,this.updateTool(),this.annotation.measure&&(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)),document.addEventListener("keydown",this.onKeydown);var f=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.deletetButton&&f.push(this.deletetButton),this.replyButton&&f.push(this.replyButton);var y=document.getElementById("measurePropertyPanelButton");y&&f.push(y);var x=document.querySelector(".toggle-button");x&&f.push(x),onClickOutside$1(f,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var g,d,f,y,x=this.documentViewer.annotationStore.selectedElementName,k=this.annotation.name;!this.hidden&&this.annotation.measure&&x===k&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(y=this.documentViewer)===null||y===void 0||(y=y.pdfViewer)===null||y===void 0||(y=y.measurementTool)===null||y===void 0||y.updateMeasurePanel(),this.hidePopup()),x===k&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(g=this.outerLine)===null||g===void 0||g.removeEventListener("mousedown",this.onMousedown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("touchstart",this.onMousedown),(f=this.outerLineContainer)===null||f===void 0||f.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure&&(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup))}},{key:"getActualRect",value:function(g){var d=this.annotation.rect,f=d.left,y=d.top,x=d.right,k=d.bottom;return{start:getActualPoint$1({x:f,y},g),end:getActualPoint$1({x,y:k},g)}}},{key:"getInitialPoint",value:function(){var g=this.documentViewer.scale;return{start:{x:this.start.x/g,y:this.start.y/g},end:{x:this.end.x/g,y:this.end.y/g}}}},{key:"calculate",value:function(g,d){var f=this.rectCalc({start:g,end:d}),y=this.annotation.borderWidth*this.documentViewer.scale;return{top:f.top-y,left:f.left-y,width:f.width+2*y,height:f.height+2*y}}},{key:"rectCalc",value:function(g){var d=g.start,f=g.end;return{top:d.y<f.y?d.y:f.y,left:d.x<f.x?d.x:f.x,width:Math.abs(f.x-d.x),height:Math.abs(f.y-d.y)}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var g;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var d=this.annotation;this.documentViewer.annotationStore.selectedElementName=d.name;var f=_objectSpread2$1({},d);delete f.annotPtr,delete f.pagePtr,delete f.operate,delete f.targetPage,delete f.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",f)}(g=this.layer)===null||g===void 0||g.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,radius:this.annotation.radius,perimeter:this.annotation.perimeter,area:this.annotation.area,showRadius:this.showRadius,showPerimeter:this.showPerimeter,showArea:this.showArea}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleMouseDown",value:function(g){var d;if(g.button===0||g.type!=="mousedown"){(d=this.layer)!==null&&d!==void 0&&d.tool&&g.stopPropagation();var f=g.target.getAttribute("data-id"),y=this.documentViewer.getScrollViewElement();this.scrollTop=y.scrollTop,this.scrollLeft=y.scrollLeft;var x=getClickPoint(g),k=x.pageX,P=x.pageY;this.startState={operator:f,clickX:k,clickY:P},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(g){if(g.button===0||g.type!=="mousemove"){this.hidePopup(),g.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var d=getClickPoint(g),f=d.pageX,y=d.pageY,x=this.documentViewer,k=x.getScrollViewElement(),P=k.scrollTop;f=f+k.scrollLeft-this.scrollLeft,y=y+P-this.scrollTop;var S=this.start,E=this.end,M=this.startState,T=x.scale,D=x.getPageWidth(this.PageNumber)*T,N=x.getPageHeight(this.PageNumber)*T,I=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+this.annotation.borderWidth*this.documentViewer.scale;if(M.operator==="nw-resize"){var O=f-(M.clickX-this.start.x),F=y-(M.clickY-this.start.y);O=Math.min(E.x-5,O),O=Math.max(I,O),F=Math.min(E.y-5,F),F=Math.max(I,F),this.update({start:{x:O,y:F},end:E})}else if(M.operator==="sw-resize"){var q=f-(M.clickX-this.start.x),Y=y-(M.clickY-this.end.y);q=Math.min(E.x-5,q),q=Math.max(I,q),Y=Math.min(N-I,Y),Y=Math.max(S.y+5,Y),this.update({start:{x:q,y:S.y},end:{x:E.x,y:Y}})}else if(M.operator==="se-resize"){var _e=f-(M.clickX-this.end.x),ne=y-(M.clickY-this.end.y);_e=Math.min(D-I,_e),_e=Math.max(S.x+5,_e),ne=Math.min(N-I,ne),ne=Math.max(S.y+5,ne),this.update({start:S,end:{x:_e,y:ne}})}else if(M.operator==="ne-resize"){var ve=f-(M.clickX-this.end.x),J=y-(M.clickY-this.start.y);ve=Math.min(D-I,ve),ve=Math.max(S.x+5,ve),J=Math.min(E.y-I,J),J=Math.max(I,J),this.update({start:{x:S.x,y:J},end:{x:ve,y:E.y}})}else if(M.operator==="move"){var fe,Z,j,X,H=this.documentViewer,U=this.getMouseLocation(g),te=H.getSelectedPage(U,U),Q=this.getPageNumber();if(te.first&&te.first!==Q){var re,Pe=H.windowToPage(U,te.first,!1),be=Math.abs(S.x-E.x),we=Math.abs(S.y-E.y);if(H.pdfViewer.spreadMode===0&&H.pdfViewer.scrollMode===0)fe=f-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=f-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y;else if(H.pdfViewer.spreadMode===0&&H.pdfViewer.scrollMode===1)fe=te.first>Q?Pe.x:Pe.x-be,Z=y-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=y-(M.clickY-this.end.y);else if(H.pdfViewer.spreadMode===1&&H.pdfViewer.scrollMode===0){var Ae=Math.min(te.first,Q),$e=Math.max(te.first,Q);if($e-Ae>2||Ae+1===$e&&Ae%2==0)return;Ae+1===$e?(fe=te.first>Q?Pe.x:Pe.x-be,Z=y-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=y-(M.clickY-this.end.y)):Ae+2===$e&&(fe=f-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=f-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y)}else if(H.pdfViewer.spreadMode===2&&H.pdfViewer.scrollMode===0){var Me=Math.min(te.first,Q),Ie=Math.max(te.first,Q);if(Ie-Me>2||Me+1===Ie&&(Me!==1||Ie!==2)&&Ie%2==0||Me===1&&Ie===3)return;Me+2===Ie||Me===1&&Ie===2?(fe=f-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=f-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y):Me+1===Ie&&(fe=te.first>Q?Pe.x:Pe.x-be,Z=y-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=y-(M.clickY-this.end.y))}if(!H.pdfViewer._pages[te.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=te.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Le=(re=this.layer)===null||re===void 0?void 0:re.div;Le==null||Le.append(this.annotationContainer),Le==null||Le.append(this.outerLineContainer)}else{Z=y-(M.clickY-this.start.y),fe=f-(M.clickX-this.start.x),j=f-(M.clickX-this.end.x),X=y-(M.clickY-this.end.y);var le=H.pageToWindow({x:fe,y:Z},Q,!1),oe=H.pageToWindow({x:j,y:X},Q,!1),ke=0,Ce=0;y>M.clickY?Ce=(Ce=k.offsetHeight-(oe.y-k.scrollTop-k.offsetTop))<100?5:0:y<M.clickY&&(Ce=(Ce=le.y-k.scrollTop-k.offsetTop)<100?-5:0),f>M.clickX?ke=(ke=k.offsetWidth-(oe.x-k.scrollLeft-k.offsetLeft))<100?5:0:f<M.clickX&&(ke=(ke=le.x-k.scrollLeft-k.offsetLeft)<100?-5:0),(ke||Ce)&&(k.scrollTop+=Ce,k.scrollLeft+=ke);var Ee={width:Math.abs(S.x-E.x),height:Math.abs(S.y-E.y)};fe<j?(fe=Math.max(I,fe),fe=Math.min(D-Ee.width-I,fe),j=Math.max(Ee.width+I,j),j=Math.min(D-I,j)):(j=Math.max(I,j),j=Math.min(D-Ee.width-I,j),fe=Math.max(Ee.width+I,fe),fe=Math.min(D-I,fe)),Z<X?(Z=Math.max(I,Z),Z=Math.min(N-Ee.height-I,Z),X=Math.max(Ee.height+I,X),X=Math.min(N-I,X)):(X=Math.max(I,X),X=Math.min(N-Ee.height-I,X),Z=Math.max(Ee.height+I,Z),Z=Math.min(N-I,Z))}this.update({start:{x:fe,y:Z},end:{x:j,y:X}})}M.clickX=f,M.clickY=y}}},{key:"handleDelete",value:function(g){var d;(d=this.layer)!==null&&d!==void 0&&d.tool&&g&&g.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var g,d;this.handleOutside(),(g=this.annotationContainer)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,this.annotation.name&&((d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(d.button===0||d.type!=="mouseup"){M.next=2;break}return M.abrupt("return");case 2:if((f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation(),d.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,(y=this.annotation).measure&&this.documentViewer.annotationStore.selectedElementName===y.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){M.next=36;break}return x={type:"delete",annotation:{operate:"del-annot",name:y.name,pageIndex:y.pageIndex,annotPtr:y.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},y)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-annot",k.pageIndex=this.PageNumber-1,M.next=26,this.documentViewer.annotationManager.createMeasurementAnnotation(k);case 26:return P=M.sent,S=new n({annotation:P,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),M.next=31,this.documentViewer.annotationManager.addAnnotation(S);case 31:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),M.next=40;break;case 36:return E={operate:"mod-annot",name:y.name,pageIndex:this.PageNumber-1,pagePtr:y.pagePtr,annotPtr:y.annotPtr,rect:y.rect},M.next=39,this.documentViewer.annotationManager.editMeasurementAnnotation(E);case 39:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 40:case"end":return M.stop()}},g,this)})),function(g){return m.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var g=this.getActualRect(this.documentViewer.scale),d=g.start,f=g.end;this.update({start:d,end:f})}}},{key:"update",value:function(g){var d=g.start,f=g.end,y=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.start=d,this.end=f;var x=this.getInitialPoint();this.annotation.rect={left:x.start.x,top:x.start.y,right:x.end.x,bottom:x.end.y},this.rect=this.calculate(d,f);var k=this.rect,P=this.annotation.borderWidth*this.documentViewer.scale;this.annotationContainer.style.top=k.top+"px",this.annotationContainer.style.left=k.left+"px",this.annotationContainer.style.width=k.width+"px",this.annotationContainer.style.height=k.height+"px",this.svgElement.setAttribute("width",k.width),this.svgElement.setAttribute("height",k.height),this.svgElement.setAttribute("viewBox","0 0 ".concat(k.width," ").concat(k.height)),this.shapeEle.setAttribute("cx",k.width/2),this.shapeEle.setAttribute("cy",k.height/2),this.shapeEle.setAttribute("rx",(k.width-P)/2),this.shapeEle.setAttribute("ry",(k.height-P)/2),this.shapeEle.setAttribute("stroke-width",P);var S=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2;this.outerLine.setAttribute("width",k.width+2*S),this.outerLine.setAttribute("height",k.height+2*S),this.outerLine.setAttribute("viewBox","0 0 ".concat(k.width+2*S," ").concat(k.height+2*S)),this.outerLine.style.left="".concat(k.left-S,"px"),this.outerLine.style.top="".concat(k.top-S,"px"),this.outerLine.style.width="".concat(k.width+2*S,"px"),this.outerLine.style.height="".concat(k.height+2*S,"px"),this.deletetButton&&(this.deletetButton.style.left=k.left+k.width+MARGIN_DISTANCE-30+"px",this.deletetButton.style.top=k.top-MARGIN_DISTANCE-30+"px"),this.replyButton&&(this.replyButton.style.left=k.left+k.width+MARGIN_DISTANCE-65+"px",this.replyButton.style.top=k.top-MARGIN_DISTANCE-30+"px"),this.moveRect.setAttribute("width",k.width+this.selectionOutlinePadding),this.moveRect.setAttribute("height",k.height+this.selectionOutlinePadding),this.bottomLeftRect.setAttribute("y",k.height+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("x",k.width+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("y",k.height+this.selectionOutlinePadding),this.topRightRect.setAttribute("x",k.width+this.selectionOutlinePadding);var E={x:(k.width-P)/2,y:(k.height-P)/2};this.getResult(),this.radiusTspan&&(this.radiusTspan.setAttribute("x",E.x),this.radiusTspan.setAttribute("y",E.y),this.radiusTspan.textContent=this.annotation.radius.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit),this.permiterTspan&&(this.permiterTspan.setAttribute("x",E.x),this.permiterTspan.setAttribute("y",E.y),this.permiterTspan.textContent=this.annotation.perimeter.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit),this.areaTspan&&(this.areaTspan.setAttribute("x",E.x),this.areaTspan.setAttribute("y",E.y),this.areaTspan.textContent=this.annotation.area.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit+"\xB2"),this.annotation.measure&&y&&this.updateMeasure()}},{key:"updateMeasure",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.startState||this.startState.operator==="move"){f.next=5;break}return d={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.PageNumber,rect:this.annotation.rect},this.annotation.contents&&(d.contents=this.annotation.contents,d.labelPosition=this.annotation.labelPosition),f.next=5,this.documentViewer.annotationManager.editMeasurementAnnotation(d);case 5:if(!this.startState||this.startState.operator!=="move"){f.next=7;break}return f.abrupt("return");case 7:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,radius:this.annotation.radius,perimeter:this.annotation.perimeter,area:this.annotation.area});case 8:case"end":return f.stop()}},g,this)})),function(){return w.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(g){var d=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"circle",operate:"mod-annot",name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr},g)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"setRect",value:function(g){var d=this.documentViewer.scale,f=getActualPoint$1({x:g.x1,y:g.y1},d),y=getActualPoint$1({x:g.x2,y:g.y2},d);this.update({start:f,end:y}),this.start=f,this.end=y;var x=this.getInitialPoint(),k=x.start,P=x.end,S={left:k.x,top:k.y,right:P.x,bottom:P.y};this.annotation.rect=S,this.setAnnotationChanged({rect:S})}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(g){if(g!==this.contents){var d=this.annotation;this.radiusTspan&&(this.radiusTspan.remove(),this.radiusTspan=null),this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:midpoint.x,y:midpoint.y,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=g,d.contents=g,this.setAnnotationChanged({contents:g})}}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(g){this.shapeEle.setAttribute("fill",g||"none"),this.annotation.fillColor=g,this.setAnnotationChanged({fillColor:g})}},{key:"fillTransparency",get:function(){return this.annotation.fillTransparency},set:function(g){this.shapeEle.setAttribute("fill-opacity",g),this.annotation.fillTransparency=g,this.setAnnotationChanged({fillTransparency:g})}},{key:"opacity",get:function(){return this.opacity},set:function(g){this.annotation.opacity=g,this.shapeEle.setAttribute("stroke-opacity",g),this.textEle.setAttribute("fill-opacity",g),this.setAnnotationChanged({opacity:g})}},{key:"color",get:function(){return this.annotation.color},set:function(g){var d=this.annotation;this.textEle.setAttribute("fill",g),d.color=g,this.setAnnotationChanged({color:g,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(g){var d=this.annotation;this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(g,"px)"),d.fontSize=g,this.setAnnotationChanged({color:d.color,fontSize:g,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(g){var d=this.annotation;this.textEle.style.fontFamily=g,d.fontName=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:g,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(g){this.textEle.style.fontStyle=g,annotation.fontStyle=g,this.setAnnotationChanged({color:annotation.color,fontSize:annotation.fontSize,fontName:annotation.fontName,fontStyle:g,fontWeight:annotation.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(g){this.textEle.style.fontWeight=g,annotation.fontWeight=g,this.setAnnotationChanged({color:annotation.color,fontSize:annotation.fontSize,fontName:annotation.fontName,fontStyle:annotation.fontStyle,fontWeight:g})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(g){var d=this.annotation;g==="solid"?this.shapeEle.setAttribute("stroke-dasharray",""):g==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),d.borderStyle=g,this.setAnnotationChanged({borderStyle:g,borderWidth:d.borderWidth,dashes:d.dashes||"2, 2"})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(g){var d=this.annotation;d.dashes=g,this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),this.setAnnotationChanged({borderStyle:d.borderStyle,borderWidth:d.borderWidth,dashes:g})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(g){this.annotation.borderWidth=g,this.shapeEle.setAttribute("stroke-width",g*this.documentViewer.scale),this.update({start:this.start,end:this.end},!1),this.setAnnotationChanged({borderWidth:g})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(g){this.shapeEle.setAttribute("stroke",g),this.annotation.borderColor=g,this.setAnnotationChanged({borderColor:g})}},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P=this;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.annotation,this.documentViewer.annotationStore.selectedElementName===f.name){S.next=3;break}return S.abrupt("return");case 3:y=0,S.t0=_regeneratorRuntime().keys(d);case 5:if((S.t1=S.t0()).done){S.next=13;break}return x=S.t1.value,S.t2=y,S.next=10,this.setCustomData(x,d[x],!0);case 10:y=S.t2+=S.sent,S.next=5;break;case 13:if(y>0&&this.sendData(d),y!==0||!["showRadius","showPerimeter","showArea"].some(function(E){return E in d})){S.next=23;break}return this.getResult(),k=[],this.radiusTspan&&k.push(this.radiusTspan),this.permiterTspan&&k.push(this.permiterTspan),this.areaTspan&&k.push(this.areaTspan),k.forEach(function(E,M){k.length===3?E.setAttribute("dy",M-1+"em"):E.setAttribute("dy",M+"em"),P.textEle.appendChild(E)}),S.next=23,this.documentViewer.annotationManager.editMeasurementAnnotation({annotPtr:f.annotPtr,contents:f.contents});case 23:["scale","precision","showRadius","showPerimeter","showArea"].some(function(E){return E in d})&&this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,radius:this.annotation.radius,perimeter:this.annotation.perimeter,area:this.annotation.area,showRadius:this.showRadius,showPerimeter:this.showPerimeter,showArea:this.showArea});case 24:case"end":return S.stop()}},g,this)})),function(g){return s.apply(this,arguments)})},{key:"setCustomData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function g(d,f){var y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve=arguments;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(y=ve.length>2&&ve[2]!==void 0&&ve[2],x=this.annotation,k=0,P=this.documentViewer,S=x.borderWidth*P.scale,E={x:(this.rect.width-S)/2,y:(this.rect.height-S)/2},d!=="showRadius"){J.next=10;break}return this.showRadius=f,!f&&this.radiusTspan?(this.radiusTspan.remove(),this.radiusTspan=null):f&&(this.radiusTspan||(this.radiusTspan=createSvg("tspan",{x:E.x,y:E.y}),this.textEle.appendChild(this.radiusTspan)),this.radiusTspan.textContent=x.radius.toFixed(this.decimalPlaces)+x.scale.translateUnit),J.abrupt("return",0);case 10:if(d!=="showPerimeter"){J.next=14;break}return this.showPerimeter=f,!f&&this.permiterTspan?(this.permiterTspan.remove(),this.permiterTspan=null):f&&(this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:E.x,y:E.y}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=x.perimeter.toFixed(this.decimalPlaces)+x.scale.translateUnit),J.abrupt("return",0);case 14:if(d!=="showArea"){J.next=18;break}return this.showArea=f,!f&&this.areaTspan?(this.areaTspan.remove(),this.areaTspan=null):f&&(this.areaTspan||(this.areaTspan=createSvg("tspan",{x:E.x,y:E.y}),this.textEle.appendChild(this.areaTspan)),this.areaTspan.textContent=x.area.toFixed(this.decimalPlaces)+x.scale.translateUnit+"\xB2"),J.abrupt("return",0);case 18:if(!(d in x)||x[d]===f){J.next=85;break}x[d]=f,k=1,J.t0=d,J.next=J.t0==="fillColor"?24:J.t0==="fillTransparency"?26:J.t0==="borderColor"?28:J.t0==="opacity"?30:J.t0==="borderWidth"?33:J.t0==="borderStyle"?37:J.t0==="dashes"?40:J.t0==="color"?42:J.t0==="fontSize"?44:J.t0==="fontName"?46:J.t0==="fontStyle"?48:J.t0==="fontWeight"?50:J.t0==="contents"?52:J.t0==="scale"||J.t0==="precision"?57:J.t0==="radius"?73:85;break;case 24:return this.shapeEle.setAttribute("fill",f||"none"),J.abrupt("break",85);case 26:return this.shapeEle.setAttribute("fill-opacity",f),J.abrupt("break",85);case 28:return this.shapeEle.setAttribute("stroke",f),J.abrupt("break",85);case 30:return this.shapeEle.setAttribute("stroke-opacity",f),this.textEle.setAttribute("fill-opacity",f),J.abrupt("break",85);case 33:return this.shapeEle.setAttribute("stroke-width",f*P.scale),this.update({start:this.start,end:this.end},!1),this.showPopup(),J.abrupt("break",85);case 37:return f==="solid"&&this.shapeEle.setAttribute("stroke-dasharray",""),f==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),J.abrupt("break",85);case 40:return this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),J.abrupt("break",85);case 42:return this.textEle.setAttribute("fill",f),J.abrupt("break",85);case 44:return this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(f,"px)"),J.abrupt("break",85);case 46:return this.textEle.style.fontFamily=f,J.abrupt("break",85);case 48:return this.textEle.style.fontStyle=f,J.abrupt("break",85);case 50:return this.textEle.style.fontWeight=f,J.abrupt("break",85);case 52:return this.radiusTspan&&(this.radiusTspan.remove(),this.radiusTspan=null),this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:E.x,y:E.y,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=f,J.abrupt("break",85);case 57:return d==="precision"&&(this.decimalPlaces=((M=Math.abs(x.precision).toString().split(".")[1])===null||M===void 0?void 0:M.length)||0),J.next=60,P.annotationManager.editMeasurementAnnotation(_defineProperty$1({annotPtr:x.annotPtr,rulerPtr:x.rulerPtr},d,f));case 60:return J.next=62,P.messageHandler.sendWithPromise("GetFactor",x.rulerPtr);case 62:return T=J.sent,x.factor=T,this.getResult(),this.radiusTspan&&(this.radiusTspan.textContent=x.radius.toFixed(this.decimalPlaces)+x.scale.translateUnit),this.permiterTspan&&(this.permiterTspan.textContent=x.perimeter.toFixed(this.decimalPlaces)+x.scale.translateUnit),this.areaTspan&&(this.areaTspan.textContent=x.area.toFixed(this.decimalPlaces)+x.scale.translateUnit+"\xB2"),P.annotationStore.selectedElementName!==this.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||P.eventBus.dispatch("measurePropertyChange",this.annotation),J.next=71,P.annotationManager.editMeasurementAnnotation({annotPtr:x.annotPtr,contents:x.contents});case 71:return k=0,J.abrupt("break",85);case 73:return D=this.rect,N=D.left,I=D.top,O=P.scale,F=P.getPageWidth(this.PageNumber)*O,q=P.getPageHeight(this.PageNumber)*O,Y=Math.min(F-N,q-I)/2,_e=Math.max(0,Math.min(f/x.factor*O,Y)),ne={x:N+2*_e,y:I+2*_e},this.startState={operator:"end"},this.update({start:this.start,end:ne}),this.showPopup(),k=0,J.abrupt("break",85);case 85:return!y&&this.sendData(_defineProperty$1({},d,f)),J.abrupt("return",k);case 87:case"end":return J.stop()}},g,this)})),function(g,d){return u.apply(this,arguments)})},{key:"sendData",value:function(g){var d=this.annotation,f={pagePtr:d.pagePtr,annotPtr:d.annotPtr,rulerPtr:d.rulerPtr,pageIndex:d.pageIndex,contents:d.contents};["fontSize","fontName","color","fontStyle","fontWeight"].some(function(x){return g[x]})&&(f.fontSize=d.fontSize,f.color=d.color,f.fontName=d.fontName,f.fontStyle=d.fontStyle,f.fontWeight=d.fontWeight),g.dashes&&(f.borderStyle=d.borderStyle,f.borderWidth=d.borderWidth),g.borderStyle&&(f.dashes=g.borderStyle==="solid"?"":d.dashes,f.borderWidth=d.borderWidth);var y=Object.assign({},f,g);this.documentViewer.annotationManager.editMeasurementAnnotation(y)}},{key:"getResult",value:function(){var g=this.annotation,d=g.rect,f=g.factor,y=g.scale.translateUnit,x=Math.abs(d.right-d.left),k=Math.abs(d.bottom-d.top),P=this.formatValue(Math.max(x,k)/2*f),S=this.formatValue(Math.min(x,k)/2*f),E=Math.max(P,S),M=0,T=0;P===S?(M=this.formatValue(Math.PI*Math.pow(E,2)),T=this.formatValue(2*Math.PI*E)):(M=this.formatValue(Math.PI*P*S),T=this.formatValue(Math.PI*(3*(P+S)-Math.sqrt((3*P+S)*(P+3*S))))),this.annotation.radius=E,this.annotation.area=M,this.annotation.perimeter=T;var D=[];this.showRadius&&D.push(this.annotation.radius.toFixed(this.decimalPlaces)+y),this.showPerimeter&&D.push(this.annotation.perimeter.toFixed(this.decimalPlaces)+y),this.showArea&&D.push(this.annotation.area.toFixed(this.decimalPlaces)+y+"\xB2"),this.annotation.contents=D.join(`
`)}},{key:"showPopup",value:function(){if(this.layer){var g=this.layer.div.getBoundingClientRect(),d=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,f=g.left+this.rect.left-d,y=this.rect.top+g.top-d,x={left:f,top:y,right:f+this.rect.width+2*d,bottom:y+this.rect.height+2*d};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:x}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y=this;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d==="delete"&&this.handleDelete(),d==="reply"&&(this.openReply(),(f=document.getElementById("leftPanel"))!=null&&f.classList.contains("closed")&&setTimeout(function(){y.showPopup()},350));case 2:case"end":return x.stop()}},g,this)})),function(g){return r.apply(this,arguments)})},{key:"formatValue",value:function(g){return g%1==0?g:Number(g.toFixed(this.decimalPlaces))}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"){y.next=2;break}return y.abrupt("return");case 2:(f=d.keyCode||d.which)!==8&&f!==46||this.handleDelete();case 4:case"end":return y.stop()}},g,this)})),function(g){return o.apply(this,arguments)})},{key:"renderAnnot",value:function(){var g=this,d=this.annotation,f=this.rect,y=this.documentViewer.scale,x=d.borderWidth*y,k=this.getDashString();if(this.svgElement.innerHTML="",this.shapeEle=createSvg("ellipse",{cx:f.width/2,cy:f.height/2,rx:(f.width-x)/2,ry:(f.height-x)/2,stroke:d.borderColor,"stroke-dasharray":k,"stroke-width":x,"stroke-opacity":d.opacity||1,fill:d.fillColor?d.fillColor:"none","fill-opacity":d.fillTransparency||1}),this.svgElement.append(this.shapeEle),d.measure){var P={x:(f.width-x)/2,y:(f.height-x)/2};this.textEle=createSvg("text",{fill:d.color||d.borderColor,"fill-opacity":d.opacity||1,"text-anchor":"middle","dominant-baseline":"middle"},{"font-size":"calc(var(--scale-factor) * ".concat(d.fontSize,"px)")}),this.svgElement.append(this.textEle);var S=[];this.showRadius&&(this.radiusTspan=createSvg("tspan",{x:P.x,y:P.y}),this.radiusTspan.textContent=d.radius.toFixed(this.decimalPlaces)+d.scale.translateUnit,S.push(this.radiusTspan)),this.showPerimeter&&(this.permiterTspan=createSvg("tspan",{x:P.x,y:P.y}),this.permiterTspan.textContent=d.perimeter.toFixed(this.decimalPlaces)+d.scale.translateUnit,S.push(this.permiterTspan)),this.showArea&&(this.areaTspan=createSvg("tspan",{x:P.x,y:P.y}),this.areaTspan.textContent=d.area.toFixed(this.decimalPlaces)+d.scale.translateUnit+"\xB2",S.push(this.areaTspan)),S.forEach(function(E,M){S.length===3?E.setAttribute("dy",M-1+"em"):E.setAttribute("dy",M+"em"),g.textEle.appendChild(E)})}}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var g=this.annotation.dashes||"2,2",d=this.documentViewer.scale;return g.split(",").map(function(f){return Math.ceil(f*d)}).join(", ")}}]);var o,r,u,s,w,m,v}(),Rectangle=function(e){function n(d){var f,y=d.annotation,x=d.documentViewer,k=d.show,P=k!==void 0&&k,S=d.enableReply,E=S===void 0||S;return _classCallCheck(this,n),(f=_callSuper(this,n,[{annotation:y,documentViewer:x}])).type="rectangle",f.enableReply=E,f.hidden=!0,f.initial=!1,f.start=null,f.end=null,f.newStart=null,f.newEnd=null,f.svgElement=null,f.startCircle=null,f.endCircle=null,f.show=P,f.ratio=window.devicePixelRatio||1,f.decimalPlaces=0,f.showPerimeter=f.documentViewer.annotationStore.rectangle.showPerimeter,f.showArea=f.documentViewer.annotationStore.rectangle.showArea,f.isPopupShow=!1,f.selectionOutlinePadding=8,f.selectionOutlinePointWidth=6,f.onMousedown=f.handleMouseDown.bind(f),f.onMouseup=f.handleMouseUp.bind(f),f.onMousemove=f.handleMouseMove.bind(f),f.onDelete=f.handleDelete.bind(f),f.onOpenReply=f.openReply.bind(f),f.handlePropertyPanel=f.handlePropertyPanel.bind(f),f.onHandlePopup=f.handlePopup.bind(f),f.onKeydown=f.handleKeyDown.bind(f),f.render(),f}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y,x,k,P,S,E,M,T,D,N=this;return _regeneratorRuntime().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:f=this.annotation,y=this.documentViewer.scale,this.updateRect(),x=this.rect,this.realVertices=this.annotation.vertices.map(function(O){return getActualPoint$1(O,y)}),k=(f.borderWidth||2)*y,f.showPerimeter!==void 0&&(this.showPerimeter=f.showPerimeter,delete f.showPerimeter),f.showArea!==void 0&&(this.showArea=f.showArea,delete f.showArea),f.fillColor||(f.fillColor=""),f.borderStyle||(f.borderStyle="solid"),!f.contents&&f.measure&&this.getResult(),f.precision&&(f.precision>1&&(f.precision=Math.pow(10,-Math.floor(Math.log10(f.precision)))),this.decimalPlaces=((P=Math.abs(f.precision).toString().split(".")[1])===null||P===void 0?void 0:P.length)||0,f.area=this.formatValue(f.area),f.perimeter=this.formatValue(f.perimeter)),f.fontStyle||(f.fontStyle="regular"),f.borderColor||(f.borderColor=f.color||"#FF0000"),f.width&&f.length||(S=(f.rect.right-f.rect.left)*f.factor,E=(f.rect.bottom-f.rect.top)*f.factor,f.length=this.formatValue(S),f.width=this.formatValue(E)),this.annotationContainer=createElement("div",{top:x.top+"px",left:x.left+"px",width:x.width+"px",height:x.height+"px"},{id:f.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"0 0 ".concat(x.width," ").concat(x.height)},{pointerEvents:"all",overflow:"visible"}),M=this.getDashString(),this.shapeEle=createSvg("rect",{x:k/2,y:k/2,width:"".concat(Math.abs(x.width-k),"px"),height:"".concat(Math.abs(x.height-k),"px"),stroke:f.borderColor,"stroke-width":k,"stroke-dasharray":M,"stroke-opacity":f.opacity||1,fill:f.fillColor?f.fillColor:"none","fill-opacity":f.fillTransparency||1},{"stroke-linecap":"butt"}),this.svgElement.append(this.shapeEle),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.handleClick.bind(this)),f.measure&&(this.textEle=createSvg("text",{fill:f.color||f.borderColor,"fill-opacity":f.opacity||1,"text-anchor":"middle","dominant-baseline":"middle"},{"font-size":"calc(var(--scale-factor) * ".concat(f.fontSize,"px)")}),this.svgElement.append(this.textEle),T=[],this.showPerimeter&&(this.permiterTspan=createSvg("tspan",{x:x.width/2,y:x.height/2}),this.permiterTspan.textContent=f.perimeter.toFixed(this.decimalPlaces)+f.scale.translateUnit,T.push(this.permiterTspan)),this.showArea&&(this.areaTspan=createSvg("tspan",{x:x.width/2,y:x.height/2}),this.areaTspan.textContent=f.area.toFixed(this.decimalPlaces)+f.scale.translateUnit+"\xB2",T.push(this.areaTspan)),T.forEach(function(O,F){O.setAttribute("dy",F+"em"),N.textEle.appendChild(O)})),this.outerLineContainer=createElement("div",{},{class:"outline-container"}),D=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,this.outerLine=createSvg("svg",{},{position:"absolute",left:"".concat(x.left-D,"px"),top:"".concat(x.top-D,"px"),width:"".concat(x.width+2*D,"px"),height:"".concat(x.height+2*D,"px"),zIndex:1}),this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":1,"stroke-dasharray":"2","fill-opacity":0,width:x.width+this.selectionOutlinePadding,height:x.height+this.selectionOutlinePadding,x:this.selectionOutlinePointWidth/2,y:this.selectionOutlinePointWidth/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:0}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:0,y:x.height+this.selectionOutlinePadding}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:x.width+this.selectionOutlinePadding,y:x.height+this.selectionOutlinePadding}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.selectionOutlinePointWidth,height:this.selectionOutlinePointWidth,x:x.width+this.selectionOutlinePadding,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.topRightRect),this.outerLineContainer.append(this.outerLine),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 40:case"end":return I.stop()}},d,this)})),function(){return g.apply(this,arguments)})},{key:"getActualRect",value:function(d){var f=this.annotation.rect,y=f.left,x=f.top,k=f.right,P=f.bottom;return{start:getActualPoint$1({x:y,y:x},d),end:getActualPoint$1({x:k,y:P},d)}}},{key:"rectCalc",value:function(d){var f=d.start,y=d.end;return{top:f.y<y.y?f.y:y.y,left:f.x<y.x?f.x:y.x,width:Math.abs(y.x-f.x),height:Math.abs(y.y-f.y)}}},{key:"calculate",value:function(d,f){var y=this.rectCalc({start:d,end:f}),x=(this.annotation.borderWidth||2)*this.documentViewer.scale;return{top:y.top-x,left:y.left-x,width:y.width+2*x,height:y.height+2*x}}},{key:"getInitialPoint",value:function(){var d=this.documentViewer.scale;return{start:{x:this.start.x/d,y:this.start.y/d},end:{x:this.end.x/d,y:this.end.y/d}}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove();else{var d;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var f=this.annotation;this.documentViewer.annotationStore.selectedElementName=f.name;var y=_objectSpread2$1({},f);delete y.annotPtr,delete y.pagePtr,delete y.operate,delete y.targetPage,this.documentViewer.eventBus.dispatch("annotationSelected",y)}(d=this.layer)===null||d===void 0||d.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,perimeter:this.annotation.perimeter,area:this.annotation.area,width:this.annotation.width,length:this.annotation.length,showPerimeter:this.showPerimeter,showArea:this.showArea})),this.showPopup(),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"setPopupElementStyle",value:function(){var d,f;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(d=this.layer)===null||d===void 0||d.div.classList.remove("no-edit"):(f=this.layer)===null||f===void 0||f.div.classList.add("no-edit")}},{key:"handleClick",value:function(d){var f;if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes((f=this.layer)===null||f===void 0?void 0:f.tool)&&!document.querySelector(".compare-document-container").contains(d==null?void 0:d.target)){this.hidden=!1,this.updateTool(),this.annotation.measure&&(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)),document.addEventListener("keydown",this.onKeydown);var y=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")],x=document.getElementById("measurePropertyPanelButton");x&&y.push(x);var k=document.querySelector(".toggle-button");k&&y.push(k),onClickOutside$1(y,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var d,f,y,x,k=this.documentViewer.annotationStore.selectedElementName,P=this.annotation.name;!this.hidden&&this.annotation.measure&&this.annotation.measure&&k===P&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(x=this.documentViewer)===null||x===void 0||(x=x.pdfViewer)===null||x===void 0||(x=x.measurementTool)===null||x===void 0||x.updateMeasurePanel(),this.hidePopup()),this.annotation.measure&&k===P&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("mousedown",this.onMousedown),(f=this.outerLine)===null||f===void 0||f.removeEventListener("touchstart",this.onMousedown),(y=this.outerLineContainer)===null||y===void 0||y.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure&&(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup))}},{key:"handleMouseDown",value:function(d){var f;if(d.button===0||d.type!=="mousedown"){(f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation();var y=d.target.getAttribute("data-id"),x=this.documentViewer.getScrollViewElement();this.scrollTop=x.scrollTop,this.scrollLeft=x.scrollLeft;var k=getClickPoint(d),P=k.pageX,S=k.pageY;this.startState={operator:y,clickX:P,clickY:S},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(d){if(d.button===0||d.type!=="mousemove"){this.hidePopup(),d.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var f=getClickPoint(d),y=f.pageX,x=f.pageY,k=this.documentViewer.getScrollViewElement(),P=k.scrollTop;y=y+k.scrollLeft-this.scrollLeft,x=x+P-this.scrollTop;var S=this.start,E=this.end,M=this.startState,T=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2+this.annotation.borderWidth*this.documentViewer.scale,D=this.layer.viewport,N=D.width,I=D.height;if(M.operator==="nw-resize"){var O=y-(M.clickX-this.start.x),F=x-(M.clickY-this.start.y);O=Math.min(E.x-5,O),O=Math.max(T,O),F=Math.min(E.y-5,F),F=Math.max(T,F),this.update({start:{x:O,y:F},end:E})}else if(M.operator==="sw-resize"){var q=y-(M.clickX-this.start.x),Y=x-(M.clickY-this.end.y);q=Math.min(E.x-5,q),q=Math.max(T,q),Y=Math.min(I-T,Y),Y=Math.max(S.y+5,Y),this.update({start:{x:q,y:S.y},end:{x:E.x,y:Y}})}else if(M.operator==="se-resize"){var _e=y-(M.clickX-this.end.x),ne=x-(M.clickY-this.end.y);_e=Math.min(N-T,_e),_e=Math.max(S.x+5,_e),ne=Math.min(I-T,ne),ne=Math.max(S.y+5,ne),this.update({start:S,end:{x:_e,y:ne}})}else if(M.operator==="ne-resize"){var ve=y-(M.clickX-this.end.x),J=x-(M.clickY-this.start.y);ve=Math.min(N-T,ve),ve=Math.max(S.x+5,ve),J=Math.min(E.y,J),J=Math.max(T,J),this.update({start:{x:S.x,y:J},end:{x:ve,y:E.y}})}else if(M.operator==="move"){var fe,Z,j,X,H=this.documentViewer,U=this.getMouseLocation(d),te=H.getSelectedPage(U,U),Q=this.PageNumber;if(te.first&&te.first!==Q){var re,Pe=H.windowToPage(U,te.first,!1),be=Math.abs(S.x-E.x),we=Math.abs(S.y-E.y);if(H.pdfViewer.spreadMode===0&&H.pdfViewer.scrollMode===0)fe=y-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=y-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y;else if(H.pdfViewer.spreadMode===0&&H.pdfViewer.scrollMode===1)fe=te.first>Q?Pe.x:Pe.x-be,Z=x-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=x-(M.clickY-this.end.y);else if(H.pdfViewer.spreadMode===1&&H.pdfViewer.scrollMode===0){var Ae=Math.min(te.first,Q),$e=Math.max(te.first,Q);if($e-Ae>2||Ae+1===$e&&Ae%2==0)return;Ae+1===$e?(fe=te.first>Q?Pe.x:Pe.x-be,Z=x-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=x-(M.clickY-this.end.y)):Ae+2===$e&&(fe=y-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=y-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y)}else if(H.pdfViewer.spreadMode===2&&H.pdfViewer.scrollMode===0){var Me=Math.min(te.first,Q),Ie=Math.max(te.first,Q);if(Ie-Me>2||Me+1===Ie&&(Me!==1||Ie!==2)&&Ie%2==0||Me===1&&Ie===3)return;Me+2===Ie||Me===1&&Ie===2?(fe=y-(M.clickX-this.start.x),Z=te.first>Q?Pe.y:Pe.y-we,j=y-(M.clickX-this.end.x),X=te.first>Q?Pe.y+we:Pe.y):Me+1===Ie&&(fe=te.first>Q?Pe.x:Pe.x-be,Z=x-(M.clickY-this.start.y),j=te.first>Q?Pe.x+be:Pe.x,X=x-(M.clickY-this.end.y))}if(!H.pdfViewer._pages[te.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=te.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Le=(re=this.layer)===null||re===void 0?void 0:re.div;Le==null||Le.append(this.annotationContainer),Le==null||Le.append(this.outerLineContainer)}else{Z=x-(M.clickY-this.start.y),fe=y-(M.clickX-this.start.x),j=y-(M.clickX-this.end.x),X=x-(M.clickY-this.end.y);var le=H.pageToWindow({x:fe,y:Z},Q,!1),oe=H.pageToWindow({x:j,y:X},Q,!1),ke=0,Ce=0;x>M.clickY?Ce=(Ce=k.offsetHeight-(oe.y-k.scrollTop-k.offsetTop))<100?5:0:x<M.clickY&&(Ce=(Ce=le.y-k.scrollTop-k.offsetTop)<100?-5:0),y>M.clickX?ke=(ke=k.offsetWidth-(oe.x-k.scrollLeft-k.offsetLeft))<100?5:0:y<M.clickX&&(ke=(ke=le.x-k.scrollLeft-k.offsetLeft)<100?-5:0),(ke||Ce)&&(k.scrollTop+=Ce,k.scrollLeft+=ke);var Ee={width:Math.abs(S.x-E.x),height:Math.abs(S.y-E.y)};fe<j?(fe=Math.max(T,fe),fe=Math.min(N-Ee.width-T,fe),j=Math.max(Ee.width+T,j),j=Math.min(N-T,j)):(j=Math.max(T,j),j=Math.min(N-Ee.width-T,j),fe=Math.max(Ee.width+T,fe),fe=Math.min(N-T,fe)),Z<X?(Z=Math.max(T,Z),Z=Math.min(I-Ee.height-T,Z),X=Math.max(Ee.height+T,X),X=Math.min(I-T,X)):(X=Math.max(T,X),X=Math.min(I-Ee.height-T,X),Z=Math.max(Ee.height+T,Z),Z=Math.min(I-T,Z))}this.update({start:{x:fe,y:Z},end:{x:j,y:X}})}M.clickX=y,M.clickY=x}}},{key:"handleDelete",value:function(d){var f;(f=this.layer)!==null&&f!==void 0&&f.tool&&d&&d.stopPropagation(),this.delete();var y={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(y.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",y),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var d,f;this.handleOutside(),(d=this.annotationContainer)===null||d===void 0||d.remove(),this.annotation.isDelete=!0,this.annotation.name&&((f=this.layer)===null||f===void 0||f.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P,S,E,M,T,D,N,I,O;return _regeneratorRuntime().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(f.button===0||f.type!=="mouseup"){F.next=2;break}return F.abrupt("return");case 2:if((y=this.layer)!==null&&y!==void 0&&y.tool&&f.stopPropagation(),f.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,x=this.annotation,k=this.getInitialPoint(),P=k.start,S=k.end,E={left:P.x,top:P.y,right:S.x,bottom:S.y},M=[{x:E.left,y:E.top},{x:E.right,y:E.top},{x:E.right,y:E.bottom},{x:E.left,y:E.bottom}],E!==x.rect||this.PrePageNumber!==this.PageNumber){F.next=17;break}return F.abrupt("return");case 17:if(x.rect=E,x.vertices=M,this.documentViewer.annotationStore.selectedElementName===x.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){F.next=43;break}return T={type:"delete",annotation:{operate:"del-annot",name:x.name,pageIndex:x.pageIndex,annotPtr:x.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",T),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(D=Object.assign({},x)).annotPtr,delete D.pagePtr,delete D.name,D.operate="add-annot",D.pageIndex=this.PageNumber-1,F.next=33,this.documentViewer.annotationManager.createMeasurementAnnotation(D);case 33:return N=F.sent,I=new n({annotation:N,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),F.next=38,this.documentViewer.annotationManager.addAnnotation(I);case 38:this.documentViewer.annotationManager.drawAnnotationsFromList(I),this.annotationContainer.remove(),this.outerLineContainer.remove(),F.next=47;break;case 43:return O={operate:"mod-annot",name:x.name,pageIndex:this.PageNumber-1,pagePtr:x.pagePtr,annotPtr:x.annotPtr,rect:E,vertices:M},F.next=46,this.documentViewer.annotationManager.editMeasurementAnnotation(O);case 46:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 47:case"end":return F.stop()}},d,this)})),function(d){return v.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var d=this.documentViewer.scale,f=this.getActualRect(d),y=f.start,x=f.end;this.update({start:y,end:x})}}},{key:"update",value:function(d){var f=d.start,y=d.end,x=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.start=f,this.end=y;var k=this.getInitialPoint(),P=k.start,S=k.end;this.annotation.vertices=[{x:P.x,y:P.y},{x:S.x,y:P.y},{x:S.x,y:S.y},{x:P.x,y:S.y}],this.updateRect();var E=this.rect,M=(this.annotation.borderWidth||2)*this.documentViewer.scale;this.annotationContainer.style.top=E.top+"px",this.annotationContainer.style.left=E.left+"px",this.annotationContainer.style.width=E.width+"px",this.annotationContainer.style.height=E.height+"px",this.svgElement.setAttribute("viewBox","0 0 ".concat(E.width," ").concat(E.height)),this.shapeEle.setAttribute("x",M/2),this.shapeEle.setAttribute("y",M/2),this.shapeEle.setAttribute("width","".concat(Math.abs(E.width-M),"px")),this.shapeEle.setAttribute("height","".concat(Math.abs(E.height-M),"px")),this.shapeEle.setAttribute("stroke-width",M);var T=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2;this.outerLine.style.left="".concat(E.left-T,"px"),this.outerLine.style.top="".concat(E.top-T,"px"),this.outerLine.style.width="".concat(E.width+2*T,"px"),this.outerLine.style.height="".concat(E.height+2*T,"px"),this.moveRect.setAttribute("width",E.width+this.selectionOutlinePadding),this.moveRect.setAttribute("height",E.height+this.selectionOutlinePadding),this.bottomLeftRect.setAttribute("y",E.height+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("x",E.width+this.selectionOutlinePadding),this.bottomRightRect.setAttribute("y",E.height+this.selectionOutlinePadding),this.topRightRect.setAttribute("x",E.width+this.selectionOutlinePadding),this.annotation.measure&&(this.getResult(),this.permiterTspan&&(this.permiterTspan.setAttribute("x",E.width/2),this.permiterTspan.setAttribute("y",E.height/2),this.permiterTspan.textContent=this.annotation.perimeter.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit),this.areaTspan&&(this.areaTspan.setAttribute("x",E.width/2),this.areaTspan.setAttribute("y",E.height/2),this.areaTspan.textContent=this.annotation.area.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit+"\xB2"),this.annotation.measure&&this.updateMeasure(x))}},{key:"updateMeasure",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!this.startState||this.startState.operator==="move"||!f){x.next=4;break}return y={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:this.annotation.rect,contents:this.annotation.contents,vertices:this.annotation.vertices},x.next=4,this.documentViewer.annotationManager.editMeasurementAnnotation(y);case 4:if(!this.startState||this.startState.operator!=="move"){x.next=6;break}return x.abrupt("return");case 6:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,perimeter:this.annotation.perimeter,area:this.annotation.area,width:this.annotation.width,length:this.annotation.length});case 7:case"end":return x.stop()}},d,this)})),function(d){return m.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"setAnnotationChanged",value:function(d){var f=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"rectangle",operate:"mod-annot",name:f.name,pageIndex:this.PageNumber-1,pagePtr:f.pagePtr,annotPtr:f.annotPtr},d)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(d){if(d!==this.contents){var f=this.annotation;this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:this.rect.width/2,y:this.rect.height/2,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=value,f.contents=d,this.setAnnotationChanged({contents:d})}}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(d){var f;this.annotation.opacity=d,this.shapeEle.setAttribute("stroke-opacity",d),(f=this.textEle)===null||f===void 0||f.setAttribute("fill-opacity",d),this.setAnnotationChanged({opacity:d})}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(d){this.shapeEle.setAttribute("fill",d||"none"),this.annotation.fillColor=d,this.setAnnotationChanged({fillColor:d})}},{key:"fillTransparency",get:function(){return this.annotation.fillTransparency},set:function(d){this.shapeEle.setAttribute("fill-opacity",d),this.annotation.fillTransparency=d,this.setAnnotationChanged({fillTransparency:d})}},{key:"color",get:function(){return this.annotation.color},set:function(d){var f=this.annotation;this.textEle.setAttribute("fill",d),f.color=d,this.setAnnotationChanged({color:d,fontSize:f.fontSize,fontName:f.fontName,fontStyle:f.fontStyle,fontWeight:f.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(d){var f=this.annotation;this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(d,"px)"),f.fontSize=d,this.setAnnotationChanged({color:f.color,fontSize:d,fontName:f.fontName,fontStyle:f.fontStyle,fontWeight:f.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(d){var f=this.annotation;this.textEle.style.fontFamily=d,f.fontName=d,this.setAnnotationChanged({color:f.color,fontSize:f.fontSize,fontName:d,fontStyle:f.fontStyle,fontWeight:f.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(d){this.textEle.style.fontStyle=d,this.annotation.fontStyle=d,this.setAnnotationChanged({color:annotation.color,fontSize:annotation.fontSize,fontName:annotation.fontName,fontStyle:d,fontWeight:annotation.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(d){this.textEle.style.fontWeight=d,this.annotation.fontWeight=d,this.setAnnotationChanged({color:annotation.color,fontSize:annotation.fontSize,fontName:annotation.fontName,fontStyle:annotation.fontStyle,fontWeight:d})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(d){var f=this.annotation;d==="solid"?this.shapeEle.setAttribute("stroke-dasharray",""):d==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),f.borderStyle=d,this.setAnnotationChanged({borderStyle:d,borderWidth:f.borderWidth,dashes:f.dashes||"2, 2"})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(d){var f=this.annotation;f.dashes=d,this.shapeEle.setAttribute("stroke-dasharray",this.borderStyle==="dashed"?this.getDashString():""),this.setAnnotationChanged({borderWidth:f.borderWidth,borderStyle:f.borderStyle,dashes:d})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(d){this.annotation.borderWidth=d,this.shapeEle.setAttribute("stroke-width",d*this.documentViewer.scale),this.update({start:this.start,end:this.end},!1),this.setAnnotationChanged({borderWidth:d})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(d){this.shapeEle.setAttribute("stroke",d),this.annotation.borderColor=d,this.setAnnotationChanged({borderColor:d})}},{key:"handlePropertyPanel",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P=this;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.documentViewer.annotationStore.selectedElementName===this.annotation.name){S.next=2;break}return S.abrupt("return");case 2:y=0,S.t0=_regeneratorRuntime().keys(f);case 4:if((S.t1=S.t0()).done){S.next=12;break}return x=S.t1.value,S.t2=y,S.next=9,this.setCustomData(x,f[x],!0);case 9:y=S.t2+=S.sent,S.next=4;break;case 12:if(y>0&&this.sendData(f),y!==0||!["showPerimeter","showArea"].some(function(E){return E in f})){S.next=21;break}return this.getResult(),k=[],this.permiterTspan&&k.push(this.permiterTspan),this.areaTspan&&k.push(this.areaTspan),k.forEach(function(E,M){E.setAttribute("dy",M+"em"),P.textEle.appendChild(E)}),S.next=21,this.documentViewer.annotationManager.editMeasurementAnnotation({annotPtr:this.annotation.annotPtr,contents:this.annotation.contents});case 21:["scale","precision","showPerimeter","showArea"].some(function(E){return E in f})&&this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,perimeter:this.annotation.perimeter,area:this.annotation.area,width:this.annotation.width,length:this.annotation.length,showPerimeter:this.showPerimeter,showArea:this.showArea});case 22:case"end":return S.stop()}},d,this)})),function(d){return w.apply(this,arguments)})},{key:"setCustomData",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function d(f,y){var x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne=arguments;return _regeneratorRuntime().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(x=ne.length>2&&ne[2]!==void 0&&ne[2],k=this.annotation,P=0,f!=="showPerimeter"){ve.next=7;break}return this.showPerimeter=y,!y&&this.permiterTspan?(this.permiterTspan.remove(),this.permiterTspan=null):y&&(this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:this.rect.width/2,y:this.rect.height/2})),this.permiterTspan.textContent=k.perimeter.toFixed(this.decimalPlaces)+k.scale.translateUnit),ve.abrupt("return",0);case 7:if(f!=="showArea"){ve.next=11;break}return this.showArea=y,!y&&this.areaTspan?(this.areaTspan.remove(),this.areaTspan=null):y&&(this.areaTspan||(this.areaTspan=createSvg("tspan",{x:this.rect.width/2,y:this.rect.height/2})),this.areaTspan.textContent=k.area.toFixed(this.decimalPlaces)+k.scale.translateUnit+"\xB2"),ve.abrupt("return",0);case 11:ve.t0=_regeneratorRuntime().keys(k);case 12:if((ve.t1=ve.t0()).done){ve.next=51;break}if((S=ve.t1.value)!==f||k[S]===y){ve.next=49;break}if(k[S]=y,P=1,f==="borderColor"&&this.shapeEle.setAttribute("stroke",y),f==="fillColor"&&this.shapeEle.setAttribute("fill",y||"none"),f==="fillTransparency"&&this.shapeEle.setAttribute("fill-opacity",y),f==="opacity"&&(this.shapeEle.setAttribute("stroke-opacity",y),this.textEle.setAttribute("fill-opacity",y)),f==="borderWidth"&&(this.shapeEle.setAttribute("stroke-width",y*this.documentViewer.scale),this.update({start:this.start,end:this.end},!1),this.showPopup()),f==="borderStyle"&&(y==="solid"&&this.shapeEle.setAttribute("stroke-dasharray",""),y==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString())),f==="dashes"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),f==="color"&&this.textEle.setAttribute("fill",y),f==="fontSize"&&(this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(y,"px)")),f==="fontName"&&(this.textEle.style.fontFamily=y),f==="fontStyle"&&(this.textEle.style.fontStyle=y),f==="fontWeight"&&(this.textEle.style.fontWeight=y),f==="contents"&&(this.areaTspan&&(this.areaTspan.remove(),this.areaTspan=null),this.permiterTspan||(this.permiterTspan=createSvg("tspan",{x:this.rect.width/2,y:this.rect.height/2,dy:"0em"}),this.textEle.appendChild(this.permiterTspan)),this.permiterTspan.textContent=y),f!=="scale"&&f!=="precision"){ve.next=44;break}return f==="precision"&&(this.decimalPlaces=((E=Math.abs(k.precision).toString().split(".")[1])===null||E===void 0?void 0:E.length)||0),ve.next=34,this.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1({rulerPtr:k.rulerPtr},f,y));case 34:return ve.next=36,this.getResult();case 36:return M=[],this.showPerimeter&&this.permiterTspan&&(T=k.perimeter.toFixed(this.decimalPlaces)+k.scale.translateUnit,M.push(T),this.permiterTspan.textContent=T),this.showArea&&this.areaTspan&&(D=k.area.toFixed(this.decimalPlaces)+k.scale.translateUnit+"\xB2",M.push(D),this.areaTspan.textContent=D),k.contents=M.join(`
`),this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),ve.next=43,this.documentViewer.annotationManager.editMeasurementAnnotation({annotPtr:k.annotPtr,contents:k.contents});case 43:P=0;case 44:N=this.documentViewer.scale,I=this.documentViewer.getPageWidth(this.PageNumber)*N,O=this.documentViewer.getPageHeight(this.PageNumber)*N,f==="length"&&(F=y/k.factor*N,q=this.start.x+F,q=Math.min(I,q),q=Math.max(0,q),this.startState={operator:"end"},this.update({start:this.start,end:{x:q,y:this.end.y}}),this.showPopup(),P=0),f==="width"&&(Y=y/k.factor*N,_e=this.start.y+Y,_e=Math.min(O,_e),_e=Math.max(0,_e),this.startState={operator:"end"},this.update({start:this.start,end:{x:this.end.x,y:_e}}),this.showPopup(),P=0);case 49:ve.next=12;break;case 51:return!x&&this.sendData(_defineProperty$1({},f,y)),ve.abrupt("return",P);case 53:case"end":return ve.stop()}},d,this)})),function(d,f){return s.apply(this,arguments)})},{key:"sendData",value:function(d){var f=this.annotation,y={type:"rectangle",pagePtr:f.pagePtr,annotPtr:f.annotPtr,rulerPtr:f.rulerPtr,pageIndex:f.pageIndex,contents:f.contents};if(["fontSize","fontName","color","fontStyle"].some(function(S){return d[S]})){y.fontSize=f.fontSize,y.color=f.color;var x={Courier:{normal:"Courier",bold:"Courier-Bold",italic:"Courier-Oblique",boldItalic:"Courier-BoldOblique"},Helvetica:{normal:"Helvetica",bold:"Helvetica-Bold",italic:"Helvetica-Oblique",boldItalic:"Helvetica-BoldOblique"},Times:{normal:"Times",bold:"Times-Bold",italic:"Times-Italic",boldItalic:"Times-BoldItalic"}},k=f.fontName;f.isBold&&f.isItalic?y.fontName=x[k].boldItalic:f.isBold?y.fontName=x[k].bold:f.isItalic?y.fontName=x[k].italic:y.fontName=x[k]?x[k].normal:k,delete d.fontName}d.dashes&&(d.dashes.length===1&&(d.dashes=new Array(2).fill(d.dashes[0])),y.borderStyle=f.borderStyle,y.borderWidth=f.borderWidth),d.borderStyle&&(y.dashes=d.borderStyle==="solid"?"":f.dashes,y.borderWidth=f.borderWidth);var P=Object.assign({},y,d);this.documentViewer.annotationManager.editMeasurementAnnotation(P)}},{key:"getResult",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:f=this.annotation,y=f.rect,x=f.factor,k=f.scale.translateUnit,P=(y.right-y.left)*x,S=(y.bottom-y.top)*x,this.annotation.length=this.formatValue(P),this.annotation.width=this.formatValue(S),this.annotation.area=this.formatValue(P*S),this.annotation.perimeter=this.formatValue(2*(P+S)),E=[],this.showPerimeter&&E.push(this.annotation.perimeter.toFixed(this.decimalPlaces)+k),this.showArea&&E.push(this.annotation.area.toFixed(this.decimalPlaces)+k+"\xB2"),this.annotation.contents=E.join(`
`);case 11:case"end":return M.stop()}},d,this)})),function(){return u.apply(this,arguments)})},{key:"showPopup",value:function(){if(this.layer){var d=this.layer.div.getBoundingClientRect(),f=(this.selectionOutlinePadding+this.selectionOutlinePointWidth)/2,y=d.left+this.rect.left-f,x=this.rect.top+d.top-f,k={left:y,top:x,right:y+this.rect.width+2*f,bottom:x+this.rect.height+2*f};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:k}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x=this;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:f==="delete"&&this.handleDelete(),f==="reply"&&(this.openReply(),(y=document.getElementById("leftPanel"))!=null&&y.classList.contains("closed")&&setTimeout(function(){x.showPopup()},350));case 2:case"end":return k.stop()}},d,this)})),function(d){return r.apply(this,arguments)})},{key:"formatValue",value:function(d){return d%1==0?d:Number(d.toFixed(this.decimalPlaces))}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"){x.next=2;break}return x.abrupt("return");case 2:(y=f.keyCode||f.which)!==8&&y!==46||this.handleDelete();case 4:case"end":return x.stop()}},d,this)})),function(d){return o.apply(this,arguments)})},{key:"updateRect",value:function(){this.annotation.rect=this.rectCalcByVertices(this.annotation.vertices);var d=this.getActualRect(this.documentViewer.scale),f=d.start,y=d.end;this.start=f,this.end=y,this.rect=this.calculate(f,y)}},{key:"rectCalcByVertices",value:function(d){var f=d.map(function(x){return x.x}),y=d.map(function(x){return x.y});return{left:Math.min.apply(Math,_toConsumableArray$1(f)),top:Math.min.apply(Math,_toConsumableArray$1(y)),right:Math.max.apply(Math,_toConsumableArray$1(f)),bottom:Math.max.apply(Math,_toConsumableArray$1(y))}}},{key:"getDashString",value:function(){if(this.borderStyle!=="dashed")return"";var d=this.annotation.dashes||"2,2",f=this.documentViewer.scale;return d.split(",").map(function(y){return Math.ceil(y*f)}).join(", ")}}]);var o,r,u,s,w,m,v,g}(),Curve=function(e){function n(g){var d,f=g.annotation,y=g.documentViewer,x=g.show,k=x!==void 0&&x,P=g.enableReply,S=P===void 0||P;return _classCallCheck(this,n),(d=_callSuper(this,n,[{annotation:f,documentViewer:y}])).type="ink",d.show=k,d.enableReply=S,d.hidden=!0,d.initial=!1,d.start=null,d.end=null,d.rect=null,d.realVertices=null,d.svgElement=null,d.ratio=window.devicePixelRatio||1,d.decimalPlaces=0,d.isPopupShow=!1,d.selectionOutlineBdWidth=1,d.onClick=d.handleClick.bind(d),d.onMousedown=d.handleMouseDown.bind(d),d.onMouseup=d.handleMouseUp.bind(d),d.onMousemove=d.handleMouseMove.bind(d),d.onDelete=d.handleDelete.bind(d),d.onOpenReply=d.openReply.bind(d),d.handlePropertyPanel=d.handlePropertyPanel.bind(d),d.onHandlePopup=d.handlePopup.bind(d),d.onKeydown=d.handleKeyDown.bind(d),d.render(),d}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(d=this.annotation,f=this.documentViewer.scale,this.realVertices=d.inkPointes[0].map(function(P){return getActualPoint$1({x:P.PointX,y:P.PointY},f)}),this.updateRect(),y=this.rect,!d.fontStyle&&(d.fontStyle="normal"),!d.fontWeight&&(d.fontWeight="normal"),!d.borderStyle&&(d.borderStyle="solid"),!d.borderColor&&(d.borderColor="#FF0000"),!d.borderWidth&&(d.borderWidth=0),d.contents||this.getResult(),d.precision&&(d.precision>1&&(d.precision=Math.pow(10,-Math.floor(Math.log10(d.precision)))),this.decimalPlaces=((x=Math.abs(d.precision).toString().split(".")[1])===null||x===void 0?void 0:x.length)||0,d.perimeter=this.formatValue(d.perimeter)),d.factor){k.next=16;break}return k.next=15,this.documentViewer.messageHandler.sendWithPromise("GetFactor",d.rulerPtr);case 15:d.factor=k.sent;case 16:this.annotationContainer=createElement("div",{top:y.top+"px",left:y.left+"px",width:y.width+"px",height:y.height+"px"},{id:d.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"".concat(y.left," ").concat(y.top," ").concat(y.width," ").concat(y.height)},{pointerEvents:"all",overflow:"visible",opacity:d.opacity?d.opacity:""}),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.onClick),this.renderAnnot(),this.outerLineContainer=createElement("div",{},{class:"outline-container"}),this.outerLine=createSvg("svg",{"data-id":"move",width:y.width,height:y.height,viewBox:"".concat(y.left," ").concat(y.top," ").concat(y.width," ").concat(y.height)},{position:"absolute",zIndex:1,left:"".concat(y.left,"px"),top:"".concat(y.top,"px"),width:"".concat(y.width,"px"),height:"".concat(y.height,"px"),border:"".concat(this.selectionOutlineBdWidth,"px dashed #1460F3"),pointerEvents:"all",cursor:"all-scroll",overflow:"visible"}),this.outerLineContainer.append(this.outerLine),this.updateCircle(),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 28:case"end":return k.stop()}},g,this)})),function(){return v.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var g,d;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(g=this.layer)===null||g===void 0||g.div.classList.remove("no-edit"):(d=this.layer)===null||d===void 0||d.div.classList.add("no-edit")}},{key:"handleClick",value:function(g){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.layer.tool)&&!document.querySelector(".compare-document-container").contains(g==null?void 0:g.target)){this.hidden=!1,this.updateTool(),this.annotation.measure&&(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)),document.addEventListener("keydown",this.onKeydown);var d=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.deletetButton&&d.push(this.deletetButton),this.replyButton&&d.push(this.replyButton);var f=document.getElementById("measurePropertyPanelButton");f&&d.push(f);var y=document.querySelector(".toggle-button");y&&d.push(y),onClickOutside$1(d,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var g,d,f,y,x=this.documentViewer.annotationStore.selectedElementName,k=this.annotation.name;!this.hidden&&this.annotation.measure&&x===k&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(y=this.documentViewer)===null||y===void 0||(y=y.pdfViewer)===null||y===void 0||(y=y.measurementTool)===null||y===void 0||y.updateMeasurePanel(),this.hidePopup()),x===k&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(g=this.outerLine)===null||g===void 0||g.removeEventListener("mousedown",this.onMousedown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("touchstart",this.onMousedown),(f=this.outerLineContainer)===null||f===void 0||f.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure&&(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup))}},{key:"getActualRect",value:function(g){var d=this.annotation.rect,f=d.left,y=d.top,x=d.right,k=d.bottom;return{start:getActualPoint$1({x:f,y},g),end:getActualPoint$1({x,y:k},g)}}},{key:"getInitialPoint",value:function(){var g=this.documentViewer.scale;return{start:{x:this.start.x/g,y:this.start.y/g},end:{x:this.end.x/g,y:this.end.y/g}}}},{key:"calculate",value:function(g,d){var f=this.rectCalc({start:g,end:d}),y=this.annotation.borderWidth*this.documentViewer.scale;return{top:f.top-y,left:f.left-y,width:f.width+2*y,height:f.height+2*y}}},{key:"rectCalc",value:function(g){var d=g.start,f=g.end;return{top:d.y<f.y?d.y:f.y,left:d.x<f.x?d.x:f.x,width:Math.abs(f.x-d.x),height:Math.abs(f.y-d.y)}}},{key:"rectCalcByVertices",value:function(g){var d=g.map(function(y){return y.x}),f=g.map(function(y){return y.y});return{left:Math.min.apply(Math,_toConsumableArray$1(d)),top:Math.min.apply(Math,_toConsumableArray$1(f)),right:Math.max.apply(Math,_toConsumableArray$1(d)),bottom:Math.max.apply(Math,_toConsumableArray$1(f))}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{var g;if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var d=this.annotation;this.documentViewer.annotationStore.selectedElementName=d.name;var f=_objectSpread2$1({},d);delete f.annotPtr,delete f.pagePtr,delete f.operate,delete f.targetPage,delete f.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",f)}(g=this.layer)===null||g===void 0||g.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleMouseDown",value:function(g){var d;if(g.button===0||g.type!=="mousedown"){(d=this.layer)!==null&&d!==void 0&&d.tool&&g.stopPropagation();var f=g.target.getAttribute("data-id"),y=this.documentViewer.getScrollViewElement();this.scrollTop=y.scrollTop,this.scrollLeft=y.scrollLeft;var x=getClickPoint(g),k=x.pageX,P=x.pageY;this.startState={operator:f,clickX:k,clickY:P},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(g){if(g.button===0||g.type!=="mousemove"){this.hidePopup(),g.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var d=getClickPoint(g),f=d.pageX,y=d.pageY,x=this.documentViewer,k=x.getScrollViewElement(),P=k.scrollTop;f=f+k.scrollLeft-this.scrollLeft,y=y+P-this.scrollTop;var S=this.start,E=this.end,M=this.startState,T=x.scale,D=x.getPageWidth(this.PageNumber)*T,N=x.getPageHeight(this.PageNumber)*T,I=/^point(\d+)$/.exec(M.operator),O=2*this.selectionOutlineBdWidth;if(I){var F=+I[1],q=this.realVertices[F],Y=f-(M.clickX-q.x),_e=y-(M.clickY-q.y);Y=Math.min(D-O,Y),Y=Math.max(O,Y),_e=Math.min(N-O,_e),_e=Math.max(O,_e),this.setPathPoint(F,Y,_e),this.update(F)}else if(M.operator==="move"){var ne,ve,J,fe,Z=this.getMouseLocation(g),j=x.getSelectedPage(Z,Z),X=this.getPageNumber();if(j.first&&j.first!==X){var H,U=x.windowToPage(Z,j.first,!1),te=Math.abs(S.x-E.x),Q=Math.abs(S.y-E.y);if(x.pdfViewer.spreadMode===0&&x.pdfViewer.scrollMode===0)ne=f-(M.clickX-this.start.x),ve=j.first>X?U.y:U.y-Q,J=f-(M.clickX-this.end.x),fe=j.first>X?U.y+Q:U.y;else if(x.pdfViewer.spreadMode===0&&x.pdfViewer.scrollMode===1)ne=j.first>X?U.x:U.x-te,ve=y-(M.clickY-this.start.y),J=j.first>X?U.x+te:U.x,fe=y-(M.clickY-this.end.y);else if(x.pdfViewer.spreadMode===1&&x.pdfViewer.scrollMode===0){var re=Math.min(j.first,X),Pe=Math.max(j.first,X);if(Pe-re>2||re+1===Pe&&re%2==0)return;re+1===Pe?(ne=j.first>X?U.x:U.x-te,ve=y-(M.clickY-this.start.y),J=j.first>X?U.x+te:U.x,fe=y-(M.clickY-this.end.y)):re+2===Pe&&(ne=f-(M.clickX-this.start.x),ve=j.first>X?U.y:U.y-Q,J=f-(M.clickX-this.end.x),fe=j.first>X?U.y+Q:U.y)}else if(x.pdfViewer.spreadMode===2&&x.pdfViewer.scrollMode===0){var be=Math.min(j.first,X),we=Math.max(j.first,X);if(we-be>2||be+1===we&&(be!==1||we!==2)&&we%2==0||be===1&&we===3)return;be+2===we||be===1&&we===2?(ne=f-(M.clickX-this.start.x),ve=j.first>X?U.y:U.y-Q,J=f-(M.clickX-this.end.x),fe=j.first>X?U.y+Q:U.y):be+1===we&&(ne=j.first>X?U.x:U.x-te,ve=y-(M.clickY-this.start.y),J=j.first>X?U.x+te:U.x,fe=y-(M.clickY-this.end.y))}if(!x.pdfViewer._pages[j.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=j.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ae=(H=this.layer)===null||H===void 0?void 0:H.div;Ae==null||Ae.append(this.annotationContainer),Ae==null||Ae.append(this.outerLineContainer)}else{ne=f-(M.clickX-this.start.x),ve=y-(M.clickY-this.start.y),J=f-(M.clickX-this.end.x),fe=y-(M.clickY-this.end.y);var $e=x.pageToWindow({x:ne,y:ve},X,!1),Me=x.pageToWindow({x:J,y:fe},X,!1),Ie=0,Le=0;y>M.clickY?Le=(Le=k.offsetHeight-(Me.y-k.scrollTop-k.offsetTop))<100?5:0:y<M.clickY&&(Le=(Le=$e.y-k.scrollTop-k.offsetTop)<100?-5:0),f>M.clickX?Ie=(Ie=k.offsetWidth-(Me.x-k.scrollLeft-k.offsetLeft))<100?5:0:f<M.clickX&&(Ie=(Ie=$e.x-k.scrollLeft-k.offsetLeft)<100?-5:0),(Ie||Le)&&(k.scrollTop+=Le,k.scrollLeft+=Ie);var le=this.annotation.borderWidth*x.scale;ne<J?(ne=Math.max(O,ne),ne=Math.min(D-this.rect.width+le,ne),J=Math.max(this.rect.width,J),J=Math.min(D,J)):(J=Math.max(O,J),J=Math.min(D-this.rect.width+le,J),ne=Math.max(this.rect.width,ne),ne=Math.min(D,ne)),ve<fe?(ve=Math.max(O,ve),ve=Math.min(N-this.rect.height+le,ve),fe=Math.max(this.rect.height,fe),fe=Math.min(N,fe)):(fe=Math.max(O,fe),fe=Math.min(N-this.rect.height+le,fe),ve=Math.max(this.rect.height,ve),ve=Math.min(N,ve))}for(var oe=ne-S.x,ke=ve-S.y,Ce=0;Ce<this.realVertices.length;Ce++){var Ee=this.realVertices[Ce],Be=Ee.x+oe,Ve=Ee.y+ke;this.setPathPoint(Ce,Be,Ve)}this.update()}M.clickX=f,M.clickY=y}}},{key:"handleDelete",value:function(g){var d;(d=this.layer)!==null&&d!==void 0&&d.tool&&g&&g.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var g,d;this.handleOutside(),(g=this.annotationContainer)===null||g===void 0||g.remove(),this.annotation.isDelete=!0,this.annotation.name&&((d=this.layer)===null||d===void 0||d.deleteAnnotationInLayer({name:this.annotation.name}))}},{key:"handleMouseUp",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(d.button===0||d.type!=="mouseup"){M.next=2;break}return M.abrupt("return");case 2:if((f=this.layer)!==null&&f!==void 0&&f.tool&&d.stopPropagation(),d.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,(y=this.annotation).measure&&this.documentViewer.annotationStore.selectedElementName===y.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){M.next=36;break}return x={type:"delete",annotation:{operate:"del-annot",name:y.name,pageIndex:y.pageIndex,annotPtr:y.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",x),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(k=Object.assign({},y)).annotPtr,delete k.pagePtr,delete k.name,k.operate="add-annot",k.pageIndex=this.PageNumber-1,M.next=26,this.documentViewer.annotationManager.createMeasurementAnnotation(k);case 26:return P=M.sent,S=new n({annotation:P[0],documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),M.next=31,this.documentViewer.annotationManager.addAnnotation(S);case 31:this.documentViewer.annotationManager.drawAnnotationsFromList(S),this.annotationContainer.remove(),this.outerLineContainer.remove(),M.next=40;break;case 36:return E={operate:"mod-annot",name:y.name,pageIndex:this.PageNumber-1,pagePtr:y.pagePtr,annotPtr:y.annotPtr,rect:y.rect,inkPointes:y.inkPointes,borderWidth:y.borderWidth,borderColor:y.borderColor,opacity:y.opacity},M.next=39,this.documentViewer.annotationManager.editMeasurementAnnotation(E);case 39:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 40:case"end":return M.stop()}},g,this)})),function(g){return m.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"draw",value:function(){this.layer&&(this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer),this.update())}},{key:"update",value:function(g){var d=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.updateRect(),this.updateInkPoints();var f=this.rect;this.annotationContainer.style.top=f.top+"px",this.annotationContainer.style.left=f.left+"px",this.annotationContainer.style.width=f.width+"px",this.annotationContainer.style.height=f.height+"px",this.svgElement.setAttribute("width",f.width),this.svgElement.setAttribute("height",f.height),this.svgElement.setAttribute("viewBox","".concat(f.left," ").concat(f.top," ").concat(f.width," ").concat(f.height)),this.shapeEle.setAttribute("stroke-width",this.borderWidth*this.documentViewer.scale),this.outerLine.setAttribute("height",f.height),this.outerLine.setAttribute("viewBox","".concat(f.left," ").concat(f.top," ").concat(f.width," ").concat(f.height)),this.outerLine.style.left="".concat(f.left,"px"),this.outerLine.style.top="".concat(f.top,"px"),this.outerLine.style.width="".concat(f.width,"px"),this.outerLine.style.height="".concat(f.height,"px"),this.deletetButton&&(this.deletetButton.style.left=f.left+f.width+MARGIN_DISTANCE-30+"px",this.deletetButton.style.top=f.top-MARGIN_DISTANCE-30+"px"),this.replyButton&&(this.replyButton.style.left=f.left+f.width+MARGIN_DISTANCE-65+"px",this.replyButton.style.top=f.top-MARGIN_DISTANCE-30+"px"),this.updateCircle(g!=null?g:null),this.annotation.measure&&d&&this.updateMeasure()}},{key:"updateMeasure",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var d;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.startState||this.startState.operator==="move"){f.next=6;break}return d={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:this.annotation.rect,inkPointes:this.annotation.inkPointes,borderWidth:this.annotation.borderWidth,borderColor:this.annotation.borderColor,opacity:this.annotation.opacity},this.annotation.contents&&(d.contents=this.annotation.contents),f.next=5,this.documentViewer.annotationManager.editMeasurementAnnotation(d);case 5:this.getResult();case 6:if(!this.startState||this.startState.operator!=="move"){f.next=8;break}return f.abrupt("return");case 8:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter});case 9:case"end":return f.stop()}},g,this)})),function(){return w.apply(this,arguments)})},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(f=this.annotation,this.documentViewer.annotationStore.selectedElementName===f.name){k.next=3;break}return k.abrupt("return");case 3:y=0,k.t0=_regeneratorRuntime().keys(d);case 5:if((k.t1=k.t0()).done){k.next=13;break}return x=k.t1.value,k.t2=y,k.next=10,this.setCustomData(x,d[x],!0);case 10:y=k.t2+=k.sent,k.next=5;break;case 13:y>0&&this.sendData(d);case 14:case"end":return k.stop()}},g,this)})),function(g){return s.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(g){var d=this.annotation,f=_objectSpread2$1({operate:"mod-annot",name:d.name,pageIndex:this.PageNumber-1,pagePtr:d.pagePtr,annotPtr:d.annotPtr},g);d.measure?(f.type="ink",f.rulerPtr=d.rulerPtr,this.documentViewer.annotationManager.editMeasurementAnnotation(f)):(f.type="arc",this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:f})),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(g){g!==this.contents&&(this.annotation.contents=g,this.measure&&(this.textEle.textContent=g),this.setAnnotationChanged({contents:g}))}},{key:"color",get:function(){return this.annotation.color},set:function(g){var d=this.annotation;this.textEle.setAttribute("fill",g),d.color=g,this.setAnnotationChanged({color:g,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(g){var d=this.annotation;if(d.fontSize=g,this.measure){var f=this.calculateLinePoints(),y=Math.floor(f.length/2),x={x:f[y-1].x,y:f[y-1].y},k={x:f[y].x,y:f[y].y},P={x:(x.x+k.x)/2,y:(x.y+k.y)/2},S=Math.atan2(k.y-x.y,k.x-x.x)/Math.PI*180,E=Math.abs(S)>90?S-180:S;this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(g,"px)"),this.textEle.setAttribute("x",P.x),this.textEle.setAttribute("y",P.y+g),this.textEle.setAttribute("transform","rotate(".concat(E," ").concat(P.x," ").concat(P.y,")"))}this.setAnnotationChanged({color:d.color,fontSize:g,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(g){var d=this.annotation;this.measure&&(this.textEle.style.fontFamily=g),d.fontName=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:g,fontStyle:d.fontStyle,fontWeight:d.fontWeight})}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(g){var d=this.annotation;this.measure&&(this.textEle.style.fontStyle=g),d.fontStyle=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:g,fontWeight:d.fontWeight})}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(g){var d=this.annotation;this.measure&&(this.textEle.style.fontWeight=g),d.fontWeight=g,this.setAnnotationChanged({color:d.color,fontSize:d.fontSize,fontName:d.fontName,fontStyle:d.fontStyle,fontWeight:g})}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(g){this.svgElement.style.opacity=g,this.annotation.opacity=g,this.setAnnotationChanged({opacity:g})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(g){var d=this.annotation;g==="solid"?this.shapeEle.setAttribute("stroke-dasharray",""):g==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),d.borderStyle=g,this.setAnnotationChanged({borderStyle:g,borderWidth:d.borderWidth,dashes:d.dashes||"2,2"})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(g){var d=this.annotation;d.dashes=g;var f=this.getDashString();d.borderStyle==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",f),this.setAnnotationChanged({borderStyle:d.borderStyle,borderWidth:d.borderWidth,dashes:g})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(g){this.annotation.borderWidth=g,this.shapeEle.setAttribute("stroke-width",g*this.documentViewer.scale),this.update({start:this.start,end:this.end},!1),this.setAnnotationChanged({borderWidth:g})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(g){this.shapeEle.setAttribute("stroke",g),this.annotation.borderColor=g,this.setAnnotationChanged({borderColor:g})}},{key:"setCustomData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function g(d,f){var y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z=arguments;return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:y=Z.length>2&&Z[2]!==void 0&&Z[2],x=this.annotation,k=0,j.t0=_regeneratorRuntime().keys(x);case 4:if((j.t1=j.t0()).done){j.next=35;break}if((P=j.t1.value)!==d||this.annotation[P]===f){j.next=33;break}if(x[P]=f,k=1,d==="borderColor"&&this.shapeEle.setAttribute("stroke",f),d==="opacity"&&(this.svgElement.style.opacity=f),d==="borderWidth"&&(this.shapeEle.setAttribute("stroke-width",f*this.documentViewer.scale),this.update({start:this.start,end:this.end},!1),this.showPopup(),S=this.calculateLinePoints(),E=Math.floor(S.length/2),M={x:S[E-1].x,y:S[E-1].y},T={x:S[E].x,y:S[E].y},D={x:(M.x+T.x)/2,y:(M.y+T.y)/2+x.borderWidth},N=Math.atan2(T.y-M.y,T.x-M.x)/Math.PI*180,I=Math.abs(N)>90?N-180:N,this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(x.fontSize,"px)"),this.textEle.setAttribute("x",D.x),this.textEle.setAttribute("y",D.y+x.fontSize),this.textEle.setAttribute("transform","rotate(".concat(I," ").concat(D.x," ").concat(D.y,")"))),d==="borderStyle"&&(f==="solid"&&this.shapeEle.setAttribute("stroke-dasharray",""),f==="dashed"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString())),d==="dashes"&&this.shapeEle.setAttribute("stroke-dasharray",this.getDashString()),d==="color"&&this.textEle.setAttribute("fill",f),d==="fontSize"&&(O=this.calculateLinePoints(),F=Math.floor(O.length/2),q={x:O[F-1].x,y:O[F-1].y},Y={x:O[F].x,y:O[F].y},_e={x:(q.x+Y.x)/2,y:(q.y+Y.y)/2+x.borderWidth},ne=Math.atan2(Y.y-q.y,Y.x-q.x)/Math.PI*180,ve=Math.abs(ne)>90?ne-180:ne,this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(f,"px)"),this.textEle.setAttribute("x",_e.x),this.textEle.setAttribute("y",_e.y+x.fontSize),this.textEle.setAttribute("transform","rotate(".concat(ve," ").concat(_e.x," ").concat(_e.y,")"))),d==="fontName"&&(this.textEle.style.fontFamily=f),d==="fontStyle"&&(this.textEle.style.fontStyle=f),d==="fontWeight"&&(this.textEle.style.fontWeight=f),d==="contents"&&(this.textEle.textContent=f),d!=="scale"&&d!=="precision"){j.next=33;break}return d==="precision"&&(this.decimalPlaces=((J=Math.abs(x.precision).toString().split(".")[1])===null||J===void 0?void 0:J.length)||0),this.getResult(),j.next=25,this.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1(_defineProperty$1(_defineProperty$1({rulerPtr:x.rulerPtr},d,f),"annotPtr",x.annotPtr),"contents",x.contents));case 25:return j.next=27,this.documentViewer.messageHandler.sendWithPromise("GetFactor",x.rulerPtr);case 27:fe=j.sent,x.factor=fe,this.textEle&&(this.textEle.textContent=x.contents),this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||document.querySelector(".measure-panel").classList.contains("closed")||this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:f,length:x.perimeter}),k=0;case 33:j.next=4;break;case 35:return!y&&this.sendData(_defineProperty$1({},d,f)),j.abrupt("return",k);case 37:case"end":return j.stop()}},g,this)})),function(g,d){return u.apply(this,arguments)})},{key:"sendData",value:function(g){var d=this.annotation,f={pagePtr:d.pagePtr,annotPtr:d.annotPtr,rulerPtr:d.rulerPtr,pageIndex:d.pageIndex,inkPointes:d.inkPointes,borderWidth:d.borderWidth,borderColor:d.borderColor,opacity:d.opacity,contents:d.contents};["fontSize","fontName","color","fontStyle","fontWeight"].some(function(x){return g[x]})&&(f.fontSize=d.fontSize,f.color=d.color,f.fontName=d.fontName,f.fontStyle=d.fontStyle,f.fontWeight=d.fontWeight),g.dashes&&(f.borderStyle=d.borderStyle,f.borderWidth=d.borderWidth),g.borderStyle&&(f.dashes=g.borderStyle==="solid"?"":d.dashes,f.borderWidth=d.borderWidth);var y=Object.assign({},f,g);this.documentViewer.annotationManager.editMeasurementAnnotation(y)}},{key:"getResult",value:function(){for(var g=this,d=_slicedToArray(this.realVertices.map(function(I){return getInitialPoint$1(I,g.documentViewer.scale)}),4),f=d[0],y=d[1],x=d[2],k=d[3],P=0,S={x:f.x,y:f.y},E=1;E<=200;E++){var M=E/200,T={x:Math.pow(1-M,3)*f.x+3*Math.pow(1-M,2)*M*y.x+3*(1-M)*Math.pow(M,2)*x.x+Math.pow(M,3)*k.x,y:Math.pow(1-M,3)*f.y+3*Math.pow(1-M,2)*M*y.y+3*(1-M)*Math.pow(M,2)*x.y+Math.pow(M,3)*k.y},D=T.x-S.x,N=T.y-S.y;P+=Math.sqrt(D*D+N*N),S=T}P=this.formatValue(P*this.annotation.factor),this.annotation.perimeter=P,this.annotation.contents=P.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit}},{key:"showPopup",value:function(){if(this.layer){var g=this.layer.div.getBoundingClientRect(),d=g.left+this.rect.left,f=this.rect.top+g.top,y={left:d,top:f,right:d+this.rect.width,bottom:f+this.rect.height};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:y}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f,y=this;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d==="delete"&&this.handleDelete(),d==="reply"&&(this.openReply(),(f=document.getElementById("leftPanel"))!=null&&f.classList.contains("closed")&&setTimeout(function(){y.showPopup()},350));case 2:case"end":return x.stop()}},g,this)})),function(g){return r.apply(this,arguments)})},{key:"formatValue",value:function(g){return g%1==0?g:Number(g.toFixed(this.decimalPlaces))}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function g(d){var f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"){y.next=2;break}return y.abrupt("return");case 2:(f=d.keyCode||d.which)!==8&&f!==46||this.handleDelete();case 4:case"end":return y.stop()}},g,this)})),function(g){return o.apply(this,arguments)})},{key:"updateRect",value:function(){var g=this,d=this.realVertices.map(function(P){return getInitialPoint$1(P,g.documentViewer.scale)});this.annotation.rect=this.rectCalcByVertices(d);var f=this.getActualRect(this.documentViewer.scale),y=f.start,x=f.end;this.start=y,this.end=x;var k=this.calculate(y,x);this.rect=k}},{key:"renderAnnot",value:function(){var g=this.annotation,d=this.documentViewer.scale,f=g.borderWidth*d,y=g.borderStyle==="dashed"?this.getDashString():"";this.svgElement.innerHTML="";var x=_slicedToArray(this.realVertices,4),k=x[0],P=x[1],S=x[2],E=x[3];this.shapeEle=createSvg("path",{stroke:g.borderColor,"stroke-width":f,"stroke-dasharray":y,fill:"transparent",d:"M".concat(k.x,",").concat(k.y," C").concat(P.x,",").concat(P.y," ").concat(S.x,",").concat(S.y," ").concat(E.x,",").concat(E.y)});var M=this.calculateLinePoints(),T=Math.floor(M.length/2),D=M[T-1].x,N=M[T-1].y,I=M[T].x,O=M[T].y,F={x:(D+I)/2,y:(N+O)/2+f},q=Math.atan2(O-N,I-D)/Math.PI*180,Y=Math.abs(q)>90?q-180:q;this.textEle=createSvg("text",{fill:g.color||g.borderColor,"text-anchor":"middle","dominant-baseline":"middle",x:F.x,y:F.y+g.fontSize,transform:"rotate(".concat(Y," ").concat(F.x," ").concat(F.y,")")},{"font-size":"calc(var(--scale-factor) * ".concat(g.fontSize,"px)"),pointerEvents:"none"}),this.textEle.textContent=g.contents,this.svgElement.append(this.shapeEle),this.svgElement.append(this.textEle)}},{key:"updateCircle",value:function(g){if(Number.isFinite(g)&&g<this.realVertices.length-1&&g>=0){var d=this.realVertices[g],f=d.x,y=d.y,x=this.outerLine.querySelector('circle[data-id="point'+g+'"]');return x.setAttribute("cx",f),void x.setAttribute("cy",y)}this.outerLineContainer.querySelectorAll("circle").forEach(function(E){return E.remove()});for(var k=0;k<this.realVertices.length;k++){var P=this.realVertices[k],S=createSvg("circle",{"data-id":"point"+k,fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:P.x,cy:P.y,r:6},{cursor:"default"});this.outerLine.append(S)}}},{key:"setPathPoint",value:function(g,d,f){if(!(g>this.realVertices.length-1||g<0)){var y=this.annotation;this.realVertices[g].x=d,this.realVertices[g].y=f;var x=_slicedToArray(this.realVertices,4),k=x[0],P=x[1],S=x[2],E=x[3];this.shapeEle.setAttribute("d","M".concat(k.x,",").concat(k.y," C").concat(P.x,",").concat(P.y," ").concat(S.x,",").concat(S.y," ").concat(E.x,",").concat(E.y)),this.updateRect(),this.updateInkPoints(),this.getResult();var M=this.calculateLinePoints(),T=Math.floor(M.length/2),D=M[T-1].x,N=M[T-1].y,I=M[T].x,O=M[T].y,F={x:(D+I)/2,y:(N+O)/2+y.borderWidth},q=Math.atan2(O-N,I-D)/Math.PI*180,Y=Math.abs(q)>90?q-180:q;this.textEle.setAttribute("x",F.x),this.textEle.setAttribute("y",F.y+y.fontSize),this.textEle.setAttribute("transform","rotate(".concat(Y," ").concat(F.x," ").concat(F.y,")")),this.textEle.textContent=y.contents,this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,length:this.annotation.perimeter})}}},{key:"calculateLinePoints",value:function(){for(var g=_slicedToArray(this.realVertices,4),d=g[0],f=g[1],y=g[2],x=g[3],k=[],P=0;P<=1;P+=.01){var S=Math.pow(1-P,3)*d.x+3*Math.pow(1-P,2)*P*f.x+3*(1-P)*Math.pow(P,2)*y.x+Math.pow(P,3)*x.x,E=Math.pow(1-P,3)*d.y+3*Math.pow(1-P,2)*P*f.y+3*(1-P)*Math.pow(P,2)*y.y+Math.pow(P,3)*x.y;k.push({x:S,y:E})}return k.push(x),_toConsumableArray$1(new Map(k.map(function(M){return[M.x+M.y,M]})).values())}},{key:"calculateEqualPoints",value:function(){var g=this.realVertices[0],d=this.realVertices[3],f=1/3,y=2/3,x={x:g.x+f*(d.x-g.x),y:g.y+f*(d.y-g.y)},k={x:g.x+y*(d.x-g.x),y:g.y+y*(d.y-g.y)};this.realVertices[1]=x,this.realVertices[2]=k}},{key:"updateInkPoints",value:function(){var g=this;this.annotation.inkPointes[0]=this.realVertices.map(function(d){var f=getInitialPoint$1(d,g.documentViewer.scale);return{PointX:f.x,PointY:f.y}})}}]);var o,r,u,s,w,m,v}(),Arc=function(e){function n(d){var f,y=d.annotation,x=d.documentViewer,k=d.show,P=k!==void 0&&k,S=d.enableReply,E=S===void 0||S;return _classCallCheck(this,n),(f=_callSuper(this,n,[{annotation:y,documentViewer:x}])).type=y.measure?"ink":"arc",f.show=P,f.enableReply=E,f.hidden=!0,f.initial=!1,f.start=null,f.end=null,f.rect=null,f.realVertices=null,f.svgElement=null,f.ratio=window.devicePixelRatio||1,f.decimalPlaces=0,f.showRadius=f.documentViewer.annotationStore.arc.showRadius,f.showArcLength=f.documentViewer.annotationStore.arc.showArcLength,f.showAngle=f.documentViewer.annotationStore.arc.showAngle,f.isPopupShow=!1,f.inkPoints=null,f.selectionOutlineBdWidth=1,f.onClick=f.handleClick.bind(f),f.onMousedown=f.handleMouseDown.bind(f),f.onMouseup=f.handleMouseUp.bind(f),f.onMousemove=f.handleMouseMove.bind(f),f.onDelete=f.handleDelete.bind(f),f.onOpenReply=f.openReply.bind(f),f.handlePropertyPanel=f.handlePropertyPanel.bind(f),f.onHandlePopup=f.handlePopup.bind(f),f.onKeydown=f.handleKeyDown.bind(f),f.render(),f}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"render",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y,x,k,P,S=this;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(f=this.annotation,y=this.documentViewer.scale,f.vertices&&(f.arcPoints=f.vertices,delete f.vertices),this.realVertices=this.annotation.arcPoints.map(function(M){return getActualPoint$1(M,y)}),this.updateRect(),x=this.rect,["showRadius","showArcLength","showAngle"].forEach(function(M){f[M]!==void 0&&(S[M]=f[M],delete f[M])}),f.precision&&(f.precision>1&&(f.precision=Math.pow(10,-Math.floor(Math.log10(f.precision)))),this.decimalPlaces=((k=Math.abs(f.precision).toString().split(".")[1])===null||k===void 0?void 0:k.length)||0),f.borderColor||(f.borderColor=f.color||"#FF0000"),f.factor||!f.measure){E.next=14;break}return E.next=13,this.documentViewer.messageHandler.sendWithPromise("GetFactor",f.rulerPtr);case 13:f.factor=E.sent;case 14:f.fontStyle||(f.fontStyle="regular"),!f.contents&&f.measure&&this.getResult(),this.annotationContainer=createElement("div",{top:x.top+"px",left:x.left+"px",width:x.width+"px",height:x.height+"px"},{id:f.name,class:"annotation"}),this.svgElement=createSvg("svg",{viewBox:"".concat(x.left," ").concat(x.top," ").concat(x.width," ").concat(x.height)},{pointerEvents:"all",overflow:"visible",opacity:f.opacity?f.opacity:""}),this.annotationContainer.append(this.svgElement),this.svgElement.addEventListener("mousedown",this.onClick),this.renderAnnot(),this.outerLineContainer=createElement("div",{},{class:"outline-container"}),this.outerLine=createSvg("svg",{"data-id":"move",width:x.width,height:x.height,viewBox:"".concat(x.left," ").concat(x.top," ").concat(x.width," ").concat(x.height)},{position:"absolute",zIndex:1,left:"".concat(x.left,"px"),top:"".concat(x.top,"px"),width:"".concat(x.width,"px"),height:"".concat(x.height,"px"),border:"".concat(this.selectionOutlineBdWidth,"px ").concat(f.measure?"dashed":"solid"," #1460F3"),pointerEvents:"all",cursor:"all-scroll",overflow:"visible"}),f.measure||(this.popupElement=createElement("div",{left:x.left+x.width-114+"px",top:x.top+x.height+12+"px"},{class:"popupElement"}),this.attrbuteElement=createElement("div",{width:"30px",height:"30px"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),this.deletetButton=createElement("div",{width:"30px",height:"30px"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.replyButton=createElement("div",{width:"30px",height:"30px"},{class:"reply-button"}),this.replyButton.addEventListener("click",this.onOpenReply),this.replyButton.innerHTML=this.replySvgStr,P=this.documentViewer.isAnnotationPopup,this.enableReply&&this.popupElement.append(this.replyButton),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),P&&this.outerLineContainer.append(this.popupElement)),this.outerLineContainer.append(this.outerLine),this.updateCircle(),this.initial=!0,this.show&&this.layer&&!this.layer.addMode&&this.selectAnnotation(),this.show=!1;case 29:case"end":return E.stop()}},d,this)})),function(){return g.apply(this,arguments)})},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleClick()}},{key:"setPopupElementStyle",value:function(){var d,f,y=this.rect;this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?((d=this.layer)===null||d===void 0||d.div.classList.remove("no-edit"),this.setCss(this.popupElement,{left:y.left+y.width-114+"px"})):((f=this.layer)===null||f===void 0||f.div.classList.add("no-edit"),this.setCss(this.popupElement,{left:y.left+y.width-46+"px"}))}},{key:"handleClick",value:function(d){if(this.setPopupElementStyle(),this.hidden&&!this.documentViewer.annotationStore.creating&&!["redaction","remove"].includes(this.layer.tool)&&!document.querySelector(".compare-document-container").contains(d==null?void 0:d.target)){this.hidden=!1,this.updateTool(),this.annotation.measure?(this.documentViewer.eventBus._on("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._on("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._on("annotationPropertyChanged",this.handlePropertyPanel),document.addEventListener("keydown",this.onKeydown);var f=[this.svgElement,this.outerLine,document.querySelector(".measure-panel"),document.querySelector(".measurement-board"),document.querySelector(".measurements-settings"),document.querySelector(".measurement-popup")];this.popupElement&&f.push(this.popupElement);var y=document.getElementById(this.annotation.measure?"measurePropertyPanelButton":"annotationPropertyPanelButton");y&&f.push(y);var x=document.querySelector(".toggle-button");x&&f.push(x),onClickOutside$1(f,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var d,f,y,x,k=this.documentViewer.annotationStore.selectedElementName,P=this.annotation.name;!this.hidden&&this.annotation.measure&&k===P&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(x=this.documentViewer)===null||x===void 0||(x=x.pdfViewer)===null||x===void 0||(x=x.measurementTool)===null||x===void 0||x.updateMeasurePanel(),this.hidePopup()),k===P&&(this.documentViewer.annotationStore.selectedElementName=null),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,document.removeEventListener("keydown",this.onKeydown),(d=this.outerLine)===null||d===void 0||d.removeEventListener("mousedown",this.onMousedown),(f=this.outerLine)===null||f===void 0||f.removeEventListener("touchstart",this.onMousedown),(y=this.outerLineContainer)===null||y===void 0||y.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto",this.annotation.measure?(this.documentViewer.eventBus._off("measurePropertyPanelChanged",this.handlePropertyPanel),this.documentViewer.eventBus._off("measurementPopupClicked",this.onHandlePopup)):this.documentViewer.eventBus._off("annotationPropertyChanged",this.handlePropertyPanel)}},{key:"getActualRect",value:function(d){var f=this.annotation.rect,y=f.left,x=f.top,k=f.right,P=f.bottom;return{start:getActualPoint$1({x:y,y:x},d),end:getActualPoint$1({x:k,y:P},d)}}},{key:"getInitialPoint",value:function(){var d=this.documentViewer.scale;return{start:{x:this.start.x/d,y:this.start.y/d},end:{x:this.end.x/d,y:this.end.y/d}}}},{key:"calculate",value:function(d,f){var y=this.rectCalc({start:d,end:f}),x=this.annotation.borderWidth*this.documentViewer.scale;return{top:y.top-x,left:y.left-x,width:y.width+2*x,height:y.height+2*x}}},{key:"rectCalc",value:function(d){var f=d.start,y=d.end;return{top:f.y<y.y?f.y:y.y,left:f.x<y.x?f.x:y.x,width:Math.abs(y.x-f.x),height:Math.abs(y.y-f.y)}}},{key:"rectCalcByVertices",value:function(d){var f=d.map(function(x){return x.x}),y=d.map(function(x){return x.y});return{left:Math.min.apply(Math,_toConsumableArray$1(f)),top:Math.min.apply(Math,_toConsumableArray$1(y)),right:Math.max.apply(Math,_toConsumableArray$1(f)),bottom:Math.max.apply(Math,_toConsumableArray$1(y))}}},{key:"updateTool",value:function(){if(this.initial)if(this.hidden)this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null),this.outerLineContainer.remove(),document.removeEventListener("keydown",this.onKeydown);else{if(this.documentViewer.annotationStore.selectedElementName!==this.annotation.name){var d=this.annotation;this.documentViewer.annotationStore.selectedElementName=d.name;var f=_objectSpread2$1({},d);delete f.annotPtr,delete f.pagePtr,delete f.operate,delete f.targetPage,delete f.arrow,this.documentViewer.eventBus.dispatch("annotationSelected",f)}this.layer&&this.layer.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("touchstart",this.onMousedown),document.addEventListener("keydown",this.onKeydown),this.annotation.measure&&(this.documentViewer.eventBus.dispatch("changeRightPanelBtnDisabled"),this.documentViewer.eventBus.dispatch("measurePropertyChange",this.annotation),this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,arcLength:this.annotation.arcLength,angle:this.annotation.angle||0,radius:this.annotation.radius,showRadius:this.showRadius,showArcLength:this.showArcLength,showAngle:this.showAngle}),this.showPopup()),this.documentViewer.getScrollViewElement().style.touchAction="none"}}},{key:"handleMouseDown",value:function(d){if(d.button===0||d.type!=="mousedown"){this.layer.tool&&d.stopPropagation();var f=d.target.getAttribute("data-id"),y=this.documentViewer.getScrollViewElement();this.scrollTop=y.scrollTop,this.scrollLeft=y.scrollLeft;var x=getClickPoint(d),k=x.pageX,P=x.pageY;this.startState={operator:f,clickX:k,clickY:P},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(d){if(d.button===0||d.type!=="mousemove"){this.hidePopup(),d.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var f=getClickPoint(d),y=f.pageX,x=f.pageY,k=this.documentViewer,P=k.getScrollViewElement(),S=P.scrollTop;y=y+P.scrollLeft-this.scrollLeft,x=x+S-this.scrollTop;var E=2*this.selectionOutlineBdWidth,M=this.start,T=this.end,D=this.startState,N=k.scale,I=k.getPageWidth(this.PageNumber)*N,O=k.getPageHeight(this.PageNumber)*N,F=/^point(\d+)$/.exec(D.operator);if(F){var q=+F[1],Y=this.realVertices[q],_e=y-(D.clickX-Y.x),ne=x-(D.clickY-Y.y);_e=Math.min(I-E,_e),_e=Math.max(E,_e),ne=Math.min(O-E,ne),ne=Math.max(E,ne),this.setPathPoint(q,_e,ne),this.update(q,!1)}else if(D.operator==="move"){var ve,J,fe,Z,j=this.documentViewer,X=this.getMouseLocation(d),H=j.getSelectedPage(X,X);if(H.first&&H.first!==this.getPageNumber()){var U=j.windowToPage(X,H.first,!1),te=Math.abs(M.x-T.x),Q=Math.abs(M.y-T.y);if(j.pdfViewer.spreadMode===0&&j.pdfViewer.scrollMode===0)ve=y-(D.clickX-this.start.x),J=H.first>this.getPageNumber()?U.y:U.y-Q,fe=y-(D.clickX-this.end.x),Z=H.first>this.getPageNumber()?U.y+Q:U.y;else if(j.pdfViewer.spreadMode===0&&j.pdfViewer.scrollMode===1)ve=H.first>this.getPageNumber()?U.x:U.x-te,J=x-(D.clickY-this.start.y),fe=H.first>this.getPageNumber()?U.x+te:U.x,Z=x-(D.clickY-this.end.y);else if(j.pdfViewer.spreadMode===1&&j.pdfViewer.scrollMode===0){var re=Math.min(H.first,this.getPageNumber()),Pe=Math.max(H.first,this.getPageNumber());if(Pe-re>2||re+1===Pe&&re%2==0)return;re+1===Pe?(ve=H.first>this.getPageNumber()?U.x:U.x-te,J=x-(D.clickY-this.start.y),fe=H.first>this.getPageNumber()?U.x+te:U.x,Z=x-(D.clickY-this.end.y)):re+2===Pe&&(ve=y-(D.clickX-this.start.x),J=H.first>this.getPageNumber()?U.y:U.y-Q,fe=y-(D.clickX-this.end.x),Z=H.first>this.getPageNumber()?U.y+Q:U.y)}else if(j.pdfViewer.spreadMode===2&&j.pdfViewer.scrollMode===0){var be=Math.min(H.first,this.getPageNumber()),we=Math.max(H.first,this.getPageNumber());if(we-be>2||be+1===we&&(be!==1||we!==2)&&we%2==0||be===1&&we===3)return;be+2===we||be===1&&we===2?(ve=y-(D.clickX-this.start.x),J=H.first>this.getPageNumber()?U.y:U.y-Q,fe=y-(D.clickX-this.end.x),Z=H.first>this.getPageNumber()?U.y+Q:U.y):be+1===we&&(ve=H.first>this.getPageNumber()?U.x:U.x-te,J=x-(D.clickY-this.start.y),fe=H.first>this.getPageNumber()?U.x+te:U.x,Z=x-(D.clickY-this.end.y))}if(!j.pdfViewer._pages[H.first-1].compdfAnnotationLayer)return;this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=H.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Ae=this.layer.div;Ae.append(this.annotationContainer),Ae.append(this.outerLineContainer)}else{ve=y-(D.clickX-this.start.x),J=x-(D.clickY-this.start.y),fe=y-(D.clickX-this.end.x),Z=x-(D.clickY-this.end.y);var $e=j.pageToWindow({x:ve,y:J},this.getPageNumber(),!1),Me=j.pageToWindow({x:fe,y:Z},this.getPageNumber(),!1),Ie=0,Le=0;x>D.clickY?Le=(Le=P.offsetHeight-(Me.y-P.scrollTop-P.offsetTop))<100?5:0:x<D.clickY&&(Le=(Le=$e.y-P.scrollTop-P.offsetTop)<100?-5:0),y>D.clickX?Ie=(Ie=P.offsetWidth-(Me.x-P.scrollLeft-P.offsetLeft))<100?5:0:y<D.clickX&&(Ie=(Ie=$e.x-P.scrollLeft-P.offsetLeft)<100?-5:0),(Ie||Le)&&(P.scrollTop+=Le,P.scrollLeft+=Ie);var le=this.annotation.borderWidth*this.documentViewer.scale;ve<fe?(ve=Math.max(E,ve),ve=Math.min(I-this.rect.width+le,ve),fe=Math.max(this.rect.width,fe),fe=Math.min(I,fe)):(fe=Math.max(E,fe),fe=Math.min(I-this.rect.width+le,fe),ve=Math.max(this.rect.width,ve),ve=Math.min(I,ve)),J<Z?(J=Math.max(E,J),J=Math.min(O-this.rect.height+le,J),Z=Math.max(this.rect.height,Z),Z=Math.min(O,Z)):(Z=Math.max(E,Z),Z=Math.min(O-this.rect.height+le,Z),J=Math.max(this.rect.height,J),J=Math.min(O,J))}for(var oe=ve-M.x,ke=J-M.y,Ce=0;Ce<this.realVertices.length;Ce++){var Ee=this.realVertices[Ce],Be=Ee.x+oe,Ve=Ee.y+ke;this.setPathPoint(Ce,Be,Ve)}this.update(null,!1)}D.clickX=y,D.clickY=x}}},{key:"handleDelete",value:function(d){this.layer&&this.layer.tool&&d&&d.stopPropagation(),this.delete();var f={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.getPageNumber()-1}};this.annotation.annotPtr&&(f.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this)}},{key:"delete",value:function(){var d;this.handleOutside(),(d=this.annotationContainer)===null||d===void 0||d.remove(),this.annotation.isDelete=!0,this.annotation.name&&this.layer&&this.layer.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"handleMouseUp",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P,S,E,M;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(f.button===0||f.type!=="mouseup"){T.next=2;break}return T.abrupt("return");case 2:if((y=this.layer)!==null&&y!==void 0&&y.tool&&f.stopPropagation(),f.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,(x=this.annotation).measure&&this.documentViewer.annotationStore.selectedElementName===x.name&&this.showPopup(),this.PrePageNumber===this.PageNumber){T.next=41;break}if(k={type:"delete",annotation:{operate:"del-annot",name:x.name,pageIndex:x.pageIndex,annotPtr:x.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",k),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(P=Object.assign({},x)).annotPtr,delete P.pagePtr,delete P.name,P.operate="add-annot",P.pageIndex=this.PageNumber-1,!this.annotation.measure){T.next=30;break}return T.next=27,this.documentViewer.annotationManager.createMeasurementAnnotation(P);case 27:S=T.sent,T.next=33;break;case 30:return T.next=32,this.documentViewer.annotationManager.createAnnotation(P);case 32:S=T.sent;case 33:E=new n({annotation:S,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),this.documentViewer.annotationManager.addAnnotation(E),this.documentViewer.annotationManager.drawAnnotationsFromList(E),this.annotationContainer.remove(),this.outerLineContainer.remove(),T.next=52;break;case 41:if(M={operate:"mod-annot",name:x.name,pageIndex:this.PageNumber-1,pagePtr:x.pagePtr,annotPtr:x.annotPtr,arcPoints:this.changedArcPoints,rect:x.rect},x.contents&&(M.contents=x.contents),!x.measure){T.next=50;break}return(M=_objectSpread2$1(_objectSpread2$1({},M),{},{inkPointes:x.inkPointes,borderWidth:x.borderWidth,borderColor:x.borderColor,opacity:x.opacity})).rulerPtr=x.rulerPtr,T.next=48,this.documentViewer.annotationManager.editMeasurementAnnotation(M);case 48:T.next=51;break;case 50:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:M});case 51:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 52:case"end":return T.stop()}},d,this)})),function(d){return v.apply(this,arguments)})},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"draw",value:function(){var d=this;this.layer&&(this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer),this.realVertices=this.annotation.arcPoints.map(function(f){return getActualPoint$1(f,d.documentViewer.scale)}),this.update(null,!1))}},{key:"update",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k,P,S,E,M,T,D,N,I,O,F,q=arguments;return _regeneratorRuntime().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(S=!(q.length>1&&q[1]!==void 0)||q[1],!(this.realVertices.length<3)){Y.next=3;break}return Y.abrupt("return");case 3:if(this.annotation.measure&&this.updateMeasure(S),this.updateRect(),E=this.rect,M=(this.annotation.borderWidth||2)*this.documentViewer.scale,this.annotationContainer.style.top=E.top+"px",this.annotationContainer.style.left=E.left+"px",this.annotationContainer.style.width=E.width+"px",this.annotationContainer.style.height=E.height+"px",this.svgElement.setAttribute("width",E.width),this.svgElement.setAttribute("height",E.height),this.svgElement.setAttribute("viewBox","".concat(E.left," ").concat(E.top," ").concat(E.width," ").concat(E.height)),(y=this.arcEle)===null||y===void 0||y.setAttribute("stroke-width",M),(x=this.smallArcEle)===null||x===void 0||x.setAttribute("stroke-width",M),(k=this.startLineEle)===null||k===void 0||k.setAttribute("stroke-width",M),(P=this.endLineEle)===null||P===void 0||P.setAttribute("stroke-width",M),this.outerLine.setAttribute("height",E.height),this.outerLine.setAttribute("viewBox","".concat(E.left," ").concat(E.top," ").concat(E.width," ").concat(E.height)),this.outerLine.style.left="".concat(E.left,"px"),this.outerLine.style.top="".concat(E.top,"px"),this.outerLine.style.width="".concat(E.width,"px"),this.outerLine.style.height="".concat(E.height,"px"),this.popupElement&&(this.popupElement.style.left=E.left+E.width-114+"px"),this.popupElement&&(this.popupElement.style.top=E.top+E.height+12+"px"),this.deletetButton&&(this.deletetButton.style.left=E.left+E.width+MARGIN_DISTANCE-30+"px",this.deletetButton.style.top=E.top-MARGIN_DISTANCE-30+"px"),this.replyButton&&(this.replyButton.style.left=E.left+E.width+MARGIN_DISTANCE-65+"px",this.replyButton.style.top=E.top-MARGIN_DISTANCE-30+"px"),this.smallArcEle||!this.annotation.measure){Y.next=31;break}return this.renderAnnot(),Y.abrupt("return");case 31:if(T=_slicedToArray(this.realVertices,3),D=T[0],N=T[1],I=T[2],O=this.calculateCenter(D,N,I)){Y.next=35;break}return Y.abrupt("return");case 35:if(this.arcEle.setAttribute("d",this.describeArc(D,N,I,O)),this.updateCircle(f!=null?f:null),this.annotation.measure){Y.next=39;break}return Y.abrupt("return");case 39:this.smallArcEle.setAttribute("d",this.describeArc(D,N,I,O,.15)),this.startLineEle.setAttribute("x1",D.x),this.startLineEle.setAttribute("y1",D.y),this.startLineEle.setAttribute("x2",O.x),this.startLineEle.setAttribute("y2",O.y),this.endLineEle.setAttribute("x1",I.x),this.endLineEle.setAttribute("y1",I.y),this.endLineEle.setAttribute("x2",O.x),this.endLineEle.setAttribute("y2",O.y),F={x:(I.x+O.x)/2,y:(I.y+O.y)/2},this.arcLengthTspan&&(this.arcLengthTspan.setAttribute("x",F.x),this.arcLengthTspan.setAttribute("y",F.y),this.arcLengthTspan.textContent=this.annotation.arcLength.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit),this.angleTspan&&(this.angleTspan.setAttribute("x",F.x),this.angleTspan.setAttribute("y",F.y),this.angleTspan.textContent=this.annotation.angle+"\xB0"),this.radiusTspan&&(this.radiusTspan.setAttribute("x",F.x),this.radiusTspan.setAttribute("y",F.y),this.radiusTspan.textContent=this.annotation.radius.toFixed(this.decimalPlaces)+this.annotation.scale.translateUnit);case 52:case"end":return Y.stop()}},d,this)})),function(d){return m.apply(this,arguments)})},{key:"updateMeasure",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.documentViewer.annotationStore.creating||!this.annotation.annotPtr||!f){x.next=6;break}return y={pageIndex:this.getPageNumber()-1,pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,arcPoints:this.changedArcPoints,inkPointes:this.annotation.inkPointes,borderWidth:this.annotation.borderWidth,borderColor:this.annotation.borderColor,opacity:this.annotation.opacity},this.annotation.contents&&(y.contents=this.annotation.contents),x.next=5,this.documentViewer.annotationManager.editMeasurementAnnotation(y);case 5:this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 6:if(this.getResult(),!this.startState||this.startState.operator!=="move"){x.next=9;break}return x.abrupt("return");case 9:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,arcLength:this.annotation.arcLength,angle:this.annotation.angle||0,radius:this.annotation.radius});case 10:case"end":return x.stop()}},d,this)})),function(d){return w.apply(this,arguments)})},{key:"setAnnotationChanged",value:function(d){var f=this.annotation,y=_objectSpread2$1({operate:"mod-annot",name:f.name,pageIndex:this.PageNumber-1,pagePtr:f.pagePtr,annotPtr:f.annotPtr},d);f.measure?(y.type="ink",y.rulerPtr=f.rulerPtr,this.documentViewer.annotationManager.editMeasurementAnnotation(y)):(y.type="arc",this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:y})),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getContents",value:function(){return this.annotation.contents}},{key:"setContents",value:function(d){d!==this.contents&&(this.annotation.contents=d,this.measure&&(this.angleTspan&&(this.angleTspan.remove(),this.angleTspan=null),this.radiusTspan&&(this.radiusTspan.remove(),this.radiusTspan=null),this.arcLengthTspan||(this.arcLengthTspan=createSvg("tspan",{x:midpoint.x,y:midpoint.y,dy:"0em"}),this.textEle.appendChild(this.arcLengthTspan)),this.arcLengthTspan.textContent=value),this.setAnnotationChanged({contents:d}))}},{key:"color",get:function(){return this.annotation.color},set:function(d){var f,y=this.annotation;(f=this.textEle)===null||f===void 0||f.setAttribute("fill",d),y.color=y.strokeColor=d,this.setAnnotationChanged({color:d,fontSize:y.fontSize,fontName:y.fontName,fontStyle:y.fontStyle,fontWeight:y.fontWeight})}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(d){var f=this.annotation;this.measure&&(this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(d,"px)"),f.fontSize=d,this.setAnnotationChanged({color:f.color,fontSize:d,fontName:f.fontName,fontStyle:f.fontStyle,fontWeight:f.fontWeight}))}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(d){var f=this.annotation;this.measure&&(this.textEle.style.fontFamily=d,f.fontName=d,this.setAnnotationChanged({color:f.color,fontSize:f.fontSize,fontName:d,fontStyle:f.fontStyle,fontWeight:f.fontWeight}))}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(d){var f=this.annotation;this.measure&&(this.textEle.style.fontStyle=d,f.fontStyle=d,this.setAnnotationChanged({color:f.color,fontSize:f.fontSize,fontName:f.fontName,fontStyle:d,fontWeight:f.fontWeight}))}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(d){var f=this.annotation;this.measure&&(this.textEle.style.fontWeight=d,f.fontWeight=d,this.setAnnotationChanged({color:f.color,fontSize:f.fontSize,fontName:f.fontName,fontStyle:f.fontStyle,fontWeight:d}))}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(d){this.svgElement.style.opacity=d,this.annotation.opacity=d,this.setAnnotationChanged({opacity:d})}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(d){var f=this.annotation;if(d==="dashed"){var y,x,k,P=this.getDashString();this.arcEle.setAttribute("stroke-dasharray",P),(y=this.smallArcEle)===null||y===void 0||y.setAttribute("stroke-dasharray",P),(x=this.startLineEle)===null||x===void 0||x.setAttribute("stroke-dasharray",P),(k=this.endLineEle)===null||k===void 0||k.setAttribute("stroke-dasharray",P)}f.borderStyle=d,this.setAnnotationChanged({borderStyle:d,borderWidth:f.borderWidth,dashes:f.dashes||"2, 2"})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(d){var f,y,x,k=this.annotation;k.dashes=d;var P=this.getDashString();this.arcEle.setAttribute("stroke-dasharray",P),(f=this.smallArcEle)===null||f===void 0||f.setAttribute("stroke-dasharray",P),(y=this.startLineEle)===null||y===void 0||y.setAttribute("stroke-dasharray",P),(x=this.endLineEle)===null||x===void 0||x.setAttribute("stroke-dasharray",P),this.setAnnotationChanged({borderStyle:k.borderStyle,borderWidth:k.borderWidth,dashes:d})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(d){var f,y,x,k=this.annotation;k.borderWidth=d;var P=d*this.documentViewer.scale;this.arcEle.setAttribute("stroke-width",P),(f=this.smallArcEle)===null||f===void 0||f.setAttribute("stroke-width",P),(y=this.startLineEle)===null||y===void 0||y.setAttribute("stroke-width",P),(x=this.endLineEle)===null||x===void 0||x.setAttribute("stroke-width",P),this.update(null,!1),this.setAnnotationChanged({borderStyle:k.borderStyle,borderWidth:d,dashes:k.dashes||"2, 2"})}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(d){var f,y,x;this.arcEle.setAttribute("stroke",d),(f=this.smallArcEle)===null||f===void 0||f.setAttribute("stroke",d),(y=this.startLineEle)===null||y===void 0||y.setAttribute("stroke",d),(x=this.endLineEle)===null||x===void 0||x.setAttribute("stroke",d),this.annotation.borderColor=d,this.setAnnotationChanged({borderColor:d})}},{key:"handlePropertyPanel",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(y=this.annotation,this.documentViewer.annotationStore.selectedElementName===y.name){P.next=3;break}return P.abrupt("return");case 3:x=0,P.t0=_regeneratorRuntime().keys(f);case 5:if((P.t1=P.t0()).done){P.next=13;break}return k=P.t1.value,P.t2=x,P.next=10,this.setCustomData(k,f[k],!0);case 10:x=P.t2+=P.sent,P.next=5;break;case 13:x>0&&this.sendData(f),x===0&&["showRadius","showArcLength","showAngle"].some(function(S){return S in f})&&(this.getResult(),this.sendData());case 15:case"end":return P.stop()}},d,this)})),function(d){return s.apply(this,arguments)})},{key:"setCustomData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(f,y){var x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z=arguments;return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(x=Z.length>2&&Z[2]!==void 0&&Z[2],k=this.annotation,P=0,S=_slicedToArray(this.realVertices,3),E=S[0],M=S[1],T=S[2],D=this.calculateCenter(E,M,T)){j.next=7;break}return j.abrupt("return",0);case 7:if(N={x:(T.x+D.x)/2,y:(T.y+D.y)/2},f!=="showRadius"){j.next=12;break}return this.showRadius=y,!y&&this.radiusTspan?(this.radiusTspan.remove(),this.radiusTspan=null):y&&(this.radiusTspan||(this.radiusTspan=createSvg("tspan",{x:N.x,y:N.y,dy:"-1em"}),this.textEle.appendChild(this.radiusTspan)),this.radiusTspan.textContent=k.radius.toFixed(this.decimalPlaces)+k.scale.translateUnit),j.abrupt("return",0);case 12:if(f!=="showArcLength"){j.next=16;break}return this.showArcLength=y,!y&&this.arcLengthTspan?(this.arcLengthTspan.remove(),this.arcLengthTspan=null):y&&(this.arcLengthTspan||(this.arcLengthTspan=createSvg("tspan",{x:N.x,y:N.y,dy:"0em"}),this.textEle.appendChild(this.arcLengthTspan)),this.arcLengthTspan.textContent=k.arcLength.toFixed(this.decimalPlaces)+k.scale.translateUnit),j.abrupt("return",0);case 16:if(f!=="showAngle"){j.next=20;break}return this.showAngle=y,!y&&this.angleTspan?(this.angleTspan.remove(),this.angleTspan=null):y&&(this.angleTspan||(this.angleTspan=createSvg("tspan",{x:N.x,y:N.y,dy:"1em"}),this.textEle.appendChild(this.angleTspan)),this.angleTspan.textContent=k.angle+"\xB0"),j.abrupt("return",0);case 20:j.t0=_regeneratorRuntime().keys(k);case 21:if((j.t1=j.t0()).done){j.next=47;break}if((I=j.t1.value)!==f||k[I]===y){j.next=45;break}if(k[I]=y,P=1,f==="borderColor"&&(this.arcEle.setAttribute("stroke",y),(O=this.smallArcEle)===null||O===void 0||O.setAttribute("stroke",y),(F=this.startLineEle)===null||F===void 0||F.setAttribute("stroke",y),(q=this.endLineEle)===null||q===void 0||q.setAttribute("stroke",y),!k.measure&&(k.color=y)),f==="opacity"&&(this.svgElement.style.opacity=y),f==="borderWidth"&&(ve=y*this.documentViewer.scale,this.arcEle.setAttribute("stroke-width",ve),(Y=this.smallArcEle)===null||Y===void 0||Y.setAttribute("stroke-width",ve),(_e=this.startLineEle)===null||_e===void 0||_e.setAttribute("stroke-width",ve),(ne=this.endLineEle)===null||ne===void 0||ne.setAttribute("stroke-width",ve),this.update(null,!1),k.measure&&this.showPopup()),f==="color"&&this.textEle.setAttribute("fill",y),f==="fontSize"&&(this.textEle.style.fontSize="calc(var(--scale-factor) * ".concat(y,"px)")),f==="fontName"&&(this.textEle.style.fontFamily=y),f==="fontStyle"&&(this.textEle.style.fontStyle=y),f==="fontWeight"&&(this.textEle.style.fontWeight=y),f==="contents"&&k.measure&&(this.angleTspan&&(this.angleTspan.remove(),this.angleTspan=null),this.radiusTspan&&(this.radiusTspan.remove(),this.radiusTspan=null),this.arcLengthTspan||(this.arcLengthTspan=createSvg("tspan",{x:N.x,y:N.y,dy:"0em"}),this.textEle.appendChild(this.arcLengthTspan)),this.arcLengthTspan.textContent=y),f!=="scale"&&f!=="precision"){j.next=45;break}return f==="precision"&&(this.decimalPlaces=((J=Math.abs(k.precision).toString().split(".")[1])===null||J===void 0?void 0:J.length)||0),j.next=39,this.documentViewer.annotationManager.editMeasurementAnnotation(_defineProperty$1(_defineProperty$1(_defineProperty$1({rulerPtr:k.rulerPtr},f,y),"annotPtr",k.annotPtr),"contents",k.contents));case 39:return j.next=41,this.documentViewer.messageHandler.sendWithPromise("GetFactor",k.rulerPtr);case 41:fe=j.sent,k.factor=fe,this.update(),P=0;case 45:j.next=21;break;case 47:return!x&&this.sendData(_defineProperty$1({},f,y)),j.abrupt("return",P);case 49:case"end":return j.stop()}},d,this)})),function(d,f){return u.apply(this,arguments)})},{key:"sendData",value:function(d){var f=this.annotation;if(!f.measure){if(!d)return;var y={operate:"mod-annot",name:f.name,pageIndex:f.pageIndex,pagePtr:f.pagePtr,annotPtr:f.annotPtr};d.borderColor&&(y.color=f.color);var x=Object.assign({},y,d);return this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:x}),void this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}var k={pagePtr:f.pagePtr,annotPtr:f.annotPtr,rulerPtr:f.rulerPtr,pageIndex:f.pageIndex,inkPointes:f.inkPointes,arcPoints:this.changedArcPoints,borderWidth:f.borderWidth,borderColor:f.borderColor,opacity:f.opacity,contents:f.contents};d&&["fontSize","fontName","color","fontStyle","fontWeight"].some(function(S){return d[S]})&&(k.fontSize=f.fontSize,k.color=f.color,k.fontName=f.fontName,k.fontStyle=f.fontStyle,k.fontWeight=f.fontWeight);var P=Object.assign({},k,d);this.documentViewer.annotationManager.editMeasurementAnnotation(P),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"getResult",value:function(){var d=this.annotation;d.arcPoints,d.factor;var f=d.scale.translateUnit,y=[];this.showRadius&&this.annotation.radius&&y.push(this.annotation.radius.toFixed(this.decimalPlaces)+f),this.showArcLength&&this.annotation.arcLength&&y.push(this.annotation.arcLength.toFixed(this.decimalPlaces)+f),this.showAngle&&this.annotation.angle&&y.push(this.annotation.angle+"\xB0"),this.annotation.contents=y.join(`
`)}},{key:"showPopup",value:function(){if(this.layer){var d=this.layer.div.getBoundingClientRect(),f=d.left+this.rect.left,y=this.rect.top+d.top,x={left:f,top:y,right:f+this.rect.width,bottom:y+this.rect.height};this.documentViewer.eventBus.dispatch("showMeasurementPopup",{rect:x}),this.isPopupShow=!0}}},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.documentViewer.eventBus.dispatch("showMeasurementPopup"))}},{key:"handlePopup",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y,x=this;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:f==="delete"&&this.handleDelete(),f==="reply"&&(this.openReply(),(y=document.getElementById("leftPanel"))!=null&&y.classList.contains("closed")&&setTimeout(function(){x.showPopup()},350));case 2:case"end":return k.stop()}},d,this)})),function(d){return r.apply(this,arguments)})},{key:"formatValue",value:function(d){return d%1==0?d:Number(d.toFixed(this.decimalPlaces))}},{key:"handleKeyDown",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function d(f){var y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"){x.next=2;break}return x.abrupt("return");case 2:(y=f.keyCode||f.which)!==8&&y!==46||this.handleDelete();case 4:case"end":return x.stop()}},d,this)})),function(d){return o.apply(this,arguments)})},{key:"updateRect",value:function(){if(this.realVertices.length===3){var d=_slicedToArray(this.realVertices,3),f=d[0],y=d[1],x=d[2],k=this.calculateCenter(f,y,x);if(!k)return;this.describeArc(f,y,x,k);var P=this.rectCalcByVertices(this.inkPoints);this.start={x:P.left,y:P.top},this.end={x:P.right,y:P.bottom},this.rect=this.calculate(this.start,this.end);var S=this.getMinBoundingRect(this.annotation.arcPoints[0],this.annotation.arcPoints[1],this.annotation.arcPoints[2]),E=S.left,M=S.top,T=S.right,D=S.bottom;this.annotation.rect={left:E,top:M,right:T,bottom:D}}else{this.annotation.rect=this.rectCalcByVertices(this.annotation.arcPoints);var N=this.getActualRect(this.documentViewer.scale),I=N.start,O=N.end;this.start=I,this.end=O,this.rect=this.calculate(I,O)}}},{key:"calculateCircle",value:function(d,f,y){var x=d.x,k=d.y,P=f.x,S=f.y,E=y.x,M=y.y,T=2*(P-x),D=2*(S-k),N=Math.pow(P,2)+Math.pow(S,2)-Math.pow(x,2)-Math.pow(k,2),I=2*(E-x),O=2*(M-k),F=Math.pow(E,2)+Math.pow(M,2)-Math.pow(x,2)-Math.pow(k,2),q=T*O-I*D;if(q===0)return null;var Y=(O*N-D*F)/q,_e=(T*F-I*N)/q;return{x:Y,y:_e,radius:Math.hypot(x-Y,k-_e)}}},{key:"isAngleInRange",value:function(d,f,y,x){return d=(d+2*Math.PI)%(2*Math.PI),f=(f+2*Math.PI)%(2*Math.PI),y=(y+2*Math.PI)%(2*Math.PI),x?f>=y?d<=f&&d>=y:d<=f||d>=y:f<=y?d>=f&&d<=y:d>=f||d<=y}},{key:"getMinBoundingRect",value:function(d,f,y){var x=this,k=this.calculateCircle(d,f,y);if(!k){var P=[d.x,f.x,y.x],S=[d.y,f.y,y.y];return{left:Math.min.apply(Math,P),right:Math.max.apply(Math,P),top:Math.max.apply(Math,S),bottom:Math.min.apply(Math,S)}}var E=function(ne){var ve=ne.x-k.x,J=ne.y-k.y;return Math.atan2(J,ve)},M=E(d);E(f);var T=E(y),D=(f.x-d.x)*(y.y-d.y)-(f.y-d.y)*(y.x-d.x)<0,N=M,I=T;D?T>M&&(I-=2*Math.PI):T<M&&(I+=2*Math.PI);var O=[0,Math.PI/2,Math.PI,3*Math.PI/2].map(function(ne){return x.isAngleInRange(ne,N,I,D)}),F=k.x,q=k.y,Y=k.radius,_e=[d,f,y];return{left:O[2]?F-Y:Math.min.apply(Math,_toConsumableArray$1(_e.map(function(ne){return ne.x}))),right:O[0]?F+Y:Math.max.apply(Math,_toConsumableArray$1(_e.map(function(ne){return ne.x}))),top:O[1]?q+Y:Math.max.apply(Math,_toConsumableArray$1(_e.map(function(ne){return ne.y}))),bottom:O[3]?q-Y:Math.min.apply(Math,_toConsumableArray$1(_e.map(function(ne){return ne.y})))}}},{key:"renderAnnot",value:function(){var d=this.annotation,f=this.documentViewer.scale,y=d.borderWidth*f;if(this.svgElement.innerHTML="",!(this.realVertices.length<2)){var x=_slicedToArray(this.realVertices,3),k=x[0],P=x[1],S=x[2],E=this.calculateCenter(k,P,S);if(E&&(this.arcEle=createSvg("path",{stroke:d.borderColor,"stroke-width":y,fill:"none",d:this.describeArc(k,P,S,E)}),this.svgElement.append(this.arcEle),d.measure)){this.smallArcEle=createSvg("path",{stroke:d.borderColor,"stroke-width":y,fill:"none",d:this.describeArc(k,P,S,E,.15)}),this.startLineEle=createSvg("line",{stroke:d.borderColor,"stroke-width":y,"stroke-dasharray":4*f,x1:k.x,y1:k.y,x2:E.x,y2:E.y}),this.endLineEle=createSvg("line",{stroke:d.borderColor,"stroke-width":y,"stroke-dasharray":4*f,x1:S.x,y1:S.y,x2:E.x,y2:E.y}),this.svgElement.append(this.smallArcEle),this.svgElement.append(this.startLineEle),this.svgElement.append(this.endLineEle);var M={x:(S.x+E.x)/2,y:(S.y+E.y)/2};this.textEle=createSvg("text",{fill:d.color||d.borderColor,"fill-opacity":d.opacity||1,"text-anchor":"middle","dominant-baseline":"middle"},{"font-size":"calc(var(--scale-factor) * ".concat(d.fontSize,"px)")}),this.svgElement.append(this.textEle),this.showRadius&&(this.radiusTspan=createSvg("tspan",{x:M.x,y:M.y,dy:"-1em"}),this.radiusTspan.textContent=d.radius.toFixed(this.decimalPlaces)+d.scale.translateUnit,this.textEle.appendChild(this.radiusTspan)),this.showArcLength&&(this.arcLengthTspan=createSvg("tspan",{x:M.x,y:M.y,dy:"0em"}),this.arcLengthTspan.textContent=d.arcLength.toFixed(this.decimalPlaces)+d.scale.translateUnit,this.textEle.appendChild(this.arcLengthTspan)),this.showAngle&&(this.angleTspan=createSvg("tspan",{x:M.x,y:M.y,dy:"1em"}),this.angleTspan.textContent=d.angle+"\xB0",this.textEle.appendChild(this.angleTspan))}}}},{key:"updateCircle",value:function(d){if(Number.isFinite(d)&&d<this.realVertices.length-1&&d>=0){var f=this.realVertices[d],y=f.x,x=f.y,k=this.outerLine.querySelector('circle[data-id="point'+d+'"]');return k.setAttribute("cx",y),void k.setAttribute("cy",x)}this.outerLineContainer.querySelectorAll("circle").forEach(function(D){return D.remove()});var P=[],S={};this.realVertices.forEach(function(D){var N="".concat(D.x,"-").concat(D.y);S[N]||(S[N]=!0,P.push(D))});for(var E=0;E<P.length;E++){var M=P[E],T=createSvg("circle",{"data-id":"point"+E,fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:M.x,cy:M.y,r:6},{cursor:"default"});this.outerLine.append(T)}}},{key:"addPathPoint",value:function(d,f){var y=this.annotation,x=getInitialPoint$1({x:d,y:f},this.documentViewer.scale);y.arcPoints.push(x),this.realVertices.push({x:d,y:f});var k=_slicedToArray(this.realVertices.slice(-2),2),P=k[0],S=k[1];[P.x,P.y,S.x,S.y].every(Number.isFinite)&&(P.x===S.x&&P.y===S.y&&(S.x+=1,S.y+=1),this.realVertices.length===3&&this.renderAnnot())}},{key:"setPathPoint",value:function(d,f,y){if(!(d>this.realVertices.length-1||d<0)){var x=this.annotation,k=this.documentViewer.scale,P=getInitialPoint$1({x:f,y},k);if(x.arcPoints[d].x=P.x,x.arcPoints[d].y=P.y,this.realVertices[d].x=f,this.realVertices[d].y=y,this.realVertices.length===2){var S=_slicedToArray(this.realVertices,2),E=S[0],M=S[1],T={x:(E.x+M.x)/2,y:(E.y+M.y)/2},D=this.calculateCenter(E,T,M);if(!D)return;var N=x.borderWidth*k;return this.arcEle||(this.arcEle=createSvg("path",{stroke:x.borderColor,"stroke-width":N,fill:"none"}),this.svgElement.append(this.arcEle)),void this.arcEle.setAttribute("d",this.describeArc(E,T,M,D))}x.measure&&this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.annotation.scale,precision:this.annotation.precision,arcLength:this.annotation.arcLength,angle:this.annotation.angle||0,radius:this.annotation.radius})}}},{key:"calculateCenter",value:function(d,f,y){var x=d.x,k=d.y,P=f.x,S=f.y,E=y.x,M=y.y;if((P-x)*(M-k)-(S-k)*(E-x)===0)return{x:(d.x+y.x)/2,y:(d.y+y.y)/2};var T=2*(P-x),D=2*(S-k),N=Math.pow(P,2)+Math.pow(S,2)-Math.pow(x,2)-Math.pow(k,2),I=2*(E-x),O=2*(M-k),F=Math.pow(E,2)+Math.pow(M,2)-Math.pow(x,2)-Math.pow(k,2),q=T*O-I*D;return{x:(N*O-F*D)/q,y:(T*F-I*N)/q}}},{key:"describeArc",value:function(d,f,y,x){var k=this,P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,S=function(J){return{x:x.x+(J.x-x.x)*P,y:x.y+(J.y-x.y)*P}};P!==1&&(d=S(d),f=S(f),y=S(y));var E=Math.hypot(d.x-x.x,d.y-x.y),M=function(J){return(Math.atan2(J.y-x.y,J.x-x.x)+2*Math.PI)%(2*Math.PI)},T=M(d),D=M(f),N=M(y),I=!1,O=(I=T<N?D>T&&D<N:D>T||D<N)?1:0,F=((N-T+2*Math.PI)%(2*Math.PI)<=Math.PI?I:!I)?0:1;if(P===1){var q=this.annotation.factor,Y=Math.abs(N-T);F===1&&(Y=2*Math.PI-Y),this.annotation.measure&&(this.annotation.radius=this.formatValue(E*q),this.annotation.angle=Math.round(Y*(180/Math.PI)),this.annotation.arcLength=this.formatValue(E*Y*q)),this.changedArcPoints=[],this.changedArcPoints.push(O?y:d,f,O?d:y),this.changedArcPoints=this.changedArcPoints.map(function(J){return getInitialPoint$1(J,k.documentViewer.scale)});for(var _e=[],ne=0;ne<this.changedArcPoints.length;ne++){var ve=this.changedArcPoints[ne];_e.push({PointX:ve.x,PointY:ve.y})}!this.annotation.inkPointes&&(this.annotation.inkPointes=[]),this.annotation.inkPointes[0]=_e,this.inkPoints=this.arcToPoints(E,d,y,x,O)}return"M ".concat(d.x," ").concat(d.y," A ").concat(E," ").concat(E," 0 ").concat(F," ").concat(O," ").concat(y.x," ").concat(y.y)}},{key:"calculateInkPoints",value:function(d,f,y,x,k){var P=[],S=y.x-f.x,E=y.y-f.y;if(Math.sqrt(S*S+E*E)!==0){for(var M=x.x,T=x.y,D=0;D<=1;D+=.01){var N=Math.atan2(f.y-T,f.x-M),I=Math.atan2(y.y-T,y.x-M),O=N+D*(k?(I-N+2*Math.PI)%(2*Math.PI):(I-N)%(2*Math.PI)),F={x:(M+d*Math.cos(O))/1,y:(T+d*Math.sin(O))/1};if(P.length>0){var q=P[P.length-1],Y=F.x-q.x,_e=F.y-q.y,ne=Math.sqrt(Y*Y+_e*_e);if(ne>=1)for(var ve=Math.floor(ne/1),J=1;J<=ve;J++){var fe={x:(q.x+Y/ve*J)/1,y:(q.y+_e/ve*J)/1};P.push(fe)}}P.push(F)}return P}}},{key:"arcToPoints",value:function(d,f,y,x,k){var P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1,S=Math.atan2(f.y-x.y,f.x-x.x),E=Math.atan2(y.y-x.y,y.x-x.x)-S;k?E<0&&(E+=2*Math.PI):E>0&&(E-=2*Math.PI),E=Math.abs(E);for(var M=Math.ceil(E/(P*(Math.PI/180))),T=[],D=0;D<=M;D++){var N=S+E*(D/M)*(k?1:-1),I=x.x+d*Math.cos(N),O=x.y+d*Math.sin(N);T.push({x:I,y:O})}return T}}]);var o,r,u,s,w,m,v,g}(),ComPDFAnnotationLayer=function(){return _createClass(function e(n){var o,r=n.documentViewer,u=n.annotationStore,s=n.pageViewer,w=n.messageHandler,m=n.pageDiv,v=n.pdfPage,g=n.annotations,d=g===void 0?null:g,f=n.annotationsAll,y=n.viewport,x=n.scale,k=n.pageIndex,P=n.eventBus,S=n.enableReply,E=S===void 0||S,M=n.$t;_classCallCheck(this,e),this.documentViewer=r,this.annotationStore=u,this.pageViewer=s,this.pageDiv=m,this.pdfPage=v,this.messageHandler=w,this.annotations=d||[],this.annotationsAll=f,this.viewport=y,this.annotationsArray=[],this.scale=x,this.eventBus=P,this.page=k,this.annotationStore.$t=M,this.enableReply=E,this._cancelled=!1,this.tool=s.tool||"",this.color=s.color||"",this.annotateManager=null,this.isDraging=!1,this.selectedElementName=null,this.addMode=!1,this.toolMode=s.toolMode||"",this.managerArray=["freetextManager","textManager","textFieldManager","checkBoxManager","radioButtonManager","pushButtonManager","listBoxManager","comboBoxManager","annotateManager","linkManager","signFieldManager","redactionManager"],this.ratio=window.devicePixelRatio||1,this.onHandleTool=this.handleTool.bind(this),this.onHandleToolMode=this.handleToolMode.bind(this),this.onHandlePropertyPanelChanged=this.handlePropertyPanelChanged.bind(this),this.onHandleAddSign=this.addSign.bind(this),this.onRedrawMarkups=this.redrawMarkups.bind(this),this.annotationStore.$t=M,this.enableReply=E,this.markupType=["highlight","underline","squiggly","strikeout"],this.ctx=(o=this.pageViewer.canvas)===null||o===void 0?void 0:o.getContext("2d")},[{key:"handleTool",value:function(e){var n=this,o=e.tool,r=e.color;if(this.tool=o,this.color=r,this.pageViewer.tool=o,this.pageViewer.color=r,this.svgElement||(this.destroy(),this.renderPaintScene()),o&&!this.markupType.includes(o)||document.querySelector(".document").classList.remove("annotation-edit"),(this.markupType.includes(o)||["cropPage","selectText","stamp","polygon","polyline","arc","callout"].includes(o))&&this.resetManagers(),this.markupType.includes(o)&&r&&this.svgElement.classList.add("point-none"),this.managerArray.forEach(function(u){n[u]&&(n[u].tool=n.tool,n[u].color=n.color)}),["line","arrow","circle","square","ink"].includes(o)&&r&&this.toolMode!=="measurement"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("annotateManager"),this.annotateManager)return void this.annotateManager.init();this.annotateManager=new PaintShape({tool:o,color:r,layer:this})}else if(o==="freetext"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("freetextManager"),this.freetextManager)return void this.freetextManager.init();this.freetextManager=new Freetext({tool:o,color:r,layer:this})}else if(o==="text"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("textManager"),this.textManager)return void this.textManager.init();this.textManager=new Text({tool:o,color:r,layer:this})}else if(o==="textfield"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("textFieldManager"),this.textFieldManager)return void this.textFieldManager.init();this.textFieldManager=new AddTextField({tool:o,color:r,layer:this})}else if(o==="checkbox"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("checkBoxManager"),this.checkBoxManager)return void this.checkBoxManager.init();this.checkBoxManager=new AddCheckBox({tool:o,color:r,layer:this})}else if(o==="radiobutton"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("radioButtonManager"),this.radioButtonManager)return void this.radioButtonManager.init();this.radioButtonManager=new AddRadioButton({tool:o,color:r,layer:this})}else if(o==="pushbutton"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("pushButtonManager"),this.pushButtonManager)return void this.pushButtonManager.init();this.pushButtonManager=new AddPushButton({tool:o,color:r,layer:this})}else if(o==="combobox"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("comboBoxManager"),this.comboBoxManager)return void this.comboBoxManager.init();this.comboBoxManager=new AddComboBox({tool:o,color:r,layer:this})}else if(o==="listbox"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("listBoxManager"),this.listBoxManager)return void this.listBoxManager.init();this.listBoxManager=new AddListBox({tool:o,color:r,layer:this})}else if(o==="link"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("linkManager"),this.linkManager)return void this.linkManager.init();this.linkManager=new PaintLink({tool:o,color:r,layer:this})}else if(o==="signatureFields"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("signFieldManager"),this.signFieldManager)return void this.signFieldManager.init();this.signFieldManager=new AddSignField({tool:o,color:r,layer:this})}else if(o==="redaction"||o==="remove"){if(document.querySelector(".document").classList.add("annotation-edit"),this.resetManagers("redactionManager"),this.redactionManager)return void this.redactionManager.init();this.redactionManager=new PaintRedaction({tool:o,color:r,layer:this})}}},{key:"resetManagers",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Array.isArray(n)||(n=[n]),this.managerArray.filter(function(o){return!n.includes(o)}).forEach(function(o){e[o]&&e[o].reset()})}},{key:"render",value:function(e){var n=this;if(!this._cancelled){if(this.renderPaintScene(),this.eventBus._on("toolChanged",this.onHandleTool),this.eventBus._on("toolModeChanged",this.onHandleToolMode),this.eventBus._on("setDefaultSelect",this.onHandleDefaultSelect),this.eventBus._on("propertyPanelChanged",this.onHandlePropertyPanelChanged),this.eventBus._on("redrawMarkups",this.onRedrawMarkups),e){var o=e.clone({dontFlip:!0});this.viewport=o,this.scale=o.scale,this.managerArray.forEach(function(r){n[r]&&(n[r].viewport=o)})}this.div||this.renderContainer(),this.documentViewer.getAnnotationManager().drawAnnotations({pageNumber:this.page+1}),this.handleTool({tool:this.tool,color:this.color}),this.annotationStore.toSelectAnnotationName&&this.pageViewer.selectAnnotation(this.annotationStore.toSelectAnnotationName)}}},{key:"renderContainer",value:function(){if(!this.div){var e=document.createElement("div");e.className="annotationContainer",this.scene.append(e),this.div=e}}},{key:"emptyAnnotations",value:function(){for(var e=this.annotationsArray.length-1;e>=0;e--)this.annotationsArray[e].delete();this.annotationsArray=[]}},{key:"cancel",value:function(){this.reset()}},{key:"reset",value:function(){this.svgElement||(this.svgElement=this.pageDiv.querySelector(".annotationLayer svg")),this.div||(this.div=this.pageDiv.querySelector(".annotationContainer")),this.resetManagers(),this.annotationStore.notFirstRender=!0}},{key:"destroy",value:function(){var e,n;this.svgElement||(this.svgElement=this.pageDiv.querySelector(".annotationLayer svg")),(e=this.svgElement)===null||e===void 0||e.remove(),this.div||(this.div=this.pageDiv.querySelector(".annotationContainer")),(n=this.div)===null||n===void 0||n.remove(),this.resetManagers(),this.svgElement=null,this.div=null,this.eventBus._off("toolChanged",this.onHandleTool),this.eventBus._off("toolModeChanged",this.onHandleToolMode),this.eventBus._off("setDefaultSelect",this.onHandleDefaultSelect),this.eventBus._off("propertyPanelChanged",this.onHandlePropertyPanelChanged),this.eventBus._off("redrawMarkups",this.onRedrawMarkups),this.annotationStore.notFirstRender=!0}},{key:"setSceneDimensions",value:function(e){if(e){var n=e.clone({dontFlip:!0});this.viewport=n,this.annotateManager&&(this.annotateManager.viewport=n)}if(this.svgElement){var o=this.scene;o.style.width="100%",o.style.height="100%"}}},{key:"renderPaintScene",value:function(){this.svgElement||(this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.scene=this.pageDiv.querySelector(".annotationLayer"),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.scene.append(this.svgElement)),this.setSceneDimensions()}},{key:"renderAnnotation",value:function(e,n){this.div||this.renderContainer();var o=this.enableReply,r=null;e.type==="custom"?r=new Shape({annotation:e,layer:this}):e.type==="highlight"?r=new TextHighlightAnnotation({annotation:e,layer:this,enableReply:o}):e.type==="squiggly"?r=new TextSquigglyAnnotation({annotation:e,layer:this,enableReply:o}):e.type==="strikeout"?r=new TextStrikeoutAnnotation({annotation:e,layer:this,enableReply:o}):e.type==="underline"?r=new TextUnderlineAnnotation({annotation:e,layer:this,enableReply:o}):e.type==="line"||e.type==="arrow"?r=new Line({annotation:e,show:n,layer:this,enableReply:o}):["square","circle"].includes(e.type)&&!e.measure?r=new Shape$1({annotation:e,show:n,layer:this,enableReply:o}):e.type!=="polygon"||e.isDelete?e.type!=="freetext"||e.isDelete?e.type!=="text"||e.isDelete?e.type!=="stamp"||e.isDelete?e.type!=="textfield"||e.isDelete?e.type!=="checkbox"||e.isDelete?e.type!=="radiobutton"||e.isDelete?e.type!=="pushbutton"||e.isDelete?e.type!=="listbox"||e.isDelete?e.type!=="combobox"||e.isDelete?e.type!=="link"||e.isDelete?e.type!=="signatureFields"||e.isDelete?e.type!=="redact"||e.isDelete?e.type!=="polyline"||e.isDelete?e.type!=="circle"||e.isDelete?e.type!=="rectangle"||e.isDelete?e.type==="arc"||e.type==="ink"&&!e.isDelete&&(e.inkPointes[0].length===3||e.arcPoints)?r=new Arc({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):e.type==="ink"&&!e.isDelete&&e.measure?r=new Curve({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):e.type!=="ink"||e.isDelete||e.measure||(r=new Ink({annotation:e,show:n,layer:this,enableReply:o})):r=new Rectangle({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):r=new Circle({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):r=new Polyline({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):r=new Redaction({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):r=new SignatureFields({annotation:e,show:n,layer:this}):r=new Link({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightLink}):r=new ComboBox({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightForm}):r=new ListBox({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightForm}):r=new PushButton({annotation:e,layer:this,show:n,highlight:this.annotationStore.highlightForm}):r=new RadioButton({annotation:e,show:n,layer:this,highlight:this.annotationStore.highlightForm}):r=new CheckBox$1({annotation:e,show:n,layer:this,highlight:this.annotationStore.highlightForm}):r=new TextField({annotation:e,show:n,layer:this,highlight:this.annotationStore.highlightForm}):r=new Stamp({annotation:e,show:n,layer:this,enableReply:o}):r=new Text$1({annotation:e,show:n,layer:this,enableReply:o}):r=new Freetext$1({annotation:e,layer:this,show:n,enableReply:o}):r=new Polygon({annotation:e,show:n,layer:this,enableReply:o}),r&&(this.annotationsArray.push(r),this.documentViewer.getAnnotationManager().addAnnotation(r))}},{key:"handleToolMode",value:function(e){this.toolMode=e,this.pageViewer.toolMode=e}},{key:"handlePropertyPanelChanged",value:function(e){var n,o=this,r=this.documentViewer.getAnnotationManager().getAnnotationsList();if(r&&r.length){var u=r.find(function(w){return w.name===o.annotationStore.selectedElementName||w.name===o.selectedElementName});if(u){var s={textfield:"textfieldPropertyPanelChanged",checkbox:"checkboxPropertyPanelChanged",radiobutton:"radioButtonPropertyPanelChanged",pushbutton:"pushButtonPropertyPanelChanged",listbox:"listBoxPropertyPanelChanged",combobox:"comboBoxPropertyPanelChanged",link:"linkPropertyPanelChanged",signatureFields:"signatureFieldsPropertyPanelChanged"}[(n=u.type)===null||n===void 0?void 0:n.replace("-","")];s?this.eventBus.dispatch(s,e,this.page+1):u.measure?this.eventBus.dispatch("measurePropertyPanelChanged",e):this.eventBus.dispatch("annotationPropertyChanged",e)}}}},{key:"addSign",value:function(e){if(document.getElementsByClassName("sign-ink-save").length){var n=e instanceof PointerEvent;n&&this.eventBus.dispatch("getSignData",{page:this.page,viewport:this.viewport,clickX:e.offsetX,clickY:e.offsetY}),e&&e.page===this.page&&e.annotationData&&!n&&this.renderAnnotation(e.annotationData),this.pageDiv.removeEventListener("click",this.onHandleAddSign),this.eventBus.dispatch("initCursorStyle")}else this.pageDiv.removeEventListener("click",this.onHandleAddSign)}},{key:"redrawMarkups",value:function(e){var n=e.pageIndex,o=e.afterContentEdit,r=o!==void 0&&o,u=e.pagePtr,s=e.rect,w=e.isRestorePage,m=w===void 0||w;if(n===this.page){if(!r&&m){var v=this.pageViewer.canvas.getContext("2d"),g=Math.round(this.viewport.width*this.ratio),d=Math.round(this.viewport.height*this.ratio);v.globalCompositeOperation="multiply",v.clearRect(0,0,g,d),v.putImageData(this.pageViewer.baseImageData,0,0)}for(var f=this.documentViewer.getAnnotationManager().getAnnotationsList(),y=0;y<f.length;y++){var x=f[y];x.PageNumber===this.page+1&&!x.isDelete&&this.markupType.includes(x.type)&&(r?x.reRenderAfterContentEdit.call(x,{pagePtr:u,rect:s}):x.drawCanvas.call(x,x.positionArray,x.getVisibleRect()))}}}},{key:"getAnnoationIndex",value:function(e){return this.annotationsArray.findIndex(function(n){return n.annotation.name===e.name})}},{key:"getAnnotation",value:function(e){return this.annotationsArray.find(function(n){return n.annotation.name===e.name})}},{key:"deleteAnnotationInLayer",value:function(e){var n=this.annotationsArray,o=this.getAnnoationIndex(e);o>-1&&n.splice(o,1)}},{key:"deleteAnnotation",value:function(e){var n=this.annotationsArray,o=this.getAnnoationIndex(e);o>-1&&n[o].handleDelete()}}])}(),toggleSelection$1=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var n=document.activeElement,o=[],r=0;r<e.rangeCount;r++)o.push(e.getRangeAt(r));switch(n.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":n.blur();break;default:n=null}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||o.forEach(function(u){e.addRange(u)}),n&&n.focus()}},deselectCurrent$1=toggleSelection$1,clipboardToIE11Formatting$1={"text/plain":"Text","text/html":"Url",default:"Text"},defaultMessage$1="Copy to clipboard: #{key}, Enter";function format$1(e){var n=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,n)}function copy$1(e,n){var o,r,u,s,w,m,v=!1;n||(n={}),o=n.debug||!1;try{if(u=deselectCurrent$1(),s=document.createRange(),w=document.getSelection(),(m=document.createElement("span")).textContent=e,m.ariaHidden="true",m.style.all="unset",m.style.position="fixed",m.style.top=0,m.style.clip="rect(0, 0, 0, 0)",m.style.whiteSpace="pre",m.style.webkitUserSelect="text",m.style.MozUserSelect="text",m.style.msUserSelect="text",m.style.userSelect="text",m.addEventListener("copy",function(g){if(g.stopPropagation(),n.format)if(g.preventDefault(),g.clipboardData===void 0){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var d=clipboardToIE11Formatting$1[n.format]||clipboardToIE11Formatting$1.default;window.clipboardData.setData(d,e)}else g.clipboardData.clearData(),g.clipboardData.setData(n.format,e);n.onCopy&&(g.preventDefault(),n.onCopy(g.clipboardData))}),document.body.appendChild(m),s.selectNodeContents(m),w.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");v=!0}catch(g){o&&console.error("unable to copy using execCommand: ",g),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",e),n.onCopy&&n.onCopy(window.clipboardData),v=!0}catch(d){o&&console.error("unable to copy using clipboardData: ",d),o&&console.error("falling back to prompt"),r=format$1("message"in n?n.message:defaultMessage$1),window.prompt(r,e)}}finally{w&&(typeof w.removeRange=="function"?w.removeRange(s):w.removeAllRanges()),m&&document.body.removeChild(m),u()}return v}var copyToClipboard$1=copy$1,_editList=new WeakMap,TextEditor=function(){return _createClass(function X(H){var U=H.eventBus,te=H.contentContainer,Q=H.container,re=H.pageDiv,Pe=H.pagePtr,be=H.editPagePtr,we=H.editAreaPtr,Ae=H.editAreaIndex,$e=H.viewport,Me=H.scale,Ie=H.messageHandler,Le=H.newAdd,le=H.pageViewer,oe=H.hidden,ke=H.isUpdate,Ce=ke!==void 0&&ke;_classCallCheck(this,X),_classPrivateFieldInitSpec(this,_editList,[]),this.eventBus=U,this.contentContainer=te,this.container=Q,this.pageDiv=re,this.pagePtr=Pe,this.editPagePtr=be,this.editAreaPtr=we,this.editAreaIndex=Ae,this.viewport=$e,this.scale=Me,this.messageHandler=Ie,this.newAdd=Le,this.pageViewer=le,this.hidden=oe,this.isUpdate=Ce,this.margin=5,this.type="text",this.frame=null,this.canvas=null,this.borderWidth=2,this.pointWidth=6,this.pointHeight=6,this.activeCharPlace={SectionIndex:0,LineIndex:0,RunIndex:0,CharIndex:0},this.selectedRects=null,this.selectedCharRange=null,this.entireCharRange=null,this.state=0,this.mouseDown=!1,this.moving=!1,this.ratio=window.devicePixelRatio||1,this.removed=!1,this.start=null,this.end=null,this.newStart=null,this.newEnd=null,this.offsetX=0,this.offsetY=0,this.startPoint=null,this.endPoint=null,this.composing=!1,this.needUndoRec=!1,this.isFirefox=navigator.userAgent.indexOf("Firefox")>-1,this.mousedown=isMobileDevice$1?"touchstart":"mousedown",this.mouseup=isMobileDevice$1?"touchend":"mouseup",this.mousemove=isMobileDevice$1?"touchmove":"mousemove",this.textInput=isMobileDevice$1||this.isFirefox?"input":"textInput",this.onClick=this.handleClick.bind(this),this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.onBlur=this.handleBlur.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.onKeyup=this.handleKeyup.bind(this),this.onTextInput=this.handleTextInput.bind(this),this.onHandlePropertyPanelChanged=this.handlePropertyPanelChanged.bind(this),this.onCompositionstart=this.handleCompositionstart.bind(this),this.onCompositionend=this.handleCompositionend.bind(this),this.onShowContentEditorType=this.handleShow.bind(this),this.onHandlePopup=this.handlePopup.bind(this),this.render()},[{key:"render",value:(j=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve;return _regeneratorRuntime().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return this.eventBus._on("textPropertyChanged",this.onHandlePropertyPanelChanged),this.eventBus._on("showContentEditorType",this.onShowContentEditorType),this.eventBus._on("contentEditorPopupClicked",this.onHandlePopup),Oe.next=5,this.getBoxRect();case 5:return te=this.margin,this.canvas=document.createElement("canvas"),this.canvas.width=(this.rect.width+2*(te+this.borderWidth))*this.ratio,this.canvas.height=(this.rect.height+2*(te+this.borderWidth))*this.ratio,Q=createElement("div",{position:"absolute",left:this.rect.left-te-this.borderWidth+"px",top:this.rect.top-te-this.borderWidth+"px",width:this.rect.width+2*(te+this.borderWidth)+"px",height:this.rect.height+2*(te+this.borderWidth)+"px",display:this.hidden?"none":"block"},{class:"frame-container",index:this.editAreaIndex}),this.frameContainer=Q,(H=this.container)===null||H===void 0||H.append(this.frameContainer),this.frameContainer.appendChild(this.canvas),re=createElement("div",{position:"absolute",left:0,top:0,width:"100%",height:"100%",borderWidth:this.borderWidth+"px",borderColor:"#1460F3"},{class:"text-container"}),this.textContainer=re,(Pe=createElement("textarea",{position:"absolute",left:0,top:0,width:"100%",height:"100%",resize:"none",opacity:0,touchAction:"none"})).name="text-editor",this.textContainer.append(Pe),this.textarea=Pe,Oe.next=21,this.getText();case 21:if(be=Oe.sent,this.textarea.value=be,(U=this.frameContainer)===null||U===void 0||U.append(this.textContainer),this.textContainer.addEventListener(this.mousedown,this.onMousedown),this.textContainer.addEventListener(this.mouseup,this.onMouseup),isMobileDevice$1&&this.textarea.addEventListener("contextmenu",function(je){return je.preventDefault()}),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.outerLineContainer.style.position="absolute",we=this.getOutlineRect(this.rect),Ae=we.width,$e=we.height,Me=we.innerWidth,Ie=we.innerHeight,Le=we.left,le=we.top,oe=we.right,ke=we.bottom,Ce=we.centerY,Ee=we.centerX,Be=this.rect,Ve=createSvg("svg",{class:"outerline"},{position:"absolute",left:Be.left-te-(this.pointWidth+this.borderWidth)/2+"px",top:Be.top-te-(this.pointHeight+this.borderWidth)/2+"px",width:Ae+"px",height:$e+"px",zIndex:2}),this.outerLine=Ve,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":this.borderWidth,"fill-opacity":0,width:Me,height:Ie,x:this.pointWidth/2,y:this.pointHeight/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:Le,y:le}),this.LeftRect=createSvg("rect",{class:"w-resize resize","data-id":"w-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:Le,y:Ce}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:Le,y:ke}),this.bottomRect=createSvg("rect",{class:"s-resize resize","data-id":"s-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:Ee,y:ke}),this.bottomRightRect=createSvg("rect",{class:"se-resize resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:oe,y:ke}),this.rightRect=createSvg("rect",{class:"e-resize resize","data-id":"e-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:oe,y:Ce}),this.topRightRect=createSvg("rect",{class:"ne-resize resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:oe,y:le}),this.topRect=createSvg("rect",{class:"n-resize resize","data-id":"n-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:Ee,y:le}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.outerLine.addEventListener(this.mousedown,this.onMousedown),this.outerLine.addEventListener(this.mouseup,this.onMouseup),this.newAdd&&(this.goEditing(),this.addUndoHistory(),this.newAdd=!1),Oe.t0=this.isUpdate,!Oe.t0){Oe.next=60;break}return Oe.next=60,this.updateCanvas();case 60:case"end":return Oe.stop()}},X,this)})),function(){return j.apply(this,arguments)})},{key:"getFrameContainerRect",value:function(){var X=this.rect,H=this.margin,U=this.borderWidth;return{left:X.left-H-U,top:X.top-H-U,width:X.width+2*(H+U),height:X.height+2*(H+U)}}},{key:"getOutlineRect",value:function(X){var H=this.margin,U=this.pointWidth,te=this.pointHeight,Q=this.borderWidth,re=X.width+2*H+U+Q,Pe=X.height+2*H+te+Q;return{width:re,height:Pe,innerWidth:re-U,innerHeight:Pe-te,left:0,top:0,right:re-U,bottom:Pe-te,centerY:(Pe-te)/2,centerX:(re-U)/2}}},{key:"getActualRect",value:function(X,H){var U=H.left,te=H.top,Q=H.right,re=H.bottom;return{start:getActualPoint$1({x:U,y:te},X),end:getActualPoint$1({x:Q,y:re},X)}}},{key:"rectCalc",value:function(X,H){return{top:X.y<H.y?X.y:H.y,left:X.x<H.x?X.x:H.x,width:Math.abs(H.x-X.x),height:Math.abs(H.y-X.y)}}},{key:"getInitialPoint",value:function(X,H){var U=this.scale;return{start:{x:X.x/U,y:X.y/U},end:{x:H.x/U,y:H.y/U}}}},{key:"handleMouseDown",value:function(X){if(isMobileDevice$1&&X.preventDefault(),X.button!==2&&!this.hidden){if(this.state===1){var H=X.target.getAttribute("data-id"),U=getClickPoint(X),te=U.pageX,Q=U.pageY;this.startState={operator:H,clickX:te,clickY:Q},document.addEventListener(this.mousemove,this.onMousemove)}else if(this.state===2){if(isMobileDevice$1){var re=X.changedTouches[0].clientX-this.pageViewer.div.getBoundingClientRect().left,Pe=X.changedTouches[0].clientY-this.pageViewer.div.getBoundingClientRect().top;this.startPoint={x:re/this.scale,y:Pe/this.scale}}else{var be=X.offsetX,we=X.offsetY;this.startPoint={x:(be+this.rect.left-this.margin-this.borderWidth)/this.scale,y:(we+this.rect.top-this.margin-this.borderWidth)/this.scale}}this.textContainer.addEventListener(this.mousemove,this.onMousemove)}document.addEventListener(this.mouseup,this.onMouseup),this.selectedCharRange=null,this.mouseMoved=!1,this.mouseDown=!0}}},{key:"handleMouseUp",value:(Z=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe,Ke,Je,rt,ht,vt,Ct,kt;return _regeneratorRuntime().wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:if(!H||this.textContainer.contains(H.target)||this.state!==0){mt.next=2;break}return mt.abrupt("return");case 2:if((U=this.contentContainer.getSelectedEditBox())===null||U===this||this.state!==0){mt.next=5;break}return mt.abrupt("return");case 5:if(document.removeEventListener(this.mousemove,this.onMousemove),document.removeEventListener(this.mouseup,this.onMouseup),this.textContainer.removeEventListener(this.mousemove,this.onMousemove),H&&H.target!==this.textarea&&H.target!==this.textContainer&&(isMobileDevice$1?(te=H.changedTouches[0].clientX-this.pageViewer.div.getBoundingClientRect().left,Q=H.changedTouches[0].clientY-this.pageViewer.div.getBoundingClientRect().top):(te=H.offsetX,Q=H.offsetY),re=new MouseEvent(this.mouseup,{offsetX:te,offsetY:Q,type:H.type,target:this.textarea}),this.textarea.dispatchEvent(re)),this.mouseDown){mt.next=11;break}return mt.abrupt("return");case 11:if(this.mouseDown=!1,this.moving=!1,this.textContainer.removeEventListener(this.mousemove,this.onMousemove),H.type==="touchend"&&(this.pageDiv.style.touchAction=""),Pe=!0,this.state===0&&(this.state=1,Pe=!1,this.getTextStyle(),this.contentContainer.setSelectedEditBox(this),this.eventBus.dispatch("changeRightPanelBtnDisabled",!1),this.eventBus.dispatch("contentBoxSelected",{type:"text",pageNumber:this.pageViewer.pageIndex+1})),this.state!==1){mt.next=36;break}if(this.frameContainer.classList.remove("editing"),Ae={start:this.start,end:this.end},$e={start:this.newStart,end:this.newEnd},Me=getClickPoint(H),Ie=Me.pageX,Le=Me.pageY,(Ie!==((be=this.startState)===null||be===void 0?void 0:be.clickX)||Le!==((we=this.startState)===null||we===void 0?void 0:we.clickY))&&this.newStart&&this.newEnd&&(this.start=this.newStart,this.end=this.newEnd),this.container.append(this.outerLineContainer),!this.mouseMoved){mt.next=34;break}return le=this.getInitialPoint(this.start,this.end),oe=le.start,ke=le.end,Ce={left:oe.x,top:oe.y,right:ke.x,bottom:ke.y},mt.next=29,this.messageHandler.sendWithPromise("SetFrame",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,rect:Ce});case 29:return this.needUndoRec=!0,mt.next=32,this.updateCanvas({oldPoint:Ae,newPoint:$e});case 32:mt.next=35;break;case 34:!this.mouseMoved&&Pe&&(this.state=2,isMobileDevice$1||this.eventBus.dispatch("contentPropertyChange",{type:"text",isOpen:!0}));case 35:this.showPopup();case 36:if(this.state!==2){mt.next=65;break}return this.outerLineContainer.remove(),this.frameContainer.classList.add("editing"),isMobileDevice$1?(this.textarea.focus(),Be=H.changedTouches[0].clientX-this.pageViewer.div.getBoundingClientRect().left,Ve=H.changedTouches[0].clientY-this.pageViewer.div.getBoundingClientRect().top,Ee={x:Be/this.scale,y:Ve/this.scale}):(Oe=H.offsetX,je=H.offsetY,Ee={x:(Oe+this.rect.left-this.margin-this.borderWidth)/this.scale,y:(je+this.rect.top-this.margin-this.borderWidth)/this.scale}),this.mouseMoved&&(Ee=this.endPoint),this.startPoint||(this.startPoint=Ee),mt.next=44,this.getCharsRange(this.startPoint,Ee);case 44:if(Ge=mt.sent,Xe=Ge.start,qe=Ge.end,this.activeCharPlace=qe,this.getTextStyle(),this.cursor?this.cursor.style.display="block":(Ke=createSvg("svg",{class:"cursor-animation"},{position:"absolute",left:"-2px",top:"-2px",width:this.rect.width+2*(this.margin+this.borderWidth)+"px",height:this.rect.height+2*(this.margin+this.borderWidth)+"px"}),this.cursor=Ke,this.textContainer.append(this.cursor)),this.updateCursorLine(),(this.selectedRects&&!this.mouseMoved||Xe.SectionIndex===qe.SectionIndex&&Xe.LineIndex===qe.LineIndex&&Xe.RunIndex===qe.RunIndex&&Xe.CharIndex===qe.CharIndex)&&this.clearSelectText(),!this.selectedRects){mt.next=57;break}return mt.next=55,this.getText();case 55:this.selectedText=mt.sent,this.eventBus.dispatch("contentTextSelected",this.selectedText);case 57:this.textarea.focus(),this.textarea.addEventListener("blur",this.onBlur),this.textarea.addEventListener("keydown",this.onKeydown),this.textarea.addEventListener("keyup",this.onKeyup),this.textarea.addEventListener(this.textInput,this.onTextInput),(this.isFirefox||isMobileDevice$1)&&(this.textarea.addEventListener("compositionstart",this.onCompositionstart),this.textarea.addEventListener("compositionend",this.onCompositionend)),onClickOutsideUp([this.textContainer],this.handleTextOutside.bind(this)),this.hidePopup();case 65:this.frameContainer.classList.add("selected"),this.state!==1||this.mouseMoved||(Je=[this.textContainer,this.outerLine],(rt=document.querySelector(".editor-panel"))&&Je.push(rt),(ht=document.getElementById("editorPropertyPanelButton"))&&Je.push(ht),(vt=document.getElementById("undo"))&&Je.push(vt),(Ct=document.getElementById("redo"))&&Je.push(Ct),(kt=document.querySelector(".content-editor-popup"))&&Je.push(kt),onClickOutsideUp(Je,this.handleOutside.bind(this)));case 67:case"end":return mt.stop()}},X,this)})),function(X){return Z.apply(this,arguments)})},{key:"handleMouseMove",value:(fe=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe,Ke,Je,rt,ht,vt,Ct,kt,mt,Vt,bt,ot;return _regeneratorRuntime().wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:if((U=this.contentContainer.getSelectedEditBox())===null||U===this||this.state!==0){gt.next=3;break}return gt.abrupt("return");case 3:if(this.moving=!0,this.hidePopup(),H.type==="touchmove"&&(this.pageDiv.style.touchAction="none"),this.state!==1){gt.next=19;break}if(te=getClickPoint(H),Q=te.pageX,re=te.pageY,Pe=this.start,be=this.end,we=this.startState){gt.next=13;break}return gt.abrupt("return");case 13:if(we.clickX!==Q||we.clickY!==re){gt.next=15;break}return gt.abrupt("return");case 15:Ae=this.viewport,$e=Ae.width,Me=Ae.height,we.operator==="nw-resize"?(Ie=Q-(we.clickX-this.start.x),Le=re-(we.clickY-this.start.y),Ie=Math.min(be.x-5,Ie),Ie=Math.max(0,Ie),Le=Math.min(be.y-5,Le),Le=Math.max(0,Le),this.updateOutline({start:{x:Ie,y:Le},end:be})):we.operator==="w-resize"?(le=Q-(we.clickX-this.start.x),le=Math.min(be.x-5,le),le=Math.max(0,le),this.updateOutline({start:{x:le,y:Pe.y},end:be})):we.operator==="sw-resize"?(oe=Q-(we.clickX-this.start.x),ke=re-(we.clickY-this.end.y),oe=Math.min(be.x-5,oe),oe=Math.max(0,oe),ke=Math.min(Me,ke),ke=Math.max(Pe.y+5,ke),this.updateOutline({start:{x:oe,y:Pe.y},end:{x:be.x,y:ke}})):we.operator==="s-resize"?(Ce=re-(we.clickY-this.end.y),Ce=Math.min(Me,Ce),Ce=Math.max(Pe.y+5,Ce),this.updateOutline({start:Pe,end:{x:be.x,y:Ce}})):we.operator==="se-resize"?(Ee=Q-(we.clickX-this.end.x),Be=re-(we.clickY-this.end.y),Ee=Math.min($e,Ee),Ee=Math.max(Pe.x+5,Ee),Be=Math.min(Me,Be),Be=Math.max(Pe.y+5,Be),this.updateOutline({start:Pe,end:{x:Ee,y:Be}})):we.operator==="e-resize"?(Ve=Q-(we.clickX-this.end.x),Ve=Math.min($e,Ve),Ve=Math.max(Pe.x+5,Ve),this.updateOutline({start:Pe,end:{x:Ve,y:be.y}})):we.operator==="ne-resize"?(Oe=Q-(we.clickX-this.end.x),je=re-(we.clickY-this.start.y),Oe=Math.min($e,Oe),Oe=Math.max(Pe.x+5,Oe),je=Math.min(be.y-5,je),je=Math.max(0,je),this.updateOutline({start:{x:Pe.x,y:je},end:{x:Oe,y:be.y}})):we.operator==="n-resize"?(Ge=re-(we.clickY-this.start.y),Ge=Math.min(be.y-5,Ge),Ge=Math.max(0,Ge),this.updateOutline({start:{x:Pe.x,y:Ge},end:be})):we.operator==="move"&&(Xe=Q-(we.clickX-this.start.x),qe=re-(we.clickY-this.start.y),Ke=Q-(we.clickX-this.end.x),Je=re-(we.clickY-this.end.y),rt={width:Math.abs(Pe.x-be.x),height:Math.abs(Pe.y-be.y)},Xe<Ke?(Xe=Math.max(0,Xe),Xe=Math.min($e-rt.width,Xe),Ke=Math.max(rt.width,Ke),Ke=Math.min($e,Ke)):(Ke=Math.max(0,Ke),Ke=Math.min($e-rt.width,Ke),Xe=Math.max(rt.width,Xe),Xe=Math.min($e,Xe)),qe<Je?(qe=Math.max(0,qe),qe=Math.min(Me-rt.height,qe),Je=Math.max(rt.height,Je),Je=Math.min(Me,Je)):(Je=Math.max(0,Je),Je=Math.min(Me-rt.height,Je),qe=Math.max(rt.height,qe),qe=Math.min(Me,qe)),this.updateOutline({start:{x:Xe,y:qe},end:{x:Ke,y:Je}})),gt.next=32;break;case 19:if(this.startPoint){gt.next=21;break}return gt.abrupt("return");case 21:return isMobileDevice$1?(vt=H.changedTouches[0].clientX-this.pageViewer.div.getBoundingClientRect().left,Ct=H.changedTouches[0].clientY-this.pageViewer.div.getBoundingClientRect().top,ht={x:vt/this.scale,y:Ct/this.scale}):(kt=H.offsetX,mt=H.offsetY,ht={x:(kt+this.rect.left-this.margin-this.borderWidth)/this.scale,y:(mt+this.rect.top-this.margin-this.borderWidth)/this.scale}),this.endPoint=ht,gt.next=25,this.getCharsRange(this.startPoint,ht);case 25:Vt=gt.sent,bt=Vt.start,ot=Vt.end,this.activeCharPlace=ot,this.selectedCharRange={start:bt,end:ot},this.cursor.style.display="none",this.updateSelectedRect(!0);case 32:this.mouseMoved=!0;case 33:case"end":return gt.stop()}},X,this)})),function(X){return fe.apply(this,arguments)})},{key:"handleClick",value:function(){}},{key:"handleBlur",value:function(){}},{key:"handleTextOutside",value:function(){this.cursor&&(this.cursor.style.display="none")}},{key:"handleOutside",value:(J=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce=this;return _regeneratorRuntime().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(!this.moving){Ee.next=14;break}return te=[this.textContainer,this.outerLine],(Q=document.querySelector(".editor-panel"))&&te.push(Q),(re=document.getElementById("editorPropertyPanelButton"))&&te.push(re),(Pe=document.getElementById("undo"))&&te.push(Pe),(be=document.getElementById("redo"))&&te.push(be),(we=document.querySelector(".content-editor-popup"))&&te.push(we),onClickOutsideUp(te,this.handleOutside.bind(this)),Ee.abrupt("return");case 14:if(this.state=this.state===2?1:this.state===1?0:this.state,(H=this.frameContainer)===null||H===void 0||H.classList.remove("editing"),this.clearSelectText(),(U=this.cursor)===null||U===void 0||U.remove(),this.cursor=null,this.state===0&&((Ae=this.frameContainer)===null||Ae===void 0||Ae.classList.remove("selected"),($e=this.outerLineContainer)===null||$e===void 0||$e.remove(),this.removed||this.contentContainer.setSelectedEditBox(null),setTimeout(function(){document.querySelector(".frame-container.selected")||(Ce.eventBus.dispatch("contentPropertyChange",{type:"text",isOpen:!1}),Ce.eventBus.dispatch("changeRightPanelBtnDisabled",!0),Ce.eventBus.dispatch("contentBoxDeselected",{type:"text",pageNumber:Ce.pageViewer.pageIndex+1}))},1),this.hidePopup()),this.state!==1){Ee.next=29;break}return Ee.next=23,this.getText();case 23:if(Ee.sent.length!==0){Ee.next=27;break}return this.remove(),Ee.abrupt("return");case 27:this.textContainer.removeEventListener(this.mousemove,this.onMousemove),this.hidden||(this.container.append(this.outerLineContainer),Me=[this.textContainer,this.outerLine],(Ie=document.querySelector(".editor-panel"))&&Me.push(Ie),(Le=document.getElementById("editorPropertyPanelButton"))&&Me.push(Le),(le=document.getElementById("undo"))&&Me.push(le),(oe=document.getElementById("redo"))&&Me.push(oe),(ke=document.querySelector(".content-editor-popup"))&&Me.push(ke),onClickOutsideUp(Me,this.handleOutside.bind(this)),this.showPopup(!1));case 29:this.textarea.removeEventListener("blur",this.onBlur),this.textarea.removeEventListener("keydown",this.onKeydown),this.textarea.removeEventListener("keyup",this.onKeyup),this.textarea.removeEventListener(this.textInput,this.onTextInput),(this.isFirefox||isMobileDevice$1)&&(this.textarea.removeEventListener("compositionstart",this.onCompositionstart),this.textarea.removeEventListener("compositionend",this.onCompositionend));case 34:case"end":return Ee.stop()}},X,this)})),function(){return J.apply(this,arguments)})},{key:"handleKeyDown",value:(ve=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce;return _regeneratorRuntime().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(U=H.keyCode||H.which,te=[9,16,17,18,20,27,37,38,39,40,91,93],Q=H.ctrlKey||H.altKey||H.metaKey||te.includes(U),this.isToolKey=Q,this.state===2){Ee.next=6;break}return Ee.abrupt("return");case 6:if(U!==8&&U!==46){Ee.next=37;break}if(this.activeCharPlace.SectionIndex!==0||this.activeCharPlace.LineIndex!==0||this.activeCharPlace.RunIndex!==0||this.activeCharPlace.CharIndex!==-1||this.selectedCharRange){Ee.next=9;break}return Ee.abrupt("return");case 9:if(re={},!this.selectedCharRange){Ee.next=17;break}return Ee.next=13,this.getCharPlace("DeleteChars");case 13:re=Ee.sent,this.selectedCharRange=null,Ee.next=26;break;case 17:if(U!==8){Ee.next=23;break}return Ee.next=20,this.getCharPlace("BackSpaceChar");case 20:re=Ee.sent,Ee.next=26;break;case 23:return Ee.next=25,this.getCharPlace("DeleteChar");case 25:re=Ee.sent;case 26:return this.activeCharPlace=re,this.needUndoRec=!0,Ee.next=30,this.updateCanvas(null,!0);case 30:return this.clearSelectText(),this.updateCursorLine(),Ee.next=34,this.getText();case 34:return Pe=Ee.sent,this.textarea.value=Pe,Ee.abrupt("return");case 37:if(!this.selectedCharRange||Q){Ee.next=47;break}return Ee.next=40,this.getCharPlace("DeleteChars");case 40:return be=Ee.sent,this.activeCharPlace=be,this.selectedCharRange=null,this.needUndoRec=!0,Ee.next=46,this.updateCanvas(null,!0);case 46:this.updateCursorLine();case 47:if(this.isPasteKey=(H.metaKey||H.ctrlKey)&&H.key.toLowerCase()==="v",U!==37){Ee.next=55;break}return Ee.next=51,this.getCharPlace("GetPrevCharPlace");case 51:we=Ee.sent,this.activeCharPlace=we.start,Ee.next=132;break;case 55:if(U!==38){Ee.next=62;break}return Ee.next=58,this.getCharPlace("GetUpCharPlace");case 58:Ae=Ee.sent,this.activeCharPlace=Ae.start,Ee.next=132;break;case 62:if(U!==39){Ee.next=69;break}return Ee.next=65,this.getCharPlace("GetNextCharPlace");case 65:$e=Ee.sent,this.activeCharPlace=$e.start,Ee.next=132;break;case 69:if(U!==40){Ee.next=76;break}return Ee.next=72,this.getCharPlace("GetDownCharPlace");case 72:Me=Ee.sent,this.activeCharPlace=Me.start,Ee.next=132;break;case 76:if(!H.metaKey&&!H.ctrlKey||H.key.toLowerCase()!=="c"||!this.selectedCharRange){Ee.next=88;break}if(this.pageViewer.documentViewer.getPermission("allowsCopying")){Ee.next=81;break}return this.pageViewer.documentViewer.permissionPasswordCallback(),Ee.abrupt("return",{type:"permission",message:"The document contains a permission password."});case 81:return Ee.next=83,this.getText();case 83:return this.selectedText=Ee.sent,copyToClipboard$1(this.selectedText),Ee.abrupt("return");case 88:if(!H.metaKey&&!H.ctrlKey||H.key.toLowerCase()!=="x"||!this.selectedCharRange){Ee.next=111;break}if(this.pageViewer.documentViewer.getPermission("allowsCopying")){Ee.next=93;break}return this.pageViewer.documentViewer.permissionPasswordCallback(),Ee.abrupt("return",{type:"permission",message:"The document contains a permission password."});case 93:return Ee.next=95,this.getText();case 95:return this.selectedText=Ee.sent,copyToClipboard$1(this.selectedText),Ee.next=99,this.getCharPlace("DeleteChars");case 99:return Ie=Ee.sent,this.activeCharPlace=Ie,this.selectedCharRange=null,this.needUndoRec=!0,Ee.next=105,this.getText();case 105:return Le=Ee.sent,this.textarea.value=Le,Ee.next=109,this.updateCanvas(null,!0);case 109:Ee.next=132;break;case 111:if(!H.metaKey&&!H.ctrlKey||H.key.toLowerCase()!=="a"){Ee.next=131;break}return Ee.next=114,this.getEntireCharPlace();case 114:return le=Ee.sent,oe=le.start,ke=le.end,this.selectedCharRange={start:oe,end:ke},Ee.next=120,this.getCharsRect(oe,ke);case 120:if((Ce=Ee.sent)!=null&&Ce.length){Ee.next=123;break}return Ee.abrupt("return");case 123:return this.selectedRects=Ce,Ee.next=126,this.getText();case 126:return this.selectedText=Ee.sent,this.selectText(),Ee.abrupt("return");case 131:return Ee.abrupt("return");case 132:return this.clearSelectText(),this.updateCursorLine(),Ee.next=136,this.getTextStyle();case 136:case"end":return Ee.stop()}},X,this)})),function(X){return ve.apply(this,arguments)})},{key:"handleKeyup",value:function(X){this.textarea.setSelectionRange(0,0)}},{key:"handleTextInput",value:(ne=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(!this.isToolKey||this.isPasteKey){te.next=2;break}return te.abrupt("return");case 2:if(U=H.data,!this.isFirefox&&!isMobileDevice$1){te.next=10;break}if(H.inputType!=="insertLineBreak"){te.next=8;break}U=`
`,te.next=10;break;case 8:if(!this.composing&&U!==null){te.next=10;break}return te.abrupt("return");case 10:if(_classPrivateFieldGet2(_editList,this).push(U),!(_classPrivateFieldGet2(_editList,this).length>1)){te.next=13;break}return te.abrupt("return");case 13:this.handleInsertText();case 14:case"end":return te.stop()}},X,this)})),function(X){return ne.apply(this,arguments)})},{key:"handleInsertText",value:(_e=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H;return _regeneratorRuntime().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this.messageHandler.sendWithPromise("InsertText",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace,text:_classPrivateFieldGet2(_editList,this)[0]});case 2:return H=U.sent,this.activeCharPlace=H,this.addUndoHistory(),this.updateCanvas(),this.updateCursorLine(),U.next=9,this.getTextStyle();case 9:if(_classPrivateFieldGet2(_editList,this).length&&_classPrivateFieldGet2(_editList,this).shift(),!(_classPrivateFieldGet2(_editList,this).length>0)){U.next=13;break}return U.next=13,this.handleInsertText();case 13:case"end":return U.stop()}},X,this)})),function(){return _e.apply(this,arguments)})},{key:"handleCompositionstart",value:function(){this.composing=!0}},{key:"handleCompositionend",value:(Y=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,this.messageHandler.sendWithPromise("InsertText",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace,text:H.data});case 2:return U=te.sent,this.activeCharPlace=U,this.needUndoRec=!0,te.next=7,this.updateCanvas();case 7:return te.next=9,this.updateCursorLine();case 9:this.composing=!1;case 10:case"end":return te.stop()}},X,this)})),function(X){return Y.apply(this,arguments)})},{key:"getRect",value:function(){return this.frame}},{key:"getBoxRect",value:(q=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q;return _regeneratorRuntime().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,this.messageHandler.sendWithPromise("GetFrame",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr});case 2:this.frame=re.sent,H=this.getActualRect(this.scale,this.frame),U=H.start,te=H.end,this.start=U,this.end=te,this.oldRect=this.rect||null,Q=this.rectCalc(U,te),this.rect=Q;case 9:case"end":return re.stop()}},X,this)})),function(){return q.apply(this,arguments)})},{key:"updateCanvas",value:(F=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U,te){var Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe;return _regeneratorRuntime().wrap(function(Ke){for(;;)switch(Ke.prev=Ke.next){case 0:if(this.removed){Ke.next=3;break}return Ke.next=3,this.getBoxRect();case 3:if(Q=this.margin,this.frameContainer&&this.outerLineContainer&&(this.updateOutline({start:this.start,end:this.end}),re=this.getFrameContainerRect(),Pe=re.left,be=re.top,we=re.width,Ae=re.height,setCss(this.frameContainer,{left:Pe+"px",top:be+"px",width:we+"px",height:Ae+"px"})),H?($e=H.oldPoint,Me=H.newPoint,Ie=this.getEntireArea($e,Me),Le=this.getActualRect(this.scale,Ie),le=Le.start,oe=Le.end,ke=this.rectCalc(le,oe),Ce=this.rectCalc($e.start,$e.end),Ee=this.getEntireArea(Ce,this.rect),Be={left:Ee.left,top:Ee.top,width:Ee.right-Ee.left,height:Ee.bottom-Ee.top},parseInt(ke.left)===parseInt(Ee.left)&&parseInt(ke.top)===parseInt(Ee.top)&&parseInt(ke.width)===parseInt(Ee.width)&&parseInt(ke.height)===parseInt(Ee.height)||(ke=Be),Ve={left:parseInt(ke.left*this.ratio),top:parseInt(ke.top*this.ratio),right:parseInt(ke.left*this.ratio)+parseInt(ke.width*this.ratio),bottom:parseInt(ke.top*this.ratio)+parseInt(ke.height*this.ratio),width:parseInt(ke.width*this.ratio),height:parseInt(ke.height*this.ratio)},this.imgRect=Ve,this.canvas.width=(this.rect.width+2*(Q+this.borderWidth))*this.ratio,this.canvas.height=(this.rect.height+2*(Q+this.borderWidth))*this.ratio):U?(Oe=this.getEntireArea(this.oldRect,this.rect),je={left:parseInt(Oe.left*this.ratio),top:parseInt(Oe.top*this.ratio),right:parseInt(Oe.right*this.ratio),bottom:parseInt(Oe.bottom*this.ratio),width:parseInt(Oe.right*this.ratio)-parseInt(Oe.left*this.ratio),height:parseInt(Oe.bottom*this.ratio)-parseInt(Oe.top*this.ratio)},this.imgRect=je,this.canvas.width=(this.rect.width+2*(Q+this.borderWidth))*this.ratio,this.canvas.height=(this.rect.height+2*(Q+this.borderWidth))*this.ratio):(Ge={left:parseInt(this.rect.left*this.ratio),top:parseInt(this.rect.top*this.ratio),right:parseInt(this.rect.left*this.ratio)+parseInt(this.rect.width*this.ratio),bottom:parseInt(this.rect.top*this.ratio)+parseInt(this.rect.height*this.ratio),width:parseInt(this.rect.width*this.ratio),height:parseInt(this.rect.height*this.ratio)},this.imgRect=Ge,this.canvas.width=Ge.width+2*(Q+this.borderWidth)*this.ratio,this.canvas.height=Ge.height+2*(Q+this.borderWidth)*this.ratio),!te){Ke.next=8;break}return Ke.abrupt("return");case 8:if(Xe=null,!this.pageViewer.documentViewer.renderLayerPermission||!this.pageViewer.documentViewer.layers.length){Ke.next=15;break}return Ke.next=12,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top,ocgsPtr:_toConsumableArray$1(this.pageViewer.documentViewer.ocgsPtr)});case 12:Xe=Ke.sent,Ke.next=18;break;case 15:return Ke.next=17,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top});case 17:Xe=Ke.sent;case 18:qe=Xe.imageArray,this.imageArray=qe,this.drawCanvas(),this.saveEdit();case 22:case"end":return Ke.stop()}},X,this)})),function(X,H,U){return F.apply(this,arguments)})},{key:"drawCanvas",value:function(){var X=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.imgRect){if(this.pageViewer.canvas&&!X){var H={x1:0,y1:0};if(this.pageViewer.documentViewer.scale>this.pageViewer.documentViewer.maxViewportZoom){var U=this.pageViewer.documentViewer.getVisibleRegionRect(0,0);H=this.pageViewer.documentViewer.calculatePageVisibility(this.pageViewer.pageIndex+1,U)}var te=this.pageViewer.canvas.getContext("2d"),Q=te.createImageData(parseInt(this.imgRect.width),parseInt(this.imgRect.height));Q.data.set(this.imageArray),te.putImageData(Q,this.imgRect.left-H.x1,this.imgRect.top-H.y1),this.eventBus.dispatch("redrawMarkups",{pageIndex:this.pageViewer.pageIndex,afterContentEdit:!0,rect:this.oldRect?this.getEntireArea(this.oldRect,this.rect):this.rect,pagePtr:this.pagePtr})}}else this.updateCanvas(null,null,X)}},{key:"updateCursorLine",value:(O=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re;return _regeneratorRuntime().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return H&&(this.activeCharPlace=H),Pe.next=3,this.messageHandler.sendWithPromise("GetTextCursorPoints",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 3:if(U=Pe.sent,this.cursor){Pe.next=6;break}return Pe.abrupt("return");case 6:te=this.margin,Q=this.borderWidth,this.cursor.innerHTML="",setCss(this.cursor,{width:this.rect.width+2*(te+Q)+"px",height:this.rect.height+2*(te+Q)+"px"}),re=createSvg("line",{x1:U.HighPointX*this.scale-this.rect.left+te+Q,x2:U.LowPointX*this.scale-this.rect.left+te+Q,y1:U.HighPointY*this.scale-this.rect.top+te+Q,y2:U.LowPointY*this.scale-this.rect.top+te+Q,stroke:"currentcolor"}),this.cursorLine=re,this.cursor.append(re);case 13:case"end":return Pe.stop()}},X,this)})),function(X){return O.apply(this,arguments)})},{key:"getTextStyle",value:(I=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q,re,Pe,be,we;return _regeneratorRuntime().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return Ae.next=2,this.messageHandler.sendWithPromise("GetTextStyle",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 2:return H=Ae.sent,Ae.next=5,this.messageHandler.sendWithPromise("GetBaseFontName",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 5:return U=Ae.sent,Ae.next=8,this.messageHandler.sendWithPromise("GetLineLeading",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 8:return te=Ae.sent,Ae.next=11,this.messageHandler.sendWithPromise("GetSectionAfterLeading",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 11:return Q=Ae.sent,Ae.next=14,this.getEntireCharPlace();case 14:return re=this.selectedCharRange||this.entireCharRange,Ae.next=17,this.messageHandler.sendWithPromise("GetCharacterSpacing",{editAreaPtr:this.editAreaPtr,start:re.start,end:re.end});case 17:return Pe=Ae.sent,be={color:"rgb(".concat(H.R,", ").concat(H.G,", ").concat(H.B,")"),opacity:Math.round(100*H.Transparency),fontStyle:H.IsBold&&H.IsItalic?3:H.IsBold||H.IsItalic?H.IsBold?1:2:0,fontSize:Math.round(H.FontSize),fontFamily:U,lineSpacing:Math.round(10*te)/10,paragraphSpacing:Math.round(10*Q)/10,characterSpacing:Math.max(Math.round(10*Pe)/10,0)},this.textStyle=be,Ae.next=22,this.messageHandler.sendWithPromise("GetTextSectionAlignType",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace});case 22:we=Ae.sent,this.eventBus.dispatch("contentPropertyChange",_objectSpread2$1(_objectSpread2$1({type:"text"},be),{},{alignType:we}));case 24:case"end":return Ae.stop()}},X,this)})),function(){return I.apply(this,arguments)})},{key:"getCharPlace",value:(N=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return U={editAreaPtr:this.editAreaPtr,char:this.activeCharPlace},H==="DeleteChars"&&(U.start=this.selectedCharRange.start,U.end=this.selectedCharRange.end),te.next=4,this.messageHandler.sendWithPromise(H,U);case 4:return te.abrupt("return",te.sent);case 5:case"end":return te.stop()}},X,this)})),function(X){return N.apply(this,arguments)})},{key:"getCharsRange",value:(D=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U){return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,this.messageHandler.sendWithPromise("SelectCharsRangeAtPos",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,startPoint:H,endPoint:U});case 2:return te.abrupt("return",te.sent);case 3:case"end":return te.stop()}},X,this)})),function(X,H){return D.apply(this,arguments)})},{key:"saveEdit",value:function(){this.messageHandler.sendWithPromise("EndEdit",this.editPagePtr),this.needUndoRec&&(this.addUndoHistory(),this.needUndoRec=!1)}},{key:"getText",value:(T=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te;return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(!this.selectedCharRange){Q.next=7;break}return H=this.selectedCharRange,U=H.start,te=H.end,Q.next=4,this.messageHandler.sendWithPromise("GetTextByRange",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,start:U,end:te});case 4:case 9:return Q.abrupt("return",Q.sent);case 7:return Q.next=9,this.messageHandler.sendWithPromise("GetText",this.editAreaPtr);case 10:case"end":return Q.stop()}},X,this)})),function(){return T.apply(this,arguments)})},{key:"getTextByRange",value:(M=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U){return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,this.messageHandler.sendWithPromise("GetTextByRange",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,start:H,end:U});case 2:return te.abrupt("return",te.sent);case 3:case"end":return te.stop()}},X,this)})),function(X,H){return M.apply(this,arguments)})},{key:"insertTextWithIndex",value:(E=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U){return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,this.messageHandler.sendWithPromise("InsertText",{editAreaPtr:this.editAreaPtr,char:{CharIndex:U.index-1,SectionIndex:U.lineIndex},text:H});case 2:return this.needUndoRec=!0,te.next=5,this.updateCanvas(null,!0);case 5:case"end":return te.stop()}},X,this)})),function(X,H){return E.apply(this,arguments)})},{key:"replaceTextWithIndex",value:(S=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U,te){return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,this.messageHandler.sendWithPromise("ReplaceText",{editAreaPtr:this.editAreaPtr,start:{CharIndex:U.index-1,SectionIndex:U.lineIndex},end:{CharIndex:te.index,SectionIndex:te.lineIndex},text:H});case 2:return this.needUndoRec=!0,Q.next=5,this.updateCanvas(null,!0);case 5:case"end":return Q.stop()}},X,this)})),function(X,H,U){return S.apply(this,arguments)})},{key:"replaceAll",value:(P=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){return _regeneratorRuntime().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this.messageHandler.sendWithPromise("ReplaceAll",{editAreaPtr:this.editAreaPtr,text:H});case 2:return this.needUndoRec=!0,U.next=5,this.updateCanvas(null,!0);case 5:case"end":return U.stop()}},X,this)})),function(X){return P.apply(this,arguments)})},{key:"setCharsFontColor",value:(k=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U,te){return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,this.messageHandler.sendWithPromise("SetCharsFontColor",{editAreaPtr:this.editAreaPtr,start:H,end:U,color:te});case 2:return Q.next=4,this.updateCanvas(null,!0);case 4:case"end":return Q.stop()}},X,this)})),function(X,H,U){return k.apply(this,arguments)})},{key:"getContents",value:(x=_asyncToGenerator(_regeneratorRuntime().mark(function X(){return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,this.messageHandler.sendWithPromise("GetText",this.editAreaPtr);case 2:return H.abrupt("return",H.sent);case 3:case"end":return H.stop()}},X,this)})),function(){return x.apply(this,arguments)})},{key:"updateOutline",value:function(X){var H=X.start,U=X.end,te=this.rectCalc(H,U);this.newStart=H,this.newEnd=U;var Q=this.getOutlineRect(te),re=Q.width,Pe=Q.height,be=Q.innerWidth,we=Q.innerHeight,Ae=Q.right,$e=Q.bottom,Me=Q.centerY,Ie=Q.centerX;setCss(this.outerLine,{left:te.left-this.margin-(this.pointWidth+this.borderWidth)/2+"px",top:te.top-this.margin-(this.pointHeight+this.borderWidth)/2+"px",width:re+"px",height:Pe+"px"}),this.moveRect.setAttribute("width",be),this.moveRect.setAttribute("height",we),this.LeftRect.setAttribute("y",Me),this.bottomLeftRect.setAttribute("y",$e),this.bottomRect.setAttribute("x",Ie),this.bottomRect.setAttribute("y",$e),this.bottomRightRect.setAttribute("x",Ae),this.bottomRightRect.setAttribute("y",$e),this.rightRect.setAttribute("x",Ae),this.rightRect.setAttribute("y",Me),this.topRightRect.setAttribute("x",Ae),this.topRect.setAttribute("x",Ie)}},{key:"getCharsRect",value:(y=_asyncToGenerator(_regeneratorRuntime().mark(function X(H,U,te){var Q,re,Pe,be,we,Ae,$e,Me;return _regeneratorRuntime().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(H.SectionIndex!==U.SectionIndex||H.LineIndex!==U.LineIndex||H.RunIndex!==U.RunIndex||H.CharIndex!==U.CharIndex){Ie.next=2;break}return Ie.abrupt("return");case 2:return Ie.next=4,this.messageHandler.sendWithPromise("GetSelectLineRects",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,start:H,end:U});case 4:for(Q=Ie.sent,re=[],Pe=0;Pe<Q.length;Pe++)be={left:Q[Pe].Left,top:Q[Pe].Top,right:Q[Pe].Right,bottom:Q[Pe].Bottom},we=this.getActualRect(this.scale,be),Ae=we.start,$e=we.end,te||(this.start=Ae,this.end=$e),Me=this.rectCalc(Ae,$e,0),re.push(Me);return Ie.abrupt("return",re);case 8:case"end":return Ie.stop()}},X,this)})),function(X,H,U){return y.apply(this,arguments)})},{key:"updateSelectedRect",value:(f=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le;return _regeneratorRuntime().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(this.selectedCharRange){le.next=2;break}return le.abrupt("return");case 2:return Q=this.selectedCharRange,re=Q.start,Pe=Q.end,le.next=5,this.getCharsRect(re,Pe);case 5:if((be=le.sent)!=null&&be.length){le.next=8;break}return le.abrupt("return");case 8:if(we=(U=this.selectedRects)===null||U===void 0?void 0:U[this.selectedRects.length-1],!H||(we==null?void 0:we.left)!==be[0].left||(we==null?void 0:we.top)!==be[0].top||(we==null?void 0:we.width)!==be[0].width||(we==null?void 0:we.height)!==be[0].height){le.next=12;break}return this.selectedRects=be,le.abrupt("return");case 12:if(Ae=this.canvas.getContext("2d"),(te=this.selectedRects)===null||te===void 0||!te.length){le.next=26;break}$e=Math.max(this.selectedRects.length,be.length),Me=0;case 16:if(!(Me<$e)){le.next=25;break}if(Ie=this.selectedRects[Me],Le=be[Me],(Ie==null?void 0:Ie.left)!==(Le==null?void 0:Le.left)||(Ie==null?void 0:Ie.top)!==(Le==null?void 0:Le.top)||(Ie==null?void 0:Ie.width)!==(Le==null?void 0:Le.width)||(Ie==null?void 0:Ie.height)!==(Le==null?void 0:Le.height)){le.next=21;break}return le.abrupt("continue",22);case 21:Ae.clearRect(0,0,this.canvas.width,this.canvas.height);case 22:Me++,le.next=16;break;case 25:this.drawCanvas(!0);case 26:this.selectedRects=be,this.selectText(),this.updateCursorLine();case 29:case"end":return le.stop()}},X,this)})),function(X){return f.apply(this,arguments)})},{key:"selectText",value:function(){var X;if((X=this.selectedRects)!==null&&X!==void 0&&X.length){var H=this.canvas.getContext("2d");H.clearRect(0,0,this.canvas.width,this.canvas.height);var U,te=this.margin,Q=this.borderWidth,re=_createForOfIteratorHelper(this.selectedRects);try{for(re.s();!(U=re.n()).done;){var Pe=U.value;H.beginPath(),H.fillStyle="rgba(0, 117, 255, 0.3)",H.fillRect((Pe.left-this.rect.left+te+Q)*this.ratio,(Pe.top-this.rect.top+te+Q)*this.ratio,Pe.width*this.ratio,Pe.height*this.ratio)}}catch(be){re.e(be)}finally{re.f()}}}},{key:"clearSelectText",value:function(){var X;(X=this.selectedRects)!==null&&X!==void 0&&X.length&&(this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.updateCanvas()),this.selectedRects=null,this.selectedCharRange=null,this.selectedText=""}},{key:"setTextStyle",value:(d=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){return _regeneratorRuntime().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this.handlePropertyPanelChanged(H,!0);case 2:case"end":return U.stop()}},X,this)})),function(X){return d.apply(this,arguments)})},{key:"setContent",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te;return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,this.getEntireCharPlace();case 2:return U=Q.sent,te=U.end,this.activeCharPlace=te,Q.next=7,this.handleCompositionend({data:H});case 7:case"end":return Q.stop()}},X,this)})),function(X){return g.apply(this,arguments)})},{key:"handlePropertyPanelChanged",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U,te,Q,re,Pe,be=arguments;return _regeneratorRuntime().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(U=be.length>1&&be[1]!==void 0&&be[1],this.state!==0||U){we.next=3;break}return we.abrupt("return");case 3:return te=!1,we.next=6,this.getEntireCharPlace();case 6:if(Q=this.selectedCharRange||this.entireCharRange,this.textStyle){we.next=10;break}return we.next=10,this.getTextStyle();case 10:we.t0=_regeneratorRuntime().keys(H);case 11:if((we.t1=we.t0()).done){we.next=74;break}if(re=we.t1.value,H[re]!==this.textStyle[re]){we.next=15;break}return we.abrupt("continue",11);case 15:if(re!=="alignType"){we.next=23;break}if(this.selectedCharRange||this.state!==2){we.next=21;break}return we.next=19,this.messageHandler.sendWithPromise("SetTextAligningSection",{editAreaPtr:this.editAreaPtr,alignType:H.alignType,char:this.activeCharPlace});case 19:we.next=23;break;case 21:return we.next=23,this.messageHandler.sendWithPromise("SetTextAligningRange",{editAreaPtr:this.editAreaPtr,alignType:H.alignType,start:Q.start,end:Q.end});case 23:if(re!=="color"){we.next=26;break}return we.next=26,this.messageHandler.sendWithPromise("SetCharsFontColor",{editAreaPtr:this.editAreaPtr,start:Q.start,end:Q.end,color:H.color});case 26:if(re!=="opacity"){we.next=29;break}return we.next=29,this.messageHandler.sendWithPromise("SetCharsFontTransparency",{editAreaPtr:this.editAreaPtr,start:Q.start,end:Q.end,opacity:H.opacity/100});case 29:if(re!=="fontSize"){we.next=32;break}return we.next=32,this.messageHandler.sendWithPromise("SetCharsFontSize",{editAreaPtr:this.editAreaPtr,start:Q.start,end:Q.end,fontSize:H.fontSize});case 32:if(re!=="fontFamily"){we.next=35;break}return we.next=35,this.messageHandler.sendWithPromise("SetFontFromNativeTrueTypeFont",{editAreaPtr:this.editAreaPtr,start:Q.start,end:Q.end,fontFamily:H.fontFamily});case 35:if(re!=="fontStyle"){we.next=60;break}return Pe=H.fontStyle,we.next=39,this.setCharsFontStyle("ClearCharsFontBold");case 39:return we.next=41,this.refreshSelectedRange();case 41:return we.next=43,this.setCharsFontStyle("ClearCharsFontItalic");case 43:return we.next=45,this.refreshSelectedRange();case 45:if(Pe!==1&&Pe!=="bold"){we.next=50;break}return we.next=48,this.setCharsFontStyle("SetCharsFontBold");case 48:we.next=60;break;case 50:if(Pe!==2&&Pe!=="italic"){we.next=55;break}return we.next=53,this.setCharsFontStyle("SetCharsFontItalic");case 53:we.next=60;break;case 55:if(Pe!==3&&Pe!=="boldItalic"){we.next=60;break}return we.next=58,this.setCharsFontStyle("SetCharsFontBold");case 58:return we.next=60,this.setCharsFontStyle("SetCharsFontItalic");case 60:if(re!=="lineSpacing"){we.next=63;break}return we.next=63,this.messageHandler.sendWithPromise("SetLineLeading",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace,spacing:H.lineSpacing});case 63:if(re!=="paragraphSpacing"){we.next=66;break}return we.next=66,this.messageHandler.sendWithPromise("SetSectionAfterLeading",{editAreaPtr:this.editAreaPtr,char:this.activeCharPlace,spacing:H.paragraphSpacing});case 66:if(re!=="characterSpacing"){we.next=69;break}return we.next=69,this.messageHandler.sendWithPromise("SetCharacterSpacing",{editAreaPtr:this.editAreaPtr,start:Q.start,end:Q.end,spacing:H.characterSpacing});case 69:this.textStyle[re]=H[re],te=!0,this.needUndoRec=!0,we.next=11;break;case 74:if(te){we.next=76;break}return we.abrupt("return");case 76:return we.next=78,this.updateCanvas(null,!0);case 78:if(!this.selectedCharRange||this.state!==2){we.next=81;break}return we.next=81,this.refreshSelectedRange();case 81:this.state===2&&(this.updateSelectedRect(),this.updateCursorLine()),this.showPopup();case 83:case"end":return we.stop()}},X,this)})),function(X){return v.apply(this,arguments)})},{key:"setCharsFontStyle",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return U=this.selectedCharRange||this.entireCharRange,te.next=3,this.messageHandler.sendWithPromise("SetCharsFontStyle",{editAreaPtr:this.editAreaPtr,start:U.start,end:U.end,fontStyle:H});case 3:case"end":return te.stop()}},X,this)})),function(X){return m.apply(this,arguments)})},{key:"hexToRgb",value:function(X){return X=(X=X.replace("#","")).length===3?X.repeat(2):X,{r:parseInt(X.substr(0,2),16),g:parseInt(X.substr(2,2),16),b:parseInt(X.substr(4,2),16)}}},{key:"getEntireArea",value:function(X,H){var U=null;if("start"in X&&"start"in H){var te=this.getInitialPoint(X.start,X.end),Q=this.getInitialPoint(H.start,H.end);U={left:Math.min(te.start.x,Q.start.x),top:Math.min(te.start.y,Q.start.y),right:Math.max(te.end.x,Q.end.x),bottom:Math.max(te.end.y,Q.end.y)}}else"left"in X&&"left"in H&&(U={left:Math.min(X.left,H.left),top:Math.min(X.top,H.top),right:Math.max(X.left+X.width,H.left+H.width),bottom:Math.max(X.top+X.height,H.top+H.height)});return U}},{key:"goEditing",value:function(){this.state=2,this.eventBus.dispatch("changeRightPanelBtnDisabled",!1),this.contentContainer.setSelectedEditBox(this),this.frameContainer.classList.add("selected"),this.frameContainer.classList.add("editing"),this.activeCharPlace={SectionIndex:0,LineIndex:0,RunIndex:0,CharIndex:-1};var X=createSvg("svg",{class:"cursor-animation"},{position:"absolute",left:0,top:0,width:"100%",height:"100%"});this.cursor=X,this.textContainer.append(this.cursor),this.updateCursorLine(),this.textarea.focus(),this.textarea.addEventListener("blur",this.onBlur),this.textarea.addEventListener("keydown",this.onKeydown),this.textarea.addEventListener("keyup",this.onKeyup),this.textarea.addEventListener(this.textInput,this.onTextInput),(this.isFirefox||isMobileDevice$1)&&(this.textarea.addEventListener("compositionstart",this.onCompositionstart),this.textarea.addEventListener("compositionend",this.onCompositionend));var H=[this.textContainer,this.outerLine],U=document.querySelector(".editor-panel");U&&H.push(U);var te=document.getElementById("editorPropertyPanelButton");te&&H.push(te);var Q=document.getElementById("undo");Q&&H.push(Q);var re=document.getElementById("redo");re&&H.push(re);var Pe=document.querySelector(".content-editor-popup");Pe&&H.push(Pe),onClickOutsideUp(H,this.handleOutside.bind(this))}},{key:"remove",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function X(){return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return this.state=0,H.next=3,this.handleOutside();case 3:return H.next=5,this.outerLineContainer.remove();case 5:return this.frameContainer.remove(),this.frameContainer=null,this.contentContainer.setSelectedEditBox(null),this.removed=!0,H.next=11,this.messageHandler.send("RemoveEditAreaByIndex",{editPagePtr:this.editPagePtr,editAreaIndex:this.editAreaIndex});case 11:this.needUndoRec=!0,this.updateCanvas(),this.contentContainer.removeEditor(this.editAreaIndex),this.eventBus.dispatch("contentPropertyChange",{type:"text",isOpen:!1}),this.eventBus._off("textPropertyChanged",this.onHandlePropertyPanelChanged),this.eventBus._off("showContentEditorType",this.onShowContentEditorType),this.eventBus._off("contentEditorPopupClicked",this.onHandlePopup);case 18:case"end":return H.stop()}},X,this)})),function(){return w.apply(this,arguments)})},{key:"removeViewer",value:function(){var X,H;this.state=0,(X=this.outerLineContainer)===null||X===void 0||X.remove(),(H=this.frameContainer)===null||H===void 0||H.remove(),this.frameContainer=null,this.contentContainer.setSelectedEditBox(null),this.removed=!0,this.eventBus.dispatch("contentPropertyChange",{type:"text",isOpen:!1})}},{key:"getEntireCharPlace",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te;return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,this.messageHandler.sendWithPromise("GetBeginAndEndCharPlace",this.editAreaPtr);case 2:return H=Q.sent,U=H.start,te=H.end,this.entireCharRange={start:U,end:te},Q.abrupt("return",{start:U,end:te});case 7:case"end":return Q.stop()}},X,this)})),function(){return s.apply(this,arguments)})},{key:"selectedAllText",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q;return _regeneratorRuntime().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(this.state===1||this.state===2){re.next=2;break}return re.abrupt("return");case 2:return re.next=4,this.getEntireCharPlace();case 4:return H=re.sent,U=H.start,te=H.end,this.selectedCharRange={start:U,end:te},re.next=10,this.getCharsRect(U,te);case 10:if((Q=re.sent)!=null&&Q.length){re.next=13;break}return re.abrupt("return");case 13:return this.selectedRects=Q,re.next=16,this.getText();case 16:this.selectedText=re.sent,this.selectText();case 18:case"end":return re.stop()}},X,this)})),function(){return u.apply(this,arguments)})},{key:"handleShow",value:function(X){X==="image"?(this.hidden=!0,this.frameContainer&&(this.frameContainer.style.display="none"),this.state===1&&this.handleOutside()):(this.hidden=!1,this.frameContainer&&(this.frameContainer.style.display="block"))}},{key:"addUndoHistory",value:function(){this.contentContainer.handleOperateList({editPagePtr:this.editPagePtr,editAreaIndex:this.editAreaIndex,editAreaPtr:this.editAreaPtr,pageIndex:this.pageViewer.pageIndex})}},{key:"updateCanvasAfterUndoRedo",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q,re,Pe,be,we,Ae,$e;return _regeneratorRuntime().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,this.getBoxRect();case 2:if(H=this.margin,this.frameContainer&&this.outerLineContainer&&(this.updateOutline({start:this.start,end:this.end}),U=this.getFrameContainerRect(),te=U.left,Q=U.top,re=U.width,Pe=U.height,setCss(this.frameContainer,{left:te+"px",top:Q+"px",width:re+"px",height:Pe+"px"})),be=this.getEntireArea(this.oldRect,this.rect),we={left:parseInt(be.left*this.ratio),top:parseInt(be.top*this.ratio),right:parseInt(be.right*this.ratio),bottom:parseInt(be.bottom*this.ratio),width:parseInt(be.right*this.ratio)-parseInt(be.left*this.ratio),height:parseInt(be.bottom*this.ratio)-parseInt(be.top*this.ratio)},this.imgRect=we,this.canvas.width=(this.rect.width+2*(H+this.borderWidth))*this.ratio,this.canvas.height=(this.rect.height+2*(H+this.borderWidth))*this.ratio,Ae=null,!this.pageViewer.documentViewer.renderLayerPermission||!this.pageViewer.documentViewer.layers.length){Me.next=16;break}return Me.next=13,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top,ocgsPtr:_toConsumableArray$1(this.pageViewer.documentViewer.ocgsPtr)});case 13:Ae=Me.sent,Me.next=19;break;case 16:return Me.next=18,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top});case 18:Ae=Me.sent;case 19:$e=Ae.imageArray,this.imageArray=$e,this.drawCanvas(),this.saveEdit(),this.contentContainer.getSelectedEditBox()===this&&this.getTextStyle();case 24:case"end":return Me.stop()}},X,this)})),function(){return r.apply(this,arguments)})},{key:"refreshSelectedRange",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q;return _regeneratorRuntime().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return H=this.selectedCharRange||this.entireCharRange,re.next=3,this.messageHandler.sendWithPromise("RefreshRange",{editAreaPtr:this.editAreaPtr,start:H.start,end:H.end});case 3:U=re.sent,te=U.start,Q=U.end,this.selectedCharRange?this.selectedCharRange={start:te,end:Q}:this.entireCharRange={start:te,end:Q},this.activeCharPlace.CharIndex===te.CharIndex?this.activeCharPlace=te:this.activeCharPlace=Q;case 8:case"end":return re.stop()}},X,this)})),function(){return o.apply(this,arguments)})},{key:"showPopup",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function X(){var H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve=arguments;return _regeneratorRuntime().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:if(H=!(Ve.length>0&&Ve[0]!==void 0)||Ve[0],U=this.container.getBoundingClientRect(),this.pageDiv.contains(this.container)){Oe.next=6;break}return Oe.next=5,this.handleOutside();case 5:return Oe.abrupt("return");case 6:if(te=U.left+this.rect.left-this.borderWidth-this.margin,Q=this.rect.top+U.top-this.borderWidth-this.margin,re=te+2*(this.borderWidth+this.margin)+this.rect.width,Pe=Q+2*(this.borderWidth+this.margin)+this.rect.height,be={left:te,top:Q,right:re,bottom:Pe},this.eventBus.dispatch("showContentEditorPopup",{rect:be}),this.isPopupShow=!0,this.state!==1||!H){Oe.next=31;break}if(we=[],Oe.t0=this.selectedCharRange,Oe.t0){Oe.next=20;break}return Oe.next=19,this.getEntireCharPlace();case 19:Oe.t0=Oe.sent;case 20:return Ae=Oe.t0,$e=Ae.start,Me=Ae.end,Oe.next=25,this.getCharsRect($e,Me,!0);case 25:for(Ie=Oe.sent,Le=0;Le<Ie.length;Le++)le=Ie[Le],oe=le.left,ke=le.top,Ce=le.width,Ee=le.height,we.push({left:oe,top:ke,right:oe+Ce,bottom:ke+Ee});return Oe.next=29,this.getText();case 29:Be=Oe.sent,this.eventBus.dispatch("contentSelected",{selectedText:Be,pageNumber:this.pageViewer.pageIndex+1,textRects:we});case 31:case"end":return Oe.stop()}},X,this)})),function(){return n.apply(this,arguments)})},{key:"hidePopup",value:function(){this.isPopupShow&&(this.isPopupShow=!1,this.eventBus.dispatch("showContentEditorPopup"))}},{key:"handlePopup",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(this.state!==0){te.next=2;break}return te.abrupt("return");case 2:te.t0=H,te.next=te.t0==="copy"?5:te.t0==="delete"?14:16;break;case 5:if(this.pageViewer.documentViewer.getPermission("allowsCopying")){te.next=9;break}return this.pageViewer.documentViewer.permissionPasswordCallback(),te.abrupt("return",{type:"permission",message:"The document contains a permission password."});case 9:return te.next=11,this.getText();case 11:return U=te.sent,copyToClipboard$1(U),te.abrupt("break",16);case 14:return this.remove(),te.abrupt("break",16);case 16:case"end":return te.stop()}},X,this)})),function(X){return e.apply(this,arguments)})}]);var e,n,o,r,u,s,w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j}(),ImageEditor=function(){return _createClass(function P(S){var E=S.eventBus,M=S.contentContainer,T=S.container,D=S.pageDiv,N=S.pagePtr,I=S.editPagePtr,O=S.editAreaPtr,F=S.editAreaIndex,q=S.viewport,Y=S.scale,_e=S.messageHandler,ne=S.newAdd,ve=S.pageViewer,J=S.$t,fe=S.hidden;_classCallCheck(this,P),this.eventBus=E,this.contentContainer=M,this.container=T,this.pageDiv=D,this.pagePtr=N,this.editPagePtr=I,this.editAreaPtr=O,this.editAreaIndex=F,this.viewport=q,this.scale=Y,this.messageHandler=_e,this.newAdd=ne,this.pageViewer=ve,this.$t=J,this.hidden=fe,this.type="image",this.deleteSvgStr=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path id="ic" fill-rule="evenodd" clip-rule="evenodd" d="M13 2.75V1.25H7V2.75H13ZM19 5.75V4.25H16.75H3.25H1V5.75H3.25V18.75H16.75V5.75H19ZM4.75 17.25V5.75H15.25V17.25H4.75ZM8.75 8.5V14.5H7.25V8.5H8.75ZM12.75 8.5V14.5H11.25V8.5H12.75Z" fill="currentColor"/>
    </svg>`,this.attrbuteSvgStr=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M8.54546 4.375L16.6666 4.375V5.625L8.54546 5.625C8.29821 6.2358 7.69939 6.66667 6.99994 6.66667C6.30049 6.66667 5.70167 6.2358 5.45442 5.625L3.33325 5.625L3.33325 4.375L5.45442 4.375C5.70167 3.7642 6.30049 3.33333 6.99994 3.33333C7.69939 3.33333 8.29821 3.7642 8.54546 4.375ZM3.33325 10.625L11.2877 10.625C11.5349 11.2358 12.1337 11.6667 12.8332 11.6667C13.5326 11.6667 14.1314 11.2358 14.3787 10.625H16.6666V9.375H14.3787C14.1314 8.7642 13.5326 8.33333 12.8332 8.33333C12.1337 8.33333 11.5349 8.7642 11.2877 9.375L3.33325 9.375L3.33325 10.625ZM5.45432 15.625H3.33325L3.33325 14.375H5.45432C5.70156 13.7642 6.30038 13.3333 6.99984 13.3333C7.69929 13.3333 8.29811 13.7642 8.54535 14.375L16.6666 14.375V15.625L8.54535 15.625C8.29811 16.2358 7.69929 16.6667 6.99984 16.6667C6.30038 16.6667 5.70156 16.2358 5.45432 15.625Z" fill="currentColor"/>
    </svg>`,this.frame=null,this.borderWidth=2,this.pointWidth=6,this.pointHeight=6,this.activeCharPlace=null,this.selectedRects=null,this.selectedCharRange=null,this.state=0,this.mouseDown=!1,this.moving=!1,this.ratio=window.devicePixelRatio||1,this.opacity=1,this.imageRatio=1,this.imageUrl=null,this.cropped=!1,this.removed=!1,this.listener=null,this.start=null,this.end=null,this.newStart=null,this.newEnd=null,this.needUndoRec=!1,this.mousedown=isMobileDevice$1?"touchstart":"mousedown",this.mouseup=isMobileDevice$1?"touchend":"mouseup",this.mousemove=isMobileDevice$1?"touchmove":"mousemove",this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.onHandlePropertyPanelChanged=this.handlePropertyPanelChanged.bind(this),this.onDelete=this.handleDelete.bind(this),this.toggleAttrbutePanel=this.toggleAttrbutePanel.bind(this),this.onShowContentEditorType=this.handleShow.bind(this),this.render()},[{key:"render",value:(k=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return this.eventBus._on("imagePropertyChanged",this.onHandlePropertyPanelChanged),this.eventBus._on("showContentEditorType",this.onShowContentEditorType),D.next=4,this.updateCanvas();case 4:return D.next=6,this.messageHandler.sendWithPromise("GetImageTransparency",this.editAreaPtr);case 6:this.opacity=D.sent,(E=createElement("div",{position:"absolute",left:this.rect.left+"px",top:this.rect.top+"px",width:this.rect.width+"px",height:this.rect.height+"px",display:this.hidden?"none":"block"},{class:"frame-container",index:this.editAreaIndex})).classList.add("image"),this.frameContainer=E,(S=this.container)===null||S===void 0||S.append(this.frameContainer),M=createElement("div",{position:"absolute",left:0,top:0,width:"100%",height:"100%",borderWidth:this.borderWidth+"px",borderColor:"#1460F3"},{class:"image-container"}),this.imageContainer=M,this.frameContainer.append(this.imageContainer),this.imageContainer.addEventListener(this.mousedown,this.onMousedown),this.imageContainer.addEventListener(this.mouseup,this.onMouseup),this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container",this.outerLineContainer.style.position="absolute",this.popupElement=createElement("div",{left:this.rect.left+this.rect.width-80+"px",top:this.rect.top+this.rect.height+12+"px"},{class:"popupElement"}),this.deletetButton=createElement("div",{width:"30px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center"},{class:"delete-button"}),this.deletetButton.addEventListener("click",this.onDelete),this.deletetButton.innerHTML=this.deleteSvgStr,this.attrbuteElement=createElement("div",{width:"30px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center"},{class:"attrbute-button"}),this.attrbuteElement.innerHTML=this.attrbuteSvgStr,this.attrbuteElement.addEventListener("click",this.toggleAttrbutePanel),T=createSvg("svg",{class:"outerline"},{position:"absolute",left:this.rect.left-this.borderWidth+"px",top:this.rect.top-this.borderWidth+"px",width:this.rect.width+this.borderWidth+this.pointWidth/2+"px",height:this.rect.height+this.borderWidth+this.pointHeight/2+"px",zIndex:2}),this.outerLine=T,this.moveRect=createSvg("rect",{class:"move","data-id":"move",stroke:"#1460F3","stroke-width":this.borderWidth,"fill-opacity":0,width:this.rect.width-this.borderWidth,height:this.rect.height-this.borderWidth,x:this.pointWidth/2,y:this.pointHeight/2}),this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:0,y:0}),this.LeftRect=createSvg("rect",{class:"w-resize","data-id":"w-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:0,y:(this.rect.height-this.pointHeight+this.borderWidth)/2}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:0,y:this.rect.height-this.pointHeight/2+this.borderWidth/2}),this.bottomRect=createSvg("rect",{class:"s-resize","data-id":"s-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:(this.rect.width-this.pointWidth+this.borderWidth)/2,y:this.rect.height-this.pointHeight/2+this.borderWidth/2}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:this.rect.width-this.pointWidth/2+this.borderWidth/2,y:this.rect.height-this.pointHeight/2+this.borderWidth/2}),this.rightRect=createSvg("rect",{class:"e-resize","data-id":"e-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:this.rect.width-this.pointWidth/2+this.borderWidth/2,y:(this.rect.height-this.pointHeight+this.borderWidth)/2}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:this.rect.width-this.pointWidth/2+this.borderWidth/2,y:0}),this.topRect=createSvg("rect",{class:"n-resize","data-id":"n-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:(this.rect.width-this.pointWidth+this.borderWidth)/2,y:0}),this.outerLine.append(this.moveRect),this.outerLine.append(this.topLeftRect),this.outerLine.append(this.LeftRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRect),this.outerLine.append(this.bottomRightRect),this.outerLine.append(this.rightRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.topRect),this.outerLineContainer.append(this.outerLine),this.popupElement.append(this.attrbuteElement),this.popupElement.append(this.deletetButton),this.outerLineContainer.append(this.popupElement),this.outerLine.addEventListener(this.mousedown,this.onMousedown),this.outerLine.addEventListener(this.mouseup,this.onMouseup),this.newAdd&&(this.goEditing(),this.addUndoHistory(),this.newAdd=!1),this.initial=!0;case 54:case"end":return D.stop()}},P,this)})),function(){return k.apply(this,arguments)})},{key:"getActualRect",value:function(P,S){var E=S.left,M=S.top,T=S.right,D=S.bottom;return{start:getActualPoint$1({x:E,y:M},P),end:getActualPoint$1({x:T,y:D},P)}}},{key:"rectCalc",value:function(P,S){return{top:P.y<S.y?P.y:S.y,left:P.x<S.x?P.x:S.x,width:Math.abs(S.x-P.x),height:Math.abs(S.y-P.y)}}},{key:"getInitialPoint",value:function(P,S){var E=this.scale;return{start:{x:P.x/E,y:P.y/E},end:{x:S.x/E,y:S.y/E}}}},{key:"handleMouseDown",value:function(P){if(P.preventDefault(),P.button!==2&&!this.hidden){if(this.state>0){var S=P.target.getAttribute("data-id"),E=getClickPoint(P),M=E.pageX,T=E.pageY;this.startState={operator:S,clickX:M,clickY:T},document.addEventListener(this.mousemove,this.onMousemove)}document.addEventListener(this.mouseup,this.onMouseup),this.selectedCharRange=null,this.mouseMoved=!1,this.mouseDown=!0}}},{key:"handleMouseUp",value:(x=_asyncToGenerator(_regeneratorRuntime().mark(function P(S){var E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(this.frameContainer){H.next=2;break}return H.abrupt("return");case 2:if(!S||this.frameContainer.contains(S.target)||this.state!==0){H.next=4;break}return H.abrupt("return");case 4:if((E=this.contentContainer.getSelectedEditBox())===null||E===this||this.state!==0){H.next=7;break}return H.abrupt("return");case 7:if(document.removeEventListener(this.mousemove,this.onMousemove),document.removeEventListener(this.mouseup,this.onMouseup),this.mouseDown){H.next=11;break}return H.abrupt("return");case 11:if(this.mouseDown=!1,this.moving=!1,this.frameContainer.classList.add("selected"),S.type==="touchend"&&(this.pageDiv.style.touchAction=""),this.state!==0||this.imageUrl||this.updateOriginalImageUrl(),this.state===0||this.mouseMoved||this.eventBus.dispatch("contentPropertyChange",{type:"image",isOpen:!0,opacity:100*this.opacity}),this.state===0&&(this.state=1,this.contentContainer.setSelectedEditBox(this),this.container.append(this.outerLineContainer),this.eventBus.dispatch("changeRightPanelBtnDisabled",!1),this.eventBus.dispatch("contentBoxSelected",{type:"image",pageNumber:this.pageViewer.pageIndex+1})),!this.mouseMoved){H.next=31;break}return D={start:this.start,end:this.end},N={start:this.newStart,end:this.newEnd},I=getClickPoint(S),O=I.pageX,F=I.pageY,(O!==((M=this.startState)===null||M===void 0?void 0:M.clickX)||F!==((T=this.startState)===null||T===void 0?void 0:T.clickY))&&this.newStart&&this.newEnd&&(this.start=this.newStart,this.end=this.newEnd),q=this.getInitialPoint(this.start,this.end),Y=q.start,_e=q.end,ne={left:Y.x,top:Y.y,right:_e.x,bottom:_e.y},ve=this.cropped?"SetClipRect":"SetFrame",this.state===2&&(ve="CutWithRect",this.cropped=!0),H.next=29,this.messageHandler.sendWithPromise(ve,{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr,rect:ne});case 29:this.needUndoRec=!0,this.updateCanvas({oldPoint:D,newPoint:N});case 31:J=[this.imageContainer,this.outerLine,this.popupElement],(fe=document.querySelector(".editor-panel"))&&J.push(fe),(Z=document.getElementById("editorPropertyPanelButton"))&&J.push(Z),(j=document.getElementById("undo"))&&J.push(j),(X=document.getElementById("redo"))&&J.push(X),this.listener&&document.removeEventListener(isMobileDevice$1?"touchend":"mouseup",this.listener),this.listener=onClickOutsideUp(J,this.handleOutside.bind(this));case 42:case"end":return H.stop()}},P,this)})),function(P){return x.apply(this,arguments)})},{key:"handleMouseMove",value:(y=_asyncToGenerator(_regeneratorRuntime().mark(function P(S){var E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce;return _regeneratorRuntime().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if((E=this.contentContainer.getSelectedEditBox())===null||E===this||this.state!==0){Ee.next=3;break}return Ee.abrupt("return");case 3:if(this.moving=!0,S.type==="touchmove"&&(this.pageDiv.style.touchAction="none"),M=getClickPoint(S),T=M.pageX,D=M.pageY,N=this.start,I=this.end,O=this.startState){Ee.next=11;break}return Ee.abrupt("return");case 11:if(O.clickX!==T||O.clickY!==D){Ee.next=13;break}return Ee.abrupt("return");case 13:if(F=this.viewport,q=F.width,Y=F.height,O.operator!=="nw-resize"){Ee.next=30;break}if(_e=T-(O.clickX-N.x),ne=D-(O.clickY-N.y),_e=Math.min(I.x-2,_e),_e=Math.max(this.state===2?N.x:0,_e),ne=Math.min(I.y-2,ne),ne=Math.max(this.state===2?N.y:0,ne),this.state!==1){Ee.next=27;break}if(ve=_e-N.x,J=ve*this.imageRatio,!((ne=N.y+J)<0||_e<0||ne>=I.y)){Ee.next=27;break}return Ee.abrupt("return");case 27:this.updateOutline({start:{x:_e,y:ne},end:{x:I.x,y:I.y}}),Ee.next=117;break;case 30:if(O.operator!=="w-resize"){Ee.next=37;break}fe=T-(O.clickX-N.x),fe=Math.min(I.x-2,fe),fe=Math.max(this.state===2?N.x:7,fe),this.updateOutline({start:{x:fe,y:N.y},end:I}),Ee.next=117;break;case 37:if(O.operator!=="sw-resize"){Ee.next=53;break}if(Z=T-(O.clickX-N.x),j=D-(O.clickY-I.y),Z=Math.min(I.x-2,Z),Z=Math.max(this.state===2?N.x:0,Z),j=Math.min(this.state===2?I.y:Y,j),j=Math.max(N.y+2,j),this.state!==1){Ee.next=50;break}if(X=Z-N.x,H=X*this.imageRatio,!((j=I.y-H)>=Y||Z<0||j<=N.y)){Ee.next=50;break}return Ee.abrupt("return");case 50:this.updateOutline({start:{x:Z,y:N.y},end:{x:I.x,y:j}}),Ee.next=117;break;case 53:if(O.operator!=="s-resize"){Ee.next=60;break}U=D-(O.clickY-I.y),U=Math.min(this.state===2?I.y:Y,U),U=Math.max(N.y+2,U),this.updateOutline({start:N,end:{x:I.x,y:U}}),Ee.next=117;break;case 60:if(O.operator!=="se-resize"){Ee.next=76;break}if(te=T-(O.clickX-I.x),Q=D-(O.clickY-I.y),te=Math.min(this.state===2?I.x:q,te),te=Math.max(N.x+2,te),Q=Math.min(this.state===2?I.y:Y,Q),Q=Math.max(N.y+2,Q),this.state!==1){Ee.next=73;break}if(re=I.x-te,Pe=re*this.imageRatio,!((Q=I.y-Pe)>=Y||te>=q||Q-N.y<=0)){Ee.next=73;break}return Ee.abrupt("return");case 73:this.updateOutline({start:{x:N.x,y:N.y},end:{x:te,y:Q}}),Ee.next=117;break;case 76:if(O.operator!=="e-resize"){Ee.next=83;break}be=T-(O.clickX-I.x),be=Math.min(this.state===2?I.x:q,be),be=Math.max(N.x+2,be),this.updateOutline({start:N,end:{x:be,y:I.y}}),Ee.next=117;break;case 83:if(O.operator!=="ne-resize"){Ee.next=99;break}if(we=T-(O.clickX-I.x),Ae=D-(O.clickY-N.y),we=Math.min(this.state===2?I.x:q,we),we=Math.max(N.x+2,we),Ae=Math.min(I.y-2,Ae),Ae=Math.max(this.state===2?N.y:0,Ae),this.state!==1){Ee.next=96;break}if($e=I.x-we,Me=$e*this.imageRatio,!((Ae=N.y+Me)<=0||we>=q||I.y-Ae<=0)){Ee.next=96;break}return Ee.abrupt("return");case 96:this.updateOutline({start:{x:N.x,y:Ae},end:{x:we,y:I.y}}),Ee.next=117;break;case 99:if(O.operator!=="n-resize"){Ee.next=106;break}Ie=D-(O.clickY-N.y),Ie=Math.min(I.y-2,Ie),Ie=Math.max(this.state===2?N.y:0,Ie),this.updateOutline({start:{x:N.x,y:Ie},end:I}),Ee.next=117;break;case 106:if(O.operator!=="move"){Ee.next=117;break}if(this.state!==2){Ee.next=109;break}return Ee.abrupt("return");case 109:Le=T-(O.clickX-N.x),le=D-(O.clickY-N.y),oe=T-(O.clickX-I.x),ke=D-(O.clickY-I.y),Ce={width:Math.abs(N.x-I.x),height:Math.abs(N.y-I.y)},Le<oe?(Le=Math.max(this.state===2?N.x:0,Le),Le=Math.min(this.state===2?I.x-Ce.width:q-Ce.width,Le),oe=Math.max(this.state===2?N.x+Ce.width:Ce.width,oe),oe=Math.min(this.state===2?I.x:q,oe)):(oe=Math.max(this.state===2?N.x:0,oe),oe=Math.min(this.state===2?I.x-Ce.width:q-Ce.width,oe),Le=Math.max(this.state===2?N.x+Ce.width:Ce.width,Le),Le=Math.min(this.state===2?I.x:q,Le)),le<ke?(le=Math.max(this.state===2?N.y:0,le),le=Math.min(this.state===2?I.y-Ce.height:Y-Ce.height,le),ke=Math.max(this.state===2?N.y+Ce.height:Ce.height,ke),ke=Math.min(this.state===2?I.y:Y,ke)):(ke=Math.max(this.state===2?N.y:0,ke),ke=Math.min(this.state===2?I.y-Ce.height:Y-Ce.height,ke),le=Math.max(this.state===2?N.y+Ce.height:Ce.height,le),le=Math.min(this.state===2?I.y:Y,le)),this.updateOutline({start:{x:Le,y:le},end:{x:oe,y:ke}});case 117:this.mouseMoved=!0;case 118:case"end":return Ee.stop()}},P,this)})),function(P){return y.apply(this,arguments)})},{key:"handleOutside",value:(f=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D,N,I,O=this;return _regeneratorRuntime().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!this.moving){F.next=12;break}return M=[this.imageContainer,this.outerLine,this.popupElement],(T=document.querySelector(".editor-panel"))&&M.push(T),(D=document.getElementById("editorPropertyPanelButton"))&&M.push(D),(N=document.getElementById("undo"))&&M.push(N),(I=document.getElementById("redo"))&&M.push(I),onClickOutsideUp(M,this.handleOutside.bind(this)),F.abrupt("return");case 12:this.state=0,this.imageUrl=null,this.removed||this.contentContainer.setSelectedEditBox(null),this.moveRect.style.cursor="all-scroll",this.updateRectStyle(),this.updateOutline({start:this.start,end:this.end}),(S=this.frameContainer)===null||S===void 0||S.classList.remove("editing"),(E=this.frameContainer)===null||E===void 0||E.classList.remove("selected"),this.outerLineContainer.remove(),this.outerLineContainer.append(this.popupElement),setTimeout(function(){document.querySelector(".frame-container.selected")||(O.eventBus.dispatch("contentPropertyChange",{type:"image",isOpen:!1}),O.eventBus.dispatch("changeRightPanelBtnDisabled",!0),O.eventBus.dispatch("contentBoxDeselected",{type:"image",pageNumber:O.pageViewer.pageIndex+1}))},1);case 23:case"end":return F.stop()}},P,this)})),function(){return f.apply(this,arguments)})},{key:"getRect",value:function(){return this.frame}},{key:"getBoxRect",value:(d=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(this.cropped){N.next=4;break}return N.next=3,this.messageHandler.sendWithPromise("GetFrame",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr});case 3:S=N.sent;case 4:return N.next=6,this.messageHandler.sendWithPromise("GetClipRect",{pagePtr:this.pagePtr,editAreaPtr:this.editAreaPtr});case 6:this.frame=N.sent,!S||S.left===this.frame.left&&S.top===this.frame.top&&S.right===this.frame.right&&S.bottom===this.frame.bottom||(this.cropped=!0),E=this.getActualRect(this.scale,this.frame),M=E.start,T=E.end,this.start=M,this.end=T,this.oldRect=this.rect||null,D=this.rectCalc(M,T),this.rect=D,this.imageRatio=this.rect.height/this.rect.width;case 15:case"end":return N.stop()}},P,this)})),function(){return d.apply(this,arguments)})},{key:"updateCanvas",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function P(S,E){var M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j;return _regeneratorRuntime().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(this.removed){X.next=3;break}return X.next=3,this.getBoxRect();case 3:if(this.frameContainer&&this.outerLineContainer&&(this.updateOutline({start:this.start,end:this.end}),setCss(this.frameContainer,{left:this.rect.left+"px",top:this.rect.top+"px",width:this.rect.width+"px",height:this.rect.height+"px"})),S?(M=S.oldPoint,T=S.newPoint,D=this.getEntireArea(M,T),N=this.getActualRect(this.scale,D),I=N.start,O=N.end,F=this.rectCalc(I,O),q=this.rectCalc(M.start,M.end),Y=this.getEntireArea(q,this.rect),_e={left:Y.left,top:Y.top,width:Y.right-Y.left,height:Y.bottom-Y.top},parseInt(F.left)===parseInt(Y.left)&&parseInt(F.top)===parseInt(Y.top)&&parseInt(F.width)===parseInt(Y.width)&&parseInt(F.height)===parseInt(Y.height)||(F=_e),ne={left:parseInt(F.left*this.ratio),top:parseInt(F.top*this.ratio),right:Math.ceil((F.left+F.width)*this.ratio),bottom:Math.ceil((F.top+F.height)*this.ratio),width:Math.ceil(F.width*this.ratio),height:Math.ceil(F.height*this.ratio)},this.imgRect=ne):E?(ve=this.getEntireArea(this.oldRect,this.rect),J={left:parseInt(ve.left*this.ratio),top:parseInt(ve.top*this.ratio),right:parseInt(ve.right*this.ratio),bottom:parseInt(ve.bottom*this.ratio),width:parseInt(ve.right*this.ratio)-parseInt(ve.left*this.ratio),height:parseInt(ve.bottom*this.ratio)-parseInt(ve.top*this.ratio)},this.imgRect=J):(fe={left:parseInt(this.rect.left*this.ratio),top:parseInt(this.rect.top*this.ratio),right:Math.ceil(this.rect.left*this.ratio+this.rect.width*this.ratio),bottom:Math.ceil(this.rect.top*this.ratio+this.rect.height*this.ratio),width:Math.ceil(this.rect.width*this.ratio),height:Math.ceil(this.rect.height*this.ratio)},this.imgRect=fe),this.initial||this.newAdd){X.next=7;break}return X.abrupt("return");case 7:if(Z=null,!this.pageViewer.documentViewer.renderLayerPermission||!this.pageViewer.documentViewer.layers.length){X.next=14;break}return X.next=11,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top,ocgsPtr:_toConsumableArray$1(this.pageViewer.documentViewer.ocgsPtr)});case 11:Z=X.sent,X.next=17;break;case 14:return X.next=16,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top});case 16:Z=X.sent;case 17:j=Z.imageArray,this.imageArray=j,this.drawCanvas(),this.saveEdit();case 21:case"end":return X.stop()}},P,this)})),function(P,S){return g.apply(this,arguments)})},{key:"drawCanvas",value:function(){if(this.imgRect){if(this.pageViewer.canvas){var P=this.pageViewer.canvas.getContext("2d"),S=P.createImageData(parseInt(this.imgRect.right-this.imgRect.left),parseInt(this.imgRect.bottom-this.imgRect.top));S.data.set(this.imageArray),P.putImageData(S,this.imgRect.left,this.imgRect.top)}}else this.updateCanvas()}},{key:"saveEdit",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function P(){return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.messageHandler.sendWithPromise("EndEdit",this.editPagePtr);case 2:this.needUndoRec&&(this.addUndoHistory(),this.needUndoRec=!1);case 3:case"end":return S.stop()}},P,this)})),function(){return v.apply(this,arguments)})},{key:"updateOutline",value:function(P){var S=P.start,E=P.end,M=this.rectCalc(S,E);this.newStart=S,this.newEnd=E,setCss(this.outerLine,{left:M.left-this.borderWidth+"px",top:M.top-this.borderWidth+"px",width:M.width+this.borderWidth+this.pointWidth/2+"px",height:M.height+this.borderWidth+this.pointHeight/2+"px"});var T=M.left+M.width-80+"px",D=M.top+M.height+12+"px";if(this.popupElement.style.left=T,this.popupElement.style.top=D,this.moveRect.setAttribute("width",M.width-this.borderWidth),this.moveRect.setAttribute("height",M.height-this.borderWidth),this.LeftRect.setAttribute("y",(M.height-this.pointHeight+this.borderWidth)/2),this.bottomRect.setAttribute("x",(M.width-this.pointWidth+this.borderWidth)/2),this.bottomRect.setAttribute("y",M.height-this.pointHeight/2+this.borderWidth/2),this.rightRect.setAttribute("x",M.width-this.pointWidth/2+this.borderWidth/2),this.rightRect.setAttribute("y",(M.height-this.pointHeight+this.borderWidth)/2),this.topRect.setAttribute("x",(M.width-this.pointWidth+this.borderWidth)/2),this.state===2){var N=15;this.LeftRect.setAttribute("y",(M.height-N+this.borderWidth)/2),this.topRect.setAttribute("x",(M.width-N+this.borderWidth)/2),this.rightRect.setAttribute("y",(M.height-N+this.borderWidth)/2),this.bottomRect.setAttribute("x",(M.width-N+this.borderWidth)/2),this.topRightRect.setAttribute("d","M".concat(M.width+this.borderWidth/2-N+this.pointWidth/2,",").concat(this.pointWidth/2," H").concat(M.width+this.borderWidth/2," V").concat(N)),this.bottomLeftRect.setAttribute("d","M".concat(this.pointWidth/2,",").concat(M.height+this.borderWidth/2-N+this.pointWidth/2," V").concat(M.height+this.borderWidth/2," H").concat(N)),this.bottomRightRect.setAttribute("d","M".concat(M.width+this.borderWidth/2,",").concat(M.height+this.borderWidth/2-N+this.pointWidth/2," V").concat(M.height+this.borderWidth/2," H").concat(M.width+this.borderWidth/2-N+this.pointWidth/2));var I=M.left-this.rect.left,O=M.top-this.rect.top,F=this.rect.left+this.rect.width-M.left-M.width,q=this.rect.top+this.rect.height-M.top-M.height;switch(this.startState.operator){case"sw-resize":this.frameContainer.style["box-shadow"]="inset ".concat(I,"px ").concat(-q,"px rgba(0, 0, 0, 0.5)");break;case"ne-resize":this.frameContainer.style["box-shadow"]="inset ".concat(-F,"px ").concat(O,"px rgba(0, 0, 0, 0.5)");break;case"nw-resize":case"n-resize":case"w-resize":this.frameContainer.style["box-shadow"]="inset ".concat(I,"px ").concat(O,"px rgba(0, 0, 0, 0.5)");break;case"se-resize":case"s-resize":case"e-resize":this.frameContainer.style["box-shadow"]="inset ".concat(-F,"px ").concat(-q,"px rgba(0, 0, 0, 0.5)")}}else this.bottomLeftRect.setAttribute("y",M.height-this.pointHeight/2+this.borderWidth/2),this.bottomRightRect.setAttribute("x",M.width-this.pointWidth/2+this.borderWidth/2),this.bottomRightRect.setAttribute("y",M.height-this.pointHeight/2+this.borderWidth/2),this.topRightRect.setAttribute("x",M.width-this.pointWidth/2+this.borderWidth/2)}},{key:"setProperty",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function P(S){var E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:M.t0=_regeneratorRuntime().keys(S);case 1:if((M.t1=M.t0()).done){M.next=25;break}if((E=M.t1.value)!=="alignType"){M.next=11;break}if(this.selectedCharRange){M.next=9;break}return M.next=7,this.messageHandler.sendWithPromise("SetTextAligningSection",{editAreaPtr:this.editAreaPtr,alignType:S.alignType,char:activeCharPlace={SectionIndex:0,LineIndex:0,RunIndex:0,CharIndex:-1}});case 7:M.next=11;break;case 9:return M.next=11,this.messageHandler.sendWithPromise("SetTextAligningRange",{editAreaPtr:this.editAreaPtr,alignType:S.alignType,start:this.selectedCharRange.start,end:this.selectedCharRange.end});case 11:if(this.selectedCharRange||E==="alignType"){M.next=14;break}return M.next=14,this.selectAllText();case 14:if(E!=="opacity"){M.next=17;break}return M.next=17,this.messageHandler.sendWithPromise("SetCharsFontTransparency",{editAreaPtr:this.editAreaPtr,start:this.selectedCharRange.start,end:this.selectedCharRange.end,opacity:S.opacity/100});case 17:if(E!=="fontSize"){M.next=20;break}return M.next=20,this.messageHandler.sendWithPromise("SetCharsFontSize",{editAreaPtr:this.editAreaPtr,start:this.selectedCharRange.start,end:this.selectedCharRange.end,fontSize:S.fontSize});case 20:if(E!=="fontFamily"){M.next=23;break}return M.next=23,this.messageHandler.sendWithPromise("SetFontFromNativeTrueTypeFont",{editAreaPtr:this.editAreaPtr,start:this.selectedCharRange.start,end:this.selectedCharRange.end,fontFamily:S.fontFamily});case 23:M.next=1;break;case 25:return M.next=27,this.updateCanvas(null,!0);case 27:case"end":return M.stop()}},P,this)})),function(P){return m.apply(this,arguments)})},{key:"handlePropertyPanelChanged",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function P(S){var E,M=this;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(this.state!==0){T.next=2;break}return T.abrupt("return");case 2:T.t0=_regeneratorRuntime().keys(S);case 3:if((T.t1=T.t0()).done){T.next=48;break}if((E=T.t1.value)!=="rotate"){T.next=9;break}return T.next=8,this.messageHandler.sendWithPromise("RotateImage",{editAreaPtr:this.editAreaPtr,angle:S[E]});case 8:this.needUndoRec=!0;case 9:if(E!=="flip"){T.next=19;break}if(S[E]!=="x"){T.next=15;break}return T.next=13,this.messageHandler.sendWithPromise("HorizontalMirrorImage",this.editAreaPtr);case 13:T.next=18;break;case 15:if(S[E]!=="y"){T.next=18;break}return T.next=18,this.messageHandler.sendWithPromise("VerticalMirrorImage",this.editAreaPtr);case 18:this.needUndoRec=!0;case 19:if(E!=="opacity"){T.next=31;break}if(100*this.opacity!==S.opacity){T.next=22;break}return T.abrupt("return");case 22:return T.next=24,this.messageHandler.sendWithPromise("GetImageTransparency",this.editAreaPtr);case 24:if(100*T.sent!==S.opacity){T.next=27;break}return T.abrupt("return");case 27:return T.next=29,this.messageHandler.sendWithPromise("SetImageTransparency",{editAreaPtr:this.editAreaPtr,opacity:S.opacity/100});case 29:this.opacity=S.opacity/100,this.needUndoRec=!0;case 31:if(E!=="tool"||S.tool!=="replace"){T.next=34;break}return T.next=34,this.uploadFile().then(function(){var D=_asyncToGenerator(_regeneratorRuntime().mark(function N(I){var O,F,q,Y,_e,ne,ve,J,fe,Z,j,X;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return O=I.imageBase64,F=I.width,q=I.height,Y={top:M.frame.top,left:M.frame.left,width:M.frame.right-M.frame.left,height:M.frame.bottom-M.frame.top},(_e=F/q)>Y.width/Y.height?(ne=Y.width,ve=Y.width/_e):(ne=Y.height*_e,ve=Y.height),J=(X={x:Y.left+Y.width/2,y:Y.top+Y.height/2}).x-ne/2,fe=X.x+ne/2,Z=X.y+ve/2,j=X.y-ve/2,H.next=12,M.messageHandler.sendWithPromise("ReplaceImageAreaByStream",{pagePtr:M.pagePtr,editPagePtr:M.editPagePtr,editAreaPtr:M.editAreaPtr,rect:{left:J,right:fe,bottom:Z,top:j},imageBase64:O});case 12:return M.editAreaPtr=H.sent,H.next=15,M.messageHandler.sendWithPromise("GetImageTransparency",M.editAreaPtr);case 15:M.opacity=H.sent,M.eventBus.dispatch("contentPropertyChange",{type:"image",opacity:100*M.opacity}),M.needUndoRec=!0,M.saveEdit();case 19:case"end":return H.stop()}},N)}));return function(N){return D.apply(this,arguments)}}()).catch(function(D){console.error(D)});case 34:if(E!=="tool"||S.tool!=="export"){T.next=37;break}return this.exportImage(this.imageUrl),T.abrupt("return");case 37:if(E!=="tool"||S.tool!=="crop"){T.next=46;break}if(this.state!==2){T.next=40;break}return T.abrupt("return");case 40:return this.state=2,this.frameContainer.classList.add("editing"),this.popupElement.remove(),this.moveRect.style.cursor="auto",this.updateRectStyle(),T.abrupt("return");case 46:T.next=3;break;case 48:return T.next=50,this.updateCanvas(null,!0);case 50:this.updateOriginalImageUrl();case 51:case"end":return T.stop()}},P,this)})),function(P){return w.apply(this,arguments)})},{key:"replaceImage",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function P(S,E,M){var T,D,N,I,O,F,q,Y,_e;return _regeneratorRuntime().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return T={top:this.frame.top,left:this.frame.left,width:this.frame.right-this.frame.left,height:this.frame.bottom-this.frame.top},E=E||this.frame.width,M=M||this.frame.height,(D=E/M)>T.width/T.height?(N=T.width,I=T.width/D):(N=T.height*D,I=T.height),O=(_e={x:T.left+T.width/2,y:T.top+T.height/2}).x-N/2,F=_e.x+N/2,q=_e.y+I/2,Y=_e.y-I/2,ne.next=13,this.messageHandler.sendWithPromise("ReplaceImageAreaByStream",{pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:this.editAreaPtr,rect:{left:O,right:F,bottom:q,top:Y},imageBase64:S});case 13:return this.editAreaPtr=ne.sent,this.needUndoRec=!0,ne.next=17,this.saveEdit();case 17:return ne.next=19,this.updateCanvas(null,!0);case 19:this.updateOriginalImageUrl();case 20:case"end":return ne.stop()}},P,this)})),function(P,S,E){return s.apply(this,arguments)})},{key:"getEntireArea",value:function(P,S){var E=null;if("start"in P&&"start"in S){var M=this.getInitialPoint(P.start,P.end),T=this.getInitialPoint(S.start,S.end);E={left:Math.min(M.start.x,T.start.x),top:Math.min(M.start.y,T.start.y),right:Math.max(M.end.x,T.end.x),bottom:Math.max(M.end.y,T.end.y)}}else"left"in P&&"left"in S&&(E={left:Math.min(P.left,S.left),top:Math.min(P.top,S.top),right:Math.max(P.left+P.width,S.left+S.width),bottom:Math.max(P.top+P.height,S.top+S.height)});return E}},{key:"goEditing",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:this.state=1,this.contentContainer.setSelectedEditBox(this),this.frameContainer.classList.add("selected"),this.container.append(this.outerLineContainer),this.imageUrl||this.updateOriginalImageUrl(),S=[this.imageContainer,this.outerLine,this.popupElement],(E=document.querySelector(".editor-panel"))&&S.push(E),(M=document.getElementById("editorPropertyPanelButton"))&&S.push(M),(T=document.getElementById("undo"))&&S.push(T),(D=document.getElementById("redo"))&&S.push(D),onClickOutsideUp(S,this.handleOutside.bind(this));case 15:case"end":return N.stop()}},P,this)})),function(){return u.apply(this,arguments)})},{key:"toggleAttrbutePanel",value:function(){this.eventBus.dispatch("toggleAttrbutePanel","editor")}},{key:"handleDelete",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function P(){return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.handleOutside();case 2:return this.removed=!0,this.outerLineContainer.remove(),this.frameContainer.remove(),this.frameContainer=null,this.contentContainer.setSelectedEditBox(null),S.next=9,this.messageHandler.send("RemoveEditArea",{editPagePtr:this.editPagePtr,editAreaPtr:this.editAreaPtr});case 9:this.needUndoRec=!0,this.updateCanvas(),this.contentContainer.removeEditor(this.editAreaIndex),this.eventBus.dispatch("contentPropertyChange",{type:"image",isOpen:!1});case 13:case"end":return S.stop()}},P,this)})),function(){return r.apply(this,arguments)})},{key:"remove",value:function(){this.handleDelete()}},{key:"removeViewer",value:function(){var P,S,E;this.state=0,this.removed=!0,(P=this.outerLineContainer)===null||P===void 0||P.remove(),(S=this.frameContainer)===null||S===void 0||S.remove(),this.frameContainer=null,(E=this.contentContainer)===null||E===void 0||E.setSelectedEditBox(null),this.eventBus.dispatch("contentPropertyChange",{type:"image",isOpen:!1})}},{key:"uploadFile",value:function(){var P=this;return new Promise(function(S,E){var M=document.createElement("input");M.type="file",M.accept=".jpg, .jpeg, .png",M.onchange=function(){var T=M.files[0];if(T.size>2097152)return E(P.$t("contentEditor.imageProperties.maxSize")),M.remove(),void window.$message.error(P.$t("contentEditor.imageProperties.maxSize"),{duration:3e3});if(T){var D=new FileReader;D.onload=function(N){var I=new Image;I.onload=function(){S({imageBase64:N.target.result,width:I.width,height:I.height})},I.onerror=function(O){E(O)},I.src=N.target.result},D.onerror=function(N){E(N)},D.readAsDataURL(T),M.remove()}},M.click()})}},{key:"getImageData",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D,N;return _regeneratorRuntime().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,this.messageHandler.sendWithPromise("GetImageAreaSize",this.editAreaPtr);case 2:return S=I.sent,E=S.width,M=S.height,T=S.stride,I.next=8,this.messageHandler.sendWithPromise("ExtractOriginalImage",{editAreaPtr:this.editAreaPtr,width:E,height:M,stride:T});case 8:return D=I.sent,N=D.imageArray,I.abrupt("return",this.imageArrayToUrl(N,E,M));case 11:case"end":return I.stop()}},P,this)})),function(){return o.apply(this,arguments)})},{key:"updateOriginalImageUrl",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D,N;return _regeneratorRuntime().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,this.messageHandler.sendWithPromise("GetImageAreaSize",this.editAreaPtr);case 2:return S=I.sent,E=S.width,M=S.height,T=S.stride,I.next=8,this.messageHandler.sendWithPromise("ExtractOriginalImage",{editAreaPtr:this.editAreaPtr,width:E,height:M,stride:T});case 8:D=I.sent,N=D.imageArray,this.imageUrl=this.imageArrayToUrl(N,E,M),this.eventBus.dispatch("contentPropertyChange",{type:"image",imageUrl:this.imageUrl,opacity:100*this.opacity});case 12:case"end":return I.stop()}},P,this)})),function(){return n.apply(this,arguments)})},{key:"updateRectStyle",value:function(){if(this.topLeftRect.remove(),this.topRightRect.remove(),this.bottomLeftRect.remove(),this.bottomRightRect.remove(),this.state===2){var P=15;this.LeftRect.setAttribute("height",P),this.LeftRect.setAttribute("y",(this.rect.height-P+this.borderWidth)/2),this.LeftRect.style.cursor="e-resize",this.topRect.setAttribute("width",P),this.topRect.setAttribute("x",(this.rect.width-P+this.borderWidth)/2),this.topRect.style.cursor="s-resize",this.rightRect.setAttribute("height",P),this.rightRect.setAttribute("y",(this.rect.height-P+this.borderWidth)/2),this.rightRect.style.cursor="w-resize",this.bottomRect.setAttribute("width",P),this.bottomRect.setAttribute("x",(this.rect.width-P+this.borderWidth)/2),this.bottomRect.style.cursor="n-resize",this.topLeftRect=createSvg("path",{class:"nw-resize","data-id":"nw-resize",fill:"none",stroke:"#1460F3","stroke-width":this.pointWidth,d:"M".concat(P,",").concat(this.pointWidth/2," H").concat(this.pointWidth/2," V").concat(P)},{cursor:"se-resize"}),this.topRightRect=createSvg("path",{class:"ne-resize","data-id":"ne-resize",fill:"none",stroke:"#1460F3","stroke-width":this.pointWidth,d:"M".concat(this.rect.width+this.borderWidth/2-P+this.pointWidth/2,",").concat(this.pointWidth/2," H").concat(this.rect.width+this.borderWidth/2," V").concat(P)},{cursor:"sw-resize"}),this.bottomLeftRect=createSvg("path",{class:"sw-resize","data-id":"sw-resize",fill:"none",stroke:"#1460F3","stroke-width":this.pointWidth,d:"M".concat(this.pointWidth/2,",").concat(this.rect.height+this.borderWidth/2-P+this.pointWidth/2," V").concat(this.rect.height+this.borderWidth/2," H").concat(P)},{cursor:"ne-resize"}),this.bottomRightRect=createSvg("path",{class:"se-resize","data-id":"se-resize",fill:"none",stroke:"#1460F3","stroke-width":this.pointWidth,d:"M".concat(this.rect.width+this.borderWidth/2,",").concat(this.rect.height+this.borderWidth/2-P+this.pointWidth/2," V").concat(this.rect.height+this.borderWidth/2," H").concat(this.rect.width+this.borderWidth/2-P+this.pointWidth/2)},{cursor:"nw-resize"})}else this.LeftRect.setAttribute("height",this.pointHeight),this.LeftRect.style.cursor="w-resize",this.topRect.setAttribute("width",this.pointWidth),this.topRect.style.cursor="n-resize",this.rightRect.setAttribute("height",this.pointHeight),this.rightRect.style.cursor="e-resize",this.bottomRect.setAttribute("width",this.pointWidth),this.bottomRect.style.cursor="s-resize",this.topLeftRect=createSvg("rect",{class:"nw-resize","data-id":"nw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:0,y:0}),this.topRightRect=createSvg("rect",{class:"ne-resize","data-id":"ne-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:this.rect.width-this.pointWidth/2+this.borderWidth/2,y:0}),this.bottomLeftRect=createSvg("rect",{class:"sw-resize","data-id":"sw-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:0,y:this.rect.height-this.pointHeight/2+this.borderWidth/2}),this.bottomRightRect=createSvg("rect",{class:"se-resize","data-id":"se-resize",fill:"#1460F3",stroke:"none",width:this.pointWidth,height:this.pointHeight,x:this.rect.width-this.pointWidth/2+this.borderWidth/2,y:this.rect.height-this.pointHeight/2+this.borderWidth/2});this.outerLine.append(this.topLeftRect),this.outerLine.append(this.topRightRect),this.outerLine.append(this.bottomLeftRect),this.outerLine.append(this.bottomRightRect)}},{key:"imageArrayToUrl",value:function(P,S,E){var M=document.createElement("canvas"),T=M.getContext("2d");M.width=S,M.height=E;var D=T.createImageData(S,E),N=new Uint8ClampedArray(P.buffer);D.data.set(N),T.putImageData(D,0,0);var I=M.toDataURL("image/png",1);return M.remove(),M=null,I}},{key:"exportImage",value:function(P,S){var E=document.createElement("a");E.href=P,E.download=S||"image",document.body.appendChild(E),E.click(),document.body.removeChild(E)}},{key:"handleShow",value:function(P){P==="text"?(this.hidden=!0,this.frameContainer&&(this.frameContainer.style.display="none"),this.state&&this.handleOutside()):(this.hidden=!1,this.frameContainer&&(this.frameContainer.style.display="block"))}},{key:"addUndoHistory",value:function(){this.contentContainer.handleOperateList({editPagePtr:this.editPagePtr,editAreaIndex:this.editAreaIndex,editAreaPtr:this.editAreaPtr,pageIndex:this.pageViewer.pageIndex})}},{key:"updateCanvasAfterUndoRedo",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E,M,T,D;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.getBoxRect();case 2:if(this.frameContainer&&this.outerLineContainer&&(this.updateOutline({start:this.start,end:this.end}),setCss(this.frameContainer,{left:this.rect.left+"px",top:this.rect.top+"px",width:this.rect.width+"px",height:this.rect.height+"px"})),S=this.getEntireArea(this.oldRect,this.rect),E={left:parseInt(S.left*this.ratio),top:parseInt(S.top*this.ratio),right:Math.ceil(S.right*this.ratio),bottom:Math.ceil(S.bottom*this.ratio),width:parseInt(S.right*this.ratio)-parseInt(S.left*this.ratio),height:parseInt(S.bottom*this.ratio)-parseInt(S.top*this.ratio)},this.imgRect=E,M=null,!this.pageViewer.documentViewer.renderLayerPermission||!this.pageViewer.documentViewer.layers.length){N.next=13;break}return N.next=10,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top,ocgsPtr:_toConsumableArray$1(this.pageViewer.documentViewer.ocgsPtr)});case 10:M=N.sent,N.next=16;break;case 13:return N.next=15,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagePtr,scale:this.scale*this.ratio,left:this.imgRect.left,right:this.imgRect.right,bottom:this.imgRect.bottom,top:this.imgRect.top});case 15:M=N.sent;case 16:if(T=M.imageArray,this.imageArray=T,this.drawCanvas(),this.saveEdit(),this.contentContainer.getSelectedEditBox()!==this){N.next=27;break}return this.updateOriginalImageUrl(),N.next=24,this.messageHandler.sendWithPromise("GetImageTransparency",this.editAreaPtr);case 24:D=N.sent,this.opacity=Math.round(100*D)/100,this.eventBus.dispatch("contentPropertyChange",{type:"image",opacity:100*this.opacity});case 27:case"end":return N.stop()}},P,this)})),function(){return e.apply(this,arguments)})}]);var e,n,o,r,u,s,w,m,v,g,d,f,y,x,k}(),AddText=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.container,s=n.pageViewer,w=n.viewport,m=n.page,v=n.eventBus,g=n.contentContainer;_classCallCheck(this,e),this._tool=o,this.color=r,this.container=u,this.pageViewer=s,this.viewport=w,this.page=m,this.eventBus=v,this.contentContainer=g,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.container.addEventListener("mousedown",this.onMousedown),this.container.addEventListener("touchstart",this.onMousedown),this.container.style.cursor="crosshair",this.container.style.touchAction="none",document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.container.style.cursor="default",this.container.style.touchAction="",this.container.removeEventListener("mousedown",this.onMousedown),this.container.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.container.removeEventListener("mousedown",this.onMousedown),this.container.removeEventListener("touchstart",this.onMousedown)}},{key:"handleMouseDown",value:function(e){var n=this.pageViewer.documentViewer.getContentEditManager();if(e.target.classList&&e.target.classList.contains("contentContainer")&&n.getSelectedEditBox()===null){var o=getAbsoluteCoordinate(this.container,e),r=o.x,u=o.y;this.initStartPoint={x:r,y:u},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this.initStartPoint,n=this.initEndPoint;if(n&&e.x!==n.x&&e.y!==n.y){var o=getInitialPoint$1(e,this.pageViewer.viewport.scale),r=getInitialPoint$1(n,this.pageViewer.viewport.scale),u={x:Math.min(o.x,r.x),y:Math.min(o.y,r.y)},s={x:Math.max(o.x,r.x),y:Math.max(o.y,r.y)},w={rect:{left:u.x,top:u.y,right:s.x,bottom:u.y+16},fontData:{fontName:"Helvetica",fontSize:14,r:0,g:0,b:0,opacity:1,isBold:0,italic:0},alignType:2};this.contentContainer.addTextEditor(w)}else{var m=getInitialPoint$1(e,this.pageViewer.viewport.scale),v={rect:{left:m.x,top:m.y,right:m.x+10,bottom:m.y+16},fontData:{fontName:"Helvetica",fontSize:14,r:0,g:0,b:0,opacity:1,isBold:0,italic:0},alignType:2};this.contentContainer.addTextEditor(v)}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.container,e),o=n.x,r=n.y,u=this.pageViewer.viewport,s=u.width,w=u.height;if(this.pageViewer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",position:"absolute","z-index":3},{class:"add-text"});this.shapeEle=k,this.container.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.pageViewer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}}])}(),AddImage=function(){return _createClass(function e(n){var o=n.tool,r=n.color,u=n.container,s=n.pageViewer,w=n.viewport,m=n.rotation,v=n.page,g=n.eventBus,d=n.contentContainer,f=n.$t;_classCallCheck(this,e),this._tool=o,this.color=r,this.container=u,this.pageViewer=s,this.viewport=w,this.page=v,this.rotation=m,this.eventBus=g,this.contentContainer=d,this.$t=f,this.path=[],this.initStartPoint=null,this.initEndPoint=null,this.shapeEle=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.init()},[{key:"init",value:function(){this.container.addEventListener("mousedown",this.onMousedown),this.container.addEventListener("touchstart",this.onMousedown),this.container.style.cursor="crosshair",this.container.style.touchAction="none",document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"tool",get:function(){return this._tool},set:function(e){e!==this._tool&&(e||(this.reset(),this.container.style.cursor="default",this.container.style.touchAction="",this.container.removeEventListener("mousedown",this.onMousedown),this.container.removeEventListener("touchstart",this.onMousedown)),this._tool=e)}},{key:"reset",value:function(){this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.container.removeEventListener("mousedown",this.onMousedown),this.container.removeEventListener("touchstart",this.onMousedown)}},{key:"handleMouseDown",value:function(e){var n=this.pageViewer.documentViewer.getContentEditManager();if(e.target.classList&&e.target.classList.contains("contentContainer")&&n.getSelectedEditBox()===null){var o=getAbsoluteCoordinate(this.container,e),r=o.x,u=o.y;this.initStartPoint={x:r,y:u},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseUp",value:function(){var e=this,n=this.initStartPoint,o=this.initEndPoint;if(o&&n.x!==o.x&&n.y!==o.y){var r=getInitialPoint$1(n,this.pageViewer.viewport.scale),u=getInitialPoint$1(o,this.pageViewer.viewport.scale),s={x:Math.min(r.x,u.x),y:Math.min(r.y,u.y)},w={x:Math.max(r.x,u.x),y:Math.max(r.y,u.y)},m={left:s.x,top:s.y,right:w.x,bottom:w.y,width:w.x-s.x,height:w.y-s.y};this.uploadFile().then(function(x){var k,P,S=x.imageBase64,E=x.width/x.height;E>m.width/m.height?(k=m.width,P=m.width/E):(k=m.height*E,P=m.height);var M=m.left+m.width/2,T=m.top+m.height/2,D={left:M-k/2,top:T-P/2,right:M+k/2,bottom:T+P/2};e.contentContainer.addImageEditor({rect:D,imageBase64:S})}).catch(function(x){console.error(x)})}else{var v=getInitialPoint$1(n,this.pageViewer.viewport.scale),g=this.pageViewer.viewport.viewBox[2],d=this.pageViewer.viewport.viewBox[3],f=g/2,y=d/2;this.uploadFile().then(function(x){var k=x.imageBase64,P=x.width,S=x.height,E=P,M=S;if(P>f||S>y){var T=P/S;T>f/y?(E=f,M=f/T):(E=y*T,M=y)}var D=null;if((D=e.rotation/90%2>0?{left:v.x-M/2,top:v.y-E/2,right:v.x+M/2,bottom:v.y+E/2}:{left:v.x-E/2,top:v.y-M/2,right:v.x+E/2,bottom:v.y+M/2}).left<7){var N=7-D.left;D.left+=N,D.right+=N}if(D.top<7){var I=7-D.top;D.top+=I,D.bottom+=I}if(D.right>g){var O=D.right-g+7;D.right-=O,D.left-=O}if(D.bottom>d){var F=D.bottom-d+7;D.bottom-=F,D.top-=F}e.contentContainer.addImageEditor({rect:D,imageBase64:k})}).catch(function(x){console.error(x)})}this.initStartPoint=null,this.initEndPoint=null,this.shapeEle&&this.shapeEle.remove(),this.shapeEle=null,this.path=[],document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup)}},{key:"handleMouseMove",value:function(e){var n=getAbsoluteCoordinate(this.container,e),o=n.x,r=n.y,u=this.pageViewer.viewport,s=u.width,w=u.height;if(this.pageViewer.viewport.scale,o=Math.min(s,o),o=Math.max(0,o),r=Math.min(w,r),r=Math.max(0,r),this.initEndPoint={x:o,y:r},this.initStartPoint.x!==this.initEndPoint.x&&this.initStartPoint.y!==this.initEndPoint.y)if(this.shapeEle){if(e.shiftKey){var m=this.initStartPoint,v=this.initEndPoint,g=Math.abs(v.x-m.x),d=Math.abs(v.y-m.y),f=Math.min(g,d);m.x<v.x?v.x=m.x+f:v.x=m.x-f,m.y<v.y?v.y=m.y+f:v.y=m.y-f}var y=this.calculate(this.initStartPoint,this.initEndPoint),x=this.shapeEle;x.style.top="".concat(y.top,"px"),x.style.left="".concat(y.left,"px"),x.style.width="".concat(Math.abs(y.width-1),"px"),x.style.height="".concat(Math.abs(y.height-1),"px")}else{var k=createElement("div",{backgroundColor:"#DDE9FF",position:"absolute","z-index":3},{class:"add-text"});this.shapeEle=k,this.container.append(this.shapeEle)}}},{key:"rectCalc",value:function(e){var n=e.start,o=e.end;return{top:n.y<o.y?n.y:o.y,left:n.x<o.x?n.x:o.x,width:Math.abs(o.x-n.x),height:Math.abs(o.y-n.y)}}},{key:"calculate",value:function(e,n){var o=this.rectCalc({start:e,end:n}),r=1*this.pageViewer.viewport.scale;return{top:o.top-r,left:o.left-r,width:o.width+2*r,height:o.height+2*r}}},{key:"uploadFile",value:function(){var e=this;return new Promise(function(n,o){var r=document.createElement("input");r.type="file",r.accept=".jpg, .jpeg, .png",r.onchange=function(){var u=r.files[0];if(u.size>2097152)return o(e.$t("contentEditor.imageProperties.maxSize")),r.remove(),void window.$message.error(e.$t("contentEditor.imageProperties.maxSize"),{duration:3e3});if(u){var s=new FileReader;s.onload=function(w){var m=new Image;m.onload=function(){n({imageBase64:w.target.result,width:m.width,height:m.height})},m.onerror=function(v){o(v)},m.src=w.target.result},s.onerror=function(w){o(w)},s.readAsDataURL(u),r.remove()}},r.click()})}}])}(),ContentContainer=function(){return _createClass(function f(y){_classCallCheck(this,f),this.pageViewer=y.pageViewer,this.eventBus=y.eventBus,this.pageIndex=y.pageIndex,this.pagePtr=y.pagePtr,this.rotation=y.rotation,this.messageHandler=y.messageHandler,this.pageDiv=y.pageDiv,this.viewport=y.viewport,this.scale=y.scale,this.$t=y.$t,this.historyManager=y.contentEditHistoryManager,this.destroyed=!1,this.rendered=!1,this.isRendering=!1,this.frameEditorList=[],this.tool=this.pageViewer.tool||"",this.color=this.pageViewer.color||"",this.onHandleTool=this.handleTool.bind(this),this.onKeydown=this.handleKeyDown.bind(this)},[{key:"init",value:(d=_asyncToGenerator(_regeneratorRuntime().mark(function f(){return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.update();case 2:return document.addEventListener("keydown",this.onKeydown),this.eventBus._on("toolChanged",this.onHandleTool),y.next=6,this.render();case 6:case"end":return y.stop()}},f,this)})),function(){return d.apply(this,arguments)})},{key:"update",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function f(){var y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,this.messageHandler.sendWithPromise("InitEditPage",{pagePtr:this.pagePtr});case 2:return y=P.sent,x=y.editPagePtr,this.editPagePtr=x,P.next=7,this.messageHandler.sendWithPromise("BeginEdit",{editPagePtr:this.editPagePtr,type:3});case 7:if(!(k=P.sent)||!k.code){P.next=12;break}return this.eventBus.dispatch("message",{type:"ERROR",message:k.message}),console.log(k.message),P.abrupt("return",!1);case 12:this.tool=this.pageViewer.tool||"";case 13:case"end":return P.stop()}},f,this)})),function(){return g.apply(this,arguments)})},{key:"render",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function f(){var y,x,k,P,S,E,M;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!this.contentContainer){T.next=2;break}return T.abrupt("return");case 2:return y=this.isRendering,this.isRendering=!0,(x=document.createElement("div")).className="contentContainer",this.contentContainer=x,this.pageDiv.append(this.contentContainer),this.frameEditorList.forEach(function(D){D.removeViewer()}),this.frameEditorList.length=0,T.prev=10,T.next=13,this.messageHandler.sendWithPromise("GetEditAreaCount",this.editPagePtr);case 13:k=T.sent,P=0;case 15:if(!(P<k)){T.next=37;break}if(!y){T.next=18;break}return T.abrupt("break",37);case 18:return T.next=20,this.messageHandler.sendWithPromise("GetEditArea",{editPagePtr:this.editPagePtr,index:P});case 20:if(S=T.sent){T.next=23;break}return T.abrupt("continue",34);case 23:return T.next=25,this.messageHandler.sendWithPromise("IsTextArea",S);case 25:if(!T.sent){T.next=30;break}return E=new TextEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:S,editAreaIndex:P,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,hidden:this.tool==="addImage"}),this.frameEditorList.push(E),T.abrupt("continue",34);case 30:return T.next=32,this.messageHandler.sendWithPromise("IsImageArea",S);case 32:T.sent&&(M=new ImageEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:S,editAreaIndex:P,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,$t:this.$t,hidden:this.tool==="addText"}),this.frameEditorList.push(M));case 34:P++,T.next=15;break;case 37:return T.prev=37,this.isRendering=!1,T.finish(37);case 40:this.tool==="addText"&&this.addTextManager(),this.tool==="addImage"&&this.addImageManager(),this.destroyed=!1,this.rendered=!0;case 44:case"end":return T.stop()}},f,this,[[10,,37,40]])})),function(){return v.apply(this,arguments)})},{key:"show",value:function(){this.contentContainer.style.display="block"}},{key:"hide",value:function(){this.contentContainer.style.display="none",this.textManager&&(this.textManager.tool="",this.textManager.reset()),this.imageManager&&(this.imageManager.tool="",this.imageManager.reset())}},{key:"cancel",value:function(){var f;!this.destroyed&&this.rendered&&((f=this.contentContainer)===null||f===void 0||f.remove(),this.contentContainer=null,this.textManager&&(this.textManager.tool="",this.textManager.reset()),this.imageManager&&(this.imageManager.tool="",this.imageManager.reset()))}},{key:"destroy",value:function(){var f;!this.destroyed&&this.rendered&&((f=this.contentContainer)===null||f===void 0||f.remove(),this.contentContainer=null,this.textManager&&(this.textManager.tool="",this.textManager.reset()),this.imageManager&&(this.imageManager.tool="",this.imageManager.reset()),this.destroyed=!0,this.eventBus._off("toolChanged",this.onHandleTool),document.removeEventListener("keydown",this.onKeydown),this.messageHandler.sendWithPromise("ClearEditPage",this.editPagePtr))}},{key:"handleTool",value:function(f){var y=f.tool,x=f.color;this.tool=y,this.color=x,this.textManager&&(this.textManager.tool=y,this.textManager.color=x),this.imageManager&&(this.imageManager.tool=y,this.imageManager.color=x),y==="addText"&&(this.imageManager&&(this.imageManager.tool="",this.imageManager.reset()),this.addTextManager()),y==="addImage"&&(this.textManager&&(this.textManager.tool="",this.textManager.reset()),this.addImageManager());var k={addText:"text",addImage:"image"},P=k[this.tool]?k[this.tool]:"";this.eventBus.dispatch("showContentEditorType",P)}},{key:"addTextManager",value:function(){this.textManager?this.textManager.init():this.textManager=new AddText({tool:this.tool,color:this.color,container:this.pageDiv,pageViewer:this.pageViewer,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,page:this.page,eventBus:this.eventBus,contentContainer:this})}},{key:"addImageManager",value:function(){this.imageManager?this.imageManager.init():this.imageManager=new AddImage({tool:this.tool,color:this.color,container:this.pageDiv,pageViewer:this.pageViewer,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,page:this.page,rotation:this.rotation,eventBus:this.eventBus,contentContainer:this,$t:this.$t})}},{key:"addTextEditor",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return x=y.rect,k=y.fontData,P=y.alignType,M.next=3,this.messageHandler.sendWithPromise("CreateNewTextArea",{pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,rect:x,fontData:k,alignType:P});case 3:if(S=M.sent){M.next=6;break}return M.abrupt("return");case 6:if(E=new TextEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:S,editAreaIndex:this.frameEditorList.length,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,newAdd:!0,pageViewer:this.pageViewer}),!y.text){M.next=12;break}return M.next=10,E.handleCompositionend({data:y.text});case 10:E.activeCharPlace={CharIndex:y.text.length-1,LineIndex:0,RunIndex:0,SectionIndex:0},E.updateCursorLine();case 12:return this.frameEditorList.push(E),M.abrupt("return",E);case 14:case"end":return M.stop()}},f,this)})),function(f){return m.apply(this,arguments)})},{key:"addImageEditor",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return x=y.rect,k=y.imageBase64,E.next=3,this.messageHandler.sendWithPromise("CreateNewImageAreaByStream",{pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,rect:x,imageBase64:k});case 3:if(P=E.sent){E.next=6;break}return E.abrupt("return");case 6:S=new ImageEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:P,editAreaIndex:this.frameEditorList.length,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,newAdd:!0,pageViewer:this.pageViewer,$t:this.$t}),this.frameEditorList.push(S);case 8:case"end":return E.stop()}},f,this)})),function(f){return w.apply(this,arguments)})},{key:"removeEditor",value:function(f){this.frameEditorList.splice(f,1),this.frameEditorList.forEach(function(y,x){return y.editAreaIndex=x})}},{key:"handleKeyDown",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x,k,P,S,E;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(x=this.getSelectedEditBox(),k=this.pageViewer.documentViewer,!y.metaKey&&!y.ctrlKey||y.key.toLowerCase()!=="v"||x&&x.state===2){M.next=11;break}if(k.page-1===this.pageIndex){M.next=6;break}return M.abrupt("return");case 6:return P=k.getContentEditManager(),M.next=9,P.pasteAreaInPage(k.page);case 9:M.next=17;break;case 11:if(!y.metaKey&&!y.ctrlKey||y.key.toLowerCase()!=="c"){M.next=17;break}if(!x||x.state!==1){M.next=17;break}return M.next=15,this.copyArea({editPagePtr:x.editPagePtr,editAreaPtr:x.editAreaPtr});case 15:S=M.sent,k.getContentEditManager().setCopyArea({editAreaInfoPtr:S,rect:x.frame});case 17:if(x&&x.state===1&&!document.querySelector(".n-color-picker-panel")&&y.target.className!=="n-input__input-el"){M.next=19;break}return M.abrupt("return");case 19:(E=y.keyCode||y.which)!==8&&E!==46||x.remove();case 21:case"end":return M.stop()}},f,this)})),function(f){return s.apply(this,arguments)})},{key:"copyArea",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return x=y.editPagePtr,k=y.editAreaPtr,S.next=3,this.messageHandler.sendWithPromise("CopyArea",{editPagePtr:x,editAreaPtr:k});case 3:return P=S.sent,S.abrupt("return",P);case 5:case"end":return S.stop()}},f,this)})),function(f){return u.apply(this,arguments)})},{key:"getSelectedEditBox",value:function(){return this.pageViewer.documentViewer.getContentEditManager().getSelectedEditBox()}},{key:"setSelectedEditBox",value:function(f){this.pageViewer.documentViewer.getContentEditManager().setSelectedEditBox(f)}},{key:"handleResetOperate",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(y!=="undo"){x.next=6;break}return x.next=3,this.historyManager.undo();case 3:x.sent,x.next=10;break;case 6:if(y!=="redo"){x.next=10;break}return x.next=9,this.historyManager.redo();case 9:x.sent;case 10:case"end":return x.stop()}},f,this)})),function(f){return r.apply(this,arguments)})},{key:"handleOperateList",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.historyManager.canUndo(y);case 2:if(x.sent){x.next=5;break}return x.abrupt("return");case 5:this.eventBus.dispatch("undoRedoStatusChanged"),this.historyManager.undoList.push(y),this.historyManager.redoList.length=0,this.eventBus.dispatch("changeOperateList",{undoListLength:this.historyManager.undoList.length,redoListLength:this.historyManager.redoList.length}),this.eventBus.dispatch("isContentEditModyfied",!0);case 10:case"end":return x.stop()}},f,this)})),function(f){return o.apply(this,arguments)})},{key:"updateFrameEditor",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x,k,P,S,E,M,T,D;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(x=y.editAreaPtr,k=y.editCharPlace,!(P=this.frameEditorList.find(function(I){return I.editAreaPtr===x}))){N.next=6;break}return P.updateCanvasAfterUndoRedo(),P.type==="text"&&(k.CharIndex!==-1||k.LineIndex!==-1||k.RunIndex!==-1||k.SectionIndex!==-1)&&P.updateCursorLine(k),N.abrupt("return");case 6:return S=[],N.next=9,this.messageHandler.sendWithPromise("GetEditAreaCount",this.editPagePtr);case 9:E=N.sent,M=0;case 11:if(!(M<E)){N.next=32;break}return N.next=14,this.messageHandler.sendWithPromise("GetEditArea",{editPagePtr:this.editPagePtr,index:M});case 14:if(T=N.sent){N.next=17;break}return N.abrupt("continue",29);case 17:return D=void 0,N.next=20,this.messageHandler.sendWithPromise("IsTextArea",T);case 20:if(!N.sent){N.next=24;break}D=new TextEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:T,editAreaIndex:M,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,hidden:this.tool==="addImage",isUpdate:!0}),N.next=28;break;case 24:return N.next=26,this.messageHandler.sendWithPromise("IsImageArea",T);case 26:if(!N.sent){N.next=28;break}D=new ImageEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:T,editAreaIndex:M,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,$t:this.$t,hidden:this.tool==="addText"});case 28:D&&S.push(D);case 29:M++,N.next=11;break;case 32:this.frameEditorList.forEach(function(){var I=_asyncToGenerator(_regeneratorRuntime().mark(function O(F){return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,F.updateCanvas(null,!0);case 2:F.isPopupShow&&F.hidePopup(),F.removeViewer();case 4:case"end":return q.stop()}},O)}));return function(O){return I.apply(this,arguments)}}()),this.frameEditorList.length=0,this.frameEditorList=S;case 35:case"end":return N.stop()}},f,this)})),function(f){return n.apply(this,arguments)})},{key:"addEditArea",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function f(y){var x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return x=null,k.next=3,this.messageHandler.sendWithPromise("IsTextArea",y);case 3:return k.sent&&(x=new TextEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:y,editAreaIndex:this.frameEditorList.length,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,isUpdate:!0,hidden:this.tool==="addImage"})),k.next=7,this.messageHandler.sendWithPromise("IsImageArea",y);case 7:return k.sent&&(x=new ImageEditor({eventBus:this.eventBus,contentContainer:this,container:this.contentContainer,pageDiv:this.pageDiv,pagePtr:this.pagePtr,editPagePtr:this.editPagePtr,editAreaPtr:y,editAreaIndex:this.frameEditorList.length,viewport:this.pageViewer.viewport,scale:this.pageViewer.scale,messageHandler:this.messageHandler,pageViewer:this.pageViewer,$t:this.$t,hidden:this.tool==="addText"})),x&&this.frameEditorList.push(x),k.abrupt("return",x);case 11:case"end":return k.stop()}},f,this)})),function(f){return e.apply(this,arguments)})}]);var e,n,o,r,u,s,w,m,v,g,d}(),_TextSelection_pagePtr,_TextSelection_textPtr;function __awaiter(e,n,o,r){return new(o||(o=Promise))(function(u,s){function w(g){try{v(r.next(g))}catch(d){s(d)}}function m(g){try{v(r.throw(g))}catch(d){s(d)}}function v(g){g.done?u(g.value):function(d){return d instanceof o?d:new o(function(f){f(d)})}(g.value).then(w,m)}v((r=r.apply(e,n||[])).next())})}function __classPrivateFieldGet(e,n,o,r){if(o==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?e!==n||!r:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?r:o==="a"?r.call(e):r?r.value:n.get(e)}function __classPrivateFieldSet(e,n,o,r,u){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?e!==n||!u:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?u.call(e,o):u?u.value=o:n.set(e,o),o}var markupType=isMobileDevice$1?["highlight","underline","squiggly","strikeout","selectText"]:["highlight","underline","squiggly","strikeout","","redaction","remove"],markupTypeNotNull=["highlight","underline","squiggly","strikeout","redaction","remove"],leftSelectedPointerStr=`<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 5.01475C0 2.25333 2.23858 0 5 0H9.94118V5.02941C9.94118 7.77459 7.71577 10 4.97059 10C2.22541 10 0 7.75993 0 5.01475Z" fill="#4982E6"/>
  </svg>`,rightSelectedPointerStr=`<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M9.94116 5.01475C9.94116 2.25333 7.70259 0 4.94116 0H-1.43051e-05V5.02941C-1.43051e-05 7.77459 2.22539 10 4.97057 10C7.71575 10 9.94116 7.75993 9.94116 5.01475Z" fill="#4982E6"/>
  </svg>`,TextSelection=function(){return _createClass(function e(n){_classCallCheck(this,e),_TextSelection_pagePtr.set(this,void 0),_TextSelection_textPtr.set(this,void 0),this._tool=null,this.color=null,this.selecting=!1,this.documentViewer=n.documentViewer,this._selection=null,this.leftSelectedPointer=this.rightSelectedPointer=null,this.messageHandler=n.messageHandler,this.container=n.container||null,__classPrivateFieldSet(this,_TextSelection_textPtr,n.pagePtr.textPtr,"f"),__classPrivateFieldSet(this,_TextSelection_pagePtr,n.pagePtr.pagePtr,"f"),this.selected=n.selected,this.viewport=n.viewport,this.scale=n.scale,this.eventBus=n.eventBus,this.pageIndex=n.pageIndex,this.pageViewer=n.pageViewer,this.handleTool=this.handleTool.bind(this),this.handleToolMode=this.handleToolMode.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleDobuleClick=this.handleDobuleClick.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleTextPopup=this.handleTextPopup.bind(this),this.handleLeftPointerMouseDown=this.handleLeftPointerMouseDown.bind(this),this.handleRightPointerMouseDown=this.handleRightPointerMouseDown.bind(this),this.toolMode=n.toolMode,this.tool=n.tool,this.color=n.color,this.eventBus._on("toolChanged",this.handleTool),this.eventBus._on("toolModeChanged",this.handleToolMode),this.eventBus._on("textPopupClicked",this.handleTextPopup)},[{key:"handleToolMode",value:function(e){e!==this.toolMode&&(this.toolMode=e,document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("touchstart",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("dblclick",this.handleDobuleClick),["view","annotation","redaction"].includes(this.toolMode)&&(document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("touchstart",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleMouseMove),document.addEventListener("dblclick",this.handleDobuleClick)))}},{key:"handleTool",value:function(e){var n=e.tool,o=e.color;this.tool=n,this.color=o,markupType.includes(this.tool)?(document.body.style.userSelect="auto",document.body.style.webkitUserSelect="auto"):(document.body.style.userSelect="none",document.body.style.webkitUserSelect="none")}},{key:"tool",get:function(){return this._tool},set:function(e){if(e!==this._tool||e===""){if(!markupType.includes(e)||this.toolMode==="editor")return document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("touchstart",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("dblclick",this.handleDobuleClick),void(this._tool=e);markupType.includes(e)&&markupType.includes(this.tool)||(document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("touchstart",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleMouseMove),document.addEventListener("dblclick",this.handleDobuleClick)),this._tool=e}}},{key:"testPoint",value:function(e){var n=getAbsoluteCoordinate(this.container,e),o=n.x,r=n.y,u=n.width,s=n.height;return!(o<0||r<0||o>u||r>s)&&{x:o,y:r}}},{key:"handleKeyDown",value:function(e){var n;if(e.key.toLocaleLowerCase()==="c"&&(e.ctrlKey||e.metaKey)){var o=(n=this._selection)===null||n===void 0?void 0:n.textContent;if(o){var r=this.documentViewer.getPermission("allowsCopying");if(!r)return this.documentViewer.permissionPasswordCallback(),{type:"permission",message:"The document contains a permission password."};r&&copyToClipboard$1(o)}}}},{key:"handleMouseDown",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!this.isTargetInElement(e.target,".text-popup")){d.next=2;break}return d.abrupt("return");case 2:if(this.cleanSelection(),o=this.tool,!(r=document.querySelectorAll(".dialog")).length){d.next=13;break}u=0;case 7:if(!(u<r.length)){d.next=13;break}if(!r[u].contains(e.target)){d.next=10;break}return d.abrupt("return");case 10:u++,d.next=7;break;case 13:if(e.target.className==="annotationContainer"||!this.isTargetInElement(e.target,".annotationContainer")||this.isTargetInElement(e.target,".markup")){d.next=15;break}return d.abrupt("return");case 15:if(!this.isTargetInElement(e.target,".text-editor-container")){d.next=17;break}return d.abrupt("return");case 17:if(this.isTargetInElement(e.target,".document-container")||this.isTargetInElement(e.target,".compare-document-container")){d.next=19;break}return d.abrupt("return");case 19:if(markupType.includes(o)){d.next=21;break}return d.abrupt("return");case 21:if(s=this.testPoint(e)){d.next=24;break}return d.abrupt("return");case 24:return w=s.x,m=s.y,v=getInitialPoint$1({x:w,y:m},this.scale),this.startPoint=v,d.next=29,this.isTextAtPoint(v);case 29:g=d.sent,this.selecting=!!g,document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleMouseUp);case 33:case"end":return d.stop()}},n,this)}))}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this.pageViewer.documentViewer.pdfCursorTools.active){y.next=2;break}return y.abrupt("return");case 2:if(!this.isTargetInElement(e.target,".redaction-confirm-dialog")&&!this.isTargetInElement(e.target,".mask")){y.next=4;break}return y.abrupt("return");case 4:if((w=this.testPoint(e))&&!document.querySelector(".annotationContainer .outline-container")){y.next=8;break}return(o=this.container)===null||o===void 0||o.classList.remove("text"),y.abrupt("return");case 8:return m=w.x,v=w.y,g=getInitialPoint$1({x:m,y:v},this.scale),y.next=12,this.isTextAtPoint(g);case 12:if(!(d=y.sent)){y.next=17;break}(r=this.container)===null||r===void 0||r.classList.add("text"),y.next=19;break;case 17:return(u=this.container)===null||u===void 0||u.classList.remove("text"),y.abrupt("return");case 19:if(this.selecting){y.next=21;break}return y.abrupt("return");case 21:if(this.selecting&&d&&(this.selecting==="left"?this.startPoint=g:this.endPoint=g),!this.startPoint||this.startPoint.x!==this.endPoint.x||this.startPoint.y!==this.endPoint.y){y.next=24;break}return y.abrupt("return");case 24:return(s=this.container)===null||s===void 0||s.classList.add("selecting"),y.next=27,this.messageHandler.sendWithPromise("GetCharsRangeAtPos",{pagePtr:__classPrivateFieldGet(this,_TextSelection_pagePtr,"f"),textPtr:__classPrivateFieldGet(this,_TextSelection_textPtr,"f"),start:this.startPoint,end:this.endPoint});case 27:f=y.sent,this._selection=f,this.updateSelection();case 30:case"end":return y.stop()}},n,this)}))}},{key:"handleDobuleClick",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.pageViewer.documentViewer.pdfCursorTools.active){g.next=2;break}return g.abrupt("return");case 2:if(e.stopPropagation(),e.preventDefault(),(r=this.testPoint(e))&&!document.querySelector(".annotationContainer .outline-container")){g.next=8;break}return(o=this.container)===null||o===void 0||o.classList.remove("text"),g.abrupt("return");case 8:return u=r.x,s=r.y,w=getInitialPoint$1({x:u,y:s},this.scale),g.next=12,this.isTextAtPoint(w);case 12:if(g.sent){g.next=15;break}return g.abrupt("return");case 15:return g.next=17,this.messageHandler.sendWithPromise("GetSelectionForWordAtPos",{pagePtr:__classPrivateFieldGet(this,_TextSelection_pagePtr,"f"),textPtr:__classPrivateFieldGet(this,_TextSelection_textPtr,"f"),start:w,end:w});case 17:m=g.sent,this._selection=m,this.updateSelection(),this._selection&&this.textContainer&&["redaction","remove"].includes(this.tool)?(v={operate:"add-annot",type:"redact",pageIndex:this.pageIndex,date:new Date,rect:this.rect,rects:this.rects,color:this.color,erasure:this.tool==="remove",quadPoints:this.quadPoints,contents:this._selection.textContent||void 0},this.tool==="redaction"&&(v.fillColor="rgb(0, 0, 0)"),this.eventBus.dispatch("annotationChange",{type:"add",annotation:v}),this.cleanSelection()):this._selection&&this.textContainer&&this.showTextPopup();case 21:case"end":return g.stop()}},n,this)}))}},{key:"handleMouseUp",value:function(){if(this.selecting&&this._selection&&markupTypeNotNull.includes(this.tool)){var e={operate:"add-annot",type:this.tool,pageIndex:this.pageIndex,date:new Date,opacity:1,quadPoints:this.quadPoints,rect:this.rect,color:this.color,contents:this._selection.textContent||void 0};this.tool!=="redaction"&&this.tool!=="remove"||(e.type="redact",e.rects=this.rects,e.erasure=this.tool==="remove",this.tool==="redaction"&&(e.fillColor="rgb(0, 0, 0)"),delete e.opacity),this.eventBus.dispatch("annotationChange",{type:"add",annotation:e}),this.cleanSelection()}this.selecting=!1,this._selection&&this.textContainer&&this.showTextPopup()}},{key:"updateSelection",value:function(){var e,n,o,r=this._selection.textRects;(e=this.textContainer)===null||e===void 0||(e.textContent=""),!this.leftSelectedPointer&&(this.leftSelectedPointer=this.createSelectionPointer(!0)),!this.rightSelectedPointer&&(this.rightSelectedPointer=this.createSelectionPointer()),(n=this.textContainer)===null||n===void 0||n.append(this.leftSelectedPointer),(o=this.textContainer)===null||o===void 0||o.append(this.rightSelectedPointer);for(var u=[],s=[],w=[],m=[],v=[],g=[],d=0;d<r.length;d++){var f=r[d],y=f.Left,x=f.Top,k=f.Right,P=f.Bottom,S={left:y*this.scale,top:x*this.scale,right:k*this.scale,bottom:P*this.scale};w.push(x),m.push(P),v.push(y),g.push(k);var E={PointX:y,PointY:x},M={PointX:k,PointY:x},T={PointX:y,PointY:P},D={PointX:k,PointY:P};s.push(E,M,T,D),u.push({top:x,left:y,right:k,bottom:P}),d===0&&(this.leftSelectedPointer.style.left=S.left-10+"px",this.leftSelectedPointer.style.top=S.top+"px",this.leftSelectedPointer.style.height=S.bottom-S.top+10+"px"),d===r.length-1&&(this.rightSelectedPointer.style.left=S.right+"px",this.rightSelectedPointer.style.top=S.top+"px",this.rightSelectedPointer.style.height=S.bottom-S.top+10+"px"),this.drawSelection(S)}this.quadPoints=s,this.rects=u;var N=Math.min.apply(Math,w),I=Math.max.apply(Math,m),O=Math.min.apply(Math,v),F=Math.max.apply(Math,g);this.rect={left:O,top:N,right:F,bottom:I}}},{key:"drawSelection",value:function(e){var n,o;this.textContainer||(this.textContainer=document.createElement("div"),this.textContainer.classList.add("text-container"),(n=this.container)===null||n===void 0||n.appendChild(this.textContainer));var r=e.left,u=e.top,s=e.right,w=e.bottom,m=document.createElement("div");return m.classList.add("text-selection"),m.style.left="".concat(r,"px"),m.style.top="".concat(u,"px"),m.style.width="".concat(s-r,"px"),m.style.height="".concat(w-u,"px"),(o=this.textContainer)===null||o===void 0||o.appendChild(m),m}},{key:"createSelectionPointer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=createElement("div",{width:"10px",display:"flex",justifyContent:"center",alignItems:"flex-end",position:"absolute",zIndex:122,cursor:"pointer"},{class:"pointer"});return e?(n.innerHTML=leftSelectedPointerStr,n.addEventListener("mousedown",this.handleLeftPointerMouseDown),n.addEventListener("touchstart",this.handleLeftPointerMouseDown)):(n.innerHTML=rightSelectedPointerStr,n.addEventListener("mousedown",this.handleRightPointerMouseDown),n.addEventListener("touchstart",this.handleRightPointerMouseDown)),n}},{key:"handleLeftPointerMouseDown",value:function(e){e.stopPropagation(),this.eventBus.dispatch("showTextPopup",{show:!1}),this.selecting="left"}},{key:"handleRightPointerMouseDown",value:function(e){e.stopPropagation(),this.eventBus.dispatch("showTextPopup",{show:!1}),this.selecting="right"}},{key:"cleanSelection",value:function(){var e,n,o,r,u,s;this.startPoint=null,this.endPoint=null,this.selecting=!1,(e=this.container)===null||e===void 0||e.classList.remove("selecting"),(n=this.textContainer)===null||n===void 0||n.remove(),this.textContainer=null,this._selection=null,(o=this.leftSelectedPointer)===null||o===void 0||o.addEventListener("mousedown",this.handleLeftPointerMouseDown),(r=this.leftSelectedPointer)===null||r===void 0||r.addEventListener("touchstart",this.handleLeftPointerMouseDown),(u=this.rightSelectedPointer)===null||u===void 0||u.addEventListener("mousedown",this.handleRightPointerMouseDown),(s=this.rightSelectedPointer)===null||s===void 0||s.addEventListener("touchstart",this.handleRightPointerMouseDown),this.leftSelectedPointer=this.rightSelectedPointer=null,document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleMouseUp),this.eventBus.dispatch("showTextPopup",{show:!1})}},{key:"destroy",value:function(){this.cleanSelection(),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("touchstart",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleMouseUp),document.removeEventListener("dblclick",this.handleDobuleClick),this.eventBus._off("toolChanged",this.handleTool),this.eventBus._off("toolModeChanged",this.handleToolMode),this.eventBus._off("textPopupClicked",this.handleTextPopup)}},{key:"showTextPopup",value:function(){var e,n,o=this.container.getBoundingClientRect(),r={left:this.rect.left*this.scale+o.left,top:this.rect.top*this.scale+o.top,right:this.rect.right*this.scale+o.left,bottom:this.rect.bottom*this.scale+o.top};this.eventBus.dispatch("showTextPopup",{show:!0,rect:r,text:(e=this._selection)===null||e===void 0?void 0:e.textContent});for(var u=[],s=0;s<this._selection.textRects.length;s++){var w=this._selection.textRects[s],m=w.Left,v=w.Top,g=w.Right,d=w.Bottom;u.push({left:m,top:v,right:g,bottom:d})}var f={selectedText:(n=this._selection)===null||n===void 0?void 0:n.textContent,pageNumber:this.pageIndex+1,textRects:u};this.eventBus.dispatch("textSelected",f)}},{key:"handleTextPopup",value:function(e){var n;if(this._selection){var o=e.tool,r=e.color,u=(n=this._selection)===null||n===void 0?void 0:n.textContent;if(markupTypeNotNull.includes(o)){var s={operate:"add-annot",type:o,pageIndex:this.pageIndex,date:new Date,opacity:.5,quadPoints:this.quadPoints,rect:this.rect,color:r||"#ff0000",contents:u};this.eventBus.dispatch("annotationChange",{type:"add",annotation:s}),this.cleanSelection(),this.endPoint=null}}}},{key:"isTargetInElement",value:function(e,n){var o=document.querySelector(n);return!(!o||!o.contains(e))}},{key:"isTextAtPoint",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.messageHandler.sendWithPromise("GetCharIndexAtPos",{pagePtr:__classPrivateFieldGet(this,_TextSelection_pagePtr,"f"),textPtr:__classPrivateFieldGet(this,_TextSelection_textPtr,"f"),point:e});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},n,this)}))}}])}();_TextSelection_pagePtr=new WeakMap,_TextSelection_textPtr=new WeakMap;var TextSearch=function(){return _createClass(function e(n){var o=n.container,r=n.viewport,u=n.scale,s=n.pageIndex,w=n.results;_classCallCheck(this,e),this.searchContainer=null,this.activeIndex=0,this.container=null,this.scale=0,this.pageIndex=0,this._searchResults=[],this.color="rgba(255, 255, 0, 0.25)",this.container=o,this.viewport=r,this.scale=u,this.pageIndex=s,this._searchResults=w,w&&w.length&&this.renderSearchResults()},[{key:"searchResults",get:function(){return this._searchResults},set:function(e){this._searchResults=e,this.renderSearchResults()}},{key:"setActiveSearchResult",value:function(e){var n=e.pageNum;e&&(this.searchContainer&&this.searchContainer.querySelectorAll(".searchItems")[e.pageSearchIndex].classList.add("selected"),this.activeIndex=n-1)}},{key:"clearActiveSearchResult",value:function(e){if(this.searchContainer){var n=e.pageSearchIndex;this.searchContainer.querySelectorAll(".searchItems")[n].classList.remove("selected")}}},{key:"renderSearchResults",value:function(){var e=this.scale;if(!this.searchContainer){var n=document.createElement("div");n.className="searchContainer",this.container.appendChild(n),this.searchContainer=n}this.searchContainer.textContent="";for(var o=0;o<this.searchResults.length;o++)if(this.searchResults[o].pageNum===this.pageIndex+1){var r=this.searchResults[o],u=document.createElement("div");u.className="searchItems";for(var s=0;s<r.quads.length;s++){var w=r.quads[s],m=w.left,v=w.top,g={left:m*e,top:v*e,width:w.right*e-m*e,height:w.bottom*e-v*e},d=document.createElement("div");d.className="highlight",d.style.position="absolute",d.style.left="".concat(g.left,"px"),d.style.top="".concat(g.top,"px"),d.style.width="".concat(g.width,"px"),d.style.height="".concat(g.height,"px"),u.appendChild(d)}this.searchContainer.appendChild(u)}}},{key:"destroy",value:function(){this.searchContainer&&(this.searchContainer.parentNode.removeChild(this.searchContainer),this.searchContainer=null)}}])}(),CropPage=function(){return _createClass(function n(o){var r=o.container,u=o.viewport,s=o.scale,w=o.pageIndex,m=o.pagePtr,v=o.eventBus,g=o.messageHandler,d=o.pageViewer,f=o.annotationStore;_classCallCheck(this,n),this.container=r,this.viewport=u,this.scale=s,this.pageIndex=w,this.pagePtr=m.pagePtr,this.eventBus=v,this.messageHandler=g,this.pageViewer=d,this.annotationStore=f,this.startPoint=null,this.endPoint=null,this.listener=null,this.moved=!1,this.mousedown=isMobileDevice$1?"touchstart":"mousedown",this.mouseup=isMobileDevice$1?"touchend":"mouseup",this.mousemove=isMobileDevice$1?"touchmove":"mousemove",this.onDrawMousedown=this.handleDrawMouseDown.bind(this),this.onDrawMouseup=this.handleDrawMouseUp.bind(this),this.onDrawMousemove=this.handleDrawMouseMove.bind(this),this.onMousedown=this.handleMouseDown.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.handlePopup=this.handlePopup.bind(this)},[{key:"init",value:function(){var n=this;this.container.removeEventListener(this.mousedown,this.onDrawMousedown),this.container.addEventListener(this.mousedown,this.onDrawMousedown),setTimeout(function(){n.cropping||(n.container.style.cursor="crosshair"),n.container.style.touchAction="none"}),document.removeEventListener(this.mousemove,this.onDrawMousemove),document.removeEventListener(this.mouseup,this.onDrawMouseup)}},{key:"resetDraw",value:function(){this.startPoint=null,this.endPoint=null,this.container.style.cursor="",document.removeEventListener(this.mousemove,this.onDrawMousemove),document.removeEventListener(this.mouseup,this.onDrawMouseup),this.container.removeEventListener(this.mousedown,this.onDrawMousedown)}},{key:"reset",value:function(){this.startPoint=null,this.endPoint=null,this.cropContainer&&this.cropContainer.remove(),this.cropContainer=null,this.container.style.cursor="auto",this.container.style.touchAction="",document.removeEventListener(this.mousemove,this.onMousemove),document.removeEventListener(this.mouseup,this.onMouseup),this.container.removeEventListener(this.mousedown,this.onDrawMousedown),this.eventBus.dispatch("snipSelected",{rect:null,pageNumber:0}),this.eventBus.dispatch("pageCropped",{rect:null,pageNumber:0}),this.eventBus._off("cropPagePopupClicked",this.handlePopup),this.cropping=!1,this.annotationStore.cropping=!1,document.removeEventListener(this.mousedown,this.listener)}},{key:"getMouseLocation",value:function(n){var o=this.pageViewer.documentViewer.getScrollViewElement(),r=o.scrollLeft||0,u=o.scrollTop||0,s=getClickPoint(n);return{x:s.pageX+r,y:s.pageY+u}}},{key:"handleDrawMouseDown",value:function(n){if(!this.annotationStore.cropping){var o=this.getMouseLocation(n),r=this.pageViewer.documentViewer.windowToPage({x:o.x,y:o.y},this.pageIndex+1),u=r.x,s=r.y;this.startPoint={x:u,y:s},document.addEventListener(this.mousemove,this.onDrawMousemove),document.addEventListener(this.mouseup,this.onDrawMouseup)}}},{key:"handleDrawMouseMove",value:function(n){var o=this.getMouseLocation(n),r=this.pageViewer.documentViewer.windowToPage({x:o.x,y:o.y},this.pageIndex+1),u=r.x,s=r.y,w=this.viewport.viewBox[2],m=this.viewport.viewBox[3];if(u=Math.min(w,u),u=Math.max(0,u),s=Math.min(m,s),s=Math.max(0,s),this.endPoint={x:u,y:s},this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y)if(this.cropContainer){var v=this.rectCalc(this.startPoint,this.endPoint),g=this.cropContainer;g.style.top="".concat(v.top,"px"),g.style.left="".concat(v.left,"px"),g.style.width="".concat(Math.abs(v.width-1),"px"),g.style.height="".concat(Math.abs(v.height-1),"px")}else{var d=createElement("div",{position:"absolute",border:"1px solid #1460F3",cursor:"all-scroll",zIndex:2},{class:"crop-box","data-id":"move"});this.cropContainer=d,this.container.append(this.cropContainer)}}},{key:"handleDrawMouseUp",value:function(){var n=this.startPoint,o=this.endPoint;if(this.resetDraw(),!o||n.x===o.x||n.y===o.y)return this.container.style.cursor="crosshair",void this.container.addEventListener(this.mousedown,this.onDrawMousedown);var r={x:Math.min(n.x,o.x),y:Math.min(n.y,o.y)},u={x:Math.max(n.x,o.x),y:Math.max(n.y,o.y)},s={left:r.x,top:r.y,right:u.x,bottom:u.y};this.rect=s,this.start=r,this.end=u,this.renderCropBox()}},{key:"rectCalc",value:function(n,o){var r=this.viewport.scale,u=(n.y<o.y?n.y:o.y)*r,s=(n.x<o.x?n.x:o.x)*r,w=(n.x>o.x?n.x:o.x)*r,m=(n.y>o.y?n.y:o.y)*r;return{top:u,left:s,right:w,bottom:m,width:w-s,height:m-u}}},{key:"renderCropBox",value:function(){var n=10;this.tl=createElement("div",{position:"absolute",top:"".concat(-5,"px"),left:"".concat(-5,"px"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"nw-resize"},{class:"handle handle-tl","data-id":"nw-resize"}),this.tm=createElement("div",{position:"absolute",top:"".concat(-5,"px"),left:"50%",transform:"translateX(".concat(-5,"px)"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"n-resize"},{class:"handle handle-tm","data-id":"n-resize"}),this.tr=createElement("div",{position:"absolute",top:"".concat(-5,"px"),right:"".concat(-5,"px"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"ne-resize"},{class:"handle handle-tr","data-id":"ne-resize"}),this.mr=createElement("div",{position:"absolute",top:"50%",right:"".concat(-5,"px"),transform:"translateY(".concat(-5,"px)"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"e-resize"},{class:"handle handle-mr","data-id":"e-resize"}),this.br=createElement("div",{position:"absolute",bottom:"".concat(-5,"px"),right:"".concat(-5,"px"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"se-resize"},{class:"handle handle-br","data-id":"se-resize"}),this.bm=createElement("div",{position:"absolute",bottom:"".concat(-5,"px"),left:"50%",transform:"translateX(".concat(-5,"px)"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"s-resize"},{class:"handle handle-bm","data-id":"s-resize"}),this.bl=createElement("div",{position:"absolute",bottom:"".concat(-5,"px"),left:"".concat(-5,"px"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"sw-resize"},{class:"handle handle-bl","data-id":"sw-resize"}),this.ml=createElement("div",{position:"absolute",top:"50%",left:"".concat(-5,"px"),transform:"translateY(".concat(-5,"px)"),width:"".concat(n,"px"),height:"".concat(n,"px"),background:"#1460F3",cursor:"w-resize"},{class:"handle handle-ml","data-id":"w-resize"}),this.cropContainer.append(this.tl),this.cropContainer.append(this.tm),this.cropContainer.append(this.tr),this.cropContainer.append(this.mr),this.cropContainer.append(this.br),this.cropContainer.append(this.bm),this.cropContainer.append(this.bl),this.cropContainer.append(this.ml),this.cropContainer.addEventListener(this.mousedown,this.onMousedown),this.showPopup(),this.eventBus._on("cropPagePopupClicked",this.handlePopup),this.eventBus.dispatch("pageCropped",{rect:this.rect,pageNumber:this.pageIndex+1}),this.cropping=!0,this.annotationStore.cropping=!0,this.listener=onClickOutside$1([this.cropContainer],this.handleOutside.bind(this))}},{key:"handleMouseDown",value:function(n){var o=n.target.getAttribute("data-id"),r=this.getMouseLocation(n),u=this.pageViewer.documentViewer;this.moved=!1;var s=u.windowToPage({x:r.x,y:r.y},this.pageIndex+1),w=s.x,m=s.y;this.startState={operator:o,x:w,y:m},document.addEventListener(this.mousemove,this.onMousemove),document.addEventListener(this.mouseup,this.onMouseup)}},{key:"handleMouseMove",value:function(n){n.type==="touchmove"&&(document.body.style.overscrollBehavior="none");var o=this.getMouseLocation(n),r=this.pageViewer.documentViewer.windowToPage({x:o.x,y:o.y},this.pageIndex+1),u=r.x,s=r.y,w=this.start,m=this.end,v=this.startState,g=this.viewport.viewBox[2],d=this.viewport.viewBox[3];if(this.moved=!0,v.operator==="nw-resize"){var f=u-(v.x-this.start.x),y=s-(v.y-this.start.y);f=Math.min(m.x-5,f),f=Math.max(0,f),y=Math.min(m.y-5,y),y=Math.max(0,y),this.update({start:{x:f,y},end:m})}else if(v.operator==="w-resize"){var x=u-(v.x-this.start.x);x=Math.min(m.x-5,x),x=Math.max(0,x),this.update({start:{x,y:w.y},end:m})}else if(v.operator==="sw-resize"){var k=u-(v.x-this.start.x),P=s-(v.y-this.end.y);k=Math.min(m.x-5,k),k=Math.max(0,k),P=Math.min(d,P),P=Math.max(w.y+5,P),this.update({start:{x:k,y:w.y},end:{x:m.x,y:P}})}else if(v.operator==="s-resize"){var S=s-(v.y-this.end.y);S=Math.min(d,S),S=Math.max(w.y+5,S),this.update({start:w,end:{x:m.x,y:S}})}else if(v.operator==="se-resize"){var E=(v.x,this.end.x),M=(v.y,this.end.y);E=Math.max(w.x+5,u),M=Math.max(w.y+5,s),this.update({start:w,end:{x:E,y:M}})}else if(v.operator==="e-resize"){var T=(v.x,this.end.x);T=Math.max(w.x+5,u),this.update({start:w,end:{x:T,y:m.y}})}else if(v.operator==="ne-resize"){var D=(v.x,this.end.x),N=(v.y,this.start.y);D=Math.max(w.x+5,u),Math.min(m.y-5,s),N=Math.max(0,s),this.update({start:{x:w.x,y:N},end:{x:D,y:m.y}})}else if(v.operator==="n-resize"){var I=(v.y,this.start.y);Math.min(m.y-5,s),I=Math.max(0,s),this.update({start:{x:w.x,y:I},end:m})}else if(v.operator==="move"){var O=u-(v.x-this.start.x),F=s-(v.y-this.start.y),q=u-(v.x-this.end.x),Y=s-(v.y-this.end.y),_e={width:Math.abs(w.x-m.x),height:Math.abs(w.y-m.y)};O<q?(O=Math.max(0,O),O=Math.min(g-_e.width,O),q=Math.max(_e.width,q),q=Math.min(g,q)):(q=Math.max(0,q),q=Math.min(g-_e.width,q),O=Math.max(_e.width,O),O=Math.min(g,O)),F<Y?(F=Math.max(0,F),F=Math.min(d-_e.height,F),Y=Math.max(_e.height,Y),Y=Math.min(d,Y)):(Y=Math.max(0,Y),Y=Math.min(d-_e.height,Y),F=Math.max(_e.height,F),F=Math.min(d,F)),this.update({start:{x:O,y:F},end:{x:q,y:Y}})}}},{key:"handleMouseUp",value:function(n){if(n.type==="touchend"&&(this.layer.pageDiv.style.touchAction=""),document.removeEventListener(this.mousemove,this.onMousemove),document.removeEventListener(this.mouseup,this.onMouseup),this.moved){var o=getClickPoint(n),r=o.pageX,u=o.pageY;r!==this.startState.x||u!==this.startState.y?(this.start=this.newStart,this.end=this.newEnd,this.rect={left:this.start.x,top:this.start.y,right:this.end.x,bottom:this.end.y},this.showPopup(),this.eventBus.dispatch("pageCropped",{rect:this.rect,pageNumber:this.pageIndex+1})):this.showPopup()}}},{key:"update",value:function(n){var o=n.start,r=n.end,u=this.rectCalc(o,r);this.newStart=o,this.newEnd=r,this.cropContainer.style.top=u.top+"px",this.cropContainer.style.left=u.left+"px",this.cropContainer.style.width=u.width+"px",this.cropContainer.style.height=u.height+"px",this.cropContainer.style.width="".concat(u.width,"px"),this.cropContainer.style.height="".concat(u.height,"px"),this.showPopup({left:o.x,top:o.y,right:r.x,bottom:r.y})}},{key:"showPopup",value:function(n){this.eventBus.dispatch("snipSelected",{rect:n||this.rect,pageNumber:this.pageIndex+1})}},{key:"handlePopup",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(o){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o==="close"&&(this.reset(),this.init());case 1:case"end":return r.stop()}},n,this)})),function(n){return e.apply(this,arguments)})},{key:"draw",value:function(){document.removeEventListener(this.mousedown,this.listener);var n=this.viewport.scale,o=this.rect,r=o.left,u=o.top,s=o.right,w=o.bottom,m=createElement("div",{position:"absolute",border:"1px solid #1460F3",cursor:"all-scroll",top:"".concat(u*n,"px"),left:"".concat(r*n,"px"),width:"".concat((s-r)*n,"px"),height:"".concat((w-u)*n,"px"),zIndex:2},{class:"crop-box","data-id":"move"});this.cropContainer=m,this.container.append(this.cropContainer),this.renderCropBox()}},{key:"handleOutside",value:function(){this.reset(),this.init()}},{key:"updateInitialProps",value:function(){this.container=this.pageViewer.div,this.viewport=this.pageViewer.viewport,this.scale=this.pageViewer.scale,this.pageIndex=this.pageViewer.pageIndex,this.pagePtr=this.pageViewer.pagesPtr[this.pageViewer.pageIndex].pagePtr,this.eventBus=this.pageViewer.eventBus,this.messageHandler=this.pageViewer.messageHandler,this.annotationStore=this.pageViewer.annotationStore}}]);var e}(),Separation=function(){return _createClass(function e(n){_classCallCheck(this,e),this.iccData=null,this.isClearData=!1,this.latestRequestPoint=null,this.isRequestInProgress=!1,this.colorList=[],this.onMousemove=this.handleMouseMove.bind(this),this.onClick=this.handleClick.bind(this),this.onUpdateCanvas=this.updateCanvas.bind(this),this.documentViewer=n.documentViewer,this.container=n.container,this.pageViewer=n.pageViewer,this.pagePtr=n.pagePtr},[{key:"init",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.initColorsList();case 2:this.documentViewer.eventBus._on("updateSeparationView",this.onUpdateCanvas),document.addEventListener("mousemove",this.onMousemove);case 4:case"end":return n.stop()}},e,this)}))}},{key:"initColorsList",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function e(){var n,o,r,u,s,w,m=this;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n=this.documentViewer,o=n.messageHandler,r=n.doc,u=n.eventBus,s=n.colorFile,o.sendWithPromise("InitColorList",r),v.next=4,o.sendWithPromise("GetPDFSeparationColor",{pagePtr:this.pagePtr.pagePtr,fileData:s});case 4:return w=v.sent,this.pagePtr.sepColorPtr=w,v.next=8,o.sendWithPromise("GetColorsList",r);case 8:this.colorList=v.sent,u.dispatch("colorSeparationUpdate",this.colorList),!this.documentViewer.colorList.length&&this.colorList.length&&(this.documentViewer.colorList=this.colorList,setTimeout(function(){u.dispatch("colorSeparationAdded",m.colorList)},100));case 11:case"end":return v.stop()}},e,this)}))}},{key:"destroy",value:function(){this.documentViewer.eventBus._off("updateSeparationView",this.onUpdateCanvas),document.removeEventListener("mousemove",this.onMousemove)}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.documentViewer.doc===this.pagePtr.doc){w.next=2;break}return w.abrupt("return");case 2:if(this.testPoint(e)){w.next=7;break}return!this.isClearData&&this.documentViewer.eventBus.dispatch("colorSeparationUpdate",this.colorList),this.isClearData=!0,w.abrupt("return");case 7:if(o=getAbsoluteCoordinate(this.container,e),r=o.x,u=o.y,s=getInitialPoint$1({x:r,y:u},this.pageViewer.viewport.scale),this.latestRequestPoint=s,!this.isRequestInProgress){w.next=12;break}return w.abrupt("return");case 12:return w.next=14,this.processLatestRequest();case 14:case"end":return w.stop()}},n,this)}))}},{key:"handleClick",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:o=getAbsoluteCoordinate(this.container,e),r=o.x,u=o.y,getInitialPoint$1({x:r,y:u},this.pageViewer.viewport.scale);case 2:case"end":return s.stop()}},n,this)}))}},{key:"getSelectPointColor",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.documentViewer.messageHandler.sendWithPromise("GetSelectPointColor",{pagePtr:this.pagePtr.pagePtr,sepColorPtr:this.pagePtr.sepColorPtr,point:e});case 2:if(!(o=s.sent).length){s.next=12;break}return r=this.colorList.map(function(w){return Object.assign({},w)}),u=[],o.forEach(function(w){r[w.Index].intensity=w.ColorIntensity,u.push({name:r[w.Index].name,value:w.ColorIntensity})}),this.documentViewer.eventBus.dispatch("colorSeparationUpdate",r),this.isClearData=!1,s.abrupt("return",u);case 12:return this.isClearData||this.documentViewer.eventBus.dispatch("colorSeparationUpdate",this.colorList),this.isClearData=!0,s.abrupt("return",o);case 15:case"end":return s.stop()}},n,this)}))}},{key:"updateCanvas",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f,y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.pageViewer.canvas){x.next=2;break}return x.abrupt("return");case 2:return r=window.devicePixelRatio||1,u=this.pageViewer.viewport,s=u.width,w=u.height,m=Math.round(s*r),v=Math.round(w*r),x.next=8,this.documentViewer.messageHandler.sendWithPromise("RenderPageAndIgnoreColorByIndex",{sepColorPtr:this.pagePtr.sepColorPtr,width:m,height:v,indexs:e});case 8:if(g=x.sent,d=g.imageArray,f=(o=this.pageViewer.canvas)===null||o===void 0?void 0:o.getContext("2d")){x.next=13;break}return x.abrupt("return");case 13:f.clearRect(0,0,m,v),(y=f.createImageData(m,v)).data.set(d),f.putImageData(y,0,0),this.documentViewer.eventBus.dispatch("redrawMarkups",{pageIndex:this.pageViewer.pageIndex,isRestorePage:!1}),this.documentViewer.eventBus.dispatch("finishUpdateSeparationView");case 19:case"end":return x.stop()}},n,this)}))}},{key:"testPoint",value:function(e){var n=getAbsoluteCoordinate(this.container,e),o=n.x,r=n.y,u=n.width,s=n.height;return!(o<0||r<0||o>u||r>s)&&{x:o,y:r}}},{key:"processLatestRequest",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function e(){var n;return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isRequestInProgress=!0,!(n=this.latestRequestPoint)){o.next=11;break}return o.prev=3,o.next=6,this.getSelectPointColor(n);case 6:o.next=11;break;case 8:o.prev=8,o.t0=o.catch(3),console.error("\u8BF7\u6C42\u51FA\u9519:",o.t0);case 11:this.isRequestInProgress=!1;case 12:case"end":return o.stop()}},e,this,[[3,8]])}))}}])}(),MAX_CANVAS_PIXELS=maxCanvasPixels,_previousRotation=new WeakMap,_useThumbnailCanvas=new WeakMap,_PDFPageView_brand=new WeakSet,PDFPageView=function(){return _createClass(function s(w){var m;_classCallCheck(this,s),_classPrivateMethodInitSpec(this,_PDFPageView_brand),_classPrivateFieldInitSpec(this,_previousRotation,null),_classPrivateFieldInitSpec(this,_useThumbnailCanvas,{initialOptionalContent:!0,regularAnnotations:!0}),_defineProperty$1(this,"_activeSearch",null),this.documentViewer=w.documentViewer,this._loadingId=null;var v=w.container,g=w.defaultViewport;this.id=w.id,this.pageIndex=w.pageIndex,this.renderingId="page"+this.id,this.layerProperties=w.layerProperties,this.doc=w.doc,this.messageHandler=w.messageHandler,this.pagesPtr=w.pagesPtr,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.annotationStore=w.annotationStore,this.tool="",this.color="",this.toolMode="",this.enableReply=w.enableReply,this.scale=w.scale||DEFAULT_SCALE,this.viewport=g,this.pdfPageRotate=g.rotation,this.hasRestrictedScaling=!1,this.textLayerMode=(m=w.textLayerMode)!==null&&m!==void 0?m:TextLayerMode.ENABLE,this.imageResourcesPath=w.imageResourcesPath||"",this.useOnlyCssZoom=w.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=!0,this.maxCanvasPixels=w.maxCanvasPixels||MAX_CANVAS_PIXELS,this.pageColors=w.pageColors||null,this.eventBus=w.eventBus,this._annotations=w.annotations,this._annotationsAll=w.annotationsAll,this.pagesPtr=w.pagesPtr,(typeof PDFJSDev>"u"||PDFJSDev.test("!PRODUCTION || GENERIC"))&&(this.renderer=w.renderer||RendererType.CANVAS),this.l10n=w.l10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this._renderingState=RenderingStates$1.INITIAL,this.resume=null,this._renderError=null,this._annotationCanvasMap=null,this.annotationLayer=null,this.compdfAnnotationLayer=null,this.annotationEditorLayer=null,this.textSelect=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.contentContainer=null,this.textSelection=null,this.textSearch=null,this.searchResults=null,this.cropPage=null,this.separation=null;var d=document.createElement("div");d.className="page page-number"+this.id,d.setAttribute("data-page-number",this.id),d.setAttribute("role","region"),this.pagePressHandle=this.pagePressHandle.bind(this),d.addEventListener("click",this.pagePressHandle),this.div=d,_assertClassBrand(_PDFPageView_brand,this,_setDimensions).call(this),v==null||v.append(d),this.selected=w.selected,this.$t=w.$t,this.eventBus._on("toolChanged",this.handleTool.bind(this)),this.eventBus._on("toolModeChanged",this.handleToolMode.bind(this)),this.eventBus._on("search",this.handleSearch.bind(this)),this.mode=null,this.contentEditHistoryManager=w.contentEditHistoryManager,v==null||v.style.setProperty("--scale-factor",this.scale*PixelsPerInch.PDF_TO_CSS_UNITS)},[{key:"resetPageFocus",value:function(){for(var s=this.documentViewer.getViewerElement().querySelectorAll(".page"),w=0;w<s.length;w++)s[w].classList.remove("focus")}},{key:"pagePressHandle",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y;return _regeneratorRuntime().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(m=w.currentTarget,v=this.id,g=this.pageIndex,v&&(this.annotationStore.selectedElementName,!["compare","document","separation"].includes(this.mode)&&this.documentViewer.isEnablePageFocus&&(this.resetPageFocus(),this.div.classList.add("focus")),d=document.getElementById("sign-image-save"))){if(f=d.getAttribute("src"),y=m.getBoundingClientRect(),x=d.getBoundingClientRect(),k=x.x-y.x,P=x.y-y.y,S=k+d.width,E=P+d.height,M=k/this.scale,T=P/this.scale,D=S/this.scale,N=E/this.scale,I=null,d.inkPath){for(O=[],F=0;F<d.inkPath.length;F++){for(q=[],Y=0;Y<d.inkPath[F].length;Y++)q.push({PointX:d.inkPath[F][Y].x/this.scale+M,PointY:T+d.inkPath[F][Y].y/this.scale});O.push(q)}I={operate:"add-annot",type:"ink",pageIndex:g,inkPointes:O,rect:{left:M,top:T,right:D,bottom:N},targetPage:v,borderWidth:d.inkParam.width||1,borderColor:d.inkParam.color||"#000",date:new Date,name:v4()}}else I={operate:"add-annot",type:"stamp",stampType:"image",pageIndex:g,imageBase64:f,rect:{left:M,top:T,right:D,bottom:N},targetPage:v,date:new Date,name:v4()};I&&this.eventBus.dispatch("createSignature",I),d.remove(),document.querySelector(".content").onmousemove=null}case 4:case"end":return _e.stop()}},s,this)})),function(s){return u.apply(this,arguments)})},{key:"handleTool",value:function(s){var w=s.tool,m=s.color;this.cropPage&&(w==="cropPage"?this.cropPage.init():this.cropPage.reset()),this.compdfAnnotationLayer||(this.tool=w,this.color=m,w&&this.resetPageFocus())}},{key:"handleToolMode",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w!==this.mode){v.next=2;break}return v.abrupt("return");case 2:if(["compare","document","separation"].includes(w)&&this.resetPageFocus(),m=this.mode,this.mode=w,this.toolMode=w,!this.contentContainer){v.next=13;break}if(w!=="editor"){v.next=12;break}return v.next=10,this.contentContainer.init();case 10:v.next=13;break;case 12:this.contentContainer.destroy();case 13:this.separation&&(m!=="separation"&&w==="separation"?(this.separation.init(),document.querySelector(".document").classList.add("color-separation")):m==="separation"&&w!=="separation"&&(this.separation.destroy(),document.querySelector(".document").classList.remove("color-separation")));case 14:case"end":return v.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"handleSearch",value:function(s,w){this.searchResults=s,this.textSearch&&(this.textSearch.color=w||"rgba(255, 255, 0, 0.25)",this.textSearch.searchResults=s)}},{key:"annotations",get:function(){return this._annotations},set:function(s){this._annotations=s,this.compdfAnnotationLayer&&(this.compdfAnnotationLayer.annotations=this.annotations)}},{key:"annotationsAll",get:function(){return this._annotationsAll},set:function(s){this._annotationsAll=s,this.compdfAnnotationLayer&&(this.compdfAnnotationLayer.annotationsAll=this.annotationsAll)}},{key:"renderingState",get:function(){return this._renderingState},set:function(s){var w=this;if(s!==this._renderingState)switch(this._renderingState=s,this._loadingId&&(clearTimeout(this._loadingId),this._loadingId=null),s){case RenderingStates$1.PAUSED:this.div.classList.remove("loading");break;case RenderingStates$1.RUNNING:this.div.classList.add("loadingIcon"),this._loadingId=setTimeout(function(){w.div.classList.add("loading"),w._loadingId=null},0);break;case RenderingStates$1.INITIAL:case RenderingStates$1.FINISHED:this.div.classList.remove("loadingIcon","loading")}}},{key:"selectedText",get:function(){if(!this.textSelection)return null;var s=this.textSelection._selection;return s?s.textContent:null}},{key:"selectedTextQuads",get:function(){var s=this.textSelection;return s&&s._selection?{textQuads:s.rects,rect:s.rect,pageIndex:this.pageIndex}:null}},{key:"setPdfPage",value:function(s){this.pdfPage=s,this.pdfPageRotate=s.rotate;var w=(this.rotation+this.pdfPageRotate)%360;this.viewport=s.getViewport({scale:this.scale*PixelsPerInch.PDF_TO_CSS_UNITS,rotation:w}),_assertClassBrand(_PDFPageView_brand,this,_setDimensions).call(this),this.reset()}},{key:"destroy",value:function(){var s,w;this.reset(),(s=this.compdfAnnotationLayer)===null||s===void 0||s.destroy(),this.compdfAnnotationLayer=null,(w=this.pdfPage)===null||w===void 0||w.cleanup()}},{key:"clearSearchResults",value:function(){this.searchResults=null,this.textSearch&&this.textSearch.destroy()}},{key:"_renderAnnotationLayer",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return w=null,m.prev=1,m.next=4,this.annotationLayer.render(this.viewport,"display");case 4:m.next=10;break;case 6:m.prev=6,m.t0=m.catch(1),console.error('_renderAnnotationLayer: "'.concat(m.t0,'".')),w=m.t0;case 10:return m.prev=10,this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:w}),m.finish(10);case 13:case"end":return m.stop()}},s,this,[[1,6,10,13]])})),function(){return o.apply(this,arguments)})},{key:"emptyAnnotations",value:function(){this.compdfAnnotationLayer&&this.compdfAnnotationLayer.emptyAnnotations()}},{key:"_renderAnnotationEditorLayer",value:function(){this.annotationEditorLayer.render(this.viewport,"display")}},{key:"selectAnnotation",value:function(s){var w=this;s.name&&(this.annotationStore.toSelectAnnotationName=s.name);var m=this.compdfAnnotationLayer;if(m){var v=m.annotationsArray,g=v.findIndex(function(f){return f.annotation.name===w.annotationStore.toSelectAnnotationName});if(this.annotationStore.selectedElementName){var d=v.findIndex(function(f){return f.annotation.name===w.annotationStore.selectedElementName});d>-1&&m.annotationsArray[d].handleOutside()}g>-1&&(m.annotationsArray[g].selectAnnotation(),this.annotationStore.toSelectAnnotationName=null)}}},{key:"deselectAnnotation",value:function(s){var w=this.annotationStore.selectedElementName;s.name===w&&this.getAnnotationWithName(s.name).handleOutside()}},{key:"getAnnotationWithName",value:function(s){var w=this.compdfAnnotationLayer;if(w){var m=w.annotationsArray.findIndex(function(v){return v.annotation.name===s});return m>-1?w.annotationsArray[m]:void 0}}},{key:"finishRenderTask",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(this.renderTask=null,this._renderError=s,this.renderingState=RenderingStates$1.FINISHED,this._resetZoomLayer(!0),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),s)throw s}},{key:"_resetZoomLayer",value:function(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.zoomLayer){var w=this.zoomLayer.firstChild;this.paintedViewportMap.delete(w),w&&(w.width=0,w.height=0),s&&this.zoomLayer.remove(),this.zoomLayer=null}}},{key:"reset",value:function(){var s,w,m,v,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=g.keepZoomLayer,f=d!==void 0&&d,y=g.keepAnnotationLayer,x=y!==void 0&&y,k=g.keepAnnotationEditorLayer,P=k!==void 0&&k,S=g.keepXfaLayer,E=S!==void 0&&S,M=g.keepTextLayer,T=M!==void 0&&M;this.cancelRendering({keepAnnotationLayer:x,keepAnnotationEditorLayer:P,keepXfaLayer:E,keepTextLayer:T}),this.renderingState=RenderingStates$1.INITIAL;for(var D,N=this.div,I=N.childNodes,O=f&&this.zoomLayer||null,F=x&&((s=this.annotationLayer)===null||s===void 0?void 0:s.div)||null,q=P&&((w=this.annotationEditorLayer)===null||w===void 0?void 0:w.div)||null,Y=T&&((m=this.textLayer)===null||m===void 0?void 0:m.div)||null,_e=I.length-1;_e>=0;_e--){var ne=I[_e];switch(ne){case O:case Y:case F:case q:continue}ne.remove()}N.removeAttribute("data-loaded"),F&&this.annotationLayer.hide(),q||(D=this.annotationEditorLayer)===null||D===void 0||D.destroy(),Y&&this.textLayer.hide(),(v=this.structTreeLayer)===null||v===void 0||v.hide(),O||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}},{key:"update",value:function(s){var w,m=s.scale,v=m===void 0?0:m,g=s.rotation,d=g===void 0?null:g,f=s.drawingDelay,y=f===void 0?-1:f;this.scale=v||this.scale,typeof d=="number"&&(this.rotation=d);var x=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:this.scale*PixelsPerInch.PDF_TO_CSS_UNITS,rotation:x}),_assertClassBrand(_PDFPageView_brand,this,_setDimensions).call(this),(w=this.div.parentNode)===null||w===void 0||w.style.setProperty("--scale-factor",this.viewport.scale);var k=y>=0&&y<1e3;if(this.canvas){if(k||this.useOnlyCssZoom||this.hasRestrictedScaling&&isScalingRestricted)return k&&this.renderingState!==RenderingStates$1.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:y}),this.renderingState=RenderingStates$1.FINISHED),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!k,hideTextLayer:k}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError}),void this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.zoomLayer.firstChild&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}},{key:"cancelRendering",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=s.keepAnnotationLayer,m=w!==void 0&&w,v=s.keepAnnotationEditorLayer,g=v!==void 0&&v,d=s.cancelExtraDelay,f=d===void 0?0:d;this.paintTask&&(this.paintTask.cancel(f),this.paintTask=null),this.resume=null,this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),!this.annotationLayer||m&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.compdfAnnotationLayer&&this.compdfAnnotationLayer.cancel(),!this.annotationEditorLayer||g&&this.annotationEditorLayer.div||(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.contentContainer&&this.contentContainer.cancel(),this.textSelection&&(this.textSelection.destroy(),this.textSelection=null),this.textSearch&&(this.textSearch.destroy(),this.textSearch=null),this.separation&&(this.separation.destroy(),this.separation=null)}},{key:"cssTransform",value:function(s){var w=s.target,m=s.redrawAnnotationLayer,v=m!==void 0&&m,g=s.redrawAnnotationEditorLayer,d=g!==void 0&&g;s.redrawXfaLayer;var f=s.redrawTextLayer,y=f!==void 0&&f,x=s.hideTextLayer,k=x!==void 0&&x;if(w instanceof HTMLCanvasElement)w.hasAttribute("zooming")||w.setAttribute("zooming",!0);else{var P=this.div,S=this.viewport,E=S.width,M=S.height;w.style.width=w.parentNode.style.width=P.style.width=Math.floor(E)+"px",w.style.height=w.parentNode.style.height=P.style.height=Math.floor(M)+"px"}var T,D=this.paintedViewportMap.get(w);if(this.viewport!==D){var N=this.viewport.rotation-D.rotation,I=Math.abs(N),O=1,F=1;if(I===90||I===270){var q=this.viewport,Y=q.width,_e=q.height;O=_e/Y,F=Y/_e}I!==0&&(w.style.transform="rotate(".concat(N,"deg) scale(").concat(O,", ").concat(F,")"))}v&&this.annotationLayer&&this._renderAnnotationLayer(),d&&this.annotationEditorLayer&&this._renderAnnotationEditorLayer(),this.textLayer&&(k?(this.textLayer.hide(),(T=this.structTreeLayer)===null||T===void 0||T.hide()):y&&_assertClassBrand(_PDFPageView_brand,this,_renderTextLayer).call(this))}},{key:"width",get:function(){return this.viewport.width}},{key:"height",get:function(){return this.viewport.height}},{key:"getPagePoint",value:function(s,w){return this.viewport.convertToPdfPoint(s,w)}},{key:"addTextEditor",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m,v,g,d;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.contentContainer){f.next=5;break}return m=this.div,v=this.annotationStore,g=this.annotations,d=this.annotationsAll,this.contentContainer=new ContentContainer({annotationStore:v,pageViewer:this,annotations:g,annotationsAll:d,viewport:this.viewport,scale:this.scale,pageIndex:this.pageIndex,pageDiv:m,eventBus:this.eventBus,selected:this.selected,pagePtr:this.pagesPtr[this.pageIndex].pagePtr,rotation:this.pagesPtr[this.pageIndex].rotation,messageHandler:this.messageHandler,$t:this.$t,contentEditHistoryManager:this.contentEditHistoryManager}),f.next=5,this.contentContainer.init();case 5:return f.abrupt("return",this.contentContainer.addTextEditor(w));case 6:case"end":return f.stop()}},s,this)})),function(s){return n.apply(this,arguments)})},{key:"getEditAnnotation",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.contentContainer){d.next=5;break}return w=this.div,m=this.annotationStore,v=this.annotations,g=this.annotationsAll,this.contentContainer=new ContentContainer({annotationStore:m,pageViewer:this,annotations:v,annotationsAll:g,viewport:this.viewport,scale:this.scale,pageIndex:this.pageIndex,pageDiv:w,eventBus:this.eventBus,selected:this.selected,pagePtr:this.pagesPtr[this.pageIndex].pagePtr,rotation:this.pagesPtr[this.pageIndex].rotation,messageHandler:this.messageHandler,$t:this.$t,contentEditHistoryManager:this.contentEditHistoryManager}),d.next=5,this.contentContainer.init();case 5:return d.abrupt("return",this.contentContainer);case 6:case"end":return d.stop()}},s,this)})),function(){return e.apply(this,arguments)})},{key:"draw",value:function(){var s=this;this.renderingState!==RenderingStates$1.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());var w=this.div,m=this.pdfPage,v=this.annotations,g=this.annotationsAll;if(!m)return this.renderingState=RenderingStates$1.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=RenderingStates$1.RUNNING;var d=null;this.zoomLayer||((d=document.createElement("div")).classList.add("canvasWrapper"),w.append(d),this.zoomLayer=d),d=this.zoomLayer,this.canvas&&this.viewport;var f=function(){var k=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var S,E=arguments;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(S=E.length>0&&E[0]!==void 0?E[0]:null,y===s.paintTask&&(s.paintTask=null),!(S instanceof pdfExports.RenderingCancelledException)){M.next=5;break}return s._renderError=null,M.abrupt("return");case 5:if(s._renderError=S,s.renderingState=RenderingStates$1.FINISHED,_classPrivateFieldGet2(_useThumbnailCanvas,s).regularAnnotations=!y.separateAnnots,s.eventBus.dispatch("pagerendered",{source:s,pageNumber:s.id,cssTransform:!1,timestamp:performance.now(),error:s._renderError}),!S){M.next=11;break}throw S;case 11:case"end":return M.stop()}},P)}));return function(){return k.apply(this,arguments)}}(),y=this.paintOnCanvas(d);y.onRenderContinue=null,this.paintTask=y;var x=y.promise.then(function(){return f(null).then(_asyncToGenerator(_regeneratorRuntime().mark(function k(){var P,S,E,M;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(_assertClassBrand(_PDFPageView_brand,s,_renderTextLayer).call(s),!s.annotationLayer){T.next=4;break}return T.next=4,s._renderAnnotationLayer();case 4:if(s.annotationEditorLayer){T.next=9;break}if(S=s.layerProperties(),E=S.annotationEditorUIManager,M=S.annotationStorage,E){T.next=8;break}return T.abrupt("return");case 8:s.annotationEditorLayer=new PDFAnnotationLayer({uiManager:E,annotationStorage:M,pageIndex:s.pageIndex,pageDiv:w,viewport:s.viewport,scale:s.scale,annotations:v,accessibilityManager:s._accessibilityManager});case 9:if(s._renderAnnotationEditorLayer(),s.compdfAnnotationLayer?s.compdfAnnotationLayer.destroy():s.compdfAnnotationLayer=new ComPDFAnnotationLayer({documentViewer:s.documentViewer,annotationStore:s.annotationStore,messageHandler:s.messageHandler,pageViewer:s,annotations:v,annotationsAll:g,viewport:s.viewport,scale:s.scale,pageIndex:s.pageIndex,pageDiv:w,eventBus:s.eventBus,selected:s.selected,enableReply:s.enableReply,$t:s.$t}),s.compdfAnnotationLayer.render(s.viewport),s.contentContainer){T.next=17;break}s.contentContainer=new ContentContainer({annotationStore:s.annotationStore,pageViewer:s,annotations:v,annotationsAll:g,viewport:s.viewport,scale:s.scale,pageIndex:s.pageIndex,pageDiv:w,eventBus:s.eventBus,selected:s.selected,pagePtr:s.pagesPtr[s.pageIndex].pagePtr,rotation:s.pagesPtr[s.pageIndex].rotation,messageHandler:s.messageHandler,$t:s.$t,contentEditHistoryManager:s.contentEditHistoryManager}),s.mode==="editor"&&s.contentContainer.init(),T.next=20;break;case 17:if(s.mode!=="editor"){T.next=20;break}return T.next=20,s.contentContainer.render();case 20:if(!s.contentContainer||s.contentContainer.pagePtr===s.pagesPtr[s.pageIndex].pagePtr){T.next=24;break}return s.contentContainer.pagePtr=s.pagesPtr[s.pageIndex].pagePtr,T.next=24,s.contentContainer.update();case 24:s.textSelection||(s.textSelection=new TextSelection({documentViewer:s.documentViewer,viewport:s.viewport,scale:s.scale,pageIndex:s.pageIndex,container:w,eventBus:s.eventBus,selected:s.selected,pagePtr:s.pagesPtr[s.pageIndex],messageHandler:s.messageHandler,tool:s.tool,toolMode:s.toolMode,color:s.color,pageViewer:s})),s.textSearch||(s.textSearch=new TextSearch({viewport:s.viewport,scale:s.scale,pageIndex:s.pageIndex,container:w,results:s.searchResults}),s._activeSearch&&s.textSearch.setActiveSearchResult(s._activeSearch)),(P=s.cropPage)!==null&&P!==void 0&&P.cropping&&s.cropPage.draw(),s.cropPage?s.cropPage.updateInitialProps():s.cropPage=new CropPage({viewport:s.viewport,scale:s.scale,pageIndex:s.pageIndex,container:w,eventBus:s.eventBus,selected:s.selected,pagePtr:s.pagesPtr[s.pageIndex],messageHandler:s.messageHandler,tool:s.tool,toolMode:s.toolMode,color:s.color,pageViewer:s,annotationStore:s.annotationStore}),s.tool==="cropPage"&&s.cropPage.init();case 29:case"end":return T.stop()}},k)})))},function(k){return f(k)});return w.setAttribute("data-loaded",!0),x}},{key:"paintOnCanvas",value:function(s){var w=this,m=pdfExports.createPromiseCapability(),v={promise:m.promise,onRenderContinue:function(E){E()},cancel:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;S.cancel(E)},get separateAnnots(){return S.separateAnnots}},g=window.devicePixelRatio||1;this.radio=g;var d=this.viewport,f=d.width,y=d.height,x=d.scale,k=Math.ceil(f*g),P=Math.ceil(y*g),S=new PromiseExt;return S.cancel=function(){},S.resolve(),S.promise.then(_asyncToGenerator(_regeneratorRuntime().mark(function E(){var M,T,D,N,I,O,F,q,Y,_e,ne,ve;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(M=null,w.separation){J.next=7;break}if(w.separation=new Separation({documentViewer:w.documentViewer,container:w.div,pagePtr:w.pagesPtr[w.pageIndex],pageViewer:w}),J.t0=w.mode==="separation",!J.t0){J.next=7;break}return J.next=7,w.separation.init();case 7:if(T={x1:0,y1:0,x2:k,y2:P,width:k,height:P},w.documentViewer.scale>w.documentViewer.maxViewportZoom&&(D=w.documentViewer.getVisibleRegionRect(0,0),T=w.documentViewer.calculatePageVisibility(w.pageIndex+1,D)),w.toolMode!=="separation"||!w.annotationStore.ignoreColors.length){J.next=15;break}return J.next=12,w.messageHandler.sendWithPromise("RenderPageAndIgnoreColorByIndex",{sepColorPtr:w.pagesPtr[w.pageIndex].sepColorPtr,x:T.x1,y:T.y1,width:T.width,height:T.height,indexs:w.annotationStore.ignoreColors});case 12:M=J.sent,J.next=24;break;case 15:if(!w.documentViewer.renderLayerPermission||!w.documentViewer.layers.length){J.next=21;break}return J.next=18,w.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:w.pagesPtr[w.pageIndex].pagePtr,left:T.x1,top:T.y1,right:T.x2,bottom:T.y2,scale:x*g,ocgsPtr:_toConsumableArray$1(w.documentViewer.ocgsPtr)});case 18:M=J.sent,J.next=24;break;case 21:return J.next=23,w.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:w.pagesPtr[w.pageIndex].pagePtr,left:T.x1,top:T.y1,right:T.x2,bottom:T.y2,scale:x*g});case 23:M=J.sent;case 24:if(!M||!M.code){J.next=28;break}return w.eventBus.dispatch("message",{type:"ERROR",message:M.message}),console.log(M.message),J.abrupt("return");case 28:(N=document.createElement("canvas")).setAttribute("role","presentation"),w.canvas=N,I="calc(var(--scale-factor) * ".concat(T.width/(g*x),"px)"),O="calc(var(--scale-factor) * ".concat(T.height/(g*x),"px)"),F="calc(var(--scale-factor) * ".concat(T.x1/(g*x),"px)"),q="calc(var(--scale-factor) * ".concat(T.y1/(g*x),"px)"),Y=N.getContext("2d"),(_e=N.style).width=I,_e.height=O,_e.position="absolute",_e.left=F,_e.top=q,w.paintedViewportMap.set(N,d),ne=M.imageArray,N.width=T.width,N.height=T.height,(ve=Y.createImageData(T.width,T.height)).data.set(ne),Y.putImageData(ve,0,0),w.baseImageData=ve,s.children[0]&&s.removeChild(s.children[0]),s.append(N),m.resolve();case 53:case"end":return J.stop()}},E)})),function(E){console.log(E),E instanceof pdfExports.RenderingCancelledException||showCanvas(),m.reject(E)}),v}},{key:"setActiveSearchResult",value:function(s){this._activeSearch=s,this.textSearch&&this.textSearch.setActiveSearchResult(s)}},{key:"clearActiveSearchResult",value:function(s){this._activeSearch=null,this.textSearch&&this.textSearch.clearActiveSearchResult(s)}},{key:"setPageLabel",value:function(s){this.pageLabel=typeof s=="string"?s:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}},{key:"thumbnailCanvas",get:function(){return this.canvas}},{key:"fontFile",get:function(){return this._fontFile},set:function(s){this._fontFile=s}},{key:"redrawCanvas",value:function(){var s=this;this.renderingState=RenderingStates$1.RUNNING;var w=pdfExports.createPromiseCapability(),m={promise:w.promise,onRenderContinue:function(S){S()},cancel:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;P.cancel(S)},get separateAnnots(){return P.separateAnnots}},v=window.devicePixelRatio||1;this.radio=v;var g=this.viewport,d=g.width,f=g.height,y=g.scale,x=Math.round(d*v),k=Math.round(f*v),P=new PromiseExt;return P.cancel=function(){},P.resolve(),P.promise.then(_asyncToGenerator(_regeneratorRuntime().mark(function S(){var E,M,T,D,N,I,O,F,q,Y,_e,ne,ve;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(E=null,M={x1:0,y1:0,x2:x,y2:k,width:x,height:k},s.documentViewer.scale>s.documentViewer.maxViewportZoom&&(T=s.documentViewer.getVisibleRegionRect(0,0),M=s.documentViewer.calculatePageVisibility(s.pageIndex+1,T)),s.toolMode!=="separation"||!s.annotationStore.ignoreColors.length){J.next=9;break}return J.next=6,s.messageHandler.sendWithPromise("RenderPageAndIgnoreColorByIndex",{sepColorPtr:s.pagesPtr[s.pageIndex].sepColorPtr,x:M.x1,y:M.y1,width:M.width,height:M.height,indexs:s.annotationStore.ignoreColors});case 6:E=J.sent,J.next=18;break;case 9:if(!s.documentViewer.renderLayerPermission||!s.documentViewer.layers.length){J.next=15;break}return J.next=12,s.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:s.pagesPtr[s.pageIndex].pagePtr,left:M.x1,top:M.y1,right:M.x2,bottom:M.y2,scale:y*v,ocgsPtr:_toConsumableArray$1(s.documentViewer.ocgsPtr)});case 12:E=J.sent,J.next=18;break;case 15:return J.next=17,s.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:s.pagesPtr[s.pageIndex].pagePtr,left:M.x1,top:M.y1,right:M.x2,bottom:M.y2,scale:y*v});case 17:E=J.sent;case 18:if(!E||!E.code){J.next=22;break}return s.eventBus.dispatch("message",{type:"ERROR",message:E.message}),console.log(E.message),J.abrupt("return");case 22:(D=document.createElement("canvas")).setAttribute("role","presentation"),s.canvas=D,N="calc(var(--scale-factor) * ".concat(M.width/(v*y),"px)"),I="calc(var(--scale-factor) * ".concat(M.height/(v*y),"px)"),O="calc(var(--scale-factor) * ".concat(M.x1/(v*y),"px)"),F="calc(var(--scale-factor) * ".concat(M.y1/(v*y),"px)"),q=D.getContext("2d"),(Y=D.style).width=N,Y.height=I,Y.position="absolute",Y.left=O,Y.top=F,s.paintedViewportMap.set(D,g),_e=E.imageArray,D.width=M.width,D.height=M.height,(ne=q.createImageData(M.width,M.height)).data.set(_e),q.putImageData(ne,0,0),s.baseImageData=ne,ve=null,s.zoomLayer||((ve=document.createElement("div")).classList.add("canvasWrapper"),s.div.append(ve),s.zoomLayer=ve),(ve=s.zoomLayer).children[0]&&ve.removeChild(ve.children[0]),ve.append(D),s.eventBus.dispatch("redrawMarkups",{pageIndex:s.pageIndex,isRestorePage:!1}),w.resolve(),s.renderingState=RenderingStates$1.FINISHED;case 52:case"end":return J.stop()}},S)})),function(S){console.log(S),w.reject(S)}),m}}]);var e,n,o,r,u}();function _setDimensions(){var e=this.viewport;if(this.pdfPage){if(_classPrivateFieldGet2(_previousRotation,this)===e.rotation)return;_classPrivateFieldSet2(_previousRotation,this,e.rotation)}pdfExports.setLayerDimensions(this.div,e,!0,!1)}function _renderTextLayer(){return _renderTextLayer2.apply(this,arguments)}function _renderTextLayer2(){return(_renderTextLayer2=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var n,o,r,u,s;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(n=this.pdfPage,o=this.textLayer,r=this.viewport,o){w.next=3;break}return w.abrupt("return");case 3:return u=null,w.prev=4,o.renderingDone||(s=n.streamTextContent({includeMarkedContent:!0}),o.setTextContentSource(s)),w.next=8,o.render(r);case 8:w.next=16;break;case 10:if(w.prev=10,w.t0=w.catch(4),!(w.t0 instanceof pdfExports.AbortException)){w.next=14;break}return w.abrupt("return");case 14:console.error('#renderTextLayer: "'.concat(w.t0,'".')),u=w.t0;case 16:this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:o.numTextDivs,error:u});case 17:case"end":return w.stop()}},e,this,[[4,10]])}))).apply(this,arguments)}var ContentEditHistoryManager=function(){return _createClass(function s(w){_classCallCheck(this,s),this.messageHandler=w.messageHandler,this.eventBus=w.eventBus,this.pdfViewer=w.pdfViewer,this.undoList=[],this.redoList=[],this.eventBus._on("toolModeChanged",this.handleToolMode.bind(this))},[{key:"canRedo",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w){v.next=2;break}return v.abrupt("return",this.redoList.length>0);case 2:if(w.editPagePtr){v.next=4;break}return v.abrupt("return",!1);case 4:return v.next=6,this.messageHandler.sendWithPromise("CanRedo",w.editPagePtr);case 6:return m=v.sent,v.abrupt("return",!!m);case 8:case"end":return v.stop()}},s,this)})),function(s){return u.apply(this,arguments)})},{key:"canUndo",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(w){var m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w){v.next=2;break}return v.abrupt("return",this.undoList.length>0);case 2:if(w.editPagePtr){v.next=4;break}return v.abrupt("return",!1);case 4:return v.next=6,this.messageHandler.sendWithPromise("CanUndo",w.editPagePtr);case 6:return m=v.sent,v.abrupt("return",!!m);case 8:case"end":return v.stop()}},s,this)})),function(s){return r.apply(this,arguments)})},{key:"redo",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w=this.redoList.pop()){v.next=4;break}return console.warn("No actions to redo"),v.abrupt("return",!1);case 4:return v.next=6,this.messageHandler.sendWithPromise("Redo",w.editPagePtr);case 6:m=v.sent,this.undoList.push(w),this.updateView(w.pageIndex,m),this.eventBus.dispatch("undoRedoStatusChanged");case 10:case"end":return v.stop()}},s,this)})),function(){return o.apply(this,arguments)})},{key:"undo",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w=this.undoList.pop()){v.next=4;break}return console.warn("No actions to undo"),v.abrupt("return",!1);case 4:return v.next=6,this.messageHandler.sendWithPromise("Undo",w.editPagePtr);case 6:return m=v.sent,v.next=9,this.canRedo(w);case 9:v.sent&&this.redoList.push(w),this.updateView(w.pageIndex,m),this.eventBus.dispatch("undoRedoStatusChanged");case 13:case"end":return v.stop()}},s,this)})),function(){return n.apply(this,arguments)})},{key:"updateView",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function s(w,m){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.pdfViewer._pages[w].contentContainer.updateFrameEditor(m);case 2:this.eventBus.dispatch("changeOperateList",{undoListLength:this.undoList.length,redoListLength:this.redoList.length});case 3:case"end":return v.stop()}},s,this)})),function(s,w){return e.apply(this,arguments)})},{key:"handleToolMode",value:function(s){s!=="editor"&&(this.undoList.length||this.redoList.length)&&(this.undoList.length=0,this.redoList.length=0)}}]);var e,n,o,r,u}(),AreaMeasurementCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.drawingPageIndex=-1,this.drawingLayer=null,this.realStartPoint=null,this.realEndPoint=null,this.oriStartPoint=null,this.oriEndPoint=null,this.shapeEle=null,this.textEle=null,this.annotation=null,this.onMousedown=this.handleMouseDown.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.handleTool=this.handleTool.bind(this),this.documentViewer=n.documentViewer,this.tool=n.documentViewer.activeTool,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.measureType="area",this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1},this.defaultStyles={borderWidth:2,opacity:1,fillTransparency:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",labelPosition:"inside"},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0,this.showPerimeter=!0,this.showArea=!0,this.eventBus._on("toolChanged",this.handleTool)},[{key:"handleTool",value:function(e){var n=e.tool;e.color,this.tool,this.tool=n}},{key:"init",value:function(){document.removeEventListener("mousedown",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.addEventListener("mousedown",this.onMousedown),this.documentViewer.viewerContainer.classList.add("annotation-edit")}},{key:"reset",value:function(){this.realStartPoint=null,this.realEndPoint=null,this.oriStartPoint=null,this.oriEndPoint=null,this.shapeEle=null,this.textEle=null,document.removeEventListener("mousedown",this.onMousedown),document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),this.documentViewer.viewerContainer.classList.remove("annotation-edit")}},{key:"handleMouseDown",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e.target.className==="annotationContainer"){d.next=2;break}return d.abrupt("return");case 2:if(o=this.getMouseLocation(e),r=this.documentViewer.getSelectedPage(o,o),!((u=r.first-1)<0)){d.next=7;break}return d.abrupt("return");case 7:if(!(this.annotationStore.selectedElementName&&this.drawingPageIndex<0)){d.next=9;break}return d.abrupt("return");case 9:return s=this.documentViewer.pdfViewer._pages[u].compdfAnnotationLayer,w=getAbsoluteCoordinate(s.pageDiv,e),m=this.documentViewer.windowToPage(o,u+1),this.drawingPageIndex=u,this.drawingLayer=s,this.realStartPoint={x:w.x,y:w.y},this.oriStartPoint={x:m.x,y:m.y},this.oriStartPoint,v=Object.assign(Object.assign({measure:1,operate:"add-annot",type:"polygon",measureType:this.measureType,pageIndex:u,date:new Date},this.defaults),this.defaultStyles),d.next=20,this.documentViewer.annotationManager.createMeasurementAnnotation(v);case 20:g=d.sent,this.annotation=g[0],document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),this.updateMeasureData();case 25:case"end":return d.stop()}},n,this)}))}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f,y,x,k,P,S,E,M,T,D;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!(this.drawingPageIndex<0)){N.next=2;break}return N.abrupt("return");case 2:return u=getAbsoluteCoordinate(this.drawingLayer.pageDiv,e),s=u.x,w=u.y,m=this.drawingLayer.viewport,v=m.width,g=m.height,d=m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x&&(this.realEndPoint.x+=1),((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y&&(this.realEndPoint.y+=1),f=getInitialPoint$1({x:s,y:w},d),this.oriEndPoint={x:f.x,y:f.y},y=this.oriStartPoint,x=this.oriEndPoint,k={left:Math.min(y.x,x.x),top:Math.min(y.y,x.y),right:Math.max(y.x,x.x),bottom:Math.max(y.y,x.y)},P=[{x:k.left,y:k.top},{x:k.right,y:k.top},{x:k.right,y:k.bottom},{x:k.left,y:k.bottom}],S={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:k,vertices:P},this.annotation.contents&&(S.contents=this.annotation.contents,S.labelPosition=this.annotation.labelPosition),this.annotation.rect=k,this.annotation.vertices=P,N.next=21,this.documentViewer.annotationManager.editMeasurementAnnotation(S);case 21:return N.next=23,this.getResult();case 23:E=[],this.showPerimeter&&E.push(this.annotation.perimeter+this.defaults.scale.translateUnit),this.showArea&&E.push(this.annotation.area+this.defaults.scale.translateUnit+"\xB2"),this.annotation.contents=E.join(`
`),this.shapeEle||(this.shapeEle=createSvg("rect",{fill:"none",stroke:this.defaultStyles.borderColor,"stroke-width":2*d,"stroke-opacity":.8}),this.drawingLayer.svgElement.append(this.shapeEle)),this.textEle||(this.textEle=createSvg("text",{fill:this.defaultStyles.color||this.defaultStyles.borderColor,"text-anchor":"middle","dominant-baseline":"middle","font-size":this.defaultStyles.fontSize+"px"}),this.drawingLayer.svgElement.append(this.textEle)),M={x:(this.realStartPoint.x+this.realEndPoint.x)/2-this.annotation.borderWidth,y:(this.realStartPoint.y+this.realEndPoint.y)/2-this.annotation.borderWidth},this.shapeEle.setAttribute("x",Math.min(this.realStartPoint.x,this.realEndPoint.x)-this.annotation.borderWidth),this.shapeEle.setAttribute("y",Math.min(this.realStartPoint.y,this.realEndPoint.y)-this.annotation.borderWidth),this.shapeEle.setAttribute("width","".concat(Math.abs(this.realEndPoint.x-this.realStartPoint.x)+2*this.annotation.borderWidth,"px")),this.shapeEle.setAttribute("height","".concat(Math.abs(this.realEndPoint.y-this.realStartPoint.y)+2*this.annotation.borderWidth,"px")),this.textEle.textContent="",this.showPerimeter&&((T=createSvg("tspan",{x:M.x,y:M.y,dy:"0em"})).textContent=this.annotation.perimeter+this.defaults.scale.translateUnit,this.textEle.appendChild(T)),this.showArea&&((D=createSvg("tspan",{x:M.x,y:M.y,dy:"1em"})).textContent=this.annotation.area+this.defaults.scale.translateUnit+"\xB2",this.textEle.appendChild(D)),this.updateMeasureData();case 38:case"end":return N.stop()}},n,this)}))}},{key:"handleMouseUp",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(u=getAbsoluteCoordinate(this.drawingLayer.pageDiv,e),s=u.x,w=u.y,m=this.drawingLayer.viewport,v=m.width,g=m.height,d=m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},this.drawingPageIndex=-1,f=getInitialPoint$1({x:s,y:w},d),this.oriEndPoint={x:f.x,y:f.y},!this.realEndPoint||((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x||((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y){E.next=29;break}if(y=this.oriStartPoint,x=this.oriEndPoint,y){E.next=13;break}return E.abrupt("return");case 13:return k={left:Math.min(y.x,x.x),top:Math.min(y.y,x.y),right:Math.max(y.x,x.x),bottom:Math.max(y.y,x.y)},P=[{x:k.left,y:k.top},{x:k.right,y:k.top},{x:k.right,y:k.bottom},{x:k.left,y:k.bottom}],S={pagePtr:this.annotation.pagePtr,annotPtr:this.annotation.annotPtr,rulerPtr:this.annotation.rulerPtr,pageIndex:this.annotation.pageIndex,rect:k,vertices:P,labelPosition:this.annotation.labelPosition,contents:this.annotation.contents},this.annotation.rect=k,this.annotation.vertices=P,this.annotation.showPerimeter=this.showPerimeter,this.annotation.showArea=this.showArea,E.next=22,this.documentViewer.messageHandler.sendWithPromise("GetFactor",this.annotation.rulerPtr);case 22:return this.annotation.factor=E.sent,E.next=25,this.documentViewer.annotationManager.editMeasurementAnnotation(S);case 25:return E.next=27,this.documentViewer.annotationManager.drawAnnotationsFromList(this.annotation);case 27:E.next=30;break;case 29:this.documentViewer.deleteAnnotations(this.annotation);case 30:this.annotation=null,this.realStartPoint=null,this.realEndPoint=null,this.oriStartPoint=null,this.oriEndPoint=null,this.shapeEle=null,this.textEle=null,this.drawingLayer.svgElement.innerHTML="",document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),this.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:this.documentViewer.annotations});case 41:case"end":return E.stop()}},n,this)}))}},{key:"destroy",value:function(){this.reset(),this.eventBus._off("toolChanged",this.handleTool)}},{key:"getMouseLocation",value:function(e){var n,o=this.documentViewer.getScrollViewElement(),r=((n=document.querySelector(".document-container"))===null||n===void 0?void 0:n.style.marginLeft)||0;r=parseFloat(r);var u=o.scrollLeft||0,s=o.scrollTop||0,w=getClickPoint(e);return{x:w.pageX+u-r,y:w.pageY+s}}},{key:"getResult",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function e(){var n,o,r,u,s=this;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return n=this.annotation.rulerPtr,w.next=3,this.documentViewer.messageHandler.sendWithPromise("GetMeasurementResult",{rulerPtr:n,captionType:"area"});case 3:return o=w.sent,w.next=6,this.documentViewer.messageHandler.sendWithPromise("GetMeasurementResult",{rulerPtr:n,captionType:"length"});case 6:r=w.sent,u=function(m){return m%1==0?m:Number(m.toFixed(s.decimalPlaces))},this.annotation.area=u(o),this.annotation.perimeter=u(r);case 10:case"end":return w.stop()}},e,this)}))}},{key:"updateMeasureData",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.documentViewer.eventBus.dispatch("updateMeasureData",{scale:this.defaults.scale,precision:this.defaults.precision,perimeter:this.annotation.perimeter||0,area:this.annotation.area||0});case 1:case"end":return n.stop()}},e,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m=this;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(e.showPerimeter===void 0&&e.showArea===void 0||(this.showPerimeter=(o=e.showPerimeter)!==null&&o!==void 0?o:this.showPerimeter,this.showArea=(r=e.showArea)!==null&&r!==void 0?r:this.showArea),Object.entries(e).forEach(function(g){var d=_slicedToArray(g,2),f=d[0],y=d[1];Object.entries(m.defaults).forEach(function(x){var k,P=_slicedToArray(x,2),S=P[0],E=P[1];f!==S||E===y||["showPerimeter","showArea"].includes(f)||(m.defaults[S]=y,S==="precision"&&(m.decimalPlaces=((k=y.toString().split(".")[1])===null||k===void 0?void 0:k.length)||0))})}),!this.annotationStore.selectedElementName){v.next=4;break}return v.abrupt("return");case 4:if(u={scale:this.defaults.scale,precision:this.defaults.precision,perimeter:0,area:0},!this.annotation){v.next=17;break}return v.next=8,this.getResult();case 8:if(s=[],this.showPerimeter&&s.push(this.annotation.perimeter+this.defaults.scale.translateUnit),this.showArea&&s.push(this.annotation.area+this.defaults.scale.translateUnit+"\xB2"),this.annotation.contents=s.join(`
`),!this.annotation.rulerPtr||!this.oriEndPoint){v.next=17;break}return v.next=15,this.documentViewer.messageHandler.sendWithPromise("GetFactor",this.annotation.rulerPtr);case 15:w=v.sent,this.annotation.factor=w;case 17:this.documentViewer.eventBus.dispatch("updateMeasureData",u);case 18:case"end":return v.stop()}},n,this)}))}}])}(),LineCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.onMousemove=this.handleMouseMove.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",head:"openarrow",tail:"openarrow",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:""},this.leaderLineDefaultOptions={leadLength:9,leadOffset:-9,leadExtension:6,labelPosition:"inside"},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x,k,P,S;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!o.annotationStore.selectedElementName){E.next=2;break}return E.abrupt("return");case 2:if(o.layer=w,o.annotationStore.creating){E.next=17;break}return o.annotationStore.creating=!0,o.realStartPoint={x:s.x,y:s.y},d=u.x,f=u.y,y=u.x+1,x=u.y+1,k={left:d,top:f,right:y,bottom:x},P=[d,x,y,f],S=Object.assign(Object.assign(Object.assign({measure:1,type:"line",measureType:"distance",pageIndex:r,rect:k,linePoints:P},o.defaults),o.defaultStyles),o.leaderLineDefaultOptions),o.drawingAnnot=new Line({annotation:S,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),document.addEventListener("mousemove",o.onMousemove),E.abrupt("return");case 17:if(o.drawingAnnot.layer.div){E.next=20;break}return o.reset(),E.abrupt("return");case 20:if(o.annotationStore.creating=!1,!s||((v=o.realStartPoint)===null||v===void 0?void 0:v.x)===s.x&&((g=o.realStartPoint)===null||g===void 0?void 0:g.y)===s.y){E.next=30;break}return E.next=24,o.documentViewer.annotationManager.createMeasurementAnnotation(o.drawingAnnot.annotation);case 24:E.sent,o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations}),E.next=31;break;case 30:o.drawingAnnot.delete();case 31:o.reset();case 32:case"end":return E.stop()}},m)})()})}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.annotationStore.creating){d.next=2;break}return d.abrupt("return");case 2:u=getAbsoluteCoordinate(this.layer.pageDiv,e),s=u.x,w=u.y,m=this.layer.viewport,v=m.width,g=m.height,m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x&&(this.realEndPoint.x+=1),((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y&&(this.realEndPoint.y+=1),this.drawingAnnot.update({start:this.drawingAnnot.start,end:this.realEndPoint});case 10:case"end":return d.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Object.entries(e).forEach(function(u){var s,w=_slicedToArray(u,2),m=w[0],v=w[1];Object.hasOwn(o.defaults,m)&&o.defaults[m]!==v&&(o.defaults[m]=v,m==="precision"&&(o.decimalPlaces=((s=v.toString().split(".")[1])===null||s===void 0?void 0:s.length)||0)),Object.hasOwn(o.defaultStyles,m)&&o.defaultStyles[m]!==v&&(o.defaultStyles[m]=v)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 2:case"end":return r.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision};e&&(n.length=0,n.angle=0,n.X=0,n.Y=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}}])}(),PolylineCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.clickTimeId=null,this.addedBeforeMove=!1,this.onMousemove=this.handleMouseMove.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.measure=+n.measure||0,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:""},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener(isMobileDevice$1?"click":"mousemove",this.onMousemove),document.removeEventListener("keydown",this.onKeydown)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!o.clickTimeId){P.next=4;break}return clearTimeout(o.clickTimeId),o.clickTimeId=null,P.abrupt("return");case 4:if(!o.annotationStore.selectedElementName){P.next=6;break}return P.abrupt("return");case 6:if(o.layer=w,o.drawingAnnot&&o.drawingAnnot.PageNumber!==r+1&&(f=o.documentViewer.scale,y=o.drawingAnnot.getPathPoint(o.drawingAnnot.realVertices.length-1),s={x:y.x*f,y:y.y*f},o.layer=o.documentViewer.pdfViewer._pages[o.drawingAnnot.PageNumber-1].compdfAnnotationLayer),o.annotationStore.creating){P.next=19;break}return o.annotationStore.creating=!0,o.addedBeforeMove=!1,o.realStartPoint={x:s.x,y:s.y},x=Object.assign({measure:o.measure,type:"polyline",pageIndex:r,vertices:[{x:u.x,y:u.y}]},o.defaultStyles),o.measure&&Object.assign(x,Object.assign({measureType:"perimeter"},o.defaults)),o.drawingAnnot=new Polyline({annotation:x,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),document.addEventListener(isMobileDevice$1?"click":"mousemove",o.onMousemove),document.addEventListener("keydown",o.onKeydown),P.abrupt("return");case 19:if(!((v=o.drawingAnnot.layer)===null||v===void 0)&&v.div){P.next=22;break}return o.reset(),P.abrupt("return");case 22:if(o.clickTimeId=setTimeout(function(){o.realEndPoint={x:s.x,y:s.y},o.realStartPoint=o.realEndPoint,o.clickTimeId=null},250),s&&!(Math.abs(((g=o.realStartPoint)===null||g===void 0?void 0:g.x)-s.x)<=5&&Math.abs(((d=o.realStartPoint)===null||d===void 0?void 0:d.y)-s.y)<=5)){P.next=25;break}return P.abrupt("return");case 25:k=isMobileDevice$1?o.drawingAnnot.annotation.vertices.length:o.drawingAnnot.annotation.vertices.length-1,o.drawingAnnot.setPathPoint(k,s.x,s.y),o.addedBeforeMove=!1;case 28:case"end":return P.stop()}},m)})()})}},{key:"handleKeyDown",value:function(e){(e.keyCode||e.which)===27&&(e.preventDefault(),this.reset())}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.annotationStore.creating){f.next=2;break}return f.abrupt("return");case 2:if(u=getAbsoluteCoordinate(this.layer.pageDiv,e),s=u.x,w=u.y,m=this.layer.viewport,v=m.width,g=m.height,m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},!(Math.abs(((o=this.realStartPoint)===null||o===void 0?void 0:o.x)-s)<=5&&Math.abs(((r=this.realStartPoint)===null||r===void 0?void 0:r.y)-w)<=5)){f.next=9;break}return f.abrupt("return");case 9:!this.addedBeforeMove&&this.drawingAnnot.addPathPoint(s,w),this.addedBeforeMove=!0,d=this.drawingAnnot.realVertices.length-1,this.drawingAnnot.setPathPoint(d,s,w),this.drawingAnnot.update(d,!1);case 14:case"end":return f.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Object.entries(e).forEach(function(u){var s,w=_slicedToArray(u,2),m=w[0],v=w[1];Object.hasOwn(o.defaults,m)&&o.defaults[m]!==v&&(o.defaults[m]=v,m==="precision"&&(o.decimalPlaces=((s=v.toString().split(".")[1])===null||s===void 0?void 0:s.length)||0)),Object.hasOwn(o.defaultStyles,m)&&o.defaultStyles[m]!==v&&(o.defaultStyles[m]=v)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 2:case"end":return r.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision};e&&(n.length=0,n.angle=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}},{key:"handleDoubleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.realPoint;return _regeneratorRuntime().mark(function u(){var s,w,m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(o.clickTimeId&&(clearTimeout(o.clickTimeId),o.clickTimeId=null),o.annotationStore.creating=!1,!r||((s=o.realStartPoint)===null||s===void 0?void 0:s.x)===r.x&&((w=o.realStartPoint)===null||w===void 0?void 0:w.y)===r.y||o.drawingAnnot.setPathPoint(o.drawingAnnot.realVertices.length-1,r.x,r.y),o.drawingAnnot.update(),o.drawingAnnot.realVertices.length>=2&&(m=o.drawingAnnot.realVertices.slice(-2),v=_slicedToArray(m,2),g=v[0],d=g.x,f=g.y,y=v[1],x=y.x,k=y.y,Math.abs(parseInt(d)-parseInt(x))<=1&&Math.abs(parseInt(f)-parseInt(k))<=1&&(o.drawingAnnot.realVertices.pop(),o.drawingAnnot.annotation.vertices.pop(),o.drawingAnnot.renderAnnot())),!(o.drawingAnnot.realVertices.length<2)){P.next=9;break}o.drawingAnnot.delete(),P.next=19;break;case 9:if(!o.measure){P.next=16;break}return P.next=12,o.documentViewer.annotationManager.createMeasurementAnnotation(o.drawingAnnot.annotation);case 12:P.sent,o.eventBus.dispatch("updateMeasureData",{angle:0}),P.next=19;break;case 16:return P.next=18,o.documentViewer.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 18:P.sent;case 19:o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot),o.reset(),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations});case 23:case"end":return P.stop()}},u)})()})}}])}(),CurveCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.onMousemove=this.handleMouseMove.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:""},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!o.annotationStore.selectedElementName){y.next=2;break}return y.abrupt("return");case 2:if(o.layer=w,o.annotationStore.creating){y.next=11;break}return o.annotationStore.creating=!0,o.realStartPoint={x:s.x,y:s.y},d=Object.assign(Object.assign({measure:1,type:"ink",measureType:"arc",captionType:"generic",pageIndex:r,inkPointes:[[{PointX:u.x,PointY:u.y},{PointX:u.x+1,PointY:u.y+1},{PointX:u.x+2,PointY:u.y+2},{PointX:u.x+3,PointY:u.y+3}]]},o.defaults),o.defaultStyles),o.drawingAnnot=new Curve({annotation:d,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),document.addEventListener("mousemove",o.onMousemove),y.abrupt("return");case 11:if(o.drawingAnnot.layer.div){y.next=14;break}return o.reset(),y.abrupt("return");case 14:if(o.annotationStore.creating=!1,!s||((v=o.realStartPoint)===null||v===void 0?void 0:v.x)===s.x&&((g=o.realStartPoint)===null||g===void 0?void 0:g.y)===s.y){y.next=28;break}return f=o.drawingAnnot.realVertices[o.drawingAnnot.realVertices.length-1],o.drawingAnnot.setPathPoint(o.drawingAnnot.realVertices.length-1,f.x,f.y),o.drawingAnnot.calculateEqualPoints(),o.drawingAnnot.update(),y.next=22,o.documentViewer.annotationManager.createMeasurementAnnotation(o.drawingAnnot.annotation);case 22:y.sent,o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations}),y.next=29;break;case 28:o.drawingAnnot.delete();case 29:o.reset();case 30:case"end":return y.stop()}},m)})()})}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.annotationStore.creating){v.next=2;break}return v.abrupt("return");case 2:if(o=getAbsoluteCoordinate(this.layer.pageDiv,e),r=o.x,u=o.y,s=this.layer.viewport,w=s.width,m=s.height,s.scale,r=Math.max(0,Math.min(w,r)),u=Math.max(0,Math.min(m,u)),this.realEndPoint={x:r,y:u},this.realStartPoint.x!==this.realEndPoint.x||this.realStartPoint.y!==this.realEndPoint.y){v.next=9;break}return v.abrupt("return");case 9:this.drawingAnnot.setPathPoint(this.drawingAnnot.realVertices.length-1,r,u),this.drawingAnnot.calculateEqualPoints();case 11:case"end":return v.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Object.entries(e).forEach(function(u){var s,w=_slicedToArray(u,2),m=w[0],v=w[1];Object.hasOwn(o.defaults,m)&&o.defaults[m]!==v&&(o.defaults[m]=v,m==="precision"&&(o.decimalPlaces=((s=v.toString().split(".")[1])===null||s===void 0?void 0:s.length)||0)),Object.hasOwn(o.defaultStyles,m)&&o.defaultStyles[m]!==v&&(o.defaultStyles[m]=v)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 2:case"end":return r.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision};e&&(n.length=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}}])}(),ArcCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.clickId=0,this.addedBeforeMove=!1,this.layer=null,this.onMousemove=this.handleMouseMove.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.measure=+n.measure||0,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:""},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0,this.showOption=this.annotationStore.arc},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.clickId=0,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!o.annotationStore.selectedElementName){k.next=2;break}return k.abrupt("return");case 2:if(o.layer=w,o.drawingAnnot&&o.drawingAnnot.PageNumber,o.annotationStore.creating||o.clickId){k.next=24;break}if(o.annotationStore.creating=!0,o.clickId=1,o.addedBeforeMove=!1,o.realStartPoint={x:s.x,y:s.y},y=Object.assign({measure:o.measure,type:"arc",author:o.documentViewer.annotator,pageIndex:r,arcPoints:[{x:u.x,y:u.y}],inkPointes:[]},o.defaultStyles),o.measure&&Object.assign(y,Object.assign(Object.assign({type:"ink",measureType:"arc"},o.defaults),{showRadius:o.showOption.showRadius,showAngle:o.showOption.showAngle,showArcLength:o.showOption.showArcLength})),!isMobileDevice$1){k.next=21;break}return u.x,u.y,u.x<100&&(u.x=100),u.y<50&&(u.y=50),x=Object.assign(Object.assign({},y),{arcPoints:[{x:u.x,y:u.y},{x:u.x-50,y:u.y-50},{x:u.x,y:u.y-100}],operate:"add-annot"}),o.documentViewer.handleAnnotationChange({type:"add",show:!0,annotation:x}),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations}),o.annotationStore.creating=!1,o.reset(),k.abrupt("return");case 21:return o.drawingAnnot=new Arc({annotation:y,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),document.addEventListener("mousemove",o.onMousemove),k.abrupt("return");case 24:if(o.drawingAnnot.layer.div){k.next=27;break}return o.reset(),k.abrupt("return");case 27:if(o.clickId!==1){k.next=35;break}if(s&&!(Math.abs(((v=o.realStartPoint)===null||v===void 0?void 0:v.x)-s.x)<=5&&Math.abs(((g=o.realStartPoint)===null||g===void 0?void 0:g.y)-s.y)<=5)){k.next=30;break}return k.abrupt("return");case 30:return o.clickId=2,o.drawingAnnot.setPathPoint(o.drawingAnnot.realVertices.length-1,s.x,s.y),o.addedBeforeMove=!1,document.addEventListener("mousemove",o.onMousemove),k.abrupt("return");case 35:if(o.addedBeforeMove&&!(o.drawingAnnot.realVertices.length<3)){k.next=37;break}return k.abrupt("return");case 37:if(o.annotationStore.creating=!1,!s||((d=o.realStartPoint)===null||d===void 0?void 0:d.x)===s.x&&((f=o.realStartPoint)===null||f===void 0?void 0:f.y)===s.y){k.next=56;break}if(o.drawingAnnot.setPathPoint(o.drawingAnnot.realVertices.length-1,s.x,s.y),Object.assign(o.drawingAnnot.annotation,{arcPoints:o.drawingAnnot.changedArcPoints}),o.drawingAnnot.update(),!o.measure){k.next=48;break}return k.next=45,o.documentViewer.annotationManager.createMeasurementAnnotation(o.drawingAnnot.annotation);case 45:k.sent,k.next=51;break;case 48:return k.next=50,o.documentViewer.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 50:k.sent;case 51:o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations}),k.next=57;break;case 56:o.drawingAnnot.delete();case 57:o.reset();case 58:case"end":return k.stop()}},m)})()})}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.annotationStore.creating&&this.clickId){v.next=2;break}return v.abrupt("return");case 2:if(o=getAbsoluteCoordinate(this.layer.pageDiv,e),r=o.x,u=o.y,s=this.layer.viewport,w=s.width,m=s.height,s.scale,r=Math.max(0,Math.min(w,r)),u=Math.max(0,Math.min(m,u)),this.realEndPoint={x:r,y:u},this.realStartPoint.x!==this.realEndPoint.x||this.realStartPoint.y!==this.realEndPoint.y){v.next=9;break}return v.abrupt("return");case 9:this.addedBeforeMove||(this.drawingAnnot.addPathPoint(r,u),this.clickId===1&&this.drawingAnnot.draw()),this.addedBeforeMove=!0,this.drawingAnnot.setPathPoint(this.drawingAnnot.realVertices.length-1,r,u),this.clickId===2&&this.drawingAnnot.update(null,!1);case 13:case"end":return v.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:["showAngle","showArcLength","showRadius"].forEach(function(u){var s;e[u]!==void 0&&(o.showOption[u]=(s=e[u])!==null&&s!==void 0?s:o.showOption[u])}),Object.entries(e).forEach(function(u){var s,w=_slicedToArray(u,2),m=w[0],v=w[1];Object.hasOwn(o.defaults,m)&&o.defaults[m]!==v&&(o.defaults[m]=v,m==="precision"&&(o.decimalPlaces=((s=v.toString().split(".")[1])===null||s===void 0?void 0:s.length)||0)),Object.hasOwn(o.defaultStyles,m)&&o.defaultStyles[m]!==v&&(o.defaultStyles[m]=v)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 4:case"end":return r.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision,showRadius:this.showOption.showRadius,showAngle:this.showOption.showAngle,showArcLength:this.showOption.showArcLength};e&&(n.radius=0,n.arcLength=0,n.angle=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}}])}(),CircleCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.onMousemove=this.handleMouseMove.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,fillTransparency:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fillColor:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:"",labelPosition:"inside"},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0,this.showOption=this.annotationStore.circle},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup)}},{key:"handleMouseDown",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!o.annotationStore.selectedElementName&&!o.annotationStore.creating){k.next=2;break}return k.abrupt("return");case 2:o.layer=w,o.annotationStore.creating=!0,o.realStartPoint={x:s.x,y:s.y},v=u.x,g=u.y,d=u.x+1,f=u.y+1,y={left:v,top:g,right:d,bottom:f},x=Object.assign(Object.assign(Object.assign({measure:1,type:"circle",measureType:"area",pageIndex:r,rect:y},o.defaults),o.defaultStyles),{showRadius:o.showOption.showRadius,showPerimeter:o.showOption.showPerimeter,showArea:o.showOption.showArea}),o.drawingAnnot=new Circle({annotation:x,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),document.addEventListener("mousemove",o.onMousemove),document.addEventListener("mouseup",o.onMouseup);case 15:case"end":return k.stop()}},m)})()})}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f,y;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.annotationStore.creating){x.next=2;break}return x.abrupt("return");case 2:u=getAbsoluteCoordinate(this.layer.pageDiv,e),s=u.x,w=u.y,m=this.layer.viewport,v=m.width,g=m.height,m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x&&(this.realEndPoint.x+=1),((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y&&(this.realEndPoint.y+=1),e.shiftKey&&(d=Math.abs(this.realEndPoint.x-this.realStartPoint.x),f=Math.abs(this.realEndPoint.y-this.realStartPoint.y),y=Math.min(d,f),this.realStartPoint.x<this.realEndPoint.x?this.realEndPoint.x=this.realStartPoint.x+y:this.realEndPoint.x=this.realStartPoint.x-y,this.realStartPoint.y<this.realEndPoint.y?this.realEndPoint.y=this.realStartPoint.y+y:this.realEndPoint.y=this.realStartPoint.y-y),this.drawingAnnot.update({start:this.drawingAnnot.start,end:this.realEndPoint});case 11:case"end":return x.stop()}},n,this)}))}},{key:"handleMouseUp",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.annotationStore.creating=!1,!this.realEndPoint||((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x||((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y){u.next=10;break}return u.next=4,this.documentViewer.annotationManager.createMeasurementAnnotation(this.drawingAnnot.annotation);case 4:u.sent,this.drawingAnnot.selectAnnotation(),this.documentViewer.getAnnotationManager().addAnnotation(this.drawingAnnot),this.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:this.documentViewer.annotations}),u.next=11;break;case 10:this.drawingAnnot.delete();case 11:this.reset();case 12:case"end":return u.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:["showPerimeter","showArea","showRadius"].forEach(function(u){var s;e[u]!==void 0&&(o.showOption[u]=(s=e[u])!==null&&s!==void 0?s:o.showOption[u])}),Object.entries(e).forEach(function(u){var s,w=_slicedToArray(u,2),m=w[0],v=w[1];Object.hasOwn(o.defaults,m)&&o.defaults[m]!==v&&(o.defaults[m]=v,m==="precision"&&(o.decimalPlaces=((s=v.toString().split(".")[1])===null||s===void 0?void 0:s.length)||0)),Object.hasOwn(o.defaultStyles,m)&&o.defaultStyles[m]!==v&&(o.defaultStyles[m]=v)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 4:case"end":return r.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision,showRadius:this.showOption.showRadius,showPerimeter:this.showOption.showPerimeter,showArea:this.showOption.showArea};e&&(n.radius=0,n.perimeter=0,n.area=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}}])}(),RectangleCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.onMousemove=this.handleMouseMove.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,fillTransparency:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fillColor:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:"",labelPosition:"inside"},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0,this.showOption=this.annotationStore.rectangle},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup)}},{key:"handleMouseDown",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!o.annotationStore.selectedElementName&&!o.annotationStore.creating){P.next=2;break}return P.abrupt("return");case 2:o.layer=w,o.annotationStore.creating=!0,o.realStartPoint={x:s.x,y:s.y},v=u.x,g=u.y,d=u.x+1,f=u.y+1,y={left:v,top:g,right:d,bottom:f},x=[{x:v,y:g},{x:d,y:g},{x:d,y:f},{x:v,y:f}],k=Object.assign(Object.assign(Object.assign({measure:1,type:"rectangle",measureType:"area",pageIndex:r,rect:y,vertices:x},o.defaults),o.defaultStyles),{showPerimeter:o.showOption.showPerimeter,showArea:o.showOption.showArea}),o.drawingAnnot=new Rectangle({annotation:k,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),document.addEventListener("mousemove",o.onMousemove),document.addEventListener("mouseup",o.onMouseup);case 16:case"end":return P.stop()}},m)})()})}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.annotationStore.creating){d.next=2;break}return d.abrupt("return");case 2:u=getAbsoluteCoordinate(this.layer.pageDiv,e),s=u.x,w=u.y,m=this.layer.viewport,v=m.width,g=m.height,m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x&&(this.realEndPoint.x+=1),((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y&&(this.realEndPoint.y+=1),this.drawingAnnot.update({start:this.drawingAnnot.start,end:this.realEndPoint});case 10:case"end":return d.stop()}},n,this)}))}},{key:"handleMouseUp",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(u=getAbsoluteCoordinate(this.layer.pageDiv,e),s=u.x,w=u.y,m=this.layer.viewport,v=m.width,g=m.height,d=m.scale,s=Math.max(0,Math.min(v,s)),w=Math.max(0,Math.min(g,w)),this.realEndPoint={x:s,y:w},this.annotationStore.creating=!1,f=getInitialPoint$1({x:s,y:w},d),this.oriEndPoint={x:f.x,y:f.y},!this.realEndPoint||((o=this.realStartPoint)===null||o===void 0?void 0:o.x)===this.realEndPoint.x||((r=this.realStartPoint)===null||r===void 0?void 0:r.y)===this.realEndPoint.y){y.next=17;break}return y.next=11,this.documentViewer.annotationManager.createMeasurementAnnotation(this.drawingAnnot.annotation);case 11:y.sent,this.drawingAnnot.selectAnnotation(),this.documentViewer.getAnnotationManager().addAnnotation(this.drawingAnnot),this.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:this.documentViewer.annotations}),y.next=18;break;case 17:this.drawingAnnot.delete();case 18:this.reset();case 19:case"end":return y.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision,showPerimeter:this.showOption.showPerimeter,showArea:this.showOption.showArea};e&&(n.perimeter=0,n.area=0,n.length=0,n.width=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u=this;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e.showPerimeter===void 0&&e.showArea===void 0||(this.showOption.showPerimeter=(o=e.showPerimeter)!==null&&o!==void 0?o:this.showOption.showPerimeter,this.showOption.showArea=(r=e.showArea)!==null&&r!==void 0?r:this.showOption.showArea),Object.entries(e).forEach(function(w){var m,v=_slicedToArray(w,2),g=v[0],d=v[1];Object.hasOwn(u.defaults,g)&&u.defaults[g]!==d&&(u.defaults[g]=d,g==="precision"&&(u.decimalPlaces=((m=d.toString().split(".")[1])===null||m===void 0?void 0:m.length)||0)),Object.hasOwn(u.defaultStyles,g)&&u.defaultStyles[g]!==d&&(u.defaultStyles[g]=d)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 3:case"end":return s.stop()}},n,this)}))}}])}(),PolygonCreateTool=function(){return _createClass(function e(n){var o;_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.clickTimeId=null,this.addedBeforeMove=!1,this.onMousemove=this.handleMouseMove.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.measure=+n.measure||0,this.defaults={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,factor:.0352778},this.defaultStyles={borderWidth:2,opacity:1,fillTransparency:1,color:"#FF0000",fillColor:"",borderColor:"#FF0000",borderStyle:"solid",dashes:"",fontName:"Helvetica",fontSize:14,fontStyle:"regular",contents:""},this.decimalPlaces=((o=this.defaults.precision.toString().split(".")[1])===null||o===void 0?void 0:o.length)||0,this.showOption=this.annotationStore.polygon},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener(isMobileDevice$1?"click":"mousemove",this.onMousemove),document.removeEventListener("keydown",this.onKeydown)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!o.clickTimeId){k.next=4;break}return clearTimeout(o.clickTimeId),o.clickTimeId=null,k.abrupt("return");case 4:if(!o.annotationStore.selectedElementName){k.next=6;break}return k.abrupt("return");case 6:if(o.layer=w,o.drawingAnnot&&o.drawingAnnot.PageNumber!==r+1&&(d=o.documentViewer.scale,f=o.drawingAnnot.getPathPoint(o.drawingAnnot.annotation.vertices.length-1),s={x:f.x*d,y:f.y*d},o.layer=o.documentViewer.pdfViewer._pages[o.drawingAnnot.PageNumber-1].compdfAnnotationLayer),o.annotationStore.creating){k.next=19;break}return o.annotationStore.creating=!0,o.addedBeforeMove=!1,o.realStartPoint={x:s.x,y:s.y},y=Object.assign({measure:o.measure,type:"polygon",pageIndex:r,vertices:[{x:u.x,y:u.y}]},o.defaultStyles),o.measure&&Object.assign(y,Object.assign(Object.assign({measureType:"area"},o.defaults),{showPerimeter:o.showOption.showPerimeter,showArea:o.showOption.showArea})),o.drawingAnnot=new Polygon({annotation:y,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink,creating:!0}),o.drawingAnnot.draw(),document.addEventListener("keydown",o.onKeydown),document.addEventListener(isMobileDevice$1?"click":"mousemove",o.onMousemove),k.abrupt("return");case 19:if(o.drawingAnnot.layer.div){k.next=22;break}return o.reset(),k.abrupt("return");case 22:if(o.clickTimeId=setTimeout(function(){o.realEndPoint={x:s.x,y:s.y},o.realStartPoint=o.realEndPoint,o.clickTimeId=null},250),s&&!(Math.abs(((v=o.realStartPoint)===null||v===void 0?void 0:v.x)-s.x)<=5&&Math.abs(((g=o.realStartPoint)===null||g===void 0?void 0:g.y)-s.y)<=5)){k.next=25;break}return k.abrupt("return");case 25:x=isMobileDevice$1?o.drawingAnnot.annotation.vertices.length:o.drawingAnnot.annotation.vertices.length-1,o.drawingAnnot.setPathPoint(x,s.x,s.y),o.addedBeforeMove=!1;case 28:case"end":return k.stop()}},m)})()})}},{key:"handleKeyDown",value:function(e){(e.keyCode||e.which)===27&&(e.preventDefault(),this.reset())}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.annotationStore.creating){d.next=2;break}return d.abrupt("return");case 2:if(o=getAbsoluteCoordinate(this.layer.pageDiv,e),r=o.x,u=o.y,s=this.layer.viewport,w=s.width,m=s.height,s.scale,r=Math.max(0,Math.min(w,r)),u=Math.max(0,Math.min(m,u)),this.realEndPoint={x:r,y:u},this.realStartPoint.x!==this.realEndPoint.x||this.realStartPoint.y!==this.realEndPoint.y){d.next=9;break}return d.abrupt("return");case 9:v=this.drawingAnnot,!this.addedBeforeMove&&v.addPathPoint(r,u),this.addedBeforeMove=!0,g=v.annotation.vertices,v.setPathPoint(g.length-1,r,u),v.update(g.length-1);case 15:case"end":return d.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u=this;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e.showPerimeter===void 0&&e.showArea===void 0||(this.showOption.showPerimeter=(o=e.showPerimeter)!==null&&o!==void 0?o:this.showOption.showPerimeter,this.showOption.showArea=(r=e.showArea)!==null&&r!==void 0?r:this.showOption.showArea),Object.entries(e).forEach(function(w){var m,v=_slicedToArray(w,2),g=v[0],d=v[1];Object.hasOwn(u.defaults,g)&&u.defaults[g]!==d&&(u.defaults[g]=d,g==="precision"&&(u.decimalPlaces=((m=d.toString().split(".")[1])===null||m===void 0?void 0:m.length)||0)),Object.hasOwn(u.defaultStyles,g)&&u.defaultStyles[g]!==d&&(u.defaultStyles[g]=d)}),this.updateMeasureData(!this.annotationStore.selectedElementName);case 3:case"end":return s.stop()}},n,this)}))}},{key:"updateMeasureData",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n={scale:this.defaults.scale,precision:this.defaults.precision,showPerimeter:this.showOption.showPerimeter,showArea:this.showOption.showArea};e&&(n.perimeter=0,n.area=0),this.documentViewer.eventBus.dispatch("updateMeasureData",n)}},{key:"handleDoubleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.realPoint;return _regeneratorRuntime().mark(function u(){var s,w,m,v;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o.clickTimeId&&(clearTimeout(o.clickTimeId),o.clickTimeId=null),o.annotationStore.creating=!1,m=o.documentViewer.scale,v=o.drawingAnnot.annotation.vertices,!r||((s=o.realStartPoint)===null||s===void 0?void 0:s.x)===r.x&&((w=o.realStartPoint)===null||w===void 0?void 0:w.y)===r.y||o.drawingAnnot.setPathPoint(v.length-1,r.x,r.y),r&&(Math.abs(v[0].x-r.x/m)<=5&&Math.abs(v[0].y-r.y/m)<=5||Math.abs(v[v.length-2].x-r.x/m)<=2&&Math.abs(v[v.length-2].y-r.y/m)<=2)&&v.pop(),o.drawingAnnot.creating=!1,!(v.length<3)){g.next=11;break}o.drawingAnnot.delete(),g.next=24;break;case 11:if(o.drawingAnnot.renderAnnot(),o.drawingAnnot.update(),!o.measure){g.next=19;break}return g.next=16,o.documentViewer.annotationManager.createMeasurementAnnotation(o.drawingAnnot.annotation);case 16:g.sent,g.next=22;break;case 19:return g.next=21,o.documentViewer.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 21:g.sent;case 22:o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot);case 24:o.reset(),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations});case 26:case"end":return g.stop()}},u)})()})}}])}(),CloudyCreateTool=function(){return _createClass(function e(n){_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.clickTimeId=null,this.addedBeforeMove=!1,this.onMousemove=this.handleMouseMove.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaultStyles={borderWidth:2,opacity:1,fillTransparency:1,color:"#FF0000",fillColor:"",borderColor:"#FF0000",borderStyle:"cloudy",dashes:"",intensity:1,contents:""},this.showOption=this.annotationStore.polygon},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener(isMobileDevice$1?"click":"mousemove",this.onMousemove),document.removeEventListener("keydown",this.onKeydown)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint,s=n.realPoint,w=n.layer;return _regeneratorRuntime().mark(function m(){var v,g,d,f,y,x;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!o.clickTimeId){k.next=4;break}return clearTimeout(o.clickTimeId),o.clickTimeId=null,k.abrupt("return");case 4:if(!o.annotationStore.selectedElementName){k.next=6;break}return k.abrupt("return");case 6:if(o.layer=w,o.drawingAnnot&&o.drawingAnnot.PageNumber!==r+1&&(d=o.documentViewer.scale,f=o.drawingAnnot.getPathPoint(o.drawingAnnot.annotation.vertices.length-1),s={x:f.x*d,y:f.y*d},o.layer=o.documentViewer.pdfViewer._pages[o.drawingAnnot.PageNumber-1].compdfAnnotationLayer),o.annotationStore.creating){k.next=19;break}return o.annotationStore.creating=!0,o.addedBeforeMove=!1,o.realStartPoint={x:s.x,y:s.y},y=Object.assign({type:"polygon",pageIndex:r,vertices:[{x:u.x,y:u.y}]},o.defaultStyles),o.drawingAnnot=new Polygon({annotation:y,documentViewer:o.documentViewer,highlight:o.annotationStore.highlightLink,creating:!0}),o.drawingAnnot.annotation.toolName="CloudyCreateTool",o.drawingAnnot.draw(),document.addEventListener("keydown",o.onKeydown),document.addEventListener(isMobileDevice$1?"click":"mousemove",o.onMousemove),k.abrupt("return");case 19:if(o.drawingAnnot.layer.div){k.next=22;break}return o.reset(),k.abrupt("return");case 22:if(o.clickTimeId=setTimeout(function(){o.realEndPoint={x:s.x,y:s.y},o.realStartPoint=o.realEndPoint,o.clickTimeId=null},250),s&&!(Math.abs(((v=o.realStartPoint)===null||v===void 0?void 0:v.x)-s.x)<=5&&Math.abs(((g=o.realStartPoint)===null||g===void 0?void 0:g.y)-s.y)<=5)){k.next=25;break}return k.abrupt("return");case 25:x=isMobileDevice$1?o.drawingAnnot.annotation.vertices.length:o.drawingAnnot.annotation.vertices.length-1,o.drawingAnnot.setPathPoint(x,s.x,s.y),o.addedBeforeMove=!1;case 28:case"end":return k.stop()}},m)})()})}},{key:"handleKeyDown",value:function(e){(e.keyCode||e.which)===27&&(e.preventDefault(),this.reset())}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.annotationStore.creating){v.next=2;break}return v.abrupt("return");case 2:if(o=getAbsoluteCoordinate(this.layer.pageDiv,e),r=o.x,u=o.y,s=this.layer.viewport,w=s.width,m=s.height,s.scale,r=Math.max(0,Math.min(w,r)),u=Math.max(0,Math.min(m,u)),this.realEndPoint={x:r,y:u},this.realStartPoint.x!==this.realEndPoint.x||this.realStartPoint.y!==this.realEndPoint.y){v.next=9;break}return v.abrupt("return");case 9:!this.addedBeforeMove&&this.drawingAnnot.addPathPoint(r,u),this.addedBeforeMove=!0,this.drawingAnnot.setPathPoint(this.drawingAnnot.annotation.vertices.length-1,r,u),this.drawingAnnot.update(this.drawingAnnot.annotation.vertices.length-1);case 13:case"end":return v.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u=this;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e.showPerimeter===void 0&&e.showArea===void 0||(this.showOption.showPerimeter=(o=e.showPerimeter)!==null&&o!==void 0?o:this.showOption.showPerimeter,this.showOption.showArea=(r=e.showArea)!==null&&r!==void 0?r:this.showOption.showArea),Object.entries(e).forEach(function(w){var m=_slicedToArray(w,2),v=m[0],g=m[1];Object.hasOwn(u.defaultStyles,v)&&u.defaultStyles[v]!==g&&(u.defaultStyles[v]=g)});case 2:case"end":return s.stop()}},n,this)}))}},{key:"handleDoubleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.realPoint;return _regeneratorRuntime().mark(function u(){var s,w,m,v;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o.clickTimeId&&(clearTimeout(o.clickTimeId),o.clickTimeId=null),o.annotationStore.creating=!1,m=o.documentViewer.scale,v=o.drawingAnnot.annotation.vertices,!r||((s=o.realStartPoint)===null||s===void 0?void 0:s.x)===r.x&&((w=o.realStartPoint)===null||w===void 0?void 0:w.y)===r.y||o.drawingAnnot.setPathPoint(v.length-1,r.x,r.y),r&&(Math.abs(v[0].x-r.x/m)<=5&&Math.abs(v[0].y-r.y/m)<=5||Math.abs(v[v.length-2].x-r.x/m)<=2&&Math.abs(v[v.length-2].y-r.y/m)<=2)&&v.pop(),o.drawingAnnot.creating=!1,!(v.length<3)){g.next=11;break}o.drawingAnnot.delete(),g.next=18;break;case 11:return o.drawingAnnot.renderAnnot(),o.drawingAnnot.update(),g.next=15,o.documentViewer.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 15:g.sent,o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot);case 18:o.reset(),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations});case 20:case"end":return g.stop()}},u)})()})}}])}(),Callout=function(e){function n(r){var u,s=r.annotation,w=s===void 0?null:s,m=r.documentViewer,v=r.show,g=v!==void 0&&v,d=r.enableReply,f=d===void 0||d;return _classCallCheck(this,n),(u=_callSuper(this,n,[{annotation:w,documentViewer:m}])).type="freetext",u.enableReply=f,u.hidden=!0,u.initial=!1,u.leftTop=null,u.rightBottom=null,u.newLeftTop=null,u.newRightBottom=null,u.startCircle=null,u.endCircle=null,u.show=g,u.editing=!1,u.lastClickTime=null,u.outSideListener=null,u.onContainerClick=u.handleContainerClick.bind(u),u.onMousedown=u.handleMouseDown.bind(u),u.onMousemove=u.handleMouseMove.bind(u),u.onMouseup=u.handleMouseUp.bind(u),u.onDelete=u.handleDelete.bind(u),u.onOpenReply=u.openReply.bind(u),u.onBlur=u.handleFreetextEditElementBlur.bind(u),u.onSingleClick=u.onSingleClick.bind(u),u.onDbclick=u.handleElementDbClick.bind(u),u.handleStopPropagation=u.handleStopPropagation.bind(u),u.onPaste=u.handleFreetextEditElementPaste.bind(u),u.render(),u}return _inherits(n,BaseAnnotation),_createClass(n,[{key:"setCss",value:function(r,u){if(r&&u)for(var s in u)r.style[s]=u[s]}},{key:"render",value:function(){var r=this.documentViewer,u=r.scale,s=this.annotation,w=this.getActualRect(u),m=w.leftTop,v=w.rightBottom;this.leftTop=m,this.rightBottom=v;var g=this.calculate(this.leftTop,this.rightBottom);s.fontSize=s.fontSize||16,s.color=s.color||"#000000",s.fontWeight=s.fontWeight||"normal",s.fontStyle=s.fontStyle||"normal",s.borderWidth=s.borderWidth||1,s.contents=s.contents||"",s.borderColor=s.borderColor||"#000000",s.borderStyle=s.borderStyle||"solid";var d=s.borderWidth*u,f=document.createElement("div");f.className="annotation",this.setCss(f,{top:g.top+"px",left:g.left+"px"}),this.annotationContainer=f,this.svgElement=createSvg("svg",{viewBox:"".concat(g.left," ").concat(g.top," ").concat(g.width," ").concat(g.height)},{pointerEvents:"all",overflow:"visible",position:"absolute",zIndex:1,width:g.width+"px",height:g.height+"px"}),this.svgElement.addEventListener("mousedown",this.onClick),this.annotationContainer.append(this.svgElement);var y=document.createElement("div");y.setAttribute("role","textbox"),y.setAttribute("contenteditable",!0),y.setAttribute("spellcheck",!1),y.className="freetext";var x=r.getPageWidth(this.PageNumber)*u,k=r.getPageHeight(this.PageNumber)*u,P=x-this.leftTop.x,S=k-this.leftTop.y,E=s.textAlignment||"left",M=Math.abs(s.rectDiff.top)*u+d,T=Math.abs(s.rectDiff.left)*u+d,D=g.width-(Math.abs(s.rectDiff.left)+Math.abs(s.rectDiff.right))*u-2*d,N=g.height-(Math.abs(s.rectDiff.top)+Math.abs(s.rectDiff.bottom))*u-2*d;this.freetextRect={left:T,top:M,width:D,height:N},this.setCss(y,{position:"absolute",top:M+"px",left:T+"px",zIndex:2,cursor:"text",maxWidth:P+"px",maxHeight:S+"px",width:D+"px",height:N+"px",padding:"0 2px",fontSize:s.fontSize*u+"px",lineHeight:"1.2em",fontFamily:s.fontName,fontWeight:s.fontWeight,fontStyle:s.fontStyle,color:s.color,opacity:s.opacity,textAlign:E,verticalAlign:"bottom",overflow:"auto",backgroundColor:s.fillColor?s.fillColor:"transparent","-webkit-user-select":"text"}),this.freetextEditElement=y;var I=document.createElement("div");I.className="freetext",this.setCss(I,{position:"absolute",top:M+"px",left:T+"px",zIndex:2,width:D+"px",height:N+"px",padding:"0 2px",fontFamily:s.fontName,fontWeight:s.fontWeight,fontStyle:s.fontStyle,opacity:s.opacity,lineHeight:"1.2em",color:s.color,fontSize:s.fontSize*u+"px",textAlign:E,verticalAlign:"bottom",overflow:"hidden",pointerEvents:"none",backgroundColor:s.fillColor?s.fillColor:"transparent"}),this.freetextElement=I,I.innerHTML=s.contents,y.innerHTML=s.contents,this.appendOrRemoveFreetextElement("append"),this.renderArrow(),this.renderOutline(),this.initial=!0}},{key:"renderArrow",value:function(){var r=this.annotation,u=r.floatPoint,s=this.documentViewer.scale,w={x:u[0].x*s,y:u[0].y*s},m={x:u[1].x*s,y:u[1].y*s},v=r.borderWidth*s,g=Math.max(3*v,12*s),d=this.calculate(this.leftTop,this.rightBottom),f=Math.abs(r.rectDiff.left)*s+this.leftTop.x+v/2,y=Math.abs(r.rectDiff.top)*s+this.leftTop.y+v/2,x=d.width-(Math.abs(r.rectDiff.left)+Math.abs(r.rectDiff.right))*s-v,k=d.height-(Math.abs(r.rectDiff.top)+Math.abs(r.rectDiff.bottom))*s-v,P=this.getDashString();if(this.arrowHead&&this.polyline){var S=new ArrowHelper(w,m),E="",M=S.getArrowPoints("openarrow",30,g,!1);M&&M.forEach(function(I){E.length>0&&(E+=" "),E+="".concat(I.x,",").concat(I.y)}),E.length>0&&this.arrowHead.setAttribute("points",E),this.arrowHead.setAttribute("stroke",r.borderColor),this.arrowHead.setAttribute("stroke-width",v),this.arrowHead.setAttribute("stroke-opacity",r.opacity||1),this.arrowHead.setAttribute("stroke-dasharray",r.borderStyle==="dashed"?P:""),this.polyline.setAttribute("points","".concat(w.x,",").concat(w.y," ").concat(m.x,",").concat(m.y," ").concat(u[2].x*s,",").concat(u[2].y*s)),this.polyline.setAttribute("stroke",r.borderColor),this.polyline.setAttribute("stroke-width",v),this.polyline.setAttribute("stroke-opacity",r.opacity||1),this.polyline.setAttribute("stroke-dasharray",r.borderStyle==="dashed"?P:""),this.rectElement.setAttribute("x",f),this.rectElement.setAttribute("y",y),this.rectElement.setAttribute("width",x),this.rectElement.setAttribute("height",k),this.rectElement.setAttribute("stroke",r.borderColor),this.rectElement.setAttribute("stroke-width",v),this.rectElement.setAttribute("stroke-opacity",r.opacity||1),this.rectElement.setAttribute("stroke-dasharray",r.borderStyle==="dashed"?P:"")}else{var T=new ArrowHelper(w,m).getArrow("openarrow",30,g,!1);this.arrowHead=T,T.setAttribute("fill","none"),T.setAttribute("stroke",r.borderColor),T.setAttribute("stroke-width",v),T.setAttribute("stroke-opacity",r.opacity||1),T.setAttribute("stroke-dasharray",r.borderStyle==="dashed"?P:"");var D=createSvg("polyline",{fill:"none",points:"".concat(w.x,",").concat(w.y," ").concat(m.x,",").concat(m.y," ").concat(u[2].x*s,",").concat(u[2].y*s),stroke:r.borderColor,"stroke-width":v,"stroke-opacity":r.opacity||1,"stroke-dasharray":r.borderStyle==="dashed"?P:""});this.polyline=D;var N=createSvg("rect",{"fill-opacity":r.opacity,fill:r.fillColor||"none",x:f,y,width:x,height:k,stroke:r.borderColor,"stroke-width":v,"stroke-opacity":r.opacity||1,"stroke-dasharray":r.borderStyle==="dashed"?P:""});this.rectElement=N,this.svgElement.append(T,D,N)}}},{key:"renderOutline",value:function(){var r=this.calculate(this.leftTop,this.rightBottom);if(this.outerLine){this.outerLine.setAttribute("viewBox","".concat(r.left-6," ").concat(r.top-6," ").concat(r.width+12," ").concat(r.height+12));var u=this.outerLine.style;u.left="".concat(r.left-6,"px"),u.top="".concat(r.top-6,"px"),u.width="".concat(r.width+12,"px"),u.height="".concat(r.height+12,"px"),this.renderSelectPoint()}else{this.outerLineContainer=document.createElement("div"),this.outerLineContainer.className="outline-container";var s=createSvg("svg",{viewBox:"".concat(r.left-6," ").concat(r.top-6," ").concat(r.width+12," ").concat(r.height+12),"data-id":"move"},{position:"absolute",zIndex:1,left:"".concat(r.left-6,"px"),top:"".concat(r.top-6,"px"),width:"".concat(r.width+12,"px"),height:"".concat(r.height+12,"px"),border:"1px solid #1460F3",boxSizing:"content-box",overflow:"visible",pointerEvents:"auto",cursor:"all-scroll"});this.outerLine=s,this.outerLineContainer.append(this.outerLine),this.renderSelectPoint(!0)}}},{key:"renderSelectPoint",value:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],u=this.annotation,s=this.documentViewer.scale,w=u.floatPoint,m=u.borderWidth*s,v=this.calculate(this.leftTop,this.rightBottom),g=Math.abs(u.rectDiff.left)*s-m/2+v.left,d=Math.abs(u.rectDiff.top)*s-m/2+v.top,f=v.width-(Math.abs(u.rectDiff.left)+Math.abs(u.rectDiff.right))*s+m,y=v.height-(Math.abs(u.rectDiff.top)+Math.abs(u.rectDiff.bottom))*s+m,x=g,k=d,P=g+f,S=d+y,E=[{x:w[0].x*s,y:w[0].y*s,cursor:"resize",dataId:"point0"},{x:w[1].x*s,y:w[1].y*s,cursor:"resize",dataId:"point1"},{x:x+m/2,y:k+m/2,cursor:"nwse-resize",dataId:"nw-resize"},{x:x+f/2,y:k+m/2,cursor:"ns-resize",dataId:"n-resize"},{x:P-m/2,y:k+m/2,cursor:"nesw-resize",dataId:"ne-resize"},{x:P-m/2,y:S-m/2,cursor:"nwse-resize",dataId:"se-resize"},{x:P-m/2,y:k+y/2,cursor:"ew-resize",dataId:"e-resize"},{x:x+f/2,y:S-m/2,cursor:"ns-resize",dataId:"s-resize"},{x:x+m/2,y:S-m/2,cursor:"nesw-resize",dataId:"sw-resize"},{x:x+m/2,y:k+y/2,cursor:"ew-resize",dataId:"w-resize"}];if(r)for(var M=0;M<E.length;M++){var T=E[M],D=createSvg("circle",{"data-id":T.dataId,fill:"#1460F3",stroke:"#FFFFFF","stroke-width":2,cx:T.x,cy:T.y,r:6},{cursor:T.cursor});this.outerLine.append(D)}else for(var N=this.outerLine.querySelectorAll("circle"),I=0;I<N.length;I++){var O=N[I];O.setAttribute("cx",E[I].x),O.setAttribute("cy",E[I].y)}}},{key:"handleElementDbClick",value:function(r){r&&r.stopPropagation(),r&&r.preventDefault(),this.freetextEditElement&&(document.removeEventListener("mousedown",this.outSideListener),this.outerLine.removeEventListener("mousedown",this.onMousedown),this.outerLine.removeEventListener("touchstart",this.onMousedown),this.outerLine.removeEventListener("dblclick",this.onDbclick),this.outerLine.removeEventListener("dblclick",this.onSingleClick),this.outerLineContainer.remove(),this.appendOrRemoveFreetextElement("remove"),this.appendOrRemoveFreetextEditElement("append"),this.editing=!0,this.setCss(this.svgElement,{pointerEvents:"none"}))}},{key:"getFreetextRectPoint",value:function(){var r=this.freetextEditElement.getBoundingClientRect(),u=r.width,s=r.height,w=this.leftTop,m=w.x+u,v=w.y+s,g=m>this.rightBottom.x?m:this.rightBottom.x,d=v>this.rightBottom.y?v:this.rightBottom.y;this.rightBottom={x:g,y:d}}},{key:"getFreetextRect",value:function(){var r=this.documentViewer.scale;this.getFreetextRectPoint();var u=getInitialPoint$1(this.leftTop,r),s=getInitialPoint$1(this.rightBottom,r);return{left:u.x,top:u.y,right:s.x,bottom:s.y}}},{key:"setAnnotationChanged",value:function(r){var u=this.annotation;this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:_objectSpread2$1({type:"freetext",operate:"mod-annot",name:u.name,pageIndex:this.PageNumber-1,pagePtr:u.pagePtr,annotPtr:u.annotPtr},r)}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify")}},{key:"fontName",get:function(){return this.annotation.fontName},set:function(r){var u=this.annotation;this.annotation.fontName!==r&&(this.setCss(this.freetextEditElement,{fontFamily:r}),this.setCss(this.freetextElement,{fontFamily:r}),this.annotation.fontName=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:r,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"fontStyle",get:function(){return this.annotation.fontStyle},set:function(r){var u=this.annotation;r!==u.fontStyle&&(this.setCss(this.freetextEditElement,{fontStyle:r}),this.setCss(this.freetextElement,{fontStyle:r}),this.annotation.fontStyle=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:r,fontSize:u.fontSize,color:u.color}))}},{key:"fontWeight",get:function(){return this.annotation.fontWeight},set:function(r){var u=this.annotation;r!==u.fontWeight&&(this.setCss(this.freetextEditElement,{fontWeight:r}),this.setCss(this.freetextElement,{fontWeight:r}),this.annotation.fontWeight=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:r,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"fontSize",get:function(){return this.annotation.fontSize},set:function(r){var u=this.annotation;if(u.fontSize!==r){var s=this.documentViewer.scale;this.setCss(this.freetextEditElement,{fontSize:r*s+"px"}),this.setCss(this.freetextElement,{fontSize:r*s+"px"}),u.fontSize=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:r,color:u.color})}}},{key:"textAlignment",get:function(){return this.annotation.textAlignment},set:function(r){var u=this.annotation;u.textAlignment!==r&&(this.setCss(this.freetextEditElement,{textAlign:r}),this.setCss(this.freetextElement,{textAlign:r}),u.textAlignment=r,this.setAnnotationChanged({contents:u.contents,textAlignment:r,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"color",get:function(){return this.annotation.color},set:function(r){var u=this.annotation;u.color!==r&&(this.setCss(this.freetextEditElement,{color:r}),this.setCss(this.freetextElement,{color:r}),u.color=r,this.setAnnotationChanged({contents:u.contents,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:r}))}},{key:"borderStyle",get:function(){return this.annotation.borderStyle},set:function(r){var u=this.annotation;if(r==="solid")this.arrowHead.setAttribute("stroke-dasharray",""),this.polyline.setAttribute("stroke-dasharray",""),this.rectElement.setAttribute("stroke-dasharray","");else if(r==="dashed"){var s=this.getDashString();this.arrowHead.setAttribute("stroke-dasharray",s),this.polyline.setAttribute("stroke-dasharray",s),this.rectElement.setAttribute("stroke-dasharray",s)}u.borderStyle=r,this.setAnnotationChanged({borderStyle:r,borderWidth:u.borderWidth,dashes:u.dashes||"2, 2"})}},{key:"dashes",get:function(){return this.annotation.dashes},set:function(r){var u=this.annotation;u.dashes=r;var s=this.getDashString();u.borderStyle==="dashed"&&(this.arrowHead.setAttribute("stroke-dasharray",s),this.polyline.setAttribute("stroke-dasharray",s),this.rectElement.setAttribute("stroke-dasharray",s)),this.setAnnotationChanged({borderStyle:u.borderStyle,borderWidth:u.borderWidth,dashes:r})}},{key:"borderWidth",get:function(){return this.annotation.borderWidth},set:function(r){var u=this.documentViewer.scale,s=this.annotation;if(s.borderWidth!==r){s.borderWidth=r;var w=r*u;this.arrowHead.setAttribute("stroke-width",w),this.polyline.setAttribute("stroke-width",w),this.rectElement.setAttribute("stroke-width",w),this.renderArrow(),this.renderSelectPoint();var m=this.calculate(this.leftTop,this.rightBottom),v=Math.abs(s.rectDiff.top)*u+w,g=Math.abs(s.rectDiff.left)*u+w,d=m.width-(Math.abs(s.rectDiff.left)+Math.abs(s.rectDiff.right))*u-2*w,f=m.height-(Math.abs(s.rectDiff.top)+Math.abs(s.rectDiff.bottom))*u-2*w;this.setCss(this.freetextEditElement,{top:v+"px",left:g+"px",width:d+"px",height:f+"px"}),this.setCss(this.freetextElement,{top:v+"px",left:g+"px",width:d+"px",height:f+"px"}),this.setAnnotationChanged({borderWidth:r})}}},{key:"borderColor",get:function(){return this.annotation.borderColor},set:function(r){var u=this.annotation;u.borderColor!==r&&(this.arrowHead.setAttribute("stroke",r),this.polyline.setAttribute("stroke",r),this.rectElement.setAttribute("stroke",r),u.borderColor=r,this.setAnnotationChanged({borderColor:r}))}},{key:"fillColor",get:function(){return this.annotation.fillColor},set:function(r){var u=this.annotation;u.fillColor!==r&&(this.setCss(this.freetextEditElement,{backgroundColor:r&&r!=="transparent"?r:"transparent"}),this.setCss(this.freetextElement,{backgroundColor:r&&r!=="transparent"?r:"transparent"}),this.rectElement.setAttribute("fill",r&&r!=="none"?r:"transparent"),u.fillColor=r,this.setAnnotationChanged({fillColor:r}))}},{key:"opacity",get:function(){return this.annotation.opacity},set:function(r){var u=this.annotation;u.opacity!==r&&(this.setCss(this.annotationContainer,{opacity:r}),u.opacity=r,this.setAnnotationChanged({opacity:r}))}},{key:"contents",get:function(){return this.annotation.contents},set:function(r){this.setContents(r)}},{key:"setContents",value:function(r){var u=this.annotation;r!==u.contents&&(u.contents=r,this.freetextElement.innerHTML=u.contents,this.freetextEditElement.innerHTML=u.contents,this.setAnnotationChanged({contents:r,textAlignment:u.textAlignment,fontName:u.fontName,fontWeight:u.fontWeight,fontStyle:u.fontStyle,fontSize:u.fontSize,color:u.color}))}},{key:"handleFreetextEditElementBlur",value:function(){var r=this.documentViewer,u=this.freetextEditElement;if(this.editing=!1,this.isDelete)return u.removeEventListener("blur",this.onBlur),u.removeEventListener("click",this.handleStopPropagation),u.removeEventListener("paste",this.onPaste),this.outerLineContainer.remove(),void(r.annotationStore.selectedElementName===this.annotation.name&&(r.annotationStore.selectedElementName=null));var s=[this.annotationContainer,this.outerLine,document.querySelector(".toggle-button"),document.querySelector(".sidebar-style"),document.querySelector(".freetext-panel")],w=document.querySelector(".freetext-popup");if(w&&s.push(w),this.outSideListener=onClickOutside$1(s,this.handleOutside.bind(this)),u&&u.innerText!==this.annotation.contents){var m=this.annotation,v=getHtmlToText(u);this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{type:"freetext",operate:"mod-annot",name:m.name,pageIndex:this.PageNumber-1,pagePtr:m.pagePtr,annotPtr:m.annotPtr,contents:v,textAlignment:m.textAlignment,fontName:m.fontName,fontWeight:m.fontWeight,fontStyle:m.fontStyle,fontSize:m.fontSize,color:m.color}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify"),this.update({leftTop:this.leftTop,rightBottom:this.rightBottom}),this.annotation.contents=v,this.freetextElement.innerText=v}this.appendOrRemoveFreetextEditElement("remove"),this.appendOrRemoveFreetextElement("append"),this.name!==r.annotationStore.selectedElementName&&r.annotationStore.selectedElementName||(this.hidden=!0,this.handleContainerClick()),this.setCss(this.svgElement,{pointerEvents:"all"})}},{key:"appendOrRemoveFreetextElement",value:function(r){var u=this.freetextElement,s=this.svgElement;r==="append"?(s.addEventListener("mousedown",this.onContainerClick),this.annotationContainer.append(u)):(s.removeEventListener("mousedown",this.onContainerClick),u.remove())}},{key:"appendOrRemoveFreetextEditElement",value:function(r){var u=this.freetextEditElement;r==="append"?(u.addEventListener("blur",this.onBlur),u.addEventListener("click",this.handleStopPropagation),u.addEventListener("paste",this.onPaste),this.annotationContainer.append(u),u.focus(),keepLastIndex(u)):(u.removeEventListener("blur",this.onBlur),u.removeEventListener("click",this.handleStopPropagation),u.removeEventListener("paste",this.onPaste),u.remove())}},{key:"handleElementSelect",value:function(){this.hidden=!1,this.show&&this.updateTool();var r=[this.freetextElement,this.outerLine,document.querySelector(".toggle-button"),document.querySelector(".sidebar-style"),document.querySelector(".freetext-panel")],u=document.querySelector(".freetext-popup");u&&r.push(u),this.outSideListener=onClickOutside$1(r,this.handleOutside.bind(this))}},{key:"getActualRect",value:function(r){var u=this.annotation.rect,s=u.left,w=u.top,m=u.right,v=u.bottom,g=getActualPoint$1({x:s,y:w},r),d=getActualPoint$1({x:m,y:v},r);return{leftTop:{x:Math.min(g.x,d.x),y:Math.min(g.y,d.y)},rightBottom:{x:Math.max(g.x,d.x),y:Math.max(g.y,d.y)}}}},{key:"rectCalc",value:function(r){var u=r.leftTop,s=r.rightBottom;return{top:u.y<s.y?u.y:s.y,left:u.x<s.x?u.x:s.x,width:Math.abs(s.x-u.x),height:Math.abs(s.y-u.y)}}},{key:"calculate",value:function(r,u){var s=this.rectCalc({leftTop:r,rightBottom:u});return{top:s.top,left:s.left,width:s.width,height:s.height}}},{key:"getInitialPoint",value:function(){var r=this.leftTop.x,u=this.leftTop.y,s=this.rightBottom.x,w=this.rightBottom.y,m=this.documentViewer.scale;return{leftTop:{x:r/m,y:u/m},rightBottom:{x:s/m,y:w/m}}}},{key:"selectAnnotation",value:function(){this.documentViewer.annotationStore.selectedElementName!==this.annotation.name&&this.handleContainerClick()}},{key:"updateTool",value:function(){if(this.initial){var r=this.documentViewer;if(this.hidden)this.outerLineContainer.remove(),r.annotationStore.selectedElementName===this.annotation.name&&(r.annotationStore.selectedElementName=null);else{var u;if(r.annotationStore.selectedElementName!==this.annotation.name){var s=this.annotation;r.annotationStore.selectedElementName=s.name;var w=_objectSpread2$1({},s);delete w.annotPtr,delete w.pagePtr,delete w.operate,delete w.targetPage,r.eventBus.dispatch("annotationSelected",w),this.documentViewer.eventBus.dispatch("annotationSelectedAttr",this)}(u=this.layer)===null||u===void 0||u.div.append(this.outerLineContainer),this.outerLine.addEventListener("mousedown",this.onMousedown),this.outerLine.addEventListener("dblclick",this.onDbclick),this.outerLine.addEventListener("click",this.onSingleClick),this.outerLine.addEventListener("touchstart",this.onMousedown),r.getScrollViewElement().style.touchAction="none"}}}},{key:"onSingleClick",value:function(r){r.stopPropagation();var u=new Date().getTime();u-this.lastClickTime<300&&this.onDbclick(),this.lastClickTime=u}},{key:"handleContainerClick",value:function(r){var u,s;if(this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author?(u=this.layer)===null||u===void 0||u.div.classList.remove("no-edit"):(s=this.layer)===null||s===void 0||s.div.classList.add("no-edit"),this.layer&&!(!this.hidden||this.layer.addMode||this.documentViewer.annotationStore.creating||["redaction","remove"].includes(this.layer.tool)||document.querySelector(".compare-document-container").contains(r==null?void 0:r.target))){this.hidden=!1,this.updateTool();var w=[this.annotationContainer,this.outerLine,document.querySelector(".toggle-button"),document.querySelector(".sidebar-style"),document.querySelector(".freetext-panel")],m=document.querySelector(".freetext-popup");m&&w.push(m),this.outSideListener=onClickOutside$1(w,this.handleOutside.bind(this))}}},{key:"handleOutside",value:function(){var r,u,s,w,m;this.documentViewer.annotationStore.selectedElementName===this.annotation.name&&(this.documentViewer.annotationStore.selectedElementName=null,this.editing=!1),!this.hidden&&this.documentViewer.eventBus.dispatch("annotationDeselected",this),this.hidden=!0,(r=this.outerLine)===null||r===void 0||r.removeEventListener("mousedown",this.onMousedown),(u=this.outerLine)===null||u===void 0||u.removeEventListener("touchstart",this.onMousedown),(s=this.outerLine)===null||s===void 0||s.removeEventListener("dblclick",this.onDbclick),(w=this.outerLine)===null||w===void 0||w.addEventListener("click",this.onSingleClick),(m=this.outerLineContainer)===null||m===void 0||m.remove(),this.documentViewer.getScrollViewElement().style.touchAction="auto"}},{key:"handleStopPropagation",value:function(r){r.stopPropagation()}},{key:"handleMouseDown",value:function(r){var u;if(r.button===0||r.type!=="mousedown"){(u=this.layer)!==null&&u!==void 0&&u.tool&&r.stopPropagation();var s=r.target.getAttribute("data-id"),w=this.documentViewer.getScrollViewElement();this.scrollTop=w.scrollTop,this.scrollLeft=w.scrollLeft;var m=getClickPoint(r),v=m.pageX,g=m.pageY;this.startState={operator:s,clickX:v,clickY:g},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"getFloatPointPosition",value:function(){var r=this.annotation.floatPoint[1],u=this.documentViewer.scale,s=this.leftTop.x/u,w=this.leftTop.y/u,m=this.rightBottom.x/u,v=this.rightBottom.y/u,g=this.annotation.rectDiff,d=r.x-s,f=m-r.x,y=r.y-w,x=v-r.y;return d<=g.left||Math.abs(d-g.left)<1e-5?"left":f<=g.right||Math.abs(f-g.right)<1e-5?"right":y<=Math.abs(g.top)||Math.abs(y-Math.abs(g.top))<1e-5?"top":x<=Math.abs(g.bottom)||Math.abs(x-Math.abs(g.bottom))<1e-5?"bottom":void 0}},{key:"getPointPosition",value:function(r){var u=this.documentViewer.scale,s=this.leftTop.x/u,w=this.leftTop.y/u,m=this.rightBottom.x/u,v=this.rightBottom.y/u,g=this.annotation.rectDiff,d=s+g.left,f=w+g.top,y=m-g.right,x=v-g.bottom,k=r.x<d,P=r.y<f,S=r.x<y,E=r.y<x;return!k&&S&&P?"top":k||!S||E?k?"left":S?void 0:"right":"bottom"}},{key:"testPointInBox",value:function(r){var u=this.documentViewer.scale,s=this.leftTop.x/u,w=this.leftTop.y/u,m=this.rightBottom.x/u,v=this.rightBottom.y/u,g=this.annotation.rectDiff,d=r.x-s,f=r.y-w,y=m-r.x,x=v-r.y;return d>g.left&&f>g.top&&y>g.right&&x>g.bottom}},{key:"pointInFreetextRect",value:function(r,u){var s=this.documentViewer.scale,w=r.x/s,m=r.y/s,v=u.x/s,g=u.y/s,d=this.annotation.floatPoint[0],f=this.annotation.rectDiff,y=d.x-w,x=d.y-m,k=v-d.x,P=g-d.y;return y>f.left&&x>f.top&&k>f.right&&P>f.bottom}},{key:"setLinkPoint",value:function(r){var u=this.annotation.floatPoint;u[2]=r,u[2]}},{key:"handleMouseMove",value:function(r){if(r.button===0||r.type!=="mousemove"){r.type==="touchmove"&&this.layer&&(this.layer.pageDiv.style.touchAction="none"),this.moving=!0;var u=getClickPoint(r),s=u.pageX,w=u.pageY,m=this.documentViewer,v=m.getScrollViewElement(),g=v.scrollTop;s=s+v.scrollLeft-this.scrollLeft,w=w+g-this.scrollTop;var d=this.annotation,f=this.documentViewer.scale,y=this.leftTop,x=this.rightBottom,k=this.startState,P=m.getPageWidth(this.PageNumber)*f,S=m.getPageHeight(this.PageNumber)*f,E=this.getFloatPointPosition();if(k.operator==="nw-resize"){var M=this.moveW(s,E).x,T=this.moveN(w,E).y;this.update({leftTop:{x:M,y:T},rightBottom:x})}else if(k.operator==="w-resize"){var D=this.moveW(s,E);this.update({leftTop:D,rightBottom:this.rightBottom})}else if(k.operator==="sw-resize"){var N=this.moveW(s,E).x,I=this.moveS(w,E).y;this.update({leftTop:{x:N,y:y.y},rightBottom:{x:x.x,y:I}})}else if(k.operator==="s-resize"){var O=this.moveS(w,E);this.update({leftTop:this.leftTop,rightBottom:O})}else if(k.operator==="se-resize"){var F=this.moveE(s,E).x,q=this.moveS(w,E).y;this.update({leftTop:y,rightBottom:{x:F,y:q}})}else if(k.operator==="n-resize"){var Y=this.moveN(w,E);this.update({leftTop:Y,rightBottom:this.rightBottom})}else if(k.operator==="ne-resize"){var _e=this.moveE(s,E).x,ne=this.moveN(w,E).y;this.update({leftTop:{x:y.x,y:ne},rightBottom:{x:_e,y:x.y}})}else if(k.operator==="e-resize"){var ve=this.moveE(s,E);this.update({leftTop:y,rightBottom:ve})}else if(k.operator==="move"){var J,fe,Z,j,X=this.documentViewer,H=this.getMouseLocation(r),U=X.getSelectedPage(H,H),te=this.getPageNumber(),Q=d.floatPoint;if(U.first&&U.first!==te){var re,Pe=X.windowToPage(H,U.first,!1),be=Math.abs(y.x-x.x),we=Math.abs(y.y-x.y);if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===0)J=s-(k.clickX-y.x),fe=U.first>te?Pe.y:Pe.y-we,Z=s-(k.clickX-x.x),j=U.first>te?Pe.y+we:Pe.y;else if(X.pdfViewer.spreadMode===0&&X.pdfViewer.scrollMode===1)J=U.first>te?Pe.x:Pe.x-be,fe=w-(k.clickY-y.y),Z=U.first>te?Pe.x+be:Pe.x,j=w-(k.clickY-x.y);else if(X.pdfViewer.spreadMode===1&&X.pdfViewer.scrollMode===0){var Ae=Math.min(U.first,te),$e=Math.max(U.first,te);if($e-Ae>2||Ae+1===$e&&Ae%2==0)return;Ae+1===$e?(J=U.first>te?Pe.x:Pe.x-be,fe=w-(k.clickY-y.y),Z=U.first>te?Pe.x+be:Pe.x,j=w-(k.clickY-x.y)):Ae+2===$e&&(J=s-(k.clickX-y.x),fe=U.first>te?Pe.y:Pe.y-we,Z=s-(k.clickX-x.x),j=U.first>te?Pe.y+we:Pe.y)}else if(X.pdfViewer.spreadMode===2&&X.pdfViewer.scrollMode===0){var Me=Math.min(U.first,te),Ie=Math.max(U.first,te);if(Ie-Me>2||Me+1===Ie&&(Me!==1||Ie!==2)&&Ie%2==0||Me===1&&Ie===3)return;Me+2===Ie||Me===1&&Ie===2?(J=s-(k.clickX-y.x),fe=U.first>te?Pe.y:Pe.y-we,Z=s-(k.clickX-x.x),j=U.first>te?Pe.y+we:Pe.y):Me+1===Ie&&(J=U.first>te?Pe.x:Pe.x-be,fe=w-(k.clickY-y.y),Z=U.first>te?Pe.x+be:Pe.x,j=w-(k.clickY-x.y))}if(Q[0].x=Q[0].x+(J-y.x)/f,Q[0].y=Q[0].y+(fe-y.y)/f,Q[1].x=Q[1].x+(J-y.x)/f,Q[1].y=Q[1].y+(fe-y.y)/f,Q[2].x=Q[2].x+(J-y.x)/f,Q[2].y=Q[2].y+(fe-y.y)/f,!X.pdfViewer._pages[U.first-1].compdfAnnotationLayer)return this.leftTop={x:J,y:fe},void(this.rightBottom={x:Z,y:j});this.annotation.prePageIndex=this.annotation.pageIndex,this.annotation.pageIndex=U.first-1,this.annotationContainer.remove(),this.outerLineContainer.remove();var Le=(re=this.layer)===null||re===void 0?void 0:re.div;Le==null||Le.append(this.annotationContainer),Le==null||Le.append(this.outerLineContainer)}else{J=s-(k.clickX-y.x),fe=w-(k.clickY-y.y),Z=s-(k.clickX-x.x),j=w-(k.clickY-x.y);var le=X.pageToWindow({x:J,y:fe},te,!1),oe=X.pageToWindow({x:Z,y:j},te,!1),ke=0,Ce=0;w>k.clickY?Ce=(Ce=v.offsetHeight-(oe.y-v.scrollTop-v.offsetTop))<100?5:0:w<k.clickY&&(Ce=(Ce=le.y-v.scrollTop-v.offsetTop)<100?-5:0),s>k.clickX?ke=(ke=v.offsetWidth-(oe.x-v.scrollLeft-v.offsetLeft))<100?5:0:s<k.clickX&&(ke=(ke=le.x-v.scrollLeft-v.offsetLeft)<100?-5:0),(ke||Ce)&&(v.scrollTop+=Ce,v.scrollLeft+=ke);var Ee={width:Math.abs(J-Z),height:Math.abs(j-fe)};J<Z?(J=Math.max(12,J),J=Math.min(P-Ee.width-4,J),Z=Math.max(Ee.width+12,Z),Z=Math.min(P-4,Z)):(Z=Math.max(4,Z),Z=Math.min(P-Ee.width-12,Z),J=Math.max(Ee.width+4,J),J=Math.min(P-12,J)),j<fe?(j=Math.max(6,j),j=Math.min(S-Ee.height-9,j),fe=Math.max(Ee.height+6,fe),fe=Math.min(S-9,fe)):(fe=Math.max(9,fe),fe=Math.min(S-Ee.height-6,fe),j=Math.max(Ee.height+9,j),j=Math.min(S-6,j)),Q[0].x=Q[0].x+(J-y.x)/f,Q[0].y=Q[0].y+(fe-y.y)/f,Q[1].x=Q[1].x+(J-y.x)/f,Q[1].y=Q[1].y+(fe-y.y)/f,Q[2].x=Q[2].x+(J-y.x)/f,Q[2].y=Q[2].y+(fe-y.y)/f}this.update({leftTop:{x:J,y:fe},rightBottom:{x:Z,y:j}})}else if(k.operator==="point0"){var Be=d.floatPoint[0],Ve=d.rectDiff,Oe={left:y.x/f+Ve.left,top:y.y/f+Ve.top,right:x.x/f-Ve.right,bottom:x.y/f-Ve.bottom},je={x:s-k.clickX,y:w-k.clickY},Ge={x:Be.x+je.x/f,y:Be.y+je.y/f};if(Ge.x=Math.max(3,Ge.x),Ge.x=Math.min(P/f-3,Ge.x),Ge.y=Math.max(3,Ge.y),Ge.y=Math.min(S/f-3,Ge.y),this.testPointInBox(Ge))return;var Xe=this.getPointPosition(Ge);if(E==="top"){if(Xe==="top"){d.floatPoint[0]=Ge;var qe=Math.min(d.floatPoint[1].y,d.floatPoint[0].y);Ve.top=y.y/f+Ve.top-qe,y.y=qe*f}else if(Xe==="left"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left-10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.left,y:Oe.top+(Oe.bottom-Oe.top)/2};var Ke=Math.min(d.floatPoint[1].x,d.floatPoint[0].x);Ve.left=y.x/f+Ve.left-Ke,y.x=Ke*f}else if(Xe==="right"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.right+10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.right,y:Oe.top+(Oe.bottom-Oe.top)/2};var Je=Math.max(d.floatPoint[1].x,d.floatPoint[0].x);Ve.right=Je-(x.x/f-Ve.right),x.x=Je*f}else if(Xe==="bottom"){d.floatPoint[0]=Ge,d.floatPoint[1].y=Oe.bottom+10,d.floatPoint[2].y=Oe.bottom;var rt=y.y/f+Ve.top-.5,ht=Math.max(d.floatPoint[0].y,d.floatPoint[1].y);Ve.top=Math.abs(y.y/f+Ve.top-rt),Ve.bottom=Math.abs(ht-(x.y/f-Ve.bottom)),y.y=rt*f,x.y=ht*f}}else if(E==="left"){if(Xe==="left"){d.floatPoint[0]=Ge;var vt=Math.min(d.floatPoint[1].x,d.floatPoint[0].x);Ve.left=y.x/f+Ve.left-vt;var Ct=Math.min(d.floatPoint[0].y,y.y/f+Ve.top-.5),kt=Math.max(d.floatPoint[0].y,x.y/f-Ve.bottom+.5);Ve.top=Math.abs(y.y/f+Ve.top-Ct),Ve.bottom=Math.abs(kt-(x.y/f-Ve.bottom)),y.x=vt*f,y.y=Ct*f,x.y=kt*f}else if(Xe==="top"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.top-10},d.floatPoint[2]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.top};var mt=Math.min(d.floatPoint[1].y,d.floatPoint[0].y);Ve.top=y.y/f+Ve.top-mt,y.y=mt*f,y.x=Oe.left*f-.5*f,Ve.left=.5}else if(Xe==="bottom"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.bottom+10},d.floatPoint[2]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.bottom};var Vt=Math.max(d.floatPoint[1].y,d.floatPoint[0].y);Ve.bottom=Vt-(x.y/f-Ve.bottom),x.y=Vt*f,y.x=Oe.left*f-.5*f,Ve.left=.5}else if(Xe==="right"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.right+10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.right,y:Oe.top+(Oe.bottom-Oe.top)/2};var bt=Math.max(d.floatPoint[1].x,d.floatPoint[0].x);Ve.right=bt-(x.x/f-Ve.right),x.x=bt*f,y.x=Oe.left*f-.5*f,Ve.left=.5}}else if(E==="right"){if(Xe==="right"){d.floatPoint[0]=Ge;var ot=Math.max(d.floatPoint[1].x,d.floatPoint[0].x);Ve.right=ot-(x.x/f-Ve.right);var gt=Math.min(d.floatPoint[0].y,y.y/f+Ve.top-.5),tt=Math.max(d.floatPoint[0].y,x.y/f-Ve.bottom+.5);Ve.top=Math.abs(y.y/f+Ve.top-gt),Ve.bottom=Math.abs(tt-(x.y/f-Ve.bottom)),x.x=ot*f,y.y=gt*f,x.y=tt*f}else if(Xe==="top"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.top-10},d.floatPoint[2]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.top};var ut=Math.min(d.floatPoint[1].y,d.floatPoint[0].y);Ve.top=y.y/f+Ve.top-ut,y.y=ut*f,x.x=(Oe.right+.5)*f,Ve.right=.5}else if(Xe==="bottom"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.bottom+10},d.floatPoint[2]={x:Oe.left+(Oe.right-Oe.left)/2,y:Oe.bottom};var Re=Math.max(d.floatPoint[1].y,d.floatPoint[0].y);Ve.bottom=Re-(x.y/f-Ve.bottom),x.y=Re*f,x.x=(Oe.right+.5)*f,Ve.right=.5}else if(Xe==="left"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left-10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.left,y:Oe.top+(Oe.bottom-Oe.top)/2};var Te=Math.min(d.floatPoint[1].x,d.floatPoint[0].x);Ve.left=y.x/f+Ve.left-Te,y.x=Te*f,x.x=(Oe.right+.5)*f,Ve.right=.5}}else if(E==="bottom"){if(Xe==="bottom"){d.floatPoint[0]=Ge;var He=Math.max(d.floatPoint[1].y,d.floatPoint[0].y);Ve.bottom=He-(x.y/f-Ve.bottom),x.y=He*f}else if(Xe==="right"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.right+10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.right,y:Oe.top+(Oe.bottom-Oe.top)/2};var Fe=Math.max(d.floatPoint[1].x,d.floatPoint[0].x);Ve.right=Fe-(x.x/f-Ve.right),x.x=Fe*f}else if(Xe==="left"){d.floatPoint[0]=Ge,d.floatPoint[1]={x:Oe.left-10,y:Oe.top+(Oe.bottom-Oe.top)/2},d.floatPoint[2]={x:Oe.left,y:Oe.top+(Oe.bottom-Oe.top)/2};var ze=Math.min(d.floatPoint[1].x,d.floatPoint[0].x);Ve.left=y.x/f+Ve.left-ze,y.x=ze*f}else if(Xe==="top"){d.floatPoint[0]=Ge,d.floatPoint[1].y=Oe.top-10,d.floatPoint[2].y=Oe.top;var We=Math.min(d.floatPoint[0].y,d.floatPoint[1].y),Ue=x.y/f-Ve.bottom+.5;Ve.top=Math.abs(y.y/f+Ve.top-We),Ve.bottom=Math.abs(Ue-(x.y/f-Ve.bottom)),y.y=We*f,x.y=Ue*f}}this.update({leftTop:this.leftTop,rightBottom:this.rightBottom})}else if(k.operator==="point1"){var et=d.rectDiff,it=d.floatPoint,nt={x:s-k.clickX,y:w-k.clickY};if(E==="top"){var dt=Math.max(3,it[1].y+nt.y/f);dt=Math.min(dt,it[2].y-10),it[1].y=dt;var xt=Math.min(it[0].y,it[1].y);et.top=Math.abs(y.y/f+et.top-xt),y.y=xt*f}else if(E==="left"){var yt=Math.max(3,it[1].x+nt.x/f);yt=Math.min(yt,it[2].x-10),it[1].x=yt;var Bt=Math.min(it[0].x,it[1].x);et.left=Math.abs(y.x/f+et.left-Bt),y.x=Bt*f}else if(E==="bottom"){var Pt=Math.min(S/f-3,it[1].y+nt.y/f);Pt=Math.max(Pt,it[2].y+10),it[1].y=Pt;var Tt=Math.max(it[0].y,it[1].y);et.bottom=Math.abs(Tt-x.y/f+et.bottom),x.y=Tt*f}else if(E==="right"){var ct=Math.min(P/f-3,it[1].x+nt.x/f);ct=Math.max(ct,it[2].x+10),it[1].x=ct;var wt=Math.max(it[0].x,it[1].x);et.right=Math.abs(wt-x.x/f+et.right),x.x=wt*f}this.update({leftTop:this.leftTop,rightBottom:this.rightBottom})}k.clickX=s,k.clickY=w;var St=this.getInitialPoint();this.documentViewer.eventBus.dispatch("mouseMoving",{rect:{left:St.leftTop.x,top:St.leftTop.y,right:St.rightBottom.x,bottom:St.rightBottom.y},pageNumber:this.annotation.pageIndex+1})}}},{key:"moveN",value:function(r,u){var s=this.annotation,w=this.startState,m=this.documentViewer.scale,v=this.leftTop,g=s.floatPoint,d=s.rectDiff,f=this.freetextRect,y=s.borderWidth*m,x=10,k=_objectSpread2$1({},d),P=_toConsumableArray$1(g),S=Math.abs(d.top),E=r-(w.clickY-S*m);E>S*m+f.height-y-x&&(r=(E=S*m+f.height-y-x)-S*m+w.clickY);var M={x:v.x,y:v.y};if(d.top=E/m,E<=.5*m){d.top=.5;var T=.5*m-E;M.y=Math.max(3,M.y-T),r=M.y-v.y+w.clickY}return this.pointInFreetextRect(M,this.rightBottom)?(s.rectDiff=_objectSpread2$1({},k),s.floatPoint=_toConsumableArray$1(P),v):(u==="top"?(g[2].y=g[2].y+(r-w.clickY)/m,g[1].y=g[1].y+(r-w.clickY)/m,M.y=Math.min(g[0].y*m,g[1].y*m),M.y<v.y?d.top=Math.min(k.top,Math.max(g[2].y-g[1].y,g[2].y-g[0].y)):M.y>v.y&&(d.top=Math.max(g[2].y-g[1].y,g[2].y-g[0].y))):u!=="left"&&u!=="right"||(g[2].y=g[2].y+(r-w.clickY)/m/2,g[1].y=g[1].y+(r-w.clickY)/m/2),u!=="top"&&M.y+(d.top-.5)*m<g[0].y*m&&(M.y=M.y+(d.top-.5)*m,d.top=.5),M)}},{key:"moveS",value:function(r,u){var s=this.annotation,w=this.startState,m=this.documentViewer.scale,v=this.rightBottom,g=s.floatPoint,d=s.rectDiff,f=this.freetextRect,y=s.borderWidth*m,x=this.documentViewer.getPageHeight(this.PageNumber)*m,k=_objectSpread2$1({},d),P=_toConsumableArray$1(g),S=Math.abs(d.bottom),E=S*m-(r-w.clickY);r=S*m-(E=Math.min(S*m+f.height-y-10,E))+w.clickY;var M={x:v.x,y:v.y};if(d.bottom=E/m,E<=.5*m){d.bottom=.5;var T=.5*m-E;M.y=Math.min(x-3*m,M.y+T),r=M.y-v.y+w.clickY}return M.y/m-d.bottom>g[0].y&&u==="bottom"?(s.rectDiff=_objectSpread2$1({},k),s.floatPoint=_toConsumableArray$1(P),v):(u==="bottom"?(g[2].y=g[2].y+(r-w.clickY)/m,g[1].y=g[1].y+(r-w.clickY)/m,M.y=Math.max(g[0].y*m,g[1].y*m),M.y>v.y?d.bottom=Math.min(k.bottom,Math.max(g[0].y-g[2].y,g[1].y-g[2].y)):M.y<v.y&&(d.bottom=Math.max(g[0].y-g[2].y,g[1].y-g[2].y))):u!=="left"&&u!=="right"||(g[2].y=g[2].y+(r-w.clickY)/m/2,g[1].y=g[1].y+(r-w.clickY)/m/2),u!=="bottom"&&M.y-(d.bottom-.5)*m>g[0].y*m&&(M.y=M.y-(d.bottom-.5)*m,d.bottom=.5),M)}},{key:"moveW",value:function(r,u){var s=this.annotation,w=this.startState,m=this.documentViewer.scale,v=this.leftTop,g=s.floatPoint,d=s.rectDiff,f=this.freetextRect,y=s.borderWidth*m,x=_objectSpread2$1({},d),k=_toConsumableArray$1(g),P=Math.abs(d.left),S=r-(w.clickX-P*m);r=(S=Math.min(P*m+f.width-y-10,S))-P*m+w.clickX;var E={x:v.x,y:v.y};if(d.left=S/m,S<=.5*m){d.left=.5;var M=.5*m-S;E.x=Math.max(3,E.x-M),r=E.x-v.x+w.clickX}return E.x/m+d.left<g[0].x&&u==="left"?(s.rectDiff=_objectSpread2$1({},x),s.floatPoint=_toConsumableArray$1(k),v):(u==="left"?(g[2].x=g[2].x+(r-w.clickX)/m,g[1].x=g[1].x+(r-w.clickX)/m,E.x=Math.min(g[0].x*m,g[1].x*m),E.x<v.x?d.left=Math.min(x.left,Math.max(g[2].x-g[1].x,g[2].x-g[0].x)):E.x>v.x&&(d.left=Math.max(g[2].x-g[1].x,g[2].x-g[0].x))):u!=="top"&&u!=="bottom"||(g[2].x=g[2].x+(r-w.clickX)/m/2,g[1].x=g[1].x+(r-w.clickX)/m/2),u!=="left"&&E.x+(d.left-.5)*m<g[0].x*m&&(E.x=E.x+(d.left-.5)*m,d.left=.5),E)}},{key:"moveE",value:function(r,u){var s=this.annotation,w=this.startState,m=this.documentViewer.scale,v=this.rightBottom,g=s.floatPoint,d=s.rectDiff,f=this.freetextRect,y=s.borderWidth*m,x=this.documentViewer.getPageWidth(this.PageNumber)*m,k=_objectSpread2$1({},d),P=_toConsumableArray$1(g),S=Math.abs(d.right),E=S*m-(r-w.clickX);r=S*m-(E=Math.min(S*m+f.width-y-10,E))+w.clickX;var M={x:this.rightBottom.x,y:this.rightBottom.y};if(d.right=E/m,E<=.5*m){d.right=.5;var T=.5*m-E;M.x=Math.min(x-3*m,M.x+T),r=M.x-v.x+w.clickX}return M.x/m-d.right>g[0].x&&u==="right"?(s.rectDiff=_objectSpread2$1({},k),s.floatPoint=_toConsumableArray$1(P),v):(u==="right"?(g[2].x=g[2].x+(r-w.clickX)/m,g[1].x=g[1].x+(r-w.clickX)/m,M.x=Math.max(g[0].x*m,g[1].x*m),M.x>v.x?d.right=Math.min(k.right,Math.max(g[0].x-g[2].x,g[1].x-g[2].x)):M.x<v.x&&(d.right=Math.max(g[0].x-g[2].x,g[1].x-g[2].x))):u!=="top"&&u!=="bottom"||(g[2].x=g[2].x+(r-w.clickX)/m/2,g[1].x=g[1].x+(r-w.clickX)/m/2),u!=="right"&&M.x-(d.right-.5)*m>g[0].x*m&&(M.x=M.x-(d.right-.5)*m,d.right=.5),M)}},{key:"handleMouseUp",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g,d,f,y,x,k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(u.button===0||u.type!=="mouseup"){P.next=2;break}return P.abrupt("return");case 2:if((s=this.layer)!==null&&s!==void 0&&s.tool&&u.stopPropagation(),u.type==="touchend"&&this.layer&&(this.layer.pageDiv.style.touchAction=""),this.moving=!1,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.scrollLeft=0,this.scrollTop=0,w=this.annotation,m=this.getInitialPoint(),v=m.leftTop,g=m.rightBottom,(d={left:v.x,top:v.y,right:g.x,bottom:g.y})!==w.rect||this.PrePageNumber!==this.PageNumber){P.next=16;break}return P.abrupt("return");case 16:if(w.rect=d,this.PrePageNumber===this.PageNumber){P.next=41;break}return f={type:"delete",annotation:{operate:"del-annot",name:w.name,pageIndex:w.pageIndex,annotPtr:w.annotPtr}},this.documentViewer.eventBus.dispatch("annotationChange",f),this.isDelete=!0,this.documentViewer.getAnnotationManager().deleteAnnotation(this),delete(y=Object.assign({},w)).annotPtr,delete y.pagePtr,delete y.name,delete y.prePageIndex,y.operate="add-annot",y.pageIndex=this.PageNumber-1,P.next=31,this.documentViewer.annotationManager.createAnnotation(y);case 31:x=P.sent,k=new n({annotation:x,documentViewer:this.documentViewer,show:!0,enableReply:this.documentViewer.enableReply}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"delete"),this.documentViewer.annotationManager.addAnnotation(k),this.documentViewer.annotationManager.drawAnnotationsFromList(k),this.annotationContainer.remove(),this.outerLineContainer.remove(),k.selectAnnotation(),P.next=43;break;case 41:this.documentViewer.eventBus.dispatch("annotationChange",{type:"modify",annotation:{type:"freetext",operate:"mod-annot",doc:this.documentViewer.doc,name:w.name,pageIndex:this.PageNumber-1,pagePtr:w.pagePtr,annotPtr:w.annotPtr,rect:d,floatPoint:w.floatPoint,rectDiff:w.rectDiff}}),this.documentViewer.eventBus.dispatch("annotationChanged",this,"modify");case 43:case"end":return P.stop()}},r,this)})),function(r){return o.apply(this,arguments)})},{key:"draw",value:function(){if(this.layer){this.layer.div.append(this.annotationContainer),this.hidden||this.documentViewer.annotationStore.selectedElementName!==this.annotation.name||this.layer.div.append(this.outerLineContainer);var r=this.moving?this:this.getActualRect(this.documentViewer.scale),u=r.leftTop,s=r.rightBottom;this.update({leftTop:u,rightBottom:s})}}},{key:"update",value:function(r){var u=r.leftTop,s=r.rightBottom,w=r.freetextRect,m=this.layer.viewport,v=m.width,g=m.height;this.leftTop=u=u||this.leftTop,this.rightBottom=s=s||this.rightBottom;var d=this.calculate(u,s),f=this.annotation,y=this.documentViewer.scale,x=f.borderWidth*y,k=d.width-(Math.abs(f.rectDiff.left)+Math.abs(f.rectDiff.right))*y-2*x,P=d.height-(Math.abs(f.rectDiff.top)+Math.abs(f.rectDiff.bottom))*y-2*x,S=Math.abs(f.rectDiff.top)*y+x,E=Math.abs(f.rectDiff.left)*y+x;this.freetextRect=w||{left:E,top:S,width:k,height:P},this.setCss(this.annotationContainer,{width:d.width+"px",height:d.height+"px"}),this.svgElement.setAttribute("viewBox","".concat(d.left," ").concat(d.top," ").concat(d.width," ").concat(d.height)),this.setCss(this.svgElement,{width:d.width+"px",height:d.height+"px"}),this.renderArrow(),this.setCss(this.annotationContainer,{top:d.top+"px",left:d.left+"px"});var M=v-u.x,T=g-u.y,D=f.fontSize*y;this.setCss(this.freetextEditElement,{top:S+"px",left:E+"px",maxWidth:M+"px",maxHeight:T+"px",width:k+"px",height:P+"px",fontSize:D+"px"}),this.setCss(this.freetextElement,{top:S+"px",left:E+"px",width:k+"px",height:P+"px",fontSize:D+"px"}),this.setCss(this.outerLine,{left:"".concat(d.left-x,"px"),top:"".concat(d.top-x,"px"),width:"".concat(d.width+2*x,"px"),height:"".concat(d.height+2*x,"px")}),this.renderOutline()}},{key:"handleDelete",value:function(r){if(!this.editing){this.isDelete=!0,this.layer&&this.layer.tool&&r&&r.stopPropagation(),this.delete();var u={type:"delete",annotation:{operate:"del-annot",name:this.annotation.name,pageIndex:this.PageNumber-1}};this.annotation.annotPtr&&(u.annotation.annotPtr=this.annotation.annotPtr),this.documentViewer.eventBus.dispatch("annotationChange",u),this.documentViewer.getAnnotationManager().deleteAnnotation(this)}}},{key:"delete",value:function(){var r,u;this.handleOutside(),(r=this.annotationContainer)===null||r===void 0||r.remove(),this.annotation.isDelete=!0,(u=this.layer)===null||u===void 0||u.deleteAnnotationInLayer({name:this.annotation.name})}},{key:"openReply",value:function(){this.documentViewer.eventBus.dispatch("openAnnotationReply",this.annotation)}},{key:"handleFreetextEditElementPaste",value:function(r){pastePlainText(r)}}]);var o}(),CalloutCreateTool=function(){return _createClass(function e(n){_classCallCheck(this,e),this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,this.clickTimeId=null,this.addedBeforeMove=!1,this.onMousemove=this.handleMouseMove.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.documentViewer=n.documentViewer,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.defaultStyles={borderWidth:2,opacity:1,color:"#FF0000",borderColor:"#FF0000",borderStyle:"solid",dashes:"2,2",contents:"",fontName:"Helvetica",fontSize:14,fontStyle:"normal",fontWeight:"normal",textAlignment:"left",fillColor:""}},[{key:"reset",value:function(){this.annotationStore.creating&&this.drawingAnnot.delete(),this.annotationStore.creating=!1,this.realStartPoint=null,this.realEndPoint=null,this.drawingAnnot=null,this.layer=null,document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("keydown",this.onKeydown)}},{key:"handleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.pageIndex,u=n.oriPoint;n.realPoint;var s=n.layer;return _regeneratorRuntime().mark(function w(){var m,v,g,d,f;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!o.clickTimeId){y.next=4;break}return clearTimeout(o.clickTimeId),o.clickTimeId=null,y.abrupt("return");case 4:if(!o.annotationStore.selectedElementName){y.next=6;break}return y.abrupt("return");case 6:return o.layer=s,m=Object.assign({type:"freetext",pageIndex:r,floatPoint:[{x:u.x,y:u.y},{x:u.x+20,y:u.y+50},{x:u.x+30,y:u.y+50}],rect:{left:u.x,top:u.y,right:u.x+230,bottom:u.y+70},rectDiff:{left:30,top:30,right:.5,bottom:.5},intent:"FreeTextCallout"},o.defaultStyles),v=o.documentViewer,g=r+1,d=v.getPageWidth(g),f=v.getPageHeight(g),m.rect.right>d&&(m.floatPoint[1].x=u.x-20,m.floatPoint[2].x=u.x-30,m.rect.left=u.x-230,m.rect.right=u.x,m.rectDiff.left=.5,m.rectDiff.right=30),m.rect.bottom>f&&(m.floatPoint[1].y=u.y-50,m.floatPoint[2].y=u.y-50,m.rect.top=u.y-70,m.rect.bottom=u.y,m.rectDiff.top=.5,m.rectDiff.bottom=30),o.drawingAnnot=new Callout({annotation:m,documentViewer:v,highlight:o.annotationStore.highlightLink}),o.drawingAnnot.draw(),y.next=18,v.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 18:y.sent,o.drawingAnnot.selectAnnotation(),v.getAnnotationManager().addAnnotation(o.drawingAnnot),isMobileDevice$1&&o.drawingAnnot.handleElementDbClick();case 22:case"end":return y.stop()}},w)})()})}},{key:"handleKeyDown",value:function(e){(e.keyCode||e.which)===27&&(e.preventDefault(),this.reset())}},{key:"handleMouseMove",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.annotationStore.creating){g.next=2;break}return g.abrupt("return");case 2:if(o=getAbsoluteCoordinate(this.layer.pageDiv,e),r=o.x,u=o.y,s=this.layer.viewport,w=s.width,m=s.height,v=s.scale,r=Math.max(0,Math.min(w,r)),u=Math.max(0,Math.min(m,u)),this.realEndPoint={x:r,y:u},this.realStartPoint.x!==this.realEndPoint.x||this.realStartPoint.y!==this.realEndPoint.y){g.next=9;break}return g.abrupt("return");case 9:!this.addedBeforeMove&&this.drawingAnnot.setLinkPoint({x:r/v,y:u/v}),this.addedBeforeMove=!0,this.drawingAnnot.update({leftTop:this.drawingAnnot.leftTop,rightBottom:this.drawingAnnot.rightBottom});case 12:case"end":return g.stop()}},n,this)}))}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o=this;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Object.entries(e).forEach(function(u){var s=_slicedToArray(u,2),w=s[0],m=s[1];Object.hasOwn(o.defaultStyles,w)&&o.defaultStyles[w]!==m&&(o.defaultStyles[w]=m)});case 1:case"end":return r.stop()}},n)}))}},{key:"handleDoubleClick",value:function(e){return __awaiter(this,arguments,void 0,function(n){var o=this,r=n.realPoint;return _regeneratorRuntime().mark(function u(){var s,w;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o.clickTimeId&&(clearTimeout(o.clickTimeId),o.clickTimeId=null),o.annotationStore.creating=!1,!r||((s=o.realStartPoint)===null||s===void 0?void 0:s.x)===r.x&&((w=o.realStartPoint)===null||w===void 0?void 0:w.y)===r.y||o.drawingAnnot.setPathPoint(o.drawingAnnot.realVertices.length-1,r.x,r.y),r&&(Math.abs(o.drawingAnnot.realVertices[0].x-r.x)<=5&&Math.abs(o.drawingAnnot.realVertices[0].y-r.y)<=5||Math.abs(o.drawingAnnot.realVertices[o.drawingAnnot.realVertices.length-2].x-r.x)<=2&&Math.abs(o.drawingAnnot.realVertices[o.drawingAnnot.realVertices.length-2].y-r.y)<=2)&&(o.drawingAnnot.realVertices.pop(),o.drawingAnnot.annotation.vertices.pop()),o.drawingAnnot.creating=!1,!(o.drawingAnnot.realVertices.length<3)){m.next=9;break}o.drawingAnnot.delete(),m.next=16;break;case 9:return o.drawingAnnot.renderAnnot(),o.drawingAnnot.update(),m.next=13,o.documentViewer.annotationManager.createAnnotation(o.drawingAnnot.annotation);case 13:m.sent,o.drawingAnnot.selectAnnotation(),o.documentViewer.getAnnotationManager().addAnnotation(o.drawingAnnot);case 16:o.reset(),o.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:o.documentViewer.annotations});case 18:case"end":return m.stop()}},u)})()})}}])}(),MeasurementTool=function(){return _createClass(function e(n){_classCallCheck(this,e),this.onHandleTool=this.handleTool.bind(this),this.onHandleToolMode=this.handleToolMode.bind(this),this.onClick=this.handleClick.bind(this),this.onDbclick=this.handleDbclick.bind(this),this.onMousedown=this.handleMousedown.bind(this),this.onKeydown=this.handleKeyDown.bind(this),this.documentViewer=n.documentViewer,this.tool=n.documentViewer.activeTool,this.eventBus=n.documentViewer.eventBus,this.annotationStore=n.annotationStore,this.eventBus._on("toolChanged",this.onHandleTool),this.eventBus._on("toolModeChanged",this.onHandleToolMode),this.eventBus._on("pdfClick",this.onClick),this.eventBus._on("pdfDbclick",this.onDbclick),this.eventBus._on("pdfMousedown",this.onMousedown),this.lineCreateTool=new LineCreateTool(n),this.polylineCreateTool=new PolylineCreateTool(n),this.curveCreateTool=new CurveCreateTool(n),this.arcCreateTool=new ArcCreateTool(n),this.circleCreateTool=new CircleCreateTool(n),this.rectangleCreateTool=new RectangleCreateTool(n),this.polygonCreateTool=new PolygonCreateTool(n),this.cloudyCreateTool=new CloudyCreateTool(n),this.calloutCreateTool=new CalloutCreateTool(n),this.createTools=[this.lineCreateTool,this.polylineCreateTool,this.curveCreateTool,this.arcCreateTool,this.circleCreateTool,this.rectangleCreateTool,this.polygonCreateTool,this.cloudyCreateTool,this.calloutCreateTool],this.toolMapping={line:"lineCreateTool",polyline:"polylineCreateTool",curve:"curveCreateTool",arc:"arcCreateTool",circle:"circleCreateTool",rectangle:"rectangleCreateTool",polygon:"polygonCreateTool",cloudy:"cloudyCreateTool",callout:"calloutCreateTool"},this.activeTool=null},[{key:"handleTool",value:function(e){var n,o=e.tool;e.color;var r=this.tool;this.tool=o,this.activeTool=null;var u=this.documentViewer.toolMode==="measurement"?1:0;this.toolMapping[r]&&this.tool!==r&&this[this.toolMapping[r]].reset(),(u||["polyline","arc","polygon","cloudy","callout"].includes(o))&&(o&&this.toolMapping[this.tool]?(this.activeTool=this[this.toolMapping[this.tool]],(n=this.activeTool)===null||n===void 0||(n.measure=u),document.querySelector(".document").classList.add("annotation-edit"),u&&this.updateMeasurePanel(),document.addEventListener("keydown",this.onKeydown)):(this.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),document.removeEventListener("keydown",this.onKeydown)))}},{key:"handleToolMode",value:function(e){var n,o=this.toolMode;this.toolMode=e,o==="measurement"&&e!==o&&(this.eventBus.dispatch("measurePropertyChange",{isOpen:!1}),(n=this[this.toolMapping[this.tool]])===null||n===void 0||n.reset())}},{key:"destroy",value:function(){this.createTools.forEach(function(e){e.reset(),e=null}),this.eventBus._off("toolChanged",this.onHandleTool),this.eventBus._off("toolModeChanged",this.onHandleToolMode),this.eventBus._off("pdfClick",this.onClick),this.eventBus._off("pdfDbclick",this.onDbclick),this.eventBus._off("pdfMousedown",this.onMousedown)}},{key:"setDefaults",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((e.scale||e.precision)&&(o={},e.scale&&(o.scale=e.scale,delete e.scale),e.precision&&(o.precision=e.precision,delete e.precision),this.createTools.forEach(function(u){u.setDefaults(o)})),Object.keys(e).length!==0||e.constructor!==Object){r.next=3;break}return r.abrupt("return");case 3:this.activeTool&&this.activeTool.setDefaults&&this.activeTool.setDefaults(e);case 4:case"end":return r.stop()}},n,this)}))}},{key:"handleClick",value:function(e){this.handleEvent(e,"handleClick")}},{key:"handleDbclick",value:function(e){this.handleEvent(e,"handleDoubleClick")}},{key:"handleMousedown",value:function(e){this.handleEvent(e,"handleMouseDown")}},{key:"handleEvent",value:function(e,n){var o=e.pageNumber,r=e.x,u=e.y,s=e.event;if(!this.annotationStore.selectedElementName){var w=o-1,m=this.documentViewer.pdfViewer._pages[w].compdfAnnotationLayer;if(m){var v=getAbsoluteCoordinate(m.pageDiv,s);this.activeTool&&this.activeTool[n]&&this.activeTool[n]({pageIndex:w,oriPoint:{x:r,y:u},realPoint:v,layer:m})}}}},{key:"updateMeasurePanel",value:function(){this.activeTool&&(this.eventBus.dispatch("measurePropertyChange",Object.assign(Object.assign({},this.activeTool.defaultStyles),{measure:1})),this.activeTool.updateMeasureData())}},{key:"handleKeyDown",value:function(e){(e.keyCode||e.which)===27&&(e.preventDefault(),this.activeTool&&this.activeTool.drawingAnnot&&(this.annotationStore.creating=!1,this.activeTool.drawingAnnot.delete(),this.activeTool.reset()))}}])}(),DEFAULT_CACHE_SIZE=3,ENABLE_PERMISSIONS_CLASS="enablePermissions",PagesCountLimit={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};function isValidAnnotationEditorMode(e){return Object.values(pdfExports.AnnotationEditorType).includes(e)&&e!==pdfExports.AnnotationEditorType.DISABLE}var _buf=new WeakMap,_size=new WeakMap,_PDFPageViewBuffer_brand=new WeakSet,PDFPageViewBuffer=function(){return _createClass(function e(n){_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_PDFPageViewBuffer_brand),_classPrivateFieldInitSpec(this,_buf,new Set),_classPrivateFieldInitSpec(this,_size,0),_classPrivateFieldSet2(_size,this,n)},[{key:"push",value:function(e){var n=_classPrivateFieldGet2(_buf,this);n.has(e)&&n.delete(e),n.add(e),n.size>_classPrivateFieldGet2(_size,this)&&_assertClassBrand(_PDFPageViewBuffer_brand,this,_destroyFirstView).call(this)}},{key:"resize",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_classPrivateFieldSet2(_size,this,e);var o=_classPrivateFieldGet2(_buf,this);if(n){var r,u=o.size,s=1,w=_createForOfIteratorHelper(o);try{for(w.s();!(r=w.n()).done;){var m=r.value;if(n.has(m.id)&&(o.delete(m),o.add(m)),++s>u)break}}catch(v){w.e(v)}finally{w.f()}}for(;o.size>_classPrivateFieldGet2(_size,this);)_assertClassBrand(_PDFPageViewBuffer_brand,this,_destroyFirstView).call(this)}},{key:"has",value:function(e){return _classPrivateFieldGet2(_buf,this).has(e)}},{key:Symbol.iterator,value:function(){return _classPrivateFieldGet2(_buf,this).keys()}}])}();function _destroyFirstView(){var e=_classPrivateFieldGet2(_buf,this).keys().next().value;e==null||e.destroy(),_classPrivateFieldGet2(_buf,this).delete(e)}var _buffer=new WeakMap,_enablePermissions=new WeakMap,_scrollModePageState=new WeakMap,_onVisibilityChange=new WeakMap,_scaleTimeoutId=new WeakMap,_renderedPagesView=new WeakMap,_rendering=new WeakMap,_cacheTask=new WeakMap,_PDFViewer_brand=new WeakSet,PDFViewer=function(){return _createClass(function r(u){var s,w,m,v,g;if(_classCallCheck(this,r),_classPrivateMethodInitSpec(this,_PDFViewer_brand),_classPrivateFieldInitSpec(this,_buffer,null),_classPrivateFieldInitSpec(this,_enablePermissions,!1),_classPrivateFieldInitSpec(this,_scrollModePageState,null),_classPrivateFieldInitSpec(this,_onVisibilityChange,null),_classPrivateFieldInitSpec(this,_scaleTimeoutId,null),_classPrivateFieldInitSpec(this,_renderedPagesView,[]),_classPrivateFieldInitSpec(this,_rendering,!1),_classPrivateFieldInitSpec(this,_cacheTask,[]),this.documentViewer=u.documentViewer,this.eventBus=u.eventBus,this._annotationEditorUIManager=null,this.container=u.container,this.viewer=u.viewer||u.container.firstElementChild,this.annotationStore=u.annotationStore,this.messageHandler=u.messageHandler,this.exitPresentationMode=!1,((s=this.container)===null||s===void 0?void 0:s.tagName)!=="DIV"||((w=this.viewer)===null||w===void 0?void 0:w.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");this.linkService=u.linkService,this.removePageBorders=!1,this.textLayerMode=(m=u.textLayerMode)!==null&&m!==void 0?m:TextLayerMode.ENABLE,this._annotationEditorMode=(v=u.annotationEditorMode)!==null&&v!==void 0?v:pdfExports.AnnotationEditorType.NONE,this.imageResourcesPath=u.imageResourcesPath||"",this.enablePrintAutoRotate=u.enablePrintAutoRotate||!1,this.renderer=u.renderer||RendererType.CANVAS,this.useOnlyCssZoom=u.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=(g=u.isOffscreenCanvasSupported)===null||g===void 0||g,this.maxCanvasPixels=maxCanvasPixels,_classPrivateFieldSet2(_enablePermissions,this,u.enablePermissions||!1),this.pageColors=u.pageColors||null,this.$t=u.$t,this.doc=u.doc,this.messageHandler=u.messageHandler,this._fontFile=null,this.contentEditHistoryManager=null,this.areaMeasurementCreateTool=null,this.measurementTool=null,!this.pageColors||CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground)||((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.renderingQueue=u.renderingQueue,this.scroll=watchScroll(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders")},[{key:"pagesCount",get:function(){return this._pages.length}},{key:"getPageView",value:function(r){return this._pages[r]}},{key:"pageViewsReady",get:function(){return!!this._pagesCapability.settled&&this._pages.every(function(r){return r==null?void 0:r.pdfPage})}},{key:"currentPageNumber",get:function(){return this._currentPageNumber},set:function(r){if(!Number.isInteger(r))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(r,!0)||console.error('currentPageNumber: "'.concat(r,'" is not a valid page.')))}},{key:"_setCurrentPageNumber",value:function(r){var u,s,w=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(this._currentPageNumber===r)return w&&this._resetCurrentPageView(),!0;if(!(0<r&&r<=this.pagesCount))return!1;var m=this._currentPageNumber;return this._currentPageNumber=r,this.eventBus.dispatch("onPageNumberUpdated",{source:this,pageNumber:r,pageLabel:(u=(s=this._pageLabels)===null||s===void 0?void 0:s[r-1])!==null&&u!==void 0?u:null,previous:m}),this.eventBus.dispatch("pageNumberUpdated",r),w&&this._resetCurrentPageView(),!0}},{key:"currentPageLabel",get:function(){var r,u;return(r=(u=this._pageLabels)===null||u===void 0?void 0:u[this._currentPageNumber-1])!==null&&r!==void 0?r:null},set:function(r){if(this.pdfDocument){var u=0|r;if(this._pageLabels){var s=this._pageLabels.indexOf(r);s>=0&&(u=s+1)}this._setCurrentPageNumber(u,!0)||console.error('currentPageLabel: "'.concat(r,'" is not a valid page.'))}}},{key:"currentScale",get:function(){return this._currentScale!==UNKNOWN_SCALE?this._currentScale:DEFAULT_SCALE},set:function(r){if(isNaN(r))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(r,{noScroll:!1})}},{key:"currentScaleValue",get:function(){return this._currentScaleValue},set:function(r){this.pdfDocument&&this._setScale(r,{noScroll:!1,drawingDelay:400,origin:{x:window.innerWidth/2,y:window.innerHeight/2}})}},{key:"pagesRotation",get:function(){return this._pagesRotation},set:function(r){if(!isValidRotation(r))throw new Error("Invalid pages rotation angle.");if(this.pdfDocument&&((r%=360)<0&&(r+=360),this._pagesRotation!==r)){this._pagesRotation=r;var u=this._currentPageNumber;this.refresh(!0,{rotation:r}),this._currentScaleValue&&this._setScale(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:r,pageNumber:u})}}},{key:"firstPagePromise",get:function(){return this.pdfDocument?this._firstPageCapability.promise:null}},{key:"onePageRendered",get:function(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}},{key:"pagesPromise",get:function(){return this.pdfDocument?this._pagesCapability.promise:null}},{key:"setDocument",value:function(r,u,s,w){var m=this;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this._annotationEditorUIManager&&(this._annotationEditorUIManager.destroy(),this._annotationEditorUIManager=null)),this.pdfDocument=r,r){var v=r.numPages,g=r.getPage(1),d=r.getOptionalContentConfig(),f=_classPrivateFieldGet2(_enablePermissions,this)?r.getPermissions():Promise.resolve();if(v>PagesCountLimit.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");var y=this._scrollMode=ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:y})}this._pagesCapability.promise.then(function(){m.eventBus.dispatch("pagesloaded",{source:m,pagesCount:v})},function(){}),this._onBeforeDraw=function(x){m._pages[x.pageNumber-1]},this._onAfterDraw=function(x){x.cssTransform||m._onePageRenderedCapability.settled||(m._onePageRenderedCapability.resolve({timestamp:x.timestamp}),m.eventBus._off("pagerendered",m._onAfterDraw),m._onAfterDraw=null,_classPrivateFieldGet2(_onVisibilityChange,m)&&(document.removeEventListener("visibilitychange",_classPrivateFieldGet2(_onVisibilityChange,m)),_classPrivateFieldSet2(_onVisibilityChange,m,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([g,f]).then(function(x){var k=_slicedToArray(x,2),P=k[0],S=k[1];if(r===m.pdfDocument){m._firstPageCapability.resolve(P),m._optionalContentConfigPromise=d;var E=_assertClassBrand(_PDFViewer_brand,m,_initializePermissions).call(m,S),M=E.annotationEditorMode,T=E.textLayerMode;if(M!==pdfExports.AnnotationEditorType.DISABLE){var D=M;r.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):isValidAnnotationEditorMode(D)?(m._annotationEditorUIManager=new pdfExports.AnnotationEditorUIManager(m.container,m.eventBus,r==null?void 0:r.annotationStorage),D!==pdfExports.AnnotationEditorType.NONE&&m._annotationEditorUIManager.updateMode(D)):console.error("Invalid AnnotationEditor mode: ".concat(D))}var N=_assertClassBrand(_PDFViewer_brand,m,_layerProperties).bind(m),I=m._scrollMode===ScrollMode.PAGE?null:m.viewer,O=m.currentScale,F=P.getViewport({scale:O*PixelsPerInch.PDF_TO_CSS_UNITS});F.rotation!==0&&(F.rotation=0),m.viewer.style.setProperty("--scale-factor",F.scale),m.contentEditHistoryManager=new ContentEditHistoryManager({messageHandler:m.messageHandler,eventBus:m.eventBus,pdfViewer:m}),m.areaMeasurementCreateTool=new AreaMeasurementCreateTool({documentViewer:m.documentViewer,annotationStore:m.annotationStore}),m.measurementTool=new MeasurementTool({documentViewer:m.documentViewer,annotationStore:m.annotationStore});for(var q=1;q<=v;++q){var Y=q-1,_e=new PDFPageView(_defineProperty$1(_defineProperty$1(_defineProperty$1({documentViewer:m.documentViewer,container:I,eventBus:m.eventBus,id:q,pageIndex:Y,scale:O,messageHandler:m.messageHandler,annotationStore:m.annotationStore,annotations:u&&u[Y]||null,annotationsAll:u,pagesPtr:s,defaultViewport:F.clone(),optionalContentConfigPromise:d,renderingQueue:m.renderingQueue,textLayerMode:T,imageResourcesPath:m.imageResourcesPath,renderer:typeof PDFJSDev>"u"||PDFJSDev.test("!PRODUCTION || GENERIC")?m.renderer:null,useOnlyCssZoom:m.useOnlyCssZoom,isOffscreenCanvasSupported:m.isOffscreenCanvasSupported,maxCanvasPixels:m.maxCanvasPixels,pageColors:m.pageColors,layerProperties:N,l10n:m.l10n,$t:m.$t,doc:m.doc},"messageHandler",m.messageHandler),"contentEditHistoryManager",m.contentEditHistoryManager),"enableReply",w));m._pages.push(_e)}var ne=m._pages[0];ne&&(ne.setPdfPage(P),m.linkService.cachePageRef(1,P.ref)),m._scrollMode===ScrollMode.PAGE?_assertClassBrand(_PDFViewer_brand,m,_ensurePageViewVisible).call(m):m._spreadMode!==SpreadMode.NONE&&m._updateSpreadMode(),_assertClassBrand(_PDFViewer_brand,m,_onePageRenderedOrForceFetch).call(m).then(_asyncToGenerator(_regeneratorRuntime().mark(function ve(){var J,fe,Z;return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(m._annotationEditorUIManager&&m.eventBus.dispatch("annotationeditormodechanged",{source:m,mode:m._annotationEditorMode}),!(r.loadingParams.disableAutoFetch||v>PagesCountLimit.FORCE_LAZY_PAGE_INIT)){j.next=4;break}return m._pagesCapability.resolve(),j.abrupt("return");case 4:if(!((J=v-1)<=0)){j.next=8;break}return m._pagesCapability.resolve(),j.abrupt("return");case 8:fe=_regeneratorRuntime().mark(function X(H){var U;return _regeneratorRuntime().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(U=r.getPage(H).then(function(Q){var re=m._pages[H-1];re.pdfPage||re.setPdfPage(Q),m.linkService.cachePageRef(H,Q.ref),--J==0&&m._pagesCapability.resolve()},function(Q){console.error("Unable to get page ".concat(H," to initialize viewer"),Q),--J==0&&m._pagesCapability.resolve()}),H%PagesCountLimit.PAUSE_EAGER_PAGE_INIT!=0){te.next=4;break}return te.next=4,U;case 4:case"end":return te.stop()}},X)}),Z=2;case 10:if(!(Z<=v)){j.next=15;break}return j.delegateYield(fe(Z),"t0",12);case 12:++Z,j.next=10;break;case 15:case"end":return j.stop()}},ve)}))),m.eventBus.dispatch("pagesinit",{source:m}),r.getMetadata().then(function(ve){var J=ve.info;r===m.pdfDocument&&J.Language&&(m.viewer.lang=J.Language)})}}).catch(function(x){console.error("Unable to initialize viewer",x),m._pagesCapability.reject(x)})}}},{key:"setPageLabels",value:function(r){if(this.pdfDocument){r?Array.isArray(r)&&this.pdfDocument.numPages===r.length?this._pageLabels=r:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(var u=0,s=this._pages.length;u<s;u++){var w,m;this._pages[u].setPageLabel((w=(m=this._pageLabels)===null||m===void 0?void 0:m[u])!==null&&w!==void 0?w:null)}}}},{key:"renderAnnotation",value:function(r,u){var s=this._pages[r.pageIndex];s&&s.compdfAnnotationLayer&&(s.textSelection&&s.textSelection.cleanSelection(),s.compdfAnnotationLayer.renderAnnotation(r,u))}},{key:"getAnnotation",value:function(r){var u=r.pageIndex,s=this._pages[u];return s&&s.compdfAnnotationLayer?s.compdfAnnotationLayer.getAnnotation(r):null}},{key:"deleteAnnotations",value:function(r){for(var u=Array.isArray(r)?r:[r],s=0;s<u.length;s++){var w=u[s],m=w.pageIndex,v=this._pages[m];v&&v.compdfAnnotationLayer&&v.compdfAnnotationLayer.deleteAnnotation(w)}}},{key:"_resetView",value:function(){this._pages=[],this._currentPageNumber=1,this._currentScale=UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,_classPrivateFieldSet2(_buffer,this,new PDFPageViewBuffer(DEFAULT_CACHE_SIZE)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=pdfExports.createPromiseCapability(),this._onePageRenderedCapability=pdfExports.createPromiseCapability(),this._pagesCapability=pdfExports.createPromiseCapability(),this._scrollMode=ScrollMode.VERTICAL,this._previousScrollMode=ScrollMode.UNKNOWN,this._spreadMode=SpreadMode.NONE,this.contentEditHistoryManager=null,_classPrivateFieldSet2(_scrollModePageState,this,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),_classPrivateFieldGet2(_onVisibilityChange,this)&&(document.removeEventListener("visibilitychange",_classPrivateFieldGet2(_onVisibilityChange,this)),_classPrivateFieldSet2(_onVisibilityChange,this,null)),this.areaMeasurementCreateTool&&(this.areaMeasurementCreateTool.destroy(),this.areaMeasurementCreateTool=null),this.measurementTool&&(this.measurementTool.destroy(),this.measurementTool=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(ENABLE_PERMISSIONS_CLASS)}},{key:"_scrollUpdate",value:function(){this.pagesCount!==0&&this.update()}},{key:"_scrollIntoView",value:function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){var s=r.div,w=r.id;if(this._currentPageNumber!==w&&this._setCurrentPageNumber(w),this._scrollMode===ScrollMode.PAGE&&(_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this),this.update()),!u&&!this.isInPresentationMode){var m=s.offsetLeft+s.clientLeft,v=m+s.clientWidth,g=this.container,d=g.scrollLeft,f=g.clientWidth;(this._scrollMode===ScrollMode.HORIZONTAL||m<d||v>d+f)&&(u={left:0,top:0})}scrollIntoView(s,u),!this._currentScaleValue&&this._location&&(this._location=null)}}},{key:"_setScaleUpdatePages",value:function(r,u,s){var w=this,m=s.noScroll,v=m!==void 0&&m,g=s.preset,d=g!==void 0&&g,f=s.drawingDelay,y=f===void 0?-1:f,x=s.origin,k=x===void 0?null:x;if(this._currentScaleValue=u.toString(),_assertClassBrand(_PDFViewer_brand,this,_isSameScale).call(this,r))d&&this.eventBus.dispatch("scalechanging",{source:this,scale:r,presetValue:u});else{var P=this._currentScale;if(k&&(k.x||k.y)){k.x=k.x||0,k.y=k.y||0;var S=r/P,E=this.documentViewer.getScrollViewElement(),M=this.documentViewer.getViewerElement();k.x=(k.x+this.container.scrollLeft-M.offsetLeft-E.offsetLeft)*S-k.x+E.offsetLeft,k.y=(k.y+this.container.scrollTop-M.offsetTop-E.offsetTop)*S-k.y+E.offsetTop}this.viewer.style.setProperty("--scale-factor",r*PixelsPerInch.PDF_TO_CSS_UNITS);var T=y>=0&&y<1e3;if(this.refresh(!0,{scale:r,drawingDelay:T?y:-1}),T&&_classPrivateFieldSet2(_scaleTimeoutId,this,setTimeout(function(){_classPrivateFieldSet2(_scaleTimeoutId,w,null),w.refresh(),w.exitPresentationMode=!1},y)),this._currentScale=r,!v){var D,N=this._currentPageNumber;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(N=this._location.pageNumber,D=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:N,destArray:D,allowNegativeOffset:!0}),k&&(k.x||k.y)&&(k.x=k.x||0,k.y=k.y||0,this.container.offsetTop,this.container.offsetLeft,this.container.scrollLeft=k.x,this.container.scrollTop=k.y)}this.eventBus.dispatch("scalechanging",{source:this,scale:r,presetValue:d?u:void 0})}}},{key:"_pageWidthScaleFactor",get:function(){return this._spreadMode!==SpreadMode.NONE&&this._scrollMode!==ScrollMode.HORIZONTAL?2:1}},{key:"_setScale",value:function(r,u){var s=parseFloat(r);if(s>0)u.preset=!1,this._setScaleUpdatePages(s,r,u);else{var w=this._pages[this._currentPageNumber-1];if(!w)return;var m=SCROLLBAR_PADDING,v=VERTICAL_PADDING;if(this.isInPresentationMode)m=v=4,this._spreadMode!==SpreadMode.NONE&&(m*=2);else if(this.removePageBorders)m=v=0;else if(this._scrollMode===ScrollMode.HORIZONTAL){var g=[v,m];m=g[0],v=g[1]}var d=(this.container.clientWidth-m)/w.width*w.scale/this._pageWidthScaleFactor,f=(this.container.clientHeight-v)/w.height*w.scale;switch(r){case"page-actual":s=1;break;case"page-width":s=d;break;case"page-height":s=f;break;case"page-fit":s=Math.min(d,f);break;case"auto":var y=isPortraitOrientation(w)?d:Math.min(f,d);s=Math.min(MAX_AUTO_SCALE,y);break;default:return void console.error('_setScale: "'.concat(r,'" is an unknown zoom value.'))}u.preset=!0,this._setScaleUpdatePages(s,r,u)}}},{key:"_resetCurrentPageView",value:function(){var r=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,{noScroll:!0}),this._scrollIntoView(r)}},{key:"pageLabelToPageNumber",value:function(r){if(!this._pageLabels)return null;var u=this._pageLabels.indexOf(r);return u<0?null:u+1}},{key:"scrollPageIntoView",value:function(r){var u=r.pageNumber,s=r.destArray,w=s===void 0?null:s,m=r.allowNegativeOffset,v=m!==void 0&&m,g=r.ignoreDestinationZoom,d=g!==void 0&&g;if(this.pdfDocument&&(!this._pages||this._pages.length)){var f=Number.isInteger(u)&&this._pages[u-1];if(f)if(!this.isInPresentationMode&&w){var y,x,k=0,P=0,S=0,E=0,M=f.rotation%180!=0,T=(M?f.height:f.width)/f.scale/PixelsPerInch.PDF_TO_CSS_UNITS,D=(M?f.width:f.height)/f.scale/PixelsPerInch.PDF_TO_CSS_UNITS,N=0;switch(w[1].name){case"XYZ":k=w[2],P=w[3],N=w[4],k=k!==null?k:0,P=P!==null?P:D;break;case"Fit":case"FitB":N="page-fit";break;case"FitH":case"FitBH":N="page-width",(P=w[2])===null&&this._location?(k=this._location.left,P=this._location.top):(typeof P!="number"||P<0)&&(P=D);break;case"FitV":case"FitBV":k=w[2],S=T,E=D,N="page-height";break;case"FitR":k=w[2],P=w[3],S=w[4]-k,E=w[5]-P;var I=this.removePageBorders?0:SCROLLBAR_PADDING,O=this.removePageBorders?0:VERTICAL_PADDING;y=(this.container.clientWidth-I)/S/PixelsPerInch.PDF_TO_CSS_UNITS,x=(this.container.clientHeight-O)/E/PixelsPerInch.PDF_TO_CSS_UNITS,N=Math.min(Math.abs(y),Math.abs(x));break;default:return void console.error('scrollPageIntoView: "'.concat(w[1].name,'" is not a valid destination type.'))}if(d||(N&&N!==this._currentScale?this.currentScaleValue=N:this._currentScale===UNKNOWN_SCALE&&(this.currentScaleValue=DEFAULT_SCALE_VALUE)),N!=="page-fit"||w[4]){var F=[f.viewport.convertToViewportPoint(k,P),f.viewport.convertToViewportPoint(k+S,P+E)],q=Math.min(F[0][0],F[1][0]),Y=Math.min(F[0][1],F[1][1]);v||(q=Math.max(q,0),Y=Math.max(Y,0)),this._scrollIntoView(f,{left:q,top:Y})}else this._scrollIntoView(f)}else this._setCurrentPageNumber(u,!0);else console.error('scrollPageIntoView: "'.concat(u,'" is not a valid pageNumber parameter.'))}}},{key:"_updateLocation",value:function(r){var u=this._currentScale,s=this._currentScaleValue,w=parseFloat(s)===u?Math.round(1e4*u)/100:s,m=r.id,v=this._pages[m-1],g=this.container,d=v.getPagePoint(g.scrollLeft-r.x,g.scrollTop-r.y),f=Math.round(d[0]),y=Math.round(d[1]),x="#page=".concat(m);this.isInPresentationMode||(x+="&zoom=".concat(w,",").concat(f,",").concat(y)),this._location={pageNumber:m,scale:w,top:y,left:f,rotation:this._pagesRotation,pdfOpenParams:x}}},{key:"cleanupPages",value:function(){var r=this._getVisiblePages(),u=r.views;if(u.length!==0){for(var s=0;s<_classPrivateFieldGet2(_renderedPagesView,this).length;s++){var w=_classPrivateFieldGet2(_renderedPagesView,this)[s];r.ids.has(w.id)||w.destroy()}var m,v=this._spreadMode===SpreadMode.NONE&&(this._scrollMode===ScrollMode.PAGE||this._scrollMode===ScrollMode.VERTICAL),g=this._currentPageNumber,d=!1,f=_createForOfIteratorHelper(u);try{for(f.s();!(m=f.n()).done;){var y=m.value;if(y.percent<100)break;if(y.id===g&&v){d=!0;break}}}catch(x){f.e(x)}finally{f.f()}this._setCurrentPageNumber(d?g:u[0].id),this._updateLocation(r.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}}},{key:"update",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function r(){var u,s;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(_classPrivateFieldGet2(_scaleTimeoutId,this)===null||this.isInPresentationMode||this.exitPresentationMode||(clearTimeout(_classPrivateFieldGet2(_scaleTimeoutId,this)),_classPrivateFieldSet2(_scaleTimeoutId,this,null)),u=this._getVisiblePages(),u.views.length!==0){w.next=5;break}return w.abrupt("return");case 5:return s=DEFAULT_CACHE_SIZE,_classPrivateFieldGet2(_buffer,this).resize(s,u.ids),w.next=9,this.forceRendering(u);case 9:this.cleanupPages();case 10:case"end":return w.stop()}},r,this)})),function(){return o.apply(this,arguments)})},{key:"containsElement",value:function(r){return this.container.contains(r)}},{key:"focus",value:function(){this.container.focus()}},{key:"_isContainerRtl",get:function(){return getComputedStyle(this.container).direction==="rtl"}},{key:"isInPresentationMode",get:function(){return this.presentationModeState===PresentationModeState.FULLSCREEN}},{key:"isChangingPresentationMode",get:function(){return this.presentationModeState===PresentationModeState.CHANGING}},{key:"isHorizontalScrollbarEnabled",get:function(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}},{key:"isVerticalScrollbarEnabled",get:function(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}},{key:"_getVisiblePages",value:function(){var r=this._scrollMode===ScrollMode.PAGE?_classPrivateFieldGet2(_scrollModePageState,this).pages:this._pages,u=this._scrollMode===ScrollMode.HORIZONTAL,s=u&&this._isContainerRtl;return getVisibleElements({scrollEl:this.container,views:r,sortByVisibility:!0,horizontal:u,rtl:s})}},{key:"isPageVisible",value:function(r){return!!this.pdfDocument&&(Number.isInteger(r)&&r>0&&r<=this.pagesCount?this._getVisiblePages().ids.has(r):(console.error('isPageVisible: "'.concat(r,'" is not a valid page.')),!1))}},{key:"isPageCached",value:function(r){if(!this.pdfDocument)return!1;if(!(Number.isInteger(r)&&r>0&&r<=this.pagesCount))return console.error('isPageCached: "'.concat(r,'" is not a valid page.')),!1;var u=this._pages[r-1];return _classPrivateFieldGet2(_buffer,this).has(u)}},{key:"cleanup",value:function(){var r,u=_createForOfIteratorHelper(this._pages);try{for(u.s();!(r=u.n()).done;){var s=r.value;s.renderingState!==RenderingStates$1.FINISHED&&s.reset()}}catch(w){u.e(w)}finally{u.f()}}},{key:"_cancelRendering",value:function(){var r,u=_createForOfIteratorHelper(this._pages);try{for(u.s();!(r=u.n()).done;){var s,w=r.value;(s=w.contentContainer)===null||s===void 0||s.destroy(),w.contentContainer=null,w.cancelRendering()}}catch(m){u.e(m)}finally{u.f()}}},{key:"forceRendering",value:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function u(s){var w,m,v,g,d,f=this;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(w=s||this._getVisiblePages(),!_classPrivateFieldGet2(_rendering,this)){y.next=4;break}return _classPrivateFieldGet2(_cacheTask,this).push({visiblePages:w}),y.abrupt("return");case 4:_classPrivateFieldSet2(_rendering,this,!0),m=[],v=_regeneratorRuntime().mark(function x(){var k;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!((k=w.views[g].view).renderingState===RenderingStates$1.FINISHED&&f.documentViewer.scale>f.documentViewer.maxViewportZoom)){P.next=5;break}k.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}),P.next=10;break;case 5:if(k.renderingState!==RenderingStates$1.FINISHED||!k.canvas){P.next=9;break}return P.abrupt("return",1);case 9:k.renderingState===RenderingStates$1.FINISHED&&k.reset();case 10:return P.next=12,_assertClassBrand(_PDFViewer_brand,f,_ensurePdfPageLoaded$1).call(f,k).then(function(){m.push(k.draw()),_classPrivateFieldGet2(_renderedPagesView,f).push(k)});case 12:case"end":return P.stop()}},x)}),g=0;case 8:if(!(g<w.views.length)){y.next=15;break}return y.delegateYield(v(),"t0",10);case 10:if(!y.t0){y.next=12;break}return y.abrupt("continue",12);case 12:g++,y.next=8;break;case 15:return y.next=17,Promise.all(m);case 17:if(_classPrivateFieldSet2(_rendering,this,!1),!_classPrivateFieldGet2(_cacheTask,this).length){y.next=24;break}return d=_classPrivateFieldGet2(_cacheTask,this).pop(),_classPrivateFieldSet2(_cacheTask,this,[]),y.next=23,this.forceRendering(d.visiblePages);case 23:return y.abrupt("return",!0);case 24:return y.abrupt("return",!1);case 25:case"end":return y.stop()}},u,this)}));return function(u){return r.apply(this,arguments)}}()},{key:"hasEqualPageSizes",get:function(){for(var r=this._pages[0],u=1,s=this._pages.length;u<s;++u){var w=this._pages[u];if(w.width!==r.width||w.height!==r.height)return!1}return!0}},{key:"getPagesOverview",value:function(){var r=this;return this._pages.map(function(u){var s=u.pdfPage.getViewport({scale:1});return!r.enablePrintAutoRotate||isPortraitOrientation(s)?{width:s.width,height:s.height,rotation:s.rotation}:{width:s.height,height:s.width,rotation:(s.rotation-90)%360}})}},{key:"optionalContentConfigPromise",get:function(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)},set:function(r){if(!(r instanceof Promise))throw new Error("Invalid optionalContentConfigPromise: ".concat(r));this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=r,this.refresh(!1,{optionalContentConfigPromise:r}))}},{key:"scrollMode",get:function(){return this._scrollMode},set:function(r){if(this._scrollMode!==r){if(!isValidScrollMode(r))throw new Error("Invalid scroll mode: ".concat(r));this.pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=r,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:r}),this._updateScrollMode(this._currentPageNumber))}}},{key:"_updateScrollMode",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,u=this._scrollMode,s=this.viewer;s.classList.toggle("scrollHorizontal",u===ScrollMode.HORIZONTAL),s.classList.toggle("scrollWrapped",u===ScrollMode.WRAPPED),this.pdfDocument&&r&&(u===ScrollMode.PAGE?_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this):this._previousScrollMode===ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(r,!0),this.update())}},{key:"spreadMode",get:function(){return this._spreadMode},set:function(r){if(this._spreadMode!==r){if(!isValidSpreadMode(r))throw new Error("Invalid spread mode: ".concat(r));this._spreadMode=r,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:r}),this._updateSpreadMode(this._currentPageNumber)}}},{key:"_updateSpreadMode",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(this.pdfDocument){var u=this.viewer,s=this._pages;if(this._scrollMode===ScrollMode.PAGE)_assertClassBrand(_PDFViewer_brand,this,_ensurePageViewVisible).call(this);else if(u.textContent="",this._spreadMode===SpreadMode.NONE){var w,m=_createForOfIteratorHelper(this._pages);try{for(m.s();!(w=m.n()).done;){var v=w.value;u.append(v.div)}}catch(x){m.e(x)}finally{m.f()}}else for(var g=this._spreadMode-1,d=null,f=0,y=s.length;f<y;++f)d===null?((d=document.createElement("div")).className="spread",u.append(d)):f%2===g&&(d=d.cloneNode(!1),u.append(d)),d.append(s[f].div);r&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(r,!0),this.update())}}},{key:"_getPageAdvance",value:function(r){var u=arguments.length>1&&arguments[1]!==void 0&&arguments[1];switch(this._scrollMode){case ScrollMode.WRAPPED:var s,w=this._getVisiblePages().views,m=new Map,v=_createForOfIteratorHelper(w);try{for(v.s();!(s=v.n()).done;){var g=s.value,d=g.id,f=g.y,y=g.percent,x=g.widthPercent;if(!(y===0||x<100)){var k=m.get(f);k||m.set(f,k||(k=[])),k.push(d)}}}catch(te){v.e(te)}finally{v.f()}var P,S=_createForOfIteratorHelper(m.values());try{for(S.s();!(P=S.n()).done;){var E=P.value,M=E.indexOf(r);if(M!==-1){var T=E.length;if(T===1)break;if(u)for(var D=M-1;D>=0;D--){var N=E[D],I=E[D+1]-1;if(N<I)return r-I}else for(var O=M+1,F=T;O<F;O++){var q=E[O],Y=E[O-1]+1;if(q>Y)return Y-r}if(u){var _e=E[0];if(_e<r)return r-_e+1}else{var ne=E[T-1];if(ne>r)return ne-r+1}break}}}catch(te){S.e(te)}finally{S.f()}break;case ScrollMode.HORIZONTAL:break;case ScrollMode.PAGE:case ScrollMode.VERTICAL:if(this._spreadMode===SpreadMode.NONE)break;var ve=this._spreadMode-1;if(u&&r%2!==ve||!u&&r%2===ve)break;var J,fe=u?r-1:r+1,Z=_createForOfIteratorHelper(this._getVisiblePages().views);try{for(Z.s();!(J=Z.n()).done;){var j=J.value,X=j.id,H=j.percent,U=j.widthPercent;if(X===fe){if(H>0&&U===100)return 2;break}}}catch(te){Z.e(te)}finally{Z.f()}}return 1}},{key:"nextPage",value:function(){var r=this._currentPageNumber,u=this.pagesCount;if(r>=u)return!1;var s=this._getPageAdvance(r,!1)||1;return this.currentPageNumber=Math.min(r+s,u),!0}},{key:"previousPage",value:function(){var r=this._currentPageNumber;if(r<=1)return!1;var u=this._getPageAdvance(r,!0)||1;return this.currentPageNumber=Math.max(r-u,1),!0}},{key:"increaseScale",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(typeof r=="number"&&(console.error("The `increaseScale` method-signature was updated, please use an object instead."),r={steps:r}),this.pdfDocument){r||(r=Object.create(null));var u=this._currentScale;if(r.scaleFactor>1)u=Math.min(MAX_SCALE,Math.round(u*r.scaleFactor*100)/100);else{var s,w=(s=r.steps)!==null&&s!==void 0?s:1;do u=(u*DEFAULT_SCALE_DELTA).toFixed(2),u=Math.ceil(10*u)/10,u=Math.min(MAX_SCALE,u);while(--w>0&&u<MAX_SCALE)}r.noScroll=!0,this._setScale(u,r),_classPrivateFieldSet2(_rendering,this,!1)}}},{key:"decreaseScale",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(typeof r=="number"&&(console.error("The `decreaseScale` method-signature was updated, please use an object instead."),r={steps:r}),this.pdfDocument){r||(r=Object.create(null));var u=this._currentScale;if(r.scaleFactor>0&&r.scaleFactor<1)u=Math.max(MIN_SCALE,Math.round(u*r.scaleFactor*100)/100);else{var s,w=(s=r.steps)!==null&&s!==void 0?s:1;do u=(u/DEFAULT_SCALE_DELTA).toFixed(2),u=Math.floor(10*u)/10,u=Math.max(MIN_SCALE,u);while(--w>0&&u>MIN_SCALE)}r.noScroll=!0,this._setScale(u,r),_classPrivateFieldSet2(_rendering,this,!1)}}},{key:"updateScale",value:function(r){var u=r.drawingDelay,s=r.scaleFactor,w=s===void 0?null:s,m=r.steps,v=m===void 0?null:m,g=r.origin;if(v===null&&w===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(this.pdfDocument){var d=this._currentScale;if(w>0&&w!==1)d=Math.round(d*w*100)/100;else if(v){var f=v>0?DEFAULT_SCALE_DELTA:1/DEFAULT_SCALE_DELTA,y=v>0?Math.ceil:Math.floor;v=Math.abs(v);do d=y(10*(d*f).toFixed(2))/10;while(--v>0)}d=Math.max(MIN_SCALE,Math.min(MAX_SCALE,d)),this._setScale(d,{noScroll:!1,drawingDelay:u,origin:g})}}},{key:"resize",value:function(r){this._setScale(r,{noScroll:!1,drawingDelay:400}),_classPrivateFieldSet2(_rendering,this,!1)}},{key:"annotationEditorMode",get:function(){return this._annotationEditorUIManager?this._annotationEditorMode:pdfExports.AnnotationEditorType.DISABLE},set:function(r){if(!this._annotationEditorUIManager)throw new Error("The AnnotationEditor is not enabled.");if(this._annotationEditorMode!==r){if(!isValidAnnotationEditorMode(r))throw new Error("Invalid AnnotationEditor mode: ".concat(r));this.pdfDocument&&(this._annotationEditorMode=r,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:r}),this._annotationEditorUIManager.updateMode(r))}}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object.create(null);if(this.pdfDocument){var s,w=_createForOfIteratorHelper(this._pages);try{for(w.s();!(s=w.n()).done;)s.value.update(u)}catch(m){w.e(m)}finally{w.f()}_classPrivateFieldGet2(_scaleTimeoutId,this)===null||this.isInPresentationMode||this.exitPresentationMode||(clearTimeout(_classPrivateFieldGet2(_scaleTimeoutId,this)),_classPrivateFieldSet2(_scaleTimeoutId,this,null)),r||this.update()}}},{key:"setFontFile",value:function(r){var u,s=_createForOfIteratorHelper(this._pages);try{for(s.s();!(u=s.n()).done;)u.value.fontFile=r}catch(w){s.e(w)}finally{s.f()}}},{key:"refreshCanvas",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function r(){var u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if((u=this._getVisiblePages()).views.length!==0){s.next=3;break}return s.abrupt("return");case 3:return s.next=5,this.renderCanvas(u);case 5:case"end":return s.stop()}},r,this)})),function(){return n.apply(this,arguments)})},{key:"renderCanvas",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){var s,w,m,v,g;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(s=u||this._getVisiblePages(),!_classPrivateFieldGet2(_rendering,this)){d.next=4;break}return _classPrivateFieldGet2(_cacheTask,this).push({visiblePages:s}),d.abrupt("return");case 4:for(_classPrivateFieldSet2(_rendering,this,!0),w=[],m=0;m<s.views.length;m++)v=s.views[m].view,w.push(v.redrawCanvas());return d.next=9,Promise.all(w);case 9:if(_classPrivateFieldSet2(_rendering,this,!1),!_classPrivateFieldGet2(_cacheTask,this).length){d.next=16;break}return g=_classPrivateFieldGet2(_cacheTask,this).pop(),_classPrivateFieldSet2(_cacheTask,this,[]),d.next=15,this.renderCanvas(g.visiblePages);case 15:return d.abrupt("return",!0);case 16:return d.abrupt("return",!1);case 17:case"end":return d.stop()}},r,this)})),function(r){return e.apply(this,arguments)})}]);var e,n,o}();function _layerProperties(){var e=this;return{get annotationEditorUIManager(){return e._annotationEditorUIManager},get annotationStorage(){var n;return(n=e.pdfDocument)===null||n===void 0?void 0:n.annotationStorage},get fieldObjectsPromise(){var n;return(n=e.pdfDocument)===null||n===void 0?void 0:n.getFieldObjects()},get hasJSActionsPromise(){var n;return(n=e.pdfDocument)===null||n===void 0?void 0:n.hasJSActions()},get linkService(){return e.linkService}}}function _initializePermissions(e){var n={annotationEditorMode:this._annotationEditorMode,textLayerMode:this.textLayerMode};return e&&(e.includes(pdfExports.PermissionFlag.COPY)||this.viewer.classList.add(ENABLE_PERMISSIONS_CLASS),e.includes(pdfExports.PermissionFlag.MODIFY_CONTENTS)||(n.annotationEditorMode=pdfExports.AnnotationEditorType.DISABLE),e.includes(pdfExports.PermissionFlag.MODIFY_ANNOTATIONS)||e.includes(pdfExports.PermissionFlag.FILL_INTERACTIVE_FORMS)||(n.annotationMode=pdfExports.AnnotationMode.ENABLE)),n}function _onePageRenderedOrForceFetch(){var e=this;if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();var n=new Promise(function(o){_classPrivateFieldSet2(_onVisibilityChange,e,function(){document.visibilityState==="hidden"&&(o(),document.removeEventListener("visibilitychange",_classPrivateFieldGet2(_onVisibilityChange,e)),_classPrivateFieldSet2(_onVisibilityChange,e,null))}),document.addEventListener("visibilitychange",_classPrivateFieldGet2(_onVisibilityChange,e))});return Promise.race([this._onePageRenderedCapability.promise,n])}function _ensurePageViewVisible(){if(this._scrollMode!==ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");var e=this._currentPageNumber,n=_classPrivateFieldGet2(_scrollModePageState,this),o=this.viewer;if(o.textContent="",n.pages.length=0,this._spreadMode!==SpreadMode.NONE||this.isInPresentationMode){var r=new Set,u=this._spreadMode-1;u===-1?r.add(e-1):e%2!==u?(r.add(e-1),r.add(e)):(r.add(e-2),r.add(e-1));var s=document.createElement("div");s.className="spread",this.isInPresentationMode;var w,m=_createForOfIteratorHelper(r);try{for(m.s();!(w=m.n()).done;){var v=w.value,g=this._pages[v];g&&(s.append(g.div),n.pages.push(g))}}catch(f){m.e(f)}finally{m.f()}o.append(s)}else{var d=this._pages[e-1];o.append(d.div),n.pages.push(d)}n.scrollDown=e>=n.previousPageNumber,n.previousPageNumber=e}function _isSameScale(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}function _ensurePdfPageLoaded$1(e){return _ensurePdfPageLoaded2$1.apply(this,arguments)}function _ensurePdfPageLoaded2$1(){return(_ensurePdfPageLoaded2$1=_asyncToGenerator(_regeneratorRuntime().mark(function e(n){var o,r,u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!n.pdfPage){s.next=2;break}return s.abrupt("return",n.pdfPage);case 2:return s.prev=2,s.next=5,this.pdfDocument.getPage(n.id);case 5:return u=s.sent,n.pdfPage||n.setPdfPage(u),(o=(r=this.linkService)._cachedPageNumber)!==null&&o!==void 0&&o.call(r,u.ref)||this.linkService.cachePageRef(n.id,u.ref),s.abrupt("return",u);case 11:return s.prev=11,s.t0=s.catch(2),console.error("Unable to get page for page view",s.t0),s.abrupt("return",null);case 15:case"end":return s.stop()}},e,this,[[2,11]])}))).apply(this,arguments)}var DRAW_UPSCALE_FACTOR=2,MAX_NUM_SCALING_STEPS=3,THUMBNAIL_CANVAS_BORDER_WIDTH=0,THUMBNAIL_WIDTH=120,TempImageFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getCanvas",value:function(n,o){var r=_assertClassBrand(e,this,_tempCanvas)._||(_tempCanvas._=_assertClassBrand(e,this,document.createElement("canvas")));r.width=n,r.height=o;var u=r.getContext("2d",{alpha:!1});return u.save(),u.fillStyle="rgb(255, 255, 255)",u.fillRect(0,0,n,o),u.restore(),[r,r.getContext("2d")]}},{key:"destroyCanvas",value:function(){var n=_assertClassBrand(e,this,_tempCanvas)._;n&&(n.width=0,n.height=0),_tempCanvas._=_assertClassBrand(e,this,null)}}])}(),_tempCanvas={_:null},PDFThumbnailView=function(){return _createClass(function e(n){var o=n.container,r=n.id,u=n.defaultViewport,s=n.linkService,w=n.renderingQueue,m=n.pageColors;_classCallCheck(this,e),this.id=r,this.renderingId="thumbnail"+r,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=u,this.pdfPageRotate=u.rotation,this.pageColors=m||null,this.linkService=s,this.renderingQueue=w,this.renderTask=null,this.renderingState=RenderingStates$1.INITIAL,this.resume=null;var v=this.viewport.width,g=v/this.viewport.height;this.canvasWidth=THUMBNAIL_WIDTH,this.canvasHeight=this.canvasWidth/g|0,this.scale=this.canvasWidth/v;var d=document.createElement("div");d.onclick=function(){return s.goToPage(r),isMobile$1&&window.instance.UI.closeElement("leftPanel"),!1},this.anchor=d;var f=document.createElement("div");f.className="thumbnail",f.setAttribute("data-page-number",this.id),this.div=f;var y=document.createElement("div");y.className="thumbnailSelectionRing";var x=2*THUMBNAIL_CANVAS_BORDER_WIDTH;y.style.width=this.canvasWidth+x+"px",y.style.height=this.canvasHeight+x+"px",this.ring=y,f.append(y);var k=document.createElement("div");k.className="box-thumbnail",k.textContent=this.id,f.append(k),d.append(f),o.append(d)},[{key:"setPdfPage",value:function(e){this.pdfPage=e,this.pdfPageRotate=e.rotate;var n=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:1,rotation:n}),this.reset()}},{key:"reset",value:function(){this.cancelRendering(),this.renderingState=RenderingStates$1.INITIAL;var e=this.viewport.width,n=e/this.viewport.height;this.canvasHeight=this.canvasWidth/n|0,this.scale=this.canvasWidth/e,this.div.removeAttribute("data-loaded");var o=this.ring;o.textContent="";var r=2*THUMBNAIL_CANVAS_BORDER_WIDTH;o.style.width=this.canvasWidth+r+"px",o.style.height=this.canvasHeight+r+"px",this.canvas&&(this.canvas.width=0,this.canvas.height=0,delete this.canvas),this.image&&(this.image.removeAttribute("src"),delete this.image)}},{key:"update",value:function(e){var n=e.rotation,o=n===void 0?null:n;typeof o=="number"&&(this.rotation=o);var r=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:r}),this.reset()}},{key:"cancelRendering",value:function(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}},{key:"_getPageDrawContext",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,n=document.createElement("canvas"),o=n.getContext("2d",{alpha:!1}),r=new OutputScale;return n.width=e*this.canvasWidth*r.sx|0,n.height=e*this.canvasHeight*r.sy|0,{ctx:o,canvas:n,transform:r.scaled?[r.sx,0,0,r.sy,0,0]:null}}},{key:"_convertCanvasToImage",value:function(e){if(this.renderingState!==RenderingStates$1.FINISHED)throw new Error("_convertCanvasToImage: Rendering has not finished.");var n=this._reduceImage(e),o=document.createElement("img");o.className="thumbnailImage",this._thumbPageCanvas.then(function(r){o.setAttribute("aria-label",r)}),o.style.width=this.canvasWidth+"px",o.style.height=this.canvasHeight+"px",o.src=n.toDataURL(),this.image=o,this.div.setAttribute("data-loaded",!0),this.ring.append(o),n.width=0,n.height=0}},{key:"draw",value:function(){var e=this;if(this.renderingState!==RenderingStates$1.INITIAL)return console.error("Must be in new state before drawing"),Promise.resolve();var n=this.pdfPage;if(!n)return this.renderingState=RenderingStates$1.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=RenderingStates$1.RUNNING;var o=function(){var g=_asyncToGenerator(_regeneratorRuntime().mark(function d(){var f,y=arguments;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(f=y.length>0&&y[0]!==void 0?y[0]:null,m===e.renderTask&&(e.renderTask=null),!(f instanceof pdfExports.RenderingCancelledException)){x.next=4;break}return x.abrupt("return");case 4:if(e.renderingState=RenderingStates$1.FINISHED,e._convertCanvasToImage(s),!f){x.next=8;break}throw f;case 8:case"end":return x.stop()}},d)}));return function(){return g.apply(this,arguments)}}(),r=this._getPageDrawContext(DRAW_UPSCALE_FACTOR),u=r.ctx,s=r.canvas,w={canvasContext:u,transform:r.transform,viewport:this.viewport.clone({scale:DRAW_UPSCALE_FACTOR*this.scale}),pageColors:this.pageColors},m=this.renderTask=n.render(w);m.onContinue=function(g){if(!e.renderingQueue.isHighestPriority(e))return e.renderingState=RenderingStates$1.PAUSED,void(e.resume=function(){e.renderingState=RenderingStates$1.RUNNING,g()});g()};var v=m.promise.then(function(){return o(null)},function(g){return o(g)});return v.finally(function(){var g;s.width=0,s.height=0,e.linkService.isPageCached(e.id)||(g=e.pdfPage)===null||g===void 0||g.cleanup()}),v}},{key:"setImage",value:function(e){if(this.renderingState===RenderingStates$1.INITIAL){var n=e.thumbnailCanvas,o=e.pdfPage,r=e.scale;n&&(this.pdfPage||this.setPdfPage(o),r<this.scale||(this.renderingState=RenderingStates$1.FINISHED,this._convertCanvasToImage(n)))}}},{key:"_reduceImage",value:function(e){var n=this._getPageDrawContext(),o=n.ctx,r=n.canvas;if(e.width<=2*r.width)return o.drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height),r;for(var u=r.width<<MAX_NUM_SCALING_STEPS,s=r.height<<MAX_NUM_SCALING_STEPS,w=_slicedToArray(TempImageFactory.getCanvas(u,s),2),m=w[0],v=w[1];u>e.width||s>e.height;)u>>=1,s>>=1;for(v.drawImage(e,0,0,e.width,e.height,0,0,u,s);u>2*r.width;)v.drawImage(m,0,0,u,s,0,0,u>>1,s>>1),u>>=1,s>>=1;return o.drawImage(m,0,0,u,s,0,0,r.width,r.height),r}},{key:"_thumbPageTitle",get:function(){var e;return Promise.resolve("Page ".concat((e=this.pageLabel)!==null&&e!==void 0?e:this.id))}},{key:"_thumbPageCanvas",get:function(){var e;return Promise.resolve("Thumbnail of Page ".concat((e=this.pageLabel)!==null&&e!==void 0?e:this.id))}},{key:"setPageLabel",value:function(e){var n=this;this.pageLabel=typeof e=="string"?e:null,this._thumbPageTitle.then(function(o){n.anchor.title=o}),this.renderingState===RenderingStates$1.FINISHED&&this._thumbPageCanvas.then(function(o){var r;(r=n.image)===null||r===void 0||r.setAttribute("aria-label",o)})}}])}(),THUMBNAIL_SCROLL_MARGIN=-19,THUMBNAIL_SELECTED_CLASS="selected",_PDFThumbnailViewer_brand=new WeakSet,PDFThumbnailViewer=function(){return _createClass(function e(n){var o=n.container,r=n.renderingQueue,u=n.linkService;_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_PDFThumbnailViewer_brand),this.container=o,this.linkService=u,this.renderingQueue=r,this.pageColors=null,typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")||!this.pageColors||CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground)||((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFThumbnailViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.scroll=watchScroll(this.container,this._scrollUpdated.bind(this)),this._resetView()},[{key:"_scrollUpdated",value:function(){this.renderingQueue.renderHighestPriority()}},{key:"getThumbnail",value:function(e){return this._thumbnails[e]}},{key:"_getVisibleThumbs",value:function(){return getVisibleElements({scrollEl:this.container,views:this._thumbnails})}},{key:"scrollThumbnailIntoView",value:function(e){if(this.pdfDocument){var n=this._thumbnails[e-1];if(n){e!==this._currentPageNumber&&(this._thumbnails[this._currentPageNumber-1].div.classList.remove(THUMBNAIL_SELECTED_CLASS),n.div.classList.add(THUMBNAIL_SELECTED_CLASS));var o=this._getVisibleThumbs(),r=o.first,u=o.last,s=o.views;if(s.length>0){var w=!1;if(e<=r.id||e>=u.id)w=!0;else{var m,v=_createForOfIteratorHelper(s);try{for(v.s();!(m=v.n()).done;){var g=m.value,d=g.id,f=g.percent;if(d===e){w=f<100;break}}}catch(y){v.e(y)}finally{v.f()}}w&&scrollIntoView(n.div,{top:THUMBNAIL_SCROLL_MARGIN})}this._currentPageNumber=e}else console.warn('scrollThumbnailIntoView: Invalid "pageNumber" parameter.')}}},{key:"pagesRotation",get:function(){return this._pagesRotation},set:function(e){if(!isValidRotation(e))throw new Error("Invalid thumbnails rotation angle.");if(this.pdfDocument&&this._pagesRotation!==e){this._pagesRotation=e;var n,o={rotation:e},r=_createForOfIteratorHelper(this._thumbnails);try{for(r.s();!(n=r.n()).done;)n.value.update(o)}catch(u){r.e(u)}finally{r.f()}}}},{key:"cleanup",value:function(){var e,n=_createForOfIteratorHelper(this._thumbnails);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.renderingState!==RenderingStates$1.FINISHED&&o.reset()}}catch(r){n.e(r)}finally{n.f()}TempImageFactory.destroyCanvas()}},{key:"_resetView",value:function(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this.container.textContent=""}},{key:"setDocument",value:function(e){var n=this;this.pdfDocument&&(this._cancelRendering(),this._resetView()),this.pdfDocument=e,e&&e.getPage(1).then(function(o){for(var r,u=e.numPages,s=o.getViewport({scale:1}),w=1;w<=u;++w){var m=new PDFThumbnailView({container:n.container,id:w,defaultViewport:s.clone(),linkService:n.linkService,renderingQueue:n.renderingQueue,pageColors:n.pageColors});n._thumbnails.push(m)}(r=n._thumbnails[0])===null||r===void 0||r.setPdfPage(o),n._thumbnails[n._currentPageNumber-1].div.classList.add(THUMBNAIL_SELECTED_CLASS)}).catch(function(o){console.error("Unable to initialize thumbnail viewer",o)})}},{key:"_cancelRendering",value:function(){var e,n=_createForOfIteratorHelper(this._thumbnails);try{for(n.s();!(e=n.n()).done;)e.value.cancelRendering()}catch(o){n.e(o)}finally{n.f()}}},{key:"setPageLabels",value:function(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(var n=0,o=this._thumbnails.length;n<o;n++){var r,u;this._thumbnails[n].setPageLabel((r=(u=this._pageLabels)===null||u===void 0?void 0:u[n])!==null&&r!==void 0?r:null)}}}},{key:"forceRendering",value:function(){var e=this,n=this._getVisibleThumbs(),o=_assertClassBrand(_PDFThumbnailViewer_brand,this,_getScrollAhead).call(this,n),r=this.renderingQueue.getHighestPriority(n,this._thumbnails,o);return!!r&&(_assertClassBrand(_PDFThumbnailViewer_brand,this,_ensurePdfPageLoaded).call(this,r).then(function(){e.renderingQueue.renderView(r)}),!0)}}])}();function _ensurePdfPageLoaded(e){return _ensurePdfPageLoaded2.apply(this,arguments)}function _ensurePdfPageLoaded2(){return(_ensurePdfPageLoaded2=_asyncToGenerator(_regeneratorRuntime().mark(function e(n){var o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.pdfPage){r.next=2;break}return r.abrupt("return",n.pdfPage);case 2:return r.prev=2,r.next=5,this.pdfDocument.getPage(n.id);case 5:return o=r.sent,n.pdfPage||n.setPdfPage(o),r.abrupt("return",o);case 10:return r.prev=10,r.t0=r.catch(2),console.error("Unable to get page for thumb view",r.t0),r.abrupt("return",null);case 14:case"end":return r.stop()}},e,this,[[2,10]])}))).apply(this,arguments)}function _getScrollAhead(e){var n,o;return((n=e.first)===null||n===void 0?void 0:n.id)===1||((o=e.last)===null||o===void 0?void 0:o.id)!==this._thumbnails.length&&this.scroll.down}var CLEANUP_TIMEOUT=3e4,PDFRenderingQueue=function(){return _createClass(function n(){_classCallCheck(this,n),this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1},[{key:"setViewer",value:function(n){this.pdfViewer=n}},{key:"setThumbnailViewer",value:function(n){this.pdfThumbnailViewer=n}},{key:"isHighestPriority",value:function(n){return this.highestPriorityPage===n.renderingId}},{key:"hasViewer",value:function(){return!!this.pdfViewer}},{key:"renderHighestPriority",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(o){var r;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),u.next=3,this.pdfViewer.forceRendering(o);case 3:if(!u.sent){u.next=5;break}return u.abrupt("return");case 5:if(!this.isThumbnailViewEnabled||(r=this.pdfThumbnailViewer)===null||r===void 0||!r.forceRendering()){u.next=7;break}return u.abrupt("return");case 7:if(!this.printing){u.next=9;break}return u.abrupt("return");case 9:this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),CLEANUP_TIMEOUT));case 10:case"end":return u.stop()}},n,this)})),function(n){return e.apply(this,arguments)})},{key:"getHighestPriority",value:function(n,o,r){var u=arguments.length>3&&arguments[3]!==void 0&&arguments[3],s=n.views,w=s.length;if(w===0)return null;for(var m=0;m<w;m++){var v=s[m].view;if(!this.isViewFinished(v))return v}var g=n.first.id,d=n.last.id;if(d-g+1>w)for(var f=n.ids,y=1,x=d-g;y<x;y++){var k=r?g+y:d-y;if(!f.has(k)){var P=o[k-1];if(!this.isViewFinished(P))return P}}var S=r?d:g-2,E=o[S];return E&&!this.isViewFinished(E)||u&&(E=o[S+=r?1:-1])&&!this.isViewFinished(E)?E:null}},{key:"isViewFinished",value:function(n){return n.renderingState===RenderingStates.FINISHED}},{key:"renderView",value:function(n){var o=this;switch(n.renderingState){case RenderingStates.FINISHED:return!1;case RenderingStates.PAUSED:this.highestPriorityPage=n.renderingId,n.resume();break;case RenderingStates.RUNNING:this.highestPriorityPage=n.renderingId;break;case RenderingStates.INITIAL:this.highestPriorityPage=n.renderingId,n.draw().finally(function(){o.renderHighestPriority()})}return!0}}]);var e}(),UI_NOTIFICATION_CLASS="pdfSidebarNotification",_PDFSidebar_brand=new WeakSet,PDFSidebar=function(){return _createClass(function e(n){var o=n.elements,r=n.pdfViewer,u=n.pdfThumbnailViewer,s=n.eventBus,w=n.l10n;_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_PDFSidebar_brand),this.isOpen=!1,this.active=SidebarView.THUMBS,this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.onToggled=null,this.pdfViewer=r,this.pdfThumbnailViewer=u,this.outerContainer=o.outerContainer,this.sidebarContainer=o.sidebarContainer,this.toggleButton=o.toggleButton,this.thumbnailButton=o.thumbnailButton,this.outlineButton=o.outlineButton,this.attachmentsButton=o.attachmentsButton,this.layersButton=o.layersButton,this.thumbnailView=o.thumbnailView,this.outlineView=o.outlineView,this.attachmentsView=o.attachmentsView,this.layersView=o.layersView,this._outlineOptionsContainer=o.outlineOptionsContainer,this._currentOutlineItemButton=o.currentOutlineItemButton,this.eventBus=s,this.l10n=w,this.eventBus._on("pagesloaded",function(){})},[{key:"reset",value:function(){this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,_assertClassBrand(_PDFSidebar_brand,this,_hideUINotification).call(this,!0),this.switchView(SidebarView.THUMBS)}},{key:"visibleView",get:function(){return this.isOpen?this.active:SidebarView.NONE}},{key:"setInitialView",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SidebarView.NONE;this.isInitialViewSet||(this.isInitialViewSet=!0,e!==SidebarView.NONE&&e!==SidebarView.UNKNOWN?(this.switchView(e,!0),this.isInitialEventDispatched||_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent$1).call(this)):_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent$1).call(this))}},{key:"switchView",value:function(e){var n,o,r,u,s,w,m,v,g,d,f,y,x,k=arguments.length>1&&arguments[1]!==void 0&&arguments[1],P=e!==this.active,S=!1;switch(e){case SidebarView.NONE:return void(this.isOpen&&this.close());case SidebarView.THUMBS:this.isOpen&&P&&(S=!0);break;case SidebarView.ATTACHMENTS:if(this.attachmentsButton.disabled)return;break;case SidebarView.OUTLINE:case SidebarView.LAYERS:break;default:return void console.error('PDFSidebar.switchView: "'.concat(e,'" is not a valid view.'))}this.active=e;var E=e===SidebarView.THUMBS,M=e===SidebarView.OUTLINE,T=e===SidebarView.ATTACHMENTS,D=e===SidebarView.LAYERS;(n=this.thumbnailButton)===null||n===void 0||n.classList.toggle("toggled",E),(o=this.outlineButton)===null||o===void 0||o.classList.toggle("toggled",M),(r=this.attachmentsButton)===null||r===void 0||r.classList.toggle("toggled",T),(u=this.layersButton)===null||u===void 0||u.classList.toggle("toggled",D),(s=this.thumbnailButton)===null||s===void 0||s.setAttribute("aria-checked",E),(w=this.outlineButton)===null||w===void 0||w.setAttribute("aria-checked",M),(m=this.attachmentsButton)===null||m===void 0||m.setAttribute("aria-checked",T),(v=this.layersButton)===null||v===void 0||v.setAttribute("aria-checked",D),(g=this.thumbnailView)===null||g===void 0||g.classList.toggle("hidden",!E),(d=this.outlineView)===null||d===void 0||d.classList.toggle("hidden",!M),(f=this.attachmentsView)===null||f===void 0||f.classList.toggle("hidden",!T),(y=this.layersView)===null||y===void 0||y.classList.toggle("hidden",!D),(x=this._outlineOptionsContainer)===null||x===void 0||x.classList.toggle("hidden",!M),!k||this.isOpen?(S&&(_assertClassBrand(_PDFSidebar_brand,this,_updateThumbnailViewer).call(this),_assertClassBrand(_PDFSidebar_brand,this,_forceRendering).call(this)),P&&_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent$1).call(this)):this.open()}},{key:"open",value:function(){var e,n,o;this.isOpen||(this.isOpen=!0,(e=this.toggleButton)===null||e===void 0||e.classList.add("toggled"),(n=this.toggleButton)===null||n===void 0||n.setAttribute("aria-expanded","true"),(o=this.outerContainer)===null||o===void 0||o.classList.add("sidebarMoving","sidebarOpen"),this.active===SidebarView.THUMBS&&_assertClassBrand(_PDFSidebar_brand,this,_updateThumbnailViewer).call(this),_assertClassBrand(_PDFSidebar_brand,this,_forceRendering).call(this),_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent$1).call(this),_assertClassBrand(_PDFSidebar_brand,this,_hideUINotification).call(this))}},{key:"close",value:function(){var e,n,o,r;this.isOpen&&(this.isOpen=!1,(e=this.toggleButton)===null||e===void 0||e.classList.remove("toggled"),(n=this.toggleButton)===null||n===void 0||n.setAttribute("aria-expanded","false"),(o=this.outerContainer)===null||o===void 0||o.classList.add("sidebarMoving"),(r=this.outerContainer)===null||r===void 0||r.classList.remove("sidebarOpen"),_assertClassBrand(_PDFSidebar_brand,this,_forceRendering).call(this),_assertClassBrand(_PDFSidebar_brand,this,_dispatchEvent$1).call(this))}},{key:"toggle",value:function(){this.isOpen?this.close():this.open()}}])}();function _dispatchEvent$1(){this.isInitialViewSet&&!this.isInitialEventDispatched&&(this.isInitialEventDispatched=!0),this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView})}function _forceRendering(){this.onToggled?this.onToggled():(this.pdfViewer.forceRendering(),this.pdfThumbnailViewer.forceRendering())}function _updateThumbnailViewer(){for(var e=this.pdfViewer,n=this.pdfThumbnailViewer,o=e.pagesCount,r=0;r<o;r++){var u=e.getPageView(r);(u==null?void 0:u.renderingState)===RenderingStates$1.FINISHED&&n.getThumbnail(r).setImage(u)}n.scrollThumbnailIntoView(e.currentPageNumber)}function _hideUINotification(){var e,n,o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];(this.isOpen||o)&&((e=this.toggleButton)===null||e===void 0||e.classList.remove(UI_NOTIFICATION_CLASS)),o&&((n=this.toggleButton)===null||n===void 0||n.setAttribute("data-l10n-id","toggle_sidebar"))}function _download(e,n){var o=document.createElement("a");if(!o.click)throw new Error('DownloadManager: "a.click()" is not supported.');o.href=e,o.target="_parent","download"in o&&(o.download=n),(document.body||document.documentElement).append(o),o.click(),o.remove()}var _openBlobUrls=new WeakMap,DownloadManager=function(){return _createClass(function e(){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_openBlobUrls,new WeakMap)},[{key:"downloadUrl",value:function(e,n){pdfExports.createValidAbsoluteUrl(e,"http://example.com")?_download(e+"#pdfjs.action=download",n):console.error("downloadUrl - not a valid URL: ".concat(e))}},{key:"downloadData",value:function(e,n,o){_download(URL.createObjectURL(new Blob([e],{type:o})),n)}},{key:"openOrDownloadData",value:function(e,n,o){var r=pdfExports.isPdfFile(o),u=r?"application/pdf":"";if(r){var s,w=_classPrivateFieldGet2(_openBlobUrls,this).get(e);w||(w=URL.createObjectURL(new Blob([n],{type:u})),_classPrivateFieldGet2(_openBlobUrls,this).set(e,w)),typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?s="?file="+encodeURIComponent(w+"#"+o):PDFJSDev.test("CHROME")&&(s=chrome.runtime.getURL("/content/web/viewer.html")+"?file="+encodeURIComponent(w+"#"+o));try{return window.open(s),!0}catch(m){console.error("openOrDownloadData: ".concat(m)),URL.revokeObjectURL(w),_classPrivateFieldGet2(_openBlobUrls,this).delete(e)}}return this.downloadData(n,o,u),!1}},{key:"download",value:function(e,n,o){_download(URL.createObjectURL(e),o)}}])}(),DefaultExternalServices=function(){return _createClass(function e(){throw _classCallCheck(this,e),new Error("Cannot initialize DefaultExternalServices.")},null,[{key:"updateFindControlState",value:function(e){}},{key:"updateFindMatchesCount",value:function(e){}},{key:"initPassiveLoading",value:function(e){}},{key:"reportTelemetry",value:function(e){}},{key:"createDownloadManager",value:function(){throw new Error("Not implemented: createDownloadManager")}},{key:"createPreferences",value:function(){throw new Error("Not implemented: createPreferences")}},{key:"createL10n",value:function(e){throw new Error("Not implemented: createL10n")}},{key:"createScripting",value:function(e){throw new Error("Not implemented: createScripting")}},{key:"supportsIntegratedFind",get:function(){return shadow(this,"supportsIntegratedFind",!1)}},{key:"supportsDocumentFonts",get:function(){return shadow(this,"supportsDocumentFonts",!0)}},{key:"supportedMouseWheelZoomModifierKeys",get:function(){return shadow(this,"supportedMouseWheelZoomModifierKeys",{ctrlKey:!0,metaKey:!0})}},{key:"isInAutomation",get:function(){return shadow(this,"isInAutomation",!1)}},{key:"updateEditorStates",value:function(e){throw new Error("Not implemented: updateEditorStates")}}])}(),GenericExternalServices=function(e){function n(){return _classCallCheck(this,n),_callSuper(this,n,arguments)}return _inherits(n,DefaultExternalServices),_createClass(n,null,[{key:"createDownloadManager",value:function(){return new DownloadManager}}])}(),CSS_CLASS_GRAB="grab-to-pan-grab",_GrabToPan_brand=new WeakSet,GrabToPan=function(){return _createClass(function e(n){_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_GrabToPan_brand),this.element=n.element,this.document=n.element.ownerDocument,typeof n.ignoreTarget=="function"&&(this.ignoreTarget=n.ignoreTarget),this.onActiveChanged=n.onActiveChanged,this.activate=this.activate.bind(this),this.deactivate=this.deactivate.bind(this),this.toggle=this.toggle.bind(this),this._onMouseDown=_assertClassBrand(_GrabToPan_brand,this,_onMouseDown).bind(this),this._onMouseMove=_assertClassBrand(_GrabToPan_brand,this,_onMouseMove).bind(this),this._endPan=_assertClassBrand(_GrabToPan_brand,this,_endPan).bind(this),(this.overlay=document.createElement("div")).className="grab-to-pan-grabbing"},[{key:"activate",value:function(){var e;this.active||(this.active=!0,this.element.addEventListener("mousedown",this._onMouseDown,!0),this.element.classList.add(CSS_CLASS_GRAB),(e=this.onActiveChanged)===null||e===void 0||e.call(this,!0))}},{key:"deactivate",value:function(){var e;this.active&&(this.active=!1,this.element.removeEventListener("mousedown",this._onMouseDown,!0),this._endPan(),this.element.classList.remove(CSS_CLASS_GRAB),(e=this.onActiveChanged)===null||e===void 0||e.call(this,!1))}},{key:"toggle",value:function(){this.active?this.deactivate():this.activate()}},{key:"ignoreTarget",value:function(e){return e.matches("a[href], a[href] *, input, textarea, button, button *, select, option")}}])}();function _onMouseDown(e){if(e.button===0&&!this.ignoreTarget(e.target)){if(e.originalTarget)try{e.originalTarget.tagName}catch{return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=e.clientX,this.clientYStart=e.clientY,this.document.addEventListener("mousemove",this._onMouseMove,!0),this.document.addEventListener("mouseup",this._endPan,!0),this.element.addEventListener("scroll",this._endPan,!0),e.preventDefault(),e.stopPropagation();var n=document.activeElement;n&&!n.contains(e.target)&&n.blur()}}function _onMouseMove(e){if(this.element.removeEventListener("scroll",this._endPan,!0),1&e.buttons){var n=e.clientX-this.clientXStart,o=e.clientY-this.clientYStart,r=this.scrollTopStart-o,u=this.scrollLeftStart-n;this.element.scrollTo?this.element.scrollTo({top:r,left:u,behavior:"instant"}):(this.element.scrollTop=r,this.element.scrollLeft=u),this.overlay.parentNode||document.body.append(this.overlay)}else this._endPan()}function _endPan(){this.element.removeEventListener("scroll",this._endPan,!0),this.document.removeEventListener("mousemove",this._onMouseMove,!0),this.document.removeEventListener("mouseup",this._endPan,!0),this.overlay.remove()}var CursorTool={SELECT:0,HAND:1,ZOOM:2},_PDFCursorTools_brand=new WeakSet,PDFCursorTools=function(){return _createClass(function e(n){var o=this,r=n.container,u=n.eventBus,s=n.cursorToolOnLoad,w=s===void 0?CursorTool.SELECT:s;_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_PDFCursorTools_brand),this.container=r,this.eventBus=u,this.active=CursorTool.SELECT,this.previouslyActive=null,this.handTool=new GrabToPan({element:this.container}),_assertClassBrand(_PDFCursorTools_brand,this,_addEventListeners).call(this),Promise.resolve().then(function(){o.switchTool(w)})},[{key:"activeTool",get:function(){return this.active}},{key:"switchTool",value:function(e){var n=this;if(this.previouslyActive===null&&e!==this.active){var o=function(){switch(n.active){case CursorTool.SELECT:break;case CursorTool.HAND:n.handTool.deactivate()}};switch(e){case CursorTool.SELECT:o();break;case CursorTool.HAND:o(),this.handTool.activate();break;case CursorTool.ZOOM:default:return void console.error('switchTool: "'.concat(e,'" is an unsupported value.'))}this.active=e,_assertClassBrand(_PDFCursorTools_brand,this,_dispatchEvent$2).call(this)}}}])}();function _dispatchEvent$2(){this.eventBus.dispatch("cursortoolchanged",{source:this,tool:this.active})}function _addEventListeners(){var e=this;this.eventBus._on("switchcursortool",function(s){e.switchTool(s.tool)});var n=pdfExports.AnnotationEditorType.NONE,o=PresentationModeState.NORMAL,r=function(){var s,w=e.active;e.switchTool(CursorTool.SELECT),(s=e.previouslyActive)!==null&&s!==void 0||(e.previouslyActive=w)},u=function(){var s=e.previouslyActive;s!==null&&n===pdfExports.AnnotationEditorType.NONE&&o===PresentationModeState.NORMAL&&(e.previouslyActive=null,e.switchTool(s))};this.eventBus._on("secondarytoolbarreset",function(s){e.previouslyActive!==null&&(n=pdfExports.AnnotationEditorType.NONE,o=PresentationModeState.NORMAL,u())}),this.eventBus._on("annotationeditormodechanged",function(s){var w=s.mode;n=w,w===pdfExports.AnnotationEditorType.NONE?u():r()}),this.eventBus._on("presentationmodechanged",function(s){var w=s.state;o=w,w===PresentationModeState.NORMAL?u():w===PresentationModeState.FULLSCREEN&&r()})}var DELAY_BEFORE_HIDING_CONTROLS=3e3,ACTIVE_SELECTOR="pdfPresentationMode",CONTROLS_SELECTOR="pdfPresentationModeControls",MOUSE_SCROLL_COOLDOWN_TIME=50,PAGE_SWITCH_THRESHOLD=.1,SWIPE_MIN_DISTANCE_THRESHOLD=50,SWIPE_ANGLE_THRESHOLD=Math.PI/6,_state=new WeakMap,_args=new WeakMap,_PDFPresentationMode_brand=new WeakSet,PDFPresentationMode=function(){return _createClass(function n(o){var r=o.container,u=o.pdfViewer,s=o.eventBus;_classCallCheck(this,n),_classPrivateMethodInitSpec(this,_PDFPresentationMode_brand),_classPrivateFieldInitSpec(this,_state,PresentationModeState.UNKNOWN),_classPrivateFieldInitSpec(this,_args,null),this.container=r,this.pdfViewer=u,this.eventBus=s,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null,this.isHandlingFullScreen=!1},[{key:"request",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(){var o,r,u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=this.container,r=this.pdfViewer,!this.active&&r.pagesCount){s.next=3;break}return s.abrupt("return",!1);case 3:return _assertClassBrand(_PDFPresentationMode_brand,this,_addFullscreenChangeListeners).call(this),_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.CHANGING),u=null,o.webkitRequestFullScreen?u=o.webkitRequestFullScreen():o.mozRequestFullScreen?u=o.mozRequestFullScreen():o.requestFullscreen&&(u=o.requestFullscreen()),_classPrivateFieldSet2(_args,this,{pageNumber:r.currentPageNumber,scaleValue:r.currentScaleValue,scrollMode:r.scrollMode,spreadMode:null,annotationEditorMode:null}),r.spreadMode===SpreadMode.NONE||r.pageViewsReady&&r.hasEqualPageSizes||(console.warn("Ignoring Spread modes when entering PresentationMode, since the document may contain varying page sizes."),_classPrivateFieldGet2(_args,this).spreadMode=r.spreadMode),r.annotationEditorMode!==pdfExports.AnnotationEditorType.DISABLE&&(_classPrivateFieldGet2(_args,this).annotationEditorMode=r.annotationEditorMode),s.prev=10,s.next=13,u;case 13:return r.focus(),s.abrupt("return",!0);case 17:s.prev=17,s.t0=s.catch(10),_assertClassBrand(_PDFPresentationMode_brand,this,_removeFullscreenChangeListeners).call(this),_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.NORMAL);case 21:return s.abrupt("return",!1);case 22:case"end":return s.stop()}},n,this,[[10,17]])})),function(){return e.apply(this,arguments)})},{key:"active",get:function(){return _classPrivateFieldGet2(_state,this)===PresentationModeState.CHANGING||_classPrivateFieldGet2(_state,this)===PresentationModeState.FULLSCREEN}}]);var e}();function _mouseWheel(e){if(this.active){e.preventDefault();var n=normalizeWheelEventDelta(e),o=Date.now(),r=this.mouseScrollTimeStamp;if(!(o>r&&o-r<MOUSE_SCROLL_COOLDOWN_TIME)&&((this.mouseScrollDelta>0&&n<0||this.mouseScrollDelta<0&&n>0)&&_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this),this.mouseScrollDelta+=n,Math.abs(this.mouseScrollDelta)>=PAGE_SWITCH_THRESHOLD)){var u=this.mouseScrollDelta;_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this),(u>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=o)}}}function _notifyStateChange(e){_classPrivateFieldSet2(_state,this,e),this.eventBus.dispatch("presentationmodechanged",{source:this,state:e})}function _enter(){var e=this;_assertClassBrand(_PDFPresentationMode_brand,this,_notifyStateChange).call(this,PresentationModeState.FULLSCREEN),this.container.classList.add(ACTIVE_SELECTOR),setTimeout(function(){e.pdfViewer.scrollMode=ScrollMode.PAGE,_classPrivateFieldGet2(_args,e).spreadMode!==null&&(e.pdfViewer.spreadMode=SpreadMode.NONE),e.pdfViewer.currentPageNumber=_classPrivateFieldGet2(_args,e).pageNumber,e.pdfViewer.currentScaleValue="page-fit",_classPrivateFieldGet2(_args,e).annotationEditorMode!==null&&(e.pdfViewer.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},0),_assertClassBrand(_PDFPresentationMode_brand,this,_addWindowListeners).call(this),_assertClassBrand(_PDFPresentationMode_brand,this,_showControls).call(this),this.contextMenuOpen=!1,window.getSelection().removeAllRanges()}function _exit(){var e=this,n=this.pdfViewer.currentPageNumber;this.container.classList.remove(ACTIVE_SELECTOR),setTimeout(function(){_assertClassBrand(_PDFPresentationMode_brand,e,_removeFullscreenChangeListeners).call(e),_assertClassBrand(_PDFPresentationMode_brand,e,_notifyStateChange).call(e,PresentationModeState.NORMAL),e.pdfViewer.scrollMode=_classPrivateFieldGet2(_args,e).scrollMode,_classPrivateFieldGet2(_args,e).spreadMode!==null&&(e.pdfViewer.spreadMode=_classPrivateFieldGet2(_args,e).spreadMode),e.pdfViewer.exitPresentationMode=!0,e.pdfViewer.currentPageNumber=n,e.pdfViewer.currentScaleValue=_classPrivateFieldGet2(_args,e).scaleValue,_classPrivateFieldGet2(_args,e).annotationEditorMode!==null&&(e.pdfViewer.annotationEditorMode=_classPrivateFieldGet2(_args,e).annotationEditorMode),_classPrivateFieldSet2(_args,e,null)},0),_assertClassBrand(_PDFPresentationMode_brand,this,_removeWindowListeners).call(this),_assertClassBrand(_PDFPresentationMode_brand,this,_hideControls).call(this),_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).call(this),this.contextMenuOpen=!1}function _mouseDown(e){var n;if(this.contextMenuOpen)return this.contextMenuOpen=!1,void e.preventDefault();e.button===0&&(e.target.href&&(n=e.target.parentNode)!==null&&n!==void 0&&n.hasAttribute("data-internal-link")||(e.preventDefault(),e.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))}function _contextMenu(){this.contextMenuOpen=!0}function _showControls(){var e=this;this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(CONTROLS_SELECTOR),this.controlsTimeout=setTimeout(function(){e.container.classList.remove(CONTROLS_SELECTOR),delete e.controlsTimeout},DELAY_BEFORE_HIDING_CONTROLS)}function _hideControls(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(CONTROLS_SELECTOR),delete this.controlsTimeout)}function _resetMouseScrollState(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0}function _touchSwipe(e){if(this.active)if(e.touches.length>1)this.touchSwipeState=null;else switch(e.type){case"touchstart":this.touchSwipeState={startX:e.touches[0].pageX,startY:e.touches[0].pageY,endX:e.touches[0].pageX,endY:e.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null)return;this.touchSwipeState.endX=e.touches[0].pageX,this.touchSwipeState.endY=e.touches[0].pageY,e.preventDefault();break;case"touchend":if(this.touchSwipeState===null)return;var n=0,o=this.touchSwipeState.endX-this.touchSwipeState.startX,r=this.touchSwipeState.endY-this.touchSwipeState.startY,u=Math.abs(Math.atan2(r,o));Math.abs(o)>SWIPE_MIN_DISTANCE_THRESHOLD&&(u<=SWIPE_ANGLE_THRESHOLD||u>=Math.PI-SWIPE_ANGLE_THRESHOLD)?n=o:Math.abs(r)>SWIPE_MIN_DISTANCE_THRESHOLD&&Math.abs(u-Math.PI/2)<=SWIPE_ANGLE_THRESHOLD&&(n=r),n>0?this.pdfViewer.previousPage():n<0&&this.pdfViewer.nextPage()}}function _addWindowListeners(){this.showControlsBind=_assertClassBrand(_PDFPresentationMode_brand,this,_showControls).bind(this),this.mouseDownBind=_assertClassBrand(_PDFPresentationMode_brand,this,_mouseDown).bind(this),this.mouseWheelBind=_assertClassBrand(_PDFPresentationMode_brand,this,_mouseWheel).bind(this),this.resetMouseScrollStateBind=_assertClassBrand(_PDFPresentationMode_brand,this,_resetMouseScrollState).bind(this),this.contextMenuBind=_assertClassBrand(_PDFPresentationMode_brand,this,_contextMenu).bind(this),this.touchSwipeBind=_assertClassBrand(_PDFPresentationMode_brand,this,_touchSwipe).bind(this),window.addEventListener("mousemove",this.showControlsBind),window.addEventListener("mousedown",this.mouseDownBind),window.addEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.addEventListener("keydown",this.resetMouseScrollStateBind),window.addEventListener("contextmenu",this.contextMenuBind),window.addEventListener("touchstart",this.touchSwipeBind),window.addEventListener("touchmove",this.touchSwipeBind),window.addEventListener("touchend",this.touchSwipeBind)}function _removeWindowListeners(){window.removeEventListener("mousemove",this.showControlsBind),window.removeEventListener("mousedown",this.mouseDownBind),window.removeEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.removeEventListener("keydown",this.resetMouseScrollStateBind),window.removeEventListener("contextmenu",this.contextMenuBind),window.removeEventListener("touchstart",this.touchSwipeBind),window.removeEventListener("touchmove",this.touchSwipeBind),window.removeEventListener("touchend",this.touchSwipeBind),delete this.showControlsBind,delete this.mouseDownBind,delete this.mouseWheelBind,delete this.resetMouseScrollStateBind,delete this.contextMenuBind,delete this.touchSwipeBind}function _fullscreenChange(){var e=this;this.isHandlingFullScreen||(this.isHandlingFullScreen=!0,document.fullscreenElement?_assertClassBrand(_PDFPresentationMode_brand,this,_enter).call(this):_assertClassBrand(_PDFPresentationMode_brand,this,_exit).call(this),setTimeout(function(){e.isHandlingFullScreen=!1},0))}function _addFullscreenChangeListeners(){this.fullscreenChangeBind=_assertClassBrand(_PDFPresentationMode_brand,this,_fullscreenChange).bind(this),window.addEventListener("fullscreenchange",this.fullscreenChangeBind),window.addEventListener("webkitfullscreenchange",this.fullscreenChangeBind),window.addEventListener("mozfullscreenchange",this.fullscreenChangeBind)}function _removeFullscreenChangeListeners(){window.removeEventListener("fullscreenchange",this.fullscreenChangeBind),window.removeEventListener("webkitfullscreenchange",this.fullscreenChangeBind),window.removeEventListener("mozfullscreenchange",this.fullscreenChangeBind),delete this.fullscreenChangeBind}var annotationStore={selectedName:null,annotationsAll:null,notFirstRender:!1,creating:!1,fileData:null,$t:null,signatures:[],highlightLink:!0,highlightForm:!0,cropping:!1,ignoreColors:[],freetextDefault:{fontName:"Helvetica",fontStyle:"normal",fontWeight:"normal",fontSize:14,textAlignment:"left",color:"rgb(0, 0, 0)",borderWidth:0,borderColor:"rgb(0, 0, 0)",fillColor:""},polygon:{showPerimeter:!0,showArea:!0},rectangle:{showPerimeter:!0,showArea:!0},circle:{showRadius:!1,showPerimeter:!1,showArea:!0},arc:{showRadius:!1,showAngle:!0,showArcLength:!1},defauleStyle:{text:{name:"text",defaults:{color:"#FF0000",opacity:1}},ink:{name:"ink",defaults:{borderColor:"FF0000",borderWidth:2,opacity:1}},highlight:{name:"highlight",defaults:{color:"#FFEC66",opacity:1}},underline:{name:"underline",defaults:{color:"#FF0000",opacity:1}},squiggly:{name:"squiggly",defaults:{color:"#FF0000",opacity:1}},strikeout:{name:"strikeout",defaults:{color:"#FF0000",opacity:1}},arc:{name:"arc",defaults:{borderColor:"FF0000",borderWidth:2,opacity:1}},circle:{name:"circle",defaults:{fillColor:"",fillTransparency:1,borderColor:"#FF0000",borderWidth:2,opacity:1,borderStyle:"solid"}},square:{name:"square",defaults:{fillColor:"",fillTransparency:1,borderColor:"#FF0000",borderWidth:2,opacity:1,borderStyle:"solid"}},polygon:{name:"polygon",defaults:{fillColor:"",fillTransparency:1,borderColor:"#FF0000",borderWidth:2,opacity:1,borderStyle:"solid",dashes:""}},cloudy:{name:"cloudy",defaults:{fillColor:"",fillTransparency:1,borderColor:"#FF0000",borderWidth:2,opacity:1,borderStyle:"cloudy",intensity:1}},polyline:{name:"polyline",defaults:{borderColor:"FF0000",borderWidth:2,opacity:1,borderStyle:"solid"}},arrow:{name:"arrow",defaults:{borderColor:"FF0000",borderWidth:2,opacity:1,borderStyle:"solid",head:"none",tail:"openarrow"}},line:{name:"line",defaults:{borderColor:"FF0000",borderWidth:2,opacity:1,borderStyle:"solid",head:"none",tail:"none"}},freetext:{name:"freetext",defaults:{fontName:"Helvetica",fontStyle:"normal",fontWeight:"normal",fontSize:14,textAlignment:"left",color:"rgb(0, 0, 0)",borderWidth:0,borderColor:"rgb(0, 0, 0)",fillColor:""}},callout:{name:"callout",defaults:{fillColor:"",borderColor:"rgb(0, 0, 0)",borderWidth:2,color:"rgb(0, 0, 0)",opacity:1,fontName:"Helvetica",fontStyle:"normal",fontWeight:"normal",fontSize:14,textAlignment:"left"}}}},Signatures=function(){return _createClass(function n(o){var r=o.pdfViewer,u=o.eventBus,s=o.type;_classCallCheck(this,n),this.pdfViewer=r,this.eventBus=u,this.type=s,this.path=[],this.inkPath=[],this.currentPath=[],this.areaBound=[NaN,NaN,NaN,NaN],this.inkPadding={x:10,y:10},this.strokeWidth=5,this.strokColor="#000",this.onMousedown=this.handleMouseDown.bind(this),this.onMousemove=this.handleMouseMove.bind(this),this.onMouseup=this.handleMouseUp.bind(this),this.onHandleGetSignData=this.getData.bind(this),this.onHandleInitCursorStyle=this.initCursorStyle.bind(this),this.init()},[{key:"init",value:function(){var n=document.getElementById("digitalTrackpadCanvas"),o=document.getElementById("electronicTrackpadCanvas");this.canvas=this.type?n:o,this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=578,this.canvas.height=270),this.ctx=this.canvas.getContext("2d"),this.canvas.style.cursor="crosshair",this.canvas.addEventListener("mousedown",this.onMousedown),this.canvas.addEventListener("touchstart",this.onMousedown),this.eventBus._on("getSignData",this.onHandleGetSignData),this.eventBus._on("initCursorStyle",this.onHandleInitCursorStyle)}},{key:"handleMouseDown",value:function(n){if(!n.changedTouches||n.changedTouches.length===1){var o,r,u=n.clientX||n.changedTouches[0].clientX,s=n.clientY||n.changedTouches[0].clientY;isMobile$1&&this.type?(o=s-this.canvas.getBoundingClientRect().top,r=this.canvas.height-(u-this.canvas.getBoundingClientRect().left)):(o=u-this.canvas.getBoundingClientRect().left,r=s-this.canvas.getBoundingClientRect().top),this.ctx.lineWidth=this.strokeWidth,this.ctx.strokeStyle=this.strokColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.currentPath.length>0&&(this.inkPath.push(this.currentPath),this.currentPath=[]),this.ctx.beginPath(),this.ctx.moveTo(o,r),this.mousedown=!0,this.pressPoint={x:o,y:r},document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup),document.addEventListener("touchmove",this.onMousemove),document.addEventListener("touchend",this.onMouseup)}}},{key:"handleMouseMove",value:function(n){var o,r,u=n.clientX||n.changedTouches[0].clientX,s=n.clientY||n.changedTouches[0].clientY;if(isMobile$1&&this.type?(o=s-this.canvas.getBoundingClientRect().top,r=this.canvas.height-(u-this.canvas.getBoundingClientRect().left)):(o=u-this.canvas.getBoundingClientRect().left,r=s-this.canvas.getBoundingClientRect().top),!(o>this.canvas.width||r>this.canvas.height||o<0||r<0)){var w=!0;this.mousedown&&this.pressPoint&&o==this.pressPoint.x&&r==this.pressPoint.y&&(w=!1),w&&(this.ctx.lineTo(o,r),this.ctx.stroke(),this.path.push([o,r]),this.currentPath.push({x:o,y:r}))}}},{key:"handleMouseUp",value:function(){document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),document.removeEventListener("touchmove",this.onMousemove),document.removeEventListener("touchend",this.onMouseup),this.mousedown=!1,this.pressPoint={x:-1,y:-1};var n=this.getRect();this.rect=n,this.currentPath.length>0&&(this.inkPath.push(this.currentPath),this.currentPath=[],this.eventBus.dispatch("signaturesImageChanged",{type:"addSignature",imageBase64:this.getImageBase64()}))}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.path=[],this.inkPath=[],this.currentPath=[],this.areaBound=[NaN,NaN,NaN,NaN],this.initCursorStyle(),this.eventBus.dispatch("signaturesImageChanged",{type:"clear",imageBase64:null})}},{key:"reset",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.path=[],this.inkPath=[],this.currentPath=[],this.areaBound=[NaN,NaN,NaN,NaN],this.onMousedown=null,this.onMousemove=null,this.onMouseup=null,this.onHandleGetSignData=null,this.onHandleInitCursorStyle=null,this.eventBus.dispatch("signaturesImageChanged",{type:"reset",imageBase64:null})}},{key:"getRect",value:function(){var n=[],o=[];this.path.forEach(function(m){n.push(m[0]),o.push(m[1])});var r=Math.min.apply(Math,o),u=Math.min.apply(Math,n),s=Math.max.apply(Math,o),w=Math.max.apply(Math,n);return{left:u,top:r,bottom:s,right:w,width:w-u,height:s-r}}},{key:"getImageBase64",value:function(){var n=null;if(this.path.length!==0){var o=this.getInkPathData();n=o.toDataURL("image/png"),o||(n=(o=this.paintFinalCanvas()).toDataURL("image/jpeg"))}return n}},{key:"toImage",value:function(n){var o=n.annotation,r=n.imageBase64,u=o.annotPtr,s=o.rect,w=o.pagePtr,m=null;if(this.path.length!==0){var v=this.getInkPathData(),g=v.toDataURL("image/png");v||(g=(v=this.paintFinalCanvas()).toDataURL("image/jpeg")),m=g}this.dataURL=m||r;var d=m?this.dataURLToArrayBuffer(m):null;if(u&&(d||r)&&!this.type)return this.eventBus.dispatch("updateSignatureAp",{type:this.type,annotPtr:u,pagePtr:w,rect:s,imageArray:d,imageBase64:r,annotation:o}),m}},{key:"getData",value:function(n){if(this.path.length!==0){this.layerData=n;var o={operate:"add-annot",type:"image",pageIndex:this.layerData.page+1,imageBase64:this.dataURL,date:new Date},r=this.formatPath();r.path;var u=r.rect;o.rect=u,this.eventBus.dispatch("createSignature",o)}}},{key:"calcInkPath",value:function(){if(this.inkPath.length>0){for(var n=[NaN,NaN,NaN,NaN],o=[],r=0;r<this.inkPath.length;r++)for(var u=0;u<this.inkPath[r].length;u++)isNaN(n[0])?(n[0]=this.inkPath[r][u].x,n[1]=this.inkPath[r][u].y,n[2]=this.inkPath[r][u].x,n[3]=this.inkPath[r][u].y):(n[0]>this.inkPath[r][u].x&&(n[0]=this.inkPath[r][u].x),n[1]>this.inkPath[r][u].y&&(n[1]=this.inkPath[r][u].y),n[2]<this.inkPath[r][u].x&&(n[2]=this.inkPath[r][u].x),n[3]<this.inkPath[r][u].y&&(n[3]=this.inkPath[r][u].y));if(!isNaN(n[0]))for(var s={x:this.inkPadding.x-n[0],y:this.inkPadding.y-n[1]},w=0;w<this.inkPath.length;w++){var m=[];o.push(m);for(var v=0;v<this.inkPath[w].length;v++)m.push({x:this.inkPath[w][v].x+s.x,y:this.inkPath[w][v].y+s.y})}return{areaBound:n,inkPaths:o}}}},{key:"getInkPathData",value:function(){var n=this.calcInkPath(),o=n.areaBound,r=n.inkPaths;if(!isNaN(o[0])){var u=document.createElement("canvas"),s=u.getContext("2d");u.width=o[2]-o[0]+2*this.inkPadding.x,u.height=o[3]-o[1]+2*this.inkPadding.y,s.strokeStyle=this.strokColor,s.lineWidth=this.strokeWidth;for(var w=0;w<r.length;w++)if(r[w].length==1&&(s.beginPath(),s.fillStyle=this.strokColor,s.ellipse(r[w][0].x,r[w][0].y,this.strokeWidth/2,this.strokeWidth/2,0,0,360,!1),s.fill(),s.closePath()),r[w].length>1){s.beginPath(),s.moveTo(r[w][0].x,r[w][0].y);for(var m=1;m<r[w].length;m++)s.lineTo(r[w][m].x,r[w][m].y);s.stroke(),s.closePath()}return u}return null}},{key:"formatPath",value:function(){for(var n="",o=this.path.length,r=[],u=[],s=0;s<o;s+=2){var w=this.handlePoint(this.path[s]);if(r.push(w.x),u.push(w.y),n+=w.x.toFixed(2)+","+w.y.toFixed(2),s+1<o){var m=this.handlePoint(this.path[s]);r.push(m.x),u.push(m.y),n+=";"+m.x.toFixed(2)+","+m.y.toFixed(2),s+2<o&&(n+=";")}}var v=Math.min.apply(Math,r),g=Math.min.apply(Math,u),d=Math.max.apply(Math,r),f=Math.max.apply(Math,u);return{path:n,rect:"".concat(v,",").concat(g,",").concat(d,",").concat(f)}}},{key:"handlePoint",value:function(n){var o=getInitialPoint$1({x:n[0]+this.layerData.clickX-this.rect.width/2,y:n[1]+this.layerData.clickY-this.rect.height/2},this.layerData.viewport.scale);return{x:o.x,y:o.y}}},{key:"initCursorStyle",value:function(){this.img&&this.img.remove()}},{key:"paintFinalCanvas",value:function(){var n=document.createElement("canvas"),o=n.getContext("2d");return n.width=this.rect.width,n.height=this.rect.height,o.fillStyle="white",o.fillRect(0,0,n.width,n.height),o.lineWidth=3,o.strokeStyle="black",o.drawImage(this.canvas,this.rect.left,this.rect.top,n.width,n.height,0,0,n.width,n.height),n}},{key:"update",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function n(o){var r,u,s,w;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.type&&this.toImage(o),r=o.width,u=o.color,r&&(this.strokeWidth=r),u&&(this.strokColor=u),this.inkPath){for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=this.strokeWidth,this.ctx.strokeStyle=this.strokColor,s=0;s<this.inkPath.length;s++)if(this.inkPath[s].length==1&&(this.ctx.beginPath(),this.ctx.fillStyle=this.strokColor,this.ctx.ellipse(this.inkPath[s][0].x,this.inkPath[s][0].y,this.strokeWidth/2,this.strokeWidth/2,0,0,360,!1),this.ctx.fill(),this.ctx.closePath()),this.inkPath[s].length>1){for(this.ctx.beginPath(),this.ctx.moveTo(this.inkPath[s][0].x,this.inkPath[s][0].y),w=1;w<this.inkPath[s].length;w++)this.ctx.lineTo(this.inkPath[s][w].x,this.inkPath[s][w].y);this.ctx.stroke(),this.ctx.closePath()}}case 5:case"end":return m.stop()}},n,this)})),function(n){return e.apply(this,arguments)})},{key:"dataURLToArrayBuffer",value:function(n){var o=atob(n.split(",")[1]);n.split(";")[0].split(":")[1];for(var r=new ArrayBuffer(o.length),u=new Uint8Array(r),s=0;s<o.length;s++)u[s]=o.charCodeAt(s);return u}},{key:"updateSignature",value:function(n){}}]);var e}(),MessageHandler=function(){return _createClass(function e(n,o,r){var u=this;_classCallCheck(this,e),this.sourceName=n,this.targetName=o,this.comObj=r,this.callbackId=1,this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=function(s){var w=s.data;if(w.targetName===u.sourceName)if(w.callback){var m=w.callbackId,v=u.callbackCapabilities[m];if(!v)throw new Error("Cannot resolve callback ".concat(m));if(delete u.callbackCapabilities[m],w.callback!=="resolve")throw console.log({data:{action:w.data.action,data:w.data.data},message:w.reason&&w.reason.message}),v.reject(w.reason),new Error("Unexpected callback case");v.resolve(w.data)}else{var g=u.actionHandler[w.action];if(!g)throw new Error("Unknown action from worker: ".concat(w.action));if(w.callbackId){var d=u.sourceName,f=w.sourceName;new Promise(function(y){y(g(w.data))}).then(function(y){r.postMessage({sourceName:d,targetName:f,callback:"resolve",callbackId:w.callbackId,data:y})},function(y){r.postMessage({data:w,sourceName:d,targetName:f,callback:"reject",callbackId:w.callbackId,reason:y})})}else g(w.data)}},r.addEventListener("message",this._onComObjOnMessage)},[{key:"on",value:function(e,n){var o=this.actionHandler;if(o[e])throw new Error('There is already an actionName called "'.concat(e,'"'));o[e]=n}},{key:"send",value:function(e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:n})}},{key:"sendWithPromise",value:function(e,n){var o=this.callbackId++,r=new PromiseExt;this.callbackCapabilities[o]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:o,data:n})}catch(u){r.reject(u)}return r.promise}},{key:"destroy",value:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}])}(),jszip_minExports={},jszip_min={get exports(){return jszip_minExports},set exports(e){jszip_minExports=e}};jszip_min.exports=function e(n,o,r){function u(m,v){if(!o[m]){if(!n[m]){var g=typeof commonjsRequire=="function"&&commonjsRequire;if(!v&&g)return g(m,!0);if(s)return s(m,!0);var d=new Error("Cannot find module '"+m+"'");throw d.code="MODULE_NOT_FOUND",d}var f=o[m]={exports:{}};n[m][0].call(f.exports,function(y){return u(n[m][1][y]||y)},f,f.exports,e,n,o,r)}return o[m].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,w=0;w<r.length;w++)u(r[w]);return u}({1:[function(e,n,o){var r=e("./utils"),u=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(w){for(var m,v,g,d,f,y,x,k=[],P=0,S=w.length,E=S,M=r.getTypeOf(w)!=="string";P<w.length;)E=S-P,g=M?(m=w[P++],v=P<S?w[P++]:0,P<S?w[P++]:0):(m=w.charCodeAt(P++),v=P<S?w.charCodeAt(P++):0,P<S?w.charCodeAt(P++):0),d=m>>2,f=(3&m)<<4|v>>4,y=1<E?(15&v)<<2|g>>6:64,x=2<E?63&g:64,k.push(s.charAt(d)+s.charAt(f)+s.charAt(y)+s.charAt(x));return k.join("")},o.decode=function(w){var m,v,g,d,f,y,x=0,k=0,P="data:";if(w.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var S,E=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===s.charAt(64)&&E--,w.charAt(w.length-2)===s.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=u.uint8array?new Uint8Array(0|E):new Array(0|E);x<w.length;)m=s.indexOf(w.charAt(x++))<<2|(d=s.indexOf(w.charAt(x++)))>>4,v=(15&d)<<4|(f=s.indexOf(w.charAt(x++)))>>2,g=(3&f)<<6|(y=s.indexOf(w.charAt(x++))),S[k++]=m,f!==64&&(S[k++]=v),y!==64&&(S[k++]=g);return S}},{"./support":30,"./utils":32}],2:[function(e,n,o){var r=e("./external"),u=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),w=e("./stream/DataLengthProbe");function m(v,g,d,f,y){this.compressedSize=v,this.uncompressedSize=g,this.crc32=d,this.compression=f,this.compressedContent=y}m.prototype={getContentWorker:function(){var v=new u(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),g=this;return v.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new u(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(v,g,d){return v.pipe(new s).pipe(new w("uncompressedSize")).pipe(g.compressWorker(d)).pipe(new w("compressedSize")).withStreamInfo("compression",g)},n.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,o){var r=e("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},o.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,o){var r=e("./utils"),u=function(){for(var s,w=[],m=0;m<256;m++){s=m;for(var v=0;v<8;v++)s=1&s?3988292384^s>>>1:s>>>1;w[m]=s}return w}();n.exports=function(s,w){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(m,v,g,d){var f=u,y=d+g;m^=-1;for(var x=d;x<y;x++)m=m>>>8^f[255&(m^v[x])];return~m}(0|w,s,s.length,0):function(m,v,g,d){var f=u,y=d+g;m^=-1;for(var x=d;x<y;x++)m=m>>>8^f[255&(m^v.charCodeAt(x))];return~m}(0|w,s,s.length,0):0}},{"./utils":32}],5:[function(e,n,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(e,n,o){var r=null;r=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:r}},{lie:37}],7:[function(e,n,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",u=e("pako"),s=e("./utils"),w=e("./stream/GenericWorker"),m=r?"uint8array":"array";function v(g,d){w.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=d,this.meta={}}o.magic="\b\0",s.inherits(v,w),v.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(m,g.data),!1)},v.prototype.flush=function(){w.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new u[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(d){g.push({data:d,meta:g.meta})}},o.compressWorker=function(g){return new v("Deflate",g)},o.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,o){function r(f,y){var x,k="";for(x=0;x<y;x++)k+=String.fromCharCode(255&f),f>>>=8;return k}function u(f,y,x,k,P,S){var E,M,T=f.file,D=f.compression,N=S!==m.utf8encode,I=s.transformTo("string",S(T.name)),O=s.transformTo("string",m.utf8encode(T.name)),F=T.comment,q=s.transformTo("string",S(F)),Y=s.transformTo("string",m.utf8encode(F)),_e=O.length!==T.name.length,ne=Y.length!==F.length,ve="",J="",fe="",Z=T.dir,j=T.date,X={crc32:0,compressedSize:0,uncompressedSize:0};y&&!x||(X.crc32=f.crc32,X.compressedSize=f.compressedSize,X.uncompressedSize=f.uncompressedSize);var H=0;y&&(H|=8),N||!_e&&!ne||(H|=2048);var U=0,te=0;Z&&(U|=16),P==="UNIX"?(te=798,U|=function(re,Pe){var be=re;return re||(be=Pe?16893:33204),(65535&be)<<16}(T.unixPermissions,Z)):(te=20,U|=function(re){return 63&(re||0)}(T.dosPermissions)),E=j.getUTCHours(),E<<=6,E|=j.getUTCMinutes(),E<<=5,E|=j.getUTCSeconds()/2,M=j.getUTCFullYear()-1980,M<<=4,M|=j.getUTCMonth()+1,M<<=5,M|=j.getUTCDate(),_e&&(J=r(1,1)+r(v(I),4)+O,ve+="up"+r(J.length,2)+J),ne&&(fe=r(1,1)+r(v(q),4)+Y,ve+="uc"+r(fe.length,2)+fe);var Q="";return Q+=`
\0`,Q+=r(H,2),Q+=D.magic,Q+=r(E,2),Q+=r(M,2),Q+=r(X.crc32,4),Q+=r(X.compressedSize,4),Q+=r(X.uncompressedSize,4),Q+=r(I.length,2),Q+=r(ve.length,2),{fileRecord:g.LOCAL_FILE_HEADER+Q+I+ve,dirRecord:g.CENTRAL_FILE_HEADER+r(te,2)+Q+r(q.length,2)+"\0\0\0\0"+r(U,4)+r(k,4)+I+ve+q}}var s=e("../utils"),w=e("../stream/GenericWorker"),m=e("../utf8"),v=e("../crc32"),g=e("../signature");function d(f,y,x,k){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=x,this.encodeFileName=k,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,w),d.prototype.push=function(f){var y=f.meta.percent||0,x=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,w.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:x?(y+100*(x-k-1))/x:100}}))},d.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var y=this.streamFiles&&!f.file.dir;if(y){var x=u(f,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:x.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(f){this.accumulate=!1;var y=this.streamFiles&&!f.file.dir,x=u(f,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(x.dirRecord),y)this.push({data:function(k){return g.DATA_DESCRIPTOR+r(k.crc32,4)+r(k.compressedSize,4)+r(k.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:x.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var f=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var x=this.bytesWritten-f,k=function(P,S,E,M,T){var D=s.transformTo("string",T(M));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(P,2)+r(P,2)+r(S,4)+r(E,4)+r(D.length,2)+D}(this.dirRecords.length,x,f,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(f){this._sources.push(f);var y=this;return f.on("data",function(x){y.processChunk(x)}),f.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),f.on("error",function(x){y.error(x)}),this},d.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(f){var y=this._sources;if(!w.prototype.error.call(this,f))return!1;for(var x=0;x<y.length;x++)try{y[x].error(f)}catch{}return!0},d.prototype.lock=function(){w.prototype.lock.call(this);for(var f=this._sources,y=0;y<f.length;y++)f[y].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,o){var r=e("../compressions"),u=e("./ZipFileWorker");o.generateWorker=function(s,w,m){var v=new u(w.streamFiles,m,w.platform,w.encodeFileName),g=0;try{s.forEach(function(d,f){g++;var y=function(S,E){var M=S||E,T=r[M];if(!T)throw new Error(M+" is not a valid compression method !");return T}(f.options.compression,w.compression),x=f.options.compressionOptions||w.compressionOptions||{},k=f.dir,P=f.date;f._compressWorker(y,x).withStreamInfo("file",{name:d,dir:k,date:P,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(v)}),v.entriesCount=g}catch(d){v.error(d)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,o){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var u=new r;for(var s in this)typeof this[s]!="function"&&(u[s]=this[s]);return u}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(u,s){return new r().loadAsync(u,s)},r.external=e("./external"),n.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,o){var r=e("./utils"),u=e("./external"),s=e("./utf8"),w=e("./zipEntries"),m=e("./stream/Crc32Probe"),v=e("./nodejsUtils");function g(d){return new u.Promise(function(f,y){var x=d.decompressed.getContentWorker().pipe(new m);x.on("error",function(k){y(k)}).on("end",function(){x.streamInfo.crc32!==d.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}n.exports=function(d,f){var y=this;return f=r.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),v.isNode&&v.isStream(d)?u.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(x){var k=new w(f);return k.load(x),k}).then(function(x){var k=[u.Promise.resolve(x)],P=x.files;if(f.checkCRC32)for(var S=0;S<P.length;S++)k.push(g(P[S]));return u.Promise.all(k)}).then(function(x){for(var k=x.shift(),P=k.files,S=0;S<P.length;S++){var E=P[S],M=E.fileNameStr,T=r.resolve(E.fileNameStr);y.file(T,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:f.createFolders}),E.dir||(y.file(T).unsafeOriginalName=M)}return k.zipComment.length&&(y.comment=k.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,o){var r=e("../utils"),u=e("../stream/GenericWorker");function s(w,m){u.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(m)}r.inherits(s,u),s.prototype._bindStream=function(w){var m=this;(this._stream=w).pause(),w.on("data",function(v){m.push({data:v,meta:{percent:0}})}).on("error",function(v){m.isPaused?this.generatedError=v:m.error(v)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},s.prototype.pause=function(){return!!u.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,o){var r=e("readable-stream").Readable;function u(s,w,m){r.call(this,w),this._helper=s;var v=this;s.on("data",function(g,d){v.push(g)||v._helper.pause(),m&&m(d)}).on("error",function(g){v.emit("error",g)}).on("end",function(){v.push(null)})}e("../utils").inherits(u,r),u.prototype._read=function(){this._helper.resume()},n.exports=u},{"../utils":32,"readable-stream":16}],14:[function(e,n,o){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,u){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,u);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,u)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var u=new Buffer(r);return u.fill(0),u},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(e,n,o){function r(T,D,N){var I,O=s.getTypeOf(D),F=s.extend(N||{},v);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(T=P(T)),F.createFolders&&(I=k(T))&&S.call(this,I,!0);var q=O==="string"&&F.binary===!1&&F.base64===!1;N&&N.binary!==void 0||(F.binary=!q),(D instanceof g&&D.uncompressedSize===0||F.dir||!D||D.length===0)&&(F.base64=!1,F.binary=!0,D="",F.compression="STORE",O="string");var Y=null;Y=D instanceof g||D instanceof w?D:y.isNode&&y.isStream(D)?new x(T,D):s.prepareContent(T,D,F.binary,F.optimizedBinaryString,F.base64);var _e=new d(T,Y,F);this.files[T]=_e}var u=e("./utf8"),s=e("./utils"),w=e("./stream/GenericWorker"),m=e("./stream/StreamHelper"),v=e("./defaults"),g=e("./compressedObject"),d=e("./zipObject"),f=e("./generate"),y=e("./nodejsUtils"),x=e("./nodejs/NodejsStreamInputAdapter"),k=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var D=T.lastIndexOf("/");return 0<D?T.substring(0,D):""},P=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},S=function(T,D){return D=D!==void 0?D:v.createFolders,T=P(T),this.files[T]||r.call(this,T,null,{dir:!0,createFolders:D}),this.files[T]};function E(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var D,N,I;for(D in this.files)I=this.files[D],(N=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&T(N,I)},filter:function(T){var D=[];return this.forEach(function(N,I){T(N,I)&&D.push(I)}),D},file:function(T,D,N){if(arguments.length!==1)return T=this.root+T,r.call(this,T,D,N),this;if(E(T)){var I=T;return this.filter(function(F,q){return!q.dir&&I.test(F)})}var O=this.files[this.root+T];return O&&!O.dir?O:null},folder:function(T){if(!T)return this;if(E(T))return this.filter(function(O,F){return F.dir&&T.test(O)});var D=this.root+T,N=S.call(this,D),I=this.clone();return I.root=N.name,I},remove:function(T){T=this.root+T;var D=this.files[T];if(D||(T.slice(-1)!=="/"&&(T+="/"),D=this.files[T]),D&&!D.dir)delete this.files[T];else for(var N=this.filter(function(O,F){return F.name.slice(0,T.length)===T}),I=0;I<N.length;I++)delete this.files[N[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var D,N={};try{if((N=s.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:u.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");s.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var I=N.comment||this.comment||"";D=f.generateWorker(this,N,I)}catch(O){(D=new w("error")).error(O)}return new m(D,N.type||"string",N.mimeType)},generateAsync:function(T,D){return this.generateInternalStream(T).accumulate(D)},generateNodeStream:function(T,D){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(D)}};n.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,o){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,o){var r=e("./DataReader");function u(s){r.call(this,s);for(var w=0;w<this.data.length;w++)s[w]=255&s[w]}e("../utils").inherits(u,r),u.prototype.byteAt=function(s){return this.data[this.zero+s]},u.prototype.lastIndexOfSignature=function(s){for(var w=s.charCodeAt(0),m=s.charCodeAt(1),v=s.charCodeAt(2),g=s.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===w&&this.data[d+1]===m&&this.data[d+2]===v&&this.data[d+3]===g)return d-this.zero;return-1},u.prototype.readAndCheckSignature=function(s){var w=s.charCodeAt(0),m=s.charCodeAt(1),v=s.charCodeAt(2),g=s.charCodeAt(3),d=this.readData(4);return w===d[0]&&m===d[1]&&v===d[2]&&g===d[3]},u.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,w},n.exports=u},{"../utils":32,"./DataReader":18}],18:[function(e,n,o){var r=e("../utils");function u(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}u.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var w,m=0;for(this.checkOffset(s),w=this.index+s-1;w>=this.index;w--)m=(m<<8)+this.byteAt(w);return this.index+=s,m},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=u},{"../utils":32}],19:[function(e,n,o){var r=e("./Uint8ArrayReader");function u(s){r.call(this,s)}e("../utils").inherits(u,r),u.prototype.readData=function(s){this.checkOffset(s);var w=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,w},n.exports=u},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,o){var r=e("./DataReader");function u(s){r.call(this,s)}e("../utils").inherits(u,r),u.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},u.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},u.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},u.prototype.readData=function(s){this.checkOffset(s);var w=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,w},n.exports=u},{"../utils":32,"./DataReader":18}],21:[function(e,n,o){var r=e("./ArrayReader");function u(s){r.call(this,s)}e("../utils").inherits(u,r),u.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,w},n.exports=u},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,o){var r=e("../utils"),u=e("../support"),s=e("./ArrayReader"),w=e("./StringReader"),m=e("./NodeBufferReader"),v=e("./Uint8ArrayReader");n.exports=function(g){var d=r.getTypeOf(g);return r.checkSupport(d),d!=="string"||u.uint8array?d==="nodebuffer"?new m(g):u.uint8array?new v(r.transformTo("uint8array",g)):new s(r.transformTo("array",g)):new w(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,o){var r=e("./GenericWorker"),u=e("../utils");function s(w){r.call(this,"ConvertWorker to "+w),this.destType=w}u.inherits(s,r),s.prototype.processChunk=function(w){this.push({data:u.transformTo(this.destType,w.data),meta:w.meta})},n.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,o){var r=e("./GenericWorker"),u=e("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,r),s.prototype.processChunk=function(w){this.streamInfo.crc32=u(w.data,this.streamInfo.crc32||0),this.push(w)},n.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,o){var r=e("../utils"),u=e("./GenericWorker");function s(w){u.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}r.inherits(s,u),s.prototype.processChunk=function(w){if(w){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+w.data.length}u.prototype.processChunk.call(this,w)},n.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,o){var r=e("../utils"),u=e("./GenericWorker");function s(w){u.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then(function(v){m.dataIsReady=!0,m.data=v,m.max=v&&v.length||0,m.type=r.getTypeOf(v),m.isPaused||m._tickAndRepeat()},function(v){m.error(v)})}r.inherits(s,u),s.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,m);break;case"uint8array":w=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":w=this.data.slice(this.index,m)}return this.index=m,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,o){function r(u){this.name=u||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(u){this.emit("data",u)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(u){this.emit("error",u)}return!0},error:function(u){return!this.isFinished&&(this.isPaused?this.generatedError=u:(this.isFinished=!0,this.emit("error",u),this.previous&&this.previous.error(u),this.cleanUp()),!0)},on:function(u,s){return this._listeners[u].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(u,s){if(this._listeners[u])for(var w=0;w<this._listeners[u].length;w++)this._listeners[u][w].call(this,s)},pipe:function(u){return u.registerPrevious(this)},registerPrevious:function(u){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=u.streamInfo,this.mergeStreamInfo(),this.previous=u;var s=this;return u.on("data",function(w){s.processChunk(w)}),u.on("end",function(){s.end()}),u.on("error",function(w){s.error(w)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var u=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),u=!0),this.previous&&this.previous.resume(),!u},flush:function(){},processChunk:function(u){this.push(u)},withStreamInfo:function(u,s){return this.extraStreamInfo[u]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var u in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,u)&&(this.streamInfo[u]=this.extraStreamInfo[u])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var u="Worker "+this.name;return this.previous?this.previous+" -> "+u:u}},n.exports=r},{}],29:[function(e,n,o){var r=e("../utils"),u=e("./ConvertWorker"),s=e("./GenericWorker"),w=e("../base64"),m=e("../support"),v=e("../external"),g=null;if(m.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(y,x){return new v.Promise(function(k,P){var S=[],E=y._internalType,M=y._outputType,T=y._mimeType;y.on("data",function(D,N){S.push(D),x&&x(N)}).on("error",function(D){S=[],P(D)}).on("end",function(){try{var D=function(N,I,O){switch(N){case"blob":return r.newBlob(r.transformTo("arraybuffer",I),O);case"base64":return w.encode(I);default:return r.transformTo(N,I)}}(M,function(N,I){var O,F=0,q=null,Y=0;for(O=0;O<I.length;O++)Y+=I[O].length;switch(N){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(q=new Uint8Array(Y),O=0;O<I.length;O++)q.set(I[O],F),F+=I[O].length;return q;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+N+"'")}}(E,S),T);k(D)}catch(N){P(N)}S=[]}).resume()})}function f(y,x,k){var P=x;switch(x){case"blob":case"arraybuffer":P="uint8array";break;case"base64":P="string"}try{this._internalType=P,this._outputType=x,this._mimeType=k,r.checkSupport(P),this._worker=y.pipe(new u(P)),y.lock()}catch(S){this._worker=new s("error"),this._worker.error(S)}}f.prototype={accumulate:function(y){return d(this,y)},on:function(y,x){var k=this;return y==="data"?this._worker.on(y,function(P){x.call(k,P.data,P.meta)}):this._worker.on(y,function(){r.delay(x,arguments,k)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},y)}},n.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var r=new ArrayBuffer(0);try{o.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);u.append(r),o.blob=u.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!e("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,o){for(var r=e("./utils"),u=e("./support"),s=e("./nodejsUtils"),w=e("./stream/GenericWorker"),m=new Array(256),v=0;v<256;v++)m[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function g(){w.call(this,"utf-8 decode"),this.leftOver=null}function d(){w.call(this,"utf-8 encode")}m[254]=m[254]=1,o.utf8encode=function(f){return u.nodebuffer?s.newBufferFrom(f,"utf-8"):function(y){var x,k,P,S,E,M=y.length,T=0;for(S=0;S<M;S++)(64512&(k=y.charCodeAt(S)))==55296&&S+1<M&&(64512&(P=y.charCodeAt(S+1)))==56320&&(k=65536+(k-55296<<10)+(P-56320),S++),T+=k<128?1:k<2048?2:k<65536?3:4;for(x=u.uint8array?new Uint8Array(T):new Array(T),S=E=0;E<T;S++)(64512&(k=y.charCodeAt(S)))==55296&&S+1<M&&(64512&(P=y.charCodeAt(S+1)))==56320&&(k=65536+(k-55296<<10)+(P-56320),S++),k<128?x[E++]=k:(k<2048?x[E++]=192|k>>>6:(k<65536?x[E++]=224|k>>>12:(x[E++]=240|k>>>18,x[E++]=128|k>>>12&63),x[E++]=128|k>>>6&63),x[E++]=128|63&k);return x}(f)},o.utf8decode=function(f){return u.nodebuffer?r.transformTo("nodebuffer",f).toString("utf-8"):function(y){var x,k,P,S,E=y.length,M=new Array(2*E);for(x=k=0;x<E;)if((P=y[x++])<128)M[k++]=P;else if(4<(S=m[P]))M[k++]=65533,x+=S-1;else{for(P&=S===2?31:S===3?15:7;1<S&&x<E;)P=P<<6|63&y[x++],S--;1<S?M[k++]=65533:P<65536?M[k++]=P:(P-=65536,M[k++]=55296|P>>10&1023,M[k++]=56320|1023&P)}return M.length!==k&&(M.subarray?M=M.subarray(0,k):M.length=k),r.applyFromCharCode(M)}(f=r.transformTo(u.uint8array?"uint8array":"array",f))},r.inherits(g,w),g.prototype.processChunk=function(f){var y=r.transformTo(u.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var x=y;(y=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),y.set(x,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var k=function(S,E){var M;for((E=E||S.length)>S.length&&(E=S.length),M=E-1;0<=M&&(192&S[M])==128;)M--;return M<0||M===0?E:M+m[S[M]]>E?M:E}(y),P=y;k!==y.length&&(u.uint8array?(P=y.subarray(0,k),this.leftOver=y.subarray(k,y.length)):(P=y.slice(0,k),this.leftOver=y.slice(k,y.length))),this.push({data:o.utf8decode(P),meta:f.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=g,r.inherits(d,w),d.prototype.processChunk=function(f){this.push({data:o.utf8encode(f.data),meta:f.meta})},o.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,o){var r=e("./support"),u=e("./base64"),s=e("./nodejsUtils"),w=e("./external");function m(x){return x}function v(x,k){for(var P=0;P<x.length;++P)k[P]=255&x.charCodeAt(P);return k}e("setimmediate"),o.newBlob=function(x,k){o.checkSupport("blob");try{return new Blob([x],{type:k})}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return P.append(x),P.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(x,k,P){var S=[],E=0,M=x.length;if(M<=P)return String.fromCharCode.apply(null,x);for(;E<M;)k==="array"||k==="nodebuffer"?S.push(String.fromCharCode.apply(null,x.slice(E,Math.min(E+P,M)))):S.push(String.fromCharCode.apply(null,x.subarray(E,Math.min(E+P,M)))),E+=P;return S.join("")},stringifyByChar:function(x){for(var k="",P=0;P<x.length;P++)k+=String.fromCharCode(x[P]);return k},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function d(x){var k=65536,P=o.getTypeOf(x),S=!0;if(P==="uint8array"?S=g.applyCanBeUsed.uint8array:P==="nodebuffer"&&(S=g.applyCanBeUsed.nodebuffer),S)for(;1<k;)try{return g.stringifyByChunk(x,P,k)}catch{k=Math.floor(k/2)}return g.stringifyByChar(x)}function f(x,k){for(var P=0;P<x.length;P++)k[P]=x[P];return k}o.applyFromCharCode=d;var y={};y.string={string:m,array:function(x){return v(x,new Array(x.length))},arraybuffer:function(x){return y.string.uint8array(x).buffer},uint8array:function(x){return v(x,new Uint8Array(x.length))},nodebuffer:function(x){return v(x,s.allocBuffer(x.length))}},y.array={string:d,array:m,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return s.newBufferFrom(x)}},y.arraybuffer={string:function(x){return d(new Uint8Array(x))},array:function(x){return f(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:m,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return s.newBufferFrom(new Uint8Array(x))}},y.uint8array={string:d,array:function(x){return f(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:m,nodebuffer:function(x){return s.newBufferFrom(x)}},y.nodebuffer={string:d,array:function(x){return f(x,new Array(x.length))},arraybuffer:function(x){return y.nodebuffer.uint8array(x).buffer},uint8array:function(x){return f(x,new Uint8Array(x.length))},nodebuffer:m},o.transformTo=function(x,k){if(k=k||"",!x)return k;o.checkSupport(x);var P=o.getTypeOf(k);return y[P][x](k)},o.resolve=function(x){for(var k=x.split("/"),P=[],S=0;S<k.length;S++){var E=k[S];E==="."||E===""&&S!==0&&S!==k.length-1||(E===".."?P.pop():P.push(E))}return P.join("/")},o.getTypeOf=function(x){return typeof x=="string"?"string":Object.prototype.toString.call(x)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(x)?"nodebuffer":r.uint8array&&x instanceof Uint8Array?"uint8array":r.arraybuffer&&x instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(x){if(!r[x.toLowerCase()])throw new Error(x+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(x){var k,P,S="";for(P=0;P<(x||"").length;P++)S+="\\x"+((k=x.charCodeAt(P))<16?"0":"")+k.toString(16).toUpperCase();return S},o.delay=function(x,k,P){setImmediate(function(){x.apply(P||null,k||[])})},o.inherits=function(x,k){function P(){}P.prototype=k.prototype,x.prototype=new P},o.extend=function(){var x,k,P={};for(x=0;x<arguments.length;x++)for(k in arguments[x])Object.prototype.hasOwnProperty.call(arguments[x],k)&&P[k]===void 0&&(P[k]=arguments[x][k]);return P},o.prepareContent=function(x,k,P,S,E){return w.Promise.resolve(k).then(function(M){return r.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new w.Promise(function(T,D){var N=new FileReader;N.onload=function(I){T(I.target.result)},N.onerror=function(I){D(I.target.error)},N.readAsArrayBuffer(M)}):M}).then(function(M){var T=o.getTypeOf(M);return T?(T==="arraybuffer"?M=o.transformTo("uint8array",M):T==="string"&&(E?M=u.decode(M):P&&S!==!0&&(M=function(D){return v(D,r.uint8array?new Uint8Array(D.length):new Array(D.length))}(M))),M):w.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,o){var r=e("./reader/readerFor"),u=e("./utils"),s=e("./signature"),w=e("./zipEntry"),m=e("./support");function v(g){this.files=[],this.loadOptions=g}v.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+u.pretty(d)+", expected "+u.pretty(g)+")")}},isSignature:function(g,d){var f=this.reader.index;this.reader.setIndex(g);var y=this.reader.readString(4)===d;return this.reader.setIndex(f),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),d=m.uint8array?"uint8array":"array",f=u.transformTo(d,g);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,d,f,y=this.zip64EndOfCentralSize-44;0<y;)g=this.reader.readInt(2),d=this.reader.readInt(4),f=this.reader.readData(d),this.zip64ExtensibleData[g]={id:g,length:d,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,d;for(g=0;g<this.files.length;g++)d=this.files[g],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(g=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var d=g;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===u.MAX_VALUE_16BITS||this.diskWithCentralDirStart===u.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===u.MAX_VALUE_16BITS||this.centralDirRecords===u.MAX_VALUE_16BITS||this.centralDirSize===u.MAX_VALUE_32BITS||this.centralDirOffset===u.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var y=d-f;if(0<y)this.isSignature(d,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(g){this.reader=r(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,o){var r=e("./reader/readerFor"),u=e("./utils"),s=e("./compressedObject"),w=e("./crc32"),m=e("./utf8"),v=e("./compressions"),g=e("./support");function d(f,y){this.options=f,this.loadOptions=y}d.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(f){var y,x;if(f.skip(22),this.fileNameLength=f.readInt(2),x=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(k){for(var P in v)if(Object.prototype.hasOwnProperty.call(v,P)&&v[P].magic===k)return v[P];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+u.pretty(this.compressionMethod)+" unknown (inner file : "+u.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var y=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(y),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=r(this.extraFields[1].value);this.uncompressedSize===u.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===u.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===u.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===u.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var y,x,k,P=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<P;)y=f.readInt(2),x=f.readInt(2),k=f.readData(x),this.extraFields[y]={id:y,length:x,value:k};f.setIndex(P)},handleUTF8:function(){var f=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var x=u.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var k=this.findExtraFieldUnicodeComment();if(k!==null)this.fileCommentStr=k;else{var P=u.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var y=r(f.value);return y.readInt(1)!==1||w(this.fileName)!==y.readInt(4)?null:m.utf8decode(y.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var y=r(f.value);return y.readInt(1)!==1||w(this.fileComment)!==y.readInt(4)?null:m.utf8decode(y.readData(f.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,o){function r(y,x,k){this.name=y,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=x,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var u=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),w=e("./utf8"),m=e("./compressedObject"),v=e("./stream/GenericWorker");r.prototype={internalStream:function(y){var x=null,k="string";try{if(!y)throw new Error("No output type specified.");var P=(k=y.toLowerCase())==="string"||k==="text";k!=="binarystring"&&k!=="text"||(k="string"),x=this._decompressWorker();var S=!this._dataBinary;S&&!P&&(x=x.pipe(new w.Utf8EncodeWorker)),!S&&P&&(x=x.pipe(new w.Utf8DecodeWorker))}catch(E){(x=new v("error")).error(E)}return new u(x,k,"")},async:function(y,x){return this.internalStream(y).accumulate(x)},nodeStream:function(y,x){return this.internalStream(y||"nodebuffer").toNodejsStream(x)},_compressWorker:function(y,x){if(this._data instanceof m&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new w.Utf8EncodeWorker)),m.createWorkerFrom(k,y,x)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof v?this._data:new s(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<g.length;f++)r.prototype[g[f]]=d;n.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,o){(function(r){var u,s,w=r.MutationObserver||r.WebKitMutationObserver;if(w){var m=0,v=new w(y),g=r.document.createTextNode("");v.observe(g,{characterData:!0}),u=function(){g.data=m=++m%2}}else if(r.setImmediate||r.MessageChannel===void 0)u="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var x=r.document.createElement("script");x.onreadystatechange=function(){y(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},r.document.documentElement.appendChild(x)}:function(){setTimeout(y,0)};else{var d=new r.MessageChannel;d.port1.onmessage=y,u=function(){d.port2.postMessage(0)}}var f=[];function y(){var x,k;s=!0;for(var P=f.length;P;){for(k=f,f=[],x=-1;++x<P;)k[x]();P=f.length}s=!1}n.exports=function(x){f.push(x)!==1||s||u()}}).call(this,commonjsGlobal$1!==void 0?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,o){var r=e("immediate");function u(){}var s={},w=["REJECTED"],m=["FULFILLED"],v=["PENDING"];function g(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,P!==u&&x(this,P)}function d(P,S,E){this.promise=P,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function f(P,S,E){r(function(){var M;try{M=S(E)}catch(T){return s.reject(P,T)}M===P?s.reject(P,new TypeError("Cannot resolve promise with itself")):s.resolve(P,M)})}function y(P){var S=P&&P.then;if(P&&(_typeof$1(P)=="object"||typeof P=="function")&&typeof S=="function")return function(){S.apply(P,arguments)}}function x(P,S){var E=!1;function M(N){E||(E=!0,s.reject(P,N))}function T(N){E||(E=!0,s.resolve(P,N))}var D=k(function(){S(T,M)});D.status==="error"&&M(D.value)}function k(P,S){var E={};try{E.value=P(S),E.status="success"}catch(M){E.status="error",E.value=M}return E}(n.exports=g).prototype.finally=function(P){if(typeof P!="function")return this;var S=this.constructor;return this.then(function(E){return S.resolve(P()).then(function(){return E})},function(E){return S.resolve(P()).then(function(){throw E})})},g.prototype.catch=function(P){return this.then(null,P)},g.prototype.then=function(P,S){if(typeof P!="function"&&this.state===m||typeof S!="function"&&this.state===w)return this;var E=new this.constructor(u);return this.state!==v?f(E,this.state===m?P:S,this.outcome):this.queue.push(new d(E,P,S)),E},d.prototype.callFulfilled=function(P){s.resolve(this.promise,P)},d.prototype.otherCallFulfilled=function(P){f(this.promise,this.onFulfilled,P)},d.prototype.callRejected=function(P){s.reject(this.promise,P)},d.prototype.otherCallRejected=function(P){f(this.promise,this.onRejected,P)},s.resolve=function(P,S){var E=k(y,S);if(E.status==="error")return s.reject(P,E.value);var M=E.value;if(M)x(P,M);else{P.state=m,P.outcome=S;for(var T=-1,D=P.queue.length;++T<D;)P.queue[T].callFulfilled(S)}return P},s.reject=function(P,S){P.state=w,P.outcome=S;for(var E=-1,M=P.queue.length;++E<M;)P.queue[E].callRejected(S);return P},g.resolve=function(P){return P instanceof this?P:s.resolve(new this(u),P)},g.reject=function(P){var S=new this(u);return s.reject(S,P)},g.all=function(P){var S=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=P.length,M=!1;if(!E)return this.resolve([]);for(var T=new Array(E),D=0,N=-1,I=new this(u);++N<E;)O(P[N],N);return I;function O(F,q){S.resolve(F).then(function(Y){T[q]=Y,++D!==E||M||(M=!0,s.resolve(I,T))},function(Y){M||(M=!0,s.reject(I,Y))})}},g.race=function(P){var S=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=P.length,M=!1;if(!E)return this.resolve([]);for(var T,D=-1,N=new this(u);++D<E;)T=P[D],S.resolve(T).then(function(I){M||(M=!0,s.resolve(N,I))},function(I){M||(M=!0,s.reject(N,I))});return N}},{immediate:36}],38:[function(e,n,o){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,o){var r=e("./zlib/deflate"),u=e("./utils/common"),s=e("./utils/strings"),w=e("./zlib/messages"),m=e("./zlib/zstream"),v=Object.prototype.toString,g=0,d=-1,f=0,y=8;function x(P){if(!(this instanceof x))return new x(P);this.options=u.assign({level:d,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},P||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var E=r.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(E!==g)throw new Error(w[E]);if(S.header&&r.deflateSetHeader(this.strm,S.header),S.dictionary){var M;if(M=typeof S.dictionary=="string"?s.string2buf(S.dictionary):v.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(E=r.deflateSetDictionary(this.strm,M))!==g)throw new Error(w[E]);this._dict_set=!0}}function k(P,S){var E=new x(S);if(E.push(P,!0),E.err)throw E.msg||w[E.err];return E.result}x.prototype.push=function(P,S){var E,M,T=this.strm,D=this.options.chunkSize;if(this.ended)return!1;M=S===~~S?S:S===!0?4:0,typeof P=="string"?T.input=s.string2buf(P):v.call(P)==="[object ArrayBuffer]"?T.input=new Uint8Array(P):T.input=P,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new u.Buf8(D),T.next_out=0,T.avail_out=D),(E=r.deflate(T,M))!==1&&E!==g)return this.onEnd(E),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(u.shrinkBuf(T.output,T.next_out))):this.onData(u.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&E!==1);return M===4?(E=r.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===g):M!==2||(this.onEnd(g),!(T.avail_out=0))},x.prototype.onData=function(P){this.chunks.push(P)},x.prototype.onEnd=function(P){P===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},o.Deflate=x,o.deflate=k,o.deflateRaw=function(P,S){return(S=S||{}).raw=!0,k(P,S)},o.gzip=function(P,S){return(S=S||{}).gzip=!0,k(P,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,o){var r=e("./zlib/inflate"),u=e("./utils/common"),s=e("./utils/strings"),w=e("./zlib/constants"),m=e("./zlib/messages"),v=e("./zlib/zstream"),g=e("./zlib/gzheader"),d=Object.prototype.toString;function f(x){if(!(this instanceof f))return new f(x);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},x||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||x&&x.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&!(15&k.windowBits)&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var P=r.inflateInit2(this.strm,k.windowBits);if(P!==w.Z_OK)throw new Error(m[P]);this.header=new g,r.inflateGetHeader(this.strm,this.header)}function y(x,k){var P=new f(k);if(P.push(x,!0),P.err)throw P.msg||m[P.err];return P.result}f.prototype.push=function(x,k){var P,S,E,M,T,D,N=this.strm,I=this.options.chunkSize,O=this.options.dictionary,F=!1;if(this.ended)return!1;S=k===~~k?k:k===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof x=="string"?N.input=s.binstring2buf(x):d.call(x)==="[object ArrayBuffer]"?N.input=new Uint8Array(x):N.input=x,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new u.Buf8(I),N.next_out=0,N.avail_out=I),(P=r.inflate(N,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&O&&(D=typeof O=="string"?s.string2buf(O):d.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,P=r.inflateSetDictionary(this.strm,D)),P===w.Z_BUF_ERROR&&F===!0&&(P=w.Z_OK,F=!1),P!==w.Z_STREAM_END&&P!==w.Z_OK)return this.onEnd(P),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&P!==w.Z_STREAM_END&&(N.avail_in!==0||S!==w.Z_FINISH&&S!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=s.utf8border(N.output,N.next_out),M=N.next_out-E,T=s.buf2string(N.output,E),N.next_out=M,N.avail_out=I-M,M&&u.arraySet(N.output,N.output,E,M,0),this.onData(T)):this.onData(u.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(F=!0)}while((0<N.avail_in||N.avail_out===0)&&P!==w.Z_STREAM_END);return P===w.Z_STREAM_END&&(S=w.Z_FINISH),S===w.Z_FINISH?(P=r.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===w.Z_OK):S!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(N.avail_out=0))},f.prototype.onData=function(x){this.chunks.push(x)},f.prototype.onEnd=function(x){x===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},o.Inflate=f,o.inflate=y,o.inflateRaw=function(x,k){return(k=k||{}).raw=!0,y(x,k)},o.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(w){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var v=m.shift();if(v){if(_typeof$1(v)!="object")throw new TypeError(v+"must be non-object");for(var g in v)v.hasOwnProperty(g)&&(w[g]=v[g])}}return w},o.shrinkBuf=function(w,m){return w.length===m?w:w.subarray?w.subarray(0,m):(w.length=m,w)};var u={arraySet:function(w,m,v,g,d){if(m.subarray&&w.subarray)w.set(m.subarray(v,v+g),d);else for(var f=0;f<g;f++)w[d+f]=m[v+f]},flattenChunks:function(w){var m,v,g,d,f,y;for(m=g=0,v=w.length;m<v;m++)g+=w[m].length;for(y=new Uint8Array(g),m=d=0,v=w.length;m<v;m++)f=w[m],y.set(f,d),d+=f.length;return y}},s={arraySet:function(w,m,v,g,d){for(var f=0;f<g;f++)w[d+f]=m[v+f]},flattenChunks:function(w){return[].concat.apply([],w)}};o.setTyped=function(w){w?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,u)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(r)},{}],42:[function(e,n,o){var r=e("./common"),u=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var w=new r.Buf8(256),m=0;m<256;m++)w[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function v(g,d){if(d<65537&&(g.subarray&&s||!g.subarray&&u))return String.fromCharCode.apply(null,r.shrinkBuf(g,d));for(var f="",y=0;y<d;y++)f+=String.fromCharCode(g[y]);return f}w[254]=w[254]=1,o.string2buf=function(g){var d,f,y,x,k,P=g.length,S=0;for(x=0;x<P;x++)(64512&(f=g.charCodeAt(x)))==55296&&x+1<P&&(64512&(y=g.charCodeAt(x+1)))==56320&&(f=65536+(f-55296<<10)+(y-56320),x++),S+=f<128?1:f<2048?2:f<65536?3:4;for(d=new r.Buf8(S),x=k=0;k<S;x++)(64512&(f=g.charCodeAt(x)))==55296&&x+1<P&&(64512&(y=g.charCodeAt(x+1)))==56320&&(f=65536+(f-55296<<10)+(y-56320),x++),f<128?d[k++]=f:(f<2048?d[k++]=192|f>>>6:(f<65536?d[k++]=224|f>>>12:(d[k++]=240|f>>>18,d[k++]=128|f>>>12&63),d[k++]=128|f>>>6&63),d[k++]=128|63&f);return d},o.buf2binstring=function(g){return v(g,g.length)},o.binstring2buf=function(g){for(var d=new r.Buf8(g.length),f=0,y=d.length;f<y;f++)d[f]=g.charCodeAt(f);return d},o.buf2string=function(g,d){var f,y,x,k,P=d||g.length,S=new Array(2*P);for(f=y=0;f<P;)if((x=g[f++])<128)S[y++]=x;else if(4<(k=w[x]))S[y++]=65533,f+=k-1;else{for(x&=k===2?31:k===3?15:7;1<k&&f<P;)x=x<<6|63&g[f++],k--;1<k?S[y++]=65533:x<65536?S[y++]=x:(x-=65536,S[y++]=55296|x>>10&1023,S[y++]=56320|1023&x)}return v(S,y)},o.utf8border=function(g,d){var f;for((d=d||g.length)>g.length&&(d=g.length),f=d-1;0<=f&&(192&g[f])==128;)f--;return f<0||f===0?d:f+w[g[f]]>d?f:d}},{"./common":41}],43:[function(e,n,o){n.exports=function(r,u,s,w){for(var m=65535&r,v=r>>>16&65535,g=0;s!==0;){for(s-=g=2e3<s?2e3:s;v=v+(m=m+u[w++]|0)|0,--g;);m%=65521,v%=65521}return m|v<<16}},{}],44:[function(e,n,o){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,o){var r=function(){for(var u,s=[],w=0;w<256;w++){u=w;for(var m=0;m<8;m++)u=1&u?3988292384^u>>>1:u>>>1;s[w]=u}return s}();n.exports=function(u,s,w,m){var v=r,g=m+w;u^=-1;for(var d=m;d<g;d++)u=u>>>8^v[255&(u^s[d])];return~u}},{}],46:[function(e,n,o){var r,u=e("../utils/common"),s=e("./trees"),w=e("./adler32"),m=e("./crc32"),v=e("./messages"),g=0,d=4,f=0,y=-2,x=-1,k=4,P=2,S=8,E=9,M=286,T=30,D=19,N=2*M+1,I=15,O=3,F=258,q=F+O+1,Y=42,_e=113,ne=1,ve=2,J=3,fe=4;function Z(le,oe){return le.msg=v[oe],oe}function j(le){return(le<<1)-(4<le?9:0)}function X(le){for(var oe=le.length;0<=--oe;)le[oe]=0}function H(le){var oe=le.state,ke=oe.pending;ke>le.avail_out&&(ke=le.avail_out),ke!==0&&(u.arraySet(le.output,oe.pending_buf,oe.pending_out,ke,le.next_out),le.next_out+=ke,oe.pending_out+=ke,le.total_out+=ke,le.avail_out-=ke,oe.pending-=ke,oe.pending===0&&(oe.pending_out=0))}function U(le,oe){s._tr_flush_block(le,0<=le.block_start?le.block_start:-1,le.strstart-le.block_start,oe),le.block_start=le.strstart,H(le.strm)}function te(le,oe){le.pending_buf[le.pending++]=oe}function Q(le,oe){le.pending_buf[le.pending++]=oe>>>8&255,le.pending_buf[le.pending++]=255&oe}function re(le,oe){var ke,Ce,Ee=le.max_chain_length,Be=le.strstart,Ve=le.prev_length,Oe=le.nice_match,je=le.strstart>le.w_size-q?le.strstart-(le.w_size-q):0,Ge=le.window,Xe=le.w_mask,qe=le.prev,Ke=le.strstart+F,Je=Ge[Be+Ve-1],rt=Ge[Be+Ve];le.prev_length>=le.good_match&&(Ee>>=2),Oe>le.lookahead&&(Oe=le.lookahead);do if(Ge[(ke=oe)+Ve]===rt&&Ge[ke+Ve-1]===Je&&Ge[ke]===Ge[Be]&&Ge[++ke]===Ge[Be+1]){Be+=2,ke++;do;while(Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Ge[++Be]===Ge[++ke]&&Be<Ke);if(Ce=F-(Ke-Be),Be=Ke-F,Ve<Ce){if(le.match_start=oe,Oe<=(Ve=Ce))break;Je=Ge[Be+Ve-1],rt=Ge[Be+Ve]}}while((oe=qe[oe&Xe])>je&&--Ee!=0);return Ve<=le.lookahead?Ve:le.lookahead}function Pe(le){var oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe=le.w_size;do{if(Ee=le.window_size-le.lookahead-le.strstart,le.strstart>=qe+(qe-q)){for(u.arraySet(le.window,le.window,qe,qe,0),le.match_start-=qe,le.strstart-=qe,le.block_start-=qe,oe=ke=le.hash_size;Ce=le.head[--oe],le.head[oe]=qe<=Ce?Ce-qe:0,--ke;);for(oe=ke=qe;Ce=le.prev[--oe],le.prev[oe]=qe<=Ce?Ce-qe:0,--ke;);Ee+=qe}if(le.strm.avail_in===0)break;if(Ve=le.strm,Oe=le.window,je=le.strstart+le.lookahead,Xe=void 0,(Ge=Ee)<(Xe=Ve.avail_in)&&(Xe=Ge),ke=Xe===0?0:(Ve.avail_in-=Xe,u.arraySet(Oe,Ve.input,Ve.next_in,Xe,je),Ve.state.wrap===1?Ve.adler=w(Ve.adler,Oe,Xe,je):Ve.state.wrap===2&&(Ve.adler=m(Ve.adler,Oe,Xe,je)),Ve.next_in+=Xe,Ve.total_in+=Xe,Xe),le.lookahead+=ke,le.lookahead+le.insert>=O)for(Be=le.strstart-le.insert,le.ins_h=le.window[Be],le.ins_h=(le.ins_h<<le.hash_shift^le.window[Be+1])&le.hash_mask;le.insert&&(le.ins_h=(le.ins_h<<le.hash_shift^le.window[Be+O-1])&le.hash_mask,le.prev[Be&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=Be,Be++,le.insert--,!(le.lookahead+le.insert<O)););}while(le.lookahead<q&&le.strm.avail_in!==0)}function be(le,oe){for(var ke,Ce;;){if(le.lookahead<q){if(Pe(le),le.lookahead<q&&oe===g)return ne;if(le.lookahead===0)break}if(ke=0,le.lookahead>=O&&(le.ins_h=(le.ins_h<<le.hash_shift^le.window[le.strstart+O-1])&le.hash_mask,ke=le.prev[le.strstart&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=le.strstart),ke!==0&&le.strstart-ke<=le.w_size-q&&(le.match_length=re(le,ke)),le.match_length>=O)if(Ce=s._tr_tally(le,le.strstart-le.match_start,le.match_length-O),le.lookahead-=le.match_length,le.match_length<=le.max_lazy_match&&le.lookahead>=O){for(le.match_length--;le.strstart++,le.ins_h=(le.ins_h<<le.hash_shift^le.window[le.strstart+O-1])&le.hash_mask,ke=le.prev[le.strstart&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=le.strstart,--le.match_length!=0;);le.strstart++}else le.strstart+=le.match_length,le.match_length=0,le.ins_h=le.window[le.strstart],le.ins_h=(le.ins_h<<le.hash_shift^le.window[le.strstart+1])&le.hash_mask;else Ce=s._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++;if(Ce&&(U(le,!1),le.strm.avail_out===0))return ne}return le.insert=le.strstart<O-1?le.strstart:O-1,oe===d?(U(le,!0),le.strm.avail_out===0?J:fe):le.last_lit&&(U(le,!1),le.strm.avail_out===0)?ne:ve}function we(le,oe){for(var ke,Ce,Ee;;){if(le.lookahead<q){if(Pe(le),le.lookahead<q&&oe===g)return ne;if(le.lookahead===0)break}if(ke=0,le.lookahead>=O&&(le.ins_h=(le.ins_h<<le.hash_shift^le.window[le.strstart+O-1])&le.hash_mask,ke=le.prev[le.strstart&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=le.strstart),le.prev_length=le.match_length,le.prev_match=le.match_start,le.match_length=O-1,ke!==0&&le.prev_length<le.max_lazy_match&&le.strstart-ke<=le.w_size-q&&(le.match_length=re(le,ke),le.match_length<=5&&(le.strategy===1||le.match_length===O&&4096<le.strstart-le.match_start)&&(le.match_length=O-1)),le.prev_length>=O&&le.match_length<=le.prev_length){for(Ee=le.strstart+le.lookahead-O,Ce=s._tr_tally(le,le.strstart-1-le.prev_match,le.prev_length-O),le.lookahead-=le.prev_length-1,le.prev_length-=2;++le.strstart<=Ee&&(le.ins_h=(le.ins_h<<le.hash_shift^le.window[le.strstart+O-1])&le.hash_mask,ke=le.prev[le.strstart&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=le.strstart),--le.prev_length!=0;);if(le.match_available=0,le.match_length=O-1,le.strstart++,Ce&&(U(le,!1),le.strm.avail_out===0))return ne}else if(le.match_available){if((Ce=s._tr_tally(le,0,le.window[le.strstart-1]))&&U(le,!1),le.strstart++,le.lookahead--,le.strm.avail_out===0)return ne}else le.match_available=1,le.strstart++,le.lookahead--}return le.match_available&&(Ce=s._tr_tally(le,0,le.window[le.strstart-1]),le.match_available=0),le.insert=le.strstart<O-1?le.strstart:O-1,oe===d?(U(le,!0),le.strm.avail_out===0?J:fe):le.last_lit&&(U(le,!1),le.strm.avail_out===0)?ne:ve}function Ae(le,oe,ke,Ce,Ee){this.good_length=le,this.max_lazy=oe,this.nice_length=ke,this.max_chain=Ce,this.func=Ee}function $e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(2*N),this.dyn_dtree=new u.Buf16(2*(2*T+1)),this.bl_tree=new u.Buf16(2*(2*D+1)),X(this.dyn_ltree),X(this.dyn_dtree),X(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(I+1),this.heap=new u.Buf16(2*M+1),X(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*M+1),X(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Me(le){var oe;return le&&le.state?(le.total_in=le.total_out=0,le.data_type=P,(oe=le.state).pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?Y:_e,le.adler=oe.wrap===2?0:1,oe.last_flush=g,s._tr_init(oe),f):Z(le,y)}function Ie(le){var oe=Me(le);return oe===f&&function(ke){ke.window_size=2*ke.w_size,X(ke.head),ke.max_lazy_match=r[ke.level].max_lazy,ke.good_match=r[ke.level].good_length,ke.nice_match=r[ke.level].nice_length,ke.max_chain_length=r[ke.level].max_chain,ke.strstart=0,ke.block_start=0,ke.lookahead=0,ke.insert=0,ke.match_length=ke.prev_length=O-1,ke.match_available=0,ke.ins_h=0}(le.state),oe}function Le(le,oe,ke,Ce,Ee,Be){if(!le)return y;var Ve=1;if(oe===x&&(oe=6),Ce<0?(Ve=0,Ce=-Ce):15<Ce&&(Ve=2,Ce-=16),Ee<1||E<Ee||ke!==S||Ce<8||15<Ce||oe<0||9<oe||Be<0||k<Be)return Z(le,y);Ce===8&&(Ce=9);var Oe=new $e;return(le.state=Oe).strm=le,Oe.wrap=Ve,Oe.gzhead=null,Oe.w_bits=Ce,Oe.w_size=1<<Oe.w_bits,Oe.w_mask=Oe.w_size-1,Oe.hash_bits=Ee+7,Oe.hash_size=1<<Oe.hash_bits,Oe.hash_mask=Oe.hash_size-1,Oe.hash_shift=~~((Oe.hash_bits+O-1)/O),Oe.window=new u.Buf8(2*Oe.w_size),Oe.head=new u.Buf16(Oe.hash_size),Oe.prev=new u.Buf16(Oe.w_size),Oe.lit_bufsize=1<<Ee+6,Oe.pending_buf_size=4*Oe.lit_bufsize,Oe.pending_buf=new u.Buf8(Oe.pending_buf_size),Oe.d_buf=1*Oe.lit_bufsize,Oe.l_buf=3*Oe.lit_bufsize,Oe.level=oe,Oe.strategy=Be,Oe.method=ke,Ie(le)}r=[new Ae(0,0,0,0,function(le,oe){var ke=65535;for(ke>le.pending_buf_size-5&&(ke=le.pending_buf_size-5);;){if(le.lookahead<=1){if(Pe(le),le.lookahead===0&&oe===g)return ne;if(le.lookahead===0)break}le.strstart+=le.lookahead,le.lookahead=0;var Ce=le.block_start+ke;if((le.strstart===0||le.strstart>=Ce)&&(le.lookahead=le.strstart-Ce,le.strstart=Ce,U(le,!1),le.strm.avail_out===0)||le.strstart-le.block_start>=le.w_size-q&&(U(le,!1),le.strm.avail_out===0))return ne}return le.insert=0,oe===d?(U(le,!0),le.strm.avail_out===0?J:fe):(le.strstart>le.block_start&&(U(le,!1),le.strm.avail_out),ne)}),new Ae(4,4,8,4,be),new Ae(4,5,16,8,be),new Ae(4,6,32,32,be),new Ae(4,4,16,16,we),new Ae(8,16,32,32,we),new Ae(8,16,128,128,we),new Ae(8,32,128,256,we),new Ae(32,128,258,1024,we),new Ae(32,258,258,4096,we)],o.deflateInit=function(le,oe){return Le(le,oe,S,15,8,0)},o.deflateInit2=Le,o.deflateReset=Ie,o.deflateResetKeep=Me,o.deflateSetHeader=function(le,oe){return le&&le.state?le.state.wrap!==2?y:(le.state.gzhead=oe,f):y},o.deflate=function(le,oe){var ke,Ce,Ee,Be;if(!le||!le.state||5<oe||oe<0)return le?Z(le,y):y;if(Ce=le.state,!le.output||!le.input&&le.avail_in!==0||Ce.status===666&&oe!==d)return Z(le,le.avail_out===0?-5:y);if(Ce.strm=le,ke=Ce.last_flush,Ce.last_flush=oe,Ce.status===Y)if(Ce.wrap===2)le.adler=0,te(Ce,31),te(Ce,139),te(Ce,8),Ce.gzhead?(te(Ce,(Ce.gzhead.text?1:0)+(Ce.gzhead.hcrc?2:0)+(Ce.gzhead.extra?4:0)+(Ce.gzhead.name?8:0)+(Ce.gzhead.comment?16:0)),te(Ce,255&Ce.gzhead.time),te(Ce,Ce.gzhead.time>>8&255),te(Ce,Ce.gzhead.time>>16&255),te(Ce,Ce.gzhead.time>>24&255),te(Ce,Ce.level===9?2:2<=Ce.strategy||Ce.level<2?4:0),te(Ce,255&Ce.gzhead.os),Ce.gzhead.extra&&Ce.gzhead.extra.length&&(te(Ce,255&Ce.gzhead.extra.length),te(Ce,Ce.gzhead.extra.length>>8&255)),Ce.gzhead.hcrc&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending,0)),Ce.gzindex=0,Ce.status=69):(te(Ce,0),te(Ce,0),te(Ce,0),te(Ce,0),te(Ce,0),te(Ce,Ce.level===9?2:2<=Ce.strategy||Ce.level<2?4:0),te(Ce,3),Ce.status=_e);else{var Ve=S+(Ce.w_bits-8<<4)<<8;Ve|=(2<=Ce.strategy||Ce.level<2?0:Ce.level<6?1:Ce.level===6?2:3)<<6,Ce.strstart!==0&&(Ve|=32),Ve+=31-Ve%31,Ce.status=_e,Q(Ce,Ve),Ce.strstart!==0&&(Q(Ce,le.adler>>>16),Q(Ce,65535&le.adler)),le.adler=1}if(Ce.status===69)if(Ce.gzhead.extra){for(Ee=Ce.pending;Ce.gzindex<(65535&Ce.gzhead.extra.length)&&(Ce.pending!==Ce.pending_buf_size||(Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),H(le),Ee=Ce.pending,Ce.pending!==Ce.pending_buf_size));)te(Ce,255&Ce.gzhead.extra[Ce.gzindex]),Ce.gzindex++;Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),Ce.gzindex===Ce.gzhead.extra.length&&(Ce.gzindex=0,Ce.status=73)}else Ce.status=73;if(Ce.status===73)if(Ce.gzhead.name){Ee=Ce.pending;do{if(Ce.pending===Ce.pending_buf_size&&(Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),H(le),Ee=Ce.pending,Ce.pending===Ce.pending_buf_size)){Be=1;break}Be=Ce.gzindex<Ce.gzhead.name.length?255&Ce.gzhead.name.charCodeAt(Ce.gzindex++):0,te(Ce,Be)}while(Be!==0);Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),Be===0&&(Ce.gzindex=0,Ce.status=91)}else Ce.status=91;if(Ce.status===91)if(Ce.gzhead.comment){Ee=Ce.pending;do{if(Ce.pending===Ce.pending_buf_size&&(Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),H(le),Ee=Ce.pending,Ce.pending===Ce.pending_buf_size)){Be=1;break}Be=Ce.gzindex<Ce.gzhead.comment.length?255&Ce.gzhead.comment.charCodeAt(Ce.gzindex++):0,te(Ce,Be)}while(Be!==0);Ce.gzhead.hcrc&&Ce.pending>Ee&&(le.adler=m(le.adler,Ce.pending_buf,Ce.pending-Ee,Ee)),Be===0&&(Ce.status=103)}else Ce.status=103;if(Ce.status===103&&(Ce.gzhead.hcrc?(Ce.pending+2>Ce.pending_buf_size&&H(le),Ce.pending+2<=Ce.pending_buf_size&&(te(Ce,255&le.adler),te(Ce,le.adler>>8&255),le.adler=0,Ce.status=_e)):Ce.status=_e),Ce.pending!==0){if(H(le),le.avail_out===0)return Ce.last_flush=-1,f}else if(le.avail_in===0&&j(oe)<=j(ke)&&oe!==d)return Z(le,-5);if(Ce.status===666&&le.avail_in!==0)return Z(le,-5);if(le.avail_in!==0||Ce.lookahead!==0||oe!==g&&Ce.status!==666){var Oe=Ce.strategy===2?function(je,Ge){for(var Xe;;){if(je.lookahead===0&&(Pe(je),je.lookahead===0)){if(Ge===g)return ne;break}if(je.match_length=0,Xe=s._tr_tally(je,0,je.window[je.strstart]),je.lookahead--,je.strstart++,Xe&&(U(je,!1),je.strm.avail_out===0))return ne}return je.insert=0,Ge===d?(U(je,!0),je.strm.avail_out===0?J:fe):je.last_lit&&(U(je,!1),je.strm.avail_out===0)?ne:ve}(Ce,oe):Ce.strategy===3?function(je,Ge){for(var Xe,qe,Ke,Je,rt=je.window;;){if(je.lookahead<=F){if(Pe(je),je.lookahead<=F&&Ge===g)return ne;if(je.lookahead===0)break}if(je.match_length=0,je.lookahead>=O&&0<je.strstart&&(qe=rt[Ke=je.strstart-1])===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]){Je=je.strstart+F;do;while(qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&qe===rt[++Ke]&&Ke<Je);je.match_length=F-(Je-Ke),je.match_length>je.lookahead&&(je.match_length=je.lookahead)}if(je.match_length>=O?(Xe=s._tr_tally(je,1,je.match_length-O),je.lookahead-=je.match_length,je.strstart+=je.match_length,je.match_length=0):(Xe=s._tr_tally(je,0,je.window[je.strstart]),je.lookahead--,je.strstart++),Xe&&(U(je,!1),je.strm.avail_out===0))return ne}return je.insert=0,Ge===d?(U(je,!0),je.strm.avail_out===0?J:fe):je.last_lit&&(U(je,!1),je.strm.avail_out===0)?ne:ve}(Ce,oe):r[Ce.level].func(Ce,oe);if(Oe!==J&&Oe!==fe||(Ce.status=666),Oe===ne||Oe===J)return le.avail_out===0&&(Ce.last_flush=-1),f;if(Oe===ve&&(oe===1?s._tr_align(Ce):oe!==5&&(s._tr_stored_block(Ce,0,0,!1),oe===3&&(X(Ce.head),Ce.lookahead===0&&(Ce.strstart=0,Ce.block_start=0,Ce.insert=0))),H(le),le.avail_out===0))return Ce.last_flush=-1,f}return oe!==d?f:Ce.wrap<=0?1:(Ce.wrap===2?(te(Ce,255&le.adler),te(Ce,le.adler>>8&255),te(Ce,le.adler>>16&255),te(Ce,le.adler>>24&255),te(Ce,255&le.total_in),te(Ce,le.total_in>>8&255),te(Ce,le.total_in>>16&255),te(Ce,le.total_in>>24&255)):(Q(Ce,le.adler>>>16),Q(Ce,65535&le.adler)),H(le),0<Ce.wrap&&(Ce.wrap=-Ce.wrap),Ce.pending!==0?f:1)},o.deflateEnd=function(le){var oe;return le&&le.state?(oe=le.state.status)!==Y&&oe!==69&&oe!==73&&oe!==91&&oe!==103&&oe!==_e&&oe!==666?Z(le,y):(le.state=null,oe===_e?Z(le,-3):f):y},o.deflateSetDictionary=function(le,oe){var ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe=oe.length;if(!le||!le.state||(Be=(ke=le.state).wrap)===2||Be===1&&ke.status!==Y||ke.lookahead)return y;for(Be===1&&(le.adler=w(le.adler,oe,Xe,0)),ke.wrap=0,Xe>=ke.w_size&&(Be===0&&(X(ke.head),ke.strstart=0,ke.block_start=0,ke.insert=0),Ge=new u.Buf8(ke.w_size),u.arraySet(Ge,oe,Xe-ke.w_size,ke.w_size,0),oe=Ge,Xe=ke.w_size),Ve=le.avail_in,Oe=le.next_in,je=le.input,le.avail_in=Xe,le.next_in=0,le.input=oe,Pe(ke);ke.lookahead>=O;){for(Ce=ke.strstart,Ee=ke.lookahead-(O-1);ke.ins_h=(ke.ins_h<<ke.hash_shift^ke.window[Ce+O-1])&ke.hash_mask,ke.prev[Ce&ke.w_mask]=ke.head[ke.ins_h],ke.head[ke.ins_h]=Ce,Ce++,--Ee;);ke.strstart=Ce,ke.lookahead=O-1,Pe(ke)}return ke.strstart+=ke.lookahead,ke.block_start=ke.strstart,ke.insert=ke.lookahead,ke.lookahead=0,ke.match_length=ke.prev_length=O-1,ke.match_available=0,le.next_in=Oe,le.input=je,le.avail_in=Ve,ke.wrap=Be,f},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,o){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,o){n.exports=function(r,u){var s,w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve;s=r.state,w=r.next_in,ne=r.input,m=w+(r.avail_in-5),v=r.next_out,ve=r.output,g=v-(u-r.avail_out),d=v+(r.avail_out-257),f=s.dmax,y=s.wsize,x=s.whave,k=s.wnext,P=s.window,S=s.hold,E=s.bits,M=s.lencode,T=s.distcode,D=(1<<s.lenbits)-1,N=(1<<s.distbits)-1;e:do{E<15&&(S+=ne[w++]<<E,E+=8,S+=ne[w++]<<E,E+=8),I=M[S&D];t:for(;;){if(S>>>=O=I>>>24,E-=O,(O=I>>>16&255)==0)ve[v++]=65535&I;else{if(!(16&O)){if(!(64&O)){I=M[(65535&I)+(S&(1<<O)-1)];continue t}if(32&O){s.mode=12;break e}r.msg="invalid literal/length code",s.mode=30;break e}F=65535&I,(O&=15)&&(E<O&&(S+=ne[w++]<<E,E+=8),F+=S&(1<<O)-1,S>>>=O,E-=O),E<15&&(S+=ne[w++]<<E,E+=8,S+=ne[w++]<<E,E+=8),I=T[S&N];n:for(;;){if(S>>>=O=I>>>24,E-=O,!(16&(O=I>>>16&255))){if(!(64&O)){I=T[(65535&I)+(S&(1<<O)-1)];continue n}r.msg="invalid distance code",s.mode=30;break e}if(q=65535&I,E<(O&=15)&&(S+=ne[w++]<<E,(E+=8)<O&&(S+=ne[w++]<<E,E+=8)),f<(q+=S&(1<<O)-1)){r.msg="invalid distance too far back",s.mode=30;break e}if(S>>>=O,E-=O,(O=v-g)<q){if(x<(O=q-O)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break e}if(_e=P,(Y=0)===k){if(Y+=y-O,O<F){for(F-=O;ve[v++]=P[Y++],--O;);Y=v-q,_e=ve}}else if(k<O){if(Y+=y+k-O,(O-=k)<F){for(F-=O;ve[v++]=P[Y++],--O;);if(Y=0,k<F){for(F-=O=k;ve[v++]=P[Y++],--O;);Y=v-q,_e=ve}}}else if(Y+=k-O,O<F){for(F-=O;ve[v++]=P[Y++],--O;);Y=v-q,_e=ve}for(;2<F;)ve[v++]=_e[Y++],ve[v++]=_e[Y++],ve[v++]=_e[Y++],F-=3;F&&(ve[v++]=_e[Y++],1<F&&(ve[v++]=_e[Y++]))}else{for(Y=v-q;ve[v++]=ve[Y++],ve[v++]=ve[Y++],ve[v++]=ve[Y++],2<(F-=3););F&&(ve[v++]=ve[Y++],1<F&&(ve[v++]=ve[Y++]))}break}}break}}while(w<m&&v<d);w-=F=E>>3,S&=(1<<(E-=F<<3))-1,r.next_in=w,r.next_out=v,r.avail_in=w<m?m-w+5:5-(w-m),r.avail_out=v<d?d-v+257:257-(v-d),s.hold=S,s.bits=E}},{}],49:[function(e,n,o){var r=e("../utils/common"),u=e("./adler32"),s=e("./crc32"),w=e("./inffast"),m=e("./inftrees"),v=1,g=2,d=0,f=-2,y=1,x=852,k=592;function P(Y){return(Y>>>24&255)+(Y>>>8&65280)+((65280&Y)<<8)+((255&Y)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(Y){var _e;return Y&&Y.state?(_e=Y.state,Y.total_in=Y.total_out=_e.total=0,Y.msg="",_e.wrap&&(Y.adler=1&_e.wrap),_e.mode=y,_e.last=0,_e.havedict=0,_e.dmax=32768,_e.head=null,_e.hold=0,_e.bits=0,_e.lencode=_e.lendyn=new r.Buf32(x),_e.distcode=_e.distdyn=new r.Buf32(k),_e.sane=1,_e.back=-1,d):f}function M(Y){var _e;return Y&&Y.state?((_e=Y.state).wsize=0,_e.whave=0,_e.wnext=0,E(Y)):f}function T(Y,_e){var ne,ve;return Y&&Y.state?(ve=Y.state,_e<0?(ne=0,_e=-_e):(ne=1+(_e>>4),_e<48&&(_e&=15)),_e&&(_e<8||15<_e)?f:(ve.window!==null&&ve.wbits!==_e&&(ve.window=null),ve.wrap=ne,ve.wbits=_e,M(Y))):f}function D(Y,_e){var ne,ve;return Y?(ve=new S,(Y.state=ve).window=null,(ne=T(Y,_e))!==d&&(Y.state=null),ne):f}var N,I,O=!0;function F(Y){if(O){var _e;for(N=new r.Buf32(512),I=new r.Buf32(32),_e=0;_e<144;)Y.lens[_e++]=8;for(;_e<256;)Y.lens[_e++]=9;for(;_e<280;)Y.lens[_e++]=7;for(;_e<288;)Y.lens[_e++]=8;for(m(v,Y.lens,0,288,N,0,Y.work,{bits:9}),_e=0;_e<32;)Y.lens[_e++]=5;m(g,Y.lens,0,32,I,0,Y.work,{bits:5}),O=!1}Y.lencode=N,Y.lenbits=9,Y.distcode=I,Y.distbits=5}function q(Y,_e,ne,ve){var J,fe=Y.state;return fe.window===null&&(fe.wsize=1<<fe.wbits,fe.wnext=0,fe.whave=0,fe.window=new r.Buf8(fe.wsize)),ve>=fe.wsize?(r.arraySet(fe.window,_e,ne-fe.wsize,fe.wsize,0),fe.wnext=0,fe.whave=fe.wsize):(ve<(J=fe.wsize-fe.wnext)&&(J=ve),r.arraySet(fe.window,_e,ne-ve,J,fe.wnext),(ve-=J)?(r.arraySet(fe.window,_e,ne-ve,ve,0),fe.wnext=ve,fe.whave=fe.wsize):(fe.wnext+=J,fe.wnext===fe.wsize&&(fe.wnext=0),fe.whave<fe.wsize&&(fe.whave+=J))),0}o.inflateReset=M,o.inflateReset2=T,o.inflateResetKeep=E,o.inflateInit=function(Y){return D(Y,15)},o.inflateInit2=D,o.inflate=function(Y,_e){var ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee=0,Be=new r.Buf8(4),Ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Y||!Y.state||!Y.output||!Y.input&&Y.avail_in!==0)return f;(ne=Y.state).mode===12&&(ne.mode=13),Z=Y.next_out,J=Y.output,X=Y.avail_out,fe=Y.next_in,ve=Y.input,j=Y.avail_in,H=ne.hold,U=ne.bits,te=j,Q=X,oe=d;e:for(;;)switch(ne.mode){case y:if(ne.wrap===0){ne.mode=13;break}for(;U<16;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(2&ne.wrap&&H===35615){Be[ne.check=0]=255&H,Be[1]=H>>>8&255,ne.check=s(ne.check,Be,2,0),U=H=0,ne.mode=2;break}if(ne.flags=0,ne.head&&(ne.head.done=!1),!(1&ne.wrap)||(((255&H)<<8)+(H>>8))%31){Y.msg="incorrect header check",ne.mode=30;break}if((15&H)!=8){Y.msg="unknown compression method",ne.mode=30;break}if(U-=4,le=8+(15&(H>>>=4)),ne.wbits===0)ne.wbits=le;else if(le>ne.wbits){Y.msg="invalid window size",ne.mode=30;break}ne.dmax=1<<le,Y.adler=ne.check=1,ne.mode=512&H?10:12,U=H=0;break;case 2:for(;U<16;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(ne.flags=H,(255&ne.flags)!=8){Y.msg="unknown compression method",ne.mode=30;break}if(57344&ne.flags){Y.msg="unknown header flags set",ne.mode=30;break}ne.head&&(ne.head.text=H>>8&1),512&ne.flags&&(Be[0]=255&H,Be[1]=H>>>8&255,ne.check=s(ne.check,Be,2,0)),U=H=0,ne.mode=3;case 3:for(;U<32;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.head&&(ne.head.time=H),512&ne.flags&&(Be[0]=255&H,Be[1]=H>>>8&255,Be[2]=H>>>16&255,Be[3]=H>>>24&255,ne.check=s(ne.check,Be,4,0)),U=H=0,ne.mode=4;case 4:for(;U<16;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.head&&(ne.head.xflags=255&H,ne.head.os=H>>8),512&ne.flags&&(Be[0]=255&H,Be[1]=H>>>8&255,ne.check=s(ne.check,Be,2,0)),U=H=0,ne.mode=5;case 5:if(1024&ne.flags){for(;U<16;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.length=H,ne.head&&(ne.head.extra_len=H),512&ne.flags&&(Be[0]=255&H,Be[1]=H>>>8&255,ne.check=s(ne.check,Be,2,0)),U=H=0}else ne.head&&(ne.head.extra=null);ne.mode=6;case 6:if(1024&ne.flags&&(j<(re=ne.length)&&(re=j),re&&(ne.head&&(le=ne.head.extra_len-ne.length,ne.head.extra||(ne.head.extra=new Array(ne.head.extra_len)),r.arraySet(ne.head.extra,ve,fe,re,le)),512&ne.flags&&(ne.check=s(ne.check,ve,re,fe)),j-=re,fe+=re,ne.length-=re),ne.length))break e;ne.length=0,ne.mode=7;case 7:if(2048&ne.flags){if(j===0)break e;for(re=0;le=ve[fe+re++],ne.head&&le&&ne.length<65536&&(ne.head.name+=String.fromCharCode(le)),le&&re<j;);if(512&ne.flags&&(ne.check=s(ne.check,ve,re,fe)),j-=re,fe+=re,le)break e}else ne.head&&(ne.head.name=null);ne.length=0,ne.mode=8;case 8:if(4096&ne.flags){if(j===0)break e;for(re=0;le=ve[fe+re++],ne.head&&le&&ne.length<65536&&(ne.head.comment+=String.fromCharCode(le)),le&&re<j;);if(512&ne.flags&&(ne.check=s(ne.check,ve,re,fe)),j-=re,fe+=re,le)break e}else ne.head&&(ne.head.comment=null);ne.mode=9;case 9:if(512&ne.flags){for(;U<16;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(H!==(65535&ne.check)){Y.msg="header crc mismatch",ne.mode=30;break}U=H=0}ne.head&&(ne.head.hcrc=ne.flags>>9&1,ne.head.done=!0),Y.adler=ne.check=0,ne.mode=12;break;case 10:for(;U<32;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}Y.adler=ne.check=P(H),U=H=0,ne.mode=11;case 11:if(ne.havedict===0)return Y.next_out=Z,Y.avail_out=X,Y.next_in=fe,Y.avail_in=j,ne.hold=H,ne.bits=U,2;Y.adler=ne.check=1,ne.mode=12;case 12:if(_e===5||_e===6)break e;case 13:if(ne.last){H>>>=7&U,U-=7&U,ne.mode=27;break}for(;U<3;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}switch(ne.last=1&H,U-=1,3&(H>>>=1)){case 0:ne.mode=14;break;case 1:if(F(ne),ne.mode=20,_e!==6)break;H>>>=2,U-=2;break e;case 2:ne.mode=17;break;case 3:Y.msg="invalid block type",ne.mode=30}H>>>=2,U-=2;break;case 14:for(H>>>=7&U,U-=7&U;U<32;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if((65535&H)!=(H>>>16^65535)){Y.msg="invalid stored block lengths",ne.mode=30;break}if(ne.length=65535&H,U=H=0,ne.mode=15,_e===6)break e;case 15:ne.mode=16;case 16:if(re=ne.length){if(j<re&&(re=j),X<re&&(re=X),re===0)break e;r.arraySet(J,ve,fe,re,Z),j-=re,fe+=re,X-=re,Z+=re,ne.length-=re;break}ne.mode=12;break;case 17:for(;U<14;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(ne.nlen=257+(31&H),H>>>=5,U-=5,ne.ndist=1+(31&H),H>>>=5,U-=5,ne.ncode=4+(15&H),H>>>=4,U-=4,286<ne.nlen||30<ne.ndist){Y.msg="too many length or distance symbols",ne.mode=30;break}ne.have=0,ne.mode=18;case 18:for(;ne.have<ne.ncode;){for(;U<3;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.lens[Ve[ne.have++]]=7&H,H>>>=3,U-=3}for(;ne.have<19;)ne.lens[Ve[ne.have++]]=0;if(ne.lencode=ne.lendyn,ne.lenbits=7,ke={bits:ne.lenbits},oe=m(0,ne.lens,0,19,ne.lencode,0,ne.work,ke),ne.lenbits=ke.bits,oe){Y.msg="invalid code lengths set",ne.mode=30;break}ne.have=0,ne.mode=19;case 19:for(;ne.have<ne.nlen+ne.ndist;){for(;Ae=(Ee=ne.lencode[H&(1<<ne.lenbits)-1])>>>16&255,$e=65535&Ee,!((we=Ee>>>24)<=U);){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if($e<16)H>>>=we,U-=we,ne.lens[ne.have++]=$e;else{if($e===16){for(Ce=we+2;U<Ce;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(H>>>=we,U-=we,ne.have===0){Y.msg="invalid bit length repeat",ne.mode=30;break}le=ne.lens[ne.have-1],re=3+(3&H),H>>>=2,U-=2}else if($e===17){for(Ce=we+3;U<Ce;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}U-=we,le=0,re=3+(7&(H>>>=we)),H>>>=3,U-=3}else{for(Ce=we+7;U<Ce;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}U-=we,le=0,re=11+(127&(H>>>=we)),H>>>=7,U-=7}if(ne.have+re>ne.nlen+ne.ndist){Y.msg="invalid bit length repeat",ne.mode=30;break}for(;re--;)ne.lens[ne.have++]=le}}if(ne.mode===30)break;if(ne.lens[256]===0){Y.msg="invalid code -- missing end-of-block",ne.mode=30;break}if(ne.lenbits=9,ke={bits:ne.lenbits},oe=m(v,ne.lens,0,ne.nlen,ne.lencode,0,ne.work,ke),ne.lenbits=ke.bits,oe){Y.msg="invalid literal/lengths set",ne.mode=30;break}if(ne.distbits=6,ne.distcode=ne.distdyn,ke={bits:ne.distbits},oe=m(g,ne.lens,ne.nlen,ne.ndist,ne.distcode,0,ne.work,ke),ne.distbits=ke.bits,oe){Y.msg="invalid distances set",ne.mode=30;break}if(ne.mode=20,_e===6)break e;case 20:ne.mode=21;case 21:if(6<=j&&258<=X){Y.next_out=Z,Y.avail_out=X,Y.next_in=fe,Y.avail_in=j,ne.hold=H,ne.bits=U,w(Y,Q),Z=Y.next_out,J=Y.output,X=Y.avail_out,fe=Y.next_in,ve=Y.input,j=Y.avail_in,H=ne.hold,U=ne.bits,ne.mode===12&&(ne.back=-1);break}for(ne.back=0;Ae=(Ee=ne.lencode[H&(1<<ne.lenbits)-1])>>>16&255,$e=65535&Ee,!((we=Ee>>>24)<=U);){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(Ae&&!(240&Ae)){for(Me=we,Ie=Ae,Le=$e;Ae=(Ee=ne.lencode[Le+((H&(1<<Me+Ie)-1)>>Me)])>>>16&255,$e=65535&Ee,!(Me+(we=Ee>>>24)<=U);){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}H>>>=Me,U-=Me,ne.back+=Me}if(H>>>=we,U-=we,ne.back+=we,ne.length=$e,Ae===0){ne.mode=26;break}if(32&Ae){ne.back=-1,ne.mode=12;break}if(64&Ae){Y.msg="invalid literal/length code",ne.mode=30;break}ne.extra=15&Ae,ne.mode=22;case 22:if(ne.extra){for(Ce=ne.extra;U<Ce;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.length+=H&(1<<ne.extra)-1,H>>>=ne.extra,U-=ne.extra,ne.back+=ne.extra}ne.was=ne.length,ne.mode=23;case 23:for(;Ae=(Ee=ne.distcode[H&(1<<ne.distbits)-1])>>>16&255,$e=65535&Ee,!((we=Ee>>>24)<=U);){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(!(240&Ae)){for(Me=we,Ie=Ae,Le=$e;Ae=(Ee=ne.distcode[Le+((H&(1<<Me+Ie)-1)>>Me)])>>>16&255,$e=65535&Ee,!(Me+(we=Ee>>>24)<=U);){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}H>>>=Me,U-=Me,ne.back+=Me}if(H>>>=we,U-=we,ne.back+=we,64&Ae){Y.msg="invalid distance code",ne.mode=30;break}ne.offset=$e,ne.extra=15&Ae,ne.mode=24;case 24:if(ne.extra){for(Ce=ne.extra;U<Ce;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}ne.offset+=H&(1<<ne.extra)-1,H>>>=ne.extra,U-=ne.extra,ne.back+=ne.extra}if(ne.offset>ne.dmax){Y.msg="invalid distance too far back",ne.mode=30;break}ne.mode=25;case 25:if(X===0)break e;if(re=Q-X,ne.offset>re){if((re=ne.offset-re)>ne.whave&&ne.sane){Y.msg="invalid distance too far back",ne.mode=30;break}Pe=re>ne.wnext?(re-=ne.wnext,ne.wsize-re):ne.wnext-re,re>ne.length&&(re=ne.length),be=ne.window}else be=J,Pe=Z-ne.offset,re=ne.length;for(X<re&&(re=X),X-=re,ne.length-=re;J[Z++]=be[Pe++],--re;);ne.length===0&&(ne.mode=21);break;case 26:if(X===0)break e;J[Z++]=ne.length,X--,ne.mode=21;break;case 27:if(ne.wrap){for(;U<32;){if(j===0)break e;j--,H|=ve[fe++]<<U,U+=8}if(Q-=X,Y.total_out+=Q,ne.total+=Q,Q&&(Y.adler=ne.check=ne.flags?s(ne.check,J,Q,Z-Q):u(ne.check,J,Q,Z-Q)),Q=X,(ne.flags?H:P(H))!==ne.check){Y.msg="incorrect data check",ne.mode=30;break}U=H=0}ne.mode=28;case 28:if(ne.wrap&&ne.flags){for(;U<32;){if(j===0)break e;j--,H+=ve[fe++]<<U,U+=8}if(H!==(4294967295&ne.total)){Y.msg="incorrect length check",ne.mode=30;break}U=H=0}ne.mode=29;case 29:oe=1;break e;case 30:oe=-3;break e;case 31:return-4;default:return f}return Y.next_out=Z,Y.avail_out=X,Y.next_in=fe,Y.avail_in=j,ne.hold=H,ne.bits=U,(ne.wsize||Q!==Y.avail_out&&ne.mode<30&&(ne.mode<27||_e!==4))&&q(Y,Y.output,Y.next_out,Q-Y.avail_out)?(ne.mode=31,-4):(te-=Y.avail_in,Q-=Y.avail_out,Y.total_in+=te,Y.total_out+=Q,ne.total+=Q,ne.wrap&&Q&&(Y.adler=ne.check=ne.flags?s(ne.check,J,Q,Y.next_out-Q):u(ne.check,J,Q,Y.next_out-Q)),Y.data_type=ne.bits+(ne.last?64:0)+(ne.mode===12?128:0)+(ne.mode===20||ne.mode===15?256:0),(te==0&&Q===0||_e===4)&&oe===d&&(oe=-5),oe)},o.inflateEnd=function(Y){if(!Y||!Y.state)return f;var _e=Y.state;return _e.window&&(_e.window=null),Y.state=null,d},o.inflateGetHeader=function(Y,_e){var ne;return Y&&Y.state&&2&(ne=Y.state).wrap?((ne.head=_e).done=!1,d):f},o.inflateSetDictionary=function(Y,_e){var ne,ve=_e.length;return Y&&Y.state?(ne=Y.state).wrap!==0&&ne.mode!==11?f:ne.mode===11&&u(1,_e,ve,0)!==ne.check?-3:q(Y,_e,ve,ve)?(ne.mode=31,-4):(ne.havedict=1,d):f},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,o){var r=e("../utils/common"),u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(v,g,d,f,y,x,k,P){var S,E,M,T,D,N,I,O,F,q=P.bits,Y=0,_e=0,ne=0,ve=0,J=0,fe=0,Z=0,j=0,X=0,H=0,U=null,te=0,Q=new r.Buf16(16),re=new r.Buf16(16),Pe=null,be=0;for(Y=0;Y<=15;Y++)Q[Y]=0;for(_e=0;_e<f;_e++)Q[g[d+_e]]++;for(J=q,ve=15;1<=ve&&Q[ve]===0;ve--);if(ve<J&&(J=ve),ve===0)return y[x++]=20971520,y[x++]=20971520,P.bits=1,0;for(ne=1;ne<ve&&Q[ne]===0;ne++);for(J<ne&&(J=ne),Y=j=1;Y<=15;Y++)if(j<<=1,(j-=Q[Y])<0)return-1;if(0<j&&(v===0||ve!==1))return-1;for(re[1]=0,Y=1;Y<15;Y++)re[Y+1]=re[Y]+Q[Y];for(_e=0;_e<f;_e++)g[d+_e]!==0&&(k[re[g[d+_e]]++]=_e);if(N=v===0?(U=Pe=k,19):v===1?(U=u,te-=257,Pe=s,be-=257,256):(U=w,Pe=m,-1),Y=ne,D=x,Z=_e=H=0,M=-1,T=(X=1<<(fe=J))-1,v===1&&852<X||v===2&&592<X)return 1;for(;;){for(I=Y-Z,F=k[_e]<N?(O=0,k[_e]):k[_e]>N?(O=Pe[be+k[_e]],U[te+k[_e]]):(O=96,0),S=1<<Y-Z,ne=E=1<<fe;y[D+(H>>Z)+(E-=S)]=I<<24|O<<16|F,E!==0;);for(S=1<<Y-1;H&S;)S>>=1;if(S!==0?(H&=S-1,H+=S):H=0,_e++,--Q[Y]==0){if(Y===ve)break;Y=g[d+k[_e]]}if(J<Y&&(H&T)!==M){for(Z===0&&(Z=J),D+=ne,j=1<<(fe=Y-Z);fe+Z<ve&&!((j-=Q[fe+Z])<=0);)fe++,j<<=1;if(X+=1<<fe,v===1&&852<X||v===2&&592<X)return 1;y[M=H&T]=J<<24|fe<<16|D-x}}return H!==0&&(y[D+H]=Y-Z<<24|64<<16),P.bits=J,0}},{"../utils/common":41}],51:[function(e,n,o){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,o){var r=e("../utils/common"),u=0,s=1;function w(Ee){for(var Be=Ee.length;0<=--Be;)Ee[Be]=0}var m=0,v=29,g=256,d=g+1+v,f=30,y=19,x=2*d+1,k=15,P=16,S=7,E=256,M=16,T=17,D=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(2*(d+2));w(q);var Y=new Array(2*f);w(Y);var _e=new Array(512);w(_e);var ne=new Array(256);w(ne);var ve=new Array(v);w(ve);var J,fe,Z,j=new Array(f);function X(Ee,Be,Ve,Oe,je){this.static_tree=Ee,this.extra_bits=Be,this.extra_base=Ve,this.elems=Oe,this.max_length=je,this.has_stree=Ee&&Ee.length}function H(Ee,Be){this.dyn_tree=Ee,this.max_code=0,this.stat_desc=Be}function U(Ee){return Ee<256?_e[Ee]:_e[256+(Ee>>>7)]}function te(Ee,Be){Ee.pending_buf[Ee.pending++]=255&Be,Ee.pending_buf[Ee.pending++]=Be>>>8&255}function Q(Ee,Be,Ve){Ee.bi_valid>P-Ve?(Ee.bi_buf|=Be<<Ee.bi_valid&65535,te(Ee,Ee.bi_buf),Ee.bi_buf=Be>>P-Ee.bi_valid,Ee.bi_valid+=Ve-P):(Ee.bi_buf|=Be<<Ee.bi_valid&65535,Ee.bi_valid+=Ve)}function re(Ee,Be,Ve){Q(Ee,Ve[2*Be],Ve[2*Be+1])}function Pe(Ee,Be){for(var Ve=0;Ve|=1&Ee,Ee>>>=1,Ve<<=1,0<--Be;);return Ve>>>1}function be(Ee,Be,Ve){var Oe,je,Ge=new Array(k+1),Xe=0;for(Oe=1;Oe<=k;Oe++)Ge[Oe]=Xe=Xe+Ve[Oe-1]<<1;for(je=0;je<=Be;je++){var qe=Ee[2*je+1];qe!==0&&(Ee[2*je]=Pe(Ge[qe]++,qe))}}function we(Ee){var Be;for(Be=0;Be<d;Be++)Ee.dyn_ltree[2*Be]=0;for(Be=0;Be<f;Be++)Ee.dyn_dtree[2*Be]=0;for(Be=0;Be<y;Be++)Ee.bl_tree[2*Be]=0;Ee.dyn_ltree[2*E]=1,Ee.opt_len=Ee.static_len=0,Ee.last_lit=Ee.matches=0}function Ae(Ee){8<Ee.bi_valid?te(Ee,Ee.bi_buf):0<Ee.bi_valid&&(Ee.pending_buf[Ee.pending++]=Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0}function $e(Ee,Be,Ve,Oe){var je=2*Be,Ge=2*Ve;return Ee[je]<Ee[Ge]||Ee[je]===Ee[Ge]&&Oe[Be]<=Oe[Ve]}function Me(Ee,Be,Ve){for(var Oe=Ee.heap[Ve],je=Ve<<1;je<=Ee.heap_len&&(je<Ee.heap_len&&$e(Be,Ee.heap[je+1],Ee.heap[je],Ee.depth)&&je++,!$e(Be,Oe,Ee.heap[je],Ee.depth));)Ee.heap[Ve]=Ee.heap[je],Ve=je,je<<=1;Ee.heap[Ve]=Oe}function Ie(Ee,Be,Ve){var Oe,je,Ge,Xe,qe=0;if(Ee.last_lit!==0)for(;Oe=Ee.pending_buf[Ee.d_buf+2*qe]<<8|Ee.pending_buf[Ee.d_buf+2*qe+1],je=Ee.pending_buf[Ee.l_buf+qe],qe++,Oe===0?re(Ee,je,Be):(re(Ee,(Ge=ne[je])+g+1,Be),(Xe=N[Ge])!==0&&Q(Ee,je-=ve[Ge],Xe),re(Ee,Ge=U(--Oe),Ve),(Xe=I[Ge])!==0&&Q(Ee,Oe-=j[Ge],Xe)),qe<Ee.last_lit;);re(Ee,E,Be)}function Le(Ee,Be){var Ve,Oe,je,Ge=Be.dyn_tree,Xe=Be.stat_desc.static_tree,qe=Be.stat_desc.has_stree,Ke=Be.stat_desc.elems,Je=-1;for(Ee.heap_len=0,Ee.heap_max=x,Ve=0;Ve<Ke;Ve++)Ge[2*Ve]!==0?(Ee.heap[++Ee.heap_len]=Je=Ve,Ee.depth[Ve]=0):Ge[2*Ve+1]=0;for(;Ee.heap_len<2;)Ge[2*(je=Ee.heap[++Ee.heap_len]=Je<2?++Je:0)]=1,Ee.depth[je]=0,Ee.opt_len--,qe&&(Ee.static_len-=Xe[2*je+1]);for(Be.max_code=Je,Ve=Ee.heap_len>>1;1<=Ve;Ve--)Me(Ee,Ge,Ve);for(je=Ke;Ve=Ee.heap[1],Ee.heap[1]=Ee.heap[Ee.heap_len--],Me(Ee,Ge,1),Oe=Ee.heap[1],Ee.heap[--Ee.heap_max]=Ve,Ee.heap[--Ee.heap_max]=Oe,Ge[2*je]=Ge[2*Ve]+Ge[2*Oe],Ee.depth[je]=(Ee.depth[Ve]>=Ee.depth[Oe]?Ee.depth[Ve]:Ee.depth[Oe])+1,Ge[2*Ve+1]=Ge[2*Oe+1]=je,Ee.heap[1]=je++,Me(Ee,Ge,1),2<=Ee.heap_len;);Ee.heap[--Ee.heap_max]=Ee.heap[1],function(rt,ht){var vt,Ct,kt,mt,Vt,bt,ot=ht.dyn_tree,gt=ht.max_code,tt=ht.stat_desc.static_tree,ut=ht.stat_desc.has_stree,Re=ht.stat_desc.extra_bits,Te=ht.stat_desc.extra_base,He=ht.stat_desc.max_length,Fe=0;for(mt=0;mt<=k;mt++)rt.bl_count[mt]=0;for(ot[2*rt.heap[rt.heap_max]+1]=0,vt=rt.heap_max+1;vt<x;vt++)He<(mt=ot[2*ot[2*(Ct=rt.heap[vt])+1]+1]+1)&&(mt=He,Fe++),ot[2*Ct+1]=mt,gt<Ct||(rt.bl_count[mt]++,Vt=0,Te<=Ct&&(Vt=Re[Ct-Te]),bt=ot[2*Ct],rt.opt_len+=bt*(mt+Vt),ut&&(rt.static_len+=bt*(tt[2*Ct+1]+Vt)));if(Fe!==0){do{for(mt=He-1;rt.bl_count[mt]===0;)mt--;rt.bl_count[mt]--,rt.bl_count[mt+1]+=2,rt.bl_count[He]--,Fe-=2}while(0<Fe);for(mt=He;mt!==0;mt--)for(Ct=rt.bl_count[mt];Ct!==0;)gt<(kt=rt.heap[--vt])||(ot[2*kt+1]!==mt&&(rt.opt_len+=(mt-ot[2*kt+1])*ot[2*kt],ot[2*kt+1]=mt),Ct--)}}(Ee,Be),be(Ge,Je,Ee.bl_count)}function le(Ee,Be,Ve){var Oe,je,Ge=-1,Xe=Be[1],qe=0,Ke=7,Je=4;for(Xe===0&&(Ke=138,Je=3),Be[2*(Ve+1)+1]=65535,Oe=0;Oe<=Ve;Oe++)je=Xe,Xe=Be[2*(Oe+1)+1],++qe<Ke&&je===Xe||(qe<Je?Ee.bl_tree[2*je]+=qe:je!==0?(je!==Ge&&Ee.bl_tree[2*je]++,Ee.bl_tree[2*M]++):qe<=10?Ee.bl_tree[2*T]++:Ee.bl_tree[2*D]++,Ge=je,Je=(qe=0)===Xe?(Ke=138,3):je===Xe?(Ke=6,3):(Ke=7,4))}function oe(Ee,Be,Ve){var Oe,je,Ge=-1,Xe=Be[1],qe=0,Ke=7,Je=4;for(Xe===0&&(Ke=138,Je=3),Oe=0;Oe<=Ve;Oe++)if(je=Xe,Xe=Be[2*(Oe+1)+1],!(++qe<Ke&&je===Xe)){if(qe<Je)for(;re(Ee,je,Ee.bl_tree),--qe!=0;);else je!==0?(je!==Ge&&(re(Ee,je,Ee.bl_tree),qe--),re(Ee,M,Ee.bl_tree),Q(Ee,qe-3,2)):qe<=10?(re(Ee,T,Ee.bl_tree),Q(Ee,qe-3,3)):(re(Ee,D,Ee.bl_tree),Q(Ee,qe-11,7));Ge=je,Je=(qe=0)===Xe?(Ke=138,3):je===Xe?(Ke=6,3):(Ke=7,4)}}w(j);var ke=!1;function Ce(Ee,Be,Ve,Oe){Q(Ee,(m<<1)+(Oe?1:0),3),function(je,Ge,Xe,qe){Ae(je),qe&&(te(je,Xe),te(je,~Xe)),r.arraySet(je.pending_buf,je.window,Ge,Xe,je.pending),je.pending+=Xe}(Ee,Be,Ve,!0)}o._tr_init=function(Ee){ke||(function(){var Be,Ve,Oe,je,Ge,Xe=new Array(k+1);for(je=Oe=0;je<v-1;je++)for(ve[je]=Oe,Be=0;Be<1<<N[je];Be++)ne[Oe++]=je;for(ne[Oe-1]=je,je=Ge=0;je<16;je++)for(j[je]=Ge,Be=0;Be<1<<I[je];Be++)_e[Ge++]=je;for(Ge>>=7;je<f;je++)for(j[je]=Ge<<7,Be=0;Be<1<<I[je]-7;Be++)_e[256+Ge++]=je;for(Ve=0;Ve<=k;Ve++)Xe[Ve]=0;for(Be=0;Be<=143;)q[2*Be+1]=8,Be++,Xe[8]++;for(;Be<=255;)q[2*Be+1]=9,Be++,Xe[9]++;for(;Be<=279;)q[2*Be+1]=7,Be++,Xe[7]++;for(;Be<=287;)q[2*Be+1]=8,Be++,Xe[8]++;for(be(q,d+1,Xe),Be=0;Be<f;Be++)Y[2*Be+1]=5,Y[2*Be]=Pe(Be,5);J=new X(q,N,g+1,d,k),fe=new X(Y,I,0,f,k),Z=new X(new Array(0),O,0,y,S)}(),ke=!0),Ee.l_desc=new H(Ee.dyn_ltree,J),Ee.d_desc=new H(Ee.dyn_dtree,fe),Ee.bl_desc=new H(Ee.bl_tree,Z),Ee.bi_buf=0,Ee.bi_valid=0,we(Ee)},o._tr_stored_block=Ce,o._tr_flush_block=function(Ee,Be,Ve,Oe){var je,Ge,Xe=0;0<Ee.level?(Ee.strm.data_type===2&&(Ee.strm.data_type=function(qe){var Ke,Je=4093624447;for(Ke=0;Ke<=31;Ke++,Je>>>=1)if(1&Je&&qe.dyn_ltree[2*Ke]!==0)return u;if(qe.dyn_ltree[18]!==0||qe.dyn_ltree[20]!==0||qe.dyn_ltree[26]!==0)return s;for(Ke=32;Ke<g;Ke++)if(qe.dyn_ltree[2*Ke]!==0)return s;return u}(Ee)),Le(Ee,Ee.l_desc),Le(Ee,Ee.d_desc),Xe=function(qe){var Ke;for(le(qe,qe.dyn_ltree,qe.l_desc.max_code),le(qe,qe.dyn_dtree,qe.d_desc.max_code),Le(qe,qe.bl_desc),Ke=y-1;3<=Ke&&qe.bl_tree[2*F[Ke]+1]===0;Ke--);return qe.opt_len+=3*(Ke+1)+5+5+4,Ke}(Ee),je=Ee.opt_len+3+7>>>3,(Ge=Ee.static_len+3+7>>>3)<=je&&(je=Ge)):je=Ge=Ve+5,Ve+4<=je&&Be!==-1?Ce(Ee,Be,Ve,Oe):Ee.strategy===4||Ge===je?(Q(Ee,2+(Oe?1:0),3),Ie(Ee,q,Y)):(Q(Ee,4+(Oe?1:0),3),function(qe,Ke,Je,rt){var ht;for(Q(qe,Ke-257,5),Q(qe,Je-1,5),Q(qe,rt-4,4),ht=0;ht<rt;ht++)Q(qe,qe.bl_tree[2*F[ht]+1],3);oe(qe,qe.dyn_ltree,Ke-1),oe(qe,qe.dyn_dtree,Je-1)}(Ee,Ee.l_desc.max_code+1,Ee.d_desc.max_code+1,Xe+1),Ie(Ee,Ee.dyn_ltree,Ee.dyn_dtree)),we(Ee),Oe&&Ae(Ee)},o._tr_tally=function(Ee,Be,Ve){return Ee.pending_buf[Ee.d_buf+2*Ee.last_lit]=Be>>>8&255,Ee.pending_buf[Ee.d_buf+2*Ee.last_lit+1]=255&Be,Ee.pending_buf[Ee.l_buf+Ee.last_lit]=255&Ve,Ee.last_lit++,Be===0?Ee.dyn_ltree[2*Ve]++:(Ee.matches++,Be--,Ee.dyn_ltree[2*(ne[Ve]+g+1)]++,Ee.dyn_dtree[2*U(Be)]++),Ee.last_lit===Ee.lit_bufsize-1},o._tr_align=function(Ee){Q(Ee,2,3),re(Ee,E,q),function(Be){Be.bi_valid===16?(te(Be,Be.bi_buf),Be.bi_buf=0,Be.bi_valid=0):8<=Be.bi_valid&&(Be.pending_buf[Be.pending++]=255&Be.bi_buf,Be.bi_buf>>=8,Be.bi_valid-=8)}(Ee)}},{"../utils/common":41}],53:[function(e,n,o){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,o){(function(r){(function(u,s){if(!u.setImmediate){var w,m,v,g,d=1,f={},y=!1,x=u.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(u);k=k&&k.setTimeout?k:u,w={}.toString.call(u.process)==="[object process]"?function(M){process.nextTick(function(){S(M)})}:function(){if(u.postMessage&&!u.importScripts){var M=!0,T=u.onmessage;return u.onmessage=function(){M=!1},u.postMessage("","*"),u.onmessage=T,M}}()?(g="setImmediate$"+Math.random()+"$",u.addEventListener?u.addEventListener("message",E,!1):u.attachEvent("onmessage",E),function(M){u.postMessage(g+M,"*")}):u.MessageChannel?((v=new MessageChannel).port1.onmessage=function(M){S(M.data)},function(M){v.port2.postMessage(M)}):x&&"onreadystatechange"in x.createElement("script")?(m=x.documentElement,function(M){var T=x.createElement("script");T.onreadystatechange=function(){S(M),T.onreadystatechange=null,m.removeChild(T),T=null},m.appendChild(T)}):function(M){setTimeout(S,0,M)},k.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var T=new Array(arguments.length-1),D=0;D<T.length;D++)T[D]=arguments[D+1];var N={callback:M,args:T};return f[d]=N,w(d),d++},k.clearImmediate=P}function P(M){delete f[M]}function S(M){if(y)setTimeout(S,0,M);else{var T=f[M];if(T){y=!0;try{(function(D){var N=D.callback,I=D.args;switch(I.length){case 0:N();break;case 1:N(I[0]);break;case 2:N(I[0],I[1]);break;case 3:N(I[0],I[1],I[2]);break;default:N.apply(s,I)}})(T)}finally{P(M),y=!1}}}}function E(M){M.source===u&&typeof M.data=="string"&&M.data.indexOf(g)===0&&S(+M.data.slice(g.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,commonjsGlobal$1!==void 0?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10);var JSZip=jszip_minExports,Outline=function(){return _createClass(function e(n){_classCallCheck(this,e),this.doc=n.doc,this.messageHandler=n.messageHandler,this.outline=n.outline,this.index=n.index,this.children=n.children||[],this.parent=n.parent},[{key:"pageNumber",get:function(){return this.outline.pageNumber}},{key:"title",get:function(){return this.outline.title}},{key:"level",get:function(){return this.outline.level}},{key:"getOutline",value:function(){return this.outline}}])}(),ContentEditManager=function(){return _createClass(function s(w){_classCallCheck(this,s),this.documentViewer=w,this.editAreaInfoPtr=null,this.selectedEditBox=null},[{key:"getContentBoxesList",value:function(s){var w=this.documentViewer;if(s){var m=s-1,v=w.pdfViewer._pages[m].contentContainer;return v?v.frameEditorList:[]}for(var g=[],d=0;d<w.pdfViewer._pages.length;d++){var f=w.pdfViewer._pages[d].contentContainer;f&&g.push.apply(g,_toConsumableArray$1(f.frameEditorList))}return g}},{key:"startContentEditMode",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m,v;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:w=_createForOfIteratorHelper(this.documentViewer.pdfViewer._pages),g.prev=1,w.s();case 3:if((m=w.n()).done){g.next=9;break}return v=m.value,g.next=7,v.handleToolMode("editor");case 7:g.next=3;break;case 9:g.next=14;break;case 11:g.prev=11,g.t0=g.catch(1),w.e(g.t0);case 14:return g.prev=14,w.f(),g.finish(14);case 17:this.documentViewer.setToolMode("editor");case 18:case"end":return g.stop()}},s,this,[[1,11,14,17]])})),function(){return u.apply(this,arguments)})},{key:"endContentEditMode",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function s(){return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:this.documentViewer.setToolMode("view");case 1:case"end":return w.stop()}},s,this)})),function(){return r.apply(this,arguments)})},{key:"getSelectedEditBox",value:function(){return this.selectedEditBox}},{key:"setSelectedEditBox",value:function(s){this.selectedEditBox=s}},{key:"getCopyArea",value:function(){return this.editAreaInfo}},{key:"setCopyArea",value:function(s){this.editAreaInfo=s}},{key:"pasteAreaInPage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function s(w,m){var v,g,d,f,y,x,k,P;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(m){S.next=5;break}if(v=this.getCopyArea()){S.next=4;break}return S.abrupt("return");case 4:m={rect:v.rect,editAreaInfoPtr:v.editAreaInfoPtr};case 5:if(g=this.documentViewer,d=w-1,f=g.pdfViewer._pages[d],y=f.contentContainer,x=y&&y.editPagePtr){S.next=15;break}return S.next=13,f.getEditAnnotation();case 13:y=S.sent,x=y.editPagePtr;case 15:return S.next=17,g.messageHandler.sendWithPromise("PasteArea",{pagePtr:g.pagesPtr[d].pagePtr,editPagePtr:x,pageIndex:d,editAreaInfoPtr:m.editAreaInfoPtr,rect:m.rect});case 17:return k=S.sent,S.next=20,y.addEditArea(k);case 20:P=S.sent,y.handleOperateList({editPagePtr:x,editAreaIndex:P.editAreaIndex,editAreaPtr:k,pageIndex:d});case 22:case"end":return S.stop()}},s,this)})),function(s,w){return o.apply(this,arguments)})},{key:"getSelectedText",value:function(s){var w=this.documentViewer;if(s&&(s<1||s>w.pagesCount))return"";var m=w.pdfViewer._pages,v="";if(s)v+=this.getPageSelectedText(s);else for(var g=0;g<m.length;g++)m[g].contentContainer&&(v+=this.getPageSelectedText(g+1));return v}},{key:"getPageSelectedText",value:function(s){if(!s)return"";var w=s-1,m=this.documentViewer.pdfViewer._pages[w].contentContainer;if(!m)return"";for(var v=m.frameEditorList,g="",d=0;d<v.length;d++){var f=v[d];f.type==="text"&&f.selectedCharRange&&(g+=f.selectedText)}return g}},{key:"selectedEditBoxText",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if((w=this.getSelectedEditBox())&&w.type==="text"){m.next=3;break}return m.abrupt("return");case 3:if(m.t0=w.selectedAllText,!m.t0){m.next=7;break}return m.next=7,w.selectedAllText();case 7:case"end":return m.stop()}},s,this)})),function(){return n.apply(this,arguments)})},{key:"getEditBoxSelectedText",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function s(){var w,m;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(w=this.getSelectedEditBox()){v.next=3;break}return v.abrupt("return");case 3:if(w.selectedCharRange){v.next=5;break}return v.abrupt("return","");case 5:return v.next=7,w.getText();case 7:return m=v.sent,v.abrupt("return",m);case 9:case"end":return v.stop()}},s,this)})),function(){return e.apply(this,arguments)})}]);var e,n,o,r,u}();function convertFileToBuffer(e){return new Promise(function(n,o){var r=new FileReader;r.onload=function(){var u=new Uint8Array(r.result);n(u)},r.onerror=function(){o(r.error)},r.readAsArrayBuffer(e)})}var AnnotationManager=function(){return _createClass(function e(n){_classCallCheck(this,e),this.selectedAnnotations=[],this.documentViewer=n,this.annotations=[],this.enableFillForm=!1,this.focusedAnnotation=null,this.indicator=!1,this.annotationsType={custom:Shape,highlight:TextHighlightAnnotation,squiggly:TextSquigglyAnnotation,strikeout:TextStrikeoutAnnotation,underline:TextUnderlineAnnotation,line:Line,circle:Circle,square:Shape$1,rectangle:Rectangle,freetext:Freetext$1,stamp:Stamp,text:Text$1,ink:Ink,arc:Arc,polyline:Polyline,polygon:Polygon,redact:Redaction,link:Link,curve:Curve,textfield:TextField,checkbox:CheckBox$1,radiobutton:RadioButton,pushbutton:PushButton,listbox:ListBox,combobox:ComboBox,signatureFields:SignatureFields,callout:Callout},this.documentViewer.addEvent("presentationmodechanged",this.presentationmodechanged.bind(this))},[{key:"presentationmodechanged",value:function(e){for(var n=e.state,o=this.annotations,r=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"],u=0;u<o.length;u++){var s=o[u],w=s.type;r.includes(w)&&s.annotation.indicator&&(n===3?s.indicatorBox.style.display="none":n===1&&(s.indicatorBox.style.display="block"))}}},{key:"getAnnotationsList",value:function(){return this.annotations}},{key:"isInFormFieldFillMode",value:function(){return this.enableFillForm}},{key:"endFormFieldFillMode",value:function(){this.enableFillForm=!1;for(var e=this.annotations,n=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"],o=[],r=0;r<e.length;r++){var u=e[r],s=u.type;n.includes(s)&&u.isHidden&&o.push(u),s==="combobox"&&u.changeSelectAvailable()}o.length&&this.showAnnotations(o)}},{key:"startFormFieldFillMode",value:function(){this.enableFillForm=!0;for(var e=this.annotations,n=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"],o=[],r=0;r<e.length;r++){var u=e[r],s=u.type;n.includes(s)&&u.isHidden&&o.push(u),s==="combobox"&&u.changeSelectAvailable()}o.length&&this.hideAnnotations(o)}},{key:"showIndicator",value:function(){return this.indicator}},{key:"enableIndicator",value:function(){this.indicator=!0}},{key:"disableIndicator",value:function(){this.indicator=!1}},{key:"hideAnnotations",value:function(e){if(e&&e.length)for(var n=0;n<e.length;n++)e[n].annotationContainer.style.display="none"}},{key:"showAnnotations",value:function(e){if(e&&e.length)for(var n=0;n<e.length;n++)e[n].annotationContainer.style.display="block"}},{key:"focus",value:function(e){e&&(this.focusedAnnotation&&this.focusedAnnotation!==e&&this.focusedAnnotation.blur(),e.focus&&e.focus())}},{key:"createAnnotationReply",value:function(e,n){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function o(){var r,u,s;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return n.author=n.author||this.documentViewer.annotator,n.rect=e.annotation.rect,n.pageIndex=e.pageIndex,!n.name&&(n.name=v4()),w.next=6,this.documentViewer.messageHandler.sendWithPromise("CreateReplyAnnotation",{pagePtr:e.pagePtr,annotPtr:e.annotPtr,replyAnnotation:n});case 6:r=w.sent,n.pagePtr=e.pagePtr,n.annotPtr=r,n.inReplyTo=e.name,n.stateModel||(u=n.state==="MARKED"||n.state==="UNMARKED"?"Marked":"Review",n.stateModel=u),s=new this.annotationsType.text({annotation:n,documentViewer:this.documentViewer}),e.addReply(s);case 13:case"end":return w.stop()}},o,this)}))}},{key:"addAnnotation",value:function(e){this.addAnnotations([e])}},{key:"addAnnotations",value:function(e){if(e){for(var n=[],o=0;o<e.length;o++){var r=e[o];r.pageIndex<0||(this.annotations.push(r),n.push(r))}n.length&&this.documentViewer.eventBus.dispatch("annotationChanged",n,"add")}}},{key:"hasAnnotation",value:function(e){return e instanceof BaseAnnotation?this.annotations.indexOf(e)>-1:e.name?!!(e=this.getAnnotationById(e.name)):void 0}},{key:"isAnnotationSelected",value:function(e){}},{key:"deleteAnnotation",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.deleteAnnotations(Array.isArray(e)?e:[e]);case 2:case"end":return o.stop()}},n,this)}))}},{key:"deleteAnnotations",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s,w,m,v,g,d,f=this;return _regeneratorRuntime().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(o=[],r=[],this.documentViewer.userAdmin||!this.documentViewer.readOnly&&this.documentViewer.annotator===this.annotation.author){y.next=4;break}return y.abrupt("return");case 4:u=e.length-1;case 5:if(!(u>=0)){y.next=43;break}if(s=e[u],w=this.hasAnnotation(s),m=null,!w){y.next=29;break}if(s instanceof BaseAnnotation||!s.name||(this.getAnnotationById(s.name),_readOnlyError("annotation")),this.documentViewer.annotationStore.selectedElementName&&s.name===this.documentViewer.annotationStore.selectedElementName&&(r.push(s),this.deselectAnnotation(s)),v=this.annotations.splice(this.annotations.indexOf(s),1),o.push(v[0]),s.isDelete||s.handleDelete(),!(g=s.getReplies())){y.next=24;break}return y.next=20,this.documentViewer.messageHandler.sendWithPromise("RemoveFromPageIncludeReplyAnnot",{pagePtr:s.pagePtr,annotPtr:s.annotPtr});case 20:m=y.sent,g.forEach(function(x){f.annotations.splice(f.annotations.indexOf(x),1)}),y.next=27;break;case 24:return y.next=26,this.documentViewer.messageHandler.sendWithPromise("RemoveAnnot",{annotPtr:s.annotPtr});case 26:m=y.sent;case 27:y.next=36;break;case 29:if(!s.isReply()){y.next=36;break}return d=this.getRootAnnotation(s),this.documentViewer.eventBus.dispatch("deleteReply",s),d.deleteReplyAnnotation(s),y.next=35,this.documentViewer.messageHandler.sendWithPromise("RemoveAnnot",{annotPtr:s.annotPtr});case 35:m=y.sent;case 36:if(!m||!m.code){y.next=40;break}return this.documentViewer.eventBus.dispatch("message",{type:"ERROR",message:m.message}),console.log(m.message),y.abrupt("return");case 40:u--,y.next=5;break;case 43:0<o.length&&this.documentViewer.eventBus.dispatch("annotationChanged",o,"delete"),0<r.length&&this.documentViewer.eventBus.dispatch("annotationSelected",r,"deselected");case 45:case"end":return y.stop()}},n,this)}))}},{key:"getRootAnnotation",value:function(e){return e.isReply()?this.getAnnotationById(e.inReplyTo):e}},{key:"getAnnotationById",value:function(e,n){if(n=n||this.annotations,!e)return null;for(var o=0;o<n.length;o++)if(n[o].name===e)return n[o];return null}},{key:"selectAnnotation",value:function(e){if(e){var n=this.documentViewer.annotationStore.selectedElementName;if(n){var o=this.getAnnotationById(n);o.handleOutside&&o.handleOutside()}this.hasAnnotation(e)&&e.selectAnnotation()}}},{key:"emptyAnnotations",value:function(){for(var e=this.annotations,n=0;n<e.length;n++)e[n].delete()}},{key:"deselectAnnotation",value:function(e){if(e){var n=this.documentViewer.annotationStore.selectedElementName;if(n&&e.name===n){var o=this.getAnnotationById(e.name);o.handleOutside&&o.handleOutside()}}}},{key:"getSelectedAnnotation",value:function(){var e=this.documentViewer.annotationStore.selectedElementName;return e?this.getAnnotationById(e):null}},{key:"getFocusedAnnotation",value:function(){return this.focusedAnnotation}},{key:"getConsecutiveAnnotations",value:function(){var e=this.documentViewer.skipNoRequired,n=this.documentViewer.consecutiveType,o=["textfield","checkbox","radiobutton","listbox","combobox","signatureFields"],r=this.annotations.filter(function(u){var s=o.includes(u.type);if(!s)return!1;var w=u.isHidden,m=!e||u.isRequired(),v=s&&(n==="signForm"||n==="form"&&u.type!=="signatureFields"||n==="sign"&&u.type==="signatureFields");return s&&!w&&m&&v}).sort(function(u,s){return u.PageNumber-s.PageNumber||u.Y-s.Y});return r}},{key:"getPreviousConsecutiveAnnotation",value:function(){var e=this;if(!this.focusedAnnotation)return null;var n=this.getConsecutiveAnnotations(),o=n.findIndex(function(r){return r===e.focusedAnnotation});return o===0?o=n.length-1:o--,n[o]}},{key:"getNextConsecutiveAnnotation",value:function(){var e=this;if(!this.focusedAnnotation)return null;var n=this.getConsecutiveAnnotations(),o=n.findIndex(function(r){return r===e.focusedAnnotation});return o===n.length-1?o=0:o++,n[o]}},{key:"setAnnotationStyles",value:function(e,n){Object.keys(n).forEach(function(o){e[o]=n[o]})}},{key:"getCurrentUser",value:function(){return this.author}},{key:"setCurrentUser",value:function(e){this.author}},{key:"createAnnotation",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.documentViewer.annotationHistory.push(e),!(Number(e.pageIndex)+1>this.documentViewer.pagesCount)){s.next=3;break}return s.abrupt("return");case 3:return!e.author&&(e.author=this.documentViewer.annotator),!e.date&&(e.date=new Date),!e.name&&(e.name=v4()),o=this.documentViewer.pagesPtr[e.pageIndex].pagePtr,s.next=9,this.documentViewer.messageHandler.sendWithPromise("CreateAnnotation",{doc:this.documentViewer.doc,pagePtr:o,annotation:e});case 9:if(!(r=s.sent)||!r.code){s.next=14;break}return this.documentViewer.eventBus.dispatch("message",{type:"ERROR",message:r.message}),console.log(r.message),s.abrupt("return",r);case 14:return u=r.annotPtr,e.doc=this.documentViewer.doc,e.pagePtr=o,e.annotPtr=u,s.abrupt("return",e);case 19:case"end":return s.stop()}},n,this)}))}},{key:"createMeasurementAnnotation",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){var o,r,u,s;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.documentViewer.annotationHistory.push(e),!(Number(e.pageIndex)+1>this.documentViewer.pagesCount)){w.next=3;break}return w.abrupt("return");case 3:return!e.operate&&(e.operate="add-annot"),!e.author&&(e.author=this.documentViewer.annotator),!e.date&&(e.date=new Date),o=this.documentViewer.pagesPtr[e.pageIndex].pagePtr,w.next=9,this.documentViewer.messageHandler.sendWithPromise("CreateMeasurementAnnotation",{doc:this.documentViewer.doc,pagePtr:o,annotation:e});case 9:if(!(r=w.sent)||!r.code){w.next=14;break}return this.documentViewer.eventBus.dispatch("message",{type:"ERROR",message:r.message}),console.log(r.message),w.abrupt("return",r);case 14:return u=r.annotPtr,s=r.rulerPtr,e.doc=this.documentViewer.doc,e.pagePtr=o,e.annotPtr=u,e.rulerPtr=s,w.abrupt("return",e);case 20:case"end":return w.stop()}},n,this)}))}},{key:"editMeasurementAnnotation",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function n(){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,this.documentViewer.messageHandler.sendWithPromise("EditMeasurementAnnotation",{doc:this.documentViewer.doc,annotation:e});case 4:this.documentViewer.eventBus.dispatch("annotationUpdated",{annotations:this.documentViewer.annotations});case 5:case"end":return o.stop()}},n,this)}))}},{key:"drawAnnotations",value:function(e){var n=e.pageNumber;this.getAnnotationsList().filter(function(o){return o.PageNumber===n}).forEach(function(o){o.draw()})}},{key:"drawAnnotationsFromList",value:function(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)e[n].draw()}},{key:"pushAnnotationToLayer",value:function(e){var n,o;if(this.addAnnotation(e),this.documentViewer.pdfViewer){var r=(o=(n=this.documentViewer.pdfViewer)===null||n===void 0?void 0:n._pages)===null||o===void 0?void 0:o[e.annotation.pageIndex];r&&r.compdfAnnotationLayer&&r.compdfAnnotationLayer.annotationsArray.push(e)}}},{key:"reset",value:function(){this.annotations=[],this.selectedAnnotations=[]}}])}(),fileToArrayBuffer=function(e){return new Promise(function(n){var o=new FileReader;o.onload=function(r){var u;n((u=r.target)===null||u===void 0?void 0:u.result)},o.readAsArrayBuffer(e)})};function isBase64(e){return typeof e!="string"?!1:e.length%4==0&&/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/.test(e)}function base64ToArrayBuffer(e){for(var n=e.includes("base64,")?e.split("base64,")[1]:e,o=window.atob(n),r=o.length,u=new Uint8Array(r),s=0;s<r;s++)u[s]=o.charCodeAt(s);return u.buffer}var getElementPosition=function(e){var n=e.getBoundingClientRect();return{top:n.top+window.pageYOffset,left:n.left+window.pageXOffset}};function isDataScheme(e){for(var n=e.length,o=0;o<n&&e[o].trim()==="";)o++;return e.substring(o,o+5).toLowerCase()==="data:"}function getPdfFilenameFromUrl(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof e!="string"||isDataScheme(e))return n;var o=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e),u=o.exec(r[1])||o.exec(r[2])||o.exec(r[3]);if(u&&(u=u[0]).includes("%"))try{u=o.exec(decodeURIComponent(u))[0]}catch{}return u||n}pdfExports.GlobalWorkerOptions.workerSrc="./lib/pdf.worker.min.js";var CMAP_URL="./cmaps/";function onKeyDown(e){if(this._isCtrlKeyDown=e.key==="Control",e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"){var n=e.keyCode||e.which;if(n===8||n===46){var o=annotationStore.selectedElementName;if(o){var r=this.annotationManager.getAnnotationById(o);if(r){if(r.type==="freetext"&&r.editing)return;this.deleteAnnotations([r])}}}else if(n===27){var u=annotationStore.selectedElementName;u&&this.deselectAnnotation({name:u})}}}function onKeyUp(e){e.key==="Control"&&(this._isCtrlKeyDown=!1)}function onWheel(e){if(this._isCtrlKeyDown){var n={x:e.clientX,y:e.clientY};if(e.preventDefault(),document.visibilityState!=="hidden"){var o=normalizeWheelEventDirection(e),r=e.deltaMode,u=0;r===WheelEvent.DOM_DELTA_LINE||r===WheelEvent.DOM_DELTA_PAGE?u=Math.abs(o)>=1?Math.sign(o):this._accumulateTicks(o):u=this._accumulateTicks(o/30),this.updateZoom(u,null,n)}}}var ComPDFKitViewer=function(){return _createClass(function Re(Te){_classCallCheck(this,Re),_defineProperty$1(this,"_pwd",""),_defineProperty$1(this,"_oldPwd",""),_defineProperty$1(this,"_textSearch",null),_defineProperty$1(this,"_activeSearchIndex",0),_defineProperty$1(this,"_fileList",null),_defineProperty$1(this,"_version","2.8.1"),_defineProperty$1(this,"_wheelUnusedTicks",0),this.config=Te,this.annotationStore=annotationStore,this.viewerContainer=null,this.pdfLoadingTask=null,this.printService=null,this.pdfSidebar=null,this.pdfOutlineViewer=null,this.outlines=[],this.pdfLayerViewer=null,this.pdfDocument=null,this.downloadComplete=!1,this.isInitialViewSet=!1,this.pdfLinkService=null,this.externalServices=GenericExternalServices,this.percent=0,this.onError=function(){},this.pageChangedCallback=null,this.scaleChangedCallback=null,this.annotationsNumChangedCallback=null,this.distanceChangedCallback=null,this.permissionPasswordCallback=null,this.verified=!1,this.fillConsecutively=!1,this.skipNoRequired=!1,this.consecutiveType=!1,this.readOnly=!1,this._license="",this._token=null,this._pdfId=null,this.annotations=null,this.annotationHistory=[],this._annotationMode=0,this._boundEvents=Object.create(null),this._title=document.title,this.activeTool="",this.color="color",this.pagesPtr=[],this.saveAction=null,this.enableReply=!0,this.isAnnotationPopup=!0,this.enableDefaultFont=!1,this.annotationPermission=!1,this.userAdmin=!0,this.isEnablePageFocus=!1,this.enableCustomFont=!1,this.fontsJson=null,this._permission={allowsPrinting:!0,allowsCopying:!0,allowsDocumentChanges:!0},this.webFontURL="https://www.compdf.com/fonts/",this.optionUrl={baseUrl:"https://wms.compdf.com",verifyUrl:"/api/license/verify/v2",webviewBaseUrl:"https://web-viewer-backend.compdf.com",uploadUrl:"/web-viewer/annotate/openPdfToAnnotate",editUrl:"/web-viewer/annotate/edit",saveUrl:"/web-viewer/annotate/save",flattenUrl:"/web-viewer/annotate/saveAndFlatten",uploadAnnotationsUrl:"/web-viewer/annotate/importAnnotateToPdf",downloadAnnotation:"/web-viewer/annotate/exportAnnotate",compareUrl:"/web-viewer/annotate/pdfCompare"},this.eventBus=new EventBus,this.toolMode="",this.$t=Te.$t,this.annotationStore.$t=Te.$t,this.fontFileInited=!1,this.contentEditAnnotationsManager={},this.initWorker(),this.annotator="Guest",this.isAnnotationModified=!1,this.isContentEditModyfied=!1,this.redactionList=[],this.layers=[],this.ocgsPtr=null,this.isRenderAnnotations=!1,this.colorList=[],this.renderLayerPermission=!1,this.queue=[],this.isProcessing=!1},[{key:"enqueue",value:function(Re){var Te=this;return new Promise(function(He,Fe){var ze=function(){var We=_asyncToGenerator(_regeneratorRuntime().mark(function Ue(){var et;return _regeneratorRuntime().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return it.prev=0,it.next=3,Re();case 3:et=it.sent,He(et),it.next=10;break;case 7:it.prev=7,it.t0=it.catch(0),Fe(it.t0);case 10:case"end":return it.stop()}},Ue,null,[[0,7]])}));return function(){return We.apply(this,arguments)}}();Te.queue.push(ze),Te.processQueue()})}},{key:"_accumulateTicks",value:function(Re){(this._wheelUnusedTicks>0&&Re<0||this._wheelUnusedTicks<0&&Re>0)&&(this._wheelUnusedTicks=0),this._wheelUnusedTicks+=Re;var Te=Math.trunc(this._wheelUnusedTicks);return this._wheelUnusedTicks-=Te,Te}},{key:"processQueue",value:(ut=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te;return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:if(!this.isProcessing&&this.queue.length!==0){He.next=2;break}return He.abrupt("return");case 2:return this.isProcessing=!0,Te=this.queue.shift(),He.prev=4,He.next=7,Te();case 7:return He.prev=7,this.isProcessing=!1,this.processQueue(),He.finish(7);case 11:case"end":return He.stop()}},Re,this,[[4,,7,11]])})),function(){return ut.apply(this,arguments)})},{key:"pagesCount",get:function(){return this.doc?this._pagesCount:0}},{key:"annotationsCount",get:function(){return this.pdfViewer.annotationStorage?this.pdfViewer.annotationStorage.size:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(Re){this.pdfViewer.currentPageNumber=Re}},{key:"currentPageNumber",get:function(){return this.pdfViewer.currentPageNumber}},{key:"scale",get:function(){return this.pdfViewer.currentScale}},{key:"isDocumentModified",get:function(){return this.isAnnotationModified||this.isContentEditModyfied}},{key:"pagesRotation",get:function(){return this.pdfViewer.pagesRotation}},{key:"getPageWidth",value:function(Re){return this.pagesPtr[Re-1].width}},{key:"getPageHeight",value:function(Re){return this.pagesPtr[Re-1].height}},{key:"initWorker",value:function(){var Re=new PDFWorker;this.worker=Re;var Te=Re.messageHandler;this.messageHandler=Te}},{key:"_decrypt",value:function(Re){var Te=new JSEncrypt;Te.setPrivateKey(`MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCb9LJZzBAOR3YDT0/rLqY1pCu6
    ge7lb0aU4k/aTnxSz10t/JUUtGMvQ2tBy36hjwulouM6xoFSm8gnjovALuVpTltRPPEfN+uX6AVy
    Wa58TsS2+Q9JRPHJlOb4sDEriUnzLtonahqF/S/EiijMAkNc2b1KNNUb2bDNmLi6YvT7d1sh3iIf
    kTggsyt3UVUjh2exEVpb8Ww4grmLJjFssi5nZksLDhlA0MUr4dPmIcDl0RlIwHTsxrJbewnX7kNd
    MsSvCxYV1EtmBx9KRCu8ON2bRwKaaWd7fAT9yZWYpjQmbZ5A4CAqDcEAlW8RrhMv0FNKVn1/GMVu
    DC/PsWTyI1fJAgMBAAECggEAazkHThmwiEC1cH0dEzLVb1faALbIitHAkygtgognjb+n7rATx1Jm
    Rt5xZaEFBQqWFWEyHPzRePxF1nx4tL8JVydaPTZLCQ2nWp9Y70+dWTXGpY4C5nsSSWeojR6GD8qq
    Hxn9PtACQFDcgKIEfo6nxbSmIdjFFArNNe1kRDE5AZHtZi7Q6JDRewp6mESrSGED1JodQ4xJoEZl
    1HPvMTxcGGQk/8EZOWXaGvGuBEfIMc33g61YxxhWXb6Rf7x8QKpa2cRLbqN+74wdiWyQUAcSjZSi
    LzeY0a4h7DKkhBEHWXT4svrXsF1RjMRpTi8amxNgUP7RSSTiF9iT6fpGpnwWKQKBgQDsP18lwMjl
    blt8mKqrL9SKVMoOLKUaci9WNV14qEUgNp/RIqjflS0wasbRo7suix2Cwd58ZVAmueuH5W9ZM9NP
    A9RP5vnm8fqfqMZIq+Z7ORhry5QpGlOo0tKkik716kTRXl5w3O/YcR8wBZ7Xzwh467OYcRMNnr2i
    8F5eT4Ny5wKBgQCo/sQrc4KqsYwdWWZW+O92jIylxgtCQsZNg1cXql91IuB3lx1HnDaN/R2MeCkp
    ok+hYXWB0848321x+vYdL9ivLUrnHpNoycFEuhqNTYbyZWnq1tKPz9RDhPIwEmlQVW3dU9hWEjF5
    6sa4NXP7/lSiYaQe0FS4BYQ7KCwahxw5zwKBgQCyCYv92oxLguBFRJQR0EjfOsjO58xA4t5TnIHl
    hQIbJa9JH1KetEBK5Z0Rrc9JYyOJP+sYWg2OMbyTPE+urMTJHjypPosEBUX3fmx3pbxbDosd6Vyt
    oR588uw1fdnFr5fPJMwNSCMkPRPgz8uGHYrn/dDpyAUw1XlaSsUDU+7e7wKBgDHCej6VD3d1Od12
    cmTPfar5bXxuWOhUwxEVyDImr17NOyzbaPqp64JZcjbnNq+UpD/Pc4sbs5FG9HHoREmJyhKikniF
    D0B+j5LN/X13w3FiHRLR2EQSHN0YqzsuYKYP0X6m7n9BciIE2ChrTNB5LbB2cZ3FF/zrWukURhA1
    kkEPAoGBAIpoB6ehuqTn7cisbXjaLqwzX35y50+KED2TamB1FkTjfU5YPsSnKBX9CfCeEd+yr08r
    mecHPUYVj5SpLlcpzx+n7taJCzNJ4SuE186qwHR+MGAS3reXsz5l5GVu7WSH2uKZ7OuXnzCJC4/r
    dx/f2C0wOi6fdC46fAZVACROoV9T`);for(var He=Base64.decode(Re),Fe=He.length,ze="",We=0;We<Fe;){var Ue=Base64.encode(He.substr(We,256));ze+=Te.decrypt(Ue),We+=256}return ze||!1}},{key:"_verifyLicense",value:(tt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We;return _regeneratorRuntime().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return He=window.location.hostname.split(".").slice(-2).join("."),Fe=He,ze=this.messageHandler,Ue.next=5,ze.sendWithPromise("InitConfig",{license:Te,appId:Fe,version:this._version});case 5:return We=Ue.sent,Ue.abrupt("return",We);case 7:case"end":return Ue.stop()}},Re,this)})),function(Re){return tt.apply(this,arguments)})},{key:"_twoStepVerification",value:(gt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et=this;return _regeneratorRuntime().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return it.next=2,this._verifyLicense(Te);case 2:if(He=it.sent,Fe=Te,!He.code){it.next=16;break}return ze=window.location.hostname.split(".").slice(-2).join("."),We=CryptoJS.MD5("".concat(Te,"7").concat(ze,"compdfkitonlinelicense")).toString(),Ue={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({license:Fe,platform:7,app_id:ze,signature:We})},it.next=10,fetch(this.optionUrl.baseUrl+this.optionUrl.verifyUrl,Ue).then(function(nt){return nt.json()}).then(function(nt){if(nt.code===200){var dt=et._decrypt(nt.data.license);return dt||(et.eventBus.dispatch("message",{type:"ERROR",message:"Invalid License"}),console.log("Invalid License"),et.onError({type:"ERROR",message:"Invalid License"}),!1)}return et.eventBus.dispatch("message",{type:"ERROR",message:nt.message}),console.log(nt.message),et.onError({type:"ERROR",message:nt.message}),!1}).catch(function(nt){return et.eventBus.dispatch("message",{type:"ERROR",message:nt&&nt.message}),console.log({error:!0,message:nt.message}),et.onError({type:"ERROR",message:nt&&nt.message}),!1});case 10:if(Fe=it.sent){it.next=13;break}return it.abrupt("return",!1);case 13:return it.next=15,this._verifyLicense(Fe);case 15:He=it.sent;case 16:if(He.code){it.next=21;break}return this._license=Fe,it.abrupt("return",!0);case 21:return this.eventBus.dispatch("message",{type:"ERROR",message:He.message}),console.log(He.message),this.onError({type:"ERROR",message:He.message}),it.abrupt("return",!1);case 25:case"end":return it.stop()}},Re,this)})),function(Re){return gt.apply(this,arguments)})},{key:"initConfig",value:(ot=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue=this;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if(Te.license){et.next=5;break}return this.eventBus.dispatch("message",{type:"ERROR",message:"License code not exists"}),console.log("License code not exists"),this.onError({type:"ERROR",message:"License code not exists"}),et.abrupt("return",!1);case 5:return this.license=Te.license,et.prev=6,et.next=9,this.worker.promise;case 9:et.next=17;break;case 11:return et.prev=11,et.t0=et.catch(6),console.log(et.t0),this.eventBus.dispatch("message",{type:"ERROR",message:et.t0}),this.onError({type:"ERROR",message:et.t0}),et.abrupt("return");case 17:if("enableDefaultFont"in Te&&(this.enableDefaultFont=Te.enableDefaultFont),"annotationPermission"in Te&&(this.annotationPermission=Te.annotationPermission),"enableReply"in Te&&(this.enableReply=Te.enableReply),"isAnnotationPopup"in Te&&(this.isAnnotationPopup=Te.isAnnotationPopup),Te.enableCustomFont&&(this.enableCustomFont=!0),Te.webFontURL&&(this.enableCustomFont=!0,this.webFontURL=Te.webFontURL.endsWith("/")?Te.webFontURL:Te.webFontURL+"/"),!this.enableCustomFont){et.next=48;break}return He=this.webFontURL,et.next=27,fetch(He+"fonts.json");case 27:if(!(Fe=et.sent).ok){et.next=34;break}return et.next=31,Fe.json();case 31:this.fontsJson=et.sent,et.next=35;break;case 34:console.error("Invalid webFontURL");case 35:if(!(this.fontsJson&&this.fontsJson[0].filePath&&this.fontsJson[0].filePath.endsWith("brotli"))){et.next=47;break}return et.next=38,fetch(He+"font.ff");case 38:if(!(ze=et.sent).ok){et.next=46;break}return et.next=42,ze.arrayBuffer();case 42:We=et.sent,this._fileList=new Uint8Array(We),et.next=47;break;case 46:console.error("Invalid webFontURL");case 47:this.messageHandler.on("LoadFont",function(it){var nt=it.fontFamily;Ue.eventBus.dispatch("LoadFont",{fontFamily:nt})});case 48:Te.autoJumpNextSign&&(this.autoJumpNextSign=Te.autoJumpNextSign),Te.isRenderAnnotations&&(this.isRenderAnnotations=Te.isRenderAnnotations),Te.renderLayerPermission&&(this.renderLayerPermission=Te.renderLayerPermission),this.initColorFile(Te.colorFile);case 52:case"end":return et.stop()}},Re,this,[[6,11]])})),function(Re){return ot.apply(this,arguments)})},{key:"initializeViewer",value:function(Re){var Te=Re.container,He=Re.viewer,Fe=Re.thumbnailView,ze=Re.findbarView,We=Re.toggleButton;this._initializeViewerComponents({container:Te,viewer:He,thumbnailView:Fe,findbarView:ze,toggleButton:We}),this.initBindEvents(),Fe&&(this.bindEvents(),this.bindWindowEvents())}},{key:"setErrorCallback",value:function(Re){this.onError=Re}},{key:"setTool",value:function(Re){var Te=Re.tool,He=Re.color;this.activeTool=Te,this.color=He,this.eventBus.dispatch("toolChanged",{tool:Te,color:He})}},{key:"initAnnotations",value:function(Re){for(var Te=0;Te<Re.length;Te++){var He=Re[Te],Fe=this.initAnnotation(He);this.annotationManager.annotations.push(Fe)}}},{key:"enablePageFocus",value:function(){this.isEnablePageFocus=!0}},{key:"disablePageFocus",value:function(){this.isEnablePageFocus=!1}},{key:"isUserAdmin",value:function(){return this.userAdmin}},{key:"promoteUserToAdmin",value:function(){this.userAdmin=!0,this.readOnly=!1;var Re=this.annotationManager.getSelectedAnnotation();Re&&Re.setPopupElementStyle&&Re.setPopupElementStyle(),this.eventBus.dispatch("updateAnnotationPermission")}},{key:"demoteUserFromAdmin",value:function(){this.userAdmin=!1;var Re=this.annotationManager.getSelectedAnnotation();Re&&Re.setPopupElementStyle&&Re.setPopupElementStyle(),this.eventBus.dispatch("updateAnnotationPermission")}},{key:"enableReadOnlyMode",value:function(){this.readOnly=!0,this.userAdmin=!1;var Re=this.annotationManager.getSelectedAnnotation();Re&&Re.setPopupElementStyle&&Re.setPopupElementStyle(),this.eventBus.dispatch("updateAnnotationPermission")}},{key:"disableReadOnlyMode",value:function(){this.readOnly=!1;var Re=this.annotationManager.getSelectedAnnotation();Re&&Re.setPopupElementStyle&&Re.setPopupElementStyle(),this.eventBus.dispatch("updateAnnotationPermission")}},{key:"isReadOnlyModeEnabled",value:function(){return this.readOnly}},{key:"enableAnnotationPermission",value:function(){this.annotationPermission=!0}},{key:"disableAnnotationPermission",value:function(){this.annotationPermission=!1}},{key:"initAnnotation",value:function(Re){var Te=this.getAnnotationManager();if(!Re||!Te)return null;var He=Te.annotationsType,Fe=null,ze=Re.type;return["square","circle"].includes(ze)&&!Re.measure&&(Fe=He.square),ze!=="ink"||Re.inkPointes[0].length!==3&&!Re.arcPoints||(Fe=He.arc),ze==="ink"&&Re.measure&&(Fe=He.curve),new(Fe=Fe||He[ze])(Re)}},{key:"handleAnnotations",value:(bt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe,ze,We,Ue,et,it,nt,dt,xt;return _regeneratorRuntime().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:if(ze=He.show,!(Number(Te.pageIndex)+1>this.pagesCount)){yt.next=3;break}return yt.abrupt("return");case 3:return"destPage"in Te&&(Te.doc=this.doc,Te.pageHeight=this.pagesPtr[Te.pageIndex].height),!Te.author&&(Te.author=this.annotator),!Te.date&&(Te.date=new Date),!Te.name&&(Te.name=v4()),We=this.pagesPtr[Te.pageIndex].pagePtr,yt.next=10,this.messageHandler.sendWithPromise("CreateAnnotation",{doc:this.doc,pagePtr:We,annotation:Te});case 10:if(!(Ue=yt.sent)||!Ue.code){yt.next=16;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Ue.message}),console.log(Ue.message),this.onError({type:"ERROR",message:Ue.message}),yt.abrupt("return",Ue);case 16:if(et=Ue.annotPtr,Te.pagePtr=We,Te.annotPtr=et,it=this.getAnnotationManager(),nt=it.annotationsType[Te.type],Te.measure||Te.type!=="circle"||(nt=it.annotationsType.square),Te.type==="ink"&&(Te.inkPointes.length&&Te.inkPointes[0].length===3||Te.arcPoints)&&(nt=it.annotationsType.arc),Te.type==="ink"&&Te.measure&&(nt=it.annotationsType.curve),Te.type==="freetext"&&Te.intent&&Te.intent==="FreeTextCallout"&&(nt=it.annotationsType.callout),nt&&(Te.type!=="link"||(Fe=Te.url)===null||Fe===void 0||!Fe.startsWith("af://"))){yt.next=27;break}return yt.abrupt("return");case 27:return dt=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"].includes(Te.type)?this.annotationStore.highlightForm:this.annotationStore.highlightLink,(xt=new nt({highlight:dt,documentViewer:this,annotation:Te,show:ze,enableReply:this.enableReply})).draw(),it.addAnnotations([xt]),Te.type==="redact"&&this.redactionList.push(xt),yt.abrupt("return",xt);case 34:case"end":return yt.stop()}},Re,this)})),function(Re,Te){return bt.apply(this,arguments)})},{key:"addAnnotations",value:(Vt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt;return _regeneratorRuntime().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:Te=Array.isArray(Te)?Te:[Te],He=["highlight","underline","strikeout","squiggly"],Fe=0;case 3:if(!(Fe<Te.length)){yt.next=12;break}if(ze=Te[Fe],He.includes(ze.type)&&(We=[],ze.quadPoints&&!ze.quadPoints[0].PointX&&!ze.quadPoints[0].PointY)){for(Ue=0;Ue<ze.quadPoints.length;Ue++)et=ze.quadPoints[Ue],it=et.left,nt=et.top,dt=et.right,xt=et.bottom,We.push({PointX:it,PointY:nt}),We.push({PointX:dt,PointY:nt}),We.push({PointX:it,PointY:xt}),We.push({PointX:dt,PointY:xt});ze.quadPoints=We}return ze.backgroundColor&&(ze.fillColor=ze.backgroundColor),yt.next=9,this.handleAnnotations(ze,{show:!1});case 9:Fe++,yt.next=3;break;case 12:case"end":return yt.stop()}},Re,this)})),function(Re){return Vt.apply(this,arguments)})},{key:"deleteAnnotations",value:(mt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,this.getAnnotationManager().deleteAnnotations(Te);case 2:case"end":return He.stop()}},Re,this)})),function(Re){return mt.apply(this,arguments)})},{key:"addEvent",value:function(Re,Te){this.eventBus._on(Re,Te)}},{key:"removeEvent",value:function(Re,Te){this.eventBus._off(Re,Te)}},{key:"loadDocument",value:(kt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt=this,xt=arguments;return _regeneratorRuntime().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:if(He=xt.length>1&&xt[1]!==void 0?xt[1]:{},this.verified){yt.next=6;break}return yt.next=4,this._twoStepVerification(this.license);case 4:Fe=yt.sent,this.verified=Fe;case 6:if(this.verified){yt.next=8;break}return yt.abrupt("return",{verified:this.verified});case 8:if(!this.pdfLoadingTask){yt.next=11;break}return yt.next=11,this.close();case 11:if(He.annotations&&parseAnnotationFromXml(He.annotations),this.onError=He.onError||this.onError,this.info=He.info||null,this.pageChangedCallback=He.pageChangedCallback||this.pageChangedCallback,this.scaleChangedCallback=He.scaleChangedCallback||this.scaleChangedCallback,this.annotationsNumChangedCallback=He.annotationsNumChangedCallback||this.annotationsNumChangedCallback,this.distanceChangedCallback=He.distanceChangedCallback||this.distanceChangedCallback,this.permissionPasswordCallback=He.permissionPasswordCallback||this.permissionPasswordCallback,this.onError=He.onError||function(){},this.annotations=null,annotationStore.annotationsAll=null,annotationStore.signatures=null,annotationStore.selectedName=null,this.ocgsPtr=null,annotationStore.ignoreColors=[],this.fontFileInited=!1,this.saveAction=He.saveAction||null,this.isAnnotationModified=!1,this.isContentEditModyfied=!1,this.colorList=[],ze={cMapUrl:CMAP_URL,cMapPacked:!0,enableXfa:!0},typeof Te!="string"){yt.next=36;break}ze.url=Te,yt.next=61;break;case 36:if(!Te||!(Te instanceof ArrayBuffer||"byteLength"in Te)){yt.next=40;break}ze.data=Te,yt.next=61;break;case 40:if(!Te||!(Te instanceof Blob||Te instanceof File)){yt.next=47;break}return yt.next=43,fileToArrayBuffer(Te);case 43:We=yt.sent,ze.data=We,yt.next=61;break;case 47:if((_typeof$1(Te)==="object"||typeof Te=="function")&&Te!==null&&Te.byteLength!==void 0){yt.next=53;break}return yt.next=50,fileToArrayBuffer(Te);case 50:ze.data=yt.sent,yt.next=61;break;case 53:if(!isBase64(Te)){yt.next=60;break}return yt.next=56,base64ToArrayBuffer(Te);case 56:Ue=yt.sent,ze.data=Ue,yt.next=61;break;case 60:Te.url&&Te.originalUrl&&(ze.url=Te.url);case 61:return ze.password=He.password||"",this._pwd=ze.password,et=pdfExports.getDocument(ze),this.pdfLoadingTask=et,this._docName=He.filename||getPdfFilenameFromUrl(ze.url),it=function(Bt){return dt._pwd=Bt},nt=function(Bt,Pt){dt._oldPwd&&He.notUpdatePwd?(it(dt._oldPwd),Bt(dt._oldPwd),et.onPassword=null):He.pwd?(it(He.pwd),Bt(He.pwd),et.onPassword=null):(dt.passwordPrompt.setUpdateCallback(Bt,Pt,it),dt.passwordPrompt.open())},et.onPassword=nt,et.onProgress=function(Bt){var Pt=Bt.loaded,Tt=Bt.total;(He.progress||dt.progress).call(dt,Pt/Tt)},yt.abrupt("return",et.promise.then(function(){var Bt=_asyncToGenerator(_regeneratorRuntime().mark(function Pt(Tt){return _regeneratorRuntime().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:return ct.next=2,Tt.getData().then(function(){var wt=_asyncToGenerator(_regeneratorRuntime().mark(function St(Ft){var Gt,jt,Ut,Jt,un;return _regeneratorRuntime().wrap(function(nn){for(;;)switch(nn.prev=nn.next){case 0:return dt.pdfDocument=Tt,He.notUpdatePwd||(dt._oldPwd=dt._pwd),Gt=new Uint8Array(Ft),nn.next=5,dt.messageHandler.sendWithPromise("LoadFile",{doc:dt.doc,pagesPtr:dt.pagesPtr,buffer:Gt,webFontURL:dt.webFontURL,fileList:dt._fileList,fontsJson:dt.fontsJson,enableDefaultFont:dt.enableDefaultFont});case 5:return jt=nn.sent,dt.doc=jt,nn.next=9,dt.messageHandler.sendWithPromise("LoadDocumentByStream",{doc:dt.doc,fileId:0,length:Gt.length,password:dt._pwd});case 9:for(Jt in Ut=nn.sent)dt._permission[Jt]=!!Ut[Jt];return dt.contentEditAnnotationsManager.addTextEditor=function(Zt){var en=Zt.pageNumber;if(en>dt.pagesCount||en<1)throw new Error({message:"Invalid pageNumber"});dt.toolMode!=="editor"&&dt.setToolMode("editor"),dt.currentPageNumber!==en&&dt.pdfViewer.scrollPageIntoView({pageNumber:en});var Cn=en-1,$n=dt.pdfViewer._pages[Cn];if($n)return $n.addTextEditor(Zt)},dt.contentEditAnnotationsManager.getEditAnnotation=function(){var Zt=_asyncToGenerator(_regeneratorRuntime().mark(function en(Cn){var $n,Rn,Nn;return _regeneratorRuntime().wrap(function(zn){for(;;)switch(zn.prev=zn.next){case 0:if(!(Cn>dt.pagesCount||Cn<1)){zn.next=2;break}throw new Error({message:"Invalid pageNumber"});case 2:if(dt.toolMode!=="editor"&&dt.setToolMode("editor"),dt.currentPageNumber!==Cn&&dt.pdfViewer.scrollPageIntoView({pageNumber:Cn}),$n=Cn-1,!(Rn=dt.pdfViewer._pages[$n])){zn.next=11;break}return zn.next=9,Rn.getEditAnnotation();case 9:return Nn=zn.sent,zn.abrupt("return",Nn);case 11:case"end":return zn.stop()}},en)}));return function(en){return Zt.apply(this,arguments)}}(),un=null,nn.next=16,dt.initPage();case 16:if(dt.isRenderAnnotations){nn.next=20;break}return nn.next=19,dt.getAnnotations();case 19:un=nn.sent;case 20:un&&dt.initAnnotations(un),dt.maxViewportZoom=dt.calculateMaxViewportZoom();case 22:case"end":return nn.stop()}},St)}));return function(St){return wt.apply(this,arguments)}}());case 2:return ct.next=4,dt.load(Tt);case 4:return ct.abrupt("return",{pwd:dt._pwd,verified:dt.verified});case 5:case"end":return ct.stop()}},Pt)}));return function(Pt){return Bt.apply(this,arguments)}}(),function(Bt){if(et===dt.pdfLoadingTask){var Pt="loading_error";return Bt instanceof pdfExports.InvalidPDFException?(Pt="Invalid or corrupted PDF file.",console.warn("Invalid or corrupted PDF file.")):Bt instanceof pdfExports.MissingPDFException?(Pt="Missing PDF file.",console.warn("Missing PDF file.")):Bt instanceof pdfExports.UnexpectedResponseException?(Pt="Unexpected server response.",console.warn("Unexpected server response.")):Bt&&(Bt.message==="No password given."?(Pt="No password given.",console.warn("No password given.")):Bt.message==="Incorrect Password."&&(Pt="Incorrect Password.",console.warn("Incorrect Password."))),dt.onError&&dt.onError({type:"ERROR",message:Pt}),new Promise(function(Tt,ct){ct(Pt)})}}));case 71:case"end":return yt.stop()}},Re,this)})),function(Re){return kt.apply(this,arguments)})},{key:"getSelectedText",value:function(Re){if(Re){var Te=this.pdfViewer._pages[Re-1];if(Te)return Te.selectedText}return this.pdfViewer._pages.map(function(He){return He.selectedText}).filter(function(He){return He!==null}).join(`
`)}},{key:"getSelectedTextQuads",value:function(Re){if(Re){var Te=this.pdfViewer._pages[Re-1];if(Te)return Te.selectedTextQuads}var He=this.pdfViewer._pages.map(function(Fe){return Fe.selectedTextQuads}).filter(function(Fe){return Fe!==null});return He.length?He:null}},{key:"getWebFontNameList",value:(Ct=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){return _regeneratorRuntime().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return Te.next=2,this.messageHandler.sendWithPromise("GetWebFontNameList");case 2:return Te.abrupt("return",Te.sent);case 3:case"end":return Te.stop()}},Re,this)})),function(){return Ct.apply(this,arguments)})},{key:"getOutlines",value:function(){if(this.outlines)return this.outlines}},{key:"scrollPageIntoView",value:function(Re){Re.pageNumber}},{key:"search",value:(vt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe,ze,We;return _regeneratorRuntime().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Fe=He===void 0?this.pagesPtr:[this.pagesPtr[He-1]],Ue.next=3,this.messageHandler.sendWithPromise("Search",{pagesPtr:Fe,value:Te});case 3:if(!(ze=Ue.sent)||!ze.code){Ue.next=8;break}return this.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),Ue.abrupt("return");case 8:return We=ze.searchResults,this.searchResults=We,this.eventBus.dispatch("search",We),We.length?this.setActiveSearchResult():(this.clearSearchResults(),this._activeSearchIndex=0),Ue.abrupt("return",We);case 13:case"end":return Ue.stop()}},Re,this)})),function(Re,Te){return vt.apply(this,arguments)})},{key:"searchInPage",value:(ht=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He,Fe){var ze,We,Ue;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return ze=He===void 0?this.pagesPtr:[this.pagesPtr[He-1]],et.next=3,this.messageHandler.sendWithPromise("Search",{pagesPtr:ze,value:Te});case 3:if(!(We=et.sent)||!We.code){et.next=8;break}return this.eventBus.dispatch("message",{type:"ERROR",message:We.message}),console.log(We.message),et.abrupt("return");case 8:return Ue=We.searchResults,this.searchPageResults=Ue,this.eventBus.dispatch("search",Ue,Fe),Ue.length||(this.clearSearchResults(),this.searchPageResults=null),et.abrupt("return",Ue);case 13:case"end":return et.stop()}},Re,this)})),function(Re,Te,He){return ht.apply(this,arguments)})},{key:"setActiveSearchResult",value:function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.searchResults){var He=Re||this.searchResults[0],Fe=He.quads[0],ze=Fe.left*this.scale,We=Fe.top*this.scale,Ue=this.pdfViewer._pages[He.pageNum-1];if(this.pdfViewer.currentPageNumber=He.pageNum,scrollIntoView(Ue.div,{left:ze,top:We}),Re){var et=this.searchResults[this._activeSearchIndex];this.pdfViewer._pages[et.pageNum-1].clearActiveSearchResult(et),Ue.setActiveSearchResult(Re),this._activeSearchIndex=Te}else Ue.setActiveSearchResult(He),this._activeSearchIndex=0}}},{key:"clearSearchResults",value:function(){if((this.searchResults||this.searchPageResults)&&this.pdfViewer&&this.pdfViewer._pages&&this.pdfViewer._pages.length){for(var Re=0;Re<this.pdfViewer._pages.length;Re++)this.pdfViewer._pages[Re].clearSearchResults();this.searchResults=null,this.searchPageResults=null}}},{key:"initPage",value:(rt=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.next=2,this.messageHandler.sendWithPromise("GetPageCount",{doc:this.doc});case 2:Te=We.sent,this._pagesCount=Te,this.pagesPtr=[],He=0;case 6:if(!(He<Te)){We.next=17;break}return We.next=9,this.messageHandler.sendWithPromise("GetPageSize",{doc:this.doc,pageIndex:He});case 9:return Fe=We.sent,We.next=12,this.messageHandler.sendWithPromise("InitText",{pagePtr:Fe.pagePtr});case 12:ze=We.sent,this.pagesPtr.push({doc:this.doc,pageNumber:He+1,pagePtr:Fe.pagePtr,textPtr:ze,width:Fe.width,height:Fe.height,rotation:Fe.rotation});case 14:He++,We.next=6;break;case 17:case"end":return We.stop()}},Re,this)})),function(){return rt.apply(this,arguments)})},{key:"getAnnotations",value:(Je=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt;return _regeneratorRuntime().wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Te=this.pagesPtr,He=[],Fe=[],Pt.prev=2,Pt.next=5,this.messageHandler.sendWithPromise("InitAnnot",{doc:this.doc,pagesPtr:Te});case 5:ze=Pt.sent,He=ze.annotations,Fe=ze.signatures,Pt.next=14;break;case 10:Pt.prev=10,Pt.t0=Pt.catch(2),this.eventBus.dispatch("message",{type:"ERROR",message:Pt.t0&&Pt.t0.message}),console.log(Pt.t0&&Pt.t0.message);case 14:this.annotationStore.signatures=Fe,this.pdfViewer.pagesPtr=this.pagesPtr,We=this.annotationManager,Ue=0;case 18:if(!(Ue<He.length)){Pt.next=35;break}if(it=He[Ue],nt=We.annotationsType[it.type],it.measure||it.type!=="circle"||(nt=We.annotationsType.square),it.type==="ink"&&it.measure&&(nt=We.annotationsType.curve),it.type==="ink"&&(it.inkPointes.length&&it.inkPointes[0].length===3||it.arcPoints)&&(nt=We.annotationsType.arc),it.type==="freetext"&&it.intent&&it.intent==="FreeTextCallout"&&(nt=We.annotationsType.callout),nt&&(it.type!=="link"||(et=it.url)===null||et===void 0||!et.startsWith("af://"))){Pt.next=27;break}return Pt.abrupt("continue",32);case 27:if(dt=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"].includes(it.type)?this.annotationStore.highlightForm:this.annotationStore.highlightLink,xt=new nt({documentViewer:this,annotation:it,enableReply:this.enableReply,highlight:dt}),it.replies&&it.replies.length)for(yt=0;yt<it.replies.length;yt++)Bt=new We.annotationsType.text({documentViewer:this,annotation:it.replies[yt]}),xt.replies.push(Bt);We.annotations.push(xt);case 32:Ue++,Pt.next=18;break;case 35:case"end":return Pt.stop()}},Re,this,[[2,10]])})),function(){return Je.apply(this,arguments)})},{key:"reRenderAnnotations",value:(Ke=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return(Te=this.getAnnotationManager()).reset(),Fe.next=4,this.getAnnotations();case 4:He=Te.getAnnotationsList(),Te.drawAnnotationsFromList(He),this.eventBus.dispatch("annotationChanged",He,"add");case 7:case"end":return Fe.stop()}},Re,this)})),function(){return Ke.apply(this,arguments)})},{key:"getDocumentID",value:(qe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te;return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,this.messageHandler.sendWithPromise("GetCurrentID2",{doc:this.doc});case 2:return Te=He.sent,He.abrupt("return",Te);case 4:case"end":return He.stop()}},Re,this)})),function(){return qe.apply(this,arguments)})},{key:"setDocumentID",value:(Xe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Te&&Te.length===32){Fe.next=3;break}return console.log("The length of the id must be 32"),Fe.abrupt("return",!1);case 3:return Fe.next=5,this.messageHandler.sendWithPromise("SetTrailerID2",{doc:this.doc,id:Te});case 5:return He=Fe.sent,Fe.abrupt("return",!!He);case 7:case"end":return Fe.stop()}},Re,this)})),function(Re){return Xe.apply(this,arguments)})},{key:"supportsFullscreen",get:function(){return shadow$1(this,"supportsFullscreen",document.webkitFullscreenEnabled||document.mozFullscreenEnabled||document.fullscreenEnabled)}},{key:"removeAllAnnotations",value:function(){this.pdfViewer.annotationStorage&&this.pdfViewer.annotationStorage.cleanup()}},{key:"importAnnotations",value:(Ge=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return typeof Te=="string"&&(Te=new Blob([Te],{type:"application/xfdf"})),We.next=3,new Promise(function(Ue){var et=new FileReader;et.onload=function(it){var nt=it.target.result;Ue(nt)},et.readAsArrayBuffer(Te)});case 3:return He=We.sent,Fe=new Uint8Array(He),We.next=7,this.messageHandler.sendWithPromise("XFDFImportAnnotations",{doc:this.doc,xfdfBuffer:Fe});case 7:if(!(ze=We.sent)||!ze.code){We.next=12;break}return this.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),We.abrupt("return",!1);case 12:this.emptyAnnotations(),this.reRenderAnnotations();case 14:case"end":return We.stop()}},Re,this)})),function(Re){return Ge.apply(this,arguments)})},{key:"importFormAnnotations",value:(je=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return typeof Te=="string"&&(Te=new Blob([Te],{type:"application/xfdf"})),We.next=3,new Promise(function(Ue){var et=new FileReader;et.onload=function(it){var nt=it.target.result;Ue(nt)},et.readAsArrayBuffer(Te)});case 3:return He=We.sent,Fe=new Uint8Array(He),We.next=7,this.messageHandler.sendWithPromise("XFDFImportFormAnnotations",{doc:this.doc,xfdfBuffer:Fe});case 7:if(!(ze=We.sent)||!ze.code){We.next=12;break}return this.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),We.abrupt("return",!1);case 12:this.emptyAnnotations(),this.reRenderAnnotations();case 14:case"end":return We.stop()}},Re,this)})),function(Re){return je.apply(this,arguments)})},{key:"saveAnnotations",value:function(){if(this.pdfDocument&&this.info){var Re,Te=[],He=_createForOfIteratorHelper(this.pdfViewer.annotationStorage._storage);try{for(He.s();!(Re=He.n()).done;){var Fe=_slicedToArray(Re.value,2),ze=(Fe[0],Fe[1]);Te.push(ze.annotationObj)}}catch(We){He.e(We)}finally{He.f()}this.uploadAnnotations({append_objects:Te,tid:this.info.tid})}}},{key:"initApiUrl",value:function(Re){this.optionUrl=Re}},{key:"getPermission",value:function(Re){return this._permission[Re]}},{key:"checkPermissionPassword",value:(Oe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.prev=0,ze.next=3,this.messageHandler.sendWithPromise("CheckOwnerPassword",{doc:this.doc,pwd:Te});case 3:if(!ze.sent){ze.next=10;break}for(Fe in He=this._permission,this._permission)He[Fe]=!0;return ze.abrupt("return",!0);case 10:return ze.abrupt("return",!1);case 11:ze.next=16;break;case 13:return ze.prev=13,ze.t0=ze.catch(0),ze.abrupt("return",!1);case 16:case"end":return ze.stop()}},Re,this,[[0,13]])})),function(Re){return Oe.apply(this,arguments)})},{key:"setPassword",value:function(Re){var Te=Re.password,He=Re.permissionPassword,Fe=Re.permission;return this.saveAction="set",Te!==void 0&&(this._pwd=Te),He!==void 0&&(this._permissionPwd=He,this._setPermission={allowsPrinting:!Fe.allowsPrinting,allowsCopying:!Fe.allowsCopying,allowsDocumentChanges:!Fe.allowsDocumentChanges}),!0}},{key:"removePassword",value:function(){return this._pwd&&(this.saveAction="remove",this._pwd=""),!0}},{key:"getOptionUrl",value:function(){return this.optionUrl}},{key:"uploadAnnotations",value:function(Re){var Te={method:"POST",headers:{Accept:"application/json","Content-type":"application/json"}};Re.append_objects.length&&(Te.body=JSON.stringify(Re),fetch(this.optionUrl.baseUrl+this.optionUrl.saveAnnotations+"?f="+this.info.token,Te).then(function(He){return He.json()}).then(function(He){return He}).catch(function(He){return{error:!0,message:He.message}}))}},{key:"toggleSidebar",value:function(){this.pdfSidebar.toggle()}},{key:"load",value:(Ve=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it=this;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return this.pdfLinkService.setDocument(Te),(He=this.pdfViewer).setDocument(Te,this.annotations,this.pagesPtr,this.enableReply),Fe=He.firstPagePromise,He.onePageRendered,He.pagesPromise,Te.getDownloadInfo().then(function(dt){var xt=dt.length;it._contentLength=xt,it.downloadComplete=!0}),this.pdfThumbnailViewer&&this.pdfThumbnailViewer.setDocument(Te),ze=this.doc,We=this.messageHandler,nt.next=10,We.sendWithPromise("GetOutlines",{doc:ze});case 10:if(Ue=nt.sent,et=function dt(xt,yt,Bt){var Pt=new Outline({outline:xt,index:yt,doc:ze,messageHandler:We,parent:Bt});return xt.children.forEach(function(Tt,ct){Pt.children.push(dt(Tt,ct,Pt))}),Pt},Ue.forEach(function(dt,xt){var yt=et(dt,xt,null);it.outlines.push(yt)}),nt.t0=this.renderLayerPermission,!nt.t0){nt.next=17;break}return nt.next=17,this.getLayers();case 17:Fe.then(function(dt){it.setInitialView(null,{rotation:null,sidebarView:0,scrollMode:-1,spreadMode:-1}),it.eventBus.dispatch("documentloaded",{source:it})}),this.eventBus.dispatch("documentinit",{source:this});case 19:case"end":return nt.stop()}},Re,this)})),function(Re){return Ve.apply(this,arguments)})},{key:"initBindEvents",value:function(){var Re=this.eventBus;this._boundEvents,Re._on("scalechanging",this.webViewerScaleChanging.bind(this))}},{key:"bindEvents",value:function(){var Re=this.eventBus;this._boundEvents,Re._on("resize",this.webViewerResize.bind(this)),Re._on("pagerendered",this.webViewerPageRendered.bind(this)),Re._on("updateviewarea",this.webViewerUpdateViewarea.bind(this)),Re._on("onPageNumberUpdated",this.webViewerPageChanging.bind(this)),Re._on("rotationchanging",this.webViewerRotationChanging.bind(this)),Re._on("sidebarviewchanged",this.webViewerSidebarViewChanged.bind(this)),Re._on("presentationmodechanged",this.webViewerPresentationModeChanged.bind(this)),Re._on("presentationmode",this.webViewerPresentationMode.bind(this)),Re._on("nextpage",this.webViewerNextPage.bind(this)),Re._on("previouspage",this.webViewerPreviousPage.bind(this)),Re._on("zoomin",this.webViewerZoomIn.bind(this)),Re._on("zoomout",this.webViewerZoomOut.bind(this)),Re._on("pagenumberchanged",this.webViewerPageNumberChanged.bind(this)),Re._on("scalechanged",this.webViewerScaleChanged.bind(this)),Re._on("rotatecw",this.webViewerRotateCw.bind(this)),Re._on("rotateccw",this.webViewerRotateCcw.bind(this)),Re._on("switchscrollmode",this.webViewerSwitchScrollMode.bind(this)),Re._on("scrollmodechanged",this.webViewerScrollModeChanged.bind(this)),Re._on("switchspreadmode",this.webViewerSwitchSpreadMode.bind(this)),Re._on("spreadmodechanged",this.webViewerSpreadModeChanged.bind(this)),Re._on("findfromurlhash",this.webViewerFindFromUrlHash.bind(this)),Re._on("updatefindmatchescount",this.webViewerUpdateFindMatchesCount.bind(this)),Re._on("updatefindcontrolstate",this.webViewerUpdateFindControlState.bind(this)),Re._on("fileinputchange",this.webViewerFileInputChange.bind(this)),Re._on("openfile",this.webViewerOpenFile.bind(this)),Re._on("switchannotationeditormode",this.webViewerSwitchAnnotationEditorMode.bind(this)),Re._on("annotationsCountChanged",this.webViewerAnnotationsCountChanged.bind(this)),Re._on("distanceChanged",this.webViewerDistanceChanged.bind(this)),Re._on("annotationChange",this.handleAnnotationChange.bind(this)),Re._on("createSignature",this.handleCreateSignature.bind(this)),Re._on("handleField",this.handleField.bind(this)),Re._on("pageNumberChanged",this.pageNumberChanged.bind(this)),Re._on("updateSignatureAp",this.updateSignatureAp.bind(this)),Re._on("isContentEditModyfied",this.setContentEditModyfied.bind(this))}},{key:"bindWindowEvents",value:function(){var Re=this,Te=this.eventBus,He=this._boundEvents;if(!this._windowAbortController){this._windowAbortController=new AbortController,He.windowResize=_.debounce(function(){Te.dispatch("resize",{source:window})},200),He.windowHashChange=function(){Te.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},He.windowUpdateFromSandbox=function(We){Te.dispatch("updatefromsandbox",{source:window,detail:We.detail})};var Fe=this._windowAbortController.signal;window.addEventListener("wheel",onWheel.bind(this),{passive:!1,signal:Fe}),window.addEventListener("keydown",onKeyDown.bind(this),{signal:Fe}),window.addEventListener("keyup",onKeyUp.bind(this),{signal:Fe}),window.addEventListener("resize",He.windowResize),window.addEventListener("hashchange",He.windowHashChange),window.addEventListener("updatefromsandbox",He.windowUpdateFromSandbox);var ze=this.getViewerElement();ze.addEventListener("dblclick",function(We){Re.eventBus.dispatch("dblclick",We)}),ze.addEventListener("click",function(We){Re.eventBus.dispatch("click",We)}),document.addEventListener("mouseup",function(We){We.which===1&&Re.eventBus.dispatch("mouseLeftUp",We)})}}},{key:"close",value:(Be=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze,We;return _regeneratorRuntime().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:if(this.pdfLoadingTask){Ue.next=2;break}return Ue.abrupt("return");case 2:return ze=[],this.annotationManager&&this.annotationManager.reset(),this.maxViewportZoom=null,this.doc&&ze.push(this.messageHandler.sendWithPromise("ClearDocument",this.doc)),this.docEditorCopy&&(this.docEditorCopy=null),this.docEditorCopy&&(this.docEditorCopy=null),ze.push(this.pdfLoadingTask.destroy()),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,(We=this.pdfThumbnailViewer)===null||We===void 0||We.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null)),this.isInitialViewSet=!1,this.downloadComplete=!1,this.url="",this.baseUrl="",this._downloadUrl="",this.documentInfo=null,this.saveAction=null,this.metadata=null,this._contentDispositionFilename=null,this._contentLength=null,this._saveInProgress=!1,this._hasAnnotationEditors=!1,(Te=this.pdfSidebar)===null||Te===void 0||Te.reset(),(He=this.pdfOutlineViewer)===null||He===void 0||He.reset(),(Fe=this.pdfAttachmentViewer)===null||Fe===void 0||Fe.reset(),this.outlines=[],this._pwd="",this._pdfId=null,this.annotations=null,this.doc=null,this.layers=[],this.ocgsPtr=null,Ue.next=35,Promise.all(ze);case 35:case"end":return Ue.stop()}},Re,this)})),function(){return Be.apply(this,arguments)})},{key:"handleInk",value:function(Re){var Te=JSON.parse(JSON.stringify(Re)),He="",Fe=[];Array.isArray(Te.inklist)?Fe=Te.inklist:Fe.push(Te.inklist);for(var ze=0;ze<Fe.length;ze++)He=He+Fe[ze].replaceAll(";",",")+"//";return Te.inklist=He,Te}},{key:"handleAnnotationChange",value:(Ee=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt;return _regeneratorRuntime().wrap(function(St){for(;;)switch(St.prev=St.next){case 0:if(He=Te.annotation,this.annotationHistory.push(He),Fe=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"],ze=["highlight","underline","strikeout","squiggly"],Te.type!=="add"){St.next=23;break}Array.isArray(He)||(He=[He]),We=He.length,Ue=0;case 8:if(!(Ue<We)){St.next=21;break}if(!(Number(He[Ue].pageIndex)+1>this.pagesCount)){St.next=11;break}return St.abrupt("continue",18);case 11:if(Fe.includes(He[Ue].type)?He[Ue].operate="add-form":(He[Ue].operate="add-annot",He[Ue].author=this.annotator),ze.includes(He[Ue].type)&&(et=[],!He[Ue].quadPoints[0].PointX&&!He[Ue].quadPoints[0].PointY)){for(it=0;it<He[Ue].quadPoints.length;it++)nt=He[Ue].quadPoints[it],dt=nt.left,xt=nt.top,yt=nt.right,Bt=nt.bottom,et.push({PointX:dt,PointY:xt}),et.push({PointX:yt,PointY:xt}),et.push({PointX:dt,PointY:Bt}),et.push({PointX:yt,PointY:Bt});He[Ue].quadPoints=et}return St.next=15,this.handleAnnotations(He[Ue],{show:Te.show});case 15:if(!(Pt=St.sent)||!Pt.code){St.next=18;break}return St.abrupt("return",!1);case 18:Ue++,St.next=8;break;case 21:St.next=46;break;case 23:if(Tt=null,Te.type!=="delete"){St.next=38;break}if(!(wt=this.getAnnotationManager().getAnnotationById(He.name))||(ct=wt.getReplies())===null||ct===void 0||!ct.length){St.next=32;break}return St.next=29,this.messageHandler.sendWithPromise("RemoveFromPageIncludeReplyAnnot",{pagePtr:wt.annotation.pagePtr,annotPtr:He.annotPtr});case 29:Tt=St.sent,St.next=35;break;case 32:return St.next=34,this.messageHandler.sendWithPromise("RemoveAnnot",{annotPtr:He.annotPtr});case 34:Tt=St.sent;case 35:this.redactionList=this.redactionList.filter(function(Ft){return Ft.name!==He.name}),St.next=42;break;case 38:return He.doc=this.doc,St.next=41,this.messageHandler.sendWithPromise("EditAnnotation",{annotation:He});case 41:Tt=St.sent;case 42:if(!Tt||!Tt.code){St.next=46;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Tt.message}),console.log(Tt.message),St.abrupt("return");case 46:return this.eventBus.dispatch("annotationUpdated",{annotations:this.annotations}),this.eventBus.dispatch("redactAnnotationChanged",this.redactionList.length),this.isAnnotationModified=!0,St.abrupt("return",!0);case 50:case"end":return St.stop()}},Re,this)})),function(Re){return Ee.apply(this,arguments)})},{key:"emptyAnnotations",value:function(){this.annotationManager.emptyAnnotations()}},{key:"handleCreateSignature",value:function(Re){this.eventBus.dispatch("annotationChange",{type:"add",annotation:Re})}},{key:"webViewerDistanceChanged",value:function(Re){this.distanceChangedCallback(Re.distance)}},{key:"progress",value:function(Re){if(!this.downloadComplete){var Te=Math.round(100*Re);Te<=this.percent||(this.percent=Te)}}},{key:"flattenPdf",value:(Ce=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(!this._token||!this._pdfId){ze.next=5;break}return Te={method:"POST",headers:{"Content-Type":"application/json",Authorization:this._token},body:JSON.stringify({pdfId:this._pdfId})},ze.abrupt("return",fetch(this.optionUrl.webviewBaseUrl+this.optionUrl.flattenUrl,Te).then(function(){var We=_asyncToGenerator(_regeneratorRuntime().mark(function Ue(et){var it;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(!et.headers.get("content-type").startsWith("application/json")){nt.next=8;break}return nt.next=4,et.json();case 4:return it=nt.sent,nt.abrupt("return",Promise.reject(it));case 8:return nt.abrupt("return",et.blob());case 9:case"end":return nt.stop()}},Ue)}));return function(Ue){return We.apply(this,arguments)}}()).then(function(We){return We}).catch(function(We){return console.log(We),!1}));case 5:return ze.next=7,this.messageHandler.sendWithPromise("FlattenPage",{doc:this.doc,pagesPtr:this.pagesPtr,saveType:2,password:this._pwd,oldPassword:this._oldPwd});case 7:if(!(He=ze.sent)||!He.code){ze.next=12;break}return this.eventBus.dispatch("message",{type:"ERROR",message:He.message}),console.log(He.message),ze.abrupt("return",!1);case 12:return Fe=He.blobData,ze.abrupt("return",Fe);case 14:case"end":return ze.stop()}},Re,this)})),function(){return Ce.apply(this,arguments)})},{key:"flattenPdfDownload",value:(ke=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.flattenPdf();case 2:if(!(Te=Fe.sent)){Fe.next=10;break}return(He=this._docName).endsWith(".pdf")&&(He=He.slice(0,-4)+"_flatten.pdf"),FileSaver_minExports.saveAs(Te,He),Fe.abrupt("return",!0);case 10:return Fe.abrupt("return",!1);case 11:case"end":return Fe.stop()}},Re,this)})),function(){return ke.apply(this,arguments)})},{key:"loadCertificates",value:(oe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.messageHandler.sendWithPromise("LoadCertificates",Te);case 2:return He=Fe.sent,Fe.abrupt("return",He);case 4:case"end":return Fe.stop()}},Re,this)})),function(Re){return oe.apply(this,arguments)})},{key:"download",value:(le=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze,We,Ue,et=this,it=arguments;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(Te=it.length>0&&it[0]!==void 0&&it[0],Fe=it.length>2?it[2]:void 0,!(He=it.length>1?it[1]:void 0)){nt.next=7;break}He.forEach(function(dt){FileSaver_minExports.saveAs(dt.url,dt.fileName)}),nt.next=19;break;case 7:if(!this._token||!this._pdfId){nt.next=12;break}return ze={method:"POST",headers:{"Content-Type":"application/json",Authorization:this._token},body:JSON.stringify({pdfId:this._pdfId})},nt.abrupt("return",fetch(this.optionUrl.webviewBaseUrl+this.optionUrl.saveUrl,ze).then(function(){var dt=_asyncToGenerator(_regeneratorRuntime().mark(function xt(yt){var Bt;return _regeneratorRuntime().wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(!yt.headers.get("content-type").startsWith("application/json")){Pt.next=8;break}return Pt.next=4,yt.json();case 4:return Bt=Pt.sent,Pt.abrupt("return",Promise.reject(Bt));case 8:return Pt.abrupt("return",yt.blob());case 9:case"end":return Pt.stop()}},xt)}));return function(xt){return dt.apply(this,arguments)}}()).then(function(dt){return Te&&FileSaver_minExports.saveAs(dt,et._docName),dt}).catch(function(dt){return console.log(dt),!1}));case 12:return We={set:2,remove:3}[this.saveAction]||1,nt.next=16,this.messageHandler.sendWithPromise("SaveDocumentByStream",{doc:this.doc,saveType:Fe||We,password:this._pwd,oldPassword:this._oldPwd,permissionPassword:this._permissionPwd,permissions:this._setPermission});case 16:return Ue=nt.sent,Te&&FileSaver_minExports.saveAs(Ue,this._docName),nt.abrupt("return",Ue);case 19:case"end":return nt.stop()}},Re,this)})),function(){return le.apply(this,arguments)})},{key:"exportPDF",value:(Le=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe=arguments;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return Te=Fe.length>0&&Fe[0]!==void 0&&Fe[0],ze.next=3,this.messageHandler.sendWithPromise("ExportPDF",{doc:this.doc,saveType:Te?2:1,password:this._pwd,oldPassword:this._oldPwd,permissionPassword:this._permissionPwd,permissions:this._setPermission});case 3:return He=ze.sent,ze.abrupt("return",He);case 5:case"end":return ze.stop()}},Re,this)})),function(){return Le.apply(this,arguments)})},{key:"saveAs",value:(Ie=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te;return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,this.messageHandler.sendWithPromise("SaveDocumentByStream",{doc:this.doc,saveType:2,password:this._pwd,oldPassword:this._oldPwd,permissionPassword:this._permissionPwd,permissions:this._setPermission});case 2:return Te=He.sent,He.abrupt("return",Te);case 4:case"end":return He.stop()}},Re,this)})),function(){return Ie.apply(this,arguments)})},{key:"exportXfdf",value:(Me=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze,We,Ue=arguments;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return Te=Ue.length>0&&Ue[0]!==void 0&&Ue[0],He="",et.next=4,this.messageHandler.sendWithPromise("XFDFExportAnnotations",{doc:this.doc});case 4:if(!(Fe=et.sent)||!Fe.code){et.next=9;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Fe.message}),console.log(Fe.message),et.abrupt("return",!1);case 9:if(He=Fe.Content,!Te){et.next=17;break}return ze=this._docName.replace(/\.pdf$/,".xfdf"),We=new Blob([He],{type:"application/xfdf"}),FileSaver_minExports.saveAs(We,ze),et.abrupt("return",!0);case 17:return et.abrupt("return",He);case 18:case"end":return et.stop()}},Re,this)})),function(){return Me.apply(this,arguments)})},{key:"exportFomrXfdf",value:($e=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te;return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,this.messageHandler.sendWithPromise("XFDFExportFormAnnotations",{doc:this.doc});case 2:if(!(Te=He.sent)||!Te.code){He.next=7;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Te.message}),console.log(Te.message),He.abrupt("return",!1);case 7:return He.abrupt("return",Te);case 8:case"end":return He.stop()}},Re,this)})),function(){return $e.apply(this,arguments)})},{key:"getPageTextContent",value:(Ae=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(!(!Te||Te<1||Te>this.pagesCount)){nt.next=2;break}return nt.abrupt("return");case 2:return He=Te-1,Fe=this.pdfViewer.getPageView(He),ze=this.pagesPtr,We=ze[He],Ue=Fe.viewport.viewBox[2],et=Fe.viewport.viewBox[3],nt.next=10,this.messageHandler.sendWithPromise("GetCharsRangeAtPos",{pagePtr:We.pagePtr,textPtr:We.textPtr,start:{x:0,y:0},end:{x:Ue,y:et}});case 10:return it=nt.sent,nt.abrupt("return",it.textContent);case 12:case"end":return nt.stop()}},Re,this)})),function(Re){return Ae.apply(this,arguments)})},{key:"getScrollViewElement",value:function(){return this.scrollContainer}},{key:"getViewerElement",value:function(){return this.viewerContainer}},{key:"getSelectedPage",value:function(Re,Te){for(var He=null,Fe=null,ze=0;ze<this.pagesCount;ze++){var We,Ue,et=this.pdfViewer._pages[ze].div,it=et.offsetLeft+((We=et.offsetParent)===null||We===void 0?void 0:We.offsetLeft),nt=it+et.clientWidth,dt=et.offsetTop+((Ue=et.offsetParent)===null||Ue===void 0?void 0:Ue.offsetTop),xt=dt+et.clientHeight;if(He===null&&Re.x<=nt&&Re.x>=it&&Re.y<=xt&&Re.y>=dt&&(He=ze+1),Fe===null&&Te.x<=nt&&Te.x>=it&&Te.y<=xt&&Te.y>=dt&&(Fe=ze+1),He!==null&&Fe!==null)break}if(He>Fe){var yt=[Fe,He];He=yt[0],Fe=yt[1]}return{first:He,last:Fe}}},{key:"pageToWindow",value:function(Re,Te){var He,Fe,ze=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(Te>this.page&&Te<1)return null;var We=this.pdfViewer._pages[Te-1].div,Ue=We.offsetLeft+((He=We.offsetParent)===null||He===void 0?void 0:He.offsetLeft),et=We.offsetTop+((Fe=We.offsetParent)===null||Fe===void 0?void 0:Fe.offsetTop),it=this.scale;return{x:(ze?Re.x*it:Re.x)+Ue,y:(ze?Re.y*it:Re.y)+et}}},{key:"windowToPage",value:function(Re,Te){var He,Fe,ze=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(Te>this.page&&Te<1)return null;var We=this.pdfViewer._pages[Te-1].div,Ue=We.offsetLeft+((He=We.offsetParent)===null||He===void 0?void 0:He.offsetLeft),et=We.offsetTop+((Fe=We.offsetParent)===null||Fe===void 0?void 0:Fe.offsetTop),it=this.scale;return{pageNumber:Te,x:ze?(Re.x-Ue)/it:Re.x-Ue,y:ze?(Re.y-et)/it:Re.y-et}}},{key:"_initializeViewerComponents",value:function(Re){var Te=Re.container,He=Re.viewer,Fe=Re.thumbnailView,ze=Re.toggleButton;this.scrollContainer=Te;var We=this;this.scrollContainer.addEventListener("mousemove",function(it){We.eventBus.dispatch("mouseMove",it)}),this.viewerContainer=He;var Ue=new PDFRenderingQueue;Ue.onIdle=this._cleanup.bind(this),this.pdfRenderingQueue=Ue;var et=new PDFLinkService;this.pdfLinkService=et,this.pdfViewer=new PDFViewer({container:Te,viewer:He,documentViewer:this,messageHandler:this.messageHandler,annotationStore,tool:{tool:this.activeTool,color:this.color},renderingQueue:Ue,linkService:et,renderer:"canvas",textLayerMode:1,enablePrintAutoRotate:!0,eventBus:this.eventBus,$t:this.$t,doc:this.doc}),Ue.setViewer(this.pdfViewer),et.setViewer(this.pdfViewer),Fe&&(this.pdfThumbnailViewer=new PDFThumbnailViewer({container:Fe,renderingQueue:Ue,linkService:et}),Ue.setThumbnailViewer(this.pdfThumbnailViewer)),this.pdfCursorTools=new PDFCursorTools({container:Te,eventBus:this.eventBus,cursorToolOnLoad:0}),this.supportsFullscreen&&(this.pdfPresentationMode=new PDFPresentationMode({container:Te,pdfViewer:this.pdfViewer,eventBus:this.eventBus})),this.passwordPrompt=new PasswordPrompt({dialog:document.getElementById("passwordDialog"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel"),$t:this.$t}),this.pdfSidebar=new PDFSidebar({elements:{toggleButton:ze},pdfViewer:this.pdfViewer,pdfThumbnailViewer:this.pdfThumbnailViewer,eventBus:this.eventBus}),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.contentEditManager=new ContentEditManager(this),this.annotationManager=new AnnotationManager(this)}},{key:"getAnnotationManager",value:function(){return this.annotationManager}},{key:"setInitialView",value:function(Re){var Te,He=this,Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Fe.rotation,Fe.sidebarView;var ze,We,Ue=Fe.scrollMode,et=Fe.spreadMode;this.isInitialViewSet=!0,We=et,isValidScrollMode(ze=Ue)&&(He.pdfViewer.scrollMode=ze),isValidSpreadMode(We)&&(He.pdfViewer.spreadMode=We),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=DEFAULT_SCALE_VALUE),this.pdfViewer.forceRendering(),!((Te=this.pdfSidebar)===null||Te===void 0)&&Te.isOpen&&this.pdfThumbnailViewer.forceRendering()}},{key:"requestFullScreenMode",value:function(){var Re;(Re=this.pdfPresentationMode)===null||Re===void 0||Re.request()}},{key:"_cleanup",value:function(){var Re;this.pdfDocument&&(this.pdfViewer.cleanup(),(Re=this.pdfThumbnailViewer)===null||Re===void 0||Re.cleanup(),this.pdfDocument.cleanup(this.pdfViewer.renderer==="svg"))}},{key:"cleanup",value:function(){this._cleanup()}},{key:"getViewCenterAfterScale",value:function(Re){var Te=this.scrollContainer,He=this.viewerContainer,Fe=window.innerWidth/2,ze=window.innerHeight/2;return{x:(Fe+Te.scrollLeft-He.offsetLeft)*Re-Fe+Te.offsetLeft,y:(ze+Te.scrollTop-He.offsetTop)*Re-ze+Te.offsetTop}}},{key:"zoomIn",value:function(){this.updateZoom(1)}},{key:"zoomOut",value:function(){this.updateZoom(-1)}},{key:"updateZoom",value:function(Re,Te,He){this.pdfViewer.isInPresentationMode||this.pdfViewer.updateScale({drawingDelay:400,steps:Re,scaleFactor:Te,origin:He||{x:window.innerWidth/2,y:window.innerHeight/2}})}},{key:"nextPage",value:function(){return this.pdfViewer.nextPage()}},{key:"previousPage",value:function(){return this.pdfViewer.previousPage()}},{key:"pageNumberChanged",value:function(Re){Re!==""&&this.pdfLinkService.goToPage(Re),Re!==this.pdfViewer.currentPageNumber.toString()&&Re!==this.pdfViewer.currentPageLabel&&this.toolbar&&this.toolbar.setPageNumber(pdfViewer.currentPageNumber,pdfViewer.currentPageLabel)}},{key:"scrollTo",value:function(Re){var Te=Re.left,He=Re.top;scrollIntoView(this.viewerContainer,{left:Te,top:He})}},{key:"scrollToPercent",value:function(Re){var Te=Re.left,He=Re.top,Fe=(this.scrollContainer.scrollHeight-this.scrollContainer.clientHeight)*He/100,ze=(this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth)*Te/100;this.scrollTo({top:Fe,left:ze})}},{key:"webViewerAnnotationsCountChanged",value:function(Re){this.annotationsNumChangedCallback(Re.annotationsCount)}},{key:"forceRendering",value:function(){this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar.visibleView===SidebarView.THUMBS,this.pdfRenderingQueue.renderHighestPriority()}},{key:"webViewerResize",value:function(){var Re=this.pdfDocument,Te=this.pdfViewer;if((!this.pdfRenderingQueue.printing||!window.matchMedia("print").matches)&&Re){var He=Te.currentScaleValue;He!=="auto"&&He!=="page-fit"&&He!=="page-width"||Te.resize(He)}}},{key:"webViewerPageRendered",value:function(Re){var Te,He=Re.pageNumber;if(Re.error,((Te=this.pdfSidebar)===null||Te===void 0?void 0:Te.visibleView)===SidebarView.THUMBS){var Fe=this.pdfViewer.getPageView(He-1),ze=this.pdfThumbnailViewer.getThumbnail(He-1);Fe&&ze&&ze.setImage(Fe)}}},{key:"annotationMode",get:function(){return this._annotationMode},set:function(Re){this._annotationMode=Re}},{key:"webViewerSwitchAnnotationEditorMode",value:function(Re){this.pdfViewer.annotationEditorMode=Re.mode}},{key:"switchTool",value:function(Re){this.pdfCursorTools.switchTool(Re)}},{key:"webViewerUpdateViewarea",value:function(Re){var Te,He=Re.location;this.isInitialViewSet&&((Te=this.store)===null||Te===void 0||Te.setMultiple({page:He.pageNumber,zoom:He.scale,scrollLeft:He.left,scrollTop:He.top,rotation:He.rotation}).catch(function(){})),this._textSearch&&this._textSearch.updateMatch()}},{key:"webViewerScrollModeChanged",value:function(Re){var Te;this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode&&((Te=this.store)===null||Te===void 0||Te.set("scrollMode",Re.mode).catch(function(){}))}},{key:"webViewerScaleChanging",value:function(Re){this.scaleChangedCallback&&this.scaleChangedCallback(Re.scale)}},{key:"webViewerRotationChanging",value:function(Re){this.pdfThumbnailViewer.pagesRotation=Re.pagesRotation,this.forceRendering(),this.pdfViewer.currentPageNumber=Re.pageNumber}},{key:"webViewerPageChanging",value:function(Re){var Te,He=Re.pageNumber;return Re.pageLabel,((Te=this.pdfSidebar)===null||Te===void 0?void 0:Te.visibleView)===SidebarView.THUMBS&&this.pdfThumbnailViewer.scrollThumbnailIntoView(He),this.pageChangedCallback(this.page),this.searchPageResults&&this.clearSearchResults(),He}},{key:"webViewerSidebarViewChanged",value:function(Re){var Te,He=Re.view;this.pdfRenderingQueue.isThumbnailViewEnabled=He===SidebarView.THUMBS,this.isInitialViewSet&&((Te=this.store)===null||Te===void 0||Te.set("sidebarView",He).catch(function(){}))}},{key:"selectAnnotation",value:function(Re){Re.selectAnnotation()}},{key:"deselectAnnotation",value:function(Re){var Te;if(Re&&Re.name){var He=(Te=this.annotationManager)===null||Te===void 0?void 0:Te.getAnnotationById(Re.name);He&&this.annotationManager.deselectAnnotation(He)}}},{key:"getRequiredFormSign",value:function(){for(var Re=this.annotationManager.getAnnotationsList(),Te=this.consecutiveType,He=["textfield","checkbox","radiobutton","listbox","combobox","signatureFields"],Fe=0;Fe<Re.length;Fe++){var ze=Re[Fe];if(He.includes(ze.type))switch(ze.type){case"listbox":case"combobox:":if(!ze.getSelectedOption()&&ze.isRequired()&&(Te==="form"||Te==="signForm"))return ze;break;case"checkbox":case"radiobutton":if(!ze.isChecked&&ze.isRequired()&&(Te==="form"||Te==="signForm"))return ze;break;case"textfield":if(!ze.getContents()&&ze.isRequired()&&(Te==="form"||Te==="signForm"))return ze;break;case"signatureFields":if(!ze.isSigned&&ze.isRequired()&&(Te==="sign"||Te==="signForm"))return ze}}}},{key:"setFormSignConsecutively",value:function(){for(var Re=this.annotationManager.getAnnotationsList(),Te=["textfield","checkbox","radiobutton","listbox","combobox","signatureFields"],He=this.consecutiveType,Fe=0;Fe<Re.length;Fe++){var ze=Re[Fe];if(Te.includes(ze.type)&&He)switch(ze.type){case"listbox":case"combobox:":ze.getSelectedOption()||!ze.isRequired()&&this.skipNoRequired;break;case"checkbox":case"radiobutton":ze.isChecked||!ze.isRequired()&&this.skipNoRequired;break;case"textfield":ze.getContents()||!ze.isRequired()&&this.skipNoRequired;break;case"signatureFields":ze.isSigned||!ze.isRequired()&&this.skipNoRequired}}}},{key:"getFormSignFilledAndUnfilled",value:function(){for(var Re=this.annotationManager.getAnnotationsList(),Te=["textfield","checkbox","radiobutton","listbox","combobox","signatureFields"],He=0,Fe=0,ze=0,We=0,Ue=0,et=0,it=0,nt=0,dt=0;dt<Re.length;dt++){var xt=Re[dt];if(Te.includes(xt.type)){var yt=xt.isRequired();if(xt.type==="signatureFields")Ue++,!xt.isSigned&&et++,yt&&it++,yt&&!xt.isSigned&&nt++;else switch(He++,yt&&ze++,xt.type){case"listbox":case"combobox:":!xt.getSelectedOption()&&yt&&(Fe++,yt&&We++);break;case"checkbox":!xt.isChecked&&yt&&(Fe++,yt&&We++);break;case"textfield":!xt.getContents()&&yt&&(Fe++,yt&&We++);break;case"radiobutton":xt.isChecked||this.getGroupRadiobuttonChecked(xt)||!yt||(Fe++,yt&&We++)}}}return{formFields:He,requiredFormFields:ze,unfilledFormFields:Fe,unfilledRequiredFormFields:We,signFields:Ue,requiredSignFields:it,unsignFields:et,unsignRequiredSignFields:nt}}},{key:"getGroupRadiobuttonChecked",value:function(Re){for(var Te=this.annotationManager.getAnnotationsList(),He=!1,Fe=0;Fe<Te.length;Fe++){var ze=Te[Fe];if(ze.type==="radiobutton"&&ze.fieldName===Re.fieldName&&ze.isChecked){He=!0;break}}return He}},{key:"getConsecutiveType",value:function(){return this.consecutiveType}},{key:"setConsecutiveType",value:function(Re){Re!==this.consecutiveType&&(this.consecutiveType=Re,this.setFormSignConsecutively(),this.eventBus.dispatch("updateConsecutivelyType"))}},{key:"isSkipNoRequired",value:function(){return this.skipNoRequired}},{key:"enableSkipNoRequired",value:function(){this.skipNoRequired||(this.skipNoRequired=!0,this.setFormSignConsecutively(),this.eventBus.dispatch("updateConsecutivelyType"))}},{key:"disableSkipNoRequired",value:function(){this.skipNoRequired&&(this.skipNoRequired=!1,this.setFormSignConsecutively(),this.eventBus.dispatch("updateConsecutivelyType"))}},{key:"isFillConsecutively",value:function(){return this.fillConsecutively}},{key:"enableFillConsecutively",value:function(){this.fillConsecutively=!0,this.setFormSignConsecutively()}},{key:"disableFillConsecutively",value:function(){this.fillConsecutively=!1,this.setFormSignConsecutively()}},{key:"jumpToAnnotation",value:function(Re){var Te=Re.getPageNumber(),He=Re.getRect(),Fe=He.x1,ze=He.y1,We=He.x2,Ue=He.y2,et=this.pageToWindow({x:Fe,y:ze},Te),it=this.pageToWindow({x:We,y:Ue},Te),nt=it.x-et.x,dt=it.y-et.y,xt=this.getScrollViewElement(),yt=getElementPosition(xt),Bt=et.x-xt.clientWidth/2+nt/2-yt.left,Pt=et.y-xt.clientHeight/2+dt/2-yt.top;xt.scrollLeft=Bt,xt.scrollTop=Pt}},{key:"setCurrentPage",value:function(Re){return!(!Re||Re<1||Re>this.pagesCount)&&(this.page=Re,!0)}},{key:"enableAnnotationPopup",value:function(){this.isAnnotationPopup=!0}},{key:"disableAnnotationPopup",value:function(){this.isAnnotationPopup=!1}},{key:"webViewerPageMode",value:function(Re){var Te,He=Re.mode;switch(He){case"thumbs":Te=SidebarView.THUMBS;break;case"bookmarks":case"outline":Te=SidebarView.OUTLINE;break;case"attachments":Te=SidebarView.ATTACHMENTS;break;case"layers":Te=SidebarView.LAYERS;break;case"none":Te=SidebarView.NONE;break;default:return void console.error('Invalid "pagemode" hash parameter: '+He)}this.pdfSidebar.switchView(Te,!0)}},{key:"webViewerNamedAction",value:(we=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:Fe.t0=Te.action,Fe.next=Fe.t0==="GoToPage"?3:Fe.t0==="Print"?5:Fe.t0==="SaveAs"?12:14;break;case 3:return this.appConfig.toolbar.pageNumber.select(),Fe.abrupt("break",14);case 5:return Fe.next=7,this.printPages();case 7:if((He=Fe.sent).length){Fe.next=10;break}return Fe.abrupt("return",!1);case 10:return this.printDocument(He),Fe.abrupt("return",!0);case 12:return this.downloadOrSave(),Fe.abrupt("break",14);case 14:case"end":return Fe.stop()}},Re,this)})),function(Re){return we.apply(this,arguments)})},{key:"triggerPrinting",value:function(Re){var Te=Re instanceof Blob?URL.createObjectURL(Re):Re;Te=decodeURIComponent(Te),printJS({url:Te,printable:Te,type:"pdf",showModal:!1})}},{key:"webViewerPresentationModeChanged",value:function(Re){this.pdfViewer.presentationModeState=Re.state}},{key:"webViewerPresentationMode",value:function(){this.requestPresentationMode()}},{key:"webViewerNextPage",value:function(){this.pdfViewer.nextPage()}},{key:"webViewerPreviousPage",value:function(){this.pdfViewer.previousPage()}},{key:"webViewerZoomIn",value:function(){this.zoomIn()}},{key:"webViewerZoomOut",value:function(){this.zoomOut()}},{key:"webViewerPageNumberChanged",value:function(Re){var Te=this.pdfViewer;Re.value!==""&&this.pdfLinkService.goToPage(Re.value),Re.value!==Te.currentPageNumber.toString()&&Re.value!==Te.currentPageLabel&&this.toolbar.setPageNumber(Te.currentPageNumber,Te.currentPageLabel)}},{key:"webViewerScaleChanged",value:function(Re){this.pdfViewer.currentScaleValue=Re}},{key:"webViewerRotateCw",value:function(){this.rotatePages(90)}},{key:"webViewerRotateCcw",value:function(){this.rotatePages(-90)}},{key:"webViewerSwitchScrollMode",value:function(Re){this.pdfViewer.scrollMode=Re}},{key:"webViewerSwitchSpreadMode",value:function(Re){this.pdfViewer.spreadMode=Re}},{key:"rotatePages",value:(be=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe=this;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.abrupt("return",this.enqueue(function(){return Fe.rotatePagesOri(Te,He)}));case 1:case"end":return ze.stop()}},Re,this)})),function(Re,Te){return be.apply(this,arguments)})},{key:"webViewerSpreadModeChanged",value:function(Re){var Te;this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode&&((Te=this.store)===null||Te===void 0||Te.set("spreadMode",Re.mode).catch(function(){}))}},{key:"webViewerFindFromUrlHash",value:function(Re){this.eventBus.dispatch("find",{source:Re.source,type:"",query:Re.query,phraseSearch:Re.phraseSearch,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1,matchDiacritics:!0})}},{key:"webViewerUpdateFindMatchesCount",value:function(Re){var Te=Re.matchesCount;this.supportsIntegratedFind?this.externalServices.updateFindMatchesCount(Te):this.findBar.updateResultsCount(Te)}},{key:"webViewerUpdateFindControlState",value:function(Re){var Te=Re.state,He=Re.previous,Fe=Re.matchesCount,ze=Re.rawQuery;this.supportsIntegratedFind?this.externalServices.updateFindControlState({result:Te,findPrevious:He,matchesCount:Fe,rawQuery:ze}):this.findBar.updateUIState(Te,He,Fe)}},{key:"webViewerFileInputChange",value:function(Re){var Te;if((Te=this.pdfViewer)===null||Te===void 0||!Te.isInPresentationMode){var He=Re.fileInput.files[0],Fe=URL.createObjectURL(He);He.name&&(Fe={url:Fe,originalUrl:He.name}),this.open(Fe)}}},{key:"webViewerOpenFile",value:function(Re){this.appConfig.openFileInput.click()}},{key:"setToolMode",value:(Pe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if(!isMobileDevice$1||Te!=="separation"){et.next=3;break}return console.warn("This feature is not available for Mobile, please access on PC for the best experience"),et.abrupt("return");case 3:if(He=this.toolMode,this.toolMode=Te,Te==="editor"&&this.fontFileInited,["redaction","remove"].includes(this.activeTool)&&this.toolMode!=="redaction"&&(this.redactionList.length&&this.applyRedactions(),this.setTool({color:"",tool:""})),this.eventBus.dispatch("toolModeChanged",Te),He!=="editor"||this.toolMode==="editor"){et.next=11;break}return et.next=11,this.updateTextPtr();case 11:He!=="editor"&&this.toolMode==="editor"&&this.contentEditManager&&this.contentEditManager.getSelectedEditBox()&&this.contentEditManager.setSelectedEditBox(null),He==="separation"&&this.toolMode!=="separation"&&(this.colorList.length=0,annotationStore.ignoreColors.length=0,this.pdfViewer.refreshCanvas()),et.t0=_regeneratorRuntime().keys(this.annotations);case 14:if((et.t1=et.t0()).done){et.next=28;break}Fe=et.t1.value,ze=0;case 17:if(!(ze<this.annotations[Fe].length)){et.next=26;break}if(We=this.annotations[Fe][ze]){et.next=21;break}return et.abrupt("continue",23);case 21:(Ue=document.getElementById(We.name))&&(this.toolMode!=="form"?We.isHidden==1?(Ue.style.display="none",Ue.style.pointerEvents="none"):We.isHidden==0&&(Ue.style.display="",Ue.style.pointerEvents=""):(Ue.style.display="",Ue.style.pointerEvents=""));case 23:ze++,et.next=17;break;case 26:et.next=14;break;case 28:case"end":return et.stop()}},Re,this)})),function(Re){return Pe.apply(this,arguments)})},{key:"updateTextPtr",value:(re=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze=this;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.next=2,this.messageHandler.sendWithPromise("ClearPage",{doc:this.doc});case 2:Te=0;case 3:if(!(Te<this.pagesCount)){We.next=17;break}return We.next=6,this.messageHandler.sendWithPromise("ClearText",{textPtr:this.pagesPtr[Te].textPtr});case 6:return We.next=8,this.messageHandler.sendWithPromise("GetPageSize",{doc:this.doc,pageIndex:Te});case 8:return He=We.sent,We.next=11,this.messageHandler.sendWithPromise("InitText",{pagePtr:He.pagePtr});case 11:Fe=We.sent,this.pagesPtr[Te].textPtr=Fe,this.pagesPtr[Te].pagePtr=He.pagePtr;case 14:Te++,We.next=3;break;case 17:return this.pdfViewer.pagesPtr=this.pagesPtr,this.pdfViewer._pages.forEach(function(Ue){Ue.pagePtr=ze.pagesPtr[Ue.pageIndex].pagePtr}),this.pdfViewer.refresh(),We.abrupt("return",new Promise(function(Ue){ze.eventBus._on("pagerendered",function et(){ze.eventBus._off("pagerendered",et),Ue()})}));case 21:case"end":return We.stop()}},Re,this)})),function(){return re.apply(this,arguments)})},{key:"setPropertyPanel",value:function(Re){this.eventBus.dispatch("propertyPanelChanged",Re)}},{key:"setContentEditorProperty",value:function(Re,Te){Re==="text"?this.eventBus.dispatch("textPropertyChanged",Te):Re==="image"&&this.eventBus.dispatch("imagePropertyChanged",Te)}},{key:"setAnnotationStyles",value:function(Re,Te){this.annotationManager.setAnnotationStyles(Re,Te)}},{key:"setInitProperty",value:function(){this.activeTool==="textfield"?this.eventBus.dispatch("initTextfieldName"):this.activeTool==="checkbox"?this.eventBus.dispatch("initCheckboxName"):this.activeTool==="radiobutton"?this.eventBus.dispatch("initRadioButtonName"):this.activeTool==="pushbutton"&&this.eventBus.dispatch("initPushButtonName")}},{key:"getDynamicStampPreview",value:(Q=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt;return _regeneratorRuntime().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:return dt.next=2,this.messageHandler.sendWithPromise("GetDynamicStampPreview",Te);case 2:return He=dt.sent,Fe=He.width,ze=He.height,We=He.imageArray,(Ue=document.createElement("canvas")).style.width=Fe+"px",Ue.style.height=ze+"px",Ue.width=Fe,Ue.height=ze,(et=Ue.getContext("2d")).clearRect(0,0,Ue.width,Ue.height),(it=et.createImageData(Fe,ze)).data.set(We),et.putImageData(it,0,0),nt=Ue.toDataURL("image/png",1),dt.abrupt("return",{width:Fe,height:ze,imgSrc:nt});case 18:case"end":return dt.stop()}},Re,this)})),function(Re){return Q.apply(this,arguments)})},{key:"handleField",value:function(Re){var Te=Re.id,He=Re.key,Fe=Re.value,ze=this.annotationManager.getAnnotationsList();if(Te&&ze&&He&&(Fe||Fe===0)){var We={name:Te};We[He]=Fe,this.eventBus.dispatch("setProperty",We)}}},{key:"handleSign",value:(te=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt;return _regeneratorRuntime().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:if(He=Te.type,Fe=He===void 0?0:He,ze=Te.flag,We=Te.param,ze!=="create"||this.Signatures||(this.Signatures=new Signatures({pdfViewer:this.pdfViewer,eventBus:this.eventBus,type:Fe})),ze!=="save"||!Fe){dt.next=6;break}return Ue=Te.pkcs12Buffer,et=Te.password,dt.next=6,this.updateSignatureAp(_objectSpread2$1({type:Fe,annotPtr:We.annotation.annotPtr,pkcs12Buffer:Ue,password:et},We));case 6:if(!this.Signatures&&Fe===0&&ze==="save"&&We.imageBase64&&(nt=(it=We.annotation)===null||it===void 0?void 0:it.annotation)&&nt.type==="signatureFields"&&this.updateSignatureAp({type:Fe,annotPtr:nt.annotPtr,pagePtr:nt.pagePtr,imageBase64:We.imageBase64,rect:nt.rect,annotation:nt}),this.Signatures){dt.next=9;break}return dt.abrupt("return");case 9:if(ze!=="clear"&&ze!=="create"||this.Signatures.clear(),ze!=="save"){dt.next=12;break}return dt.abrupt("return",this.Signatures.toImage(We));case 12:if(ze==="reset"&&(this.Signatures.reset(),this.Signatures=null),ze==="update"&&this.Signatures.update(We),ze!=="image"){dt.next=16;break}return dt.abrupt("return",this.Signatures.getImageBase64(We));case 16:case"end":return dt.stop()}},Re,this)})),function(Re){return te.apply(this,arguments)})},{key:"handleStamp",value:(U=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt;return _regeneratorRuntime().wrap(function(Tt){for(;;)switch(Tt.prev=Tt.next){case 0:if(Te){Tt.next=2;break}return Tt.abrupt("return");case 2:if(He=Te.page,Fe=this.pdfViewer.getPageView(He-1),ze=null,We=null,Fe&&(ze={left:Te.rect.x,top:Te.rect.y,right:Te.rect.x+Te.rect.width,bottom:Te.rect.y+Te.rect.height}),Te.stampType==="standard"&&(We={operate:"add-annot",type:"stamp",pageIndex:He-1,rect:ze,stampColor:"white",date:new Date,stampType:"standard",contents:Te.contents}),Te.stampType==="dynamic"&&(We={operate:"add-annot",type:"stamp",date:new Date,rect:ze,pageIndex:He-1,contents:Te.contents,time:Te.time,stampColor:Te.stampColor,stampType:"text"}),Te.stampType==="image"&&(We={operate:"add-annot",type:"stamp",stampType:"image",pageIndex:He-1,date:new Date,imageBase64:Te.imageBase64,rect:ze}),We.stampShape=0,We.rect){Tt.next=28;break}return Tt.next=14,this.messageHandler.sendWithPromise("GetStampRect",{doc:this.doc,pagePtr:this.pagesPtr[He-1].pagePtr,annotation:We});case 14:if(!(Ue=Tt.sent)||!Ue.code){Tt.next=19;break}return this.eventBus.dispatch("message",{type:"ERROR",message:result.message}),console.log(result.message),Tt.abrupt("return",!1);case 19:et=Fe.viewport.viewBox[2],it=Fe.viewport.viewBox[3],nt=Ue.right-Ue.left,dt=Ue.bottom-Ue.top,xt=(et-nt)/2,yt=(it-dt)/2,Bt=(et+nt)/2,Pt=(it+dt)/2,We.rect={left:xt,right:Bt,top:yt,bottom:Pt};case 28:this.eventBus.dispatch("annotationChange",{type:"add",annotation:We});case 29:case"end":return Tt.stop()}},Re,this)})),function(Re){return U.apply(this,arguments)})},{key:"compare",value:(H=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.messageHandler.sendWithPromise("CompareDocument",{data:Te});case 2:if(!(He=Fe.sent)||!He.code){Fe.next=7;break}return this.eventBus.dispatch("message",{type:"ERROR",message:He.message}),console.log(He.message),Fe.abrupt("return",!1);case 7:if(Te.type!==1){Fe.next=11;break}return Fe.abrupt("return",[{filename:Te.leftFile.name.replace(/(\.pdf)/,"_".concat(this.$t("compare.credit"),".pdf")),url:URL.createObjectURL(He.oldDocument)},{filename:Te.rightFile.name.replace(/(\.pdf)/,"_".concat(this.$t("compare.credit"),".pdf")),url:URL.createObjectURL(He.newDocument)},{filename:this.$t("compare.credit")+".pdf",url:URL.createObjectURL(He.blobData)}]);case 11:if(Te.type!==2){Fe.next=13;break}return Fe.abrupt("return",{filename:this._docName,url:URL.createObjectURL(He.blobData)});case 13:case"end":return Fe.stop()}},Re,this)})),function(Re){return H.apply(this,arguments)})},{key:"checkPassword",value:(X=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et=this,it=arguments;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return He=it.length>1&&it[1]!==void 0&&it[1],Fe={cMapUrl:CMAP_URL,cMapPacked:!0,enableXfa:!0},typeof Te=="string"?Fe.url=Te:Te&&"byteLength"in Te?Fe.data=Te:Te.url&&Te.originalUrl&&(Fe.url=Te.url),ze=pdfExports.getDocument(Fe),this.pdfLoadingTask=ze,We="",Ue=function(dt){return We=dt},ze.onPassword=function(dt,xt){et.passwordPrompt.setUpdateCallback(dt,xt,Ue),et.passwordPrompt.open()},nt.next=10,ze.promise.then(function(){return We&&!He&&(et._pwd=We),We}).catch(function(dt){return!1});case 10:return nt.abrupt("return",nt.sent);case 11:case"end":return nt.stop()}},Re,this)})),function(Re){return X.apply(this,arguments)})},{key:"handleCreateStatus",value:function(Re){var Te=Re.bool,He=Re.fileData;annotationStore.creating=Te,annotationStore.fileData=He}},{key:"initFontFile",value:(j=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){return _regeneratorRuntime().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:try{this.pdfViewer.setFontFile(this._fileList),this.fontFileInited=!0}catch(He){console.log(He)}case 1:case"end":return Te.stop()}},Re,this)})),function(){return j.apply(this,arguments)})},{key:"getPages",value:(Z=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We;return _regeneratorRuntime().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.next=2,this.messageHandler.sendWithPromise("GetPageCount",{doc:Te});case 2:He=Ue.sent,Fe=[],ze=0;case 5:if(!(ze<He)){Ue.next=13;break}return Ue.next=8,this.messageHandler.sendWithPromise("GetPageSize",{doc:Te,pageIndex:ze});case 8:We=Ue.sent,Fe.push({pagePtr:We.pagePtr,width:We.width,height:We.height});case 10:ze++,Ue.next=5;break;case 13:return Ue.abrupt("return",Fe);case 14:case"end":return Ue.stop()}},Re,this)})),function(Re){return Z.apply(this,arguments)})},{key:"getMinRadioSize",value:function(Re,Te,He){var Fe=Math.min(He.width/Re,He.height/Te);return{width:Re*Fe,height:Te*Fe}}},{key:"getDocEditorPages",value:(fe=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt,St,Ft,Gt,jt,Ut,Jt,un,nn=arguments;return _regeneratorRuntime().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:if(He=nn.length>1&&nn[1]!==void 0?nn[1]:0,Fe=nn.length>2&&nn[2]!==void 0?nn[2]:null,this.docEditorCopy){Zt.next=10;break}return Zt.next=5,this.messageHandler.sendWithPromise("createEditorDoc",{doc:this.doc,password:this._oldPwd||this._pwd});case 5:return ze=Zt.sent,Zt.next=8,this.getPages(ze);case 8:We=Zt.sent,this.docEditorCopy={doc:ze,pages:We};case 10:Ue=this.docEditorCopy.pages,et=window.devicePixelRatio||1,it=[],nt=[],dt=0;case 15:if(!(dt<(Fe!=null?Fe:Ue.length))){Zt.next=49;break}if(this.toolMode==="document"){Zt.next=18;break}return Zt.abrupt("break",49);case 18:return xt=Ue[dt+He],yt=it.pop()||document.createElement("canvas"),Bt=nt.pop()||yt.getContext("2d",{alpha:!1}),Pt=this.getMinRadioSize(xt.width,xt.height,Te),Tt=Pt.width,ct=Pt.height,wt=Math.round(Tt*et),St=Math.round(ct*et),Zt.next=26,this.messageHandler.sendWithPromise("RenderPageBitmap",{pagePtr:xt.pagePtr,x:0,y:0,width:wt,height:St});case 26:if(!(Ft=Zt.sent)||!Ft.code){Zt.next=31;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Ft.message}),console.log(Ft.message),Zt.abrupt("return");case 31:Gt=Ft.imageArray,yt.width=wt,yt.height=St,jt=Bt.createImageData(yt.width,yt.height),Ut=new Uint8ClampedArray(Gt.buffer),jt.data.set(Ut),Bt.putImageData(jt,0,0),Jt=yt.toDataURL("image/png",1),un={type:"page",img:Jt,size:{width:xt.width,height:xt.height},rotation:0},this.eventBus.dispatch("getDocEditorPages",{index:dt+He,pageData:un}),yt.width=0,yt.height=0,Bt.clearRect(0,0,wt,St),it.push(yt),nt.push(Bt);case 46:dt++,Zt.next=15;break;case 49:it.forEach(function(en){return URL.revokeObjectURL(en.toDataURL())}),it.length=0,nt.length=0;case 52:case"end":return Zt.stop()}},Re,this)})),function(Re){return fe.apply(this,arguments)})},{key:"updatePages",value:(J=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.messageHandler.sendWithPromise("SaveDocumentByStream",{doc:this.doc,saveType:2,password:this._oldPwd,oldPassword:this._oldPwd,permissionPassword:this._permissionPwd,permissions:this._setPermission});case 2:return Te=Fe.sent,He=this.saveAction,Fe.next=6,this.loadDocument(URL.createObjectURL(Te),{filename:this._docName,notUpdatePwd:!0,saveAction:He});case 6:this.eventBus.dispatch("onPagesUpdated",{pageNumber:this.page});case 7:case"end":return Fe.stop()}},Re,this)})),function(){return J.apply(this,arguments)})},{key:"insertBlankPageOri",value:(ve=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze,We,Ue=arguments;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if(He=Ue.length>1&&Ue[1]!==void 0?Ue[1]:595,Fe=Ue.length>2&&Ue[2]!==void 0?Ue[2]:842,!((Te=Ue.length>0&&Ue[0]!==void 0?Ue[0]:0)>this.pagesCount||Te<0)){et.next=5;break}return et.abrupt("return");case 5:return et.next=7,this.messageHandler.sendWithPromise("InsertPage",{doc:this.doc,index:Te,width:He,height:Fe});case 7:if(!(ze=et.sent)||!ze.code){et.next=12;break}return this.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),et.abrupt("return",!1);case 12:if(We=ze.status){et.next=16;break}return console.warn("insert page",We),et.abrupt("return",!1);case 16:return et.next=18,this.updatePages();case 18:case"end":return et.stop()}},Re,this)})),function(){return ve.apply(this,arguments)})},{key:"insertBlankPage",value:(ne=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe,ze=this,We=arguments;return _regeneratorRuntime().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Te=We.length>0&&We[0]!==void 0?We[0]:0,He=We.length>1&&We[1]!==void 0?We[1]:595,Fe=We.length>2&&We[2]!==void 0?We[2]:842,Ue.abrupt("return",this.enqueue(function(){return ze.insertBlankPageOri(Te,He,Fe)}));case 4:case"end":return Ue.stop()}},Re,this)})),function(){return ne.apply(this,arguments)})},{key:"insertPagesOri",value:(_e=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it=arguments;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(He=it.length>1&&it[1]!==void 0?it[1]:0,Fe=it.length>2&&it[2]!==void 0?it[2]:[0],ze=it.length>3&&it[3]!==void 0?it[3]:"",!(!Te||He>=this.pagesCount||He<0)){nt.next=5;break}return nt.abrupt("return");case 5:if(We=null,!Array.isArray(Fe)){nt.next=10;break}We=Fe.join(","),nt.next=15;break;case 10:if(Fe!=="all"){nt.next=14;break}We="all",nt.next=15;break;case 14:return nt.abrupt("return");case 15:return nt.next=17,this.messageHandler.sendWithPromise("ImportPagesAtIndex",{doc:this.doc,file:Te,range:We,index:He,password:ze});case 17:if(!(Ue=nt.sent)||!Ue.code){nt.next=22;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Ue.message}),console.log(Ue.message),nt.abrupt("return",!1);case 22:if(et=Ue.status){nt.next=26;break}return console.warn("insert pdf",et),nt.abrupt("return",!1);case 26:return nt.next=28,this.updatePages();case 28:case"end":return nt.stop()}},Re,this)})),function(Re){return _e.apply(this,arguments)})},{key:"insertPages",value:(Y=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We=this,Ue=arguments;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return He=Ue.length>1&&Ue[1]!==void 0?Ue[1]:0,Fe=Ue.length>2&&Ue[2]!==void 0?Ue[2]:[0],ze=Ue.length>3&&Ue[3]!==void 0?Ue[3]:"",et.abrupt("return",this.enqueue(function(){return We.insertPagesOri(Te,He,Fe,ze)}));case 4:case"end":return et.stop()}},Re,this)})),function(Re){return Y.apply(this,arguments)})},{key:"removePagesOri",value:(q=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe=this;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(Te.sort(function(We,Ue){return Ue-We}),He=null,Te.forEach(function(){var We=_asyncToGenerator(_regeneratorRuntime().mark(function Ue(et){var it;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(!He||!He.code){nt.next=2;break}return nt.abrupt("return");case 2:if(!(et>=Fe.pagesCount||et<0)){nt.next=4;break}return nt.abrupt("return");case 4:return nt.next=6,Fe.messageHandler.sendWithPromise("RemovePage",{doc:Fe.doc,index:et});case 6:He=nt.sent,(it=He.status)||console.warn("delete",it);case 9:case"end":return nt.stop()}},Ue)}));return function(Ue){return We.apply(this,arguments)}}()),!He||!He.code){ze.next=7;break}return this.eventBus.dispatch("message",{type:"ERROR",message:He.message}),console.log(He.message),ze.abrupt("return",!1);case 7:return ze.next=9,this.updatePages();case 9:case"end":return ze.stop()}},Re,this)})),function(Re){return q.apply(this,arguments)})},{key:"removePages",value:(F=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He=this;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.abrupt("return",this.enqueue(function(){return He.removePagesOri(Te)}));case 1:case"end":return Fe.stop()}},Re,this)})),function(Re){return F.apply(this,arguments)})},{key:"rotatePagesOri",value:(O=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe,ze=this;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(Fe=null,Te.forEach(function(){var Ue=_asyncToGenerator(_regeneratorRuntime().mark(function et(it){return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(!Fe||!Fe.code){nt.next=2;break}return nt.abrupt("return");case 2:if(!(it>=ze.pagesCount||it<0)){nt.next=4;break}return nt.abrupt("return");case 4:return nt.next=6,ze.messageHandler.sendWithPromise("RotatePage",{pagePtr:ze.pagesPtr[it].pagePtr,rotation:He});case 6:Fe=nt.sent;case 7:case"end":return nt.stop()}},et)}));return function(et){return Ue.apply(this,arguments)}}()),!Fe||!Fe.code){We.next=6;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Fe.message}),console.log(Fe.message),We.abrupt("return",!1);case 6:return We.next=8,this.updatePages();case 8:case"end":return We.stop()}},Re,this)})),function(Re,Te){return O.apply(this,arguments)})},{key:"copyPagesOri",value:(I=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et;return _regeneratorRuntime().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:Te.sort(function(nt,dt){return dt-nt}),He=null,Fe=_createForOfIteratorHelper(Te),it.prev=3,Fe.s();case 5:if((ze=Fe.n()).done){it.next=28;break}if(Ue=ze.value,(We=He)===null||We===void 0||!We.code){it.next=9;break}return it.abrupt("break",28);case 9:if(!(Ue>=this.pagesCount||Ue<0)){it.next=11;break}return it.abrupt("continue",26);case 11:return it.prev=11,it.next=14,this.messageHandler.sendWithPromise("CopyPage",{doc:this.doc,index:Ue});case 14:if(He=it.sent,(et=He)===null||et===void 0||!et.code){it.next=19;break}return this.eventBus.dispatch("message",{type:"ERROR",message:He.message}),console.log(He.message),it.abrupt("return",!1);case 19:He.status||console.warn("copy",He.status),it.next=26;break;case 22:return it.prev=22,it.t0=it.catch(11),console.error("\u590D\u5236\u9875\u9762\u5931\u8D25:",it.t0),it.abrupt("return",!1);case 26:it.next=5;break;case 28:it.next=33;break;case 30:it.prev=30,it.t1=it.catch(3),Fe.e(it.t1);case 33:return it.prev=33,Fe.f(),it.finish(33);case 36:return it.next=38,this.updatePages();case 38:return it.abrupt("return",!0);case 39:case"end":return it.stop()}},Re,this,[[3,30,33,36],[11,22]])})),function(Re){return I.apply(this,arguments)})},{key:"copyPages",value:(N=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He=this;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.abrupt("return",this.enqueue(function(){return He.copyPagesOri(Te)}));case 1:case"end":return Fe.stop()}},Re,this)})),function(Re){return N.apply(this,arguments)})},{key:"extractPages",value:(D=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze;return _regeneratorRuntime().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return He=Te.join(","),We.next=3,this.messageHandler.sendWithPromise("ExtractPage",{doc:this.doc,range:He});case 3:if(!(Fe=We.sent)||!Fe.code){We.next=8;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Fe.message}),console.log(Fe.message),We.abrupt("return",!1);case 8:if(ze=Fe.blobDataList){We.next=12;break}return console.warn("extract",0),We.abrupt("return",!1);case 12:return We.abrupt("return",ze[0]);case 13:case"end":return We.stop()}},Re,this)})),function(Re){return D.apply(this,arguments)})},{key:"movePagesOri",value:(T=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe,ze,We,Ue,et,it;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:Te.sort(function(dt,xt){return dt-xt}),He=Math.min(this.pagesCount,He),He=Math.max(0,He),Fe=0;case 4:if(!(Fe<Te.length)){nt.next=23;break}if(ze=void 0,We=void 0,!(Te[Fe]>=this.pagesCount||Te[Fe]<0)){nt.next=8;break}return nt.abrupt("continue",20);case 8:if(Te[Fe]===He)ze=Te[Fe],We=He;else if(Te[Fe]>He)if(ze=Te[Fe],Te.includes(He))for(We=He,Ue=0;Ue<Te.length;Ue++)Te[Ue]===We&&ze!==We&&We++;else We=He;else ze=Te[Fe]-Fe,We=He-1;if(!Te.includes(ze)||!Te.includes(We)||ze!==We){nt.next=11;break}return nt.abrupt("continue",20);case 11:return nt.next=13,this.messageHandler.sendWithPromise("MovePage",{doc:this.doc,index:ze,targetIndex:We});case 13:if(!(et=nt.sent)||!et.code){nt.next=18;break}return this.eventBus.dispatch("message",{type:"ERROR",message:et.message}),console.log(et.message),nt.abrupt("return",!1);case 18:(it=et.status)||console.warn("move",it);case 20:Fe++,nt.next=4;break;case 23:return nt.next=25,this.updatePages();case 25:case"end":return nt.stop()}},Re,this)})),function(Re,Te){return T.apply(this,arguments)})},{key:"movePages",value:(M=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe=this;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.abrupt("return",this.enqueue(function(){return Fe.movePagesOri(Te,He)}));case 1:case"end":return ze.stop()}},Re,this)})),function(Re,Te){return M.apply(this,arguments)})},{key:"saveDocumentEdit",value:(E=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt,St,Ft,Gt,jt=this;return _regeneratorRuntime().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(this.docEditorCopy){Ut.next=2;break}return Ut.abrupt("return");case 2:if(He=this.docEditorCopy.doc,Fe=function(){var Jt=_asyncToGenerator(_regeneratorRuntime().mark(function un(){return _regeneratorRuntime().wrap(function(nn){for(;;)switch(nn.prev=nn.next){case 0:return nn.next=2,jt.messageHandler.sendWithPromise("ClearDocument",He);case 2:jt.docEditorCopy=null;case 3:case"end":return nn.stop()}},un)}));return function(){return Jt.apply(this,arguments)}}(),ze=null,_typeof$1(Te)==="object"){Ut.next=22;break}if(Te!=="cancel"){Ut.next=10;break}return Ut.next=9,Fe();case 9:return Ut.abrupt("return");case 10:return this.saveAction==="remove"&&(this._pwd=""),Ut.next=13,this.messageHandler.sendWithPromise("SaveDocumentByStream",{doc:He,saveType:this.saveAction==="remove"?3:2,password:this._pwd,oldPassword:this._oldPwd,permissionPassword:this._permissionPwd,permissions:this._setPermission});case 13:if(We=Ut.sent,Ue=this._docName,Te!=="saveAs"){Ut.next=17;break}return Ut.abrupt("return",{blobData:We,filename:Ue});case 17:return et=URL.createObjectURL(We),this.saveAction==="set"&&this._oldPwd!==this._pwd&&(this._oldPwd=this._pwd),Ut.next=21,Fe();case 21:return Ut.abrupt("return",et);case 22:if(Te.type!=="insert"){Ut.next=50;break}if(!Te.file){Ut.next=41;break}return Ut.next=26,this.messageHandler.sendWithPromise("ImportPagesAtIndex",{doc:He,file:Te.file,range:Te.range,index:Te.pageIndex,password:Te.password});case 26:if(!(it=Ut.sent)||!it.code){Ut.next=31;break}return this.eventBus.dispatch("message",{type:"ERROR",message:it.message}),console.log(it.message),Ut.abrupt("return",!1);case 31:if(nt=it.status){Ut.next=35;break}return console.warn("insert pdf",nt),Ut.abrupt("return",!1);case 35:return Ut.next=37,this.getPages(He);case 37:return this.docEditorCopy.pages=Ut.sent,Ut.abrupt("return",this.docEditorCopy.pages.length);case 41:return Ut.next=43,this.messageHandler.sendWithPromise("InsertPage",{doc:He,index:Te.pageIndex,width:Te.size.width,height:Te.size.height});case 43:if(!(dt=Ut.sent)||!dt.code){Ut.next=48;break}return this.eventBus.dispatch("message",{type:"ERROR",message:dt.message}),console.log(dt.message),Ut.abrupt("return",!1);case 48:(xt=dt.status)||console.warn("insert page",xt);case 50:if(Te.type==="delete"&&Te.selectedPageIndexArray.forEach(function(){var Jt=_asyncToGenerator(_regeneratorRuntime().mark(function un(nn){var Zt;return _regeneratorRuntime().wrap(function(en){for(;;)switch(en.prev=en.next){case 0:if(!ze||!ze.code){en.next=2;break}return en.abrupt("return");case 2:return en.next=4,jt.messageHandler.sendWithPromise("RemovePage",{doc:He,index:nn});case 4:if(!(ze=en.sent)||!ze.code){en.next=9;break}return jt.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),en.abrupt("return");case 9:(Zt=ze.status)||console.warn("delete",Zt);case 11:case"end":return en.stop()}},un)}));return function(un){return Jt.apply(this,arguments)}}()),Te.type==="rotate"&&Te.selectedPageIndexArray.forEach(function(){var Jt=_asyncToGenerator(_regeneratorRuntime().mark(function un(nn){return _regeneratorRuntime().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:if(!ze||!ze.code){Zt.next=2;break}return Zt.abrupt("return");case 2:return Zt.next=4,jt.messageHandler.sendWithPromise("RotatePage",{pagePtr:jt.docEditorCopy.pages[nn].pagePtr,rotation:Te.rotation});case 4:if(!(ze=Zt.sent)||!ze.code){Zt.next=9;break}return jt.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),Zt.abrupt("return");case 9:case"end":return Zt.stop()}},un)}));return function(un){return Jt.apply(this,arguments)}}()),Te.type==="copy"&&Te.selectedPageIndexArray.forEach(function(){var Jt=_asyncToGenerator(_regeneratorRuntime().mark(function un(nn){var Zt;return _regeneratorRuntime().wrap(function(en){for(;;)switch(en.prev=en.next){case 0:if(!ze||!ze.code){en.next=2;break}return en.abrupt("return");case 2:return en.next=4,jt.messageHandler.sendWithPromise("CopyPage",{doc:He,index:nn});case 4:if(!(ze=en.sent)||!ze.code){en.next=9;break}return jt.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),en.abrupt("return",!1);case 9:(Zt=ze.status)||console.warn("copy",Zt);case 11:case"end":return en.stop()}},un)}));return function(un){return Jt.apply(this,arguments)}}()),Te.type!=="extract"){Ut.next=65;break}return Ut.next=56,this.messageHandler.sendWithPromise("ExtractPage",{doc:He,range:Te.range,separateFile:Te.separateFile});case 56:if(!(yt=Ut.sent)||!yt.code){Ut.next=61;break}return this.eventBus.dispatch("message",{type:"ERROR",message:yt.message}),console.log(yt.message),Ut.abrupt("return",!1);case 61:if((Bt=yt.blobDataList)||console.warn("extract",!1),Te.separateFile){for(Pt=new JSZip,Tt=[],ct=0;ct<Bt.length;ct++)wt=Bt[ct],Tt.push({blobData:wt.blobData,filename:wt.name+".pdf"});Tt.forEach(function(Jt){Pt.file(Jt.filename,Jt.blobData,{binary:!0})}),Pt.generateAsync({type:"blob"}).then(function(Jt){FileSaver_minExports.saveAs(Jt,"extracted documents.zip")})}else St=this._docName,FileSaver_minExports.saveAs(Bt[0],St);return Ut.abrupt("return");case 65:if(Te.type!=="move"){Ut.next=75;break}return Ut.next=68,this.messageHandler.sendWithPromise("MovePage",{doc:He,index:Te.pageIndex,targetIndex:Te.targetPageIndex});case 68:if(!(Ft=Ut.sent)||!Ft.code){Ut.next=73;break}return this.eventBus.dispatch("message",{type:"ERROR",message:Ft.message}),console.log(Ft.message),Ut.abrupt("return",!1);case 73:(Gt=Ft.status)||console.warn("move",Gt);case 75:if(!ze||!ze.code){Ut.next=79;break}return this.eventBus.dispatch("message",{type:"ERROR",message:ze.message}),console.log(ze.message),Ut.abrupt("return",!1);case 79:return Ut.next=81,this.getPages(He);case 81:this.docEditorCopy.pages=Ut.sent;case 82:case"end":return Ut.stop()}},Re,this)})),function(Re){return E.apply(this,arguments)})},{key:"addEditorImage",value:function(Re){if(Re){var Te=Re.imageBase64,He=Re.width,Fe=Re.height,ze=Re.pageNum,We=this.pdfViewer.getPageView(ze-1);if(We){var Ue=this.getAreaToPageRect(He,Fe,ze);We.contentContainer.addImageEditor({rect:Ue,imageBase64:Te})}}}},{key:"addAnnotationImage",value:function(Re){if(Re){var Te=Re.imageBase64,He=Re.width,Fe=Re.height,ze=Re.pageNum,We={operate:"add-annot",type:"stamp",stampType:"image",pageIndex:ze-1,imageBase64:Te,rect:this.getAreaToPageRect(He,Fe,ze),targetPage:ze,date:new Date,name:v4()};this.addAnnotations(We)}}},{key:"getAreaToPageRect",value:function(Re,Te,He){var Fe=this.pdfViewer.getPageView(He-1);if(Fe){var ze,We,Ue=.9*Fe.viewport.viewBox[2],et=.9*Fe.viewport.viewBox[3],it=Re/Te;it>Ue/et?(ze=Ue,We=Ue/it):(ze=et*it,We=et);var nt=Math.min(Ue,ze),dt=Math.min(et,We);return{left:(Ue-nt)/2+.1*Fe.viewport.viewBox[2],top:(et-dt)/2+.1*Fe.viewport.viewBox[3],right:(Ue+nt)/2,bottom:(et+dt)/2}}}},{key:"getSignature",value:(S=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt;return _regeneratorRuntime().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return He=window.devicePixelRatio||1,Fe=Te.rect,ze=parseInt(Fe.width*He),We=parseInt(Fe.height*He),Fe.width=ze,Fe.height=We,xt.next=8,this.messageHandler.sendWithPromise("CreateSignatureAP",{rect:Fe,content:Te.content,text:Te.text?Te.text:"",isContentAlginLeft:!!Te.isContentAlginLeft&&Te.isContentAlginLeft,isDrawOnlyContent:!!Te.isDrawOnlyContent&&Te.isDrawOnlyContent,isDrawLogo:!!Te.isDrawLogo&&Te.isDrawLogo,logoBase64:Te.logoBase64?Te.logoBase64:"",imageBase64:Te.imageBase64?Te.imageBase64:""});case 8:return Ue=xt.sent,(et=document.createElement("canvas")).style.width=ze+"px",et.style.height=We+"px",et.width=ze,et.height=We,(it=et.getContext("2d")).clearRect(0,0,et.width,et.height),(nt=it.createImageData(ze,We)).data.set(Ue),it.putImageData(nt,0,0),dt=et.toDataURL("image/png",1),xt.abrupt("return",dt);case 21:case"end":return xt.stop()}},Re,this)})),function(Re){return S.apply(this,arguments)})},{key:"deleteSignature",value:(P=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){return _regeneratorRuntime().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return this.messageHandler.sendWithPromise("RemoveSignature",{doc:this.doc,signaturePtr:Te.signaturePtr}),this.eventBus.dispatch("updateSignatureFieldAp",{signaturePtr:Te.signaturePtr}),annotationStore.signatures.splice(Te.index,1),He.next=5,this.getSignatures();case 5:case"end":return He.stop()}},Re,this)})),function(Re){return P.apply(this,arguments)})},{key:"getSignatures",value:(k=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He;return _regeneratorRuntime().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.messageHandler.sendWithPromise("GetSignatures",{doc:this.doc});case 2:return Te=Fe.sent,He=Te.signaturePtrList,Fe.abrupt("return",He);case 5:case"end":return Fe.stop()}},Re,this)})),function(){return k.apply(this,arguments)})},{key:"addToTrustedCertificateLists",value:(x=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return He=annotationStore.signatures[Te].signerList[0].signerPtr,ze.next=3,this.messageHandler.sendWithPromise("AddToTrustedCertificates",{signerPtr:He});case 3:return Fe=ze.sent,annotationStore.signatures[Te].signerList[0].isCertTrusted=!!Fe,this.eventBus.dispatch("getSignatures",annotationStore.signatures),ze.abrupt("return",Fe);case 7:case"end":return ze.stop()}},Re,this)})),function(Re){return x.apply(this,arguments)})},{key:"updateSignatureAp",value:(y=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt,St,Ft,Gt,jt,Ut,Jt,un,nn,Zt,en,Cn,$n;return _regeneratorRuntime().wrap(function(Rn){for(;;)switch(Rn.prev=Rn.next){case 0:if(He=Te.type,Fe=Te.pagePtr,ze=Te.rect,We=Te.annotPtr,Ue=Te.imageArray,et=Te.imageBase64,it=Te.annotation,nt=Te.width,dt=Te.height,!He){Rn.next=16;break}return xt=Te.content,yt=Te.isDrawOnlyContent,Bt=yt!==void 0&&yt,Pt=Te.isDrawLogo,Tt=Pt!==void 0&&Pt,ct=Te.isContentAlginLeft,wt=Te.text,St=Te.logoBase64,Ft=Te.pkcs12Buffer,Gt=Te.password,Rn.next=5,this.messageHandler.sendWithPromise("UpdateDigitalSignAp",{doc:this.doc,annotPtr:We,content:xt,isDrawOnlyContent:Bt,isDrawLogo:Tt,isContentAlginLeft:ct,text:wt,logoBase64:St,imageBase64:et,pkcs12Buffer:Ft,password:Gt,width:nt,height:dt,appearance:Te.appearance?Te.appearance:"default"});case 5:return jt=Rn.sent,Ut=URL.createObjectURL(jt),Jt=this._docName,un=this.page,Rn.next=11,this.loadDocument(Ut,{filename:Jt,notUpdatePwd:!0});case 11:this.page=un,this.eventBus.dispatch("onPagesUpdated",{pageNumber:un}),URL.revokeObjectURL(jt),Rn.next=19;break;case 16:return Rn.next=18,this.messageHandler.sendWithPromise("UpdateSignatureAP",{doc:this.doc,annotPtr:We,pagePtr:Fe,rect:ze,imageArray:Ue,imageBase64:et});case 18:this.eventBus.dispatch("updateSignatureFieldAp",{annotPtr:We});case 19:nn=this.annotationManager.getAnnotationById(it.name),this.eventBus.dispatch("annotationChanged",nn,"modify"),this.eventBus.dispatch("fieldChanged",nn.fieldName,!0),Zt=this.annotationManager.getAnnotationsList(),en=Zt.filter(function(Nn){return Nn.type==="signatureFields"&&!Nn.annotation.isSigned&&!Nn.annotation.isSignedDigitally}),this.eventBus.dispatch("signedComplete",{unSignedNumber:en.length}),this.autoJumpNextSign&&(Cn=en.findIndex(function(Nn){return Nn.name===it.name}),($n=en[Cn+1])&&this.jumpToAnnotation($n));case 26:case"end":return Rn.stop()}},Re,this)})),function(Re){return y.apply(this,arguments)})},{key:"verifySignature",value:(f=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){return _regeneratorRuntime().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return Te.next=2,this.getSignatures();case 2:case"end":return Te.stop()}},Re,this)})),function(){return f.apply(this,arguments)})},{key:"handleReplyAnnotation",value:(d=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt;return _regeneratorRuntime().wrap(function(St){for(;;)switch(St.prev=St.next){case 0:if(He=Te.type,Fe=Te.annotation,ze=Te.reply,We=Te.reviewAnnotState,Ue=Te.markedAnnotState,et=Fe.pagePtr,it=Fe.annotPtr,nt=this.annotations[Fe.pageIndex].find(function(Ft){return(Ft==null?void 0:Ft.name)===Fe.name})){St.next=5;break}return St.abrupt("return");case 5:if(He!=="add"){St.next=26;break}if(!ze){St.next=19;break}return ze.name=v4(),St.next=10,this.messageHandler.sendWithPromise("CreateReplyAnnotation",{pagePtr:et,annotPtr:it,reply:ze});case 10:return St.next=12,this.messageHandler.sendWithPromise("GetReplyAnnotation",{pagePtr:et,annotPtr:it});case 12:dt=St.sent,xt=dt.replies,yt=dt.markedAnnotState,Bt=dt.reviewAnnotState,xt.length&&(xt.forEach(function(Ft){return Ft.name=v4()}),nt.replies=xt),Bt&&(nt.reviewAnnotState=Bt),yt&&(nt.markedAnnotState=yt);case 19:if(!We&&!Ue){St.next=24;break}return St.next=22,this.messageHandler.sendWithPromise("CreateReplyStateAnnotation",{pagePtr:et,annotPtr:it,state:We||Ue});case 22:Pt=St.sent,Ue?nt.markedAnnotState=Pt:nt.reviewAnnotState=Pt;case 24:St.next=46;break;case 26:if(He!=="delete"){St.next=33;break}return St.next=29,this.messageHandler.sendWithPromise("RemoveAnnot",{annotPtr:ze.annotPtr});case 29:nt.replies=nt.replies.filter(function(Ft){return Ft.name!==ze.name}),nt.replies.forEach(function(Ft){Ft.index>ze.index&&Ft.index--}),St.next=46;break;case 33:if(He!=="edit"){St.next=46;break}if(!Ue&&!We){St.next=42;break}return St.next=37,this.messageHandler.sendWithPromise("SetState",{reviewAnnotState:We,markedAnnotState:Ue});case 37:Tt=St.sent,Ue&&(nt.markedAnnotState=Tt),We&&(nt.reviewAnnotState=Tt),St.next=46;break;case 42:this.messageHandler.sendWithPromise("EditReplyAnnotation",{reply:ze}),ct=nt.replies.findIndex(function(Ft){return Ft.name===ze.name}),wt=nt.replies[ct],nt.replies[ct]=_objectSpread2$1(_objectSpread2$1({},wt),ze);case 46:this.eventBus.dispatch("annotationUpdated",{annotations:this.annotations}),this.isAnnotationModified=!0;case 48:case"end":return St.stop()}},Re,this)})),function(Re){return d.apply(this,arguments)})},{key:"addReplyAnnotation",value:function(Re,Te){this.handleReplyAnnotation({type:"add",annotation:[Re],reply:[Te]})}},{key:"delReplyAnnotation",value:function(Re){this.handleReplyAnnotation({type:"delete",reply:[Re]})}},{key:"editReplyAnnotation",value:function(Re,Te){this.handleReplyAnnotation({type:"edit",annotation:[Re],reply:[Te]})}},{key:"setAnnotationState",value:function(Re){var Te=Re.annotation,He=Re.reviewAnnotState,Fe=Re.markedAnnotState;Fe?this.handleReplyAnnotation({type:"edit",annotation:Te,markedAnnotState:Fe}):He&&this.handleReplyAnnotation({type:"edit",annotation:Te,reviewAnnotState:He})}},{key:"setHighlightLink",value:function(Re){annotationStore.highlightLink=Re,this.eventBus.dispatch("setHighlightLink",Re)}},{key:"jumpToTheFirstUnfilledTextfield",value:function(){for(var Re=this.annotationManager.getAnnotationsList(),Te=0;Te<Re.length;Te++){var He=Re[Te];if(He.type==="textfield"&&!He.contents){this.jumpToAnnotation(He);break}}}},{key:"jumpToTheFirstUnSigned",value:function(){var Re=this.annotationManager.getAnnotationsList().filter(function(Te){return Te.type==="signatureFields"&&!Te.annotation.isSigned&&!Te.annotation.isSignedDigitally});Re.length&&this.jumpToAnnotation(Re[0])}},{key:"getUnfilledTextfieldNumber",value:function(){for(var Re=this.annotationManager.getAnnotationsList(),Te=0,He=0,Fe=0;Fe<Re.length;Fe++){var ze=Re[Fe];ze.type!=="textfield"||ze.contents||(Te++,ze.required&&He++)}return{unFilledAllNumber:Te,unFilledNumber:He}}},{key:"getUnSignedNumber",value:function(){return{unSignedNumber:this.annotationManager.getAnnotationsList().filter(function(Re){return Re.type==="signatureFields"&&!Re.annotation.isSigned&&!Re.annotation.isSignedDigitally}).length}}},{key:"setHighlightForm",value:function(Re){annotationStore.highlightForm=Re,this.eventBus.dispatch("setHighlightForm",Re)}},{key:"setAnnotator",value:function(Re){this.setCurrentUser(Re)}},{key:"getCurrentUser",value:function(){return this.annotator}},{key:"setCurrentUser",value:function(Re){var Te;if(Re!==this.annotator){this.annotator=Re;var He=(Te=this.annotationManager)===null||Te===void 0?void 0:Te.getSelectedAnnotation();He&&He.setPopupElementStyle&&He.setPopupElementStyle(),this.eventBus.dispatch("updateAnnotationPermission")}}},{key:"handlePopup",value:function(Re){var Te=Re.type,He=Re.tool,Fe={text:"textPopupClicked",cropPage:"cropPagePopupClicked",contentEditor:"contentEditorPopupClicked",measurement:"measurementPopupClicked"}[Te];Fe&&this.eventBus.dispatch(Fe,He)}},{key:"extractImagesFromPage",value:(g=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it=arguments;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(He=it.length>1&&it[1]!==void 0?it[1]:1,!(!Te||Te<1||Te>this.pagesCount)){nt.next=3;break}return nt.abrupt("return",null);case 3:return Fe=parseInt(this.getPageWidth(Te)*He),ze=parseInt(this.getPageHeight(Te)*He),nt.next=7,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagesPtr[Te-1].pagePtr,scale:He,left:0,right:Fe,top:0,bottom:ze,flag:1,form:1});case 7:return We=nt.sent,Ue=We.imageArray,et=this.imageArrayToUrl(Ue,Fe,ze),nt.abrupt("return",et);case 11:case"end":return nt.stop()}},Re,this)})),function(Re){return g.apply(this,arguments)})},{key:"getCropedPageImage",value:(v=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He){var Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt;return _regeneratorRuntime().wrap(function(St){for(;;)switch(St.prev=St.next){case 0:if(!(!Te||Te<1||Te>this.pagesCount)){St.next=2;break}return St.abrupt("return",null);case 2:if(He){St.next=7;break}if((Fe=this.pdfViewer._pages[Te-1])&&Fe.cropPage&&Fe.cropPage.rect){St.next=6;break}return St.abrupt("return",null);case 6:He=Fe.cropPage.rect;case 7:if(We=(ze=He).left,Ue=ze.right,et=ze.bottom,it=ze.top,nt=window.devicePixelRatio||1,dt=this.scale*nt,xt=parseInt(We*dt),yt=parseInt(Ue*dt),Bt=parseInt(et*dt),Pt=parseInt(it*dt),Tt=null,!this.renderLayerPermission||!this.layers.length){St.next=21;break}return St.next=18,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagesPtr[Te-1].pagePtr,left:xt,right:yt,bottom:Bt,top:Pt,scale:dt,ocgsPtr:_toConsumableArray$1(this.ocgsPtr),flag:1,form:1});case 18:Tt=St.sent,St.next=24;break;case 21:return St.next=23,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagesPtr[Te-1].pagePtr,scale:dt,left:xt,right:yt,bottom:Bt,top:Pt,flag:1,form:1});case 23:Tt=St.sent;case 24:if(!Tt||!Tt.code){St.next=28;break}return console.log(Tt.message),alert(Tt.message),St.abrupt("return",!1);case 28:return ct=Tt.imageArray,wt=this.imageArrayToUrl(ct,yt-xt,Bt-Pt),St.abrupt("return",wt);case 31:case"end":return St.stop()}},Re,this)})),function(Re,Te){return v.apply(this,arguments)})},{key:"calculateMaxViewportZoom",value:function(){var Re=1,Te=this.pagesCount,He=window.devicePixelRatio||1;He*=He;for(var Fe=0;Fe<Te;Fe++){var ze=this.getPageWidth(Fe+1),We=this.getPageHeight(Fe+1);Re=Math.max(Re,ze*We*He)}return Math.sqrt(43e5/Re)}},{key:"getVisibleRegionRect",value:function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.5,Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,He=this.getScrollViewElement();if(!He)return[];var Fe=He.getBoundingClientRect(),ze=He.scrollTop,We=He.scrollLeft,Ue=Fe.width,et=Fe.height,it=We+Math.max(0,Fe.left)-Ue*Te,nt=ze+Math.max(0,Fe.top)-et*Re;return{x1:it,y1:nt,x2:it+Ue*(1+2*Te),y2:nt+et*(1+2*Re)}}},{key:"calculatePageVisibility",value:function(Re,Te){var He=this.getPageWidth(Re),Fe=this.getPageHeight(Re),ze=this.pageToWindow({x:0,y:0},Re),We=this.pageToWindow({x:He,y:Fe},Re),Ue=Math.max(Te.x1-100,ze.x),et=Math.max(Te.y1-100,ze.y),it=Math.min(Te.x2+100,We.x),nt=Math.min(Te.y2+100,We.y);if(Ue!==it){var dt=window.devicePixelRatio||1,xt=this.scale*dt,yt=this.windowToPage({x:Ue,y:et},Re),Bt=this.windowToPage({x:it,y:nt},Re),Pt=Math.floor(yt.x*xt),Tt=Math.floor(yt.y*xt),ct=Math.ceil(Bt.x*xt),wt=Math.ceil(Bt.y*xt);return{x1:Pt,y1:Tt,x2:ct,y2:wt,width:ct-Pt,height:wt-Tt}}return null}},{key:"imageArrayToUrl",value:function(Re,Te,He){var Fe=document.createElement("canvas"),ze=Fe.getContext("2d");Fe.width=Te,Fe.height=He;var We=ze.createImageData(Te,He),Ue=new Uint8ClampedArray(Re.buffer);We.data.set(Ue),ze.putImageData(We,0,0);var et=Fe.toDataURL("image/png",1);return Fe.remove(),Fe=null,et}},{key:"resetOperate",value:(m=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:He=Te.operation,Fe=Te.pageNumber,this.pdfViewer._pages[Fe-1].contentContainer.handleResetOperate(He);case 2:case"end":return ze.stop()}},Re,this)})),function(Re){return m.apply(this,arguments)})},{key:"getContentEditManager",value:function(){return this.contentEditManager}},{key:"getContentEditHistoryManager",value:function(){return this.pdfViewer.contentEditHistoryManager}},{key:"setContentEditModyfied",value:function(Re){this.isContentEditModyfied=Re}},{key:"applyRedactions",value:(w=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(Te){nt.next=6;break}return nt.next=3,this.deleteAnnotations(this.redactionList);case 3:return this.redactionList.length=0,this.pdfViewer.refresh(),nt.abrupt("return");case 6:if(Te!=="all"){nt.next=13;break}return He=_toConsumableArray$1(this.redactionList),nt.next=10,this.deleteAnnotations(this.redactionList);case 10:this.redactionList.length=0,nt.next=15;break;case 13:Fe=Array.isArray(Te)?Te:[Te],He=Fe;case 15:ze=0;case 16:if(!(ze<He.length)){nt.next=48;break}if(!(We=He[ze]).annotation.erasure){nt.next=43;break}if(!We.annotation.rects||!We.annotation.rects.length){nt.next=39;break}Ue=_createForOfIteratorHelper(We.annotation.rects),nt.prev=21,Ue.s();case 23:if((et=Ue.n()).done){nt.next=29;break}return it=et.value,nt.next=27,this.messageHandler.sendWithPromise("ErasureRedactionFromRect",{pagePtr:We.pagePtr,rect:it});case 27:nt.next=23;break;case 29:nt.next=34;break;case 31:nt.prev=31,nt.t0=nt.catch(21),Ue.e(nt.t0);case 34:return nt.prev=34,Ue.f(),nt.finish(34);case 37:nt.next=41;break;case 39:return nt.next=41,this.messageHandler.sendWithPromise("ErasureRedactionFromRect",{pagePtr:We.pagePtr,rect:We.annotation.rect});case 41:nt.next=45;break;case 43:return nt.next=45,this.messageHandler.sendWithPromise("ApplyRedaction",{annotPtr:We.annotPtr});case 45:ze++,nt.next=16;break;case 48:return nt.next=50,this.updateTextPtr();case 50:return this.emptyAnnotations(),nt.next=53,this.reRenderAnnotations();case 53:this.pdfViewer.refresh();case 54:case"end":return nt.stop()}},Re,this,[[21,31,34,37]])})),function(Re){return w.apply(this,arguments)})},{key:"setAutoJumpNextSign",value:function(Re){this.autoJumpNextSign=Re}},{key:"getLayers",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function Re(){var Te,He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.messageHandler.sendWithPromise("GetLayers",this.doc);case 2:return Te=ze.sent,He=Te.layers,Fe=Te.ocgsPtr,this.layers=He,this.ocgsPtr=new Set(Fe),this.eventBus.dispatch("getLayers",He),ze.abrupt("return",this.layers);case 9:case"end":return ze.stop()}},Re,this)})),function(){return s.apply(this,arguments)})},{key:"setLayers",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt=this;return _regeneratorRuntime().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:He=Array.isArray(Te)?Te:[Te],Fe=this.ocgsPtr,ze=_toConsumableArray$1(Fe),We=!1,Ue=!1,et=function Bt(Pt,Tt){var ct,wt=_createForOfIteratorHelper(Tt);try{for(wt.s();!(ct=wt.n()).done;){var St=ct.value;if(St.node===Pt)return St;var Ft=Bt(Pt,St.children);if(Ft)return Ft}}catch(Gt){wt.e(Gt)}finally{wt.f()}return null},it=_createForOfIteratorHelper(He),yt.prev=7,dt=_regeneratorRuntime().mark(function Bt(){var Pt,Tt;return _regeneratorRuntime().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(Pt=nt.value,Tt=et(Pt.node,xt.layers),Pt.hasOwnProperty("visible")&&(Tt.visible=Pt.visible?1:0,Pt.visible?Fe.add(Pt.ocg):Fe.delete(Pt.ocg),Fe.has(0)&&Fe.delete(0),delete Pt.visible,Ue=!0),!["name","defaultVisible","isLocked","printState","exportState"].some(function(wt){return!!Pt.hasOwnProperty(wt)&&(Tt[wt]=Pt[wt],!0)})){ct.next=9;break}return ct.next=8,xt.messageHandler.sendWithPromise("SetLayer",Pt);case 8:We=!0;case 9:case"end":return ct.stop()}},Bt)}),it.s();case 10:if((nt=it.n()).done){yt.next=14;break}return yt.delegateYield(dt(),"t0",12);case 12:yt.next=10;break;case 14:yt.next=19;break;case 16:yt.prev=16,yt.t1=yt.catch(7),it.e(yt.t1);case 19:return yt.prev=19,it.f(),yt.finish(19);case 22:if(Ue&&!We||ze.length!==Fe.size||!ze.every(function(Bt){return Fe.has(Bt)})){yt.next=24;break}return yt.abrupt("return");case 24:this.pdfViewer.refreshCanvas();case 25:case"end":return yt.stop()}},Re,this,[[7,16,19,22]])})),function(Re){return u.apply(this,arguments)})},{key:"exportLayers",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et=arguments;return _regeneratorRuntime().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:if(He=et.length>1&&et[1]!==void 0&&et[1],Fe=Array.isArray(Te)?Te:[Te],Te||(Fe=this.layers.filter(function(nt){return nt.visible===1&&nt.exportState!==1||nt.exportState===0}).map(function(nt){return nt.ocg})),Fe.length){it.next=5;break}return it.abrupt("return",!1);case 5:return it.next=7,this.messageHandler.sendWithPromise("ExportLayers",{doc:this.doc,ocgsPtr:Fe});case 7:if(!(ze=it.sent)||!ze.code){it.next=12;break}return console.log(ze.message),alert(ze.message),it.abrupt("return",!1);case 12:if(ze){it.next=15;break}return console.warn("export",0),it.abrupt("return",!1);case 15:if(!He){it.next=22;break}return We=this._docName,Fe.length===1&&(Ue=function nt(dt,xt){var yt,Bt=_createForOfIteratorHelper(xt);try{for(Bt.s();!(yt=Bt.n()).done;){var Pt=yt.value;if(Pt.ocg===dt)return Pt;var Tt=nt(dt,Pt.children);if(Tt)return Tt}}catch(ct){Bt.e(ct)}finally{Bt.f()}return null}(Fe[0],this.layers))&&(We=Ue.name),FileSaver_minExports.saveAs(ze,We),it.abrupt("return",!0);case 22:return it.abrupt("return",ze);case 23:case"end":return it.stop()}},Re,this)})),function(Re){return r.apply(this,arguments)})},{key:"initColorFile",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe;return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(!Te){ze.next=4;break}He=convertFileToBuffer(Te),ze.next=10;break;case 4:return ze.next=6,fetch("./lib/CMYK/CoatedFOGRA39.icc");case 6:return Fe=ze.sent,ze.next=9,Fe.arrayBuffer();case 9:He=ze.sent;case 10:if(He){ze.next=13;break}return console.error("Invalid File"),ze.abrupt("return");case 13:this.colorFile=He;case 14:case"end":return ze.stop()}},Re,this)})),function(Re){return o.apply(this,arguments)})},{key:"updateViewWithColorIndex",value:function(Re){var Te=this;return annotationStore.ignoreColors=Re,this.eventBus.dispatch("updateSeparationView",Re),new Promise(function(He){Te.eventBus._on("finishUpdateSeparationView",function Fe(){Te.eventBus._off("finishUpdateSeparationView",Fe),He()})})}},{key:"enableColorSeparations",value:function(Re){var Te=this;if(this.toolMode==="separation"){var He=Array.isArray(Re)?Re:[Re],Fe=[];He.forEach(function(We){var Ue=Te.colorList.find(function(et){return et.name===We});Ue&&Fe.push(Ue.index)});var ze=annotationStore.ignoreColors.filter(function(We){return!Fe.includes(We)});this.updateViewWithColorIndex(ze),this.eventBus.dispatch("ignoreColorsUpdate",ze)}else console.warn("Color separation not enabled.")}},{key:"disableColorSeparations",value:function(Re){var Te=this;if(this.toolMode==="separation"){var He=Array.isArray(Re)?Re:[Re],Fe=[];He.forEach(function(ze){var We=Te.colorList.find(function(Ue){return Ue.name===ze});We&&Fe.push(We.index)}),Fe.length?(this.updateViewWithColorIndex(Fe),this.eventBus.dispatch("ignoreColorsUpdate",Fe)):console.warn("Invalid color.")}else console.warn("Color separation not enabled.")}},{key:"getColorSeparationsAtPoint",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te,He,Fe){return _regeneratorRuntime().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(this.toolMode==="separation"){ze.next=2;break}return ze.abrupt("return");case 2:return ze.next=4,this.pdfViewer._pages[Te-1].separation.getSelectPointColor({x:He,y:Fe});case 4:return ze.abrupt("return",ze.sent);case 5:case"end":return ze.stop()}},Re,this)})),function(Re,Te,He){return n.apply(this,arguments)})},{key:"printPages",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function Re(Te){var He,Fe,ze,We,Ue,et,it,nt,dt,xt,yt,Bt,Pt,Tt,ct,wt,St,Ft;return _regeneratorRuntime().wrap(function(Gt){for(;;)switch(Gt.prev=Gt.next){case 0:He=[],Fe=isNaN(Number(Te))?window.devicePixelRatio||1:Number(Te),ze=2500,We=new Set,this.layers.forEach(function(jt){jt.printState===0?We.add(jt.ocg):jt.printState===1?We.delete(jt.ocg):jt.visible?We.add(jt.ocg):We.delete(jt.ocg)}),Ue=0;case 6:if(!(Ue<this.pdfViewer._pages.length)){Gt.next=45;break}if(et=document.createElement("canvas"),it=et.getContext("2d"),nt=this.pagesPtr[Ue],dt=nt.width,xt=nt.height,yt=1,(Bt=Math.sqrt(dt*xt))>ze&&(yt=ze/Bt),Pt=Fe*yt,Tt=Math.round(dt*Pt),ct=Math.round(xt*Pt),et.width=Tt,et.height=ct,wt=null,this.toolMode!=="separation"||!annotationStore.ignoreColors.length){Gt.next=25;break}return Gt.next=22,this.messageHandler.sendWithPromise("RenderPageAndIgnoreColorByIndex",{sepColorPtr:this.pagesPtr[Ue].sepColorPtr,x:0,y:0,width:Tt,height:ct,indexs:annotationStore.ignoreColors,flag:1});case 22:wt=Gt.sent,Gt.next=34;break;case 25:if(!this.renderLayerPermission||!this.layers.length){Gt.next=31;break}return Gt.next=28,this.messageHandler.sendWithPromise("RenderLayerBitmapWithMatrix",{pagePtr:this.pagesPtr[Ue].pagePtr,left:0,top:0,right:Tt,bottom:ct,scale:Pt,ocgsPtr:_toConsumableArray$1(We),flag:1,form:1});case 28:wt=Gt.sent,Gt.next=34;break;case 31:return Gt.next=33,this.messageHandler.sendWithPromise("PushRenderTask",{pagePtr:this.pagesPtr[Ue].pagePtr,left:0,top:0,right:Tt,bottom:ct,scale:Pt,flag:1,form:1});case 33:wt=Gt.sent;case 34:if(!wt||!wt.code){Gt.next=37;break}return console.log(wt.message),Gt.abrupt("continue",42);case 37:St=wt.imageArray,(Ft=it.createImageData(Tt,ct)).data.set(St),it.putImageData(Ft,0,0),He[Ue]=et.toDataURL("image/png");case 42:Ue++,Gt.next=6;break;case 45:return Gt.abrupt("return",He);case 46:case"end":return Gt.stop()}},Re,this)})),function(Re){return e.apply(this,arguments)})},{key:"printDocument",value:function(Re){var Te=this,He=this.buildPrintContent(Re),Fe=window.parent.document.title,ze=function(){window.parent.document.title=Te._docName},We=function(){window.parent.document.title=Fe},Ue=document.createElement("iframe");Ue.style.display="none",document.body.appendChild(Ue),Ue.contentDocument.open(),Ue.contentDocument.write(He),Ue.contentDocument.close(),Ue.onload=function(){Ue.contentWindow.focus(),Ue.contentWindow.addEventListener("beforeprint",ze,{once:!0}),Ue.contentWindow.addEventListener("afterprint",We,{once:!0}),Ue.contentWindow.print(),setTimeout(function(){document.body.removeChild(Ue)},500)}}},{key:"buildPrintContent",value:function(Re){var Te=`
      <html>
        <head>
          <style>
            @media print {
              @page {
                margin: 0;
                padding: 0;
              }

              body {
                height: 100%;
                display: block! important;
                overflow: visible !important;
                margin: 0 !important;
                padding: 0 !important;
              }

              .page__container img {
                display: block !important;
                max-width: 100%;
                max-height: 100%;
                height: 100%;
                width: 100%;
                object-fit: contain;
                page-break-after: always;
                padding: 0;
                margin: 0;
              }
            }
          </style>
        </head>
        <body>
          <div class="page__container">
    `;return Re.forEach(function(He,Fe){Te+='<img src="'.concat(He,'" alt="Page ').concat(Fe+1,'">')}),Te+="</div></body></html>"}},{key:"setMeasurementDefaults",value:function(Re){var Te=this.annotationManager.getSelectedAnnotation();Te&&Te.measure&&this.eventBus.dispatch("measurePropertyPanelChanged",Re),this.pdfViewer.measurementTool.setDefaults(JSON.parse(JSON.stringify(Re)))}},{key:"getToolMode",value:function(){return this.activeTool}},{key:"getTool",value:function(Re){return this.annotationStore.defauleStyle[Re]}},{key:"setFreetextDefault",value:function(Re){Object.keys(Re).forEach(function(Te){annotationStore.freetextDefault[Te]=Re[Te]})}},{key:"setToolStyles",value:function(Re,Te){Object.keys(Te).forEach(function(He){annotationStore.defauleStyle[Re].defaults[He]=Te[He]})}},{key:"showPopup",value:function(Re){var Te,He,Fe,ze,We,Ue,et,it;switch(Re.type){case"measurementPopup":var nt=Re.annotation,dt=Re.pageIndex;if(it=(Te=this.pdfViewer)===null||Te===void 0||(Te=Te._pages)===null||Te===void 0?void 0:Te[dt],nt!=null&&nt.measure&&(He=it)!==null&&He!==void 0&&He.compdfAnnotationLayer){var xt=this.annotationManager.getAnnotationById(nt.name);xt&&xt.showPopup()}break;case"textPupop":(ze=it=(Fe=this.pdfViewer)===null||Fe===void 0||(Fe=Fe._pages)===null||Fe===void 0?void 0:Fe[Re.pageIndex])!==null&&ze!==void 0&&ze.textSelection&&it.textSelection.showTextPopup();break;case"cropPagePupop":(Ue=it=(We=this.pdfViewer)===null||We===void 0||(We=We._pages)===null||We===void 0?void 0:We[Re.pageIndex])!==null&&Ue!==void 0&&Ue.cropPage&&it.cropPage.showPopup();break;case"contentEditorPupop":var yt=(et=this.contentEditManager)===null||et===void 0?void 0:et.getSelectedEditBox();yt&&yt.showPopup(!1)}}}]);var e,n,o,r,u,s,w,m,v,g,d,f,y,x,k,P,S,E,M,T,D,N,I,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H,U,te,Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le,oe,ke,Ce,Ee,Be,Ve,Oe,je,Ge,Xe,qe,Ke,Je,rt,ht,vt,Ct,kt,mt,Vt,bt,ot,gt,tt,ut}(),PDFWorker=function(){return _createClass(function e(){_classCallCheck(this,e),_defineProperty$1(this,"destroyed",!1),this._promiseCapability=new PromiseExt,this._messageHandler=null,this._webWorker=null,this._initialize()},[{key:"_initialize",value:function(){var e=this;try{var n=new Worker("./lib/PDFWorker.js"),o=new MessageHandler("main","worker",n);this._messageHandler=o;var r=function(){n.removeEventListener("error",u),o.destroy(),n.terminate(),e.destroyed?e._promiseCapability.reject(new Error("Worker was destroyed")):console.error("The worker has been disabled.")},u=function(){e._webWorker||r()};n.addEventListener("error",u),o.on("test",function(w){n.removeEventListener("error",u),e.destroyed?r():w&&(e._messageHandler=o,e._webWorker=n,e._promiseCapability.resolve(!0))}),o.on("ready",function(w){if(n.removeEventListener("error",u),e.destroyed)r();else try{s(),o.send("Ready",!0)}catch{console.error("The worker has been disabled.")}});var s=function(){var w=new Uint8Array;o.send("test",w)};s()}catch(w){console.log(w),console.log("The worker has been disabled.")}}},{key:"promise",get:function(){return this._promiseCapability.promise}},{key:"messageHandler",get:function(){return this._messageHandler}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}}])}();const documentViewerMap=new Map,setDocumentViewer=(e,n,o)=>{if(n)documentViewerMap.set(e,n);else{const r=new ComPDFKitViewer(o);documentViewerMap.set(e,r)}},deleteDocumentViewer=e=>{documentViewerMap.delete(e)},getDocumentViewer=(e=1)=>documentViewerMap.get(e),getDocumentViewers=()=>Array.from(documentViewerMap.values()),loadDocument=(e,n,o)=>core.getDocumentViewer(o).loadDocument(e,n),initializeViewer=({container:e,viewer:n,thumbnailView:o,outlineView:r,toggleButton:u},s)=>core.getDocumentViewer(s).initializeViewer({container:e,viewer:n,thumbnailView:o,outlineView:r,toggleButton:u}),toggleSidebar=()=>core.getDocumentViewer().toggleSidebar(),getPagesCount=()=>core.getDocumentViewer().pagesCount,nextPage=()=>core.getDocumentViewer().nextPage(),previousPage=()=>core.getDocumentViewer().previousPage(),getCurrentPage=()=>core.getDocumentViewer().page,rotateClockwise=()=>core.getDocumentViewer().webViewerRotateCw(),rotateCounterclockwise=()=>core.getDocumentViewer().webViewerRotateCcw(),zoomIn=e=>core.getDocumentViewer(e).zoomIn(),zoomOut=e=>core.getDocumentViewer(e).zoomOut(),pageNumberChanged=e=>core.getDocumentViewer().pageNumberChanged(e.value),scaleChanged=(e,n)=>core.getDocumentViewer(n).webViewerScaleChanged(e),getScale=()=>core.getDocumentViewer().scale,switchAnnotationEditorMode=e=>core.getDocumentViewer().webViewerSwitchAnnotationEditorMode({mode:e}),switchTool=e=>core.getDocumentViewer().switchTool(e),requestFullScreenMode=()=>core.getDocumentViewer().requestFullScreenMode(),saveAnnotations=()=>core.getDocumentViewer().saveAnnotations(),removeAllAnnotations=()=>core.getDocumentViewer().removeAllAnnotations(),getOptionUrl=()=>core.getDocumentViewer().getOptionUrl(),importAnnotations=e=>core.getDocumentViewer().importAnnotations(e),switchSpreadMode=e=>core.getDocumentViewer().webViewerSwitchSpreadMode(e),webViewerNamedAction=(e,n)=>core.getDocumentViewer().webViewerNamedAction({action:e,close:n}),switchScrollMode=e=>core.getDocumentViewer().webViewerSwitchScrollMode(e),initConfig=(e,n=1)=>core.getDocumentViewer(n).initConfig(e),download=(e=!0,n)=>core.getDocumentViewer().download(e,n),addEvent=(e,n)=>core.getDocumentViewer().addEvent(e,n),removeEvent=(e,n)=>core.getDocumentViewer().removeEvent(e,n),setTool=({tool:e,color:n})=>core.getDocumentViewer().setTool({tool:e,color:n}),exportXfdf=(e=!1)=>core.getDocumentViewer().exportXfdf(e),webViewerPageMode=e=>core.getDocumentViewer().webViewerPageMode({mode:e}),setToolMode=e=>core.getDocumentViewer().setToolMode(e),setPropertyPanel=e=>core.getDocumentViewer().setPropertyPanel(e),setInitProperty=()=>core.getDocumentViewer().setInitProperty(),setDefaultSelect=e=>core.getDocumentViewer().setDefaultSelect(e),handleField=(e,n,o)=>core.getDocumentViewer().handleField(e,n,o),handleSign=e=>core.getDocumentViewer().handleSign(e),handleStamp=e=>core.getDocumentViewer().handleStamp(e),flattenPdfDownload=e=>core.getDocumentViewer().flattenPdfDownload(e),compare=e=>core.getDocumentViewer().compare(e),setPassword=e=>core.getDocumentViewer().setPassword(e),removePassword=()=>core.getDocumentViewer().removePassword(),checkPassword=(e,n)=>core.getDocumentViewer().checkPassword(e,n),handleCreateStatus=({bool:e,fileData:n})=>core.getDocumentViewer().handleCreateStatus({bool:e,fileData:n}),triggerPrinting=e=>core.getDocumentViewer().triggerPrinting(e),setContentEditorProperty=(e,n)=>core.getDocumentViewer().setContentEditorProperty(e,n),getOutlines=()=>core.getDocumentViewer().getOutlines(),search=(e,n)=>core.getDocumentViewer(1).search(e),setActiveSearchResult=(e,n,o)=>core.getDocumentViewer(1).setActiveSearchResult(e,n),clearSearchResults=e=>core.getDocumentViewer(1).clearSearchResults(),init=(e=1)=>core.getDocumentViewer(e).init(),getSelectedText=()=>core.getDocumentViewer().getSelectedText(),getDocEditorPages=(e,n,o)=>core.getDocumentViewer().getDocEditorPages(e,n,o),saveDocumentEdit=e=>core.getDocumentViewer().saveDocumentEdit(e),getScrollViewElement=(e=1)=>core.getDocumentViewer(e).getScrollViewElement(),getSelectedPage=(e,n,o=1)=>core.getDocumentViewer(o).getSelectedPage(e,n),pageToWindow=(e,n=1,o=1)=>core.getDocumentViewer(o).pageToWindow(e,n),windowToPage=(e,n=1,o=1)=>core.getDocumentViewer(o).windowToPage(e,n),addEditorImage=e=>core.getDocumentViewer().addEditorImage(e),flattenPdf=e=>core.getDocumentViewer().flattenPdf(e),getSignature=e=>core.getDocumentViewer().getSignature(e),deleteSignature=e=>core.getDocumentViewer().deleteSignature(e),loadCertificates=e=>core.getDocumentViewer().loadCertificates(e),addToTrustedCertificateLists=e=>core.getDocumentViewer().addToTrustedCertificateLists(e),verifySignature=()=>core.getDocumentViewer().verifySignature(),handleReplyAnnotation=e=>core.getDocumentViewer().handleReplyAnnotation(e),setHighlightLink$1=e=>core.getDocumentViewer().setHighlightLink(e),setHighlightForm$1=e=>core.getDocumentViewer().setHighlightForm(e),setAnnotator$1=e=>core.getDocumentViewer().setAnnotator(e),selectAnnotation=e=>core.getDocumentViewer().selectAnnotation(e),jumpToAnnotation=e=>core.getDocumentViewer().jumpToAnnotation(e),getCropedPageImage=e=>core.getDocumentViewer().getCropedPageImage(e),resetOperate=e=>core.getDocumentViewer().resetOperate(e),eventBus=()=>core.getDocumentViewer().eventBus,handlePopup=e=>core.getDocumentViewer().handlePopup(e),addAnnotationImage=e=>core.getDocumentViewer().addAnnotationImage(e),applyRedactions=e=>core.getDocumentViewer().applyRedactions(e),setAutoJumpNextSign$1=e=>core.getDocumentViewer().setAutoJumpNextSign(e),disableFillConsecutively=e=>core.getDocumentViewer().disableFillConsecutively(),setLayers=e=>core.getDocumentViewer().setLayers(e),exportLayers=(e,n)=>core.getDocumentViewer().exportLayers(e,n),updateViewWithColorIndex=e=>core.getDocumentViewer().updateViewWithColorIndex(e),setMeasurementDefaults=e=>core.getDocumentViewer().setMeasurementDefaults(e),setAnnotationStyles=(e,n,o)=>core.getDocumentViewer(1).setAnnotationStyles(e,n),setFreetextDefault=(e,n)=>core.getDocumentViewer(1).setFreetextDefault(e),getDynamicStampPreview=e=>core.getDocumentViewer().getDynamicStampPreview(e),getStampRect=e=>core.getDocumentViewer().getStampRect(e),getViewerElement=(e=1)=>core.getDocumentViewer(e).getViewerElement(),checkPermissionPassword=e=>core.getDocumentViewer().checkPermissionPassword(e),getPermission=e=>core.getDocumentViewer().getPermission(e),showPopup=e=>core.getDocumentViewer().showPopup(e),getAnnotationsList=()=>core.getDocumentViewer().getAnnotationManager().getAnnotationsList(),getAnnotationManager=(e=1)=>core.getDocumentViewer(e).getAnnotationManager(),isReadOnlyModeEnabled=(e=1)=>core.getDocumentViewer(e).isReadOnlyModeEnabled(),isFillConsecutively=e=>core.getDocumentViewer().isFillConsecutively(),setConsecutiveType=e=>core.getDocumentViewer().setConsecutiveType(e),enableSkipNoRequired=e=>core.getDocumentViewer().enableSkipNoRequired(),disableSkipNoRequired=e=>core.getDocumentViewer().disableSkipNoRequired(),getFormSignFilledAndUnfilled=e=>core.getDocumentViewer().getFormSignFilledAndUnfilled(),getRequiredFormSign=()=>core.getDocumentViewer().getRequiredFormSign(),isUserAdmin=(e=1)=>core.getDocumentViewer(e).isUserAdmin(),isSkipNoRequired=e=>core.getDocumentViewer().isSkipNoRequired(),getTool$1=e=>core.getDocumentViewer().getTool(e),getToolMode=()=>core.getDocumentViewer().getToolMode(),setToolStyles=(e,n)=>core.getDocumentViewer().setToolStyles(e,n),getConsecutiveType=()=>core.getDocumentViewer().getConsecutiveType(),getCurrentUser=()=>core.getDocumentViewer().getCurrentUser(),core={getDocumentViewer,setDocumentViewer,getDocumentViewers,deleteDocumentViewer,loadDocument,initializeViewer,toggleSidebar,getPagesCount,nextPage,previousPage,getCurrentPage,rotateClockwise,rotateCounterclockwise,zoomIn,zoomOut,pageNumberChanged,scaleChanged,getScale,switchAnnotationEditorMode,switchTool,requestFullScreenMode,saveAnnotations,removeAllAnnotations,getOptionUrl,importAnnotations,switchSpreadMode,webViewerNamedAction,switchScrollMode,initConfig,download,addEvent,removeEvent,setTool,exportXfdf,webViewerPageMode,setToolMode,setPropertyPanel,setInitProperty,setDefaultSelect,handleField,handleSign,handleStamp,flattenPdfDownload,compare,setPassword,removePassword,checkPassword,handleCreateStatus,triggerPrinting,setContentEditorProperty,getOutlines,search,setActiveSearchResult,clearSearchResults,init,getSelectedText,getDocEditorPages,saveDocumentEdit,getScrollViewElement,getSelectedPage,pageToWindow,windowToPage,addEditorImage,flattenPdf,getSignature,deleteSignature,loadCertificates,addToTrustedCertificateLists,verifySignature,handleReplyAnnotation,setHighlightLink:setHighlightLink$1,setHighlightForm:setHighlightForm$1,setAnnotator:setAnnotator$1,selectAnnotation,jumpToAnnotation,getCropedPageImage,resetOperate,eventBus,handlePopup,addAnnotationImage,applyRedactions,setAutoJumpNextSign:setAutoJumpNextSign$1,disableFillConsecutively,setLayers,exportLayers,updateViewWithColorIndex,setMeasurementDefaults,setAnnotationStyles,setFreetextDefault,getDynamicStampPreview,getStampRect,getViewerElement,checkPermissionPassword,getPermission,showPopup,getAnnotationsList,getAnnotationManager,isReadOnlyModeEnabled,isFillConsecutively,setConsecutiveType,enableSkipNoRequired,disableSkipNoRequired,getFormSignFilledAndUnfilled,getRequiredFormSign,isUserAdmin,isSkipNoRequired,getTool:getTool$1,getToolMode,setToolStyles,getConsecutiveType,getCurrentUser},isMobile=window.innerWidth<640;navigator.userAgent.indexOf("Edge")>-1;navigator.userAgent.indexOf("Edg/")>-1;navigator.userAgent.indexOf("Trident/7.0")>-1;navigator.userAgent.toLowerCase().indexOf("firefox")>-1;const checkForIOS13=navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,isIOS$1=window.navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||checkForIOS13,isAndroid=window.navigator.userAgent.match(/Android/i),isMobileDevice=isIOS$1||isAndroid||window.navigator.userAgent.match(/webOS|BlackBerry|IEMobile|Opera Mini/i);navigator.appVersion.indexOf("Mac")>-1;navigator.appVersion.indexOf("Windows")>-1;(function(){const e=window.navigator.userAgent.match(/OPR/),n=window.navigator.userAgent.match(/Maxthon/),o=window.navigator.userAgent.match(/Edge/);return window.navigator.userAgent.match(/Chrome\/(.*?) /)&&!e&&!n&&!o})();/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||/^((?!chrome|android).)*$/.test(navigator.userAgent);window.navigator.userAgent.match(/CriOS\/(.*?) /);window.navigator.userAgent.match(/(FxiOS)\/(.*?) /);const useViewerStore=defineStore({id:"viewer",state:()=>({language:"en",fullMode:!1,currentPage:0,searchStatus:!1,scale:"",oldScale:"",newScale:"",themeMode:"light",pageMode:0,webviewerMode:"Standalone",showAnnotationPopup:!0,scrollMode:"Vertical",pageLabels:[],zoomLevel:["auto","page-fit",.5,1,1.25,1.5,2,2.5],activeTab:0,activeStickNote:!1,activeActiveMeasure:!1,activeHand:!1,license:null,verified:!1,languages:[{code:"en",name:"English"},{code:"zh-CN",name:"\u7B80\u4F53\u4E2D\u6587"},{code:"zh-TW",name:"\u7E41\u9AD4\u4E2D\u6587"},{code:"fr",name:"Fran\xE7ais"},{code:"ja",name:"\u65E5\u672C\u8A9E"},{code:"th",name:"\u0E44\u0E17\u0E22"}],annotation:{isAnnotationExport:!0,isAnnotationImport:!0},electronicSignaturesList:[],digitalSignaturesList:[],customStamps:[],activeElements:{leftPanel:!1,rightPanel:!1,pageModePanel:!1,stampPanel:!1,linkPanel:!1,reply:!1,compareSettingDialog:!1,settingsDialog:!1,setPasswordModal:!1,signCreatePanel:!1,createCustomStampDialog:!1,digitalSignCreatePanel:!1,downloadSettingDialog:!1,printSettingDialog:!1,contentEditorPanel:!1,contentEditorPreventDialog:!1,docEditorPreventDialog:!1,insertPageSettingDialog:!1,deletePageDialog:!1,deleteCustomStampDialog:!1,extractPageSettingDialog:!1,movePageSettingDialog:!1,selectSignTypeDialog:!1,signatureAppearanceDialog:!1,signatureDetailsDialog:!1,certificateViewerDialog:!1,deleteSignatureDialog:!1,addDigitalFileDialog:!1,layerPropertyDialog:!1,colorSeparationPanel:!1,unsupportedMobileDialog:!1,redactionTipDialog:!1,measurementSettingsDialog:!1,measurePanel:!1,freetextPanel:!1,stylePanel:!1,permissionPasswordDialog:!1},digitalSignature:{preview:null},activeElementsTab:{leftPanel:"THUMBS",rightPanel:"GENERAL",stampPanel:"STANDARD",signPanel:"keyboard"},disabledElements:{header:{disabled:!1},pageNavOverlay:{disabled:!1},thumbnails:{disabled:!1},layers:{disabled:!1},outlines:{disabled:!1},annotation:{disabled:!1},signature:{disabled:!1},search:{disabled:!1}},headers:[{type:"toggleElementButton",img:"icon-header-sidebar-line",element:"leftPanel",dataElement:"leftPanelButton",title:"Left Panel",class:"toggle-button"},{type:"divider",hidden:["small-mobile"]},{type:"pageDisplayButton",dataElement:"pageDisplayButton",element:"pageDisplayButton",title:"Page Display"},{type:"fullScreenButton",dataElement:"fullScreenButton",element:"fullScreenButton",title:"Full Screen"},{type:"handToolButton",dataElement:"handToolButton",element:"handToolButton",title:"Pan Tool"},{type:"selectTools",dataElement:"selectTools"},{type:"divider",hidden:["small-mobile"]},{type:"zoomOverlay",dataElement:"zoomOverlayButton",element:"zoomOverlay",hiddenOnMobileDevice:!0},{type:"divider",hidden:["small-mobile"]},{type:"themeMode",dataElement:"themeMode",element:"themeMode"},{type:"stickyNoteButton",dataElement:"stickyNoteButton",element:"stickyNoteButton"},{type:"compareButton",dataElement:"compareButton",element:"compareButton",hidden:!0},{type:"saveButton",dataElement:"saveButton",element:"saveButton",hidden:!0},{type:"cropPageButton",dataElement:"cropPageButton",element:"cropPageButton"},{type:"openFileButton",dataElement:"openFileButton",element:"openFileButton",title:"Open File"}],rightHeaders:[{type:"openFileButton",dataElement:"openFileButton",element:"openFileButton",title:"Open File"},{type:"searchButton",dataElement:"searchButton",element:"searchButton",title:"Search"},{type:"pageModeButton",dataElement:"pageModeButton",element:"pageModeButton"},{type:"downloadButton",dataElement:"downloadButton",element:"downloadButton",title:"Download"},{type:"flattenButton",dataElement:"flattenButton",element:"flattenButton",title:"Save as Flattened PDF"},{type:"printButton",dataElement:"printButton",element:"printButton",title:"Print"},{type:"themeMode",dataElement:"themeMode",element:"themeMode"},{type:"settingButton",dataElement:"settingButton",element:"settingButton",title:"Setting"}],toolMode:"view",tools:[{element:"view",dataElement:"toolMenu-View"},{element:"annotation",dataElement:"toolMenu-Annotation"},{element:"form",dataElement:"toolMenu-Form"},{element:"measurement",dataElement:"toolMenu-Measurement"},{element:"sign",dataElement:"toolMenu-Sign"},{element:"security",dataElement:"toolMenu-Security"},{element:"redaction",dataElement:"toolMenu-Redaction"},{element:"compare",dataElement:"toolMenu-Compare"},{element:"editor",dataElement:"toolMenu-Editor"},{element:"document",dataElement:"toolMenu-Document"},{element:"separation",dataElement:"toolMenu-Separation"}],documentEditorHeaders:{leftHeaders:[{type:"toggleElementButton",dataElement:"toggleCancelButton",element:"cancelButton"}],rightHeaders:[{type:"toggleElementButton",dataElement:"toggleSaveButton",element:"saveButton"},{type:"toggleElementButton",dataElement:"toggleSaveAsButton",element:"saveAsButton"}]},toolItems:{annotation:[{type:"note",dataElement:"note"},{type:"text",dataElement:"text"},{type:"ink",dataElement:"ink"},{type:"highlight",dataElement:"highlight"},{type:"underline",dataElement:"underline"},{type:"strikeout",dataElement:"strikeout"},{type:"squiggly",dataElement:"squiggly"},{type:"circle",dataElement:"circle"},{type:"arc",dataElement:"arc"},{type:"square",dataElement:"square"},{type:"polygon",dataElement:"polygon"},{type:"cloudy",dataElement:"cloudy"},{type:"polyline",dataElement:"polyline"},{type:"arrow",dataElement:"arrow"},{type:"line",dataElement:"line"},{type:"freetext",dataElement:"freetext"},{type:"callout",dataElement:"callout"},{type:"stamp",dataElement:"stamp"},{type:"image",dataElement:"image"},{type:"link",dataElement:"link"},{type:"divider"},{type:"property",dataElement:"annotationPropertyPanelButton",id:"annotationPropertyPanelButton",title:"common.properties"}],form:[{type:"textFieldButton",dataElement:"textFieldButton",element:"textFieldButton",title:"Form Field"},{type:"checkBoxButton",dataElement:"checkBoxButton",element:"checkBoxButton",title:"Check Box"},{type:"radioButton",dataElement:"radioButton",element:"radioButton",title:"Radio Button"},{type:"listBox",dataElement:"listBox",element:"listBox",title:"List Box"},{type:"comboBox",dataElement:"comboBox",element:"comboBox",title:"Combo Box"},{type:"pushButton",dataElement:"pushButton",element:"pushButton",title:"Push Button"},{type:"fillForm",dataElement:"fillForm",element:"fillForm",title:"Fill Form"},{type:"divider"},{type:"property",dataElement:"formPropertyPanelButton",id:"formPropertyPanelButton",title:"common.properties"}],security:[{type:"encryption",dataElement:"encryption",title:"security.encryption"},{type:"decryption",dataElement:"decryption",title:"security.decryption"}],redaction:[{type:"fillBlack",dataElement:"redaction",title:"redaction.fillBlack"},{type:"fillWhite",dataElement:"remove",title:"redaction.fillWhite"}],compare:[{type:"comparedToolbar"}],editor:[{type:"addText",dataElement:"addText",element:"addText",title:"toolbar.editorTools.addText"},{type:"addImage",dataElement:"addImage",element:"addImage",title:"toolbar.editorTools.addImage"},{type:"divider"},{type:"undo",dataElement:"undo",element:"undo",title:"toolbar.editorTools.undo"},{type:"redo",dataElement:"redo",element:"redo",title:"toolbar.editorTools.redo"},{type:"divider"},{type:"property",dataElement:"editorPropertyPanelButton",id:"editorPropertyPanelButton",title:"common.properties"}],sign:[{type:"signatureToolBar"}],measurement:[{type:"line",dataElement:"measureLine",element:"measureLine",title:"toolbar.measurementTools.measureLine"},{type:"polyline",dataElement:"measureMultiline",element:"measureMultiline",title:"toolbar.measurementTools.measureMultiline"},{type:"curve",dataElement:"measureCurve",element:"measureCurve",title:"toolbar.measurementTools.measureCurve"},{type:"arc",dataElement:"measureArc",element:"measureArc",title:"toolbar.measurementTools.measureArc"},{type:"circle",dataElement:"measureCircle",element:"measureCircle",title:"toolbar.measurementTools.measureCircle"},{type:"rectangle",dataElement:"measureRectangle",element:"measureRectangle",title:"toolbar.measurementTools.measureRectangle"},{type:"polygon",dataElement:"measurePolygon",element:"measurePolygon",title:"toolbar.measurementTools.measurePolygon"},{type:"divider"},{type:"property",dataElement:"measurePropertyPanelButton",id:"measurePropertyPanelButton",title:"common.properties"}]},customFonts:[{fontFamily:"Helvetica",fontName:"Helvetica"},{fontFamily:"Courier",fontName:"Courier"},{fontFamily:"Times-Roman",fontName:"Times-Roman"}],enableSignatureTemplates:!0,signatureDialogTabs:["trackpad","keyboard","image"],signatureDialogProperties:{keyboard:{colors:[{type:"color",value:"rgb(0, 0, 0)"},{type:"color",value:"rgb(255, 0, 0)"},{type:"color",value:"rgb(45, 119, 250)"}],enableCustomColor:!0,fonts:["Arial","Courier New","Times New Roman"]},trackpad:{enableLineWidth:!0,lineWidth:5,colors:[{type:"color",value:"rgb(0, 0, 0)"},{type:"color",value:"rgb(255, 0, 0)"},{type:"color",value:"rgb(45, 119, 250)"}],enableCustomColor:!0}},downloading:!1,downloadError:"",popoverChanged:!1,compareStatus:"",upload:!0,uploadLoading:!1,compareMode:"content",contentEditorType:"text",signatureVerify:0,selectedSignatureField:null,disableSignatureTool:!1,documentEditorSaveStatus:!0,documentEditorSaveAsStatus:!0,textPopup:[{type:"copy",dataElement:"copyTextButton"},{type:"highlight",dataElement:"highlightButton"},{type:"underline",dataElement:"underlineButton"},{type:"strikeout",dataElement:"strikeoutButton"},{type:"squiggly",dataElement:"squigglyButton"}],cropPagePopup:[{type:"cropPage",dataElement:"cropDownloadButton"},{type:"close",dataElement:"exitCroppingButton"}],contentEditorPopup:[{type:"copy",dataElement:"copyTextButton"},{type:"property",dataElement:"propertyButton"},{type:"delete",dataElement:"deleteButton"}],measurementPopup:[{type:"reply",dataElement:"replyButton"},{type:"settings",dataElement:"measureSettingsButton"},{type:"property",dataElement:"measurePropertyButton"},{type:"delete",dataElement:"deleteMeasurementButton"}],isDisabledHeader:!1,rightPanelButtonDisabled:!0,redactionConfirmDialog:-1,commonLoading:!1,customLoading:null,showCompareTip:!1,readOnly:!1,userAdmin:!0,enableFillForm:!1,skipNoRequired:!1,consecutiveType:!1}),getters:{getLanguage(){return this.language},getFullMode(){return this.fullMode},getCurrentPage(){return this.currentPage},getThemeMode(){return this.themeMode},getPageMode(){return this.pageMode},getScrollMode(){return this.scrollMode},getWebviewerMode(){return this.webviewerMode},getActiveHeaderItems(){return this.headers},getActiveRightHeaderItems(){return this.rightHeaders},getDocumentEditorHeaders(){return this.documentEditorHeaders},isElementOpen:e=>n=>e.activeElements[n],getActiveElementTab:e=>n=>e.activeElementsTab[n],getScale(){return Math.round(this.scale*100)},getOldScale(){return Math.round(this.oldScale*100)},getNewScale(){return Math.round(this.newScale*100)},getActiveStickNote(){return this.activeStickNote},getActiveMeasure(){return this.activeActiveMeasure},getActiveHand(){return this.activeHand},getSearchStatus(){return this.searchStatus},getToolMode(){return this.toolMode},getTools(){return this.tools},getToolItems(){return this.toolItems},getDownloading(){return this.downloading},getDownloadError(){return this.downloadError},getPopoverChanged(){return this.popoverChanged},getCompareStatus(){return this.compareStatus},getUpload(){return this.upload},getUploadLoading(){return this.uploadLoading},getCompareMode(){return this.compareMode},getLicense(){return this.license},getVerified(){return this.verified},getContentEditorType(){return this.contentEditorType},getSignatureVerify(){return this.signatureVerify},getSelectedSignatureField(){return this.selectedSignatureField},getDigitalSignaturePreview(){return this.digitalSignature.preview},getCertSubject(){return this.digitalSignature.certSubject},getPopupItems(e){return n=>e[n]},getDisabledHeader(){return this.isDisabledHeader},getDisabledElementsObj:e=>e.disabledElements,getDisabledElements:e=>n=>{var o;return(o=e.disabledElements[n])==null?void 0:o.disabled},getRightPanelButtonDisabled(){return this.rightPanelButtonDisabled},getCustomFonts(){return this.customFonts},getRedactionConfirmDialog(){return this.redactionConfirmDialog},getCommonLoading(){return this.commonLoading},getSignatureDialogTabs(){return this.signatureDialogTabs},getEnableSignatureTemplates(){return this.enableSignatureTemplates},getSignatureDialogProperties(){return this.signatureDialogProperties},getCustomLoading(){return this.customLoading},isAnnotationExport(){return this.annotation.isAnnotationExport},isAnnotationImport(){return this.annotation.isAnnotationImport},getDisableSignatureTool(){return this.disableSignatureTool},isShowCompareTip(){return this.showCompareTip},getDocumentEditorSaveStatus(){return this.documentEditorSaveStatus},getDocumentEditorSaveAsStatus(){return this.documentEditorSaveAsStatus},getCustomStamps(){return this.customStamps},getElectronicSignaturesList(){return this.electronicSignaturesList},getDigitalSignaturesList(){return this.digitalSignaturesList},getIsAnnotationPopup(){return this.showAnnotationPopup},getLanguages(){return this.languages},getReadOnly(){return this.readOnly},getUserAdmin(e){return this.userAdmin},getEnableFillForm(){return this.enableFillForm},getConsecutiveType(){return this.consecutiveType},getSkipNoRequired(){return this.skipNoRequired}},actions:{resetSetting(){this.fullMode=!1,this.currentPage=0,this.scale="",this.themeMode="light",this.pageMode=0,this.scrollMode="Vertical",this.activeTab=0,this.searchStatus=!1,this.activeElements={leftPanel:!1,rightPanel:!1,pageModePanel:!1,stampPanel:!1,linkPanel:!1,compareSettingDialog:!1,settingsDialog:!1,contentEditorPreventDialog:!1,docEditorPreventDialog:!1,setPasswordModal:!1,signCreatePanel:!1,createCustomStampDialog:!1,digitalSignCreatePanel:!1,downloadSettingDialog:!1,printSettingDialog:!1,contentEditorPanel:!1,insertPageSettingDialog:!1,deletePageDialog:!1,deleteCustomStampDialog:!1,extractPageSettingDialog:!1,movePageSettingDialog:!1,selectSignTypeDialog:!1,signatureAppearanceDialog:!1,signatureDetailsDialog:!1,certificateViewerDialog:!1,deleteSignatureDialog:!1,addDigitalFileDialog:!1,colorSeparationPanel:!1,redactionTipDialog:!1,measurementSettingsDialog:!1,measurePanel:!1,freetextPanel:!1,stylePanel:!1},this.activeElementsTab={leftPanel:"THUMBS",rightPanel:"GENERAL",stampPanel:"STANDARD",signPanel:"trackpad"},this.signatureVerify=0},resetPanels(){this.activeElements.leftPanel&&this.closeElement("leftPanel"),this.searchStatus=!1,this.activeElements={leftPanel:!1,rightPanel:!1,pageModePanel:!1,stampPanel:!1}},setLanguage(e){this.language=e},setLicense(e){this.license=e},setVerified(e){this.verified=e},setFullMode(e){return this.fullMode=e},setCurrentPage(e){this.currentPage=e},setThemeMode(e){this.themeMode=e.toLowerCase()},setPageMode(e){this.pageMode=e},setScrollMode(e){this.scrollMode=e},setWebviewerMode(e){this.webviewerMode=e},setCurrentScale(e){this.scale=e},setOldCurrentScale(e){this.oldScale=e},setNewCurrentScale(e){this.newScale=e},openElement(e){this.activeElements[e]||(this.activeElements[e]=!0,e==="leftPanel"&&core.toggleSidebar())},closeElement(e){!this.activeElements[e]||(this.activeElements[e]=!1,e==="leftPanel"&&core.toggleSidebar()&&setTimeout(()=>core.webViewerPageMode("none"),0))},toggleElement(e){this.activeElements[e]?this.closeElement(e):this.openElement(e)},setActiveElementTab(e,n){this.activeElementsTab[e]=n;const o={THUMBS:"thumbs",OUTLINE:"outline"};o[n]&&setTimeout(()=>core.webViewerPageMode(o[n]),0)},toggleActiveStickNote(){this.activeStickNote=!this.activeStickNote},closeActiveStickNote(){this.activeStickNote=!1},toggleActiveMeasure(){this.activeActiveMeasure=!this.activeActiveMeasure},closeActiveMeasure(){this.activeActiveMeasure=!1},toggleActiveHand(e){this.activeHand=e},closeActiveHand(){this.activeHand=!1},setSearchStatus(e){this.searchStatus=e},setActiveToolMode(e){if(!(this.readOnly&&e!=="toolMenu-View")){if(isMobileDevice&&e==="separation"){this.activeElements.unsupportedMobileDialog=!0;return}this.toolMode=e,this.activeElements.stampPanel=!1,this.activeElements.linkPanel=!1,this.activeElements.contentEditorPanel=!1,this.activeElements.measurePanel=!1,this.activeElements.freetextPanel=!1,this.activeElements.stylePanel=!1,core.setToolMode(e)}},setDownloading(e){this.downloading=e},setDownloadError(e){this.downloadError=e},setActiveSignWay(e){this.activeElementsTab.signPanel=e},setPopoverChanged(e){this.popoverChanged=e},setCompareStatus(e){this.compareStatus=e},setUpload(e){this.upload=e},setUploadLoading(e){this.uploadLoading=e},setCompareMode(e){this.compareMode=e},setContentEditorType(e){this.contentEditorType=e},setSignatureVerify(e){this.signatureVerify=e},setSelectedSignatureField(e){this.selectedSignatureField=e},setDigitalSignaturePreview(e){this.digitalSignature.preview=e},setCertSubject(e){this.digitalSignature.certSubject=e},dispatch(e){return this[e]},getState(e){return e?this.$state[e]:this.$state},setDisableHeader(e){this.isDisabledHeader=e},setDisabledElements(e){const n=this.disabledElements;e in n?n[e].disabled=!0:n[e]={disabled:!0}},setEnabledElements(e){const n=this.disabledElements;e in n?n[e].disabled=!1:n[e]={disabled:!1}},setRightPanelButtonDisabled(e){this.rightPanelButtonDisabled=e},setCustomFonts(e){typeof e=="string"&&(e=[{fontName:e,fontFamily:e}]);for(let n=0;n<e.length;n++){let o=e[n];typeof o=="string"&&(o={fontFamily:o,fontName:o}),this.customFonts.some(r=>r.fontName===o.fontName&&r.fontFamily===o.fontFamily)||this.customFonts.push(o)}},setRedactionConfirmDialog(e){this.redactionConfirmDialog=e},setCommonLoading(e){this.commonLoading=Boolean(e)},setSignatureDialogTabs(e){this.signatureDialogTabs=e},setEnableSignatureTemplates(e){this.enableSignatureTemplates=e},setSignatureDialogProperties(e,n){const o={...this.signatureDialogProperties[e],...n};this.signatureDialogProperties[e]=o},setCustomLoading(e){this.customLoading=e},setAnnotationExport(e){this.annotation.isAnnotationExport=e},setAnnotationImport(e){this.annotation.isAnnotationImport=e},setDisableSignatureTool(e){this.disableSignatureTool=e},setShowCompareTip(e){this.showCompareTip=e},setDocumentEditorSaveStatus(e){this.documentEditorSaveStatus=e},setDocumentEditorSaveAsStatus(e){this.documentEditorSaveAsStatus=e},addCustomStamps(e){this.customStamps.unshift(e),window.localStorage.setItem("customStamps",JSON.stringify(this.customStamps))},setCustomStamps(e){this.customStamps=e},removeCustomStamp(e){this.customStamps.splice(e,1),window.localStorage.setItem("customStamps",JSON.stringify(this.customStamps))},addElectronicSignature(e){this.electronicSignaturesList.unshift(e),window.localStorage.setItem("electronicSignatures",JSON.stringify(this.electronicSignaturesList))},setElectronicSignature(e){this.electronicSignaturesList=e},addDigitalSignature(e){this.digitalSignaturesList.unshift(e),window.localStorage.setItem("digitalSignatures",JSON.stringify(this.digitalSignaturesList))},setDigitalSignature(e){this.digitalSignaturesList=e},removeElectronicSignature(e){this.electronicSignaturesList.splice(e,1),window.localStorage.setItem("electronicSignatures",JSON.stringify(this.electronicSignaturesList))},removeDigitalSignature(e){this.digitalSignaturesList.splice(e,1),window.localStorage.setItem("digitalSignatures",JSON.stringify(this.digitalSignaturesList))},toggleAnnotationPopup(e){this.showAnnotationPopup=e},setLanguages(e){this.languages=e},addLanguage(e){this.languages.push(e)},removeLanguage(e){this.languages=this.languages.filter(n=>e.code!==n.code)},setReadOnly(e){this.readOnly=e},setUserAdmin(e){this.userAdmin=e},setEnableFillForm(e){this.enableFillForm=e},setConsecutiveType(e){this.consecutiveType=e},setSkipNoRequired(e){this.skipNoRequired=e}}}),_sfc_main$4A={},_hoisted_1$4b={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3Z=createStaticVNode('<circle cx="12" cy="12" r="11.5333" fill="white" stroke="#DADBDE" stroke-width="0.933333"></circle><mask id="mask0_5731_11399" style="mask-type:luminance;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24"><circle cx="12" cy="12" r="12" fill="white"></circle></mask><g mask="url(#mask0_5731_11399)"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.61636 22.203L2.00011 20.5868L20.5869 2L22.2032 3.61624L3.61636 22.203Z" fill="#FA1E5D"></path></g>',3),_hoisted_5$T=[_hoisted_2$3Z];function _sfc_render$2U(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4b,_hoisted_5$T)}const __unplugin_components_0$z=_export_sfc(_sfc_main$4A,[["render",_sfc_render$2U]]);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){var n=e.default;if(typeof n=="function"){var o=function(){return n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var u=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(o,r,u.get?u:{enumerable:!0,get:function(){return e[r]}})}),o}var dayjs_min={exports:{}};(function(e,n){(function(o,r){e.exports=r()})(commonjsGlobal,function(){var o=1e3,r=6e4,u=36e5,s="millisecond",w="second",m="minute",v="hour",g="day",d="week",f="month",y="quarter",x="year",k="date",P="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(J){var fe=["th","st","nd","rd"],Z=J%100;return"["+J+(fe[(Z-20)%10]||fe[Z]||fe[0])+"]"}},T=function(J,fe,Z){var j=String(J);return!j||j.length>=fe?J:""+Array(fe+1-j.length).join(Z)+J},D={s:T,z:function(J){var fe=-J.utcOffset(),Z=Math.abs(fe),j=Math.floor(Z/60),X=Z%60;return(fe<=0?"+":"-")+T(j,2,"0")+":"+T(X,2,"0")},m:function J(fe,Z){if(fe.date()<Z.date())return-J(Z,fe);var j=12*(Z.year()-fe.year())+(Z.month()-fe.month()),X=fe.clone().add(j,f),H=Z-X<0,U=fe.clone().add(j+(H?-1:1),f);return+(-(j+(Z-X)/(H?X-U:U-X))||0)},a:function(J){return J<0?Math.ceil(J)||0:Math.floor(J)},p:function(J){return{M:f,y:x,w:d,d:g,D:k,h:v,m,s:w,ms:s,Q:y}[J]||String(J||"").toLowerCase().replace(/s$/,"")},u:function(J){return J===void 0}},N="en",I={};I[N]=M;var O="$isDayjsObject",F=function(J){return J instanceof ne||!(!J||!J[O])},q=function J(fe,Z,j){var X;if(!fe)return N;if(typeof fe=="string"){var H=fe.toLowerCase();I[H]&&(X=H),Z&&(I[H]=Z,X=H);var U=fe.split("-");if(!X&&U.length>1)return J(U[0])}else{var te=fe.name;I[te]=fe,X=te}return!j&&X&&(N=X),X||!j&&N},Y=function(J,fe){if(F(J))return J.clone();var Z=typeof fe=="object"?fe:{};return Z.date=J,Z.args=arguments,new ne(Z)},_e=D;_e.l=q,_e.i=F,_e.w=function(J,fe){return Y(J,{locale:fe.$L,utc:fe.$u,x:fe.$x,$offset:fe.$offset})};var ne=function(){function J(Z){this.$L=q(Z.locale,null,!0),this.parse(Z),this.$x=this.$x||Z.x||{},this[O]=!0}var fe=J.prototype;return fe.parse=function(Z){this.$d=function(j){var X=j.date,H=j.utc;if(X===null)return new Date(NaN);if(_e.u(X))return new Date;if(X instanceof Date)return new Date(X);if(typeof X=="string"&&!/Z$/i.test(X)){var U=X.match(S);if(U){var te=U[2]-1||0,Q=(U[7]||"0").substring(0,3);return H?new Date(Date.UTC(U[1],te,U[3]||1,U[4]||0,U[5]||0,U[6]||0,Q)):new Date(U[1],te,U[3]||1,U[4]||0,U[5]||0,U[6]||0,Q)}}return new Date(X)}(Z),this.init()},fe.init=function(){var Z=this.$d;this.$y=Z.getFullYear(),this.$M=Z.getMonth(),this.$D=Z.getDate(),this.$W=Z.getDay(),this.$H=Z.getHours(),this.$m=Z.getMinutes(),this.$s=Z.getSeconds(),this.$ms=Z.getMilliseconds()},fe.$utils=function(){return _e},fe.isValid=function(){return this.$d.toString()!==P},fe.isSame=function(Z,j){var X=Y(Z);return this.startOf(j)<=X&&X<=this.endOf(j)},fe.isAfter=function(Z,j){return Y(Z)<this.startOf(j)},fe.isBefore=function(Z,j){return this.endOf(j)<Y(Z)},fe.$g=function(Z,j,X){return _e.u(Z)?this[j]:this.set(X,Z)},fe.unix=function(){return Math.floor(this.valueOf()/1e3)},fe.valueOf=function(){return this.$d.getTime()},fe.startOf=function(Z,j){var X=this,H=!!_e.u(j)||j,U=_e.p(Z),te=function(Me,Ie){var Le=_e.w(X.$u?Date.UTC(X.$y,Ie,Me):new Date(X.$y,Ie,Me),X);return H?Le:Le.endOf(g)},Q=function(Me,Ie){return _e.w(X.toDate()[Me].apply(X.toDate("s"),(H?[0,0,0,0]:[23,59,59,999]).slice(Ie)),X)},re=this.$W,Pe=this.$M,be=this.$D,we="set"+(this.$u?"UTC":"");switch(U){case x:return H?te(1,0):te(31,11);case f:return H?te(1,Pe):te(0,Pe+1);case d:var Ae=this.$locale().weekStart||0,$e=(re<Ae?re+7:re)-Ae;return te(H?be-$e:be+(6-$e),Pe);case g:case k:return Q(we+"Hours",0);case v:return Q(we+"Minutes",1);case m:return Q(we+"Seconds",2);case w:return Q(we+"Milliseconds",3);default:return this.clone()}},fe.endOf=function(Z){return this.startOf(Z,!1)},fe.$set=function(Z,j){var X,H=_e.p(Z),U="set"+(this.$u?"UTC":""),te=(X={},X[g]=U+"Date",X[k]=U+"Date",X[f]=U+"Month",X[x]=U+"FullYear",X[v]=U+"Hours",X[m]=U+"Minutes",X[w]=U+"Seconds",X[s]=U+"Milliseconds",X)[H],Q=H===g?this.$D+(j-this.$W):j;if(H===f||H===x){var re=this.clone().set(k,1);re.$d[te](Q),re.init(),this.$d=re.set(k,Math.min(this.$D,re.daysInMonth())).$d}else te&&this.$d[te](Q);return this.init(),this},fe.set=function(Z,j){return this.clone().$set(Z,j)},fe.get=function(Z){return this[_e.p(Z)]()},fe.add=function(Z,j){var X,H=this;Z=Number(Z);var U=_e.p(j),te=function(Pe){var be=Y(H);return _e.w(be.date(be.date()+Math.round(Pe*Z)),H)};if(U===f)return this.set(f,this.$M+Z);if(U===x)return this.set(x,this.$y+Z);if(U===g)return te(1);if(U===d)return te(7);var Q=(X={},X[m]=r,X[v]=u,X[w]=o,X)[U]||1,re=this.$d.getTime()+Z*Q;return _e.w(re,this)},fe.subtract=function(Z,j){return this.add(-1*Z,j)},fe.format=function(Z){var j=this,X=this.$locale();if(!this.isValid())return X.invalidDate||P;var H=Z||"YYYY-MM-DDTHH:mm:ssZ",U=_e.z(this),te=this.$H,Q=this.$m,re=this.$M,Pe=X.weekdays,be=X.months,we=X.meridiem,Ae=function(Ie,Le,le,oe){return Ie&&(Ie[Le]||Ie(j,H))||le[Le].slice(0,oe)},$e=function(Ie){return _e.s(te%12||12,Ie,"0")},Me=we||function(Ie,Le,le){var oe=Ie<12?"AM":"PM";return le?oe.toLowerCase():oe};return H.replace(E,function(Ie,Le){return Le||function(le){switch(le){case"YY":return String(j.$y).slice(-2);case"YYYY":return _e.s(j.$y,4,"0");case"M":return re+1;case"MM":return _e.s(re+1,2,"0");case"MMM":return Ae(X.monthsShort,re,be,3);case"MMMM":return Ae(be,re);case"D":return j.$D;case"DD":return _e.s(j.$D,2,"0");case"d":return String(j.$W);case"dd":return Ae(X.weekdaysMin,j.$W,Pe,2);case"ddd":return Ae(X.weekdaysShort,j.$W,Pe,3);case"dddd":return Pe[j.$W];case"H":return String(te);case"HH":return _e.s(te,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return Me(te,Q,!0);case"A":return Me(te,Q,!1);case"m":return String(Q);case"mm":return _e.s(Q,2,"0");case"s":return String(j.$s);case"ss":return _e.s(j.$s,2,"0");case"SSS":return _e.s(j.$ms,3,"0");case"Z":return U}return null}(Ie)||U.replace(":","")})},fe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},fe.diff=function(Z,j,X){var H,U=this,te=_e.p(j),Q=Y(Z),re=(Q.utcOffset()-this.utcOffset())*r,Pe=this-Q,be=function(){return _e.m(U,Q)};switch(te){case x:H=be()/12;break;case f:H=be();break;case y:H=be()/3;break;case d:H=(Pe-re)/6048e5;break;case g:H=(Pe-re)/864e5;break;case v:H=Pe/u;break;case m:H=Pe/r;break;case w:H=Pe/o;break;default:H=Pe}return X?H:_e.a(H)},fe.daysInMonth=function(){return this.endOf(f).$D},fe.$locale=function(){return I[this.$L]},fe.locale=function(Z,j){if(!Z)return this.$L;var X=this.clone(),H=q(Z,j,!0);return H&&(X.$L=H),X},fe.clone=function(){return _e.w(this.$d,this)},fe.toDate=function(){return new Date(this.valueOf())},fe.toJSON=function(){return this.isValid()?this.toISOString():null},fe.toISOString=function(){return this.$d.toISOString()},fe.toString=function(){return this.$d.toUTCString()},J}(),ve=ne.prototype;return Y.prototype=ve,[["$ms",s],["$s",w],["$m",m],["$H",v],["$W",g],["$M",f],["$y",x],["$D",k]].forEach(function(J){ve[J[1]]=function(fe){return this.$g(fe,J[0],J[1])}}),Y.extend=function(J,fe){return J.$i||(J(fe,ne,Y),J.$i=!0),Y},Y.locale=q,Y.isDayjs=F,Y.unix=function(J){return Y(1e3*J)},Y.en=I[N],Y.Ls=I,Y.p={},Y})})(dayjs_min);const dayjs=dayjs_min.exports;var fabric$1={};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var n=n||{version:"5.5.2"};if(e.fabric=n,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?n.document=document:n.document=document.implementation.createHTMLDocument(""),n.window=window;else{var o=require$$2,r=new o.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;n.document=r.document,n.jsdomImplForWrapper=require$$2.implForWrapper,n.nodeCanvas=require$$2.Canvas,n.window=r,DOMParser=n.window.DOMParser}n.isTouchSupported="ontouchstart"in n.window||"ontouchstart"in n.document||n.window&&n.window.navigator&&n.window.navigator.maxTouchPoints>0,n.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",n.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],n.DPI=96,n.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",n.commaWsp="(?:\\s+,?\\s*|,\\s*)",n.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,n.reNonWord=/[ \n\.,;!\?\-]/,n.fontPaths={},n.iMatrix=[1,0,0,1,0,0],n.svgNS="http://www.w3.org/2000/svg",n.perfLimitSizeTotal=2097152,n.maxCacheSideLimit=4096,n.minCacheSideLimit=256,n.charWidthsCache={},n.textureSize=2048,n.disableStyleCopyPaste=!1,n.enableGLFiltering=!0,n.devicePixelRatio=n.window.devicePixelRatio||n.window.webkitDevicePixelRatio||n.window.mozDevicePixelRatio||1,n.browserShadowBlurConstant=1,n.arcToSegmentsCache={},n.boundsOfCurveCache={},n.cachesBoundsOfCurve=!0,n.forceGLPutImageData=!1,n.initFilterBackend=function(){if(n.enableGLFiltering&&n.isWebglSupported&&n.isWebglSupported(n.textureSize))return console.log("max texture size: "+n.maxTextureSize),new n.WebglFilterBackend({tileSize:n.textureSize});if(n.Canvas2dFilterBackend)return new n.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=n),function(){function m(x,k){if(!!this.__eventListeners[x]){var P=this.__eventListeners[x];k?P[P.indexOf(k)]=!1:n.util.array.fill(P,!1)}}function v(x,k){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var P in x)this.on(P,x[P]);else this.__eventListeners[x]||(this.__eventListeners[x]=[]),this.__eventListeners[x].push(k);return this}function g(x,k){var P=function(){k.apply(this,arguments),this.off(x,P)}.bind(this);this.on(x,P)}function d(x,k){if(arguments.length===1)for(var P in x)g.call(this,P,x[P]);else g.call(this,x,k);return this}function f(x,k){if(!this.__eventListeners)return this;if(arguments.length===0)for(x in this.__eventListeners)m.call(this,x);else if(arguments.length===1&&typeof arguments[0]=="object")for(var P in x)m.call(this,P,x[P]);else m.call(this,x,k);return this}function y(x,k){if(!this.__eventListeners)return this;var P=this.__eventListeners[x];if(!P)return this;for(var S=0,E=P.length;S<E;S++)P[S]&&P[S].call(this,k||{});return this.__eventListeners[x]=P.filter(function(M){return M!==!1}),this}n.Observable={fire:y,on:v,once:d,off:f}}(),n.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var m=0,v=arguments.length;m<v;m++)this._onObjectAdded(arguments[m]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(m,v,g){var d=this._objects;return g?d[v]=m:d.splice(v,0,m),this._onObjectAdded&&this._onObjectAdded(m),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var m=this._objects,v,g=!1,d=0,f=arguments.length;d<f;d++)v=m.indexOf(arguments[d]),v!==-1&&(g=!0,m.splice(v,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&g&&this.requestRenderAll(),this},forEachObject:function(m,v){for(var g=this.getObjects(),d=0,f=g.length;d<f;d++)m.call(v,g[d],d,g);return this},getObjects:function(m){return typeof m>"u"?this._objects.concat():this._objects.filter(function(v){return v.type===m})},item:function(m){return this._objects[m]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(m,v){return this._objects.indexOf(m)>-1?!0:v?this._objects.some(function(g){return typeof g.contains=="function"&&g.contains(m,!0)}):!1},complexity:function(){return this._objects.reduce(function(m,v){return m+=v.complexity?v.complexity():0,m},0)}},n.CommonMethods={_setOptions:function(m){for(var v in m)this.set(v,m[v])},_initGradient:function(m,v){m&&m.colorStops&&!(m instanceof n.Gradient)&&this.set(v,new n.Gradient(m))},_initPattern:function(m,v,g){m&&m.source&&!(m instanceof n.Pattern)?this.set(v,new n.Pattern(m,g)):g&&g()},_setObject:function(m){for(var v in m)this._set(v,m[v])},set:function(m,v){return typeof m=="object"?this._setObject(m):this._set(m,v),this},_set:function(m,v){this[m]=v},toggle:function(m){var v=this.get(m);return typeof v=="boolean"&&this.set(m,!v),this},get:function(m){return this[m]}},function(m){var v=Math.sqrt,g=Math.atan2,d=Math.pow,f=Math.PI/180,y=Math.PI/2;n.util={cos:function(x){if(x===0)return 1;x<0&&(x=-x);var k=x/y;switch(k){case 1:case 3:return 0;case 2:return-1}return Math.cos(x)},sin:function(x){if(x===0)return 0;var k=x/y,P=1;switch(x<0&&(P=-1),k){case 1:return P;case 2:return 0;case 3:return-P}return Math.sin(x)},removeFromArray:function(x,k){var P=x.indexOf(k);return P!==-1&&x.splice(P,1),x},getRandomInt:function(x,k){return Math.floor(Math.random()*(k-x+1))+x},degreesToRadians:function(x){return x*f},radiansToDegrees:function(x){return x/f},rotatePoint:function(x,k,P){var S=new n.Point(x.x-k.x,x.y-k.y),E=n.util.rotateVector(S,P);return new n.Point(E.x,E.y).addEquals(k)},rotateVector:function(x,k){var P=n.util.sin(k),S=n.util.cos(k),E=x.x*S-x.y*P,M=x.x*P+x.y*S;return{x:E,y:M}},createVector:function(x,k){return new n.Point(k.x-x.x,k.y-x.y)},calcAngleBetweenVectors:function(x,k){return Math.acos((x.x*k.x+x.y*k.y)/(Math.hypot(x.x,x.y)*Math.hypot(k.x,k.y)))},getHatVector:function(x){return new n.Point(x.x,x.y).multiply(1/Math.hypot(x.x,x.y))},getBisector:function(x,k,P){var S=n.util.createVector(x,k),E=n.util.createVector(x,P),M=n.util.calcAngleBetweenVectors(S,E),T=n.util.calcAngleBetweenVectors(n.util.rotateVector(S,M),E),D=M*(T===0?1:-1)/2;return{vector:n.util.getHatVector(n.util.rotateVector(S,D)),angle:M}},projectStrokeOnPoints:function(x,k,P){var S=[],E=k.strokeWidth/2,M=k.strokeUniform?new n.Point(1/k.scaleX,1/k.scaleY):new n.Point(1,1),T=function(D){var N=E/Math.hypot(D.x,D.y);return new n.Point(D.x*N*M.x,D.y*N*M.y)};return x.length<=1||x.forEach(function(D,N){var I=new n.Point(D.x,D.y),O,F;N===0?(F=x[N+1],O=P?T(n.util.createVector(F,I)).addEquals(I):x[x.length-1]):N===x.length-1?(O=x[N-1],F=P?T(n.util.createVector(O,I)).addEquals(I):x[0]):(O=x[N-1],F=x[N+1]);var q=n.util.getBisector(I,O,F),Y=q.vector,_e=q.angle,ne,ve;if(k.strokeLineJoin==="miter"&&(ne=-E/Math.sin(_e/2),ve=new n.Point(Y.x*ne*M.x,Y.y*ne*M.y),Math.hypot(ve.x,ve.y)/E<=k.strokeMiterLimit)){S.push(I.add(ve)),S.push(I.subtract(ve));return}ne=-E*Math.SQRT2,ve=new n.Point(Y.x*ne*M.x,Y.y*ne*M.y),S.push(I.add(ve)),S.push(I.subtract(ve))}),S},transformPoint:function(x,k,P){return P?new n.Point(k[0]*x.x+k[2]*x.y,k[1]*x.x+k[3]*x.y):new n.Point(k[0]*x.x+k[2]*x.y+k[4],k[1]*x.x+k[3]*x.y+k[5])},makeBoundingBoxFromPoints:function(x,k){if(k)for(var P=0;P<x.length;P++)x[P]=n.util.transformPoint(x[P],k);var S=[x[0].x,x[1].x,x[2].x,x[3].x],E=n.util.array.min(S),M=n.util.array.max(S),T=M-E,D=[x[0].y,x[1].y,x[2].y,x[3].y],N=n.util.array.min(D),I=n.util.array.max(D),O=I-N;return{left:E,top:N,width:T,height:O}},invertTransform:function(x){var k=1/(x[0]*x[3]-x[1]*x[2]),P=[k*x[3],-k*x[1],-k*x[2],k*x[0]],S=n.util.transformPoint({x:x[4],y:x[5]},P,!0);return P[4]=-S.x,P[5]=-S.y,P},toFixed:function(x,k){return parseFloat(Number(x).toFixed(k))},parseUnit:function(x,k){var P=/\D{0,2}$/.exec(x),S=parseFloat(x);switch(k||(k=n.Text.DEFAULT_SVG_FONT_SIZE),P[0]){case"mm":return S*n.DPI/25.4;case"cm":return S*n.DPI/2.54;case"in":return S*n.DPI;case"pt":return S*n.DPI/72;case"pc":return S*n.DPI/72*12;case"em":return S*k;default:return S}},falseFunction:function(){return!1},getKlass:function(x,k){return x=n.util.string.camelize(x.charAt(0).toUpperCase()+x.slice(1)),n.util.resolveNamespace(k)[x]},getSvgAttributes:function(x){var k=["instantiated_by_use","style","id","class"];switch(x){case"linearGradient":k=k.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":k=k.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":k=k.concat(["offset","stop-color","stop-opacity"]);break}return k},resolveNamespace:function(x){if(!x)return n;var k=x.split("."),P=k.length,S,E=m||n.window;for(S=0;S<P;++S)E=E[k[S]];return E},loadImage:function(x,k,P,S){if(!x){k&&k.call(P,x);return}var E=n.util.createImage(),M=function(){k&&k.call(P,E,!1),E=E.onload=E.onerror=null};E.onload=M,E.onerror=function(){n.log("Error loading "+E.src),k&&k.call(P,null,!0),E=E.onload=E.onerror=null},x.indexOf("data")!==0&&S!==void 0&&S!==null&&(E.crossOrigin=S),x.substring(0,14)==="data:image/svg"&&(E.onload=null,n.util.loadImageInDom(E,M)),E.src=x},loadImageInDom:function(x,k){var P=n.document.createElement("div");P.style.width=P.style.height="1px",P.style.left=P.style.top="-100%",P.style.position="absolute",P.appendChild(x),n.document.querySelector("body").appendChild(P),x.onload=function(){k(),P.parentNode.removeChild(P),P=null}},enlivenObjects:function(x,k,P,S){x=x||[];var E=[],M=0,T=x.length;function D(){++M===T&&k&&k(E.filter(function(N){return N}))}if(!T){k&&k(E);return}x.forEach(function(N,I){if(!N||!N.type){D();return}var O=n.util.getKlass(N.type,P);O.fromObject(N,function(F,q){q||(E[I]=F),S&&S(N,F,q),D()})})},enlivenObjectEnlivables:function(x,k,P){var S=n.Object.ENLIVEN_PROPS.filter(function(E){return!!x[E]});n.util.enlivenObjects(S.map(function(E){return x[E]}),function(E){var M={};S.forEach(function(T,D){M[T]=E[D],k&&(k[T]=E[D])}),P&&P(M)})},enlivenPatterns:function(x,k){x=x||[];function P(){++E===M&&k&&k(S)}var S=[],E=0,M=x.length;if(!M){k&&k(S);return}x.forEach(function(T,D){T&&T.source?new n.Pattern(T,function(N){S[D]=N,P()}):(S[D]=T,P())})},groupSVGElements:function(x,k,P){var S;return x&&x.length===1?(typeof P<"u"&&(x[0].sourcePath=P),x[0]):(k&&(k.width&&k.height?k.centerPoint={x:k.width/2,y:k.height/2}:(delete k.width,delete k.height)),S=new n.Group(x,k),typeof P<"u"&&(S.sourcePath=P),S)},populateWithProperties:function(x,k,P){if(P&&Array.isArray(P))for(var S=0,E=P.length;S<E;S++)P[S]in x&&(k[P[S]]=x[P[S]])},createCanvasElement:function(){return n.document.createElement("canvas")},copyCanvasElement:function(x){var k=n.util.createCanvasElement();return k.width=x.width,k.height=x.height,k.getContext("2d").drawImage(x,0,0),k},toDataURL:function(x,k,P){return x.toDataURL("image/"+k,P)},createImage:function(){return n.document.createElement("img")},multiplyTransformMatrices:function(x,k,P){return[x[0]*k[0]+x[2]*k[1],x[1]*k[0]+x[3]*k[1],x[0]*k[2]+x[2]*k[3],x[1]*k[2]+x[3]*k[3],P?0:x[0]*k[4]+x[2]*k[5]+x[4],P?0:x[1]*k[4]+x[3]*k[5]+x[5]]},qrDecompose:function(x){var k=g(x[1],x[0]),P=d(x[0],2)+d(x[1],2),S=v(P),E=(x[0]*x[3]-x[2]*x[1])/S,M=g(x[0]*x[2]+x[1]*x[3],P);return{angle:k/f,scaleX:S,scaleY:E,skewX:M/f,skewY:0,translateX:x[4],translateY:x[5]}},calcRotateMatrix:function(x){if(!x.angle)return n.iMatrix.concat();var k=n.util.degreesToRadians(x.angle),P=n.util.cos(k),S=n.util.sin(k);return[P,S,-S,P,0,0]},calcDimensionsMatrix:function(x){var k=typeof x.scaleX>"u"?1:x.scaleX,P=typeof x.scaleY>"u"?1:x.scaleY,S=[x.flipX?-k:k,0,0,x.flipY?-P:P,0,0],E=n.util.multiplyTransformMatrices,M=n.util.degreesToRadians;return x.skewX&&(S=E(S,[1,0,Math.tan(M(x.skewX)),1],!0)),x.skewY&&(S=E(S,[1,Math.tan(M(x.skewY)),0,1],!0)),S},composeMatrix:function(x){var k=[1,0,0,1,x.translateX||0,x.translateY||0],P=n.util.multiplyTransformMatrices;return x.angle&&(k=P(k,n.util.calcRotateMatrix(x))),(x.scaleX!==1||x.scaleY!==1||x.skewX||x.skewY||x.flipX||x.flipY)&&(k=P(k,n.util.calcDimensionsMatrix(x))),k},resetObjectTransform:function(x){x.scaleX=1,x.scaleY=1,x.skewX=0,x.skewY=0,x.flipX=!1,x.flipY=!1,x.rotate(0)},saveObjectTransform:function(x){return{scaleX:x.scaleX,scaleY:x.scaleY,skewX:x.skewX,skewY:x.skewY,angle:x.angle,left:x.left,flipX:x.flipX,flipY:x.flipY,top:x.top}},isTransparent:function(x,k,P,S){S>0&&(k>S?k-=S:k=0,P>S?P-=S:P=0);var E=!0,M,T,D=x.getImageData(k,P,S*2||1,S*2||1),N=D.data.length;for(M=3;M<N&&(T=D.data[M],E=T<=0,E!==!1);M+=4);return D=null,E},parsePreserveAspectRatioAttribute:function(x){var k="meet",P="Mid",S="Mid",E=x.split(" "),M;return E&&E.length&&(k=E.pop(),k!=="meet"&&k!=="slice"?(M=k,k="meet"):E.length&&(M=E.pop())),P=M!=="none"?M.slice(1,4):"none",S=M!=="none"?M.slice(5,8):"none",{meetOrSlice:k,alignX:P,alignY:S}},clearFabricFontCache:function(x){x=(x||"").toLowerCase(),x?n.charWidthsCache[x]&&delete n.charWidthsCache[x]:n.charWidthsCache={}},limitDimsByArea:function(x,k){var P=Math.sqrt(k*x),S=Math.floor(k/P);return{x:Math.floor(P),y:S}},capValue:function(x,k,P){return Math.max(x,Math.min(k,P))},findScaleToFit:function(x,k){return Math.min(k.width/x.width,k.height/x.height)},findScaleToCover:function(x,k){return Math.max(k.width/x.width,k.height/x.height)},matrixToSVG:function(x){return"matrix("+x.map(function(k){return n.util.toFixed(k,n.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(x,k){var P=n.util.invertTransform(k),S=n.util.multiplyTransformMatrices(P,x.calcOwnMatrix());n.util.applyTransformToObject(x,S)},addTransformToObject:function(x,k){n.util.applyTransformToObject(x,n.util.multiplyTransformMatrices(k,x.calcOwnMatrix()))},applyTransformToObject:function(x,k){var P=n.util.qrDecompose(k),S=new n.Point(P.translateX,P.translateY);x.flipX=!1,x.flipY=!1,x.set("scaleX",P.scaleX),x.set("scaleY",P.scaleY),x.skewX=P.skewX,x.skewY=P.skewY,x.angle=P.angle,x.setPositionByOrigin(S,"center","center")},sizeAfterTransform:function(x,k,P){var S=x/2,E=k/2,M=[{x:-S,y:-E},{x:S,y:-E},{x:-S,y:E},{x:S,y:E}],T=n.util.calcDimensionsMatrix(P),D=n.util.makeBoundingBoxFromPoints(M,T);return{x:D.width,y:D.height}},mergeClipPaths:function(x,k){var P=x,S=k;P.inverted&&!S.inverted&&(P=k,S=x),n.util.applyTransformToObject(S,n.util.multiplyTransformMatrices(n.util.invertTransform(P.calcTransformMatrix()),S.calcTransformMatrix()));var E=P.inverted&&S.inverted;return E&&(P.inverted=S.inverted=!1),new n.Group([P],{clipPath:S,inverted:E})},hasStyleChanged:function(x,k,P){return P=P||!1,x.fill!==k.fill||x.stroke!==k.stroke||x.strokeWidth!==k.strokeWidth||x.fontSize!==k.fontSize||x.fontFamily!==k.fontFamily||x.fontWeight!==k.fontWeight||x.fontStyle!==k.fontStyle||x.textBackgroundColor!==k.textBackgroundColor||x.deltaY!==k.deltaY||P&&(x.overline!==k.overline||x.underline!==k.underline||x.linethrough!==k.linethrough)},stylesToArray:function(P,k){for(var P=n.util.object.clone(P,!0),S=k.split(`
`),E=-1,M={},T=[],D=0;D<S.length;D++){if(!P[D]){E+=S[D].length;continue}for(var N=0;N<S[D].length;N++){E++;var I=P[D][N];if(I&&Object.keys(I).length>0){var O=n.util.hasStyleChanged(M,I,!0);O?T.push({start:E,end:E+1,style:I}):T[T.length-1].end++}M=I||{}}}return T},stylesFromArray:function(x,k){if(!Array.isArray(x))return x;for(var P=k.split(`
`),S=-1,E=0,M={},T=0;T<P.length;T++)for(var D=0;D<P[T].length;D++)S++,x[E]&&x[E].start<=S&&S<x[E].end&&(M[T]=M[T]||{},M[T][D]=Object.assign({},x[E].style),S===x[E].end-1&&E++);return M}}}(e),function(){var m=Array.prototype.join,v={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},g={m:"l",M:"L"};function d(H,U,te,Q,re,Pe,be,we,Ae,$e,Me){var Ie=n.util.cos(H),Le=n.util.sin(H),le=n.util.cos(U),oe=n.util.sin(U),ke=te*re*le-Q*Pe*oe+be,Ce=Q*re*le+te*Pe*oe+we,Ee=$e+Ae*(-te*re*Le-Q*Pe*Ie),Be=Me+Ae*(-Q*re*Le+te*Pe*Ie),Ve=ke+Ae*(te*re*oe+Q*Pe*le),Oe=Ce+Ae*(Q*re*oe-te*Pe*le);return["C",Ee,Be,Ve,Oe,ke,Ce]}function f(H,U,te,Q,re,Pe,be){var we=Math.PI,Ae=be*we/180,$e=n.util.sin(Ae),Me=n.util.cos(Ae),Ie=0,Le=0;te=Math.abs(te),Q=Math.abs(Q);var le=-Me*H*.5-$e*U*.5,oe=-Me*U*.5+$e*H*.5,ke=te*te,Ce=Q*Q,Ee=oe*oe,Be=le*le,Ve=ke*Ce-ke*Ee-Ce*Be,Oe=0;if(Ve<0){var je=Math.sqrt(1-Ve/(ke*Ce));te*=je,Q*=je}else Oe=(re===Pe?-1:1)*Math.sqrt(Ve/(ke*Ee+Ce*Be));var Ge=Oe*te*oe/Q,Xe=-Oe*Q*le/te,qe=Me*Ge-$e*Xe+H*.5,Ke=$e*Ge+Me*Xe+U*.5,Je=y(1,0,(le-Ge)/te,(oe-Xe)/Q),rt=y((le-Ge)/te,(oe-Xe)/Q,(-le-Ge)/te,(-oe-Xe)/Q);Pe===0&&rt>0?rt-=2*we:Pe===1&&rt<0&&(rt+=2*we);for(var ht=Math.ceil(Math.abs(rt/we*2)),vt=[],Ct=rt/ht,kt=8/3*Math.sin(Ct/4)*Math.sin(Ct/4)/Math.sin(Ct/2),mt=Je+Ct,Vt=0;Vt<ht;Vt++)vt[Vt]=d(Je,mt,Me,$e,te,Q,qe,Ke,kt,Ie,Le),Ie=vt[Vt][5],Le=vt[Vt][6],Je=mt,mt+=Ct;return vt}function y(H,U,te,Q){var re=Math.atan2(U,H),Pe=Math.atan2(Q,te);return Pe>=re?Pe-re:2*Math.PI-(re-Pe)}function x(H,U,te,Q,re,Pe,be,we){var Ae;if(n.cachesBoundsOfCurve&&(Ae=m.call(arguments),n.boundsOfCurveCache[Ae]))return n.boundsOfCurveCache[Ae];var $e=Math.sqrt,Me=Math.min,Ie=Math.max,Le=Math.abs,le=[],oe=[[],[]],ke,Ce,Ee,Be,Ve,Oe,je,Ge;Ce=6*H-12*te+6*re,ke=-3*H+9*te-9*re+3*be,Ee=3*te-3*H;for(var Xe=0;Xe<2;++Xe){if(Xe>0&&(Ce=6*U-12*Q+6*Pe,ke=-3*U+9*Q-9*Pe+3*we,Ee=3*Q-3*U),Le(ke)<1e-12){if(Le(Ce)<1e-12)continue;Be=-Ee/Ce,0<Be&&Be<1&&le.push(Be);continue}je=Ce*Ce-4*Ee*ke,!(je<0)&&(Ge=$e(je),Ve=(-Ce+Ge)/(2*ke),0<Ve&&Ve<1&&le.push(Ve),Oe=(-Ce-Ge)/(2*ke),0<Oe&&Oe<1&&le.push(Oe))}for(var qe,Ke,Je=le.length,rt=Je,ht;Je--;)Be=le[Je],ht=1-Be,qe=ht*ht*ht*H+3*ht*ht*Be*te+3*ht*Be*Be*re+Be*Be*Be*be,oe[0][Je]=qe,Ke=ht*ht*ht*U+3*ht*ht*Be*Q+3*ht*Be*Be*Pe+Be*Be*Be*we,oe[1][Je]=Ke;oe[0][rt]=H,oe[1][rt]=U,oe[0][rt+1]=be,oe[1][rt+1]=we;var vt=[{x:Me.apply(null,oe[0]),y:Me.apply(null,oe[1])},{x:Ie.apply(null,oe[0]),y:Ie.apply(null,oe[1])}];return n.cachesBoundsOfCurve&&(n.boundsOfCurveCache[Ae]=vt),vt}function k(H,U,te){for(var Q=te[1],re=te[2],Pe=te[3],be=te[4],we=te[5],Ae=te[6],$e=te[7],Me=f(Ae-H,$e-U,Q,re,be,we,Pe),Ie=0,Le=Me.length;Ie<Le;Ie++)Me[Ie][1]+=H,Me[Ie][2]+=U,Me[Ie][3]+=H,Me[Ie][4]+=U,Me[Ie][5]+=H,Me[Ie][6]+=U;return Me}function P(H){var U=0,te=0,Q=H.length,re=0,Pe=0,be,we,Ae,$e=[],Me,Ie,Le;for(we=0;we<Q;++we){switch(Ae=!1,be=H[we].slice(0),be[0]){case"l":be[0]="L",be[1]+=U,be[2]+=te;case"L":U=be[1],te=be[2];break;case"h":be[1]+=U;case"H":be[0]="L",be[2]=te,U=be[1];break;case"v":be[1]+=te;case"V":be[0]="L",te=be[1],be[1]=U,be[2]=te;break;case"m":be[0]="M",be[1]+=U,be[2]+=te;case"M":U=be[1],te=be[2],re=be[1],Pe=be[2];break;case"c":be[0]="C",be[1]+=U,be[2]+=te,be[3]+=U,be[4]+=te,be[5]+=U,be[6]+=te;case"C":Ie=be[3],Le=be[4],U=be[5],te=be[6];break;case"s":be[0]="S",be[1]+=U,be[2]+=te,be[3]+=U,be[4]+=te;case"S":Me==="C"?(Ie=2*U-Ie,Le=2*te-Le):(Ie=U,Le=te),U=be[3],te=be[4],be[0]="C",be[5]=be[3],be[6]=be[4],be[3]=be[1],be[4]=be[2],be[1]=Ie,be[2]=Le,Ie=be[3],Le=be[4];break;case"q":be[0]="Q",be[1]+=U,be[2]+=te,be[3]+=U,be[4]+=te;case"Q":Ie=be[1],Le=be[2],U=be[3],te=be[4];break;case"t":be[0]="T",be[1]+=U,be[2]+=te;case"T":Me==="Q"?(Ie=2*U-Ie,Le=2*te-Le):(Ie=U,Le=te),be[0]="Q",U=be[1],te=be[2],be[1]=Ie,be[2]=Le,be[3]=U,be[4]=te;break;case"a":be[0]="A",be[6]+=U,be[7]+=te;case"A":Ae=!0,$e=$e.concat(k(U,te,be)),U=be[6],te=be[7];break;case"z":case"Z":U=re,te=Pe;break}Ae||$e.push(be),Me=be[0]}return $e}function S(H,U,te,Q){return Math.sqrt((te-H)*(te-H)+(Q-U)*(Q-U))}function E(H){return H*H*H}function M(H){return 3*H*H*(1-H)}function T(H){return 3*H*(1-H)*(1-H)}function D(H){return(1-H)*(1-H)*(1-H)}function N(H,U,te,Q,re,Pe,be,we){return function(Ae){var $e=E(Ae),Me=M(Ae),Ie=T(Ae),Le=D(Ae);return{x:be*$e+re*Me+te*Ie+H*Le,y:we*$e+Pe*Me+Q*Ie+U*Le}}}function I(H,U,te,Q,re,Pe,be,we){return function(Ae){var $e=1-Ae,Me=3*$e*$e*(te-H)+6*$e*Ae*(re-te)+3*Ae*Ae*(be-re),Ie=3*$e*$e*(Q-U)+6*$e*Ae*(Pe-Q)+3*Ae*Ae*(we-Pe);return Math.atan2(Ie,Me)}}function O(H){return H*H}function F(H){return 2*H*(1-H)}function q(H){return(1-H)*(1-H)}function Y(H,U,te,Q,re,Pe){return function(be){var we=O(be),Ae=F(be),$e=q(be);return{x:re*we+te*Ae+H*$e,y:Pe*we+Q*Ae+U*$e}}}function _e(H,U,te,Q,re,Pe){return function(be){var we=1-be,Ae=2*we*(te-H)+2*be*(re-te),$e=2*we*(Q-U)+2*be*(Pe-Q);return Math.atan2($e,Ae)}}function ne(H,U,te){var Q={x:U,y:te},re,Pe=0,be;for(be=1;be<=100;be+=1)re=H(be/100),Pe+=S(Q.x,Q.y,re.x,re.y),Q=re;return Pe}function ve(H,U){for(var te=0,Q=0,re=H.iterator,Pe={x:H.x,y:H.y},be,we,Ae=.01,$e=H.angleFinder,Me;Q<U&&Ae>1e-4;)be=re(te),Me=te,we=S(Pe.x,Pe.y,be.x,be.y),we+Q>U?(te-=Ae,Ae/=2):(Pe=be,te+=Ae,Q+=we);return be.angle=$e(Me),be}function J(H){for(var U=0,te=H.length,Q,re=0,Pe=0,be=0,we=0,Ae=[],$e,Me,Ie,Le=0;Le<te;Le++){switch(Q=H[Le],Me={x:re,y:Pe,command:Q[0]},Q[0]){case"M":Me.length=0,be=re=Q[1],we=Pe=Q[2];break;case"L":Me.length=S(re,Pe,Q[1],Q[2]),re=Q[1],Pe=Q[2];break;case"C":$e=N(re,Pe,Q[1],Q[2],Q[3],Q[4],Q[5],Q[6]),Ie=I(re,Pe,Q[1],Q[2],Q[3],Q[4],Q[5],Q[6]),Me.iterator=$e,Me.angleFinder=Ie,Me.length=ne($e,re,Pe),re=Q[5],Pe=Q[6];break;case"Q":$e=Y(re,Pe,Q[1],Q[2],Q[3],Q[4]),Ie=_e(re,Pe,Q[1],Q[2],Q[3],Q[4]),Me.iterator=$e,Me.angleFinder=Ie,Me.length=ne($e,re,Pe),re=Q[3],Pe=Q[4];break;case"Z":case"z":Me.destX=be,Me.destY=we,Me.length=S(re,Pe,be,we),re=be,Pe=we;break}U+=Me.length,Ae.push(Me)}return Ae.push({length:U,x:re,y:Pe}),Ae}function fe(H,U,te){te||(te=J(H));for(var Q=0;U-te[Q].length>0&&Q<te.length-2;)U-=te[Q].length,Q++;var re=te[Q],Pe=U/re.length,be=re.command,we=H[Q],Ae;switch(be){case"M":return{x:re.x,y:re.y,angle:0};case"Z":case"z":return Ae=new n.Point(re.x,re.y).lerp(new n.Point(re.destX,re.destY),Pe),Ae.angle=Math.atan2(re.destY-re.y,re.destX-re.x),Ae;case"L":return Ae=new n.Point(re.x,re.y).lerp(new n.Point(we[1],we[2]),Pe),Ae.angle=Math.atan2(we[2]-re.y,we[1]-re.x),Ae;case"C":return ve(re,U);case"Q":return ve(re,U)}}function Z(H){var U=[],te=[],Q,re,Pe=n.rePathCommand,be="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",we="("+be+")"+n.commaWsp,Ae="([01])"+n.commaWsp+"?",$e=we+"?"+we+"?"+we+Ae+Ae+we+"?("+be+")",Me=new RegExp($e,"g"),Ie,Le,le;if(!H||!H.match)return U;le=H.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var oe=0,ke,Ce=le.length;oe<Ce;oe++){Q=le[oe],Le=Q.slice(1).trim(),te.length=0;var Ee=Q.charAt(0);if(ke=[Ee],Ee.toLowerCase()==="a")for(var Be;Be=Me.exec(Le);)for(var Ve=1;Ve<Be.length;Ve++)te.push(Be[Ve]);else for(;Ie=Pe.exec(Le);)te.push(Ie[0]);for(var Ve=0,Oe=te.length;Ve<Oe;Ve++)re=parseFloat(te[Ve]),isNaN(re)||ke.push(re);var je=v[Ee.toLowerCase()],Ge=g[Ee]||Ee;if(ke.length-1>je)for(var Xe=1,qe=ke.length;Xe<qe;Xe+=je)U.push([Ee].concat(ke.slice(Xe,Xe+je))),Ee=Ge;else U.push(ke)}return U}function j(H,U){var te=[],Q,re=new n.Point(H[0].x,H[0].y),Pe=new n.Point(H[1].x,H[1].y),be=H.length,we=1,Ae=0,$e=be>2;for(U=U||0,$e&&(we=H[2].x<Pe.x?-1:H[2].x===Pe.x?0:1,Ae=H[2].y<Pe.y?-1:H[2].y===Pe.y?0:1),te.push(["M",re.x-we*U,re.y-Ae*U]),Q=1;Q<be;Q++){if(!re.eq(Pe)){var Me=re.midPointFrom(Pe);te.push(["Q",re.x,re.y,Me.x,Me.y])}re=H[Q],Q+1<H.length&&(Pe=H[Q+1])}return $e&&(we=re.x>H[Q-2].x?1:re.x===H[Q-2].x?0:-1,Ae=re.y>H[Q-2].y?1:re.y===H[Q-2].y?0:-1),te.push(["L",re.x+we*U,re.y+Ae*U]),te}function X(H,U,te){return te&&(U=n.util.multiplyTransformMatrices(U,[1,0,0,1,-te.x,-te.y])),H.map(function(Q){for(var re=Q.slice(0),Pe={},be=1;be<Q.length-1;be+=2)Pe.x=Q[be],Pe.y=Q[be+1],Pe=n.util.transformPoint(Pe,U),re[be]=Pe.x,re[be+1]=Pe.y;return re})}n.util.joinPath=function(H){return H.map(function(U){return U.join(" ")}).join(" ")},n.util.parsePath=Z,n.util.makePathSimpler=P,n.util.getSmoothPathFromPoints=j,n.util.getPathSegmentsInfo=J,n.util.getBoundsOfCurve=x,n.util.getPointOnPath=fe,n.util.transformPath=X}(),function(){var m=Array.prototype.slice;function v(x,k){for(var P=m.call(arguments,2),S=[],E=0,M=x.length;E<M;E++)S[E]=P.length?x[E][k].apply(x[E],P):x[E][k].call(x[E]);return S}function g(x,k){return y(x,k,function(P,S){return P>=S})}function d(x,k){return y(x,k,function(P,S){return P<S})}function f(x,k){for(var P=x.length;P--;)x[P]=k;return x}function y(x,k,P){if(!(!x||x.length===0)){var S=x.length-1,E=k?x[S][k]:x[S];if(k)for(;S--;)P(x[S][k],E)&&(E=x[S][k]);else for(;S--;)P(x[S],E)&&(E=x[S]);return E}}n.util.array={fill:f,invoke:v,min:d,max:g}}(),function(){function m(g,d,f){if(f)if(!n.isLikelyNode&&d instanceof Element)g=d;else if(d instanceof Array){g=[];for(var y=0,x=d.length;y<x;y++)g[y]=m({},d[y],f)}else if(d&&typeof d=="object")for(var k in d)k==="canvas"||k==="group"?g[k]=null:d.hasOwnProperty(k)&&(g[k]=m({},d[k],f));else g=d;else for(var k in d)g[k]=d[k];return g}function v(g,d){return m({},g,d)}n.util.object={extend:m,clone:v},n.util.object.extend(n.util,n.Observable)}(),function(){function m(y){return y.replace(/-+(.)?/g,function(x,k){return k?k.toUpperCase():""})}function v(y,x){return y.charAt(0).toUpperCase()+(x?y.slice(1):y.slice(1).toLowerCase())}function g(y){return y.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(y){var x=0,k,P=[];for(x=0,k;x<y.length;x++)(k=f(y,x))!==!1&&P.push(k);return P}function f(y,x){var k=y.charCodeAt(x);if(isNaN(k))return"";if(k<55296||k>57343)return y.charAt(x);if(55296<=k&&k<=56319){if(y.length<=x+1)throw"High surrogate without following low surrogate";var P=y.charCodeAt(x+1);if(56320>P||P>57343)throw"High surrogate without following low surrogate";return y.charAt(x)+y.charAt(x+1)}if(x===0)throw"Low surrogate without preceding high surrogate";var S=y.charCodeAt(x-1);if(55296>S||S>56319)throw"Low surrogate without preceding high surrogate";return!1}n.util.string={camelize:m,capitalize:v,escapeXml:g,graphemeSplit:d}}(),function(){var m=Array.prototype.slice,v=function(){},g=function(){for(var k in{toString:1})if(k==="toString")return!1;return!0}(),d=function(k,P,S){for(var E in P)E in k.prototype&&typeof k.prototype[E]=="function"&&(P[E]+"").indexOf("callSuper")>-1?k.prototype[E]=function(M){return function(){var T=this.constructor.superclass;this.constructor.superclass=S;var D=P[M].apply(this,arguments);if(this.constructor.superclass=T,M!=="initialize")return D}}(E):k.prototype[E]=P[E],g&&(P.toString!==Object.prototype.toString&&(k.prototype.toString=P.toString),P.valueOf!==Object.prototype.valueOf&&(k.prototype.valueOf=P.valueOf))};function f(){}function y(k){for(var P=null,S=this;S.constructor.superclass;){var E=S.constructor.superclass.prototype[k];if(S[k]!==E){P=E;break}S=S.constructor.superclass.prototype}return P?arguments.length>1?P.apply(this,m.call(arguments,1)):P.call(this):console.log("tried to callSuper "+k+", method not found in prototype chain",this)}function x(){var k=null,P=m.call(arguments,0);typeof P[0]=="function"&&(k=P.shift());function S(){this.initialize.apply(this,arguments)}S.superclass=k,S.subclasses=[],k&&(f.prototype=k.prototype,S.prototype=new f,k.subclasses.push(S));for(var E=0,M=P.length;E<M;E++)d(S,P[E],k);return S.prototype.initialize||(S.prototype.initialize=v),S.prototype.constructor=S,S.prototype.callSuper=y,S}n.util.createClass=x}(),function(){var m=!!n.document.createElement("div").attachEvent,v=["touchstart","touchmove","touchend"];n.util.addListener=function(d,f,y,x){d&&d.addEventListener(f,y,m?!1:x)},n.util.removeListener=function(d,f,y,x){d&&d.removeEventListener(f,y,m?!1:x)};function g(d){var f=d.changedTouches;return f&&f[0]?f[0]:d}n.util.getPointer=function(d){var f=d.target,y=n.util.getScrollLeftTop(f),x=g(d);return{x:x.clientX+y.left,y:x.clientY+y.top}},n.util.isTouchEvent=function(d){return v.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function m(x,k){var P=x.style;if(!P)return x;if(typeof k=="string")return x.style.cssText+=";"+k,k.indexOf("opacity")>-1?y(x,k.match(/opacity:\s*(\d?\.?\d*)/)[1]):x;for(var S in k)if(S==="opacity")y(x,k[S]);else{var E=S==="float"||S==="cssFloat"?typeof P.styleFloat>"u"?"cssFloat":"styleFloat":S;P.setProperty(E,k[S])}return x}var v=n.document.createElement("div"),g=typeof v.style.opacity=="string",d=typeof v.style.filter=="string",f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,y=function(x){return x};g?y=function(x,k){return x.style.opacity=k,x}:d&&(y=function(x,k){var P=x.style;return x.currentStyle&&!x.currentStyle.hasLayout&&(P.zoom=1),f.test(P.filter)?(k=k>=.9999?"":"alpha(opacity="+k*100+")",P.filter=P.filter.replace(f,k)):P.filter+=" alpha(opacity="+k*100+")",x}),n.util.setStyle=m}(),function(){var m=Array.prototype.slice;function v(D){return typeof D=="string"?n.document.getElementById(D):D}var g,d=function(D){return m.call(D,0)};try{g=d(n.document.childNodes)instanceof Array}catch{}g||(d=function(D){for(var N=new Array(D.length),I=D.length;I--;)N[I]=D[I];return N});function f(D,N){var I=n.document.createElement(D);for(var O in N)O==="class"?I.className=N[O]:O==="for"?I.htmlFor=N[O]:I.setAttribute(O,N[O]);return I}function y(D,N){D&&(" "+D.className+" ").indexOf(" "+N+" ")===-1&&(D.className+=(D.className?" ":"")+N)}function x(D,N,I){return typeof N=="string"&&(N=f(N,I)),D.parentNode&&D.parentNode.replaceChild(N,D),N.appendChild(D),N}function k(D){for(var N=0,I=0,O=n.document.documentElement,F=n.document.body||{scrollLeft:0,scrollTop:0};D&&(D.parentNode||D.host)&&(D=D.parentNode||D.host,D===n.document?(N=F.scrollLeft||O.scrollLeft||0,I=F.scrollTop||O.scrollTop||0):(N+=D.scrollLeft||0,I+=D.scrollTop||0),!(D.nodeType===1&&D.style.position==="fixed")););return{left:N,top:I}}function P(D){var N,I=D&&D.ownerDocument,O={left:0,top:0},F={left:0,top:0},q,Y={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!I)return F;for(var _e in Y)F[Y[_e]]+=parseInt(S(D,_e),10)||0;return N=I.documentElement,typeof D.getBoundingClientRect<"u"&&(O=D.getBoundingClientRect()),q=k(D),{left:O.left+q.left-(N.clientLeft||0)+F.left,top:O.top+q.top-(N.clientTop||0)+F.top}}var S;n.document.defaultView&&n.document.defaultView.getComputedStyle?S=function(D,N){var I=n.document.defaultView.getComputedStyle(D,null);return I?I[N]:void 0}:S=function(D,N){var I=D.style[N];return!I&&D.currentStyle&&(I=D.currentStyle[N]),I},function(){var D=n.document.documentElement.style,N="userSelect"in D?"userSelect":"MozUserSelect"in D?"MozUserSelect":"WebkitUserSelect"in D?"WebkitUserSelect":"KhtmlUserSelect"in D?"KhtmlUserSelect":"";function I(F){return typeof F.onselectstart<"u"&&(F.onselectstart=n.util.falseFunction),N?F.style[N]="none":typeof F.unselectable=="string"&&(F.unselectable="on"),F}function O(F){return typeof F.onselectstart<"u"&&(F.onselectstart=null),N?F.style[N]="":typeof F.unselectable=="string"&&(F.unselectable=""),F}n.util.makeElementUnselectable=I,n.util.makeElementSelectable=O}();function E(D){var N=n.jsdomImplForWrapper(D);return N._canvas||N._image}function M(D){if(!!n.isLikelyNode){var N=n.jsdomImplForWrapper(D);N&&(N._image=null,N._canvas=null,N._currentSrc=null,N._attributes=null,N._classList=null)}}function T(D,N){D.imageSmoothingEnabled=D.imageSmoothingEnabled||D.webkitImageSmoothingEnabled||D.mozImageSmoothingEnabled||D.msImageSmoothingEnabled||D.oImageSmoothingEnabled,D.imageSmoothingEnabled=N}n.util.setImageSmoothing=T,n.util.getById=v,n.util.toArray=d,n.util.addClass=y,n.util.makeElement=f,n.util.wrapElement=x,n.util.getScrollLeftTop=k,n.util.getElementOffset=P,n.util.getNodeCanvas=E,n.util.cleanUpJsdomNode=M}(),function(){function m(d,f){return d+(/\?/.test(d)?"&":"?")+f}function v(){}function g(d,f){f||(f={});var y=f.method?f.method.toUpperCase():"GET",x=f.onComplete||function(){},k=new n.window.XMLHttpRequest,P=f.body||f.parameters;return k.onreadystatechange=function(){k.readyState===4&&(x(k),k.onreadystatechange=v)},y==="GET"&&(P=null,typeof f.parameters=="string"&&(d=m(d,f.parameters))),k.open(y,d,!0),(y==="POST"||y==="PUT")&&k.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),k.send(P),k}n.util.request=g}(),n.log=console.log,n.warn=console.warn,function(){var m=n.util.object.extend,v=n.util.object.clone,g=[];n.util.object.extend(g,{cancelAll:function(){var E=this.splice(0);return E.forEach(function(M){M.cancel()}),E},cancelByCanvas:function(E){if(!E)return[];var M=this.filter(function(T){return typeof T.target=="object"&&T.target.canvas===E});return M.forEach(function(T){T.cancel()}),M},cancelByTarget:function(E){var M=this.findAnimationsByTarget(E);return M.forEach(function(T){T.cancel()}),M},findAnimationIndex:function(E){return this.indexOf(this.findAnimation(E))},findAnimation:function(E){return this.find(function(M){return M.cancel===E})},findAnimationsByTarget:function(E){return E?this.filter(function(M){return M.target===E}):[]}});function d(){return!1}function f(E,M,T,D){return-T*Math.cos(E/D*(Math.PI/2))+T+M}function y(E){E||(E={});var M=!1,T,D=function(){var N=n.runningAnimations.indexOf(T);return N>-1&&n.runningAnimations.splice(N,1)[0]};return T=m(v(E),{cancel:function(){return M=!0,D()},currentValue:"startValue"in E?E.startValue:0,completionRate:0,durationRate:0}),n.runningAnimations.push(T),P(function(N){var I=N||+new Date,O=E.duration||500,F=I+O,q,Y=E.onChange||d,_e=E.abort||d,ne=E.onComplete||d,ve=E.easing||f,J="startValue"in E?E.startValue.length>0:!1,fe="startValue"in E?E.startValue:0,Z="endValue"in E?E.endValue:100,j=E.byValue||(J?fe.map(function(X,H){return Z[H]-fe[H]}):Z-fe);E.onStart&&E.onStart(),function X(H){q=H||+new Date;var U=q>F?O:q-I,te=U/O,Q=J?fe.map(function(Pe,be){return ve(U,fe[be],j[be],O)}):ve(U,fe,j,O),re=Math.abs(J?(Q[0]-fe[0])/j[0]:(Q-fe)/j);if(T.currentValue=J?Q.slice():Q,T.completionRate=re,T.durationRate=te,!M){if(_e(Q,re,te)){D();return}if(q>F){T.currentValue=J?Z.slice():Z,T.completionRate=1,T.durationRate=1,Y(J?Z.slice():Z,1,1),ne(Z,1,1),D();return}else Y(Q,re,te),P(X)}}(I)}),T.cancel}var x=n.window.requestAnimationFrame||n.window.webkitRequestAnimationFrame||n.window.mozRequestAnimationFrame||n.window.oRequestAnimationFrame||n.window.msRequestAnimationFrame||function(E){return n.window.setTimeout(E,1e3/60)},k=n.window.cancelAnimationFrame||n.window.clearTimeout;function P(){return x.apply(n.window,arguments)}function S(){return k.apply(n.window,arguments)}n.util.animate=y,n.util.requestAnimFrame=P,n.util.cancelAnimFrame=S,n.runningAnimations=g}(),function(){function m(g,d,f){var y="rgba("+parseInt(g[0]+f*(d[0]-g[0]),10)+","+parseInt(g[1]+f*(d[1]-g[1]),10)+","+parseInt(g[2]+f*(d[2]-g[2]),10);return y+=","+(g&&d?parseFloat(g[3]+f*(d[3]-g[3])):1),y+=")",y}function v(g,d,f,y){var x=new n.Color(g).getSource(),k=new n.Color(d).getSource(),P=y.onComplete,S=y.onChange;return y=y||{},n.util.animate(n.util.object.extend(y,{duration:f||500,startValue:x,endValue:k,byValue:k,easing:function(E,M,T,D){var N=y.colorEasing?y.colorEasing(E,D):1-Math.cos(E/D*(Math.PI/2));return m(M,T,N)},onComplete:function(E,M,T){if(P)return P(m(k,k,0),M,T)},onChange:function(E,M,T){if(S){if(Array.isArray(E))return S(m(E,E,0),M,T);S(E,M,T)}}}))}n.util.animateColor=v}(),function(){function m(H,U,te,Q){return H<Math.abs(U)?(H=U,Q=te/4):U===0&&H===0?Q=te/(2*Math.PI)*Math.asin(1):Q=te/(2*Math.PI)*Math.asin(U/H),{a:H,c:U,p:te,s:Q}}function v(H,U,te){return H.a*Math.pow(2,10*(U-=1))*Math.sin((U*te-H.s)*(2*Math.PI)/H.p)}function g(H,U,te,Q){return te*((H=H/Q-1)*H*H+1)+U}function d(H,U,te,Q){return H/=Q/2,H<1?te/2*H*H*H+U:te/2*((H-=2)*H*H+2)+U}function f(H,U,te,Q){return te*(H/=Q)*H*H*H+U}function y(H,U,te,Q){return-te*((H=H/Q-1)*H*H*H-1)+U}function x(H,U,te,Q){return H/=Q/2,H<1?te/2*H*H*H*H+U:-te/2*((H-=2)*H*H*H-2)+U}function k(H,U,te,Q){return te*(H/=Q)*H*H*H*H+U}function P(H,U,te,Q){return te*((H=H/Q-1)*H*H*H*H+1)+U}function S(H,U,te,Q){return H/=Q/2,H<1?te/2*H*H*H*H*H+U:te/2*((H-=2)*H*H*H*H+2)+U}function E(H,U,te,Q){return-te*Math.cos(H/Q*(Math.PI/2))+te+U}function M(H,U,te,Q){return te*Math.sin(H/Q*(Math.PI/2))+U}function T(H,U,te,Q){return-te/2*(Math.cos(Math.PI*H/Q)-1)+U}function D(H,U,te,Q){return H===0?U:te*Math.pow(2,10*(H/Q-1))+U}function N(H,U,te,Q){return H===Q?U+te:te*(-Math.pow(2,-10*H/Q)+1)+U}function I(H,U,te,Q){return H===0?U:H===Q?U+te:(H/=Q/2,H<1?te/2*Math.pow(2,10*(H-1))+U:te/2*(-Math.pow(2,-10*--H)+2)+U)}function O(H,U,te,Q){return-te*(Math.sqrt(1-(H/=Q)*H)-1)+U}function F(H,U,te,Q){return te*Math.sqrt(1-(H=H/Q-1)*H)+U}function q(H,U,te,Q){return H/=Q/2,H<1?-te/2*(Math.sqrt(1-H*H)-1)+U:te/2*(Math.sqrt(1-(H-=2)*H)+1)+U}function Y(H,U,te,Q){var re=1.70158,Pe=0,be=te;if(H===0)return U;if(H/=Q,H===1)return U+te;Pe||(Pe=Q*.3);var we=m(be,te,Pe,re);return-v(we,H,Q)+U}function _e(H,U,te,Q){var re=1.70158,Pe=0,be=te;if(H===0)return U;if(H/=Q,H===1)return U+te;Pe||(Pe=Q*.3);var we=m(be,te,Pe,re);return we.a*Math.pow(2,-10*H)*Math.sin((H*Q-we.s)*(2*Math.PI)/we.p)+we.c+U}function ne(H,U,te,Q){var re=1.70158,Pe=0,be=te;if(H===0)return U;if(H/=Q/2,H===2)return U+te;Pe||(Pe=Q*(.3*1.5));var we=m(be,te,Pe,re);return H<1?-.5*v(we,H,Q)+U:we.a*Math.pow(2,-10*(H-=1))*Math.sin((H*Q-we.s)*(2*Math.PI)/we.p)*.5+we.c+U}function ve(H,U,te,Q,re){return re===void 0&&(re=1.70158),te*(H/=Q)*H*((re+1)*H-re)+U}function J(H,U,te,Q,re){return re===void 0&&(re=1.70158),te*((H=H/Q-1)*H*((re+1)*H+re)+1)+U}function fe(H,U,te,Q,re){return re===void 0&&(re=1.70158),H/=Q/2,H<1?te/2*(H*H*(((re*=1.525)+1)*H-re))+U:te/2*((H-=2)*H*(((re*=1.525)+1)*H+re)+2)+U}function Z(H,U,te,Q){return te-j(Q-H,0,te,Q)+U}function j(H,U,te,Q){return(H/=Q)<1/2.75?te*(7.5625*H*H)+U:H<2/2.75?te*(7.5625*(H-=1.5/2.75)*H+.75)+U:H<2.5/2.75?te*(7.5625*(H-=2.25/2.75)*H+.9375)+U:te*(7.5625*(H-=2.625/2.75)*H+.984375)+U}function X(H,U,te,Q){return H<Q/2?Z(H*2,0,te,Q)*.5+U:j(H*2-Q,0,te,Q)*.5+te*.5+U}n.util.ease={easeInQuad:function(H,U,te,Q){return te*(H/=Q)*H+U},easeOutQuad:function(H,U,te,Q){return-te*(H/=Q)*(H-2)+U},easeInOutQuad:function(H,U,te,Q){return H/=Q/2,H<1?te/2*H*H+U:-te/2*(--H*(H-2)-1)+U},easeInCubic:function(H,U,te,Q){return te*(H/=Q)*H*H+U},easeOutCubic:g,easeInOutCubic:d,easeInQuart:f,easeOutQuart:y,easeInOutQuart:x,easeInQuint:k,easeOutQuint:P,easeInOutQuint:S,easeInSine:E,easeOutSine:M,easeInOutSine:T,easeInExpo:D,easeOutExpo:N,easeInOutExpo:I,easeInCirc:O,easeOutCirc:F,easeInOutCirc:q,easeInElastic:Y,easeOutElastic:_e,easeInOutElastic:ne,easeInBack:ve,easeOutBack:J,easeInOutBack:fe,easeInBounce:Z,easeOutBounce:j,easeInOutBounce:X}}(),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.util.object.clone,f=v.util.toFixed,y=v.util.parseUnit,x=v.util.multiplyTransformMatrices,k=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],P=["symbol","image","marker","pattern","view","svg"],S=["pattern","defs","symbol","metadata","clipPath","mask","desc"],E=["symbol","g","a","svg","clipPath","defs"],M={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},T={stroke:"strokeOpacity",fill:"fillOpacity"},D="font-size",N="clip-path";v.svgValidTagNamesRegEx=F(k),v.svgViewBoxElementsRegEx=F(P),v.svgInvalidAncestorsRegEx=F(S),v.svgValidParentsRegEx=F(E),v.cssRules={},v.gradientDefs={},v.clipPaths={};function I(Pe){return Pe in M?M[Pe]:Pe}function O(Pe,be,we,Ae){var $e=Array.isArray(be),Me;if((Pe==="fill"||Pe==="stroke")&&be==="none")be="";else{if(Pe==="strokeUniform")return be==="non-scaling-stroke";if(Pe==="strokeDashArray")be==="none"?be=null:be=be.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(Pe==="transformMatrix")we&&we.transformMatrix?be=x(we.transformMatrix,v.parseTransformAttribute(be)):be=v.parseTransformAttribute(be);else if(Pe==="visible")be=be!=="none"&&be!=="hidden",we&&we.visible===!1&&(be=!1);else if(Pe==="opacity")be=parseFloat(be),we&&typeof we.opacity<"u"&&(be*=we.opacity);else if(Pe==="textAnchor")be=be==="start"?"left":be==="end"?"right":"center";else if(Pe==="charSpacing")Me=y(be,Ae)/Ae*1e3;else if(Pe==="paintFirst"){var Ie=be.indexOf("fill"),Le=be.indexOf("stroke"),be="fill";(Ie>-1&&Le>-1&&Le<Ie||Ie===-1&&Le>-1)&&(be="stroke")}else{if(Pe==="href"||Pe==="xlink:href"||Pe==="font")return be;if(Pe==="imageSmoothing")return be==="optimizeQuality";Me=$e?be.map(y):y(be,Ae)}}return!$e&&isNaN(Me)?be:Me}function F(Pe){return new RegExp("^("+Pe.join("|")+")\\b","i")}function q(Pe){for(var be in T)if(!(typeof Pe[T[be]]>"u"||Pe[be]==="")){if(typeof Pe[be]>"u"){if(!v.Object.prototype[be])continue;Pe[be]=v.Object.prototype[be]}if(Pe[be].indexOf("url(")!==0){var we=new v.Color(Pe[be]);Pe[be]=we.setAlpha(f(we.getAlpha()*Pe[T[be]],2)).toRgba()}}return Pe}function Y(Pe,be){var we,Ae=[],$e,Me,Ie;for(Me=0,Ie=be.length;Me<Ie;Me++)we=be[Me],$e=Pe.getElementsByTagName(we),Ae=Ae.concat(Array.prototype.slice.call($e));return Ae}v.parseTransformAttribute=function(){function Pe(Xe,qe){var Ke=v.util.cos(qe[0]),Je=v.util.sin(qe[0]),rt=0,ht=0;qe.length===3&&(rt=qe[1],ht=qe[2]),Xe[0]=Ke,Xe[1]=Je,Xe[2]=-Je,Xe[3]=Ke,Xe[4]=rt-(Ke*rt-Je*ht),Xe[5]=ht-(Je*rt+Ke*ht)}function be(Xe,qe){var Ke=qe[0],Je=qe.length===2?qe[1]:qe[0];Xe[0]=Ke,Xe[3]=Je}function we(Xe,qe,Ke){Xe[Ke]=Math.tan(v.util.degreesToRadians(qe[0]))}function Ae(Xe,qe){Xe[4]=qe[0],qe.length===2&&(Xe[5]=qe[1])}var $e=v.iMatrix,Me=v.reNum,Ie=v.commaWsp,Le="(?:(skewX)\\s*\\(\\s*("+Me+")\\s*\\))",le="(?:(skewY)\\s*\\(\\s*("+Me+")\\s*\\))",oe="(?:(rotate)\\s*\\(\\s*("+Me+")(?:"+Ie+"("+Me+")"+Ie+"("+Me+"))?\\s*\\))",ke="(?:(scale)\\s*\\(\\s*("+Me+")(?:"+Ie+"("+Me+"))?\\s*\\))",Ce="(?:(translate)\\s*\\(\\s*("+Me+")(?:"+Ie+"("+Me+"))?\\s*\\))",Ee="(?:(matrix)\\s*\\(\\s*("+Me+")"+Ie+"("+Me+")"+Ie+"("+Me+")"+Ie+"("+Me+")"+Ie+"("+Me+")"+Ie+"("+Me+")\\s*\\))",Be="(?:"+Ee+"|"+Ce+"|"+ke+"|"+oe+"|"+Le+"|"+le+")",Ve="(?:"+Be+"(?:"+Ie+"*"+Be+")*)",Oe="^\\s*(?:"+Ve+"?)\\s*$",je=new RegExp(Oe),Ge=new RegExp(Be,"g");return function(Xe){var qe=$e.concat(),Ke=[];if(!Xe||Xe&&!je.test(Xe))return qe;Xe.replace(Ge,function(rt){var ht=new RegExp(Be).exec(rt).filter(function(kt){return!!kt}),vt=ht[1],Ct=ht.slice(2).map(parseFloat);switch(vt){case"translate":Ae(qe,Ct);break;case"rotate":Ct[0]=v.util.degreesToRadians(Ct[0]),Pe(qe,Ct);break;case"scale":be(qe,Ct);break;case"skewX":we(qe,Ct,2);break;case"skewY":we(qe,Ct,1);break;case"matrix":qe=Ct;break}Ke.push(qe.concat()),qe=$e.concat()});for(var Je=Ke[0];Ke.length>1;)Ke.shift(),Je=v.util.multiplyTransformMatrices(Je,Ke[0]);return Je}}();function _e(Pe,be){var we,Ae;Pe.replace(/;\s*$/,"").split(";").forEach(function($e){var Me=$e.split(":");we=Me[0].trim().toLowerCase(),Ae=Me[1].trim(),be[we]=Ae})}function ne(Pe,be){var we,Ae;for(var $e in Pe)typeof Pe[$e]>"u"||(we=$e.toLowerCase(),Ae=Pe[$e],be[we]=Ae)}function ve(Pe,be){var we={};for(var Ae in v.cssRules[be])if(J(Pe,Ae.split(" ")))for(var $e in v.cssRules[be][Ae])we[$e]=v.cssRules[be][Ae][$e];return we}function J(Pe,be){var we,Ae=!0;return we=Z(Pe,be.pop()),we&&be.length&&(Ae=fe(Pe,be)),we&&Ae&&be.length===0}function fe(Pe,be){for(var we,Ae=!0;Pe.parentNode&&Pe.parentNode.nodeType===1&&be.length;)Ae&&(we=be.pop()),Pe=Pe.parentNode,Ae=Z(Pe,we);return be.length===0}function Z(Pe,be){var we=Pe.nodeName,Ae=Pe.getAttribute("class"),$e=Pe.getAttribute("id"),Me,Ie;if(Me=new RegExp("^"+we,"i"),be=be.replace(Me,""),$e&&be.length&&(Me=new RegExp("#"+$e+"(?![a-zA-Z\\-]+)","i"),be=be.replace(Me,"")),Ae&&be.length)for(Ae=Ae.split(" "),Ie=Ae.length;Ie--;)Me=new RegExp("\\."+Ae[Ie]+"(?![a-zA-Z\\-]+)","i"),be=be.replace(Me,"");return be.length===0}function j(Pe,be){var we;if(Pe.getElementById&&(we=Pe.getElementById(be)),we)return we;var Ae,$e,Me,Ie=Pe.getElementsByTagName("*");for($e=0,Me=Ie.length;$e<Me;$e++)if(Ae=Ie[$e],be===Ae.getAttribute("id"))return Ae}function X(Pe){for(var be=Y(Pe,["use","svg:use"]),we=0;be.length&&we<be.length;){var Ae=be[we],$e=Ae.getAttribute("xlink:href")||Ae.getAttribute("href");if($e===null)return;var Me=$e.slice(1),Ie=Ae.getAttribute("x")||0,Le=Ae.getAttribute("y")||0,le=j(Pe,Me).cloneNode(!0),oe=(le.getAttribute("transform")||"")+" translate("+Ie+", "+Le+")",ke,Ce=be.length,Ee,Be,Ve,Oe,je=v.svgNS;if(U(le),/^svg$/i.test(le.nodeName)){var Ge=le.ownerDocument.createElementNS(je,"g");for(Be=0,Ve=le.attributes,Oe=Ve.length;Be<Oe;Be++)Ee=Ve.item(Be),Ge.setAttributeNS(je,Ee.nodeName,Ee.nodeValue);for(;le.firstChild;)Ge.appendChild(le.firstChild);le=Ge}for(Be=0,Ve=Ae.attributes,Oe=Ve.length;Be<Oe;Be++)Ee=Ve.item(Be),!(Ee.nodeName==="x"||Ee.nodeName==="y"||Ee.nodeName==="xlink:href"||Ee.nodeName==="href")&&(Ee.nodeName==="transform"?oe=Ee.nodeValue+" "+oe:le.setAttribute(Ee.nodeName,Ee.nodeValue));le.setAttribute("transform",oe),le.setAttribute("instantiated_by_use","1"),le.removeAttribute("id"),ke=Ae.parentNode,ke.replaceChild(le,Ae),be.length===Ce&&we++}}var H=new RegExp("^\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*$");function U(Pe){if(!v.svgViewBoxElementsRegEx.test(Pe.nodeName))return{};var be=Pe.getAttribute("viewBox"),we=1,Ae=1,$e=0,Me=0,Ie,Le,le,oe,ke=Pe.getAttribute("width"),Ce=Pe.getAttribute("height"),Ee=Pe.getAttribute("x")||0,Be=Pe.getAttribute("y")||0,Ve=Pe.getAttribute("preserveAspectRatio")||"",Oe=!be||!(be=be.match(H)),je=!ke||!Ce||ke==="100%"||Ce==="100%",Ge=Oe&&je,Xe={},qe="",Ke=0,Je=0;if(Xe.width=0,Xe.height=0,Xe.toBeParsed=Ge,Oe&&(Ee||Be)&&Pe.parentNode&&Pe.parentNode.nodeName!=="#document"&&(qe=" translate("+y(Ee)+" "+y(Be)+") ",le=(Pe.getAttribute("transform")||"")+qe,Pe.setAttribute("transform",le),Pe.removeAttribute("x"),Pe.removeAttribute("y")),Ge)return Xe;if(Oe)return Xe.width=y(ke),Xe.height=y(Ce),Xe;if($e=-parseFloat(be[1]),Me=-parseFloat(be[2]),Ie=parseFloat(be[3]),Le=parseFloat(be[4]),Xe.minX=$e,Xe.minY=Me,Xe.viewBoxWidth=Ie,Xe.viewBoxHeight=Le,je?(Xe.width=Ie,Xe.height=Le):(Xe.width=y(ke),Xe.height=y(Ce),we=Xe.width/Ie,Ae=Xe.height/Le),Ve=v.util.parsePreserveAspectRatioAttribute(Ve),Ve.alignX!=="none"&&(Ve.meetOrSlice==="meet"&&(Ae=we=we>Ae?Ae:we),Ve.meetOrSlice==="slice"&&(Ae=we=we>Ae?we:Ae),Ke=Xe.width-Ie*we,Je=Xe.height-Le*we,Ve.alignX==="Mid"&&(Ke/=2),Ve.alignY==="Mid"&&(Je/=2),Ve.alignX==="Min"&&(Ke=0),Ve.alignY==="Min"&&(Je=0)),we===1&&Ae===1&&$e===0&&Me===0&&Ee===0&&Be===0)return Xe;if((Ee||Be)&&Pe.parentNode.nodeName!=="#document"&&(qe=" translate("+y(Ee)+" "+y(Be)+") "),le=qe+" matrix("+we+" 0 0 "+Ae+" "+($e*we+Ke)+" "+(Me*Ae+Je)+") ",Pe.nodeName==="svg"){for(oe=Pe.ownerDocument.createElementNS(v.svgNS,"g");Pe.firstChild;)oe.appendChild(Pe.firstChild);Pe.appendChild(oe)}else oe=Pe,oe.removeAttribute("x"),oe.removeAttribute("y"),le=oe.getAttribute("transform")+le;return oe.setAttribute("transform",le),Xe}function te(Pe,be){for(;Pe&&(Pe=Pe.parentNode);)if(Pe.nodeName&&be.test(Pe.nodeName.replace("svg:",""))&&!Pe.getAttribute("instantiated_by_use"))return!0;return!1}v.parseSVGDocument=function(Pe,be,we,Ae){if(!!Pe){X(Pe);var $e=v.Object.__uid++,Me,Ie,Le=U(Pe),le=v.util.toArray(Pe.getElementsByTagName("*"));if(Le.crossOrigin=Ae&&Ae.crossOrigin,Le.svgUid=$e,le.length===0&&v.isLikelyNode){le=Pe.selectNodes('//*[name(.)!="svg"]');var oe=[];for(Me=0,Ie=le.length;Me<Ie;Me++)oe[Me]=le[Me];le=oe}var ke=le.filter(function(Ee){return U(Ee),v.svgValidTagNamesRegEx.test(Ee.nodeName.replace("svg:",""))&&!te(Ee,v.svgInvalidAncestorsRegEx)});if(!ke||ke&&!ke.length){be&&be([],{});return}var Ce={};le.filter(function(Ee){return Ee.nodeName.replace("svg:","")==="clipPath"}).forEach(function(Ee){var Be=Ee.getAttribute("id");Ce[Be]=v.util.toArray(Ee.getElementsByTagName("*")).filter(function(Ve){return v.svgValidTagNamesRegEx.test(Ve.nodeName.replace("svg:",""))})}),v.gradientDefs[$e]=v.getGradientDefs(Pe),v.cssRules[$e]=v.getCSSRules(Pe),v.clipPaths[$e]=Ce,v.parseElements(ke,function(Ee,Be){be&&(be(Ee,Le,Be,le),delete v.gradientDefs[$e],delete v.cssRules[$e],delete v.clipPaths[$e])},d(Le),we,Ae)}};function Q(Pe,be){var we=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],Ae="xlink:href",$e=be.getAttribute(Ae).slice(1),Me=j(Pe,$e);if(Me&&Me.getAttribute(Ae)&&Q(Pe,Me),we.forEach(function(Le){Me&&!be.hasAttribute(Le)&&Me.hasAttribute(Le)&&be.setAttribute(Le,Me.getAttribute(Le))}),!be.children.length)for(var Ie=Me.cloneNode(!0);Ie.firstChild;)be.appendChild(Ie.firstChild);be.removeAttribute(Ae)}var re=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+v.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+v.reNum+"))?\\s+(.*)");g(v,{parseFontDeclaration:function(Pe,be){var we=Pe.match(re);if(!!we){var Ae=we[1],$e=we[3],Me=we[4],Ie=we[5],Le=we[6];Ae&&(be.fontStyle=Ae),$e&&(be.fontWeight=isNaN(parseFloat($e))?$e:parseFloat($e)),Me&&(be.fontSize=y(Me)),Le&&(be.fontFamily=Le),Ie&&(be.lineHeight=Ie==="normal"?1:Ie)}},getGradientDefs:function(Pe){var be=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],we=Y(Pe,be),Ae,$e=0,Me={};for($e=we.length;$e--;)Ae=we[$e],Ae.getAttribute("xlink:href")&&Q(Pe,Ae),Me[Ae.getAttribute("id")]=Ae;return Me},parseAttributes:function(Pe,be,we){if(!!Pe){var Ae,$e={},Me,Ie;typeof we>"u"&&(we=Pe.getAttribute("svgUid")),Pe.parentNode&&v.svgValidParentsRegEx.test(Pe.parentNode.nodeName)&&($e=v.parseAttributes(Pe.parentNode,be,we));var Le=be.reduce(function(Ve,Oe){return Ae=Pe.getAttribute(Oe),Ae&&(Ve[Oe]=Ae),Ve},{}),le=g(ve(Pe,we),v.parseStyleAttribute(Pe));Le=g(Le,le),le[N]&&Pe.setAttribute(N,le[N]),Me=Ie=$e.fontSize||v.Text.DEFAULT_SVG_FONT_SIZE,Le[D]&&(Le[D]=Me=y(Le[D],Ie));var oe,ke,Ce={};for(var Ee in Le)oe=I(Ee),ke=O(oe,Le[Ee],$e,Me),Ce[oe]=ke;Ce&&Ce.font&&v.parseFontDeclaration(Ce.font,Ce);var Be=g($e,Ce);return v.svgValidParentsRegEx.test(Pe.nodeName)?Be:q(Be)}},parseElements:function(Pe,be,we,Ae,$e){new v.ElementsParser(Pe,be,we,Ae,$e).parse()},parseStyleAttribute:function(Pe){var be={},we=Pe.getAttribute("style");return we&&(typeof we=="string"?_e(we,be):ne(we,be)),be},parsePointsAttribute:function(Pe){if(!Pe)return null;Pe=Pe.replace(/,/g," ").trim(),Pe=Pe.split(/\s+/);var be=[],we,Ae;for(we=0,Ae=Pe.length;we<Ae;we+=2)be.push({x:parseFloat(Pe[we]),y:parseFloat(Pe[we+1])});return be},getCSSRules:function(Pe){var be=Pe.getElementsByTagName("style"),we,Ae,$e={},Me;for(we=0,Ae=be.length;we<Ae;we++){var Ie=be[we].textContent;Ie=Ie.replace(/\/\*[\s\S]*?\*\//g,""),Ie.trim()!==""&&(Me=Ie.split("}"),Me=Me.filter(function(Le){return Le.trim()}),Me.forEach(function(Le){var le=Le.split("{"),oe={},ke=le[1].trim(),Ce=ke.split(";").filter(function(Oe){return Oe.trim()});for(we=0,Ae=Ce.length;we<Ae;we++){var Ee=Ce[we].split(":"),Be=Ee[0].trim(),Ve=Ee[1].trim();oe[Be]=Ve}Le=le[0].trim(),Le.split(",").forEach(function(Oe){Oe=Oe.replace(/^svg/i,"").trim(),Oe!==""&&($e[Oe]?v.util.object.extend($e[Oe],oe):$e[Oe]=v.util.object.clone(oe))})}))}return $e},loadSVGFromURL:function(Pe,be,we,Ae){Pe=Pe.replace(/^\n\s*/,"").trim(),new v.util.request(Pe,{method:"get",onComplete:$e});function $e(Me){var Ie=Me.responseXML;if(!Ie||!Ie.documentElement)return be&&be(null),!1;v.parseSVGDocument(Ie.documentElement,function(Le,le,oe,ke){be&&be(Le,le,oe,ke)},we,Ae)}},loadSVGFromString:function(Pe,be,we,Ae){var $e=new v.window.DOMParser,Me=$e.parseFromString(Pe.trim(),"text/xml");v.parseSVGDocument(Me.documentElement,function(Ie,Le,le,oe){be(Ie,Le,le,oe)},we,Ae)}})}(e),n.ElementsParser=function(m,v,g,d,f,y){this.elements=m,this.callback=v,this.options=g,this.reviver=d,this.svgUid=g&&g.svgUid||0,this.parsingOptions=f,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=y},function(m){m.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},m.createObjects=function(){var v=this;this.elements.forEach(function(g,d){g.setAttribute("svgUid",v.svgUid),v.createObject(g,d)})},m.findTag=function(v){return n[n.util.string.capitalize(v.tagName.replace("svg:",""))]},m.createObject=function(v,g){var d=this.findTag(v);if(d&&d.fromElement)try{d.fromElement(v,this.createCallback(g,v),this.options)}catch(f){n.log(f)}else this.checkIfDone()},m.createCallback=function(v,g){var d=this;return function(f){var y;d.resolveGradient(f,g,"fill"),d.resolveGradient(f,g,"stroke"),f instanceof n.Image&&f._originalElement&&(y=f.parsePreserveAspectRatioAttribute(g)),f._removeTransformMatrix(y),d.resolveClipPath(f,g),d.reviver&&d.reviver(g,f),d.instances[v]=f,d.checkIfDone()}},m.extractPropertyDefinition=function(v,g,d){var f=v[g],y=this.regexUrl;if(!!y.test(f)){y.lastIndex=0;var x=y.exec(f)[1];return y.lastIndex=0,n[d][this.svgUid][x]}},m.resolveGradient=function(v,g,d){var f=this.extractPropertyDefinition(v,d,"gradientDefs");if(f){var y=g.getAttribute(d+"-opacity"),x=n.Gradient.fromElement(f,v,y,this.options);v.set(d,x)}},m.createClipPathCallback=function(v,g){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,g.push(d)}},m.resolveClipPath=function(v,g){var d=this.extractPropertyDefinition(v,"clipPath","clipPaths"),f,y,x,k,P,S;if(d){k=[],x=n.util.invertTransform(v.calcTransformMatrix());for(var E=d[0].parentNode,M=g;M.parentNode&&M.getAttribute("clip-path")!==v.clipPath;)M=M.parentNode;M.parentNode.appendChild(E);for(var T=0;T<d.length;T++)f=d[T],y=this.findTag(f),y.fromElement(f,this.createClipPathCallback(v,k),this.options);k.length===1?d=k[0]:d=new n.Group(k),P=n.util.multiplyTransformMatrices(x,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,M);var S=n.util.qrDecompose(P);d.flipX=!1,d.flipY=!1,d.set("scaleX",S.scaleX),d.set("scaleY",S.scaleY),d.angle=S.angle,d.skewX=S.skewX,d.skewY=0,d.setPositionByOrigin({x:S.translateX,y:S.translateY},"center","center"),v.clipPath=d}else delete v.clipPath},m.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(v){return v!=null}),this.callback(this.instances,this.elements))}}(n.ElementsParser.prototype),function(m){var v=m.fabric||(m.fabric={});if(v.Point){v.warn("fabric.Point is already defined");return}v.Point=g;function g(d,f){this.x=d,this.y=f}g.prototype={type:"point",constructor:g,add:function(d){return new g(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new g(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new g(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new g(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new g(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new g(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,f){return typeof f>"u"&&(f=.5),f=Math.max(Math.min(1,f),0),new g(this.x+(d.x-this.x)*f,this.y+(d.y-this.y)*f)},distanceFrom:function(d){var f=this.x-d.x,y=this.y-d.y;return Math.sqrt(f*f+y*y)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new g(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new g(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,f){return this.x=d,this.y=f,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var f=this.x,y=this.y;this.x=d.x,this.y=d.y,d.x=f,d.y=y},clone:function(){return new g(this.x,this.y)}}}(e),function(m){var v=m.fabric||(m.fabric={});if(v.Intersection){v.warn("fabric.Intersection is already defined");return}function g(d){this.status=d,this.points=[]}v.Intersection=g,v.Intersection.prototype={constructor:g,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},v.Intersection.intersectLineLine=function(d,f,y,x){var k,P=(x.x-y.x)*(d.y-y.y)-(x.y-y.y)*(d.x-y.x),S=(f.x-d.x)*(d.y-y.y)-(f.y-d.y)*(d.x-y.x),E=(x.y-y.y)*(f.x-d.x)-(x.x-y.x)*(f.y-d.y);if(E!==0){var M=P/E,T=S/E;0<=M&&M<=1&&0<=T&&T<=1?(k=new g("Intersection"),k.appendPoint(new v.Point(d.x+M*(f.x-d.x),d.y+M*(f.y-d.y)))):k=new g}else P===0||S===0?k=new g("Coincident"):k=new g("Parallel");return k},v.Intersection.intersectLinePolygon=function(d,f,y){var x=new g,k=y.length,P,S,E,M;for(M=0;M<k;M++)P=y[M],S=y[(M+1)%k],E=g.intersectLineLine(d,f,P,S),x.appendPoints(E.points);return x.points.length>0&&(x.status="Intersection"),x},v.Intersection.intersectPolygonPolygon=function(d,f){var y=new g,x=d.length,k;for(k=0;k<x;k++){var P=d[k],S=d[(k+1)%x],E=g.intersectLinePolygon(P,S,f);y.appendPoints(E.points)}return y.points.length>0&&(y.status="Intersection"),y},v.Intersection.intersectPolygonRectangle=function(d,f,y){var x=f.min(y),k=f.max(y),P=new v.Point(k.x,x.y),S=new v.Point(x.x,k.y),E=g.intersectLinePolygon(x,P,d),M=g.intersectLinePolygon(P,k,d),T=g.intersectLinePolygon(k,S,d),D=g.intersectLinePolygon(S,x,d),N=new g;return N.appendPoints(E.points),N.appendPoints(M.points),N.appendPoints(T.points),N.appendPoints(D.points),N.points.length>0&&(N.status="Intersection"),N}}(e),function(m){var v=m.fabric||(m.fabric={});if(v.Color){v.warn("fabric.Color is already defined.");return}function g(f){f?this._tryParsingColor(f):this.setSource([0,0,0,1])}v.Color=g,v.Color.prototype={_tryParsingColor:function(f){var y;f in g.colorNameMap&&(f=g.colorNameMap[f]),f==="transparent"&&(y=[255,255,255,0]),y||(y=g.sourceFromHex(f)),y||(y=g.sourceFromRgb(f)),y||(y=g.sourceFromHsl(f)),y||(y=[0,0,0,1]),y&&this.setSource(y)},_rgbToHsl:function(f,y,x){f/=255,y/=255,x/=255;var k,P,S,E=v.util.array.max([f,y,x]),M=v.util.array.min([f,y,x]);if(S=(E+M)/2,E===M)k=P=0;else{var T=E-M;switch(P=S>.5?T/(2-E-M):T/(E+M),E){case f:k=(y-x)/T+(y<x?6:0);break;case y:k=(x-f)/T+2;break;case x:k=(f-y)/T+4;break}k/=6}return[Math.round(k*360),Math.round(P*100),Math.round(S*100)]},getSource:function(){return this._source},setSource:function(f){this._source=f},toRgb:function(){var f=this.getSource();return"rgb("+f[0]+","+f[1]+","+f[2]+")"},toRgba:function(){var f=this.getSource();return"rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")"},toHsl:function(){var f=this.getSource(),y=this._rgbToHsl(f[0],f[1],f[2]);return"hsl("+y[0]+","+y[1]+"%,"+y[2]+"%)"},toHsla:function(){var f=this.getSource(),y=this._rgbToHsl(f[0],f[1],f[2]);return"hsla("+y[0]+","+y[1]+"%,"+y[2]+"%,"+f[3]+")"},toHex:function(){var f=this.getSource(),y,x,k;return y=f[0].toString(16),y=y.length===1?"0"+y:y,x=f[1].toString(16),x=x.length===1?"0"+x:x,k=f[2].toString(16),k=k.length===1?"0"+k:k,y.toUpperCase()+x.toUpperCase()+k.toUpperCase()},toHexa:function(){var f=this.getSource(),y;return y=Math.round(f[3]*255),y=y.toString(16),y=y.length===1?"0"+y:y,this.toHex()+y.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(f){var y=this.getSource();return y[3]=f,this.setSource(y),this},toGrayscale:function(){var f=this.getSource(),y=parseInt((f[0]*.3+f[1]*.59+f[2]*.11).toFixed(0),10),x=f[3];return this.setSource([y,y,y,x]),this},toBlackWhite:function(f){var y=this.getSource(),x=(y[0]*.3+y[1]*.59+y[2]*.11).toFixed(0),k=y[3];return f=f||127,x=Number(x)<Number(f)?0:255,this.setSource([x,x,x,k]),this},overlayWith:function(f){f instanceof g||(f=new g(f));var y=[],x=this.getAlpha(),k=.5,P=this.getSource(),S=f.getSource(),E;for(E=0;E<3;E++)y.push(Math.round(P[E]*(1-k)+S[E]*k));return y[3]=x,this.setSource(y),this}},v.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,v.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,v.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,v.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(f,y,x){return x<0&&(x+=1),x>1&&(x-=1),x<1/6?f+(y-f)*6*x:x<1/2?y:x<2/3?f+(y-f)*(2/3-x)*6:f}v.Color.fromRgb=function(f){return g.fromSource(g.sourceFromRgb(f))},v.Color.sourceFromRgb=function(f){var y=f.match(g.reRGBa);if(y){var x=parseInt(y[1],10)/(/%$/.test(y[1])?100:1)*(/%$/.test(y[1])?255:1),k=parseInt(y[2],10)/(/%$/.test(y[2])?100:1)*(/%$/.test(y[2])?255:1),P=parseInt(y[3],10)/(/%$/.test(y[3])?100:1)*(/%$/.test(y[3])?255:1);return[parseInt(x,10),parseInt(k,10),parseInt(P,10),y[4]?parseFloat(y[4]):1]}},v.Color.fromRgba=g.fromRgb,v.Color.fromHsl=function(f){return g.fromSource(g.sourceFromHsl(f))},v.Color.sourceFromHsl=function(f){var y=f.match(g.reHSLa);if(!!y){var x=(parseFloat(y[1])%360+360)%360/360,k=parseFloat(y[2])/(/%$/.test(y[2])?100:1),P=parseFloat(y[3])/(/%$/.test(y[3])?100:1),S,E,M;if(k===0)S=E=M=P;else{var T=P<=.5?P*(k+1):P+k-P*k,D=P*2-T;S=d(D,T,x+1/3),E=d(D,T,x),M=d(D,T,x-1/3)}return[Math.round(S*255),Math.round(E*255),Math.round(M*255),y[4]?parseFloat(y[4]):1]}},v.Color.fromHsla=g.fromHsl,v.Color.fromHex=function(f){return g.fromSource(g.sourceFromHex(f))},v.Color.sourceFromHex=function(f){if(f.match(g.reHex)){var y=f.slice(f.indexOf("#")+1),x=y.length===3||y.length===4,k=y.length===8||y.length===4,P=x?y.charAt(0)+y.charAt(0):y.substring(0,2),S=x?y.charAt(1)+y.charAt(1):y.substring(2,4),E=x?y.charAt(2)+y.charAt(2):y.substring(4,6),M=k?x?y.charAt(3)+y.charAt(3):y.substring(6,8):"FF";return[parseInt(P,16),parseInt(S,16),parseInt(E,16),parseFloat((parseInt(M,16)/255).toFixed(2))]}},v.Color.fromSource=function(f){var y=new g;return y.setSource(f),y}}(e),function(m){var v=m.fabric||(m.fabric={}),g=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],f={},y="left",x="top",k="right",P="bottom",S="center",E={top:P,bottom:x,left:k,right:y,center:S},M=v.util.radiansToDegrees,T=Math.sign||function(oe){return(oe>0)-(oe<0)||+oe};function D(oe,ke){var Ce=oe.angle+M(Math.atan2(ke.y,ke.x))+360;return Math.round(Ce%360/45)}function N(oe,ke){var Ce=ke.transform.target,Ee=Ce.canvas,Be=v.util.object.clone(ke);Be.target=Ce,Ee&&Ee.fire("object:"+oe,Be),Ce.fire(oe,ke)}function I(oe,ke){var Ce=ke.canvas,Ee=Ce.uniScaleKey,Be=oe[Ee];return Ce.uniformScaling&&!Be||!Ce.uniformScaling&&Be}function O(oe){return oe.originX===S&&oe.originY===S}function F(oe,ke,Ce){var Ee=oe.lockScalingX,Be=oe.lockScalingY;return!!(Ee&&Be||!ke&&(Ee||Be)&&Ce||Ee&&ke==="x"||Be&&ke==="y")}function q(oe,ke,Ce){var Ee="not-allowed",Be=I(oe,Ce),Ve="";if(ke.x!==0&&ke.y===0?Ve="x":ke.x===0&&ke.y!==0&&(Ve="y"),F(Ce,Ve,Be))return Ee;var Oe=D(Ce,ke);return g[Oe]+"-resize"}function Y(oe,ke,Ce){var Ee="not-allowed";if(ke.x!==0&&Ce.lockSkewingY||ke.y!==0&&Ce.lockSkewingX)return Ee;var Be=D(Ce,ke)%4;return d[Be]+"-resize"}function _e(oe,ke,Ce){return oe[Ce.canvas.altActionKey]?f.skewCursorStyleHandler(oe,ke,Ce):f.scaleCursorStyleHandler(oe,ke,Ce)}function ne(oe,ke,Ce){var Ee=oe[Ce.canvas.altActionKey];if(ke.x===0)return Ee?"skewX":"scaleY";if(ke.y===0)return Ee?"skewY":"scaleX"}function ve(oe,ke,Ce){return Ce.lockRotation?"not-allowed":ke.cursorStyle}function J(oe,ke,Ce,Ee){return{e:oe,transform:ke,pointer:{x:Ce,y:Ee}}}function fe(oe){return function(ke,Ce,Ee,Be){var Ve=Ce.target,Oe=Ve.getCenterPoint(),je=Ve.translateToOriginPoint(Oe,Ce.originX,Ce.originY),Ge=oe(ke,Ce,Ee,Be);return Ve.setPositionByOrigin(je,Ce.originX,Ce.originY),Ge}}function Z(oe,ke){return function(Ce,Ee,Be,Ve){var Oe=ke(Ce,Ee,Be,Ve);return Oe&&N(oe,J(Ce,Ee,Be,Ve)),Oe}}function j(oe,ke,Ce,Ee,Be){var Ve=oe.target,Oe=Ve.controls[oe.corner],je=Ve.canvas.getZoom(),Ge=Ve.padding/je,Xe=Ve.toLocalPoint(new v.Point(Ee,Be),ke,Ce);return Xe.x>=Ge&&(Xe.x-=Ge),Xe.x<=-Ge&&(Xe.x+=Ge),Xe.y>=Ge&&(Xe.y-=Ge),Xe.y<=Ge&&(Xe.y+=Ge),Xe.x-=Oe.offsetX,Xe.y-=Oe.offsetY,Xe}function X(oe){return oe.flipX!==oe.flipY}function H(oe,ke,Ce,Ee,Be){if(oe[ke]!==0){var Ve=oe._getTransformedDimensions()[Ee],Oe=Be/Ve*oe[Ce];oe.set(Ce,Oe)}}function U(oe,ke,Ce,Ee){var Be=ke.target,Ve=Be._getTransformedDimensions(0,Be.skewY),Oe=j(ke,ke.originX,ke.originY,Ce,Ee),je=Math.abs(Oe.x*2)-Ve.x,Ge=Be.skewX,Xe;je<2?Xe=0:(Xe=M(Math.atan2(je/Be.scaleX,Ve.y/Be.scaleY)),ke.originX===y&&ke.originY===P&&(Xe=-Xe),ke.originX===k&&ke.originY===x&&(Xe=-Xe),X(Be)&&(Xe=-Xe));var qe=Ge!==Xe;if(qe){var Ke=Be._getTransformedDimensions().y;Be.set("skewX",Xe),H(Be,"skewY","scaleY","y",Ke)}return qe}function te(oe,ke,Ce,Ee){var Be=ke.target,Ve=Be._getTransformedDimensions(Be.skewX,0),Oe=j(ke,ke.originX,ke.originY,Ce,Ee),je=Math.abs(Oe.y*2)-Ve.y,Ge=Be.skewY,Xe;je<2?Xe=0:(Xe=M(Math.atan2(je/Be.scaleY,Ve.x/Be.scaleX)),ke.originX===y&&ke.originY===P&&(Xe=-Xe),ke.originX===k&&ke.originY===x&&(Xe=-Xe),X(Be)&&(Xe=-Xe));var qe=Ge!==Xe;if(qe){var Ke=Be._getTransformedDimensions().x;Be.set("skewY",Xe),H(Be,"skewX","scaleX","x",Ke)}return qe}function Q(oe,ke,Ce,Ee){var Be=ke.target,Ve=Be.skewX,Oe,je=ke.originY;if(Be.lockSkewingX)return!1;if(Ve===0){var Ge=j(ke,S,S,Ce,Ee);Ge.x>0?Oe=y:Oe=k}else Ve>0&&(Oe=je===x?y:k),Ve<0&&(Oe=je===x?k:y),X(Be)&&(Oe=Oe===y?k:y);ke.originX=Oe;var Xe=Z("skewing",fe(U));return Xe(oe,ke,Ce,Ee)}function re(oe,ke,Ce,Ee){var Be=ke.target,Ve=Be.skewY,Oe,je=ke.originX;if(Be.lockSkewingY)return!1;if(Ve===0){var Ge=j(ke,S,S,Ce,Ee);Ge.y>0?Oe=x:Oe=P}else Ve>0&&(Oe=je===y?x:P),Ve<0&&(Oe=je===y?P:x),X(Be)&&(Oe=Oe===x?P:x);ke.originY=Oe;var Xe=Z("skewing",fe(te));return Xe(oe,ke,Ce,Ee)}function Pe(oe,ke,Ce,Ee){var Be=ke,Ve=Be.target,Oe=Ve.translateToOriginPoint(Ve.getCenterPoint(),Be.originX,Be.originY);if(Ve.lockRotation)return!1;var je=Math.atan2(Be.ey-Oe.y,Be.ex-Oe.x),Ge=Math.atan2(Ee-Oe.y,Ce-Oe.x),Xe=M(Ge-je+Be.theta),qe=!0;if(Ve.snapAngle>0){var Ke=Ve.snapAngle,Je=Ve.snapThreshold||Ke,rt=Math.ceil(Xe/Ke)*Ke,ht=Math.floor(Xe/Ke)*Ke;Math.abs(Xe-ht)<Je?Xe=ht:Math.abs(Xe-rt)<Je&&(Xe=rt)}return Xe<0&&(Xe=360+Xe),Xe%=360,qe=Ve.angle!==Xe,Ve.angle=Xe,qe}function be(oe,ke,Ce,Ee,Be){Be=Be||{};var Ve=ke.target,Oe=Ve.lockScalingX,je=Ve.lockScalingY,Ge=Be.by,Xe,qe,Ke,Je,rt=I(oe,Ve),ht=F(Ve,Ge,rt),vt,Ct,kt=ke.gestureScale;if(ht)return!1;if(kt)qe=ke.scaleX*kt,Ke=ke.scaleY*kt;else{if(Xe=j(ke,ke.originX,ke.originY,Ce,Ee),vt=Ge!=="y"?T(Xe.x):1,Ct=Ge!=="x"?T(Xe.y):1,ke.signX||(ke.signX=vt),ke.signY||(ke.signY=Ct),Ve.lockScalingFlip&&(ke.signX!==vt||ke.signY!==Ct))return!1;if(Je=Ve._getTransformedDimensions(),rt&&!Ge){var mt=Math.abs(Xe.x)+Math.abs(Xe.y),Vt=ke.original,bt=Math.abs(Je.x*Vt.scaleX/Ve.scaleX)+Math.abs(Je.y*Vt.scaleY/Ve.scaleY),ot=mt/bt;qe=Vt.scaleX*ot,Ke=Vt.scaleY*ot}else qe=Math.abs(Xe.x*Ve.scaleX/Je.x),Ke=Math.abs(Xe.y*Ve.scaleY/Je.y);O(ke)&&(qe*=2,Ke*=2),ke.signX!==vt&&Ge!=="y"&&(ke.originX=E[ke.originX],qe*=-1,ke.signX=vt),ke.signY!==Ct&&Ge!=="x"&&(ke.originY=E[ke.originY],Ke*=-1,ke.signY=Ct)}var gt=Ve.scaleX,tt=Ve.scaleY;return Ge?(Ge==="x"&&Ve.set("scaleX",qe),Ge==="y"&&Ve.set("scaleY",Ke)):(!Oe&&Ve.set("scaleX",qe),!je&&Ve.set("scaleY",Ke)),gt!==Ve.scaleX||tt!==Ve.scaleY}function we(oe,ke,Ce,Ee){return be(oe,ke,Ce,Ee)}function Ae(oe,ke,Ce,Ee){return be(oe,ke,Ce,Ee,{by:"x"})}function $e(oe,ke,Ce,Ee){return be(oe,ke,Ce,Ee,{by:"y"})}function Me(oe,ke,Ce,Ee){return oe[ke.target.canvas.altActionKey]?f.skewHandlerX(oe,ke,Ce,Ee):f.scalingY(oe,ke,Ce,Ee)}function Ie(oe,ke,Ce,Ee){return oe[ke.target.canvas.altActionKey]?f.skewHandlerY(oe,ke,Ce,Ee):f.scalingX(oe,ke,Ce,Ee)}function Le(oe,ke,Ce,Ee){var Be=ke.target,Ve=j(ke,ke.originX,ke.originY,Ce,Ee),Oe=Be.strokeWidth/(Be.strokeUniform?Be.scaleX:1),je=O(ke)?2:1,Ge=Be.width,Xe=Math.abs(Ve.x*je/Be.scaleX)-Oe;return Be.set("width",Math.max(Xe,0)),Ge!==Xe}function le(oe,ke,Ce,Ee){var Be=ke.target,Ve=Ce-ke.offsetX,Oe=Ee-ke.offsetY,je=!Be.get("lockMovementX")&&Be.left!==Ve,Ge=!Be.get("lockMovementY")&&Be.top!==Oe;return je&&Be.set("left",Ve),Ge&&Be.set("top",Oe),(je||Ge)&&N("moving",J(oe,ke,Ce,Ee)),je||Ge}f.scaleCursorStyleHandler=q,f.skewCursorStyleHandler=Y,f.scaleSkewCursorStyleHandler=_e,f.rotationWithSnapping=Z("rotating",fe(Pe)),f.scalingEqually=Z("scaling",fe(we)),f.scalingX=Z("scaling",fe(Ae)),f.scalingY=Z("scaling",fe($e)),f.scalingYOrSkewingX=Me,f.scalingXOrSkewingY=Ie,f.changeWidth=Z("resizing",fe(Le)),f.skewHandlerX=Q,f.skewHandlerY=re,f.dragHandler=le,f.scaleOrSkewActionName=ne,f.rotationStyleHandler=ve,f.fireEvent=N,f.wrapWithFixedAnchor=fe,f.wrapWithFireEvent=Z,f.getLocalPoint=j,v.controlsUtils=f}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.degreesToRadians,d=v.controlsUtils;function f(x,k,P,S,E){S=S||{};var M=this.sizeX||S.cornerSize||E.cornerSize,T=this.sizeY||S.cornerSize||E.cornerSize,D=typeof S.transparentCorners<"u"?S.transparentCorners:E.transparentCorners,N=D?"stroke":"fill",I=!D&&(S.cornerStrokeColor||E.cornerStrokeColor),O=k,F=P,q;x.save(),x.fillStyle=S.cornerColor||E.cornerColor,x.strokeStyle=S.cornerStrokeColor||E.cornerStrokeColor,M>T?(q=M,x.scale(1,T/M),F=P*M/T):T>M?(q=T,x.scale(M/T,1),O=k*T/M):q=M,x.lineWidth=1,x.beginPath(),x.arc(O,F,q/2,0,2*Math.PI,!1),x[N](),I&&x.stroke(),x.restore()}function y(x,k,P,S,E){S=S||{};var M=this.sizeX||S.cornerSize||E.cornerSize,T=this.sizeY||S.cornerSize||E.cornerSize,D=typeof S.transparentCorners<"u"?S.transparentCorners:E.transparentCorners,N=D?"stroke":"fill",I=!D&&(S.cornerStrokeColor||E.cornerStrokeColor),O=M/2,F=T/2;x.save(),x.fillStyle=S.cornerColor||E.cornerColor,x.strokeStyle=S.cornerStrokeColor||E.cornerStrokeColor,x.lineWidth=1,x.translate(k,P),x.rotate(g(E.angle)),x[N+"Rect"](-O,-F,M,T),I&&x.strokeRect(-O,-F,M,T),x.restore()}d.renderCircleControl=f,d.renderSquareControl=y}(e),function(m){var v=m.fabric||(m.fabric={});function g(d){for(var f in d)this[f]=d[f]}v.Control=g,v.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,f){return f.cursorStyle},getActionName:function(d,f){return f.actionName},getVisibility:function(d,f){var y=d._controlsVisibility;return y&&typeof y[f]<"u"?y[f]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,f){var y=v.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},f);return y},calcCornerCoords:function(d,f,y,x,k){var P,S,E,M,T=k?this.touchSizeX:this.sizeX,D=k?this.touchSizeY:this.sizeY;if(T&&D&&T!==D){var N=Math.atan2(D,T),I=Math.sqrt(T*T+D*D)/2,O=N-v.util.degreesToRadians(d),F=Math.PI/2-N-v.util.degreesToRadians(d);P=I*v.util.cos(O),S=I*v.util.sin(O),E=I*v.util.cos(F),M=I*v.util.sin(F)}else{var q=T&&D?T:f;I=q*.7071067812;var O=v.util.degreesToRadians(45-d);P=E=I*v.util.cos(O),S=M=I*v.util.sin(O)}return{tl:{x:y-M,y:x-E},tr:{x:y+P,y:x-S},bl:{x:y-P,y:x+S},br:{x:y+M,y:x+E}}},render:function(d,f,y,x,k){switch(x=x||{},x.cornerStyle||k.cornerStyle){case"circle":v.controlsUtils.renderCircleControl.call(this,d,f,y,x,k);break;default:v.controlsUtils.renderSquareControl.call(this,d,f,y,x,k)}}}}(e),function(){function m(y,x){var k=y.getAttribute("style"),P=y.getAttribute("offset")||0,S,E,M,T;if(P=parseFloat(P)/(/%$/.test(P)?100:1),P=P<0?0:P>1?1:P,k){var D=k.split(/\s*;\s*/);for(D[D.length-1]===""&&D.pop(),T=D.length;T--;){var N=D[T].split(/\s*:\s*/),I=N[0].trim(),O=N[1].trim();I==="stop-color"?S=O:I==="stop-opacity"&&(M=O)}}return S||(S=y.getAttribute("stop-color")||"rgb(0,0,0)"),M||(M=y.getAttribute("stop-opacity")),S=new n.Color(S),E=S.getAlpha(),M=isNaN(parseFloat(M))?1:parseFloat(M),M*=E*x,{offset:P,color:S.toRgb(),opacity:M}}function v(y){return{x1:y.getAttribute("x1")||0,y1:y.getAttribute("y1")||0,x2:y.getAttribute("x2")||"100%",y2:y.getAttribute("y2")||0}}function g(y){return{x1:y.getAttribute("fx")||y.getAttribute("cx")||"50%",y1:y.getAttribute("fy")||y.getAttribute("cy")||"50%",r1:0,x2:y.getAttribute("cx")||"50%",y2:y.getAttribute("cy")||"50%",r2:y.getAttribute("r")||"50%"}}var d=n.util.object.clone;n.Gradient=n.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(y){y||(y={}),y.coords||(y.coords={});var x,k=this;Object.keys(y).forEach(function(P){k[P]=y[P]}),this.id?this.id+="_"+n.Object.__uid++:this.id=n.Object.__uid++,x={x1:y.coords.x1||0,y1:y.coords.y1||0,x2:y.coords.x2||0,y2:y.coords.y2||0},this.type==="radial"&&(x.r1=y.coords.r1||0,x.r2=y.coords.r2||0),this.coords=x,this.colorStops=y.colorStops.slice()},addColorStop:function(y){for(var x in y){var k=new n.Color(y[x]);this.colorStops.push({offset:parseFloat(x),color:k.toRgb(),opacity:k.getAlpha()})}return this},toObject:function(y){var x={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return n.util.populateWithProperties(this,x,y),x},toSVG:function(y,E){var k=d(this.coords,!0),P,S,E=E||{},M,T,D=d(this.colorStops,!0),N=k.r1>k.r2,I=this.gradientTransform?this.gradientTransform.concat():n.iMatrix.concat(),O=-this.offsetX,F=-this.offsetY,q=!!E.additionalTransform,Y=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(D.sort(function(fe,Z){return fe.offset-Z.offset}),Y==="objectBoundingBox"?(O/=y.width,F/=y.height):(O+=y.width/2,F+=y.height/2),y.type==="path"&&this.gradientUnits!=="percentage"&&(O-=y.pathOffset.x,F-=y.pathOffset.y),I[4]-=O,I[5]-=F,T='id="SVGID_'+this.id+'" gradientUnits="'+Y+'"',T+=' gradientTransform="'+(q?E.additionalTransform+" ":"")+n.util.matrixToSVG(I)+'" ',this.type==="linear"?M=["<linearGradient ",T,' x1="',k.x1,'" y1="',k.y1,'" x2="',k.x2,'" y2="',k.y2,`">
`]:this.type==="radial"&&(M=["<radialGradient ",T,' cx="',N?k.x1:k.x2,'" cy="',N?k.y1:k.y2,'" r="',N?k.r1:k.r2,'" fx="',N?k.x2:k.x1,'" fy="',N?k.y2:k.y1,`">
`]),this.type==="radial"){if(N)for(D=D.concat(),D.reverse(),P=0,S=D.length;P<S;P++)D[P].offset=1-D[P].offset;var _e=Math.min(k.r1,k.r2);if(_e>0){var ne=Math.max(k.r1,k.r2),ve=_e/ne;for(P=0,S=D.length;P<S;P++)D[P].offset+=ve*(1-D[P].offset)}}for(P=0,S=D.length;P<S;P++){var J=D[P];M.push("<stop ",'offset="',J.offset*100+"%",'" style="stop-color:',J.color,typeof J.opacity<"u"?";stop-opacity: "+J.opacity:";",`"/>
`)}return M.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),M.join("")},toLive:function(y){var x,k=n.util.object.clone(this.coords),P,S;if(!!this.type){for(this.type==="linear"?x=y.createLinearGradient(k.x1,k.y1,k.x2,k.y2):this.type==="radial"&&(x=y.createRadialGradient(k.x1,k.y1,k.r1,k.x2,k.y2,k.r2)),P=0,S=this.colorStops.length;P<S;P++){var E=this.colorStops[P].color,M=this.colorStops[P].opacity,T=this.colorStops[P].offset;typeof M<"u"&&(E=new n.Color(E).setAlpha(M).toRgba()),x.addColorStop(T,E)}return x}}}),n.util.object.extend(n.Gradient,{fromElement:function(y,x,k,P){var S=parseFloat(k)/(/%$/.test(k)?100:1);S=S<0?0:S>1?1:S,isNaN(S)&&(S=1);var E=y.getElementsByTagName("stop"),M,T=y.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",D=y.getAttribute("gradientTransform")||"",N=[],I,O,F=0,q=0,Y;for(y.nodeName==="linearGradient"||y.nodeName==="LINEARGRADIENT"?(M="linear",I=v(y)):(M="radial",I=g(y)),O=E.length;O--;)N.push(m(E[O],S));Y=n.parseTransformAttribute(D),f(x,I,P,T),T==="pixels"&&(F=-x.left,q=-x.top);var _e=new n.Gradient({id:y.getAttribute("id"),type:M,coords:I,colorStops:N,gradientUnits:T,gradientTransform:Y,offsetX:F,offsetY:q});return _e}});function f(y,x,k,P){var S,E;Object.keys(x).forEach(function(M){S=x[M],S==="Infinity"?E=1:S==="-Infinity"?E=0:(E=parseFloat(x[M],10),typeof S=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(S)&&(E*=.01,P==="pixels"&&((M==="x1"||M==="x2"||M==="r2")&&(E*=k.viewBoxWidth||k.width),(M==="y1"||M==="y2")&&(E*=k.viewBoxHeight||k.height)))),x[M]=E})}}(),function(){var m=n.util.toFixed;n.Pattern=n.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(v,g){if(v||(v={}),this.id=n.Object.__uid++,this.setOptions(v),!v.source||v.source&&typeof v.source!="string"){g&&g(this);return}else{var d=this;this.source=n.util.createImage(),n.util.loadImage(v.source,function(f,y){d.source=f,g&&g(d,y)},null,this.crossOrigin)}},toObject:function(v){var g=n.Object.NUM_FRACTION_DIGITS,d,f;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),f={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:m(this.offsetX,g),offsetY:m(this.offsetY,g),patternTransform:this.patternTransform?this.patternTransform.concat():null},n.util.populateWithProperties(this,f,v),f},toSVG:function(v){var g=typeof this.source=="function"?this.source():this.source,d=g.width/v.width,f=g.height/v.height,y=this.offsetX/v.width,x=this.offsetY/v.height,k="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(f=1,x&&(f+=Math.abs(x))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,y&&(d+=Math.abs(y))),g.src?k=g.src:g.toDataURL&&(k=g.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+y+'" y="'+x+'" width="'+d+'" height="'+f+`">
<image x="0" y="0" width="`+g.width+'" height="'+g.height+'" xlink:href="'+k+`"></image>
</pattern>
`},setOptions:function(v){for(var g in v)this[g]=v[g]},toLive:function(v){var g=this.source;return!g||typeof g.src<"u"&&(!g.complete||g.naturalWidth===0||g.naturalHeight===0)?"":v.createPattern(g,this.repeat)}})}(),function(m){var v=m.fabric||(m.fabric={}),g=v.util.toFixed;if(v.Shadow){v.warn("fabric.Shadow is already defined.");return}v.Shadow=v.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var f in d)this[f]=d[f];this.id=v.Object.__uid++},_parseShadow:function(d){var f=d.trim(),y=v.Shadow.reOffsetsAndBlur.exec(f)||[],x=f.replace(v.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:x.trim(),offsetX:parseFloat(y[1],10)||0,offsetY:parseFloat(y[2],10)||0,blur:parseFloat(y[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var f=40,y=40,x=v.Object.NUM_FRACTION_DIGITS,k=v.util.rotateVector({x:this.offsetX,y:this.offsetY},v.util.degreesToRadians(-d.angle)),P=20,S=new v.Color(this.color);return d.width&&d.height&&(f=g((Math.abs(k.x)+this.blur)/d.width,x)*100+P,y=g((Math.abs(k.y)+this.blur)/d.height,x)*100+P),d.flipX&&(k.x*=-1),d.flipY&&(k.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+y+'%" height="'+(100+2*y)+'%" x="-'+f+'%" width="'+(100+2*f)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+g(this.blur?this.blur/2:0,x)+`"></feGaussianBlur>
	<feOffset dx="`+g(k.x,x)+'" dy="'+g(k.y,x)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+S.toRgb()+'" flood-opacity="'+S.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},f=v.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(y){this[y]!==f[y]&&(d[y]=this[y])},this),d}}),v.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(n.StaticCanvas){n.warn("fabric.StaticCanvas is already defined.");return}var m=n.util.object.extend,v=n.util.getElementOffset,g=n.util.removeFromArray,d=n.util.toFixed,f=n.util.transformPoint,y=n.util.invertTransform,x=n.util.getNodeCanvas,k=n.util.createCanvasElement,P=new Error("Could not initialize `canvas` element");n.StaticCanvas=n.util.createClass(n.CommonMethods,{initialize:function(S,E){E||(E={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(S,E)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:n.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(S,E){var M=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(S),this._initOptions(E),this.interactive||this._initRetinaScaling(),E.overlayImage&&this.setOverlayImage(E.overlayImage,M),E.backgroundImage&&this.setBackgroundImage(E.backgroundImage,M),E.backgroundColor&&this.setBackgroundColor(E.backgroundColor,M),E.overlayColor&&this.setOverlayColor(E.overlayColor,M),this.calcOffset()},_isRetinaScaling:function(){return n.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,n.devicePixelRatio):1},_initRetinaScaling:function(){if(!!this._isRetinaScaling()){var S=n.devicePixelRatio;this.__initRetinaScaling(S,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(S,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(S,E,M){E.setAttribute("width",this.width*S),E.setAttribute("height",this.height*S),M.scale(S,S)},calcOffset:function(){return this._offset=v(this.lowerCanvasEl),this},setOverlayImage:function(S,E,M){return this.__setBgOverlayImage("overlayImage",S,E,M)},setBackgroundImage:function(S,E,M){return this.__setBgOverlayImage("backgroundImage",S,E,M)},setOverlayColor:function(S,E){return this.__setBgOverlayColor("overlayColor",S,E)},setBackgroundColor:function(S,E){return this.__setBgOverlayColor("backgroundColor",S,E)},__setBgOverlayImage:function(S,E,M,T){return typeof E=="string"?n.util.loadImage(E,function(D,N){if(D){var I=new n.Image(D,T);this[S]=I,I.canvas=this}M&&M(D,N)},this,T&&T.crossOrigin):(T&&E.setOptions(T),this[S]=E,E&&(E.canvas=this),M&&M(E,!1)),this},__setBgOverlayColor:function(S,E,M){return this[S]=E,this._initGradient(E,S),this._initPattern(E,S,M),this},_createCanvasElement:function(){var S=k();if(!S||(S.style||(S.style={}),typeof S.getContext>"u"))throw P;return S},_initOptions:function(S){var E=this.lowerCanvasEl;this._setOptions(S),this.width=this.width||parseInt(E.width,10)||0,this.height=this.height||parseInt(E.height,10)||0,this.lowerCanvasEl.style&&(E.width=this.width,E.height=this.height,E.style.width=this.width+"px",E.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(S){S&&S.getContext?this.lowerCanvasEl=S:this.lowerCanvasEl=n.util.getById(S)||this._createCanvasElement(),n.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(S,E){return this.setDimensions({width:S},E)},setHeight:function(S,E){return this.setDimensions({height:S},E)},setDimensions:function(S,E){var M;E=E||{};for(var T in S)M=S[T],E.cssOnly||(this._setBackstoreDimension(T,S[T]),M+="px",this.hasLostContext=!0),E.backstoreOnly||this._setCssDimension(T,M);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),E.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(S,E){return this.lowerCanvasEl[S]=E,this.upperCanvasEl&&(this.upperCanvasEl[S]=E),this.cacheCanvasEl&&(this.cacheCanvasEl[S]=E),this[S]=E,this},_setCssDimension:function(S,E){return this.lowerCanvasEl.style[S]=E,this.upperCanvasEl&&(this.upperCanvasEl.style[S]=E),this.wrapperEl&&(this.wrapperEl.style[S]=E),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(S){var E=this._activeObject,M=this.backgroundImage,T=this.overlayImage,D,N,I;for(this.viewportTransform=S,N=0,I=this._objects.length;N<I;N++)D=this._objects[N],D.group||D.setCoords(!0);return E&&E.setCoords(),M&&M.setCoords(!0),T&&T.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(S,E){var M=S,T=this.viewportTransform.slice(0);S=f(S,y(this.viewportTransform)),T[0]=E,T[3]=E;var D=f(S,T);return T[4]+=M.x-D.x,T[5]+=M.y-D.y,this.setViewportTransform(T)},setZoom:function(S){return this.zoomToPoint(new n.Point(0,0),S),this},absolutePan:function(S){var E=this.viewportTransform.slice(0);return E[4]=-S.x,E[5]=-S.y,this.setViewportTransform(E)},relativePan:function(S){return this.absolutePan(new n.Point(-S.x-this.viewportTransform[4],-S.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(S){this.stateful&&S.setupState(),S._set("canvas",this),S.setCoords(),this.fire("object:added",{target:S}),S.fire("added")},_onObjectRemoved:function(S){this.fire("object:removed",{target:S}),S.fire("removed"),delete S.canvas},clearContext:function(S){return S.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var S=this.contextContainer;return this.renderCanvas(S,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=n.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var S={},E=this.width,M=this.height,T=y(this.viewportTransform);return S.tl=f({x:0,y:0},T),S.br=f({x:E,y:M},T),S.tr=new n.Point(S.br.x,S.tl.y),S.bl=new n.Point(S.tl.x,S.br.y),this.vptCoords=S,S},cancelRequestedRender:function(){this.isRendering&&(n.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(S,E){var M=this.viewportTransform,T=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(S),n.util.setImageSmoothing(S,this.imageSmoothingEnabled),this.fire("before:render",{ctx:S}),this._renderBackground(S),S.save(),S.transform(M[0],M[1],M[2],M[3],M[4],M[5]),this._renderObjects(S,E),S.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(S),T&&(T.canvas=this,T.shouldCache(),T._transformDone=!0,T.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(S)),this._renderOverlay(S),this.controlsAboveOverlay&&this.interactive&&this.drawControls(S),this.fire("after:render",{ctx:S})},drawClipPathOnCanvas:function(S){var E=this.viewportTransform,M=this.clipPath;S.save(),S.transform(E[0],E[1],E[2],E[3],E[4],E[5]),S.globalCompositeOperation="destination-in",M.transform(S),S.scale(1/M.zoomX,1/M.zoomY),S.drawImage(M._cacheCanvas,-M.cacheTranslationX,-M.cacheTranslationY),S.restore()},_renderObjects:function(S,E){var M,T;for(M=0,T=E.length;M<T;++M)E[M]&&E[M].render(S)},_renderBackgroundOrOverlay:function(S,E){var M=this[E+"Color"],T=this[E+"Image"],D=this.viewportTransform,N=this[E+"Vpt"];if(!(!M&&!T)){if(M){S.save(),S.beginPath(),S.moveTo(0,0),S.lineTo(this.width,0),S.lineTo(this.width,this.height),S.lineTo(0,this.height),S.closePath(),S.fillStyle=M.toLive?M.toLive(S,this):M,N&&S.transform(D[0],D[1],D[2],D[3],D[4],D[5]),S.transform(1,0,0,1,M.offsetX||0,M.offsetY||0);var I=M.gradientTransform||M.patternTransform;I&&S.transform(I[0],I[1],I[2],I[3],I[4],I[5]),S.fill(),S.restore()}if(T){S.save();var O=this.skipOffscreen;this.skipOffscreen=N,N&&S.transform(D[0],D[1],D[2],D[3],D[4],D[5]),T.render(S),this.skipOffscreen=O,S.restore()}}},_renderBackground:function(S){this._renderBackgroundOrOverlay(S,"background")},_renderOverlay:function(S){this._renderBackgroundOrOverlay(S,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new n.Point(this.width/2,this.height/2)},centerObjectH:function(S){return this._centerObject(S,new n.Point(this.getCenterPoint().x,S.getCenterPoint().y))},centerObjectV:function(S){return this._centerObject(S,new n.Point(S.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(S){var E=this.getCenterPoint();return this._centerObject(S,E)},viewportCenterObject:function(S){var E=this.getVpCenter();return this._centerObject(S,E)},viewportCenterObjectH:function(S){var E=this.getVpCenter();return this._centerObject(S,new n.Point(E.x,S.getCenterPoint().y)),this},viewportCenterObjectV:function(S){var E=this.getVpCenter();return this._centerObject(S,new n.Point(S.getCenterPoint().x,E.y))},getVpCenter:function(){var S=this.getCenterPoint(),E=y(this.viewportTransform);return f(S,E)},_centerObject:function(S,E){return S.setPositionByOrigin(E,"center","center"),S.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(S){return this.toDatalessObject(S)},toObject:function(S){return this._toObjectMethod("toObject",S)},toDatalessObject:function(S){return this._toObjectMethod("toDatalessObject",S)},_toObjectMethod:function(S,E){var M=this.clipPath,T={version:n.version,objects:this._toObjects(S,E)};return M&&!M.excludeFromExport&&(T.clipPath=this._toObject(this.clipPath,S,E)),m(T,this.__serializeBgOverlay(S,E)),n.util.populateWithProperties(this,T,E),T},_toObjects:function(S,E){return this._objects.filter(function(M){return!M.excludeFromExport}).map(function(M){return this._toObject(M,S,E)},this)},_toObject:function(S,E,M){var T;this.includeDefaultValues||(T=S.includeDefaultValues,S.includeDefaultValues=!1);var D=S[E](M);return this.includeDefaultValues||(S.includeDefaultValues=T),D},__serializeBgOverlay:function(S,E){var M={},T=this.backgroundImage,D=this.overlayImage,N=this.backgroundColor,I=this.overlayColor;return N&&N.toObject?N.excludeFromExport||(M.background=N.toObject(E)):N&&(M.background=N),I&&I.toObject?I.excludeFromExport||(M.overlay=I.toObject(E)):I&&(M.overlay=I),T&&!T.excludeFromExport&&(M.backgroundImage=this._toObject(T,S,E)),D&&!D.excludeFromExport&&(M.overlayImage=this._toObject(D,S,E)),M},svgViewportTransformation:!0,toSVG:function(S,E){S||(S={}),S.reviver=E;var M=[];return this._setSVGPreamble(M,S),this._setSVGHeader(M,S),this.clipPath&&M.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(M,"background"),this._setSVGBgOverlayImage(M,"backgroundImage",E),this._setSVGObjects(M,E),this.clipPath&&M.push(`</g>
`),this._setSVGBgOverlayColor(M,"overlay"),this._setSVGBgOverlayImage(M,"overlayImage",E),M.push("</svg>"),M.join("")},_setSVGPreamble:function(S,E){E.suppressPreamble||S.push('<?xml version="1.0" encoding="',E.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(S,E){var M=E.width||this.width,T=E.height||this.height,D,N='viewBox="0 0 '+this.width+" "+this.height+'" ',I=n.Object.NUM_FRACTION_DIGITS;E.viewBox?N='viewBox="'+E.viewBox.x+" "+E.viewBox.y+" "+E.viewBox.width+" "+E.viewBox.height+'" ':this.svgViewportTransformation&&(D=this.viewportTransform,N='viewBox="'+d(-D[4]/D[0],I)+" "+d(-D[5]/D[3],I)+" "+d(this.width/D[0],I)+" "+d(this.height/D[3],I)+'" '),S.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',M,'" ','height="',T,'" ',N,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",n.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(E),`</defs>
`)},createSVGClipPathMarkup:function(S){var E=this.clipPath;return E?(E.clipPathId="CLIPPATH_"+n.Object.__uid++,'<clipPath id="'+E.clipPathId+`" >
`+this.clipPath.toClipPathSVG(S.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var S=this,E=["background","overlay"].map(function(M){var T=S[M+"Color"];if(T&&T.toLive){var D=S[M+"Vpt"],N=S.viewportTransform,I={width:S.width/(D?N[0]:1),height:S.height/(D?N[3]:1)};return T.toSVG(I,{additionalTransform:D?n.util.matrixToSVG(N):""})}});return E.join("")},createSVGFontFacesMarkup:function(){var S="",E={},M,T,D,N,I,O,F,q,Y,_e=n.fontPaths,ne=[];for(this._objects.forEach(function J(fe){ne.push(fe),fe._objects&&fe._objects.forEach(J)}),q=0,Y=ne.length;q<Y;q++)if(M=ne[q],T=M.fontFamily,!(M.type.indexOf("text")===-1||E[T]||!_e[T])&&(E[T]=!0,!!M.styles)){D=M.styles;for(I in D){N=D[I];for(F in N)O=N[F],T=O.fontFamily,!E[T]&&_e[T]&&(E[T]=!0)}}for(var ve in E)S+=[`		@font-face {
`,"			font-family: '",ve,`';
`,"			src: url('",_e[ve],`');
`,`		}
`].join("");return S&&(S=['	<style type="text/css">',`<![CDATA[
`,S,"]]>",`</style>
`].join("")),S},_setSVGObjects:function(S,E){var M,T,D,N=this._objects;for(T=0,D=N.length;T<D;T++)M=N[T],!M.excludeFromExport&&this._setSVGObject(S,M,E)},_setSVGObject:function(S,E,M){S.push(E.toSVG(M))},_setSVGBgOverlayImage:function(S,E,M){this[E]&&!this[E].excludeFromExport&&this[E].toSVG&&S.push(this[E].toSVG(M))},_setSVGBgOverlayColor:function(S,E){var M=this[E+"Color"],T=this.viewportTransform,D=this.width,N=this.height;if(!!M)if(M.toLive){var I=M.repeat,O=n.util.invertTransform(T),F=this[E+"Vpt"],q=F?n.util.matrixToSVG(O):"";S.push('<rect transform="'+q+" translate(",D/2,",",N/2,')"',' x="',M.offsetX-D/2,'" y="',M.offsetY-N/2,'" ','width="',I==="repeat-y"||I==="no-repeat"?M.source.width:D,'" height="',I==="repeat-x"||I==="no-repeat"?M.source.height:N,'" fill="url(#SVGID_'+M.id+')"',`></rect>
`)}else S.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',M,'"',`></rect>
`)},sendToBack:function(S){if(!S)return this;var E=this._activeObject,M,T,D;if(S===E&&S.type==="activeSelection")for(D=E._objects,M=D.length;M--;)T=D[M],g(this._objects,T),this._objects.unshift(T);else g(this._objects,S),this._objects.unshift(S);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(S){if(!S)return this;var E=this._activeObject,M,T,D;if(S===E&&S.type==="activeSelection")for(D=E._objects,M=0;M<D.length;M++)T=D[M],g(this._objects,T),this._objects.push(T);else g(this._objects,S),this._objects.push(S);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(S,E){if(!S)return this;var M=this._activeObject,T,D,N,I,O,F=0;if(S===M&&S.type==="activeSelection")for(O=M._objects,T=0;T<O.length;T++)D=O[T],N=this._objects.indexOf(D),N>0+F&&(I=N-1,g(this._objects,D),this._objects.splice(I,0,D)),F++;else N=this._objects.indexOf(S),N!==0&&(I=this._findNewLowerIndex(S,N,E),g(this._objects,S),this._objects.splice(I,0,S));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(S,E,M){var T,D;if(M)for(T=E,D=E-1;D>=0;--D){var N=S.intersectsWithObject(this._objects[D])||S.isContainedWithinObject(this._objects[D])||this._objects[D].isContainedWithinObject(S);if(N){T=D;break}}else T=E-1;return T},bringForward:function(S,E){if(!S)return this;var M=this._activeObject,T,D,N,I,O,F=0;if(S===M&&S.type==="activeSelection")for(O=M._objects,T=O.length;T--;)D=O[T],N=this._objects.indexOf(D),N<this._objects.length-1-F&&(I=N+1,g(this._objects,D),this._objects.splice(I,0,D)),F++;else N=this._objects.indexOf(S),N!==this._objects.length-1&&(I=this._findNewUpperIndex(S,N,E),g(this._objects,S),this._objects.splice(I,0,S));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(S,E,M){var T,D,N;if(M)for(T=E,D=E+1,N=this._objects.length;D<N;++D){var I=S.intersectsWithObject(this._objects[D])||S.isContainedWithinObject(this._objects[D])||this._objects[D].isContainedWithinObject(S);if(I){T=D;break}}else T=E+1;return T},moveTo:function(S,E){return g(this._objects,S),this._objects.splice(E,0,S),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(n.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(S){S.dispose&&S.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),n.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),n.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),m(n.StaticCanvas.prototype,n.Observable),m(n.StaticCanvas.prototype,n.Collection),m(n.StaticCanvas.prototype,n.DataURLExporter),m(n.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(S){var E=k();if(!E||!E.getContext)return null;var M=E.getContext("2d");if(!M)return null;switch(S){case"setLineDash":return typeof M.setLineDash<"u";default:return null}}}),n.StaticCanvas.prototype.toJSON=n.StaticCanvas.prototype.toObject,n.isLikelyNode&&(n.StaticCanvas.prototype.createPNGStream=function(){var S=x(this.lowerCanvasEl);return S&&S.createPNGStream()},n.StaticCanvas.prototype.createJPEGStream=function(S){var E=x(this.lowerCanvasEl);return E&&E.createJPEGStream(S)})}(),n.BaseBrush=n.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(m){m.strokeStyle=this.color,m.lineWidth=this.width,m.lineCap=this.strokeLineCap,m.miterLimit=this.strokeMiterLimit,m.lineJoin=this.strokeLineJoin,m.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(m){var v=this.canvas.viewportTransform;m.save(),m.transform(v[0],v[1],v[2],v[3],v[4],v[5])},_setShadow:function(){if(!!this.shadow){var m=this.canvas,v=this.shadow,g=m.contextTop,d=m.getZoom();m&&m._isRetinaScaling()&&(d*=n.devicePixelRatio),g.shadowColor=v.color,g.shadowBlur=v.blur*d,g.shadowOffsetX=v.offsetX*d,g.shadowOffsetY=v.offsetY*d}},needsFullRender:function(){var m=new n.Color(this.color);return m.getAlpha()<1||!!this.shadow},_resetShadow:function(){var m=this.canvas.contextTop;m.shadowColor="",m.shadowBlur=m.shadowOffsetX=m.shadowOffsetY=0},_isOutSideCanvas:function(m){return m.x<0||m.x>this.canvas.getWidth()||m.y<0||m.y>this.canvas.getHeight()}}),function(){n.PencilBrush=n.util.createClass(n.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(m){this.canvas=m,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(m,v,g){var d=v.midPointFrom(g);return m.quadraticCurveTo(v.x,v.y,d.x,d.y),d},onMouseDown:function(m,v){!this.canvas._isMainEvent(v.e)||(this.drawStraightLine=v.e[this.straightLineKey],this._prepareForDrawing(m),this._captureDrawingPath(m),this._render())},onMouseMove:function(m,v){if(!!this.canvas._isMainEvent(v.e)&&(this.drawStraightLine=v.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m))&&this._captureDrawingPath(m)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var g=this._points,d=g.length,f=this.canvas.contextTop;this._saveAndTransform(f),this.oldEnd&&(f.beginPath(),f.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(f,g[d-2],g[d-1],!0),f.stroke(),f.restore()}},onMouseUp:function(m){return this.canvas._isMainEvent(m.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(m){var v=new n.Point(m.x,m.y);this._reset(),this._addPoint(v),this.canvas.contextTop.moveTo(v.x,v.y)},_addPoint:function(m){return this._points.length>1&&m.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(m),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(m){var v=new n.Point(m.x,m.y);return this._addPoint(v)},_render:function(m){var v,g,d=this._points[0],f=this._points[1];if(m=m||this.canvas.contextTop,this._saveAndTransform(m),m.beginPath(),this._points.length===2&&d.x===f.x&&d.y===f.y){var y=this.width/1e3;d=new n.Point(d.x,d.y),f=new n.Point(f.x,f.y),d.x-=y,f.x+=y}for(m.moveTo(d.x,d.y),v=1,g=this._points.length;v<g;v++)this._drawSegment(m,d,f),d=this._points[v],f=this._points[v+1];m.lineTo(d.x,d.y),m.stroke(),m.restore()},convertPointsToSVGPath:function(m){var v=this.width/1e3;return n.util.getSmoothPathFromPoints(m,v)},_isEmptySVGPath:function(m){var v=n.util.joinPath(m);return v==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(m){var v=new n.Path(m,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,v.shadow=new n.Shadow(this.shadow)),v},decimatePoints:function(m,v){if(m.length<=2)return m;var g=this.canvas.getZoom(),d=Math.pow(v/g,2),f,y=m.length-1,x=m[0],k=[x],P;for(f=1;f<y-1;f++)P=Math.pow(x.x-m[f].x,2)+Math.pow(x.y-m[f].y,2),P>=d&&(x=m[f],k.push(x));return k.push(m[y]),k},_finalizeAndAddPath:function(){var m=this.canvas.contextTop;m.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var v=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(v)){this.canvas.requestRenderAll();return}var g=this.createPath(v);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:g}),this.canvas.add(g),this.canvas.requestRenderAll(),g.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:g})}})}(),n.CircleBrush=n.util.createClass(n.BaseBrush,{width:10,initialize:function(m){this.canvas=m,this.points=[]},drawDot:function(m){var v=this.addPoint(m),g=this.canvas.contextTop;this._saveAndTransform(g),this.dot(g,v),g.restore()},dot:function(m,v){m.fillStyle=v.fill,m.beginPath(),m.arc(v.x,v.y,v.radius,0,Math.PI*2,!1),m.closePath(),m.fill()},onMouseDown:function(m){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(m)},_render:function(){var m=this.canvas.contextTop,v,g,d=this.points;for(this._saveAndTransform(m),v=0,g=d.length;v<g;v++)this.dot(m,d[v]);m.restore()},onMouseMove:function(m){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(m),this._render()):this.drawDot(m))},onMouseUp:function(){var m=this.canvas.renderOnAddRemove,v,g;this.canvas.renderOnAddRemove=!1;var d=[];for(v=0,g=this.points.length;v<g;v++){var f=this.points[v],y=new n.Circle({radius:f.radius,left:f.x,top:f.y,originX:"center",originY:"center",fill:f.fill});this.shadow&&(y.shadow=new n.Shadow(this.shadow)),d.push(y)}var x=new n.Group(d);x.canvas=this.canvas,this.canvas.fire("before:path:created",{path:x}),this.canvas.add(x),this.canvas.fire("path:created",{path:x}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=m,this.canvas.requestRenderAll()},addPoint:function(m){var v=new n.Point(m.x,m.y),g=n.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new n.Color(this.color).setAlpha(n.util.getRandomInt(0,100)/100).toRgba();return v.radius=g,v.fill=d,this.points.push(v),v}}),n.SprayBrush=n.util.createClass(n.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(m){this.canvas=m,this.sprayChunks=[]},onMouseDown:function(m){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(m),this.render(this.sprayChunkPoints)},onMouseMove:function(m){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m)||(this.addSprayChunk(m),this.render(this.sprayChunkPoints))},onMouseUp:function(){var m=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var v=[],g=0,d=this.sprayChunks.length;g<d;g++)for(var f=this.sprayChunks[g],y=0,x=f.length;y<x;y++){var k=new n.Rect({width:f[y].width,height:f[y].width,left:f[y].x+1,top:f[y].y+1,originX:"center",originY:"center",fill:this.color});v.push(k)}this.optimizeOverlapping&&(v=this._getOptimizedRects(v));var P=new n.Group(v);this.shadow&&P.set("shadow",new n.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:P}),this.canvas.add(P),this.canvas.fire("path:created",{path:P}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=m,this.canvas.requestRenderAll()},_getOptimizedRects:function(m){var v={},g,d,f;for(d=0,f=m.length;d<f;d++)g=m[d].left+""+m[d].top,v[g]||(v[g]=m[d]);var y=[];for(g in v)y.push(v[g]);return y},render:function(m){var v=this.canvas.contextTop,g,d;for(v.fillStyle=this.color,this._saveAndTransform(v),g=0,d=m.length;g<d;g++){var f=m[g];typeof f.opacity<"u"&&(v.globalAlpha=f.opacity),v.fillRect(f.x,f.y,f.width,f.width)}v.restore()},_render:function(){var m=this.canvas.contextTop,v,g;for(m.fillStyle=this.color,this._saveAndTransform(m),v=0,g=this.sprayChunks.length;v<g;v++)this.render(this.sprayChunks[v]);m.restore()},addSprayChunk:function(m){this.sprayChunkPoints=[];var v,g,d,f=this.width/2,y;for(y=0;y<this.density;y++){v=n.util.getRandomInt(m.x-f,m.x+f),g=n.util.getRandomInt(m.y-f,m.y+f),this.dotWidthVariance?d=n.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var x=new n.Point(v,g);x.width=d,this.randomOpacity&&(x.opacity=n.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(x)}this.sprayChunks.push(this.sprayChunkPoints)}}),n.PatternBrush=n.util.createClass(n.PencilBrush,{getPatternSrc:function(){var m=20,v=5,g=n.util.createCanvasElement(),d=g.getContext("2d");return g.width=g.height=m+v,d.fillStyle=this.color,d.beginPath(),d.arc(m/2,m/2,m/2,0,Math.PI*2,!1),d.closePath(),d.fill(),g},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(m){return m.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(m){this.callSuper("_setBrushStyles",m),m.strokeStyle=this.getPattern(m)},createPath:function(m){var v=this.callSuper("createPath",m),g=v._getLeftTopCoords().scalarAdd(v.strokeWidth/2);return v.stroke=new n.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-g.x,offsetY:-g.y}),v}}),function(){var m=n.util.getPointer,v=n.util.degreesToRadians,g=n.util.isTouchEvent;n.Canvas=n.util.createClass(n.StaticCanvas,{initialize:function(f,y){y||(y={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(f,y),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=n.PencilBrush&&new n.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var f=this.getActiveObjects(),y,x,k;if(f.length>0&&!this.preserveObjectStacking){x=[],k=[];for(var P=0,S=this._objects.length;P<S;P++)y=this._objects[P],f.indexOf(y)===-1?x.push(y):k.push(y);f.length>1&&(this._activeObject._objects=k),x.push.apply(x,k)}else x=this._objects;return x},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var f=this.contextContainer;return this.renderCanvas(f,this._chooseObjectsToRender()),this},renderTopLayer:function(f){f.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(f),this.contextTopDirty=!0),f.restore()},renderTop:function(){var f=this.contextTop;return this.clearContext(f),this.renderTopLayer(f),this.fire("after:render"),this},_normalizePointer:function(f,y){var x=f.calcTransformMatrix(),k=n.util.invertTransform(x),P=this.restorePointerVpt(y);return n.util.transformPoint(P,k)},isTargetTransparent:function(f,y,x){if(f.shouldCache()&&f._cacheCanvas&&f!==this._activeObject){var k=this._normalizePointer(f,{x:y,y:x}),P=Math.max(f.cacheTranslationX+k.x*f.zoomX,0),S=Math.max(f.cacheTranslationY+k.y*f.zoomY,0),D=n.util.isTransparent(f._cacheContext,Math.round(P),Math.round(S),this.targetFindTolerance);return D}var E=this.contextCache,M=f.selectionBackgroundColor,T=this.viewportTransform;f.selectionBackgroundColor="",this.clearContext(E),E.save(),E.transform(T[0],T[1],T[2],T[3],T[4],T[5]),f.render(E),E.restore(),f.selectionBackgroundColor=M;var D=n.util.isTransparent(E,y,x,this.targetFindTolerance);return D},_isSelectionKeyPressed:function(f){var y=!1;return Array.isArray(this.selectionKey)?y=!!this.selectionKey.find(function(x){return f[x]===!0}):y=f[this.selectionKey],y},_shouldClearSelection:function(f,y){var x=this.getActiveObjects(),k=this._activeObject;return!y||y&&k&&x.length>1&&x.indexOf(y)===-1&&k!==y&&!this._isSelectionKeyPressed(f)||y&&!y.evented||y&&!y.selectable&&k&&k!==y},_shouldCenterTransform:function(f,y,x){if(!!f){var k;return y==="scale"||y==="scaleX"||y==="scaleY"||y==="resizing"?k=this.centeredScaling||f.centeredScaling:y==="rotate"&&(k=this.centeredRotation||f.centeredRotation),k?!x:x}},_getOriginFromCorner:function(f,y){var x={x:f.originX,y:f.originY};return y==="ml"||y==="tl"||y==="bl"?x.x="right":(y==="mr"||y==="tr"||y==="br")&&(x.x="left"),y==="tl"||y==="mt"||y==="tr"?x.y="bottom":(y==="bl"||y==="mb"||y==="br")&&(x.y="top"),x},_getActionFromCorner:function(f,y,x,k){if(!y||!f)return"drag";var P=k.controls[y];return P.getActionName(x,P,k)},_setupCurrentTransform:function(f,y,x){if(!!y){var k=this.getPointer(f),P=y.__corner,S=y.controls[P],E=x&&P?S.getActionHandler(f,y,S):n.controlsUtils.dragHandler,M=this._getActionFromCorner(x,P,f,y),T=this._getOriginFromCorner(y,P),D=f[this.centeredKey],N={target:y,action:M,actionHandler:E,corner:P,scaleX:y.scaleX,scaleY:y.scaleY,skewX:y.skewX,skewY:y.skewY,offsetX:k.x-y.left,offsetY:k.y-y.top,originX:T.x,originY:T.y,ex:k.x,ey:k.y,lastX:k.x,lastY:k.y,theta:v(y.angle),width:y.width*y.scaleX,shiftKey:f.shiftKey,altKey:D,original:n.util.saveObjectTransform(y)};this._shouldCenterTransform(y,M,D)&&(N.originX="center",N.originY="center"),N.original.originX=T.x,N.original.originY=T.y,this._currentTransform=N,this._beforeTransform(f)}},setCursor:function(f){this.upperCanvasEl.style.cursor=f},_drawSelection:function(f){var y=this._groupSelector,x=new n.Point(y.ex,y.ey),k=n.util.transformPoint(x,this.viewportTransform),P=new n.Point(y.ex+y.left,y.ey+y.top),S=n.util.transformPoint(P,this.viewportTransform),E=Math.min(k.x,S.x),M=Math.min(k.y,S.y),T=Math.max(k.x,S.x),D=Math.max(k.y,S.y),N=this.selectionLineWidth/2;this.selectionColor&&(f.fillStyle=this.selectionColor,f.fillRect(E,M,T-E,D-M)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(f.lineWidth=this.selectionLineWidth,f.strokeStyle=this.selectionBorderColor,E+=N,M+=N,T-=N,D-=N,n.Object.prototype._setLineDash.call(this,f,this.selectionDashArray),f.strokeRect(E,M,T-E,D-M))},findTarget:function(f,y){if(!this.skipTargetFind){var x=!0,k=this.getPointer(f,x),P=this._activeObject,S=this.getActiveObjects(),E,M,T=g(f),D=S.length>1&&!y||S.length===1;if(this.targets=[],D&&P._findTargetCorner(k,T)||S.length>1&&!y&&P===this._searchPossibleTargets([P],k))return P;if(S.length===1&&P===this._searchPossibleTargets([P],k))if(this.preserveObjectStacking)E=P,M=this.targets,this.targets=[];else return P;var N=this._searchPossibleTargets(this._objects,k);return f[this.altSelectionKey]&&N&&E&&N!==E&&(N=E,this.targets=M),N}},_checkTarget:function(f,y,x){if(y&&y.visible&&y.evented&&y.containsPoint(f))if((this.perPixelTargetFind||y.perPixelTargetFind)&&!y.isEditing){var k=this.isTargetTransparent(y,x.x,x.y);if(!k)return!0}else return!0},_searchPossibleTargets:function(f,y){for(var x,k=f.length,P;k--;){var S=f[k],E=S.group?this._normalizePointer(S.group,y):y;if(this._checkTarget(E,S,y)){x=f[k],x.subTargetCheck&&x instanceof n.Group&&(P=this._searchPossibleTargets(x._objects,y),P&&this.targets.push(P));break}}return x},restorePointerVpt:function(f){return n.util.transformPoint(f,n.util.invertTransform(this.viewportTransform))},getPointer:function(f,y){if(this._absolutePointer&&!y)return this._absolutePointer;if(this._pointer&&y)return this._pointer;var x=m(f),k=this.upperCanvasEl,P=k.getBoundingClientRect(),S=P.width||0,E=P.height||0,M;(!S||!E)&&("top"in P&&"bottom"in P&&(E=Math.abs(P.top-P.bottom)),"right"in P&&"left"in P&&(S=Math.abs(P.right-P.left))),this.calcOffset(),x.x=x.x-this._offset.left,x.y=x.y-this._offset.top,y||(x=this.restorePointerVpt(x));var T=this.getRetinaScaling();return T!==1&&(x.x/=T,x.y/=T),S===0||E===0?M={width:1,height:1}:M={width:k.width/S,height:k.height/E},{x:x.x*M.width,y:x.y*M.height}},_createUpperCanvas:function(){var f=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),y=this.lowerCanvasEl,x=this.upperCanvasEl;x?x.className="":(x=this._createCanvasElement(),this.upperCanvasEl=x),n.util.addClass(x,"upper-canvas "+f),this.wrapperEl.appendChild(x),this._copyCanvasStyle(y,x),this._applyCanvasStyle(x),this.contextTop=x.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=n.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),n.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),n.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(f){var y=this.width||f.width,x=this.height||f.height;n.util.setStyle(f,{position:"absolute",width:y+"px",height:x+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),f.width=y,f.height=x,n.util.makeElementUnselectable(f)},_copyCanvasStyle:function(f,y){y.style.cssText=f.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var f=this._activeObject;return f?f.type==="activeSelection"&&f._objects?f._objects.slice(0):[f]:[]},_onObjectRemoved:function(f){f===this._activeObject&&(this.fire("before:selection:cleared",{target:f}),this._discardActiveObject(),this.fire("selection:cleared",{target:f}),f.fire("deselected")),f===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",f)},_fireSelectionEvents:function(f,y){var x=!1,k=this.getActiveObjects(),P=[],S=[];f.forEach(function(E){k.indexOf(E)===-1&&(x=!0,E.fire("deselected",{e:y,target:E}),S.push(E))}),k.forEach(function(E){f.indexOf(E)===-1&&(x=!0,E.fire("selected",{e:y,target:E}),P.push(E))}),f.length>0&&k.length>0?x&&this.fire("selection:updated",{e:y,selected:P,deselected:S}):k.length>0?this.fire("selection:created",{e:y,selected:P}):f.length>0&&this.fire("selection:cleared",{e:y,deselected:S})},setActiveObject:function(f,y){var x=this.getActiveObjects();return this._setActiveObject(f,y),this._fireSelectionEvents(x,y),this},_setActiveObject:function(f,y){return this._activeObject===f||!this._discardActiveObject(y,f)||f.onSelect({e:y})?!1:(this._activeObject=f,!0)},_discardActiveObject:function(f,y){var x=this._activeObject;if(x){if(x.onDeselect({e:f,object:y}))return!1;this._activeObject=null}return!0},discardActiveObject:function(f){var y=this.getActiveObjects(),x=this.getActiveObject();return y.length&&this.fire("before:selection:cleared",{target:x,e:f}),this._discardActiveObject(f),this._fireSelectionEvents(y,f),this},dispose:function(){var f=this.wrapperEl;return this.removeListeners(),f.removeChild(this.upperCanvasEl),f.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(y){n.util.cleanUpJsdomNode(this[y]),this[y]=void 0}.bind(this)),f.parentNode&&f.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,n.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(f){var y=this._activeObject;y&&y._renderControls(f)},_toObject:function(f,y,x){var k=this._realizeGroupTransformOnObject(f),P=this.callSuper("_toObject",f,y,x);return this._unwindGroupTransformOnObject(f,k),P},_realizeGroupTransformOnObject:function(f){if(f.group&&f.group.type==="activeSelection"&&this._activeObject===f.group){var y=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],x={};return y.forEach(function(k){x[k]=f[k]}),n.util.addTransformToObject(f,this._activeObject.calcOwnMatrix()),x}else return null},_unwindGroupTransformOnObject:function(f,y){y&&f.set(y)},_setSVGObject:function(f,y,x){var k=this._realizeGroupTransformOnObject(y);this.callSuper("_setSVGObject",f,y,x),this._unwindGroupTransformOnObject(y,k)},setViewportTransform:function(f){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),n.StaticCanvas.prototype.setViewportTransform.call(this,f)}});for(var d in n.StaticCanvas)d!=="prototype"&&(n.Canvas[d]=n.StaticCanvas[d])}(),function(){var m=n.util.addListener,v=n.util.removeListener,g=3,d=2,f=1,y={passive:!1};function x(k,P){return k.button&&k.button===P-1}n.util.object.extend(n.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(m,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(k,P){var S=this.upperCanvasEl,E=this._getEventPrefix();k(n.window,"resize",this._onResize),k(S,E+"down",this._onMouseDown),k(S,E+"move",this._onMouseMove,y),k(S,E+"out",this._onMouseOut),k(S,E+"enter",this._onMouseEnter),k(S,"wheel",this._onMouseWheel),k(S,"contextmenu",this._onContextMenu),k(S,"dblclick",this._onDoubleClick),k(S,"dragover",this._onDragOver),k(S,"dragenter",this._onDragEnter),k(S,"dragleave",this._onDragLeave),k(S,"drop",this._onDrop),this.enablePointerEvents||k(S,"touchstart",this._onTouchStart,y),typeof eventjs<"u"&&P in eventjs&&(eventjs[P](S,"gesture",this._onGesture),eventjs[P](S,"drag",this._onDrag),eventjs[P](S,"orientation",this._onOrientationChange),eventjs[P](S,"shake",this._onShake),eventjs[P](S,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(v,"remove");var k=this._getEventPrefix();v(n.document,k+"up",this._onMouseUp),v(n.document,"touchend",this._onTouchEnd,y),v(n.document,k+"move",this._onMouseMove,y),v(n.document,"touchmove",this._onMouseMove,y)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(k,P){this.__onTransformGesture&&this.__onTransformGesture(k,P)},_onDrag:function(k,P){this.__onDrag&&this.__onDrag(k,P)},_onMouseWheel:function(k){this.__onMouseWheel(k)},_onMouseOut:function(k){var P=this._hoveredTarget;this.fire("mouse:out",{target:P,e:k}),this._hoveredTarget=null,P&&P.fire("mouseout",{e:k});var S=this;this._hoveredTargets.forEach(function(E){S.fire("mouse:out",{target:E,e:k}),E&&E.fire("mouseout",{e:k})}),this._hoveredTargets=[]},_onMouseEnter:function(k){!this._currentTransform&&!this.findTarget(k)&&(this.fire("mouse:over",{target:null,e:k}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(k,P){this.__onOrientationChange&&this.__onOrientationChange(k,P)},_onShake:function(k,P){this.__onShake&&this.__onShake(k,P)},_onLongPress:function(k,P){this.__onLongPress&&this.__onLongPress(k,P)},_onDragOver:function(k){k.preventDefault();var P=this._simpleEventHandler("dragover",k);this._fireEnterLeaveEvents(P,k)},_onDrop:function(k){return this._simpleEventHandler("drop:before",k),this._simpleEventHandler("drop",k)},_onContextMenu:function(k){return this.stopContextMenu&&(k.stopPropagation(),k.preventDefault()),!1},_onDoubleClick:function(k){this._cacheTransformEventData(k),this._handleEvent(k,"dblclick"),this._resetTransformEventData(k)},getPointerId:function(k){var P=k.changedTouches;return P?P[0]&&P[0].identifier:this.enablePointerEvents?k.pointerId:-1},_isMainEvent:function(k){return k.isPrimary===!0?!0:k.isPrimary===!1?!1:k.type==="touchend"&&k.touches.length===0?!0:k.changedTouches?k.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(k){k.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(k)),this.__onMouseDown(k),this._resetTransformEventData();var P=this.upperCanvasEl,S=this._getEventPrefix();m(n.document,"touchend",this._onTouchEnd,y),m(n.document,"touchmove",this._onMouseMove,y),v(P,S+"down",this._onMouseDown)},_onMouseDown:function(k){this.__onMouseDown(k),this._resetTransformEventData();var P=this.upperCanvasEl,S=this._getEventPrefix();v(P,S+"move",this._onMouseMove,y),m(n.document,S+"up",this._onMouseUp),m(n.document,S+"move",this._onMouseMove,y)},_onTouchEnd:function(k){if(!(k.touches.length>0)){this.__onMouseUp(k),this._resetTransformEventData(),this.mainTouchId=null;var P=this._getEventPrefix();v(n.document,"touchend",this._onTouchEnd,y),v(n.document,"touchmove",this._onMouseMove,y);var S=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){m(S.upperCanvasEl,P+"down",S._onMouseDown),S._willAddMouseDown=0},400)}},_onMouseUp:function(k){this.__onMouseUp(k),this._resetTransformEventData();var P=this.upperCanvasEl,S=this._getEventPrefix();this._isMainEvent(k)&&(v(n.document,S+"up",this._onMouseUp),v(n.document,S+"move",this._onMouseMove,y),m(P,S+"move",this._onMouseMove,y))},_onMouseMove:function(k){!this.allowTouchScrolling&&k.preventDefault&&k.preventDefault(),this.__onMouseMove(k)},_onResize:function(){this.calcOffset()},_shouldRender:function(k){var P=this._activeObject;return!!P!=!!k||P&&k&&P!==k?!0:(P&&P.isEditing,!1)},__onMouseUp:function(k){var P,S=this._currentTransform,E=this._groupSelector,M=!1,T=!E||E.left===0&&E.top===0;if(this._cacheTransformEventData(k),P=this._target,this._handleEvent(k,"up:before"),x(k,g)){this.fireRightClick&&this._handleEvent(k,"up",g,T);return}if(x(k,d)){this.fireMiddleClick&&this._handleEvent(k,"up",d,T),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(k);return}if(!!this._isMainEvent(k)){if(S&&(this._finalizeCurrentTransform(k),M=S.actionPerformed),!T){var D=P===this._activeObject;this._maybeGroupObjects(k),M||(M=this._shouldRender(P)||!D&&P===this._activeObject)}var N,I;if(P){if(N=P._findTargetCorner(this.getPointer(k,!0),n.util.isTouchEvent(k)),P.selectable&&P!==this._activeObject&&P.activeOn==="up")this.setActiveObject(P,k),M=!0;else{var O=P.controls[N],F=O&&O.getMouseUpHandler(k,P,O);F&&(I=this.getPointer(k),F(k,S,I.x,I.y))}P.isMoving=!1}if(S&&(S.target!==P||S.corner!==N)){var q=S.target&&S.target.controls[S.corner],Y=q&&q.getMouseUpHandler(k,P,O);I=I||this.getPointer(k),Y&&Y(k,S,I.x,I.y)}this._setCursorFromEvent(k,P),this._handleEvent(k,"up",f,T),this._groupSelector=null,this._currentTransform=null,P&&(P.__corner=0),M?this.requestRenderAll():T||this.renderTop()}},_simpleEventHandler:function(k,P){var S=this.findTarget(P),E=this.targets,M={e:P,target:S,subTargets:E};if(this.fire(k,M),S&&S.fire(k,M),!E)return S;for(var T=0;T<E.length;T++)E[T].fire(k,M);return S},_handleEvent:function(k,P,S,E){var M=this._target,T=this.targets||[],D={e:k,target:M,subTargets:T,button:S||f,isClick:E||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};P==="up"&&(D.currentTarget=this.findTarget(k),D.currentSubTargets=this.targets),this.fire("mouse:"+P,D),M&&M.fire("mouse"+P,D);for(var N=0;N<T.length;N++)T[N].fire("mouse"+P,D)},_finalizeCurrentTransform:function(k){var P=this._currentTransform,S=P.target,E={e:k,target:S,transform:P,action:P.action};S._scaling&&(S._scaling=!1),S.setCoords(),(P.actionPerformed||this.stateful&&S.hasStateChanged())&&this._fire("modified",E)},_onMouseDownInDrawingMode:function(k){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(k).requestRenderAll();var P=this.getPointer(k);this.freeDrawingBrush.onMouseDown(P,{e:k,pointer:P}),this._handleEvent(k,"down")},_onMouseMoveInDrawingMode:function(k){if(this._isCurrentlyDrawing){var P=this.getPointer(k);this.freeDrawingBrush.onMouseMove(P,{e:k,pointer:P})}this.setCursor(this.freeDrawingCursor),this._handleEvent(k,"move")},_onMouseUpInDrawingMode:function(k){var P=this.getPointer(k);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:k,pointer:P}),this._handleEvent(k,"up")},__onMouseDown:function(k){this._cacheTransformEventData(k),this._handleEvent(k,"down:before");var P=this._target;if(x(k,g)){this.fireRightClick&&this._handleEvent(k,"down",g);return}if(x(k,d)){this.fireMiddleClick&&this._handleEvent(k,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(k);return}if(!!this._isMainEvent(k)&&!this._currentTransform){var S=this._pointer;this._previousPointer=S;var E=this._shouldRender(P),M=this._shouldGroup(k,P);if(this._shouldClearSelection(k,P)?this.discardActiveObject(k):M&&(this._handleGrouping(k,P),P=this._activeObject),this.selection&&(!P||!P.selectable&&!P.isEditing&&P!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),P){var T=P===this._activeObject;P.selectable&&P.activeOn==="down"&&this.setActiveObject(P,k);var D=P._findTargetCorner(this.getPointer(k,!0),n.util.isTouchEvent(k));if(P.__corner=D,P===this._activeObject&&(D||!M)){this._setupCurrentTransform(k,P,T);var N=P.controls[D],S=this.getPointer(k),I=N&&N.getMouseDownHandler(k,P,N);I&&I(k,this._currentTransform,S.x,S.y)}}this._handleEvent(k,"down"),(E||M)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(k){this._resetTransformEventData(),this._pointer=this.getPointer(k,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(k)||null},_beforeTransform:function(k){var P=this._currentTransform;this.stateful&&P.target.saveState(),this.fire("before:transform",{e:k,transform:P})},__onMouseMove:function(k){this._handleEvent(k,"move:before"),this._cacheTransformEventData(k);var P,S;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(k);return}if(!!this._isMainEvent(k)){var E=this._groupSelector;E?(S=this._absolutePointer,E.left=S.x-E.ex,E.top=S.y-E.ey,this.renderTop()):this._currentTransform?this._transformObject(k):(P=this.findTarget(k)||null,this._setCursorFromEvent(k,P),this._fireOverOutEvents(P,k)),this._handleEvent(k,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(k,P){var S=this._hoveredTarget,E=this._hoveredTargets,M=this.targets,T=Math.max(E.length,M.length);this.fireSyntheticInOutEvents(k,P,{oldTarget:S,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var D=0;D<T;D++)this.fireSyntheticInOutEvents(M[D],P,{oldTarget:E[D],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=k,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(k,P){var S=this._draggedoverTarget,E=this._hoveredTargets,M=this.targets,T=Math.max(E.length,M.length);this.fireSyntheticInOutEvents(k,P,{oldTarget:S,evtOut:"dragleave",evtIn:"dragenter"});for(var D=0;D<T;D++)this.fireSyntheticInOutEvents(M[D],P,{oldTarget:E[D],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=k},fireSyntheticInOutEvents:function(k,P,S){var E,M,T=S.oldTarget,D,N,I=T!==k,O=S.canvasEvtIn,F=S.canvasEvtOut;I&&(E={e:P,target:k,previousTarget:T},M={e:P,target:T,nextTarget:k}),N=k&&I,D=T&&I,D&&(F&&this.fire(F,M),T.fire(S.evtOut,M)),N&&(O&&this.fire(O,E),k.fire(S.evtIn,E))},__onMouseWheel:function(k){this._cacheTransformEventData(k),this._handleEvent(k,"wheel"),this._resetTransformEventData()},_transformObject:function(k){var P=this.getPointer(k),S=this._currentTransform;S.reset=!1,S.shiftKey=k.shiftKey,S.altKey=k[this.centeredKey],this._performTransformAction(k,S,P),S.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(k,P,S){var E=S.x,M=S.y,T=P.action,D=!1,N=P.actionHandler;N&&(D=N(k,P,E,M)),T==="drag"&&D&&(P.target.isMoving=!0,this.setCursor(P.target.moveCursor||this.moveCursor)),P.actionPerformed=P.actionPerformed||D},_fire:n.controlsUtils.fireEvent,_setCursorFromEvent:function(k,P){if(!P)return this.setCursor(this.defaultCursor),!1;var S=P.hoverCursor||this.hoverCursor,E=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,M=(!E||!E.contains(P))&&P._findTargetCorner(this.getPointer(k,!0));M?this.setCursor(this.getCornerCursor(M,P,k)):(P.subTargetCheck&&this.targets.concat().reverse().map(function(T){S=T.hoverCursor||S}),this.setCursor(S))},getCornerCursor:function(k,P,S){var E=P.controls[k];return E.cursorStyleHandler(S,E,P)}})}(),function(){var m=Math.min,v=Math.max;n.util.object.extend(n.Canvas.prototype,{_shouldGroup:function(g,d){var f=this._activeObject;return f&&this._isSelectionKeyPressed(g)&&d&&d.selectable&&this.selection&&(f!==d||f.type==="activeSelection")&&!d.onSelect({e:g})},_handleGrouping:function(g,d){var f=this._activeObject;f.__corner||d===f&&(d=this.findTarget(g,!0),!d||!d.selectable)||(f&&f.type==="activeSelection"?this._updateActiveSelection(d,g):this._createActiveSelection(d,g))},_updateActiveSelection:function(g,d){var f=this._activeObject,y=f._objects.slice(0);f.contains(g)?(f.removeWithUpdate(g),this._hoveredTarget=g,this._hoveredTargets=this.targets.concat(),f.size()===1&&this._setActiveObject(f.item(0),d)):(f.addWithUpdate(g),this._hoveredTarget=f,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(y,d)},_createActiveSelection:function(g,d){var f=this.getActiveObjects(),y=this._createGroup(g);this._hoveredTarget=y,this._setActiveObject(y,d),this._fireSelectionEvents(f,d)},_createGroup:function(g){var d=this._objects,f=d.indexOf(this._activeObject)<d.indexOf(g),y=f?[this._activeObject,g]:[g,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new n.ActiveSelection(y,{canvas:this})},_groupSelectedObjects:function(g){var d=this._collectObjects(g),f;d.length===1?this.setActiveObject(d[0],g):d.length>1&&(f=new n.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(f,g))},_collectObjects:function(g){for(var d=[],f,y=this._groupSelector.ex,x=this._groupSelector.ey,k=y+this._groupSelector.left,P=x+this._groupSelector.top,S=new n.Point(m(y,k),m(x,P)),E=new n.Point(v(y,k),v(x,P)),M=!this.selectionFullyContained,T=y===k&&x===P,D=this._objects.length;D--&&(f=this._objects[D],!(!(!f||!f.selectable||!f.visible)&&(M&&f.intersectsWithRect(S,E,!0)||f.isContainedWithinRect(S,E,!0)||M&&f.containsPoint(S,null,!0)||M&&f.containsPoint(E,null,!0))&&(d.push(f),T))););return d.length>1&&(d=d.filter(function(N){return!N.onSelect({e:g})})),d},_maybeGroupObjects:function(g){this.selection&&this._groupSelector&&this._groupSelectedObjects(g),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){n.util.object.extend(n.StaticCanvas.prototype,{toDataURL:function(m){m||(m={});var v=m.format||"png",g=m.quality||1,d=(m.multiplier||1)*(m.enableRetinaScaling?this.getRetinaScaling():1),f=this.toCanvasElement(d,m);return n.util.toDataURL(f,v,g)},toCanvasElement:function(m,v){m=m||1,v=v||{};var g=(v.width||this.width)*m,d=(v.height||this.height)*m,f=this.getZoom(),y=this.width,x=this.height,k=f*m,P=this.viewportTransform,S=(P[4]-(v.left||0))*m,E=(P[5]-(v.top||0))*m,M=this.interactive,T=[k,0,0,k,S,E],D=this.enableRetinaScaling,N=n.util.createCanvasElement(),I=this.contextTop;return N.width=g,N.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=T,this.width=g,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(N.getContext("2d"),this._objects),this.viewportTransform=P,this.width=y,this.height=x,this.calcViewportBoundaries(),this.interactive=M,this.enableRetinaScaling=D,this.contextTop=I,N}})}(),n.util.object.extend(n.StaticCanvas.prototype,{loadFromJSON:function(m,v,g){if(!!m){var d=typeof m=="string"?JSON.parse(m):n.util.object.clone(m),f=this,y=d.clipPath,x=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(k){f.clear(),f._setBgOverlay(d,function(){y?f._enlivenObjects([y],function(P){f.clipPath=P[0],f.__setupCanvas.call(f,d,k,x,v)}):f.__setupCanvas.call(f,d,k,x,v)})},g),this}},__setupCanvas:function(m,v,g,d){var f=this;v.forEach(function(y,x){f.insertAt(y,x)}),this.renderOnAddRemove=g,delete m.objects,delete m.backgroundImage,delete m.overlayImage,delete m.background,delete m.overlay,this._setOptions(m),this.renderAll(),d&&d()},_setBgOverlay:function(m,v){var g={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!m.backgroundImage&&!m.overlayImage&&!m.background&&!m.overlay){v&&v();return}var d=function(){g.backgroundImage&&g.overlayImage&&g.backgroundColor&&g.overlayColor&&v&&v()};this.__setBgOverlay("backgroundImage",m.backgroundImage,g,d),this.__setBgOverlay("overlayImage",m.overlayImage,g,d),this.__setBgOverlay("backgroundColor",m.background,g,d),this.__setBgOverlay("overlayColor",m.overlay,g,d)},__setBgOverlay:function(m,v,g,d){var f=this;if(!v){g[m]=!0,d&&d();return}m==="backgroundImage"||m==="overlayImage"?n.util.enlivenObjects([v],function(y){f[m]=y[0],g[m]=!0,d&&d()}):this["set"+n.util.string.capitalize(m,!0)](v,function(){g[m]=!0,d&&d()})},_enlivenObjects:function(m,v,g){if(!m||m.length===0){v&&v([]);return}n.util.enlivenObjects(m,function(d){v&&v(d)},null,g)},_toDataURL:function(m,v){this.clone(function(g){v(g.toDataURL(m))})},_toDataURLWithMultiplier:function(m,v,g){this.clone(function(d){g(d.toDataURLWithMultiplier(m,v))})},clone:function(m,v){var g=JSON.stringify(this.toJSON(v));this.cloneWithoutData(function(d){d.loadFromJSON(g,function(){m&&m(d)})})},cloneWithoutData:function(m){var v=n.util.createCanvasElement();v.width=this.width,v.height=this.height;var g=new n.Canvas(v);this.backgroundImage?(g.setBackgroundImage(this.backgroundImage.src,function(){g.renderAll(),m&&m(g)}),g.backgroundImageOpacity=this.backgroundImageOpacity,g.backgroundImageStretch=this.backgroundImageStretch):m&&m(g)}}),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.util.object.clone,f=v.util.toFixed,y=v.util.string.capitalize,x=v.util.degreesToRadians,k=!v.isLikelyNode,P=2;v.Object||(v.Object=v.util.createClass(v.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:k,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(S){S&&this.setOptions(S)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=v.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(S){var E=v.perfLimitSizeTotal,M=S.width,T=S.height,D=v.maxCacheSideLimit,N=v.minCacheSideLimit;if(M<=D&&T<=D&&M*T<=E)return M<N&&(S.width=N),T<N&&(S.height=N),S;var I=M/T,O=v.util.limitDimsByArea(I,E),F=v.util.capValue,q=F(N,O.x,D),Y=F(N,O.y,D);return M>q&&(S.zoomX/=M/q,S.width=q,S.capped=!0),T>Y&&(S.zoomY/=T/Y,S.height=Y,S.capped=!0),S},_getCacheCanvasDimensions:function(){var S=this.getTotalObjectScaling(),E=this._getTransformedDimensions(0,0),M=E.x*S.scaleX/this.scaleX,T=E.y*S.scaleY/this.scaleY;return{width:Math.ceil(M+P),height:Math.ceil(T+P),zoomX:S.scaleX,zoomY:S.scaleY,x:M,y:T}},_updateCacheCanvas:function(){var S=this.canvas;if(this.noScaleCache&&S&&S._currentTransform){var E=S._currentTransform.target,M=S._currentTransform.action;if(this===E&&M.slice&&M.slice(0,5)==="scale")return!1}var T=this._cacheCanvas,D=this._limitCacheSize(this._getCacheCanvasDimensions()),N=D.width,I=D.height,O,F,q=D.zoomX,Y=D.zoomY,_e=N!==this.cacheWidth||I!==this.cacheHeight,ne=this.zoomX!==q||this.zoomY!==Y,ve=_e||ne;return ve?(_e?(T.width=N,T.height=I):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,T.width,T.height)),O=D.x/2,F=D.y/2,this.cacheTranslationX=Math.round(T.width/2-O)+O,this.cacheTranslationY=Math.round(T.height/2-F)+F,this.cacheWidth=N,this.cacheHeight=I,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(q,Y),this.zoomX=q,this.zoomY=Y,!0):!1},setOptions:function(S){this._setOptions(S),this._initGradient(S.fill,"fill"),this._initGradient(S.stroke,"stroke"),this._initPattern(S.fill,"fill"),this._initPattern(S.stroke,"stroke")},transform:function(S){var E=this.group&&!this.group._transformDone||this.group&&this.canvas&&S===this.canvas.contextTop,M=this.calcTransformMatrix(!E);S.transform(M[0],M[1],M[2],M[3],M[4],M[5])},toObject:function(S){var E=v.Object.NUM_FRACTION_DIGITS,M={type:this.type,version:v.version,originX:this.originX,originY:this.originY,left:f(this.left,E),top:f(this.top,E),width:f(this.width,E),height:f(this.height,E),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:f(this.strokeWidth,E),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:f(this.strokeMiterLimit,E),scaleX:f(this.scaleX,E),scaleY:f(this.scaleY,E),angle:f(this.angle,E),flipX:this.flipX,flipY:this.flipY,opacity:f(this.opacity,E),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:f(this.skewX,E),skewY:f(this.skewY,E)};return this.clipPath&&!this.clipPath.excludeFromExport&&(M.clipPath=this.clipPath.toObject(S),M.clipPath.inverted=this.clipPath.inverted,M.clipPath.absolutePositioned=this.clipPath.absolutePositioned),v.util.populateWithProperties(this,M,S),this.includeDefaultValues||(M=this._removeDefaultValues(M)),M},toDatalessObject:function(S){return this.toObject(S)},_removeDefaultValues:function(S){var E=v.util.getKlass(S.type).prototype,M=E.stateProperties;return M.forEach(function(T){T==="left"||T==="top"||(S[T]===E[T]&&delete S[T],Array.isArray(S[T])&&Array.isArray(E[T])&&S[T].length===0&&E[T].length===0&&delete S[T])}),S},toString:function(){return"#<fabric."+y(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var S=v.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(S.scaleX),scaleY:Math.abs(S.scaleY)}},getTotalObjectScaling:function(){var S=this.getObjectScaling(),E=S.scaleX,M=S.scaleY;if(this.canvas){var T=this.canvas.getZoom(),D=this.canvas.getRetinaScaling();E*=T*D,M*=T*D}return{scaleX:E,scaleY:M}},getObjectOpacity:function(){var S=this.opacity;return this.group&&(S*=this.group.getObjectOpacity()),S},_set:function(S,E){var M=S==="scaleX"||S==="scaleY",T=this[S]!==E,D=!1;return M&&(E=this._constrainScale(E)),S==="scaleX"&&E<0?(this.flipX=!this.flipX,E*=-1):S==="scaleY"&&E<0?(this.flipY=!this.flipY,E*=-1):S==="shadow"&&E&&!(E instanceof v.Shadow)?E=new v.Shadow(E):S==="dirty"&&this.group&&this.group.set("dirty",E),this[S]=E,T&&(D=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(S)>-1?(this.dirty=!0,D&&this.group.set("dirty",!0)):D&&this.stateProperties.indexOf(S)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:v.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(S){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(S.save(),this._setupCompositeOperation(S),this.drawSelectionBackground(S),this.transform(S),this._setOpacity(S),this._setShadow(S,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(S)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(S),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),S.restore())},renderCache:function(S){S=S||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,S.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(S,E){if(S.save(),E.inverted?S.globalCompositeOperation="destination-out":S.globalCompositeOperation="destination-in",E.absolutePositioned){var M=v.util.invertTransform(this.calcTransformMatrix());S.transform(M[0],M[1],M[2],M[3],M[4],M[5])}E.transform(S),S.scale(1/E.zoomX,1/E.zoomY),S.drawImage(E._cacheCanvas,-E.cacheTranslationX,-E.cacheTranslationY),S.restore()},drawObject:function(S,E){var M=this.fill,T=this.stroke;E?(this.fill="black",this.stroke="",this._setClippingProperties(S)):this._renderBackground(S),this._render(S),this._drawClipPath(S,this.clipPath),this.fill=M,this.stroke=T},_drawClipPath:function(S,E){!E||(E.canvas=this.canvas,E.shouldCache(),E._transformDone=!0,E.renderCache({forClipping:!0}),this.drawClipPathOnCache(S,E))},drawCacheOnCanvas:function(S){S.scale(1/this.zoomX,1/this.zoomY),S.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(S){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!S&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!S){var E=this.cacheWidth/this.zoomX,M=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-E/2,-M/2,E,M)}return!0}return!1},_renderBackground:function(S){if(!!this.backgroundColor){var E=this._getNonTransformedDimensions();S.fillStyle=this.backgroundColor,S.fillRect(-E.x/2,-E.y/2,E.x,E.y),this._removeShadow(S)}},_setOpacity:function(S){this.group&&!this.group._transformDone?S.globalAlpha=this.getObjectOpacity():S.globalAlpha*=this.opacity},_setStrokeStyles:function(S,E){var M=E.stroke;M&&(S.lineWidth=E.strokeWidth,S.lineCap=E.strokeLineCap,S.lineDashOffset=E.strokeDashOffset,S.lineJoin=E.strokeLineJoin,S.miterLimit=E.strokeMiterLimit,M.toLive?M.gradientUnits==="percentage"||M.gradientTransform||M.patternTransform?this._applyPatternForTransformedGradient(S,M):(S.strokeStyle=M.toLive(S,this),this._applyPatternGradientTransform(S,M)):S.strokeStyle=E.stroke)},_setFillStyles:function(S,E){var M=E.fill;M&&(M.toLive?(S.fillStyle=M.toLive(S,this),this._applyPatternGradientTransform(S,E.fill)):S.fillStyle=M)},_setClippingProperties:function(S){S.globalAlpha=1,S.strokeStyle="transparent",S.fillStyle="#000000"},_setLineDash:function(S,E){!E||E.length===0||(1&E.length&&E.push.apply(E,E),S.setLineDash(E))},_renderControls:function(S,E){var M=this.getViewportTransform(),T=this.calcTransformMatrix(),D,N,I;E=E||{},N=typeof E.hasBorders<"u"?E.hasBorders:this.hasBorders,I=typeof E.hasControls<"u"?E.hasControls:this.hasControls,T=v.util.multiplyTransformMatrices(M,T),D=v.util.qrDecompose(T),S.save(),S.translate(D.translateX,D.translateY),S.lineWidth=1*this.borderScaleFactor,this.group||(S.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(D.angle-=180),S.rotate(x(this.group?D.angle:this.angle)),E.forActiveSelection||this.group?N&&this.drawBordersInGroup(S,D,E):N&&this.drawBorders(S,E),I&&this.drawControls(S,E),S.restore()},_setShadow:function(S){if(!!this.shadow){var E=this.shadow,M=this.canvas,T,D=M&&M.viewportTransform[0]||1,N=M&&M.viewportTransform[3]||1;E.nonScaling?T={scaleX:1,scaleY:1}:T=this.getObjectScaling(),M&&M._isRetinaScaling()&&(D*=v.devicePixelRatio,N*=v.devicePixelRatio),S.shadowColor=E.color,S.shadowBlur=E.blur*v.browserShadowBlurConstant*(D+N)*(T.scaleX+T.scaleY)/4,S.shadowOffsetX=E.offsetX*D*T.scaleX,S.shadowOffsetY=E.offsetY*N*T.scaleY}},_removeShadow:function(S){!this.shadow||(S.shadowColor="",S.shadowBlur=S.shadowOffsetX=S.shadowOffsetY=0)},_applyPatternGradientTransform:function(S,E){if(!E||!E.toLive)return{offsetX:0,offsetY:0};var M=E.gradientTransform||E.patternTransform,T=-this.width/2+E.offsetX||0,D=-this.height/2+E.offsetY||0;return E.gradientUnits==="percentage"?S.transform(this.width,0,0,this.height,T,D):S.transform(1,0,0,1,T,D),M&&S.transform(M[0],M[1],M[2],M[3],M[4],M[5]),{offsetX:T,offsetY:D}},_renderPaintInOrder:function(S){this.paintFirst==="stroke"?(this._renderStroke(S),this._renderFill(S)):(this._renderFill(S),this._renderStroke(S))},_render:function(){},_renderFill:function(S){!this.fill||(S.save(),this._setFillStyles(S,this),this.fillRule==="evenodd"?S.fill("evenodd"):S.fill(),S.restore())},_renderStroke:function(S){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(S),S.save(),this.strokeUniform&&this.group){var E=this.getObjectScaling();S.scale(1/E.scaleX,1/E.scaleY)}else this.strokeUniform&&S.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(S,this.strokeDashArray),this._setStrokeStyles(S,this),S.stroke(),S.restore()}},_applyPatternForTransformedGradient:function(S,E){var M=this._limitCacheSize(this._getCacheCanvasDimensions()),T=v.util.createCanvasElement(),D,N=this.canvas.getRetinaScaling(),I=M.x/this.scaleX/N,O=M.y/this.scaleY/N;T.width=Math.ceil(I),T.height=Math.ceil(O),D=T.getContext("2d"),D.beginPath(),D.moveTo(0,0),D.lineTo(I,0),D.lineTo(I,O),D.lineTo(0,O),D.closePath(),D.translate(I/2,O/2),D.scale(M.zoomX/this.scaleX/N,M.zoomY/this.scaleY/N),this._applyPatternGradientTransform(D,E),D.fillStyle=E.toLive(S),D.fill(),S.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),S.scale(N*this.scaleX/M.zoomX,N*this.scaleY/M.zoomY),S.strokeStyle=D.createPattern(T,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var S=v.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",S.scaleX),this.set("scaleY",S.scaleY),this.angle=S.angle,this.skewX=S.skewX,this.skewY=0}},_removeTransformMatrix:function(S){var E=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),E=v.util.transformPoint(E,this.transformMatrix)),this.transformMatrix=null,S&&(this.scaleX*=S.scaleX,this.scaleY*=S.scaleY,this.cropX=S.cropX,this.cropY=S.cropY,E.x+=S.offsetLeft,E.y+=S.offsetTop,this.width=S.width,this.height=S.height),this.setPositionByOrigin(E,"center","center")},clone:function(S,E){var M=this.toObject(E);this.constructor.fromObject?this.constructor.fromObject(M,S):v.Object._fromObject("Object",M,S)},cloneAsImage:function(S,E){var M=this.toCanvasElement(E);return S&&S(new v.Image(M)),this},toCanvasElement:function(S){S||(S={});var E=v.util,M=E.saveObjectTransform(this),T=this.group,D=this.shadow,N=Math.abs,I=(S.multiplier||1)*(S.enableRetinaScaling?v.devicePixelRatio:1);delete this.group,S.withoutTransform&&E.resetObjectTransform(this),S.withoutShadow&&(this.shadow=null);var O=v.util.createCanvasElement(),F=this.getBoundingRect(!0,!0),q=this.shadow,Y,_e={x:0,y:0},ne,ve,J;q&&(ne=q.blur,q.nonScaling?Y={scaleX:1,scaleY:1}:Y=this.getObjectScaling(),_e.x=2*Math.round(N(q.offsetX)+ne)*N(Y.scaleX),_e.y=2*Math.round(N(q.offsetY)+ne)*N(Y.scaleY)),ve=F.width+_e.x,J=F.height+_e.y,O.width=Math.ceil(ve),O.height=Math.ceil(J);var fe=new v.StaticCanvas(O,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});S.format==="jpeg"&&(fe.backgroundColor="#fff"),this.setPositionByOrigin(new v.Point(fe.width/2,fe.height/2),"center","center");var Z=this.canvas;fe.add(this);var j=fe.toCanvasElement(I||1,S);return this.shadow=D,this.set("canvas",Z),T&&(this.group=T),this.set(M).setCoords(),fe._objects=[],fe.dispose(),fe=null,j},toDataURL:function(S){return S||(S={}),v.util.toDataURL(this.toCanvasElement(S),S.format||"png",S.quality||1)},isType:function(S){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===S},complexity:function(){return 1},toJSON:function(S){return this.toObject(S)},rotate:function(S){var E=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return E&&this._setOriginToCenter(),this.set("angle",S),E&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(S,E){E=E||this.canvas.getPointer(S);var M=new v.Point(E.x,E.y),T=this._getLeftTopCoords();return this.angle&&(M=v.util.rotatePoint(M,T,x(-this.angle))),{x:M.x-T.x,y:M.y-T.y}},_setupCompositeOperation:function(S){this.globalCompositeOperation&&(S.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){v.runningAnimations&&v.runningAnimations.cancelByTarget(this)}}),v.util.createAccessors&&v.util.createAccessors(v.Object),g(v.Object.prototype,v.Observable),v.Object.NUM_FRACTION_DIGITS=2,v.Object.ENLIVEN_PROPS=["clipPath"],v.Object._fromObject=function(S,E,M,T){var D=v[S];E=d(E,!0),v.util.enlivenPatterns([E.fill,E.stroke],function(N){typeof N[0]<"u"&&(E.fill=N[0]),typeof N[1]<"u"&&(E.stroke=N[1]),v.util.enlivenObjectEnlivables(E,E,function(){var I=T?new D(E[T],E):new D(E);M&&M(I)})})},v.Object.__uid=0)}(e),function(){var m=n.util.degreesToRadians,v={left:-.5,center:0,right:.5},g={top:-.5,center:0,bottom:.5};n.util.object.extend(n.Object.prototype,{translateToGivenOrigin:function(d,f,y,x,k){var P=d.x,S=d.y,E,M,T;return typeof f=="string"?f=v[f]:f-=.5,typeof x=="string"?x=v[x]:x-=.5,E=x-f,typeof y=="string"?y=g[y]:y-=.5,typeof k=="string"?k=g[k]:k-=.5,M=k-y,(E||M)&&(T=this._getTransformedDimensions(),P=d.x+E*T.x,S=d.y+M*T.y),new n.Point(P,S)},translateToCenterPoint:function(d,f,y){var x=this.translateToGivenOrigin(d,f,y,"center","center");return this.angle?n.util.rotatePoint(x,d,m(this.angle)):x},translateToOriginPoint:function(d,f,y){var x=this.translateToGivenOrigin(d,"center","center",f,y);return this.angle?n.util.rotatePoint(x,d,m(this.angle)):x},getCenterPoint:function(){var d=new n.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,f){var y=this.getCenterPoint();return this.translateToOriginPoint(y,d,f)},toLocalPoint:function(d,f,y){var x=this.getCenterPoint(),k,P;return typeof f<"u"&&typeof y<"u"?k=this.translateToGivenOrigin(x,"center","center",f,y):k=new n.Point(this.left,this.top),P=new n.Point(d.x,d.y),this.angle&&(P=n.util.rotatePoint(P,x,-m(this.angle))),P.subtractEquals(k)},setPositionByOrigin:function(d,f,y){var x=this.translateToCenterPoint(d,f,y),k=this.translateToOriginPoint(x,this.originX,this.originY);this.set("left",k.x),this.set("top",k.y)},adjustPosition:function(d){var f=m(this.angle),y=this.getScaledWidth(),x=n.util.cos(f)*y,k=n.util.sin(f)*y,P,S;typeof this.originX=="string"?P=v[this.originX]:P=this.originX-.5,typeof d=="string"?S=v[d]:S=d-.5,this.left+=x*(S-P),this.top+=k*(S-P),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function m(y){return[new n.Point(y.tl.x,y.tl.y),new n.Point(y.tr.x,y.tr.y),new n.Point(y.br.x,y.br.y),new n.Point(y.bl.x,y.bl.y)]}var v=n.util,g=v.degreesToRadians,d=v.multiplyTransformMatrices,f=v.transformPoint;v.object.extend(n.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(y,x){return x?y?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),y?this.aCoords:this.lineCoords)},getCoords:function(y,x){return m(this._getCoords(y,x))},intersectsWithRect:function(y,x,k,P){var S=this.getCoords(k,P),E=n.Intersection.intersectPolygonRectangle(S,y,x);return E.status==="Intersection"},intersectsWithObject:function(y,x,k){var P=n.Intersection.intersectPolygonPolygon(this.getCoords(x,k),y.getCoords(x,k));return P.status==="Intersection"||y.isContainedWithinObject(this,x,k)||this.isContainedWithinObject(y,x,k)},isContainedWithinObject:function(y,x,k){for(var P=this.getCoords(x,k),S=x?y.aCoords:y.lineCoords,E=0,M=y._getImageLines(S);E<4;E++)if(!y.containsPoint(P[E],M))return!1;return!0},isContainedWithinRect:function(y,x,k,P){var S=this.getBoundingRect(k,P);return S.left>=y.x&&S.left+S.width<=x.x&&S.top>=y.y&&S.top+S.height<=x.y},containsPoint:function(y,E,k,P){var S=this._getCoords(k,P),E=E||this._getImageLines(S),M=this._findCrossPoints(y,E);return M!==0&&M%2===1},isOnScreen:function(y){if(!this.canvas)return!1;var x=this.canvas.vptCoords.tl,k=this.canvas.vptCoords.br,P=this.getCoords(!0,y);return P.some(function(S){return S.x<=k.x&&S.x>=x.x&&S.y<=k.y&&S.y>=x.y})||this.intersectsWithRect(x,k,!0,y)?!0:this._containsCenterOfCanvas(x,k,y)},_containsCenterOfCanvas:function(y,x,k){var P={x:(y.x+x.x)/2,y:(y.y+x.y)/2};return!!this.containsPoint(P,null,!0,k)},isPartiallyOnScreen:function(y){if(!this.canvas)return!1;var x=this.canvas.vptCoords.tl,k=this.canvas.vptCoords.br;if(this.intersectsWithRect(x,k,!0,y))return!0;var P=this.getCoords(!0,y).every(function(S){return(S.x>=k.x||S.x<=x.x)&&(S.y>=k.y||S.y<=x.y)});return P&&this._containsCenterOfCanvas(x,k,y)},_getImageLines:function(y){var x={topline:{o:y.tl,d:y.tr},rightline:{o:y.tr,d:y.br},bottomline:{o:y.br,d:y.bl},leftline:{o:y.bl,d:y.tl}};return x},_findCrossPoints:function(y,x){var k,P,S,E,M,T=0,D;for(var N in x)if(D=x[N],!(D.o.y<y.y&&D.d.y<y.y)&&!(D.o.y>=y.y&&D.d.y>=y.y)&&(D.o.x===D.d.x&&D.o.x>=y.x?M=D.o.x:(k=0,P=(D.d.y-D.o.y)/(D.d.x-D.o.x),S=y.y-k*y.x,E=D.o.y-P*D.o.x,M=-(S-E)/(k-P)),M>=y.x&&(T+=1),T===2))break;return T},getBoundingRect:function(y,x){var k=this.getCoords(y,x);return v.makeBoundingBoxFromPoints(k)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(y){return Math.abs(y)<this.minScaleLimit?y<0?-this.minScaleLimit:this.minScaleLimit:y===0?1e-4:y},scale:function(y){return this._set("scaleX",y),this._set("scaleY",y),this.setCoords()},scaleToWidth:function(y,x){var k=this.getBoundingRect(x).width/this.getScaledWidth();return this.scale(y/this.width/k)},scaleToHeight:function(y,x){var k=this.getBoundingRect(x).height/this.getScaledHeight();return this.scale(y/this.height/k)},calcLineCoords:function(){var y=this.getViewportTransform(),x=this.padding,k=g(this.angle),P=v.cos(k),S=v.sin(k),E=P*x,M=S*x,T=E+M,D=E-M,N=this.calcACoords(),I={tl:f(N.tl,y),tr:f(N.tr,y),bl:f(N.bl,y),br:f(N.br,y)};return x&&(I.tl.x-=D,I.tl.y-=T,I.tr.x+=T,I.tr.y-=D,I.bl.x-=T,I.bl.y+=D,I.br.x+=D,I.br.y+=T),I},calcOCoords:function(){var y=this._calcRotateMatrix(),x=this._calcTranslateMatrix(),k=this.getViewportTransform(),P=d(k,x),S=d(P,y),S=d(S,[1/k[0],0,0,1/k[3],0,0]),E=this._calculateCurrentDimensions(),M={};return this.forEachControl(function(T,D,N){M[D]=T.positionHandler(E,S,N)}),M},calcACoords:function(){var y=this._calcRotateMatrix(),x=this._calcTranslateMatrix(),k=d(x,y),P=this._getTransformedDimensions(),S=P.x/2,E=P.y/2;return{tl:f({x:-S,y:-E},k),tr:f({x:S,y:-E},k),bl:f({x:-S,y:E},k),br:f({x:S,y:E},k)}},setCoords:function(y){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),y?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return v.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var y=this.getCenterPoint();return[1,0,0,1,y.x,y.y]},transformMatrixKey:function(y){var x="_",k="";return!y&&this.group&&(k=this.group.transformMatrixKey(y)+x),k+this.top+x+this.left+x+this.scaleX+x+this.scaleY+x+this.skewX+x+this.skewY+x+this.angle+x+this.originX+x+this.originY+x+this.width+x+this.height+x+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(y){var x=this.calcOwnMatrix();if(y||!this.group)return x;var k=this.transformMatrixKey(y),P=this.matrixCache||(this.matrixCache={});return P.key===k?P.value:(this.group&&(x=d(this.group.calcTransformMatrix(!1),x)),P.key=k,P.value=x,x)},calcOwnMatrix:function(){var y=this.transformMatrixKey(!0),x=this.ownMatrixCache||(this.ownMatrixCache={});if(x.key===y)return x.value;var k=this._calcTranslateMatrix(),P={angle:this.angle,translateX:k[4],translateY:k[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return x.key=y,x.value=v.composeMatrix(P),x.value},_getNonTransformedDimensions:function(){var y=this.strokeWidth,x=this.width+y,k=this.height+y;return{x,y:k}},_getTransformedDimensions:function(y,x){typeof y>"u"&&(y=this.skewX),typeof x>"u"&&(x=this.skewY);var k,P,S,E=y===0&&x===0;if(this.strokeUniform?(P=this.width,S=this.height):(k=this._getNonTransformedDimensions(),P=k.x,S=k.y),E)return this._finalizeDimensions(P*this.scaleX,S*this.scaleY);var M=v.sizeAfterTransform(P,S,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:y,skewY:x});return this._finalizeDimensions(M.x,M.y)},_finalizeDimensions:function(y,x){return this.strokeUniform?{x:y+this.strokeWidth,y:x+this.strokeWidth}:{x:y,y:x}},_calculateCurrentDimensions:function(){var y=this.getViewportTransform(),x=this._getTransformedDimensions(),k=f(x,y,!0);return k.scalarAdd(2*this.padding)}})}(),n.util.object.extend(n.Object.prototype,{sendToBack:function(){return this.group?n.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?n.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(m){return this.group?n.StaticCanvas.prototype.sendBackwards.call(this.group,this,m):this.canvas&&this.canvas.sendBackwards(this,m),this},bringForward:function(m){return this.group?n.StaticCanvas.prototype.bringForward.call(this.group,this,m):this.canvas&&this.canvas.bringForward(this,m),this},moveTo:function(m){return this.group&&this.group.type!=="activeSelection"?n.StaticCanvas.prototype.moveTo.call(this.group,this,m):this.canvas&&this.canvas.moveTo(this,m),this}}),function(){function m(g,d){if(d){if(d.toLive)return g+": url(#SVGID_"+d.id+"); ";var f=new n.Color(d),y=g+": "+f.toRgb()+"; ",x=f.getAlpha();return x!==1&&(y+=g+"-opacity: "+x.toString()+"; "),y}else return g+": none; "}var v=n.util.toFixed;n.util.object.extend(n.Object.prototype,{getSvgStyles:function(g){var d=this.fillRule?this.fillRule:"nonzero",f=this.strokeWidth?this.strokeWidth:"0",y=this.strokeDashArray?this.strokeDashArray.join(" "):"none",x=this.strokeDashOffset?this.strokeDashOffset:"0",k=this.strokeLineCap?this.strokeLineCap:"butt",P=this.strokeLineJoin?this.strokeLineJoin:"miter",S=this.strokeMiterLimit?this.strokeMiterLimit:"4",E=typeof this.opacity<"u"?this.opacity:"1",M=this.visible?"":" visibility: hidden;",T=g?"":this.getSvgFilter(),D=m("fill",this.fill),N=m("stroke",this.stroke);return[N,"stroke-width: ",f,"; ","stroke-dasharray: ",y,"; ","stroke-linecap: ",k,"; ","stroke-dashoffset: ",x,"; ","stroke-linejoin: ",P,"; ","stroke-miterlimit: ",S,"; ",D,"fill-rule: ",d,"; ","opacity: ",E,";",T,M].join("")},getSvgSpanStyles:function(g,d){var f="; ",x=g.fontFamily?"font-family: "+(g.fontFamily.indexOf("'")===-1&&g.fontFamily.indexOf('"')===-1?"'"+g.fontFamily+"'":g.fontFamily)+f:"",y=g.strokeWidth?"stroke-width: "+g.strokeWidth+f:"",x=x,k=g.fontSize?"font-size: "+g.fontSize+"px"+f:"",P=g.fontStyle?"font-style: "+g.fontStyle+f:"",S=g.fontWeight?"font-weight: "+g.fontWeight+f:"",E=g.fill?m("fill",g.fill):"",M=g.stroke?m("stroke",g.stroke):"",T=this.getSvgTextDecoration(g),D=g.deltaY?"baseline-shift: "+-g.deltaY+"; ":"";return T&&(T="text-decoration: "+T+f),[M,y,x,k,P,S,T,E,D,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(g){return["overline","underline","line-through"].filter(function(d){return g[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(g,d){var f=g?this.calcTransformMatrix():this.calcOwnMatrix(),y='transform="'+n.util.matrixToSVG(f);return y+(d||"")+'" '},_setSVGBg:function(g){if(this.backgroundColor){var d=n.Object.NUM_FRACTION_DIGITS;g.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',v(-this.width/2,d),'" y="',v(-this.height/2,d),'" width="',v(this.width,d),'" height="',v(this.height,d),`"></rect>
`)}},toSVG:function(g){return this._createBaseSVGMarkup(this._toSVG(g),{reviver:g})},toClipPathSVG:function(g){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(g),{reviver:g})},_createBaseClipPathSVGMarkup:function(g,d){d=d||{};var f=d.reviver,y=d.additionalTransform||"",x=[this.getSvgTransform(!0,y),this.getSvgCommons()].join(""),k=g.indexOf("COMMON_PARTS");return g[k]=x,f?f(g.join("")):g.join("")},_createBaseSVGMarkup:function(g,d){d=d||{};var f=d.noStyle,y=d.reviver,x=f?"":'style="'+this.getSvgStyles()+'" ',k=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",P=this.clipPath,S=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",E=P&&P.absolutePositioned,M=this.stroke,T=this.fill,D=this.shadow,N,I=[],O,F=g.indexOf("COMMON_PARTS"),q=d.additionalTransform;return P&&(P.clipPathId="CLIPPATH_"+n.Object.__uid++,O='<clipPath id="'+P.clipPathId+`" >
`+P.toClipPathSVG(y)+`</clipPath>
`),E&&I.push("<g ",k,this.getSvgCommons(),` >
`),I.push("<g ",this.getSvgTransform(!1),E?"":k+this.getSvgCommons(),` >
`),N=[x,S,f?"":this.addPaintOrder()," ",q?'transform="'+q+'" ':""].join(""),g[F]=N,T&&T.toLive&&I.push(T.toSVG(this)),M&&M.toLive&&I.push(M.toSVG(this)),D&&I.push(D.toSVG(this)),P&&I.push(O),I.push(g.join("")),I.push(`</g>
`),E&&I.push(`</g>
`),y?y(I.join("")):I.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var m=n.util.object.extend,v="stateProperties";function g(f,y,x){var k={},P=!0;x.forEach(function(S){k[S]=f[S]}),m(f[y],k,P)}function d(f,y,x){if(f===y)return!0;if(Array.isArray(f)){if(!Array.isArray(y)||f.length!==y.length)return!1;for(var k=0,P=f.length;k<P;k++)if(!d(f[k],y[k]))return!1;return!0}else if(f&&typeof f=="object"){var S=Object.keys(f),E;if(!y||typeof y!="object"||!x&&S.length!==Object.keys(y).length)return!1;for(var k=0,P=S.length;k<P;k++)if(E=S[k],!(E==="canvas"||E==="group")&&!d(f[E],y[E]))return!1;return!0}}n.util.object.extend(n.Object.prototype,{hasStateChanged:function(f){f=f||v;var y="_"+f;return Object.keys(this[y]).length<this[f].length?!0:!d(this[y],this,!0)},saveState:function(f){var y=f&&f.propertySet||v,x="_"+y;return this[x]?(g(this,x,this[y]),f&&f.stateProperties&&g(this,x,f.stateProperties),this):this.setupState(f)},setupState:function(f){f=f||{};var y=f.propertySet||v;return f.propertySet=y,this["_"+y]={},this.saveState(f),this}})}(),function(){var m=n.util.degreesToRadians;n.util.object.extend(n.Object.prototype,{_findTargetCorner:function(v,g){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=v.x,f=v.y,y,x,k=Object.keys(this.oCoords),P=k.length-1,S;for(this.__corner=0;P>=0;P--)if(S=k[P],!!this.isControlVisible(S)&&(x=this._getImageLines(g?this.oCoords[S].touchCorner:this.oCoords[S].corner),y=this._findCrossPoints({x:d,y:f},x),y!==0&&y%2===1))return this.__corner=S,S;return!1},forEachControl:function(v){for(var g in this.controls)v(this.controls[g],g,this)},_setCornerCoords:function(){var v=this.oCoords;for(var g in v){var d=this.controls[g];v[g].corner=d.calcCornerCoords(this.angle,this.cornerSize,v[g].x,v[g].y,!1),v[g].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,v[g].x,v[g].y,!0)}},drawSelectionBackground:function(v){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;v.save();var g=this.getCenterPoint(),d=this._calculateCurrentDimensions(),f=this.canvas.viewportTransform;return v.translate(g.x,g.y),v.scale(1/f[0],1/f[3]),v.rotate(m(this.angle)),v.fillStyle=this.selectionBackgroundColor,v.fillRect(-d.x/2,-d.y/2,d.x,d.y),v.restore(),this},drawBorders:function(v,g){g=g||{};var d=this._calculateCurrentDimensions(),f=this.borderScaleFactor,y=d.x+f,x=d.y+f,k=typeof g.hasControls<"u"?g.hasControls:this.hasControls,P=!1;return v.save(),v.strokeStyle=g.borderColor||this.borderColor,this._setLineDash(v,g.borderDashArray||this.borderDashArray),v.strokeRect(-y/2,-x/2,y,x),k&&(v.beginPath(),this.forEachControl(function(S,E,M){S.withConnection&&S.getVisibility(M,E)&&(P=!0,v.moveTo(S.x*y,S.y*x),v.lineTo(S.x*y+S.offsetX,S.y*x+S.offsetY))}),P&&v.stroke()),v.restore(),this},drawBordersInGroup:function(v,g,d){d=d||{};var f=n.util.sizeAfterTransform(this.width,this.height,g),y=this.strokeWidth,x=this.strokeUniform,k=this.borderScaleFactor,P=f.x+y*(x?this.canvas.getZoom():g.scaleX)+k,S=f.y+y*(x?this.canvas.getZoom():g.scaleY)+k;return v.save(),this._setLineDash(v,d.borderDashArray||this.borderDashArray),v.strokeStyle=d.borderColor||this.borderColor,v.strokeRect(-P/2,-S/2,P,S),v.restore(),this},drawControls:function(v,g){g=g||{},v.save();var d=1,f,y;return this.canvas&&(d=this.canvas.getRetinaScaling()),v.setTransform(d,0,0,d,0,0),v.strokeStyle=v.fillStyle=g.cornerColor||this.cornerColor,this.transparentCorners||(v.strokeStyle=g.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(v,g.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(x,k,P){y=P.oCoords[k],x.getVisibility(P,k)&&(f&&(y=n.util.transformPoint(y,f)),x.render(v,y.x,y.y,g,P))}),v.restore(),this},isControlVisible:function(v){return this.controls[v]&&this.controls[v].getVisibility(this,v)},setControlVisible:function(v,g){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[v]=g,this},setControlsVisibility:function(v){v||(v={});for(var g in v)this.setControlVisible(g,v[g]);return this},onDeselect:function(){},onSelect:function(){}})}(),n.util.object.extend(n.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(m,v){v=v||{};var g=function(){},d=v.onComplete||g,f=v.onChange||g,y=this;return n.util.animate({target:this,startValue:m.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(x){m.set("left",x),y.requestRenderAll(),f()},onComplete:function(){m.setCoords(),d()}})},fxCenterObjectV:function(m,v){v=v||{};var g=function(){},d=v.onComplete||g,f=v.onChange||g,y=this;return n.util.animate({target:this,startValue:m.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(x){m.set("top",x),y.requestRenderAll(),f()},onComplete:function(){m.setCoords(),d()}})},fxRemove:function(m,v){v=v||{};var g=function(){},d=v.onComplete||g,f=v.onChange||g,y=this;return n.util.animate({target:this,startValue:m.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(x){m.set("opacity",x),y.requestRenderAll(),f()},onComplete:function(){y.remove(m),d()}})}}),n.util.object.extend(n.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var m=[],v,g,d=[];for(v in arguments[0])m.push(v);for(var f=0,y=m.length;f<y;f++)v=m[f],g=f!==y-1,d.push(this._animate(v,arguments[0][v],arguments[1],g));return d}else return this._animate.apply(this,arguments)},_animate:function(m,v,g,d){var f=this,y;v=v.toString(),g?g=n.util.object.clone(g):g={},~m.indexOf(".")&&(y=m.split("."));var x=f.colorProperties.indexOf(m)>-1||y&&f.colorProperties.indexOf(y[1])>-1,k=y?this.get(y[0])[y[1]]:this.get(m);"from"in g||(g.from=k),x||(~v.indexOf("=")?v=k+parseFloat(v.replace("=","")):v=parseFloat(v));var P={target:this,startValue:g.from,endValue:v,byValue:g.by,easing:g.easing,duration:g.duration,abort:g.abort&&function(S,E,M){return g.abort.call(f,S,E,M)},onChange:function(S,E,M){y?f[y[0]][y[1]]=S:f.set(m,S),!d&&g.onChange&&g.onChange(S,E,M)},onComplete:function(S,E,M){d||(f.setCoords(),g.onComplete&&g.onComplete(S,E,M))}};return x?n.util.animateColor(P.startValue,P.endValue,P.duration,P):n.util.animate(P)}}),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.util.object.clone,f={x1:1,x2:1,y1:1,y2:1};if(v.Line){v.warn("fabric.Line is already defined");return}v.Line=v.util.createClass(v.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:v.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(x,k){x||(x=[0,0,0,0]),this.callSuper("initialize",k),this.set("x1",x[0]),this.set("y1",x[1]),this.set("x2",x[2]),this.set("y2",x[3]),this._setWidthHeight(k)},_setWidthHeight:function(x){x||(x={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in x?x.left:this._getLeftToOriginX(),this.top="top"in x?x.top:this._getTopToOriginY()},_set:function(x,k){return this.callSuper("_set",x,k),typeof f[x]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:y({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:y({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(x){x.beginPath();var k=this.calcLinePoints();x.moveTo(k.x1,k.y1),x.lineTo(k.x2,k.y2),x.lineWidth=this.strokeWidth;var P=x.strokeStyle;x.strokeStyle=this.stroke||x.fillStyle,this.stroke&&this._renderStroke(x),x.strokeStyle=P},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(x){return g(this.callSuper("toObject",x),this.calcLinePoints())},_getNonTransformedDimensions:function(){var x=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(x.y-=this.strokeWidth),this.height===0&&(x.x-=this.strokeWidth)),x},calcLinePoints:function(){var x=this.x1<=this.x2?-1:1,k=this.y1<=this.y2?-1:1,P=x*this.width*.5,S=k*this.height*.5,E=x*this.width*-.5,M=k*this.height*-.5;return{x1:P,x2:E,y1:S,y2:M}},_toSVG:function(){var x=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',x.x1,'" y1="',x.y1,'" x2="',x.x2,'" y2="',x.y2,`" />
`]}}),v.Line.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),v.Line.fromElement=function(x,k,P){P=P||{};var S=v.parseAttributes(x,v.Line.ATTRIBUTE_NAMES),E=[S.x1||0,S.y1||0,S.x2||0,S.y2||0];k(new v.Line(E,g(S,P)))},v.Line.fromObject=function(x,k){function P(E){delete E.points,k&&k(E)}var S=d(x,!0);S.points=[x.x1,x.y1,x.x2,x.y2],v.Object._fromObject("Line",S,P,"points")};function y(x,k){var P=x.origin,S=x.axis1,E=x.axis2,M=x.dimension,T=k.nearest,D=k.center,N=k.farthest;return function(){switch(this.get(P)){case T:return Math.min(this.get(S),this.get(E));case D:return Math.min(this.get(S),this.get(E))+.5*this.get(M);case N:return Math.max(this.get(S),this.get(E))}}}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.degreesToRadians;if(v.Circle){v.warn("fabric.Circle is already defined.");return}v.Circle=v.util.createClass(v.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:v.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,y){return this.callSuper("_set",f,y),f==="radius"&&this.setRadius(y),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,y=0,x=0,k=(this.endAngle-this.startAngle)%360;if(k===0)f=["<circle ","COMMON_PARTS",'cx="'+y+'" cy="'+x+'" ','r="',this.radius,`" />
`];else{var P=g(this.startAngle),S=g(this.endAngle),E=this.radius,M=v.util.cos(P)*E,T=v.util.sin(P)*E,D=v.util.cos(S)*E,N=v.util.sin(S)*E,I=k>180?"1":"0";f=['<path d="M '+M+" "+T," A "+E+" "+E," 0 ",+I+" 1"," "+D+" "+N,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,g(this.startAngle),g(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",f*2).set("height",f*2)}}),v.Circle.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),v.Circle.fromElement=function(f,y){var x=v.parseAttributes(f,v.Circle.ATTRIBUTE_NAMES);if(!d(x))throw new Error("value of `r` attribute is required and can not be negative");x.left=(x.left||0)-x.radius,x.top=(x.top||0)-x.radius,y(new v.Circle(x))};function d(f){return"radius"in f&&f.radius>=0}v.Circle.fromObject=function(f,y){v.Object._fromObject("Circle",f,y)}}(e),function(m){var v=m.fabric||(m.fabric={});if(v.Triangle){v.warn("fabric.Triangle is already defined");return}v.Triangle=v.util.createClass(v.Object,{type:"triangle",width:100,height:100,_render:function(g){var d=this.width/2,f=this.height/2;g.beginPath(),g.moveTo(-d,f),g.lineTo(0,-f),g.lineTo(d,f),g.closePath(),this._renderPaintInOrder(g)},_toSVG:function(){var g=this.width/2,d=this.height/2,f=[-g+" "+d,"0 "+-d,g+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',f,'" />']}}),v.Triangle.fromObject=function(g,d){return v.Object._fromObject("Triangle",g,d)}}(e),function(m){var v=m.fabric||(m.fabric={}),g=Math.PI*2;if(v.Ellipse){v.warn("fabric.Ellipse is already defined.");return}v.Ellipse=v.util.createClass(v.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:v.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,f){switch(this.callSuper("_set",d,f),d){case"rx":this.rx=f,this.set("width",f*2);break;case"ry":this.ry=f,this.set("height",f*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,g,!1),d.restore(),this._renderPaintInOrder(d)}}),v.Ellipse.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),v.Ellipse.fromElement=function(d,f){var y=v.parseAttributes(d,v.Ellipse.ATTRIBUTE_NAMES);y.left=(y.left||0)-y.rx,y.top=(y.top||0)-y.ry,f(new v.Ellipse(y))},v.Ellipse.fromObject=function(d,f){v.Object._fromObject("Ellipse",d,f)}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend;if(v.Rect){v.warn("fabric.Rect is already defined");return}v.Rect=v.util.createClass(v.Object,{stateProperties:v.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:v.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var f=this.rx?Math.min(this.rx,this.width/2):0,y=this.ry?Math.min(this.ry,this.height/2):0,x=this.width,k=this.height,P=-this.width/2,S=-this.height/2,E=f!==0||y!==0,M=1-.5522847498;d.beginPath(),d.moveTo(P+f,S),d.lineTo(P+x-f,S),E&&d.bezierCurveTo(P+x-M*f,S,P+x,S+M*y,P+x,S+y),d.lineTo(P+x,S+k-y),E&&d.bezierCurveTo(P+x,S+k-M*y,P+x-M*f,S+k,P+x-f,S+k),d.lineTo(P+f,S+k),E&&d.bezierCurveTo(P+M*f,S+k,P,S+k-M*y,P,S+k-y),d.lineTo(P,S+y),E&&d.bezierCurveTo(P,S+M*y,P+M*f,S,P+f,S),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,f=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',f,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),v.Rect.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),v.Rect.fromElement=function(d,f,y){if(!d)return f(null);y=y||{};var x=v.parseAttributes(d,v.Rect.ATTRIBUTE_NAMES);x.left=x.left||0,x.top=x.top||0,x.height=x.height||0,x.width=x.width||0;var k=new v.Rect(g(y?v.util.object.clone(y):{},x));k.visible=k.visible&&k.width>0&&k.height>0,f(k)},v.Rect.fromObject=function(d,f){return v.Object._fromObject("Rect",d,f)}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.util.array.min,f=v.util.array.max,y=v.util.toFixed,x=v.util.projectStrokeOnPoints;if(v.Polyline){v.warn("fabric.Polyline is already defined");return}v.Polyline=v.util.createClass(v.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:v.Object.prototype.cacheProperties.concat("points"),initialize:function(k,P){P=P||{},this.points=k||[],this.callSuper("initialize",P),this._setPositionDimensions(P)},_projectStrokeOnPoints:function(){return x(this.points,this,!0)},_setPositionDimensions:function(k){var P=this._calcDimensions(k),S,E=this.exactBoundingBox?this.strokeWidth:0;this.width=P.width-E,this.height=P.height-E,k.fromSVG||(S=this.translateToGivenOrigin({x:P.left-this.strokeWidth/2+E/2,y:P.top-this.strokeWidth/2+E/2},"left","top",this.originX,this.originY)),typeof k.left>"u"&&(this.left=k.fromSVG?P.left:S.x),typeof k.top>"u"&&(this.top=k.fromSVG?P.top:S.y),this.pathOffset={x:P.left+this.width/2+E/2,y:P.top+this.height/2+E/2}},_calcDimensions:function(){var k=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,P=d(k,"x")||0,S=d(k,"y")||0,E=f(k,"x")||0,M=f(k,"y")||0,T=E-P,D=M-S;return{left:P,top:S,width:T,height:D}},toObject:function(k){return g(this.callSuper("toObject",k),{points:this.points.concat()})},_toSVG:function(){for(var k=[],P=this.pathOffset.x,S=this.pathOffset.y,E=v.Object.NUM_FRACTION_DIGITS,M=0,T=this.points.length;M<T;M++)k.push(y(this.points[M].x-P,E),",",y(this.points[M].y-S,E)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',k.join(""),`" />
`]},commonRender:function(k){var P,S=this.points.length,E=this.pathOffset.x,M=this.pathOffset.y;if(!S||isNaN(this.points[S-1].y))return!1;k.beginPath(),k.moveTo(this.points[0].x-E,this.points[0].y-M);for(var T=0;T<S;T++)P=this.points[T],k.lineTo(P.x-E,P.y-M);return!0},_render:function(k){!this.commonRender(k)||this._renderPaintInOrder(k)},complexity:function(){return this.get("points").length}}),v.Polyline.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat(),v.Polyline.fromElementGenerator=function(k){return function(P,S,E){if(!P)return S(null);E||(E={});var M=v.parsePointsAttribute(P.getAttribute("points")),T=v.parseAttributes(P,v[k].ATTRIBUTE_NAMES);T.fromSVG=!0,S(new v[k](M,g(T,E)))}},v.Polyline.fromElement=v.Polyline.fromElementGenerator("Polyline"),v.Polyline.fromObject=function(k,P){return v.Object._fromObject("Polyline",k,P,"points")}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.projectStrokeOnPoints;if(v.Polygon){v.warn("fabric.Polygon is already defined");return}v.Polygon=v.util.createClass(v.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return g(this.points,this)},_render:function(d){!this.commonRender(d)||(d.closePath(),this._renderPaintInOrder(d))}}),v.Polygon.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat(),v.Polygon.fromElement=v.Polyline.fromElementGenerator("Polygon"),v.Polygon.fromObject=function(d,f){v.Object._fromObject("Polygon",d,f,"points")}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.array.min,d=v.util.array.max,f=v.util.object.extend,y=v.util.object.clone,x=v.util.toFixed;if(v.Path){v.warn("fabric.Path is already defined");return}v.Path=v.util.createClass(v.Object,{type:"path",path:null,cacheProperties:v.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:v.Object.prototype.stateProperties.concat("path"),initialize:function(k,P){P=y(P||{}),delete P.path,this.callSuper("initialize",P),this._setPath(k||[],P)},_setPath:function(k,P){this.path=v.util.makePathSimpler(Array.isArray(k)?k:v.util.parsePath(k)),v.Polyline.prototype._setPositionDimensions.call(this,P||{})},_renderPathCommands:function(k){var P,S=0,E=0,M=0,T=0,D=0,N=0,I=-this.pathOffset.x,O=-this.pathOffset.y;k.beginPath();for(var F=0,q=this.path.length;F<q;++F)switch(P=this.path[F],P[0]){case"L":M=P[1],T=P[2],k.lineTo(M+I,T+O);break;case"M":M=P[1],T=P[2],S=M,E=T,k.moveTo(M+I,T+O);break;case"C":M=P[5],T=P[6],D=P[3],N=P[4],k.bezierCurveTo(P[1]+I,P[2]+O,D+I,N+O,M+I,T+O);break;case"Q":k.quadraticCurveTo(P[1]+I,P[2]+O,P[3]+I,P[4]+O),M=P[3],T=P[4],D=P[1],N=P[2];break;case"z":case"Z":M=S,T=E,k.closePath();break}},_render:function(k){this._renderPathCommands(k),this._renderPaintInOrder(k)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(k){return f(this.callSuper("toObject",k),{path:this.path.map(function(P){return P.slice()})})},toDatalessObject:function(k){var P=this.toObject(["sourcePath"].concat(k));return P.sourcePath&&delete P.path,P},_toSVG:function(){var k=v.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',k,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var k=v.Object.NUM_FRACTION_DIGITS;return" translate("+x(-this.pathOffset.x,k)+", "+x(-this.pathOffset.y,k)+")"},toClipPathSVG:function(k){var P=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:k,additionalTransform:P})},toSVG:function(k){var P=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:k,additionalTransform:P})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var k=[],P=[],S,E=0,M=0,T=0,D=0,N,I=0,O=this.path.length;I<O;++I){switch(S=this.path[I],S[0]){case"L":T=S[1],D=S[2],N=[];break;case"M":T=S[1],D=S[2],E=T,M=D,N=[];break;case"C":N=v.util.getBoundsOfCurve(T,D,S[1],S[2],S[3],S[4],S[5],S[6]),T=S[5],D=S[6];break;case"Q":N=v.util.getBoundsOfCurve(T,D,S[1],S[2],S[1],S[2],S[3],S[4]),T=S[3],D=S[4];break;case"z":case"Z":T=E,D=M;break}N.forEach(function(J){k.push(J.x),P.push(J.y)}),k.push(T),P.push(D)}var F=g(k)||0,q=g(P)||0,Y=d(k)||0,_e=d(P)||0,ne=Y-F,ve=_e-q;return{left:F,top:q,width:ne,height:ve}}}),v.Path.fromObject=function(k,P){if(typeof k.sourcePath=="string"){var S=k.sourcePath;v.loadSVGFromURL(S,function(E){var M=E[0];M.setOptions(k),k.clipPath?v.util.enlivenObjects([k.clipPath],function(T){M.clipPath=T[0],P&&P(M)}):P&&P(M)})}else v.Object._fromObject("Path",k,P,"path")},v.Path.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat(["d"]),v.Path.fromElement=function(k,P,S){var E=v.parseAttributes(k,v.Path.ATTRIBUTE_NAMES);E.fromSVG=!0,P(new v.Path(E.d,f(E,S)))}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.array.min,d=v.util.array.max;v.Group||(v.Group=v.util.createClass(v.Object,v.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(f,y,x){y=y||{},this._objects=[],x&&this.callSuper("initialize",y),this._objects=f||[];for(var k=this._objects.length;k--;)this._objects[k].group=this;if(x)this._updateObjectsACoords();else{var P=y&&y.centerPoint;y.originX!==void 0&&(this.originX=y.originX),y.originY!==void 0&&(this.originY=y.originY),P||this._calcBounds(),this._updateObjectsCoords(P),delete y.centerPoint,this.callSuper("initialize",y)}this.setCoords()},_updateObjectsACoords:function(){for(var f=!0,y=this._objects.length;y--;)this._objects[y].setCoords(f)},_updateObjectsCoords:function(y){for(var y=y||this.getCenterPoint(),x=this._objects.length;x--;)this._updateObjectCoords(this._objects[x],y)},_updateObjectCoords:function(f,y){var x=f.left,k=f.top,P=!0;f.set({left:x-y.x,top:k-y.y}),f.group=this,f.setCoords(P)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(f){var y=!!this.group;return this._restoreObjectsState(),v.util.resetObjectTransform(this),f&&(y&&v.util.removeTransformFromObject(f,this.group.calcTransformMatrix()),this._objects.push(f),f.group=this,f._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,y?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(f){return this._restoreObjectsState(),v.util.resetObjectTransform(this),this.remove(f),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(f){this.dirty=!0,f.group=this,f._set("canvas",this.canvas)},_onObjectRemoved:function(f){this.dirty=!0,delete f.group},_set:function(f,y){var x=this._objects.length;if(this.useSetOnGroup)for(;x--;)this._objects[x].setOnGroup(f,y);if(f==="canvas")for(;x--;)this._objects[x]._set(f,y);v.Object.prototype._set.call(this,f,y)},toObject:function(f){var y=this.includeDefaultValues,x=this._objects.filter(function(P){return!P.excludeFromExport}).map(function(P){var S=P.includeDefaultValues;P.includeDefaultValues=y;var E=P.toObject(f);return P.includeDefaultValues=S,E}),k=v.Object.prototype.toObject.call(this,f);return k.objects=x,k},toDatalessObject:function(f){var y,x=this.sourcePath;if(x)y=x;else{var k=this.includeDefaultValues;y=this._objects.map(function(S){var E=S.includeDefaultValues;S.includeDefaultValues=k;var M=S.toDatalessObject(f);return S.includeDefaultValues=E,M})}var P=v.Object.prototype.toDatalessObject.call(this,f);return P.objects=y,P},render:function(f){this._transformDone=!0,this.callSuper("render",f),this._transformDone=!1},shouldCache:function(){var f=v.Object.prototype.shouldCache.call(this);if(f){for(var y=0,x=this._objects.length;y<x;y++)if(this._objects[y].willDrawShadow())return this.ownCaching=!1,!1}return f},willDrawShadow:function(){if(v.Object.prototype.willDrawShadow.call(this))return!0;for(var f=0,y=this._objects.length;f<y;f++)if(this._objects[f].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(f){for(var y=0,x=this._objects.length;y<x;y++)this._objects[y].render(f);this._drawClipPath(f,this.clipPath)},isCacheDirty:function(f){if(this.callSuper("isCacheDirty",f))return!0;if(!this.statefullCache)return!1;for(var y=0,x=this._objects.length;y<x;y++)if(this._objects[y].isCacheDirty(!0)){if(this._cacheCanvas){var k=this.cacheWidth/this.zoomX,P=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-k/2,-P/2,k,P)}return!0}return!1},_restoreObjectsState:function(){var f=this.calcOwnMatrix();return this._objects.forEach(function(y){v.util.addTransformToObject(y,f),delete y.group,y.setCoords()}),this},destroy:function(){return this._objects.forEach(function(f){f.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(f){f.dispose&&f.dispose()}),this._objects=[]},toActiveSelection:function(){if(!!this.canvas){var f=this._objects,y=this.canvas;this._objects=[];var x=this.toObject();delete x.objects;var k=new v.ActiveSelection([]);return k.set(x),k.type="activeSelection",y.remove(this),f.forEach(function(P){P.group=k,P.dirty=!0,y.add(P)}),k.canvas=y,k._objects=f,y._activeObject=k,k.setCoords(),k}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var f=!0;return this.forEachObject(function(y){y.setCoords(f)}),this},_calcBounds:function(f){for(var y=[],x=[],k,P,S,E=["tr","br","bl","tl"],M=0,T=this._objects.length,D,N=E.length;M<T;++M){for(k=this._objects[M],S=k.calcACoords(),D=0;D<N;D++)P=E[D],y.push(S[P].x),x.push(S[P].y);k.aCoords=S}this._getBounds(y,x,f)},_getBounds:function(f,y,x){var k=new v.Point(g(f),g(y)),P=new v.Point(d(f),d(y)),S=k.y||0,E=k.x||0,M=P.x-k.x||0,T=P.y-k.y||0;this.width=M,this.height=T,x||this.setPositionByOrigin({x:E,y:S},"left","top")},_toSVG:function(f){for(var y=["<g ","COMMON_PARTS",` >
`],x=0,k=this._objects.length;x<k;x++)y.push("		",this._objects[x].toSVG(f));return y.push(`</g>
`),y},getSvgStyles:function(){var f=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",y=this.visible?"":" visibility: hidden;";return[f,this.getSvgFilter(),y].join("")},toClipPathSVG:function(f){for(var y=[],x=0,k=this._objects.length;x<k;x++)y.push("	",this._objects[x].toClipPathSVG(f));return this._createBaseClipPathSVGMarkup(y,{reviver:f})}}),v.Group.fromObject=function(f,y){var x=f.objects,k=v.util.object.clone(f,!0);if(delete k.objects,typeof x=="string"){v.loadSVGFromURL(x,function(P){var S=v.util.groupSVGElements(P,f,x),E=k.clipPath;delete k.clipPath,S.set(k),E?v.util.enlivenObjects([E],function(M){S.clipPath=M[0],y&&y(S)}):y&&y(S)});return}v.util.enlivenObjects(x,function(P){v.util.enlivenObjectEnlivables(f,k,function(){y&&y(new v.Group(P,k,!0))})})})}(e),function(m){var v=m.fabric||(m.fabric={});v.ActiveSelection||(v.ActiveSelection=v.util.createClass(v.Group,{type:"activeSelection",initialize:function(g,d){d=d||{},this._objects=g||[];for(var f=this._objects.length;f--;)this._objects[f].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),v.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var g=this._objects.concat();this._objects=[];var d=v.Object.prototype.toObject.call(this),f=new v.Group([]);if(delete d.type,f.set(d),g.forEach(function(x){x.canvas.remove(x),x.group=f}),f._objects=g,!this.canvas)return f;var y=this.canvas;return y.add(f),y._activeObject=f,f.setCoords(),f},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(g,d,f){g.save(),g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,f=f||{},typeof f.hasControls>"u"&&(f.hasControls=!1),f.forActiveSelection=!0;for(var y=0,x=this._objects.length;y<x;y++)this._objects[y]._renderControls(g,f);this.callSuper("_renderControls",g,d),g.restore()}}),v.ActiveSelection.fromObject=function(g,d){v.util.enlivenObjects(g.objects,function(f){delete g.objects,d&&d(new v.ActiveSelection(f,g,!0))})})}(e),function(m){var v=n.util.object.extend;if(m.fabric||(m.fabric={}),m.fabric.Image){n.warn("fabric.Image is already defined.");return}n.Image=n.util.createClass(n.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:n.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:n.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(g,d){d||(d={}),this.filters=[],this.cacheKey="texture"+n.Object.__uid++,this.callSuper("initialize",d),this._initElement(g,d)},getElement:function(){return this._element||{}},setElement:function(g,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=g,this._originalElement=g,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(g){var d=n.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(g)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(g){n.util.cleanUpJsdomNode(this[g]),this[g]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var g=this.getElement();return{width:g.naturalWidth||g.width,height:g.naturalHeight||g.height}},_stroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,f=this.height/2;g.beginPath(),g.moveTo(-d,-f),g.lineTo(d,-f),g.lineTo(d,f),g.lineTo(-d,f),g.lineTo(-d,-f),g.closePath()}},toObject:function(g){var d=[];this.filters.forEach(function(y){y&&d.push(y.toObject())});var f=v(this.callSuper("toObject",["cropX","cropY"].concat(g)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(f.resizeFilter=this.resizeFilter.toObject()),f},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var g=[],d=[],f,y=this._element,x=-this.width/2,k=-this.height/2,P="",S="";if(!y)return[];if(this.hasCrop()){var E=n.Object.__uid++;g.push('<clipPath id="imageCrop_'+E+`">
`,'	<rect x="'+x+'" y="'+k+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),P=' clip-path="url(#imageCrop_'+E+')" '}if(this.imageSmoothing||(S='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',x-this.cropX,'" y="',k-this.cropY,'" width="',y.width||y.naturalWidth,'" height="',y.height||y.height,S,'"',P,`></image>
`),this.stroke||this.strokeDashArray){var M=this.fill;this.fill=null,f=["	<rect ",'x="',x,'" y="',k,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=M}return this.paintFirst!=="fill"?g=g.concat(f,d):g=g.concat(d,f),g},getSrc:function(g){var d=g?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(g,d,f){return n.util.loadImage(g,function(y,x){this.setElement(y,f),this._setWidthHeight(),d&&d(this,x)},this,f&&f.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var g=this.resizeFilter,d=this.minimumScaleTrigger,f=this.getTotalObjectScaling(),y=f.scaleX,x=f.scaleY,k=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!g||y>d&&x>d){this._element=k,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=y,this._lastScaleY=x;return}n.filterBackend||(n.filterBackend=n.initFilterBackend());var P=n.util.createCanvasElement(),S=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,E=k.width,M=k.height;P.width=E,P.height=M,this._element=P,this._lastScaleX=g.scaleX=y,this._lastScaleY=g.scaleY=x,n.filterBackend.applyFilters([g],k,E,M,this._element,S),this._filterScalingX=P.width/this._originalElement.width,this._filterScalingY=P.height/this._originalElement.height},applyFilters:function(g){if(g=g||this.filters||[],g=g.filter(function(k){return k&&!k.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),g.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,f=d.naturalWidth||d.width,y=d.naturalHeight||d.height;if(this._element===this._originalElement){var x=n.util.createCanvasElement();x.width=f,x.height=y,this._element=x,this._filteredEl=x}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,f,y),this._lastScaleX=1,this._lastScaleY=1;return n.filterBackend||(n.filterBackend=n.initFilterBackend()),n.filterBackend.applyFilters(g,this._originalElement,f,y,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(g){n.util.setImageSmoothing(g,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(g),this._renderPaintInOrder(g)},drawCacheOnCanvas:function(g){n.util.setImageSmoothing(g,this.imageSmoothing),n.Object.prototype.drawCacheOnCanvas.call(this,g)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(g){var d=this._element;if(!!d){var f=this._filterScalingX,y=this._filterScalingY,x=this.width,k=this.height,P=Math.min,S=Math.max,E=S(this.cropX,0),M=S(this.cropY,0),T=d.naturalWidth||d.width,D=d.naturalHeight||d.height,N=E*f,I=M*y,O=P(x*f,T-N),F=P(k*y,D-I),q=-x/2,Y=-k/2,_e=P(x,T/f-E),ne=P(k,D/y-M);d&&g.drawImage(d,N,I,O,F,q,Y,_e,ne)}},_needsResize:function(){var g=this.getTotalObjectScaling();return g.scaleX!==this._lastScaleX||g.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(g,d){this.setElement(n.util.getById(g),d),n.util.addClass(this.getElement(),n.Image.CSS_CANVAS)},_initConfig:function(g){g||(g={}),this.setOptions(g),this._setWidthHeight(g)},_initFilters:function(g,d){g&&g.length?n.util.enlivenObjects(g,function(f){d&&d(f)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(g){g||(g={});var d=this.getElement();this.width=g.width||d.naturalWidth||d.width||0,this.height=g.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var g=n.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,f=this._element.height,y=1,x=1,k=0,P=0,S=0,E=0,M,T=this.width,D=this.height,N={width:T,height:D};return g&&(g.alignX!=="none"||g.alignY!=="none")?(g.meetOrSlice==="meet"&&(y=x=n.util.findScaleToFit(this._element,N),M=(T-d*y)/2,g.alignX==="Min"&&(k=-M),g.alignX==="Max"&&(k=M),M=(D-f*x)/2,g.alignY==="Min"&&(P=-M),g.alignY==="Max"&&(P=M)),g.meetOrSlice==="slice"&&(y=x=n.util.findScaleToCover(this._element,N),M=d-T/y,g.alignX==="Mid"&&(S=M/2),g.alignX==="Max"&&(S=M),M=f-D/x,g.alignY==="Mid"&&(E=M/2),g.alignY==="Max"&&(E=M),d=T/y,f=D/x)):(y=T/d,x=D/f),{width:d,height:f,scaleX:y,scaleY:x,offsetLeft:k,offsetTop:P,cropX:S,cropY:E}}}),n.Image.CSS_CANVAS="canvas-img",n.Image.prototype.getSvgSrc=n.Image.prototype.getSrc,n.Image.fromObject=function(g,d){var f=n.util.object.clone(g);n.util.loadImage(f.src,function(y,x){if(x){d&&d(null,!0);return}n.Image.prototype._initFilters.call(f,f.filters,function(k){f.filters=k||[],n.Image.prototype._initFilters.call(f,[f.resizeFilter],function(P){f.resizeFilter=P[0],n.util.enlivenObjectEnlivables(f,f,function(){var S=new n.Image(y,f);d(S,!1)})})})},null,f.crossOrigin)},n.Image.fromURL=function(g,d,f){n.util.loadImage(g,function(y,x){d&&d(new n.Image(y,f),x)},null,f&&f.crossOrigin)},n.Image.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),n.Image.fromElement=function(g,d,f){var y=n.parseAttributes(g,n.Image.ATTRIBUTE_NAMES);n.Image.fromURL(y["xlink:href"],d,v(f?n.util.object.clone(f):{},y))}}(e),n.util.object.extend(n.Object.prototype,{_getAngleValueForStraighten:function(){var m=this.angle%360;return m>0?Math.round((m-1)/90)*90:Math.round(m/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(m){m=m||{};var v=function(){},g=m.onComplete||v,d=m.onChange||v,f=this;return n.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(y){f.rotate(y),d()},onComplete:function(){f.setCoords(),g()}})}}),n.util.object.extend(n.StaticCanvas.prototype,{straightenObject:function(m){return m.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(m){return m.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function m(g,d){var f="precision "+d+` float;
void main(){}`,y=g.createShader(g.FRAGMENT_SHADER);return g.shaderSource(y,f),g.compileShader(y),!!g.getShaderParameter(y,g.COMPILE_STATUS)}n.isWebglSupported=function(g){if(n.isLikelyNode)return!1;g=g||n.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),f=d.getContext("webgl")||d.getContext("experimental-webgl"),y=!1;if(f){n.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),y=n.maxTextureSize>=g;for(var x=["highp","mediump","lowp"],k=0;k<3;k++)if(m(f,x[k])){n.webGlPrecision=x[k];break}}return this.isSupported=y,y},n.WebglFilterBackend=v;function v(g){g&&g.tileSize&&(this.tileSize=g.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}v.prototype={tileSize:2048,resources:{},setupGLContext:function(g,d){this.dispose(),this.createWebGLCanvas(g,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(g,d)},chooseFastestCopyGLTo2DMethod:function(g,d){var f=typeof window.performance<"u",y;try{new ImageData(1,1),y=!0}catch{y=!1}var x=typeof ArrayBuffer<"u",k=typeof Uint8ClampedArray<"u";if(!!(f&&y&&x&&k)){var P=n.util.createCanvasElement(),S=new ArrayBuffer(g*d*4);if(n.forceGLPutImageData){this.imageBuffer=S,this.copyGLTo2D=w;return}var E={imageBuffer:S,destinationWidth:g,destinationHeight:d,targetCanvas:P},M,T,D;P.width=g,P.height=d,M=window.performance.now(),s.call(E,this.gl,E),T=window.performance.now()-M,M=window.performance.now(),w.call(E,this.gl,E),D=window.performance.now()-M,T>D?(this.imageBuffer=S,this.copyGLTo2D=w):this.copyGLTo2D=s}},createWebGLCanvas:function(g,d){var f=n.util.createCanvasElement();f.width=g,f.height=d;var y={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},x=f.getContext("webgl",y);x||(x=f.getContext("experimental-webgl",y)),x&&(x.clearColor(0,0,0,0),this.canvas=f,this.gl=x)},applyFilters:function(g,d,f,y,x,k){var P=this.gl,S;k&&(S=this.getCachedTexture(k,d));var E={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:f,sourceHeight:y,destinationWidth:f,destinationHeight:y,context:P,sourceTexture:this.createTexture(P,f,y,!S&&d),targetTexture:this.createTexture(P,f,y),originalTexture:S||this.createTexture(P,f,y,!S&&d),passes:g.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:x},M=P.createFramebuffer();return P.bindFramebuffer(P.FRAMEBUFFER,M),g.forEach(function(T){T&&T.applyTo(E)}),u(E),this.copyGLTo2D(P,E),P.bindTexture(P.TEXTURE_2D,null),P.deleteTexture(E.sourceTexture),P.deleteTexture(E.targetTexture),P.deleteFramebuffer(M),x.getContext("2d").setTransform(1,0,0,1,0,0),E},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(g,d,f,y,x){var k=g.createTexture();return g.bindTexture(g.TEXTURE_2D,k),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,x||g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,x||g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),y?g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,y):g.texImage2D(g.TEXTURE_2D,0,g.RGBA,d,f,0,g.RGBA,g.UNSIGNED_BYTE,null),k},getCachedTexture:function(g,d){if(this.textureCache[g])return this.textureCache[g];var f=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[g]=f,f},evictCachesForKey:function(g){this.textureCache[g]&&(this.gl.deleteTexture(this.textureCache[g]),delete this.textureCache[g])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var g=this.gl,d={renderer:"",vendor:""};if(!g)return d;var f=g.getExtension("WEBGL_debug_renderer_info");if(f){var y=g.getParameter(f.UNMASKED_RENDERER_WEBGL),x=g.getParameter(f.UNMASKED_VENDOR_WEBGL);y&&(d.renderer=y.toLowerCase()),x&&(d.vendor=x.toLowerCase())}return this.gpuInfo=d,d}}}();function u(m){var v=m.targetCanvas,g=v.width,d=v.height,f=m.destinationWidth,y=m.destinationHeight;(g!==f||d!==y)&&(v.width=f,v.height=y)}function s(m,v){var g=m.canvas,d=v.targetCanvas,f=d.getContext("2d");f.translate(0,d.height),f.scale(1,-1);var y=g.height-d.height;f.drawImage(g,0,y,d.width,d.height,0,0,d.width,d.height)}function w(m,v){var g=v.targetCanvas,d=g.getContext("2d"),f=v.destinationWidth,y=v.destinationHeight,x=f*y*4,k=new Uint8Array(this.imageBuffer,0,x),P=new Uint8ClampedArray(this.imageBuffer,0,x);m.readPixels(0,0,f,y,m.RGBA,m.UNSIGNED_BYTE,k);var S=new ImageData(P,f,y);d.putImageData(S,0,0)}(function(){var m=function(){};n.Canvas2dFilterBackend=v;function v(){}v.prototype={evictCachesForKey:m,dispose:m,clearWebGLCaches:m,resources:{},applyFilters:function(g,d,f,y,x){var k=x.getContext("2d");k.drawImage(d,0,0,f,y);var P=k.getImageData(0,0,f,y),S=k.getImageData(0,0,f,y),E={sourceWidth:f,sourceHeight:y,imageData:P,originalEl:d,originalImageData:S,canvasEl:x,ctx:k,filterBackend:this};return g.forEach(function(M){M.applyTo(E)}),(E.imageData.width!==f||E.imageData.height!==y)&&(x.width=E.imageData.width,x.height=E.imageData.height),k.putImageData(E.imageData,0,0),E}}})(),n.Image=n.Image||{},n.Image.filters=n.Image.filters||{},n.Image.filters.BaseFilter=n.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(m){m&&this.setOptions(m)},setOptions:function(m){for(var v in m)this[v]=m[v]},createProgram:function(m,v,g){v=v||this.fragmentSource,g=g||this.vertexSource,n.webGlPrecision!=="highp"&&(v=v.replace(/precision highp float/g,"precision "+n.webGlPrecision+" float"));var d=m.createShader(m.VERTEX_SHADER);if(m.shaderSource(d,g),m.compileShader(d),!m.getShaderParameter(d,m.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+m.getShaderInfoLog(d));var f=m.createShader(m.FRAGMENT_SHADER);if(m.shaderSource(f,v),m.compileShader(f),!m.getShaderParameter(f,m.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+m.getShaderInfoLog(f));var y=m.createProgram();if(m.attachShader(y,d),m.attachShader(y,f),m.linkProgram(y),!m.getProgramParameter(y,m.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+m.getProgramInfoLog(y));var x=this.getAttributeLocations(m,y),k=this.getUniformLocations(m,y)||{};return k.uStepW=m.getUniformLocation(y,"uStepW"),k.uStepH=m.getUniformLocation(y,"uStepH"),{program:y,attributeLocations:x,uniformLocations:k}},getAttributeLocations:function(m,v){return{aPosition:m.getAttribLocation(v,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(m,v,g){var d=v.aPosition,f=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,f),m.enableVertexAttribArray(d),m.vertexAttribPointer(d,2,m.FLOAT,!1,0,0),m.bufferData(m.ARRAY_BUFFER,g,m.STATIC_DRAW)},_setupFrameBuffer:function(m){var v=m.context,g,d;m.passes>1?(g=m.destinationWidth,d=m.destinationHeight,(m.sourceWidth!==g||m.sourceHeight!==d)&&(v.deleteTexture(m.targetTexture),m.targetTexture=m.filterBackend.createTexture(v,g,d)),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,m.targetTexture,0)):(v.bindFramebuffer(v.FRAMEBUFFER,null),v.finish())},_swapTextures:function(m){m.passes--,m.pass++;var v=m.targetTexture;m.targetTexture=m.sourceTexture,m.sourceTexture=v},isNeutralState:function(){var m=this.mainParameter,v=n.Image.filters[this.type].prototype;if(m)if(Array.isArray(v[m])){for(var g=v[m].length;g--;)if(this[m][g]!==v[m][g])return!1;return!0}else return v[m]===this[m];else return!1},applyTo:function(m){m.webgl?(this._setupFrameBuffer(m),this.applyToWebGL(m),this._swapTextures(m)):this.applyTo2d(m)},retrieveShader:function(m){return m.programCache.hasOwnProperty(this.type)||(m.programCache[this.type]=this.createProgram(m.context)),m.programCache[this.type]},applyToWebGL:function(m){var v=m.context,g=this.retrieveShader(m);m.pass===0&&m.originalTexture?v.bindTexture(v.TEXTURE_2D,m.originalTexture):v.bindTexture(v.TEXTURE_2D,m.sourceTexture),v.useProgram(g.program),this.sendAttributeData(v,g.attributeLocations,m.aPosition),v.uniform1f(g.uniformLocations.uStepW,1/m.sourceWidth),v.uniform1f(g.uniformLocations.uStepH,1/m.sourceHeight),this.sendUniformData(v,g.uniformLocations),v.viewport(0,0,m.destinationWidth,m.destinationHeight),v.drawArrays(v.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(m,v,g){m.activeTexture(g),m.bindTexture(m.TEXTURE_2D,v),m.activeTexture(m.TEXTURE0)},unbindAdditionalTexture:function(m,v){m.activeTexture(v),m.bindTexture(m.TEXTURE_2D,null),m.activeTexture(m.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(m){this[this.mainParameter]=m},sendUniformData:function(){},createHelpLayer:function(m){if(!m.helpLayer){var v=document.createElement("canvas");v.width=m.sourceWidth,v.height=m.sourceHeight,m.helpLayer=v}},toObject:function(){var m={type:this.type},v=this.mainParameter;return v&&(m[v]=this[v]),m},toJSON:function(){return this.toObject()}}),n.Image.filters.BaseFilter.fromObject=function(m,v){var g=new n.Image.filters[m.type](m);return v&&v(g),g},function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.ColorMatrix=d(g.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(f){this.callSuper("initialize",f),this.matrix=this.matrix.slice(0)},applyTo2d:function(f){var y=f.imageData,x=y.data,k=x.length,P=this.matrix,S,E,M,T,D,N=this.colorsOnly;for(D=0;D<k;D+=4)S=x[D],E=x[D+1],M=x[D+2],N?(x[D]=S*P[0]+E*P[1]+M*P[2]+P[4]*255,x[D+1]=S*P[5]+E*P[6]+M*P[7]+P[9]*255,x[D+2]=S*P[10]+E*P[11]+M*P[12]+P[14]*255):(T=x[D+3],x[D]=S*P[0]+E*P[1]+M*P[2]+T*P[3]+P[4]*255,x[D+1]=S*P[5]+E*P[6]+M*P[7]+T*P[8]+P[9]*255,x[D+2]=S*P[10]+E*P[11]+M*P[12]+T*P[13]+P[14]*255,x[D+3]=S*P[15]+E*P[16]+M*P[17]+T*P[18]+P[19]*255)},getUniformLocations:function(f,y){return{uColorMatrix:f.getUniformLocation(y,"uColorMatrix"),uConstants:f.getUniformLocation(y,"uConstants")}},sendUniformData:function(f,y){var x=this.matrix,k=[x[0],x[1],x[2],x[3],x[5],x[6],x[7],x[8],x[10],x[11],x[12],x[13],x[15],x[16],x[17],x[18]],P=[x[4],x[9],x[14],x[19]];f.uniformMatrix4fv(y.uColorMatrix,!1,k),f.uniform4fv(y.uConstants,P)}}),v.Image.filters.ColorMatrix.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Brightness=d(g.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(f){if(this.brightness!==0){var y=f.imageData,x=y.data,k,P=x.length,S=Math.round(this.brightness*255);for(k=0;k<P;k+=4)x[k]=x[k]+S,x[k+1]=x[k+1]+S,x[k+2]=x[k+2]+S}},getUniformLocations:function(f,y){return{uBrightness:f.getUniformLocation(y,"uBrightness")}},sendUniformData:function(f,y){f.uniform1f(y.uBrightness,this.brightness)}}),v.Image.filters.Brightness.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.Image.filters,f=v.util.createClass;d.Convolute=f(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(y){var x=Math.sqrt(this.matrix.length),k=this.type+"_"+x+"_"+(this.opaque?1:0),P=this.fragmentSource[k];return y.programCache.hasOwnProperty(k)||(y.programCache[k]=this.createProgram(y.context,P)),y.programCache[k]},applyTo2d:function(y){var x=y.imageData,k=x.data,P=this.matrix,S=Math.round(Math.sqrt(P.length)),E=Math.floor(S/2),M=x.width,T=x.height,D=y.ctx.createImageData(M,T),N=D.data,I=this.opaque?1:0,O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H;for(j=0;j<T;j++)for(Z=0;Z<M;Z++){for(_e=(j*M+Z)*4,O=0,F=0,q=0,Y=0,H=0;H<S;H++)for(X=0;X<S;X++)ve=j+H-E,ne=Z+X-E,!(ve<0||ve>=T||ne<0||ne>=M)&&(J=(ve*M+ne)*4,fe=P[H*S+X],O+=k[J]*fe,F+=k[J+1]*fe,q+=k[J+2]*fe,I||(Y+=k[J+3]*fe));N[_e]=O,N[_e+1]=F,N[_e+2]=q,I?N[_e+3]=k[_e+3]:N[_e+3]=Y}y.imageData=D},getUniformLocations:function(y,x){return{uMatrix:y.getUniformLocation(x,"uMatrix"),uOpaque:y.getUniformLocation(x,"uOpaque"),uHalfSize:y.getUniformLocation(x,"uHalfSize"),uSize:y.getUniformLocation(x,"uSize")}},sendUniformData:function(y,x){y.uniform1fv(x.uMatrix,this.matrix)},toObject:function(){return g(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),v.Image.filters.Convolute.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Grayscale=d(g.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(f){var y=f.imageData,x=y.data,k,P=x.length,S,E=this.mode;for(k=0;k<P;k+=4)E==="average"?S=(x[k]+x[k+1]+x[k+2])/3:E==="lightness"?S=(Math.min(x[k],x[k+1],x[k+2])+Math.max(x[k],x[k+1],x[k+2]))/2:E==="luminosity"&&(S=.21*x[k]+.72*x[k+1]+.07*x[k+2]),x[k]=S,x[k+1]=S,x[k+2]=S},retrieveShader:function(f){var y=this.type+"_"+this.mode;if(!f.programCache.hasOwnProperty(y)){var x=this.fragmentSource[this.mode];f.programCache[y]=this.createProgram(f.context,x)}return f.programCache[y]},getUniformLocations:function(f,y){return{uMode:f.getUniformLocation(y,"uMode")}},sendUniformData:function(f,y){var x=1;f.uniform1i(y.uMode,x)},isNeutralState:function(){return!1}}),v.Image.filters.Grayscale.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Invert=d(g.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(f){var y=f.imageData,x=y.data,k,P=x.length;for(k=0;k<P;k+=4)x[k]=255-x[k],x[k+1]=255-x[k+1],x[k+2]=255-x[k+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(f,y){return{uInvert:f.getUniformLocation(y,"uInvert")}},sendUniformData:function(f,y){f.uniform1i(y.uInvert,this.invert)}}),v.Image.filters.Invert.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.Image.filters,f=v.util.createClass;d.Noise=f(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(y){if(this.noise!==0){var x=y.imageData,k=x.data,P,S=k.length,E=this.noise,M;for(P=0,S=k.length;P<S;P+=4)M=(.5-Math.random())*E,k[P]+=M,k[P+1]+=M,k[P+2]+=M}},getUniformLocations:function(y,x){return{uNoise:y.getUniformLocation(x,"uNoise"),uSeed:y.getUniformLocation(x,"uSeed")}},sendUniformData:function(y,x){y.uniform1f(x.uNoise,this.noise/255),y.uniform1f(x.uSeed,Math.random())},toObject:function(){return g(this.callSuper("toObject"),{noise:this.noise})}}),v.Image.filters.Noise.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Pixelate=d(g.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(f){var y=f.imageData,x=y.data,k=y.height,P=y.width,S,E,M,T,D,N,I,O,F,q,Y;for(E=0;E<k;E+=this.blocksize)for(M=0;M<P;M+=this.blocksize)for(S=E*4*P+M*4,T=x[S],D=x[S+1],N=x[S+2],I=x[S+3],q=Math.min(E+this.blocksize,k),Y=Math.min(M+this.blocksize,P),O=E;O<q;O++)for(F=M;F<Y;F++)S=O*4*P+F*4,x[S]=T,x[S+1]=D,x[S+2]=N,x[S+3]=I},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(f,y){return{uBlocksize:f.getUniformLocation(y,"uBlocksize"),uStepW:f.getUniformLocation(y,"uStepW"),uStepH:f.getUniformLocation(y,"uStepH")}},sendUniformData:function(f,y){f.uniform1f(y.uBlocksize,this.blocksize)}}),v.Image.filters.Pixelate.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.extend,d=v.Image.filters,f=v.util.createClass;d.RemoveColor=f(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(y){var x=y.imageData,k=x.data,P,S=this.distance*255,E,M,T,D=new v.Color(this.color).getSource(),N=[D[0]-S,D[1]-S,D[2]-S],I=[D[0]+S,D[1]+S,D[2]+S];for(P=0;P<k.length;P+=4)E=k[P],M=k[P+1],T=k[P+2],E>N[0]&&M>N[1]&&T>N[2]&&E<I[0]&&M<I[1]&&T<I[2]&&(k[P+3]=0)},getUniformLocations:function(y,x){return{uLow:y.getUniformLocation(x,"uLow"),uHigh:y.getUniformLocation(x,"uHigh")}},sendUniformData:function(y,x){var k=new v.Color(this.color).getSource(),P=parseFloat(this.distance),S=[0+k[0]/255-P,0+k[1]/255-P,0+k[2]/255-P,1],E=[k[0]/255+P,k[1]/255+P,k[2]/255+P,1];y.uniform4fv(x.uLow,S),y.uniform4fv(x.uHigh,E)},toObject:function(){return g(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),v.Image.filters.RemoveColor.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass,f={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var y in f)g[y]=d(g.ColorMatrix,{type:y,matrix:f[y],mainParameter:!1,colorsOnly:!0}),v.Image.filters[y].fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric,g=v.Image.filters,d=v.util.createClass;g.BlendColor=d(g.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(f){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[f]+`}
}`},retrieveShader:function(f){var y=this.type+"_"+this.mode,x;return f.programCache.hasOwnProperty(y)||(x=this.buildSource(this.mode),f.programCache[y]=this.createProgram(f.context,x)),f.programCache[y]},applyTo2d:function(f){var y=f.imageData,x=y.data,k=x.length,P,S,E,M,T,D,N,I=1-this.alpha;N=new v.Color(this.color).getSource(),P=N[0]*this.alpha,S=N[1]*this.alpha,E=N[2]*this.alpha;for(var O=0;O<k;O+=4)switch(M=x[O],T=x[O+1],D=x[O+2],this.mode){case"multiply":x[O]=M*P/255,x[O+1]=T*S/255,x[O+2]=D*E/255;break;case"screen":x[O]=255-(255-M)*(255-P)/255,x[O+1]=255-(255-T)*(255-S)/255,x[O+2]=255-(255-D)*(255-E)/255;break;case"add":x[O]=M+P,x[O+1]=T+S,x[O+2]=D+E;break;case"diff":case"difference":x[O]=Math.abs(M-P),x[O+1]=Math.abs(T-S),x[O+2]=Math.abs(D-E);break;case"subtract":x[O]=M-P,x[O+1]=T-S,x[O+2]=D-E;break;case"darken":x[O]=Math.min(M,P),x[O+1]=Math.min(T,S),x[O+2]=Math.min(D,E);break;case"lighten":x[O]=Math.max(M,P),x[O+1]=Math.max(T,S),x[O+2]=Math.max(D,E);break;case"overlay":x[O]=P<128?2*M*P/255:255-2*(255-M)*(255-P)/255,x[O+1]=S<128?2*T*S/255:255-2*(255-T)*(255-S)/255,x[O+2]=E<128?2*D*E/255:255-2*(255-D)*(255-E)/255;break;case"exclusion":x[O]=P+M-2*P*M/255,x[O+1]=S+T-2*S*T/255,x[O+2]=E+D-2*E*D/255;break;case"tint":x[O]=P+M*I,x[O+1]=S+T*I,x[O+2]=E+D*I}},getUniformLocations:function(f,y){return{uColor:f.getUniformLocation(y,"uColor")}},sendUniformData:function(f,y){var x=new v.Color(this.color).getSource();x[0]=this.alpha*x[0]/255,x[1]=this.alpha*x[1]/255,x[2]=this.alpha*x[2]/255,x[3]=this.alpha,f.uniform4fv(y.uColor,x)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),v.Image.filters.BlendColor.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric,g=v.Image.filters,d=v.util.createClass;g.BlendImage=d(g.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(f){var y=this.type+"_"+this.mode,x=this.fragmentSource[this.mode];return f.programCache.hasOwnProperty(y)||(f.programCache[y]=this.createProgram(f.context,x)),f.programCache[y]},applyToWebGL:function(f){var y=f.context,x=this.createTexture(f.filterBackend,this.image);this.bindAdditionalTexture(y,x,y.TEXTURE1),this.callSuper("applyToWebGL",f),this.unbindAdditionalTexture(y,y.TEXTURE1)},createTexture:function(f,y){return f.getCachedTexture(y.cacheKey,y._element)},calculateMatrix:function(){var f=this.image,y=f._element.width,x=f._element.height;return[1/f.scaleX,0,0,0,1/f.scaleY,0,-f.left/y,-f.top/x,1]},applyTo2d:function(f){var y=f.imageData,x=f.filterBackend.resources,k=y.data,P=k.length,S=y.width,E=y.height,M,T,D,N,I,O,F,q,Y,_e,ne=this.image,ve;x.blendImage||(x.blendImage=v.util.createCanvasElement()),Y=x.blendImage,_e=Y.getContext("2d"),Y.width!==S||Y.height!==E?(Y.width=S,Y.height=E):_e.clearRect(0,0,S,E),_e.setTransform(ne.scaleX,0,0,ne.scaleY,ne.left,ne.top),_e.drawImage(ne._element,0,0,S,E),ve=_e.getImageData(0,0,S,E).data;for(var J=0;J<P;J+=4)switch(I=k[J],O=k[J+1],F=k[J+2],q=k[J+3],M=ve[J],T=ve[J+1],D=ve[J+2],N=ve[J+3],this.mode){case"multiply":k[J]=I*M/255,k[J+1]=O*T/255,k[J+2]=F*D/255,k[J+3]=q*N/255;break;case"mask":k[J+3]=N;break}},getUniformLocations:function(f,y){return{uTransformMatrix:f.getUniformLocation(y,"uTransformMatrix"),uImage:f.getUniformLocation(y,"uImage")}},sendUniformData:function(f,y){var x=this.calculateMatrix();f.uniform1i(y.uImage,1),f.uniformMatrix3fv(y.uTransformMatrix,!1,x)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),v.Image.filters.BlendImage.fromObject=function(f,y){v.Image.fromObject(f.image,function(x){var k=v.util.object.clone(f);k.image=x,y(new v.Image.filters.BlendImage(k))})}}(e),function(m){var v=m.fabric||(m.fabric={}),g=Math.pow,d=Math.floor,f=Math.sqrt,y=Math.abs,x=Math.round,k=Math.sin,P=Math.ceil,S=v.Image.filters,E=v.util.createClass;S.Resize=E(S.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(M,T){return{uDelta:M.getUniformLocation(T,"uDelta"),uTaps:M.getUniformLocation(T,"uTaps")}},sendUniformData:function(M,T){M.uniform2fv(T.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),M.uniform1fv(T.uTaps,this.taps)},retrieveShader:function(M){var T=this.getFilterWindow(),D=this.type+"_"+T;if(!M.programCache.hasOwnProperty(D)){var N=this.generateShader(T);M.programCache[D]=this.createProgram(M.context,N)}return M.programCache[D]},getFilterWindow:function(){var M=this.tempScale;return Math.ceil(this.lanczosLobes/M)},getTaps:function(){for(var M=this.lanczosCreate(this.lanczosLobes),T=this.tempScale,D=this.getFilterWindow(),N=new Array(D),I=1;I<=D;I++)N[I-1]=M(I*T);return N},generateShader:function(N){for(var T=new Array(N),D=this.fragmentSourceTOP,N,I=1;I<=N;I++)T[I-1]=I+".0 * uDelta";return D+="uniform float uTaps["+N+`];
`,D+=`void main() {
`,D+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,D+=`  float sum = 1.0;
`,T.forEach(function(O,F){D+="  color += texture2D(uTexture, vTexCoord + "+O+") * uTaps["+F+`];
`,D+="  color += texture2D(uTexture, vTexCoord - "+O+") * uTaps["+F+`];
`,D+="  sum += 2.0 * uTaps["+F+`];
`}),D+=`  gl_FragColor = color / sum;
`,D+="}",D},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(M){M.webgl?(M.passes++,this.width=M.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=M.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),M.destinationWidth=this.dW,this._setupFrameBuffer(M),this.applyToWebGL(M),this._swapTextures(M),M.sourceWidth=M.destinationWidth,this.height=M.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),M.destinationHeight=this.dH,this._setupFrameBuffer(M),this.applyToWebGL(M),this._swapTextures(M),M.sourceHeight=M.destinationHeight):this.applyTo2d(M)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(M){return function(T){if(T>=M||T<=-M)return 0;if(T<11920929e-14&&T>-11920929e-14)return 1;T*=Math.PI;var D=T/M;return k(T)/T*k(D)/D}},applyTo2d:function(M){var T=M.imageData,D=this.scaleX,N=this.scaleY;this.rcpScaleX=1/D,this.rcpScaleY=1/N;var I=T.width,O=T.height,F=x(I*D),q=x(O*N),Y;this.resizeType==="sliceHack"?Y=this.sliceByTwo(M,I,O,F,q):this.resizeType==="hermite"?Y=this.hermiteFastResize(M,I,O,F,q):this.resizeType==="bilinear"?Y=this.bilinearFiltering(M,I,O,F,q):this.resizeType==="lanczos"&&(Y=this.lanczosResize(M,I,O,F,q)),M.imageData=Y},sliceByTwo:function(M,T,D,N,I){var O=M.imageData,F=.5,q=!1,Y=!1,_e=T*F,ne=D*F,ve=v.filterBackend.resources,J,fe,Z=0,j=0,X=T,H=0;for(ve.sliceByTwo||(ve.sliceByTwo=document.createElement("canvas")),J=ve.sliceByTwo,(J.width<T*1.5||J.height<D)&&(J.width=T*1.5,J.height=D),fe=J.getContext("2d"),fe.clearRect(0,0,T*1.5,D),fe.putImageData(O,0,0),N=d(N),I=d(I);!q||!Y;)T=_e,D=ne,N<d(_e*F)?_e=d(_e*F):(_e=N,q=!0),I<d(ne*F)?ne=d(ne*F):(ne=I,Y=!0),fe.drawImage(J,Z,j,T,D,X,H,_e,ne),Z=X,j=H,H+=ne;return fe.getImageData(Z,j,N,I)},lanczosResize:function(M,T,D,N,I){function O(te){var Q,re,Pe,be,we,Ae,$e,Me,Ie,Le,le;for(H.x=(te+.5)*ne,U.x=d(H.x),Q=0;Q<I;Q++){for(H.y=(Q+.5)*ve,U.y=d(H.y),we=0,Ae=0,$e=0,Me=0,Ie=0,re=U.x-Z;re<=U.x+Z;re++)if(!(re<0||re>=T)){Le=d(1e3*y(re-H.x)),X[Le]||(X[Le]={});for(var oe=U.y-j;oe<=U.y+j;oe++)oe<0||oe>=D||(le=d(1e3*y(oe-H.y)),X[Le][le]||(X[Le][le]=_e(f(g(Le*J,2)+g(le*fe,2))/1e3)),Pe=X[Le][le],Pe>0&&(be=(oe*T+re)*4,we+=Pe,Ae+=Pe*F[be],$e+=Pe*F[be+1],Me+=Pe*F[be+2],Ie+=Pe*F[be+3]))}be=(Q*N+te)*4,Y[be]=Ae/we,Y[be+1]=$e/we,Y[be+2]=Me/we,Y[be+3]=Ie/we}return++te<N?O(te):q}var F=M.imageData.data,q=M.ctx.createImageData(N,I),Y=q.data,_e=this.lanczosCreate(this.lanczosLobes),ne=this.rcpScaleX,ve=this.rcpScaleY,J=2/this.rcpScaleX,fe=2/this.rcpScaleY,Z=P(ne*this.lanczosLobes/2),j=P(ve*this.lanczosLobes/2),X={},H={},U={};return O(0)},bilinearFiltering:function(M,T,D,N,I){var O,F,q,Y,_e,ne,ve,J,fe,Z,j,X,H=0,U,te=this.rcpScaleX,Q=this.rcpScaleY,re=4*(T-1),Pe=M.imageData,be=Pe.data,we=M.ctx.createImageData(N,I),Ae=we.data;for(ve=0;ve<I;ve++)for(J=0;J<N;J++)for(_e=d(te*J),ne=d(Q*ve),fe=te*J-_e,Z=Q*ve-ne,U=4*(ne*T+_e),j=0;j<4;j++)O=be[U+j],F=be[U+4+j],q=be[U+re+j],Y=be[U+re+4+j],X=O*(1-fe)*(1-Z)+F*fe*(1-Z)+q*Z*(1-fe)+Y*fe*Z,Ae[H++]=X;return we},hermiteFastResize:function(M,T,D,N,I){for(var O=this.rcpScaleX,F=this.rcpScaleY,q=P(O/2),Y=P(F/2),_e=M.imageData,ne=_e.data,ve=M.ctx.createImageData(N,I),J=ve.data,fe=0;fe<I;fe++)for(var Z=0;Z<N;Z++){for(var j=(Z+fe*N)*4,X=0,H=0,U=0,te=0,Q=0,re=0,Pe=0,be=(fe+.5)*F,we=d(fe*F);we<(fe+1)*F;we++)for(var Ae=y(be-(we+.5))/Y,$e=(Z+.5)*O,Me=Ae*Ae,Ie=d(Z*O);Ie<(Z+1)*O;Ie++){var Le=y($e-(Ie+.5))/q,le=f(Me+Le*Le);le>1&&le<-1||(X=2*le*le*le-3*le*le+1,X>0&&(Le=4*(Ie+we*T),Pe+=X*ne[Le+3],U+=X,ne[Le+3]<255&&(X=X*ne[Le+3]/250),te+=X*ne[Le],Q+=X*ne[Le+1],re+=X*ne[Le+2],H+=X))}J[j]=te/H,J[j+1]=Q/H,J[j+2]=re/H,J[j+3]=Pe/U}return ve},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),v.Image.filters.Resize.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Contrast=d(g.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(f){if(this.contrast!==0){var y=f.imageData,x,P,k=y.data,P=k.length,S=Math.floor(this.contrast*255),E=259*(S+255)/(255*(259-S));for(x=0;x<P;x+=4)k[x]=E*(k[x]-128)+128,k[x+1]=E*(k[x+1]-128)+128,k[x+2]=E*(k[x+2]-128)+128}},getUniformLocations:function(f,y){return{uContrast:f.getUniformLocation(y,"uContrast")}},sendUniformData:function(f,y){f.uniform1f(y.uContrast,this.contrast)}}),v.Image.filters.Contrast.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Saturation=d(g.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(f){if(this.saturation!==0){var y=f.imageData,x=y.data,k=x.length,P=-this.saturation,S,E;for(S=0;S<k;S+=4)E=Math.max(x[S],x[S+1],x[S+2]),x[S]+=E!==x[S]?(E-x[S])*P:0,x[S+1]+=E!==x[S+1]?(E-x[S+1])*P:0,x[S+2]+=E!==x[S+2]?(E-x[S+2])*P:0}},getUniformLocations:function(f,y){return{uSaturation:f.getUniformLocation(y,"uSaturation")}},sendUniformData:function(f,y){f.uniform1f(y.uSaturation,-this.saturation)}}),v.Image.filters.Saturation.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Vibrance=d(g.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(f){if(this.vibrance!==0){var y=f.imageData,x=y.data,k=x.length,P=-this.vibrance,S,E,M,T;for(S=0;S<k;S+=4)E=Math.max(x[S],x[S+1],x[S+2]),M=(x[S]+x[S+1]+x[S+2])/3,T=Math.abs(E-M)*2/255*P,x[S]+=E!==x[S]?(E-x[S])*T:0,x[S+1]+=E!==x[S+1]?(E-x[S+1])*T:0,x[S+2]+=E!==x[S+2]?(E-x[S+2])*T:0}},getUniformLocations:function(f,y){return{uVibrance:f.getUniformLocation(y,"uVibrance")}},sendUniformData:function(f,y){f.uniform1f(y.uVibrance,-this.vibrance)}}),v.Image.filters.Vibrance.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Blur=d(g.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(f){f.webgl?(this.aspectRatio=f.sourceWidth/f.sourceHeight,f.passes++,this._setupFrameBuffer(f),this.horizontal=!0,this.applyToWebGL(f),this._swapTextures(f),this._setupFrameBuffer(f),this.horizontal=!1,this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},applyTo2d:function(f){f.imageData=this.simpleBlur(f)},simpleBlur:function(f){var y=f.filterBackend.resources,x,k,P=f.imageData.width,S=f.imageData.height;y.blurLayer1||(y.blurLayer1=v.util.createCanvasElement(),y.blurLayer2=v.util.createCanvasElement()),x=y.blurLayer1,k=y.blurLayer2,(x.width!==P||x.height!==S)&&(k.width=x.width=P,k.height=x.height=S);var E=x.getContext("2d"),M=k.getContext("2d"),T=15,D,N,I,O,F=this.blur*.06*.5;for(E.putImageData(f.imageData,0,0),M.clearRect(0,0,P,S),O=-T;O<=T;O++)D=(Math.random()-.5)/4,N=O/T,I=F*N*P+D,M.globalAlpha=1-Math.abs(N),M.drawImage(x,I,D),E.drawImage(k,0,0),M.globalAlpha=1,M.clearRect(0,0,k.width,k.height);for(O=-T;O<=T;O++)D=(Math.random()-.5)/4,N=O/T,I=F*N*S+D,M.globalAlpha=1-Math.abs(N),M.drawImage(x,D,I),E.drawImage(k,0,0),M.globalAlpha=1,M.clearRect(0,0,k.width,k.height);f.ctx.drawImage(x,0,0);var q=f.ctx.getImageData(0,0,x.width,x.height);return E.globalAlpha=1,E.clearRect(0,0,x.width,x.height),q},getUniformLocations:function(f,y){return{delta:f.getUniformLocation(y,"uDelta")}},sendUniformData:function(f,y){var x=this.chooseRightDelta();f.uniform2fv(y.delta,x)},chooseRightDelta:function(){var f=1,y=[0,0],x;return this.horizontal?this.aspectRatio>1&&(f=1/this.aspectRatio):this.aspectRatio<1&&(f=this.aspectRatio),x=f*this.blur*.12,this.horizontal?y[0]=x:y[1]=x,y}}),g.Blur.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Gamma=d(g.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(f){this.gamma=[1,1,1],g.BaseFilter.prototype.initialize.call(this,f)},applyTo2d:function(f){var y=f.imageData,x=y.data,k=this.gamma,P=x.length,S=1/k[0],E=1/k[1],M=1/k[2],T;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),T=0,P=256;T<P;T++)this.rVals[T]=Math.pow(T/255,S)*255,this.gVals[T]=Math.pow(T/255,E)*255,this.bVals[T]=Math.pow(T/255,M)*255;for(T=0,P=x.length;T<P;T+=4)x[T]=this.rVals[x[T]],x[T+1]=this.gVals[x[T+1]],x[T+2]=this.bVals[x[T+2]]},getUniformLocations:function(f,y){return{uGamma:f.getUniformLocation(y,"uGamma")}},sendUniformData:function(f,y){f.uniform3fv(y.uGamma,this.gamma)}}),v.Image.filters.Gamma.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.Composed=d(g.BaseFilter,{type:"Composed",subFilters:[],initialize:function(f){this.callSuper("initialize",f),this.subFilters=this.subFilters.slice(0)},applyTo:function(f){f.passes+=this.subFilters.length-1,this.subFilters.forEach(function(y){y.applyTo(f)})},toObject:function(){return v.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(f){return f.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(f){return!f.isNeutralState()})}}),v.Image.filters.Composed.fromObject=function(f,y){var x=f.subFilters||[],k=x.map(function(S){return new v.Image.filters[S.type](S)}),P=new v.Image.filters.Composed({subFilters:k});return y&&y(P),P}}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.Image.filters,d=v.util.createClass;g.HueRotation=d(g.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var f=this.rotation*Math.PI,y=v.util.cos(f),x=v.util.sin(f),k=1/3,P=Math.sqrt(k)*x,S=1-y;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=y+S/3,this.matrix[1]=k*S-P,this.matrix[2]=k*S+P,this.matrix[5]=k*S+P,this.matrix[6]=y+k*S,this.matrix[7]=k*S-P,this.matrix[10]=k*S-P,this.matrix[11]=k*S+P,this.matrix[12]=y+k*S},isNeutralState:function(f){return this.calculateMatrix(),g.BaseFilter.prototype.isNeutralState.call(this,f)},applyTo:function(f){this.calculateMatrix(),g.BaseFilter.prototype.applyTo.call(this,f)}}),v.Image.filters.HueRotation.fromObject=v.Image.filters.BaseFilter.fromObject}(e),function(m){var v=m.fabric||(m.fabric={}),g=v.util.object.clone;if(v.Text){v.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");v.Text=v.util.createClass(v.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:v.Object.prototype.stateProperties.concat(d),cacheProperties:v.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(f,y){this.styles=y?y.styles||{}:{},this.text=f,this.__skipDimension=!0,this.callSuper("initialize",y),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var f=this.path;f&&(f.segmentsInfo=v.util.getPathSegmentsInfo(f.path))},getMeasuringContext:function(){return v._measuringContext||(v._measuringContext=this.canvas&&this.canvas.contextCache||v.util.createCanvasElement().getContext("2d")),v._measuringContext},_splitText:function(){var f=this._splitTextIntoLines(this.text);return this.textLines=f.lines,this._textLines=f.graphemeLines,this._unwrappedTextLines=f._unwrappedLines,this._text=f.graphemeText,f},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var f=this.getHeightOfLine(0)*1.1;this.width=this.path.width+f,this.height=this.path.height+f}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var f,y,x,k,P,S,E,M=0,T=this._textLines.length;M<T;M++)if(!(this.textAlign!=="justify"&&(M===T-1||this.isEndOfWrapping(M)))&&(k=0,P=this._textLines[M],y=this.getLineWidth(M),y<this.width&&(E=this.textLines[M].match(this._reSpacesAndTabs)))){x=E.length,f=(this.width-y)/x;for(var D=0,N=P.length;D<=N;D++)S=this.__charBounds[M][D],this._reSpaceAndTab.test(P[D])?(S.width+=f,S.kernedWidth+=f,S.left+=k,k+=f):S.left+=k}},isEndOfWrapping:function(f){return f===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var f=this.callSuper("_getCacheCanvasDimensions"),y=this.fontSize;return f.width+=y*f.zoomX,f.height+=y*f.zoomY,f},_render:function(f){var y=this.path;y&&!y.isNotVisible()&&y._render(f),this._setTextStyles(f),this._renderTextLinesBackground(f),this._renderTextDecoration(f,"underline"),this._renderText(f),this._renderTextDecoration(f,"overline"),this._renderTextDecoration(f,"linethrough")},_renderText:function(f){this.paintFirst==="stroke"?(this._renderTextStroke(f),this._renderTextFill(f)):(this._renderTextFill(f),this._renderTextStroke(f))},_setTextStyles:function(f,y,x){if(f.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":f.textBaseline="middle";break;case"ascender":f.textBaseline="top";break;case"descender":f.textBaseline="bottom";break}f.font=this._getFontDeclaration(y,x)},calcTextWidth:function(){for(var f=this.getLineWidth(0),y=1,x=this._textLines.length;y<x;y++){var k=this.getLineWidth(y);k>f&&(f=k)}return f},_renderTextLine:function(f,y,x,k,P,S){this._renderChars(f,y,x,k,P,S)},_renderTextLinesBackground:function(f){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var y,x,k=f.fillStyle,P,S,E=this._getLeftOffset(),M=this._getTopOffset(),T=0,D=0,N,I,O=this.path,F,q=0,Y=this._textLines.length;q<Y;q++){if(y=this.getHeightOfLine(q),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",q)){M+=y;continue}P=this._textLines[q],x=this._getLineLeftOffset(q),D=0,T=0,S=this.getValueOfPropertyAt(q,0,"textBackgroundColor");for(var _e=0,ne=P.length;_e<ne;_e++)N=this.__charBounds[q][_e],I=this.getValueOfPropertyAt(q,_e,"textBackgroundColor"),O?(f.save(),f.translate(N.renderLeft,N.renderTop),f.rotate(N.angle),f.fillStyle=I,I&&f.fillRect(-N.width/2,-y/this.lineHeight*(1-this._fontSizeFraction),N.width,y/this.lineHeight),f.restore()):I!==S?(F=E+x+T,this.direction==="rtl"&&(F=this.width-F-D),f.fillStyle=S,S&&f.fillRect(F,M,D,y/this.lineHeight),T=N.left,D=N.width,S=I):D+=N.kernedWidth;I&&!O&&(F=E+x+T,this.direction==="rtl"&&(F=this.width-F-D),f.fillStyle=I,f.fillRect(F,M,D,y/this.lineHeight)),M+=y}f.fillStyle=k,this._removeShadow(f)}},getFontCache:function(f){var y=f.fontFamily.toLowerCase();v.charWidthsCache[y]||(v.charWidthsCache[y]={});var x=v.charWidthsCache[y],k=f.fontStyle.toLowerCase()+"_"+(f.fontWeight+"").toLowerCase();return x[k]||(x[k]={}),x[k]},_measureChar:function(f,y,x,k){var P=this.getFontCache(y),S=this._getFontDeclaration(y),E=this._getFontDeclaration(k),M=x+f,T=S===E,D,N,I,O=y.fontSize/this.CACHE_FONT_SIZE,F;if(x&&P[x]!==void 0&&(I=P[x]),P[f]!==void 0&&(F=D=P[f]),T&&P[M]!==void 0&&(N=P[M],F=N-I),D===void 0||I===void 0||N===void 0){var q=this.getMeasuringContext();this._setTextStyles(q,y,!0)}return D===void 0&&(F=D=q.measureText(f).width,P[f]=D),I===void 0&&T&&x&&(I=q.measureText(x).width,P[x]=I),T&&N===void 0&&(N=q.measureText(M).width,P[M]=N,F=N-I),{width:D*O,kernedWidth:F*O}},getHeightOfChar:function(f,y){return this.getValueOfPropertyAt(f,y,"fontSize")},measureLine:function(f){var y=this._measureLine(f);return this.charSpacing!==0&&(y.width-=this._getWidthOfCharSpacing()),y.width<0&&(y.width=0),y},_measureLine:function(f){var y=0,x,k,P=this._textLines[f],S,E,M=0,T=new Array(P.length),D=0,N,I,O=this.path,F=this.pathSide==="right";for(this.__charBounds[f]=T,x=0;x<P.length;x++)k=P[x],E=this._getGraphemeBox(k,f,x,S),T[x]=E,y+=E.kernedWidth,S=k;if(T[x]={left:E?E.left+E.width:0,width:0,kernedWidth:0,height:this.fontSize},O){switch(I=O.segmentsInfo[O.segmentsInfo.length-1].length,N=v.util.getPointOnPath(O.path,0,O.segmentsInfo),N.x+=O.pathOffset.x,N.y+=O.pathOffset.y,this.textAlign){case"left":D=F?I-y:0;break;case"center":D=(I-y)/2;break;case"right":D=F?0:I-y;break}for(D+=this.pathStartOffset*(F?-1:1),x=F?P.length-1:0;F?x>=0:x<P.length;F?x--:x++)E=T[x],D>I?D%=I:D<0&&(D+=I),this._setGraphemeOnPath(D,E,N),D+=E.kernedWidth}return{width:y,numOfSpaces:M}},_setGraphemeOnPath:function(f,y,x){var k=f+y.kernedWidth/2,P=this.path,S=v.util.getPointOnPath(P.path,k,P.segmentsInfo);y.renderLeft=S.x-x.x,y.renderTop=S.y-x.y,y.angle=S.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(f,y,x,k,P){var S=this.getCompleteStyleDeclaration(y,x),E=k?this.getCompleteStyleDeclaration(y,x-1):{},M=this._measureChar(f,S,k,E),T=M.kernedWidth,D=M.width,N;this.charSpacing!==0&&(N=this._getWidthOfCharSpacing(),D+=N,T+=N);var I={width:D,left:0,height:S.fontSize,kernedWidth:T,deltaY:S.deltaY};if(x>0&&!P){var O=this.__charBounds[y][x-1];I.left=O.left+O.width+M.kernedWidth-M.width}return I},getHeightOfLine:function(f){if(this.__lineHeights[f])return this.__lineHeights[f];for(var y=this._textLines[f],x=this.getHeightOfChar(f,0),k=1,P=y.length;k<P;k++)x=Math.max(this.getHeightOfChar(f,k),x);return this.__lineHeights[f]=x*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var f,y=0,x=0,k=this._textLines.length;x<k;x++)f=this.getHeightOfLine(x),y+=x===k-1?f/this.lineHeight:f;return y},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(f,y){f.save();for(var x=0,k=this._getLeftOffset(),P=this._getTopOffset(),S=0,E=this._textLines.length;S<E;S++){var M=this.getHeightOfLine(S),T=M/this.lineHeight,D=this._getLineLeftOffset(S);this._renderTextLine(y,f,this._textLines[S],k+D,P+x+T,S),x+=M}f.restore()},_renderTextFill:function(f){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(f,"fillText")},_renderTextStroke:function(f){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this._setLineDash(f,this.strokeDashArray),f.beginPath(),this._renderTextCommon(f,"strokeText"),f.closePath(),f.restore())},_renderChars:function(f,y,x,k,P,S){var E=this.getHeightOfLine(S),M=this.textAlign.indexOf("justify")!==-1,T,D,N="",I,O=0,F,q=this.path,Y=!M&&this.charSpacing===0&&this.isEmptyStyles(S)&&!q,_e=this.direction==="ltr",ne=this.direction==="ltr"?1:-1,ve,J=y.canvas.getAttribute("dir");if(y.save(),J!==this.direction&&(y.canvas.setAttribute("dir",_e?"ltr":"rtl"),y.direction=_e?"ltr":"rtl",y.textAlign=_e?"left":"right"),P-=E*this._fontSizeFraction/this.lineHeight,Y){this._renderChar(f,y,S,0,x.join(""),k,P,E),y.restore();return}for(var fe=0,Z=x.length-1;fe<=Z;fe++)F=fe===Z||this.charSpacing||q,N+=x[fe],I=this.__charBounds[S][fe],O===0?(k+=ne*(I.kernedWidth-I.width),O+=I.width):O+=I.kernedWidth,M&&!F&&this._reSpaceAndTab.test(x[fe])&&(F=!0),F||(T=T||this.getCompleteStyleDeclaration(S,fe),D=this.getCompleteStyleDeclaration(S,fe+1),F=v.util.hasStyleChanged(T,D,!1)),F&&(q?(y.save(),y.translate(I.renderLeft,I.renderTop),y.rotate(I.angle),this._renderChar(f,y,S,fe,N,-O/2,0,E),y.restore()):(ve=k,this._renderChar(f,y,S,fe,N,ve,P,E)),N="",T=D,k+=ne*O,O=0);y.restore()},_applyPatternGradientTransformText:function(f){var y=v.util.createCanvasElement(),x,k=this.width+this.strokeWidth,P=this.height+this.strokeWidth;return y.width=k,y.height=P,x=y.getContext("2d"),x.beginPath(),x.moveTo(0,0),x.lineTo(k,0),x.lineTo(k,P),x.lineTo(0,P),x.closePath(),x.translate(k/2,P/2),x.fillStyle=f.toLive(x),this._applyPatternGradientTransform(x,f),x.fill(),x.createPattern(y,"no-repeat")},handleFiller:function(f,y,x){var k,P;return x.toLive?x.gradientUnits==="percentage"||x.gradientTransform||x.patternTransform?(k=-this.width/2,P=-this.height/2,f.translate(k,P),f[y]=this._applyPatternGradientTransformText(x),{offsetX:k,offsetY:P}):(f[y]=x.toLive(f,this),this._applyPatternGradientTransform(f,x)):(f[y]=x,{offsetX:0,offsetY:0})},_setStrokeStyles:function(f,y){return f.lineWidth=y.strokeWidth,f.lineCap=this.strokeLineCap,f.lineDashOffset=this.strokeDashOffset,f.lineJoin=this.strokeLineJoin,f.miterLimit=this.strokeMiterLimit,this.handleFiller(f,"strokeStyle",y.stroke)},_setFillStyles:function(f,y){return this.handleFiller(f,"fillStyle",y.fill)},_renderChar:function(f,y,x,k,P,S,E){var M=this._getStyleDeclaration(x,k),T=this.getCompleteStyleDeclaration(x,k),D=f==="fillText"&&T.fill,N=f==="strokeText"&&T.stroke&&T.strokeWidth,I,O;!N&&!D||(y.save(),D&&(I=this._setFillStyles(y,T)),N&&(O=this._setStrokeStyles(y,T)),y.font=this._getFontDeclaration(T),M&&M.textBackgroundColor&&this._removeShadow(y),M&&M.deltaY&&(E+=M.deltaY),D&&y.fillText(P,S-I.offsetX,E-I.offsetY),N&&y.strokeText(P,S-O.offsetX,E-O.offsetY),y.restore())},setSuperscript:function(f,y){return this._setScript(f,y,this.superscript)},setSubscript:function(f,y){return this._setScript(f,y,this.subscript)},_setScript:function(f,y,x){var k=this.get2DCursorLocation(f,!0),P=this.getValueOfPropertyAt(k.lineIndex,k.charIndex,"fontSize"),S=this.getValueOfPropertyAt(k.lineIndex,k.charIndex,"deltaY"),E={fontSize:P*x.size,deltaY:S+P*x.baseline};return this.setSelectionStyles(E,f,y),this},_getLineLeftOffset:function(f){var y=this.getLineWidth(f),x=this.width-y,k=this.textAlign,P=this.direction,E,S=0,E=this.isEndOfWrapping(f);return k==="justify"||k==="justify-center"&&!E||k==="justify-right"&&!E||k==="justify-left"&&!E?0:(k==="center"&&(S=x/2),k==="right"&&(S=x),k==="justify-center"&&(S=x/2),k==="justify-right"&&(S=x),P==="rtl"&&(S-=x),S)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var f=this._forceClearCache;return f||(f=this.hasStateChanged("_dimensionAffectingProps")),f&&(this.dirty=!0,this._forceClearCache=!1),f},getLineWidth:function(f){if(this.__lineWidths[f]!==void 0)return this.__lineWidths[f];var y=this.measureLine(f),x=y.width;return this.__lineWidths[f]=x,x},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(f,y,x){var k=this._getStyleDeclaration(f,y);return k&&typeof k[x]<"u"?k[x]:this[x]},_renderTextDecoration:function(f,y){if(!(!this[y]&&!this.styleHas(y))){f.save(),(y==="overline"||y==="linethrough")&&this._removeShadow(f);for(var x,k,P,S,E,M,T,D,N=this._getLeftOffset(),I=this._getTopOffset(),O,F,q,Y,_e,ne,ve,J,fe=this.path,Z=this._getWidthOfCharSpacing(),j=this.offsets[y],X=0,H=this._textLines.length;X<H;X++){if(x=this.getHeightOfLine(X),!this[y]&&!this.styleHas(y,X)){I+=x;continue}T=this._textLines[X],ne=x/this.lineHeight,S=this._getLineLeftOffset(X),F=0,q=0,D=this.getValueOfPropertyAt(X,0,y),J=this.getValueOfPropertyAt(X,0,"fill"),O=I+ne*(1-this._fontSizeFraction),k=this.getHeightOfChar(X,0),E=this.getValueOfPropertyAt(X,0,"deltaY");for(var U=0,te=T.length;U<te;U++)if(Y=this.__charBounds[X][U],_e=this.getValueOfPropertyAt(X,U,y),ve=this.getValueOfPropertyAt(X,U,"fill"),P=this.getHeightOfChar(X,U),M=this.getValueOfPropertyAt(X,U,"deltaY"),fe&&_e&&ve)f.save(),f.fillStyle=J,f.translate(Y.renderLeft,Y.renderTop),f.rotate(Y.angle),f.fillRect(-Y.kernedWidth/2,j*P+M,Y.kernedWidth,this.fontSize/15),f.restore();else if((_e!==D||ve!==J||P!==k||M!==E)&&q>0){var Q=N+S+F;this.direction==="rtl"&&(Q=this.width-Q-q),D&&J&&(f.fillStyle=J,f.fillRect(Q,O+j*k+E,q,this.fontSize/15)),F=Y.left,q=Y.width,D=_e,J=ve,k=P,E=M}else q+=Y.kernedWidth;var Q=N+S+F;this.direction==="rtl"&&(Q=this.width-Q-q),f.fillStyle=ve,_e&&ve&&f.fillRect(Q,O+j*k+E,q-Z,this.fontSize/15),I+=x}f.restore()}},_getFontDeclaration:function(f,y){var x=f||this,k=this.fontFamily,P=v.Text.genericFonts.indexOf(k.toLowerCase())>-1,S=k===void 0||k.indexOf("'")>-1||k.indexOf(",")>-1||k.indexOf('"')>-1||P?x.fontFamily:'"'+x.fontFamily+'"';return[v.isLikelyNode?x.fontWeight:x.fontStyle,v.isLikelyNode?x.fontStyle:x.fontWeight,y?this.CACHE_FONT_SIZE+"px":x.fontSize+"px",S].join(" ")},render:function(f){!this.visible||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",f))},_splitTextIntoLines:function(f){for(var y=f.split(this._reNewline),x=new Array(y.length),k=[`
`],P=[],S=0;S<y.length;S++)x[S]=v.util.string.graphemeSplit(y[S]),P=P.concat(x[S],k);return P.pop(),{_unwrappedLines:x,lines:y,graphemeText:P,graphemeLines:x}},toObject:function(f){var y=d.concat(f),x=this.callSuper("toObject",y);return x.styles=v.util.stylesToArray(this.styles,this.text),x.path&&(x.path=this.path.toObject()),x},set:function(f,y){this.callSuper("set",f,y);var x=!1,k=!1;if(typeof f=="object")for(var P in f)P==="path"&&this.setPathInfo(),x=x||this._dimensionAffectingProps.indexOf(P)!==-1,k=k||P==="path";else x=this._dimensionAffectingProps.indexOf(f)!==-1,k=f==="path";return k&&this.setPathInfo(),x&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),v.Text.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),v.Text.DEFAULT_SVG_FONT_SIZE=16,v.Text.fromElement=function(f,y,x){if(!f)return y(null);var k=v.parseAttributes(f,v.Text.ATTRIBUTE_NAMES),P=k.textAnchor||"left";if(x=v.util.object.extend(x?g(x):{},k),x.top=x.top||0,x.left=x.left||0,k.textDecoration){var S=k.textDecoration;S.indexOf("underline")!==-1&&(x.underline=!0),S.indexOf("overline")!==-1&&(x.overline=!0),S.indexOf("line-through")!==-1&&(x.linethrough=!0),delete x.textDecoration}"dx"in k&&(x.left+=k.dx),"dy"in k&&(x.top+=k.dy),"fontSize"in x||(x.fontSize=v.Text.DEFAULT_SVG_FONT_SIZE);var E="";"textContent"in f?E=f.textContent:"firstChild"in f&&f.firstChild!==null&&"data"in f.firstChild&&f.firstChild.data!==null&&(E=f.firstChild.data),E=E.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var M=x.strokeWidth;x.strokeWidth=0;var T=new v.Text(E,x),D=T.getScaledHeight()/T.height,N=(T.height+T.strokeWidth)*T.lineHeight-T.height,I=N*D,O=T.getScaledHeight()+I,F=0;P==="center"&&(F=T.getScaledWidth()/2),P==="right"&&(F=T.getScaledWidth()),T.set({left:T.left-F,top:T.top-(O-T.fontSize*(.07+T._fontSizeFraction))/T.lineHeight,strokeWidth:typeof M<"u"?M:1}),y(T)},v.Text.fromObject=function(f,y){var x=g(f),k=f.path;return delete x.path,v.Object._fromObject("Text",x,function(P){P.styles=v.util.stylesFromArray(f.styles,f.text),k?v.Object._fromObject("Path",k,function(S){P.set("path",S),y(P)},"path"):y(P)},"text")},v.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],v.util.createAccessors&&v.util.createAccessors(v.Text)}(e),function(){n.util.object.extend(n.Text.prototype,{isEmptyStyles:function(m){if(!this.styles||typeof m<"u"&&!this.styles[m])return!0;var v=typeof m>"u"?this.styles:{line:this.styles[m]};for(var g in v)for(var d in v[g])for(var f in v[g][d])return!1;return!0},styleHas:function(m,v){if(!this.styles||!m||m===""||typeof v<"u"&&!this.styles[v])return!1;var g=typeof v>"u"?this.styles:{0:this.styles[v]};for(var d in g)for(var f in g[d])if(typeof g[d][f][m]<"u")return!0;return!1},cleanStyle:function(m){if(!this.styles||!m||m==="")return!1;var v=this.styles,g=0,d,f,y=!0,x=0,k;for(var P in v){d=0;for(var S in v[P]){var k=v[P][S],E=k.hasOwnProperty(m);g++,E?(f?k[m]!==f&&(y=!1):f=k[m],k[m]===this[m]&&delete k[m]):y=!1,Object.keys(k).length!==0?d++:delete v[P][S]}d===0&&delete v[P]}for(var M=0;M<this._textLines.length;M++)x+=this._textLines[M].length;y&&g===x&&(this[m]=f,this.removeStyle(m))},removeStyle:function(m){if(!(!this.styles||!m||m==="")){var v=this.styles,g,d,f;for(d in v){g=v[d];for(f in g)delete g[f][m],Object.keys(g[f]).length===0&&delete g[f];Object.keys(g).length===0&&delete v[d]}}},_extendStyles:function(m,v){var g=this.get2DCursorLocation(m);this._getLineStyle(g.lineIndex)||this._setLineStyle(g.lineIndex),this._getStyleDeclaration(g.lineIndex,g.charIndex)||this._setStyleDeclaration(g.lineIndex,g.charIndex,{}),n.util.object.extend(this._getStyleDeclaration(g.lineIndex,g.charIndex),v)},get2DCursorLocation:function(m,v){typeof m>"u"&&(m=this.selectionStart);for(var g=v?this._unwrappedTextLines:this._textLines,d=g.length,f=0;f<d;f++){if(m<=g[f].length)return{lineIndex:f,charIndex:m};m-=g[f].length+this.missingNewlineOffset(f,v)}return{lineIndex:f-1,charIndex:g[f-1].length<m?g[f-1].length:m}},getSelectionStyles:function(m,v,g){typeof m>"u"&&(m=this.selectionStart||0),typeof v>"u"&&(v=this.selectionEnd||m);for(var d=[],f=m;f<v;f++)d.push(this.getStyleAtPosition(f,g));return d},getStyleAtPosition:function(m,v){var g=this.get2DCursorLocation(m),d=v?this.getCompleteStyleDeclaration(g.lineIndex,g.charIndex):this._getStyleDeclaration(g.lineIndex,g.charIndex);return d||{}},setSelectionStyles:function(m,v,g){typeof v>"u"&&(v=this.selectionStart||0),typeof g>"u"&&(g=this.selectionEnd||v);for(var d=v;d<g;d++)this._extendStyles(d,m);return this._forceClearCache=!0,this},_getStyleDeclaration:function(m,v){var g=this.styles&&this.styles[m];return g?g[v]:null},getCompleteStyleDeclaration:function(m,v){for(var g=this._getStyleDeclaration(m,v)||{},d={},f,y=0;y<this._styleProperties.length;y++)f=this._styleProperties[y],d[f]=typeof g[f]>"u"?this[f]:g[f];return d},_setStyleDeclaration:function(m,v,g){this.styles[m][v]=g},_deleteStyleDeclaration:function(m,v){delete this.styles[m][v]},_getLineStyle:function(m){return!!this.styles[m]},_setLineStyle:function(m){this.styles[m]={}},_deleteLineStyle:function(m){delete this.styles[m]}})}(),function(){function m(v){v.textDecoration&&(v.textDecoration.indexOf("underline")>-1&&(v.underline=!0),v.textDecoration.indexOf("line-through")>-1&&(v.linethrough=!0),v.textDecoration.indexOf("overline")>-1&&(v.overline=!0),delete v.textDecoration)}n.IText=n.util.createClass(n.Text,n.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(v,g){this.callSuper("initialize",v,g),this.initBehavior()},setSelectionStart:function(v){v=Math.max(v,0),this._updateAndFire("selectionStart",v)},setSelectionEnd:function(v){v=Math.min(v,this.text.length),this._updateAndFire("selectionEnd",v)},_updateAndFire:function(v,g){this[v]!==g&&(this._fireSelectionChanged(),this[v]=g),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(v){this.clearContextTop(),this.callSuper("render",v),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(v){this.callSuper("_render",v)},clearContextTop:function(v){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var g=this.canvas.contextTop,d=this.canvas.viewportTransform;g.save(),g.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(g),this._clearTextArea(g),v||g.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var v=this._getCursorBoundaries(),g=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(v,g):this.renderSelection(v,g),g.restore()}},_clearTextArea:function(v){var g=this.width+4,d=this.height+4;v.clearRect(-g/2,-d/2,g,d)},_getCursorBoundaries:function(v){typeof v>"u"&&(v=this.selectionStart);var g=this._getLeftOffset(),d=this._getTopOffset(),f=this._getCursorBoundariesOffsets(v);return{left:g,top:d,leftOffset:f.left,topOffset:f.top}},_getCursorBoundariesOffsets:function(v){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var g,d,f,y=0,x=0,k,P=this.get2DCursorLocation(v);f=P.charIndex,d=P.lineIndex;for(var S=0;S<d;S++)y+=this.getHeightOfLine(S);g=this._getLineLeftOffset(d);var E=this.__charBounds[d][f];return E&&(x=E.left),this.charSpacing!==0&&f===this._textLines[d].length&&(x-=this._getWidthOfCharSpacing()),k={top:y,left:g+(x>0?x:0)},this.direction==="rtl"&&(k.left*=-1),this.cursorOffsetCache=k,this.cursorOffsetCache},renderCursor:function(v,g){var d=this.get2DCursorLocation(),f=d.lineIndex,y=d.charIndex>0?d.charIndex-1:0,x=this.getValueOfPropertyAt(f,y,"fontSize"),k=this.scaleX*this.canvas.getZoom(),P=this.cursorWidth/k,S=v.topOffset,E=this.getValueOfPropertyAt(f,y,"deltaY");S+=(1-this._fontSizeFraction)*this.getHeightOfLine(f)/this.lineHeight-x*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(v,g),g.fillStyle=this.cursorColor||this.getValueOfPropertyAt(f,y,"fill"),g.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,g.fillRect(v.left+v.leftOffset-P/2,S+v.top+E,P,x)},renderSelection:function(v,g){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,f=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,y=this.textAlign.indexOf("justify")!==-1,x=this.get2DCursorLocation(d),k=this.get2DCursorLocation(f),P=x.lineIndex,S=k.lineIndex,E=x.charIndex<0?0:x.charIndex,M=k.charIndex<0?0:k.charIndex,T=P;T<=S;T++){var D=this._getLineLeftOffset(T)||0,N=this.getHeightOfLine(T),I=0,O=0,F=0;if(T===P&&(O=this.__charBounds[P][E].left),T>=P&&T<S)F=y&&!this.isEndOfWrapping(T)?this.width:this.getLineWidth(T)||5;else if(T===S)if(M===0)F=this.__charBounds[S][M].left;else{var q=this._getWidthOfCharSpacing();F=this.__charBounds[S][M-1].left+this.__charBounds[S][M-1].width-q}I=N,(this.lineHeight<1||T===S&&this.lineHeight>1)&&(N/=this.lineHeight);var Y=v.left+D+O,_e=F-O,ne=N,ve=0;this.inCompositionMode?(g.fillStyle=this.compositionColor||"black",ne=1,ve=N):g.fillStyle=this.selectionColor,this.direction==="rtl"&&(Y=this.width-Y-_e),g.fillRect(Y,v.top+v.topOffset+ve,_e,ne),v.topOffset+=I}},getCurrentCharFontSize:function(){var v=this._getCurrentCharIndex();return this.getValueOfPropertyAt(v.l,v.c,"fontSize")},getCurrentCharColor:function(){var v=this._getCurrentCharIndex();return this.getValueOfPropertyAt(v.l,v.c,"fill")},_getCurrentCharIndex:function(){var v=this.get2DCursorLocation(this.selectionStart,!0),g=v.charIndex>0?v.charIndex-1:0;return{l:v.lineIndex,c:g}}}),n.IText.fromObject=function(v,g){var d=n.util.stylesFromArray(v.styles,v.text),f=Object.assign({},v,{styles:d});if(delete f.path,m(f),f.styles)for(var y in f.styles)for(var x in f.styles[y])m(f.styles[y][x]);n.Object._fromObject("IText",f,function(k){v.path?n.Object._fromObject("Path",v.path,function(P){k.set("path",P),g(k)},"path"):g(k)},"text")}}(),function(){var m=n.util.object.clone;n.util.object.extend(n.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var v=this;this.on("added",function(){var g=v.canvas;g&&(g._hasITextHandlers||(g._hasITextHandlers=!0,v._initCanvasHandlers(g)),g._iTextInstances=g._iTextInstances||[],g._iTextInstances.push(v))})},initRemovedHandler:function(){var v=this;this.on("removed",function(){var g=v.canvas;g&&(g._iTextInstances=g._iTextInstances||[],n.util.removeFromArray(g._iTextInstances,v),g._iTextInstances.length===0&&(g._hasITextHandlers=!1,v._removeCanvasHandlers(g)))})},_initCanvasHandlers:function(v){v._mouseUpITextHandler=function(){v._iTextInstances&&v._iTextInstances.forEach(function(g){g.__isMousedown=!1})},v.on("mouse:up",v._mouseUpITextHandler)},_removeCanvasHandlers:function(v){v.off("mouse:up",v._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(v,g,d,f){var y;return y={isAborted:!1,abort:function(){this.isAborted=!0}},v.animate("_currentCursorOpacity",g,{duration:d,onComplete:function(){y.isAborted||v[f]()},onChange:function(){v.canvas&&v.selectionStart===v.selectionEnd&&v.renderCursorOrSelection()},abort:function(){return y.isAborted}}),y},_onTickComplete:function(){var v=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){v._currentTickCompleteState=v._animateCursor(v,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(v){var g=this,d=v?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){g._tick()},d)},abortCursorAnimation:function(){var v=this._currentTickState||this._currentTickCompleteState,g=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,v&&g&&g.clearContext(g.contextTop||g.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(v){var g=0,d=v-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)g++,d--;for(;/\S/.test(this._text[d])&&d>-1;)g++,d--;return v-g},findWordBoundaryRight:function(v){var g=0,d=v;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)g++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)g++,d++;return v+g},findLineBoundaryLeft:function(v){for(var g=0,d=v-1;!/\n/.test(this._text[d])&&d>-1;)g++,d--;return v-g},findLineBoundaryRight:function(v){for(var g=0,d=v;!/\n/.test(this._text[d])&&d<this._text.length;)g++,d++;return v+g},searchWordBoundary:function(v,g){for(var d=this._text,f=this._reSpace.test(d[v])?v-1:v,y=d[f],x=n.reNonWord;!x.test(y)&&f>0&&f<d.length;)f+=g,y=d[f];return x.test(y)&&(f+=g===1?0:1),f},selectWord:function(v){v=v||this.selectionStart;var g=this.searchWordBoundary(v,-1),d=this.searchWordBoundary(v,1);this.selectionStart=g,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(v){v=v||this.selectionStart;var g=this.findLineBoundaryLeft(v),d=this.findLineBoundaryRight(v);return this.selectionStart=g,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(v){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(v),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(v){v._iTextInstances&&v._iTextInstances.forEach(function(g){g.selected=!1,g.isEditing&&g.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(v){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var g=this.getSelectionStartFromPointer(v.e),d=this.selectionStart,f=this.selectionEnd;(g!==this.__selectionStartOnMouseDown||d===f)&&(d===g||f===g)||(g>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=g):(this.selectionStart=g,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==f)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(v,g,d){var f=d.slice(0,v),y=n.util.string.graphemeSplit(f).length;if(v===g)return{selectionStart:y,selectionEnd:y};var x=d.slice(v,g),k=n.util.string.graphemeSplit(x).length;return{selectionStart:y,selectionEnd:y+k}},fromGraphemeToStringSelection:function(v,g,d){var f=d.slice(0,v),y=f.join("").length;if(v===g)return{selectionStart:y,selectionEnd:y};var x=d.slice(v,g),k=x.join("").length;return{selectionStart:y,selectionEnd:y+k}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var v=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=v.selectionStart,this.hiddenTextarea.selectionEnd=v.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(!!this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var v=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=v.selectionEnd,this.inCompositionMode||(this.selectionStart=v.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var v=this._calcTextareaPosition();this.hiddenTextarea.style.left=v.left,this.hiddenTextarea.style.top=v.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var v=this.inCompositionMode?this.compositionStart:this.selectionStart,g=this._getCursorBoundaries(v),d=this.get2DCursorLocation(v),f=d.lineIndex,y=d.charIndex,x=this.getValueOfPropertyAt(f,y,"fontSize")*this.lineHeight,k=g.leftOffset,P=this.calcTransformMatrix(),S={x:g.left+k,y:g.top+g.topOffset+x},E=this.canvas.getRetinaScaling(),M=this.canvas.upperCanvasEl,T=M.width/E,D=M.height/E,N=T-x,I=D-x,O=M.clientWidth/T,F=M.clientHeight/D;return S=n.util.transformPoint(S,P),S=n.util.transformPoint(S,this.canvas.viewportTransform),S.x*=O,S.y*=F,S.x<0&&(S.x=0),S.x>N&&(S.x=N),S.y<0&&(S.y=0),S.y>I&&(S.y=I),S.x+=this.canvas._offset.left,S.y+=this.canvas._offset.top,{left:S.x+"px",top:S.y+"px",fontSize:x+"px",charHeight:x}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){!this._savedProps||(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var v=this._textBeforeEdit!==this.text,g=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,g&&(g.blur&&g.blur(),g.parentNode&&g.parentNode.removeChild(g)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),v&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),v&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var v in this.styles)this._textLines[v]||delete this.styles[v]},removeStyleFromTo:function(v,g){var d=this.get2DCursorLocation(v,!0),f=this.get2DCursorLocation(g,!0),y=d.lineIndex,x=d.charIndex,k=f.lineIndex,P=f.charIndex,S,E;if(y!==k){if(this.styles[y])for(S=x;S<this._unwrappedTextLines[y].length;S++)delete this.styles[y][S];if(this.styles[k])for(S=P;S<this._unwrappedTextLines[k].length;S++)E=this.styles[k][S],E&&(this.styles[y]||(this.styles[y]={}),this.styles[y][x+S-P]=E);for(S=y+1;S<=k;S++)delete this.styles[S];this.shiftLineStyles(k,y-k)}else if(this.styles[y]){E=this.styles[y];var M=P-x,T,D;for(S=x;S<P;S++)delete E[S];for(D in this.styles[y])T=parseInt(D,10),T>=P&&(E[T-M]=E[D],delete E[D])}},shiftLineStyles:function(v,g){var d=m(this.styles);for(var f in this.styles){var y=parseInt(f,10);y>v&&(this.styles[y+g]=d[y],d[y-g]||delete this.styles[y])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(v,g,d,f){var y,x={},k=!1,P=this._unwrappedTextLines[v].length,S=P===g;d||(d=1),this.shiftLineStyles(v,d),this.styles[v]&&(y=this.styles[v][g===0?g:g-1]);for(var E in this.styles[v]){var M=parseInt(E,10);M>=g&&(k=!0,x[M-g]=this.styles[v][E],S&&g===0||delete this.styles[v][E])}var T=!1;for(k&&!S&&(this.styles[v+d]=x,T=!0),(T||P>g)&&d--;d>0;)f&&f[d-1]?this.styles[v+d]={0:m(f[d-1])}:y?this.styles[v+d]={0:m(y)}:delete this.styles[v+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(v,g,d,f){this.styles||(this.styles={});var y=this.styles[v],x=y?m(y):{};d||(d=1);for(var k in x){var P=parseInt(k,10);P>=g&&(y[P+d]=x[P],x[P-d]||delete y[P])}if(this._forceClearCache=!0,f){for(;d--;)!Object.keys(f[d]).length||(this.styles[v]||(this.styles[v]={}),this.styles[v][g+d]=m(f[d]));return}if(!!y)for(var S=y[g?g-1:1];S&&d--;)this.styles[v][g+d]=m(S)},insertNewStyleBlock:function(v,g,d){for(var f=this.get2DCursorLocation(g,!0),y=[0],x=0,k=0;k<v.length;k++)v[k]===`
`?(x++,y[x]=0):y[x]++;y[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,y[0],d),d=d&&d.slice(y[0]+1)),x&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+y[0],x);for(var k=1;k<x;k++)y[k]>0?this.insertCharStyleObject(f.lineIndex+k,0,y[k],d):d&&this.styles[f.lineIndex+k]&&d[0]&&(this.styles[f.lineIndex+k][0]=d[0]),d=d&&d.slice(y[k]+1);y[k]>0&&this.insertCharStyleObject(f.lineIndex+k,0,y[k],d)},setSelectionStartEndWithShift:function(v,g,d){d<=v?(g===v?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=v),this.selectionStart=d):d>v&&d<g?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(g===v?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=g),this.selectionEnd=d)},setSelectionInBoundaries:function(){var v=this.text.length;this.selectionStart>v?this.selectionStart=v:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>v?this.selectionEnd=v:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),n.util.object.extend(n.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(m){if(!!this.canvas){this.__newClickTime=+new Date;var v=m.pointer;this.isTripleClick(v)&&(this.fire("tripleclick",m),this._stopEvent(m.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=v,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(m){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===m.x&&this.__lastPointer.y===m.y},_stopEvent:function(m){m.preventDefault&&m.preventDefault(),m.stopPropagation&&m.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(m){!this.isEditing||this.selectWord(this.getSelectionStartFromPointer(m.e))},tripleClickHandler:function(m){!this.isEditing||this.selectLine(this.getSelectionStartFromPointer(m.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(m){!this.canvas||!this.editable||m.e.button&&m.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(m.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(m){!this.canvas||!this.editable||m.e.button&&m.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(m){if(this.__isMousedown=!1,!(!this.editable||this.group||m.transform&&m.transform.actionPerformed||m.e.button&&m.e.button!==1)){if(this.canvas){var v=this.canvas._activeObject;if(v&&v!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(m.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(m){var v=this.getSelectionStartFromPointer(m),g=this.selectionStart,d=this.selectionEnd;m.shiftKey?this.setSelectionStartEndWithShift(g,d,v):(this.selectionStart=v,this.selectionEnd=v),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(m){for(var v=this.getLocalPointer(m),g=0,d=0,f=0,y=0,x=0,k,P,S=0,E=this._textLines.length;S<E&&f<=v.y;S++)f+=this.getHeightOfLine(S)*this.scaleY,x=S,S>0&&(y+=this._textLines[S-1].length+this.missingNewlineOffset(S-1));k=this._getLineLeftOffset(x),d=k*this.scaleX,P=this._textLines[x],this.direction==="rtl"&&(v.x=this.width*this.scaleX-v.x+d);for(var M=0,T=P.length;M<T&&(g=d,d+=this.__charBounds[x][M].kernedWidth*this.scaleX,d<=v.x);M++)y++;return this._getNewSelectionStartFromOffset(v,g,d,y,T)},_getNewSelectionStartFromOffset:function(m,v,g,d,f){var y=m.x-v,x=g-m.x,k=x>y||x<0?0:1,P=d+k;return this.flipX&&(P=f-P),P>this._text.length&&(P=this._text.length),P}}),n.util.object.extend(n.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=n.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var m=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+m.top+"; left: "+m.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+m.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):n.document.body.appendChild(this.hiddenTextarea),n.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),n.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),n.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),n.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),n.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),n.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),n.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),n.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),n.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(n.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(m){if(!!this.isEditing){var v=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(m.keyCode in v)this[v[m.keyCode]](m);else if(m.keyCode in this.ctrlKeysMapDown&&(m.ctrlKey||m.metaKey))this[this.ctrlKeysMapDown[m.keyCode]](m);else return;m.stopImmediatePropagation(),m.preventDefault(),m.keyCode>=33&&m.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(m){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(m.keyCode in this.ctrlKeysMapUp&&(m.ctrlKey||m.metaKey))this[this.ctrlKeysMapUp[m.keyCode]](m);else return;m.stopImmediatePropagation(),m.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(m){var v=this.fromPaste;if(this.fromPaste=!1,m&&m.stopPropagation(),!!this.isEditing){var g=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,f=g.length,y,x,k=f-d,P=this.selectionStart,S=this.selectionEnd,E=P!==S,M,T,D;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var N=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),I=P>N.selectionStart;E?(y=this._text.slice(P,S),k+=S-P):f<d&&(I?y=this._text.slice(S+k,S):y=this._text.slice(P,P-k)),x=g.slice(N.selectionEnd-k,N.selectionEnd),y&&y.length&&(x.length&&(M=this.getSelectionStyles(P,P+1,!1),M=x.map(function(){return M[0]})),E?(T=P,D=S):I?(T=S-y.length,D=S):(T=S,D=S+y.length),this.removeStyleFromTo(T,D)),x.length&&(v&&x.join("")===n.copiedText&&!n.disableStyleCopyPaste&&(M=n.copiedTextStyle),this.insertNewStyleBlock(x,P,M)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(m){this.compositionStart=m.target.selectionStart,this.compositionEnd=m.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(n.copiedText=this.getSelectedText(),n.disableStyleCopyPaste?n.copiedTextStyle=null:n.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(m){return m&&m.clipboardData||n.window.clipboardData},_getWidthBeforeCursor:function(m,v){var g=this._getLineLeftOffset(m),d;return v>0&&(d=this.__charBounds[m][v-1],g+=d.left+d.width),g},getDownCursorOffset:function(m,v){var g=this._getSelectionForOffset(m,v),d=this.get2DCursorLocation(g),f=d.lineIndex;if(f===this._textLines.length-1||m.metaKey||m.keyCode===34)return this._text.length-g;var y=d.charIndex,x=this._getWidthBeforeCursor(f,y),k=this._getIndexOnLine(f+1,x),P=this._textLines[f].slice(y);return P.length+k+1+this.missingNewlineOffset(f)},_getSelectionForOffset:function(m,v){return m.shiftKey&&this.selectionStart!==this.selectionEnd&&v?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(m,v){var g=this._getSelectionForOffset(m,v),d=this.get2DCursorLocation(g),f=d.lineIndex;if(f===0||m.metaKey||m.keyCode===33)return-g;var y=d.charIndex,x=this._getWidthBeforeCursor(f,y),k=this._getIndexOnLine(f-1,x),P=this._textLines[f].slice(0,y),S=this.missingNewlineOffset(f-1);return-this._textLines[f-1].length+k-P.length+(1-S)},_getIndexOnLine:function(m,v){for(var g=this._textLines[m],d=this._getLineLeftOffset(m),f=d,y=0,x,k,P=0,S=g.length;P<S;P++)if(x=this.__charBounds[m][P].width,f+=x,f>v){k=!0;var E=f-x,M=f,T=Math.abs(E-v),D=Math.abs(M-v);y=D<T?P:P-1;break}return k||(y=g.length-1),y},moveCursorDown:function(m){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",m)},moveCursorUp:function(m){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",m)},_moveCursorUpOrDown:function(m,v){var g="get"+m+"CursorOffset",d=this[g](v,this._selectionDirection==="right");v.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(m){var v=this._selectionDirection==="left"?this.selectionStart+m:this.selectionEnd+m;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,v),m!==0},moveCursorWithoutShift:function(m){return m<0?(this.selectionStart+=m,this.selectionEnd=this.selectionStart):(this.selectionEnd+=m,this.selectionStart=this.selectionEnd),m!==0},moveCursorLeft:function(m){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",m)},_move:function(m,v,g){var d;if(m.altKey)d=this["findWordBoundary"+g](this[v]);else if(m.metaKey||m.keyCode===35||m.keyCode===36)d=this["findLineBoundary"+g](this[v]);else return this[v]+=g==="Left"?-1:1,!0;if(typeof d<"u"&&this[v]!==d)return this[v]=d,!0},_moveLeft:function(m,v){return this._move(m,v,"Left")},_moveRight:function(m,v){return this._move(m,v,"Right")},moveCursorLeftWithoutShift:function(m){var v=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(v=this._moveLeft(m,"selectionStart")),this.selectionEnd=this.selectionStart,v},moveCursorLeftWithShift:function(m){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(m,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(m,"selectionStart")},moveCursorRight:function(m){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",m)},_moveCursorLeftOrRight:function(m,v){var g="moveCursor"+m+"With";this._currentCursorOpacity=1,v.shiftKey?g+="Shift":g+="outShift",this[g](v)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(m){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(m,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(m,"selectionEnd")},moveCursorRightWithoutShift:function(m){var v=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(v=this._moveRight(m,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,v},removeChars:function(m,v){typeof v>"u"&&(v=m+1),this.removeStyleFromTo(m,v),this._text.splice(m,v-m),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(m,v,g,d){typeof d>"u"&&(d=g),d>g&&this.removeStyleFromTo(g,d);var f=n.util.string.graphemeSplit(m);this.insertNewStyleBlock(f,g,v),this._text=[].concat(this._text.slice(0,g),f,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var m=n.util.toFixed,v=n.util.radiansToDegrees,g=n.util.calcRotateMatrix,d=n.util.transformPoint,f=/  +/g;n.util.object.extend(n.Text.prototype,{_toSVG:function(){var y=this._getSVGLeftTopOffsets(),x=this._getSVGTextAndBg(y.textTop,y.textLeft);return this._wrapSVGTextAndBg(x)},toSVG:function(y){var x=this._createBaseSVGMarkup(this._toSVG(),{reviver:y,noStyle:!0,withShadow:!0}),k=this.path;return k?x+k._createBaseSVGMarkup(k._toSVG(),{reviver:y,withShadow:!0}):x},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(y){var x=!0,k=this.getSvgTextDecoration(this);return[y.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",k?'text-decoration="'+k+'" ':"",'style="',this.getSvgStyles(x),'"',this.addPaintOrder()," >",y.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(y,x){var k=[],P=[],S=y,E;this._setSVGBg(P);for(var M=0,T=this._textLines.length;M<T;M++)E=this._getLineLeftOffset(M),(this.textBackgroundColor||this.styleHas("textBackgroundColor",M))&&this._setSVGTextLineBg(P,M,x+E,S),this._setSVGTextLineText(k,M,x+E,S),S+=this.getHeightOfLine(M);return{textSpans:k,textBgRects:P}},_createTextCharSpan:function(y,x,k,P,S){var E=y!==y.trim()||y.match(f),M=this.getSvgSpanStyles(x,E),T=M?'style="'+M+'"':"",D=x.deltaY,N="",I=n.Object.NUM_FRACTION_DIGITS,O="";if(D&&(N=' dy="'+m(D,I)+'" '),S.renderLeft!==void 0){var F=S.angle;O=' rotate="'+m(v(F),n.Object.NUM_FRACTION_DIGITS)+'" ';var q=S.width/2,Y=g({angle:v(F)});Y[4]=S.renderLeft,Y[5]=S.renderTop;var _e=d({x:-q,y:0},Y);k=_e.x,P=_e.y}return['<tspan x="',m(k,I),'" y="',m(P,I),'" ',N,T,O,">",n.util.string.escapeXml(y),"</tspan>"].join("")},_setSVGTextLineText:function(y,x,k,P){var S=this.getHeightOfLine(x),E=this.textAlign.indexOf("justify")!==-1,M,T,D="",N,I,O=0,F=this._textLines[x],q;P+=S*(1-this._fontSizeFraction)/this.lineHeight;for(var Y=0,_e=F.length-1;Y<=_e;Y++)q=Y===_e||this.charSpacing||this.path,D+=F[Y],N=this.__charBounds[x][Y],O===0?(k+=N.kernedWidth-N.width,O+=N.width):O+=N.kernedWidth,E&&!q&&this._reSpaceAndTab.test(F[Y])&&(q=!0),q||(M=M||this.getCompleteStyleDeclaration(x,Y),T=this.getCompleteStyleDeclaration(x,Y+1),q=n.util.hasStyleChanged(M,T,!0)),q&&(I=this._getStyleDeclaration(x,Y)||{},y.push(this._createTextCharSpan(D,I,k,P,N)),D="",M=T,k+=O,O=0)},_pushTextBgRect:function(y,x,k,P,S,E){var M=n.Object.NUM_FRACTION_DIGITS;y.push("		<rect ",this._getFillAttributes(x),' x="',m(k,M),'" y="',m(P,M),'" width="',m(S,M),'" height="',m(E,M),`"></rect>
`)},_setSVGTextLineBg:function(y,x,k,P){for(var S=this._textLines[x],E=this.getHeightOfLine(x)/this.lineHeight,M=0,T=0,D,N,I=this.getValueOfPropertyAt(x,0,"textBackgroundColor"),O=0,F=S.length;O<F;O++)D=this.__charBounds[x][O],N=this.getValueOfPropertyAt(x,O,"textBackgroundColor"),N!==I?(I&&this._pushTextBgRect(y,I,k+T,P,M,E),T=D.left,M=D.width,I=N):M+=D.kernedWidth;N&&this._pushTextBgRect(y,N,k+T,P,M,E)},_getFillAttributes:function(y){var x=y&&typeof y=="string"?new n.Color(y):"";return!x||!x.getSource()||x.getAlpha()===1?'fill="'+y+'"':'opacity="'+x.getAlpha()+'" fill="'+x.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(y){for(var x=0,k=0,P=0;P<y;P++)x+=this.getHeightOfLine(P);return k=this.getHeightOfLine(P),{lineTop:x,offset:(this._fontSizeMult-this._fontSizeFraction)*k/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(y){var x=n.Object.prototype.getSvgStyles.call(this,y);return x+" white-space: pre;"}})}(),function(m){var v=m.fabric||(m.fabric={});v.Textbox=v.util.createClass(v.IText,v.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:v.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(g){for(var d=0,f=0,y=0,x={},k=0;k<g.graphemeLines.length;k++)g.graphemeText[y]===`
`&&k>0?(f=0,y++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(g.graphemeText[y])&&k>0&&(f++,y++),x[k]={line:d,offset:f},y+=g.graphemeLines[k].length,f+=g.graphemeLines[k].length;return x},styleHas:function(g,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[d];f&&(d=f.line)}return v.Text.prototype.styleHas.call(this,g,d)},isEmptyStyles:function(g){if(!this.styles)return!0;var d=0,f=g+1,y,x,k=!1,P=this._styleMap[g],S=this._styleMap[g+1];P&&(g=P.line,d=P.offset),S&&(f=S.line,k=f===g,y=S.offset),x=typeof g>"u"?this.styles:{line:this.styles[g]};for(var E in x)for(var M in x[E])if(M>=d&&(!k||M<y))for(var T in x[E][M])return!1;return!0},_getStyleDeclaration:function(g,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[g];if(!f)return null;g=f.line,d=f.offset+d}return this.callSuper("_getStyleDeclaration",g,d)},_setStyleDeclaration:function(g,d,f){var y=this._styleMap[g];g=y.line,d=y.offset+d,this.styles[g][d]=f},_deleteStyleDeclaration:function(g,d){var f=this._styleMap[g];g=f.line,d=f.offset+d,delete this.styles[g][d]},_getLineStyle:function(g){var d=this._styleMap[g];return!!this.styles[d.line]},_setLineStyle:function(g){var d=this._styleMap[g];this.styles[d.line]={}},_wrapText:function(g,d){var f=[],y;for(this.isWrapping=!0,y=0;y<g.length;y++)f=f.concat(this._wrapLine(g[y],y,d));return this.isWrapping=!1,f},_measureWord:function(g,d,f){var y=0,x,k=!0;f=f||0;for(var P=0,S=g.length;P<S;P++){var E=this._getGraphemeBox(g[P],d,P+f,x,k);y+=E.kernedWidth,x=g[P]}return y},_wrapLine:function(g,d,f,Y){var x=0,k=this.splitByGrapheme,P=[],S=[],E=k?v.util.string.graphemeSplit(g):g.split(this._wordJoiners),M="",T=0,D=k?"":" ",N=0,I=0,O=0,F=!0,q=this._getWidthOfCharSpacing(),Y=Y||0;E.length===0&&E.push([]),f-=Y;for(var _e=0;_e<E.length;_e++)M=k?E[_e]:v.util.string.graphemeSplit(E[_e]),N=this._measureWord(M,d,T),T+=M.length,x+=I+N-q,x>f&&!F?(P.push(S),S=[],x=N,F=!0):x+=q,!F&&!k&&S.push(D),S=S.concat(M),I=k?0:this._measureWord([D],d,T),T++,F=!1,N>O&&(O=N);return _e&&P.push(S),O+Y>this.dynamicMinWidth&&(this.dynamicMinWidth=O-q+Y),P},isEndOfWrapping:function(g){return!this._styleMap[g+1]||this._styleMap[g+1].line!==this._styleMap[g].line},missingNewlineOffset:function(g,d){return this.splitByGrapheme&&!d?this.isEndOfWrapping(g)?1:0:1},_splitTextIntoLines:function(g){for(var d=v.Text.prototype._splitTextIntoLines.call(this,g),f=this._wrapText(d.lines,this.width),y=new Array(f.length),x=0;x<f.length;x++)y[x]=f[x].join("");return d.lines=y,d.graphemeLines=f,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var g={};for(var d in this._styleMap)this._textLines[d]&&(g[this._styleMap[d].line]=1);for(var d in this.styles)g[d]||delete this.styles[d]},toObject:function(g){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(g))}}),v.Textbox.fromObject=function(g,d){var f=v.util.stylesFromArray(g.styles,g.text),y=Object.assign({},g,{styles:f});return delete y.path,v.Object._fromObject("Textbox",y,function(x){g.path?v.Object._fromObject("Path",g.path,function(k){x.set("path",k),d(x)},"path"):d(x)},"text")}}(e),function(){var m=n.controlsUtils,v=m.scaleSkewCursorStyleHandler,g=m.scaleCursorStyleHandler,d=m.scalingEqually,f=m.scalingYOrSkewingX,y=m.scalingXOrSkewingY,x=m.scaleOrSkewActionName,k=n.Object.prototype.controls;if(k.ml=new n.Control({x:-.5,y:0,cursorStyleHandler:v,actionHandler:y,getActionName:x}),k.mr=new n.Control({x:.5,y:0,cursorStyleHandler:v,actionHandler:y,getActionName:x}),k.mb=new n.Control({x:0,y:.5,cursorStyleHandler:v,actionHandler:f,getActionName:x}),k.mt=new n.Control({x:0,y:-.5,cursorStyleHandler:v,actionHandler:f,getActionName:x}),k.tl=new n.Control({x:-.5,y:-.5,cursorStyleHandler:g,actionHandler:d}),k.tr=new n.Control({x:.5,y:-.5,cursorStyleHandler:g,actionHandler:d}),k.bl=new n.Control({x:-.5,y:.5,cursorStyleHandler:g,actionHandler:d}),k.br=new n.Control({x:.5,y:.5,cursorStyleHandler:g,actionHandler:d}),k.mtr=new n.Control({x:0,y:-.5,actionHandler:m.rotationWithSnapping,cursorStyleHandler:m.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),n.Textbox){var P=n.Textbox.prototype.controls={};P.mtr=k.mtr,P.tr=k.tr,P.br=k.br,P.tl=k.tl,P.bl=k.bl,P.mt=k.mt,P.mb=k.mb,P.mr=new n.Control({x:.5,y:0,actionHandler:m.changeWidth,cursorStyleHandler:v,actionName:"resizing"}),P.ml=new n.Control({x:-.5,y:0,actionHandler:m.changeWidth,cursorStyleHandler:v,actionName:"resizing"})}}()})(fabric$1);const createFTextClass=()=>{fabric.FText=fabric.util.createClass(fabric.Textbox,{type:"f-text",padding:0,paintFirst:"stroke",initDimensions:function(){if(this.__skipDimension)return;this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces();const e=this.calcTextHeight();this.path?this.height=this.path.height>e?this.path.height:e:this.height=e,this.saveState({propertySet:"_dimensionAffectingProps"})}})},extend$2=fabric$1.fabric.util.object.extend,createFLineClass=()=>{fabric$1.fabric.FLine=fabric$1.fabric.util.createClass(fabric$1.fabric.Line,{type:"f-line",padding:6,borderColor:"#00000000",setStrokeWidth(e){this.set("strokeWidth",e)},setStrokeDashArray(e){this.set("strokeDashArray",e)},setStrokeLineCap(e){this.set("strokeLineCap",e?"round":"butt")},toObject(e){return extend$2(this.callSuper("toObject",e),{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2})}}),fabric$1.fabric.FLine.fromObject=(e,n)=>{function o(u){delete u.points,n&&n(u)}const r={...e};r.points=[e.x1,e.y1,e.x2,e.y2],fabric$1.fabric.Object._fromObject("FLine",r,o,"points")}};function createCustomClass(){createFTextClass(),createFLineClass()}const TEXTBOX_DEFAULT_CONFIG={editingBorderColor:"#1460F3",fontFamily:"Arial",fill:"#000000",fontStyle:"normal",fontWeight:"normal",fontSize:14,textAlign:"left",backgroundColor:"",opacity:1,width:100,zoomX:1,zoomY:1,splitByGrapheme:!0},SQUARE_DEFAULT_CONFIG={stroke:"rgb(0, 0, 0)",fill:"",strokeWidth:1,opacity:1},DATETIME_DEFAULT_CONFIG={format:"DD/MM/YYYY hh:mm:ss",editingBorderColor:"#1460F3",fontFamily:"Arial",fill:"#000000",fontStyle:"normal",fontWeight:"normal",fontSize:12,textAlign:"left",backgroundColor:"",opacity:1,zoomX:1,zoomY:1,width:100,splitByGrapheme:!0},THEME_CONFIG={mode:"Light"},getLocalPoint=(e,n,o,r,u)=>{var s=e.target,w=s.controls[e.corner],m=s.canvas.getZoom(),v=s.padding/m,g=s.toLocalPoint(new fabric$1.fabric.Point(r,u),n,o);return g.x>=v&&(g.x-=v),g.x<=-v&&(g.x+=v),g.y>=v&&(g.y-=v),g.y<=v&&(g.y+=v),g.x-=w.offsetX,g.y-=w.offsetY,g};function isTransformCentered(e){return e.originX==="center"&&e.originY==="center"}const _changeHeight=(e,n,o,r)=>{const u=n.target,s=getLocalPoint(n,n.originX,n.originY,o,r),w=u.strokeWidth/(u.strokeUniform?u.scaleX:1),m=isTransformCentered(n)?2:1,v=u.height,g=Math.abs(s.y*m/u.scaleY)-w;return u.set("height",Math.max(g,0)),v!==g},controlsUtils$2=fabric$1.fabric.controlsUtils,changeHeight=controlsUtils$2.wrapWithFireEvent("resizing",controlsUtils$2.wrapWithFixedAnchor(_changeHeight)),controlsUtils$1=fabric$1.fabric.controlsUtils,initRectControl=()=>{const e=fabric$1.fabric.Object.prototype.controls;if(fabric$1.fabric.Rect){const n=fabric$1.fabric.Rect.prototype.controls={};n.del=e.del,n.tr=e.tr,n.br=e.br,n.tl=e.tl,n.bl=e.bl,n.ml=new fabric$1.fabric.Control({x:-.5,y:0,actionHandler:controlsUtils$1.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),n.mr=new fabric$1.fabric.Control({x:.5,y:0,actionHandler:controlsUtils$1.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render}),n.mt=new fabric$1.fabric.Control({x:0,y:-.5,offsetY:-1,actionHandler:changeHeight,cursorStyleHandler:e.mt.cursorStyleHandler,actionName:"resizing",render:e.mt.render}),n.mb=new fabric$1.fabric.Control({x:0,y:.5,offsetY:1,actionHandler:changeHeight,cursorStyleHandler:e.mb.cursorStyleHandler,actionName:"resizing",render:e.mb.render})}},changeLineEnd=(e,n,o,r)=>{const{target:u}=n;return u.set({x2:o,y2:r}),!0},changeLineStart=(e,n,o,r)=>{const{target:u}=n;return u.set({x1:o,y1:r}),!0},linePositionHandler=(e,n)=>(o,r,u)=>{if(u!=null&&u.canvas){const s=u.calcLinePoints(),w=new fabric$1.fabric.Point(s[e],s[n]);return fabric$1.fabric.util.transformPoint(w,fabric$1.fabric.util.multiplyTransformMatrices(u.canvas.viewportTransform,u.calcTransformMatrix()))}else return new fabric$1.fabric.Point(0,0)},initLineControl=()=>{const e=fabric$1.fabric.Object.prototype.controls;if(fabric$1.fabric.Line){const n=fabric$1.fabric.Line.prototype.controls={};n.del=e.del,n.l1=new fabric$1.fabric.Control({positionHandler:linePositionHandler("x1","y1"),actionHandler:changeLineStart,cursorStyleHandler:()=>"crosshair",actionName:"line-points-change",render:e.br.render}),n.l2=new fabric$1.fabric.Control({positionHandler:linePositionHandler("x2","y2"),actionHandler:changeLineEnd,cursorStyleHandler:()=>"crosshair",actionName:"line-points-change",render:e.br.render})}},controlsUtils=fabric.controlsUtils,initFTextControl=()=>{const e=fabric.Object.prototype.controls;if(fabric.Rect){const n=fabric.FText.prototype.controls={};n.del=e.del,n.tr=e.tr,n.br=e.br,n.tl=e.tl,n.bl=e.bl,n.ml=new fabric.Control({x:-.5,y:0,offsetX:-1,actionHandler:controlsUtils.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),n.mr=new fabric.Control({x:.5,y:0,offsetX:1,actionHandler:controlsUtils.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render})}},removeObject=(e,n)=>{if(e||(e=n.getActiveObject()),!!e)return e.type==="activeSelection"?(e.getObjects().forEach(o=>{n.remove(o)}),n.discardActiveObject()):n.remove(e),handleMouseOutCorner(e),n.requestRenderAll(),n.fire("fabritor:del",{target:null}),!0},renderSizeIcon=(e,n,o,r,u,s)=>{e.save(),e.strokeStyle="#1460F3",e.fillStyle="#FFFFFF",e.lineWidth=2,e.translate(n,o),e.rotate(fabric$1.fabric.util.degreesToRadians(u.angle)),e.beginPath(),e.rect(-3,-3,6,6),e.fill(),e.stroke(),e.restore()},renderLTIcon=(e,n,o)=>{e.save(),e.strokeStyle="#1460F3",e.fillStyle="#FFFFFF",e.lineWidth=2,e.beginPath(),e.rect(n-4,o-4,6,6),e.fill(),e.stroke(),e.restore()},renderLBIcon=(e,n,o)=>{e.save(),e.strokeStyle="#1460F3",e.fillStyle="#FFFFFF",e.lineWidth=2,e.beginPath(),e.rect(n-4,o-2,6,6),e.fill(),e.stroke(),e.restore()},renderRTIcon=(e,n,o)=>{e.save(),e.strokeStyle="#1460F3",e.fillStyle="#FFFFFF",e.lineWidth=2,e.beginPath(),e.rect(n-2,o-4,6,6),e.fill(),e.stroke(),e.restore()},renderRBIcon=(e,n,o)=>{e.save(),e.strokeStyle="#1460F3",e.fillStyle="#FFFFFF",e.lineWidth=2,e.beginPath(),e.rect(n-2,o-2,6,6),e.fill(),e.stroke(),e.restore()};function renderSvgIcon(e){return function(o,r,u,s,w){o.save(),o.translate(r,u),o.fillStyle=THEME_CONFIG.mode==="Light"?"rgba(255, 255, 255, 1)":"#54575C",o.roundRect(-25,-20,50,42,4),o.shadowColor="rgba(0, 0, 0, 0.1)",o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=8,o.fill(),o.rotate(fabric$1.fabric.util.degreesToRadians(w.angle)),o.drawImage(e,-30/2,-30/2+2,30,30),o.restore()}}const renderLRIcon=(e,n,o,r,u)=>{renderSizeIcon(e,n,o,r,u,"LR")},renderTBIcon=(e,n,o,r,u)=>{renderSizeIcon(e,n,o,r,u,"TB")},renderController=()=>{const e={x:0,y:-.5,offsetY:-1,render:renderTBIcon};Object.keys(e).forEach(v=>{fabric$1.fabric.Object.prototype.controls.mt[v]=e[v]});const n={x:0,y:.5,offsetY:1,render:renderTBIcon};Object.keys(n).forEach(v=>{fabric$1.fabric.Object.prototype.controls.mb[v]=n[v]});const o={x:-.5,y:0,offsetX:-1,render:renderLRIcon};Object.keys(o).forEach(v=>{fabric$1.fabric.Object.prototype.controls.ml[v]=o[v]});const r={x:.5,y:0,offsetX:1,render:renderLRIcon};Object.keys(r).forEach(v=>{fabric$1.fabric.Object.prototype.controls.mr[v]=r[v]}),fabric$1.fabric.Object.prototype.borderOpacityWhenMoving=1,fabric$1.fabric.Object.prototype.borderColor="#1460F3",fabric$1.fabric.Object.prototype.padding=5,fabric$1.fabric.Object.prototype.setControlsVisibility({mtr:!1});const u={x:-.5,y:-.5,render:renderLTIcon};Object.keys(u).forEach(v=>{fabric$1.fabric.Object.prototype.controls.tl[v]=u[v]});const s={x:.5,y:-.5,render:renderRTIcon};Object.keys(s).forEach(v=>{fabric$1.fabric.Object.prototype.controls.tr[v]=s[v]});const w={x:-.5,y:.5,render:renderLBIcon};Object.keys(w).forEach(v=>{fabric$1.fabric.Object.prototype.controls.bl[v]=w[v]});const m={x:.5,y:.5,render:renderRBIcon};Object.keys(m).forEach(v=>{fabric$1.fabric.Object.prototype.controls.br[v]=m[v]})},handleDelObject=(e,n)=>{const o=n.target,r=o.canvas;return removeObject(o,r),!0},DEL_IMG=document.createElement("img"),DEL_SVG=`data:image/svg+xml;charset=utf-8,${encodeURIComponent('<svg width="31" height="30" viewBox="0 0 31 30" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.3333 8.15275V6.73608H12.6667V8.15275H18.3333ZM24 10.9861V9.56942H21.875H9.125H7V10.9861H9.125V23.2639H21.875V10.9861H24ZM10.5417 21.8472V10.9861H20.4583V21.8472H10.5417ZM14.3194 13.5833V19.25H12.9028V13.5833H14.3194ZM18.0972 13.5833V19.25H16.6806V13.5833H18.0972Z" fill="#43474D"/></svg>')}`;DEL_IMG.src=DEL_SVG;const DEL_IMG_DARK=document.createElement("img"),DEL_SVG_DARK=`data:image/svg+xml;charset=utf-8,${encodeURIComponent('<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="0" width="30" height="30" rx="4" fill="#54575C"/><path fill-rule="evenodd" clip-rule="evenodd" d="M17.8333 8.15275V6.73608H12.1667V8.15275H17.8333ZM23.5 10.9861V9.56941H21.375H8.625H6.5V10.9861H8.625V23.2639H21.375V10.9861H23.5ZM10.0417 21.8472V10.9861H19.9583V21.8472H10.0417ZM13.8194 13.5833V19.25H12.4028V13.5833H13.8194ZM17.5972 13.5833V19.25H16.1806V13.5833H17.5972Z" fill="white"/></svg>')}`;DEL_IMG_DARK.src=DEL_SVG_DARK;const DEL_SVG_ACTIVE=`data:image/svg+xml;charset=utf-8,${encodeURIComponent('<svg width="31" height="30" viewBox="0 0 31 30" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="0.436768" width="30" height="30" rx="4" fill="#DDE9FF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M18.2701 8.15275V6.73608H12.6034V8.15275H18.2701ZM23.9368 10.9861V9.56942H21.8118H9.06177H6.93677V10.9861H9.06177V23.2639H21.8118V10.9861H23.9368ZM10.4784 21.8472V10.9861H20.3951V21.8472H10.4784ZM14.2562 13.5833V19.25H12.8395V13.5833H14.2562ZM18.034 13.5833V19.25H16.6173V13.5833H18.034Z" fill="#43474D"/></svg>')}`,DEL_IMG_ACTIVE=document.createElement("img");DEL_IMG_ACTIVE.src=DEL_SVG_ACTIVE;const renderToolBarController=()=>{const e=new fabric$1.fabric.Control({x:.5,y:.5,offsetX:-18,offsetY:25,cursorStyle:"pointer",mouseUpHandler:handleDelObject,render:renderSvgIcon(THEME_CONFIG.mode==="Light"?DEL_IMG:DEL_IMG_DARK)});fabric$1.fabric.Object.prototype.controls.del=e},handleMouseOverCorner=(e,n)=>{e==="del"&&(n.controls[e].render=renderSvgIcon(DEL_IMG_ACTIVE)),n.canvas.requestRenderAll()},handleMouseOutCorner=e=>{var n;!e||(n=e.controls)!=null&&n.del&&(e.controls.del.render=renderSvgIcon(THEME_CONFIG.mode==="Light"?DEL_IMG:DEL_IMG_DARK))};function initControl(){renderController(),renderToolBarController(),initRectControl(),initLineControl(),initFTextControl()}class Editor{constructor(n,o){this.options=o||{},this.canvasEl=n,this.canvas=null,this.activeObject=null,this.tool="text",this.shape="rect"}init(){this._initObject(),this.canvas=new fabric$1.fabric.Canvas(this.canvasEl,this.options),this._initEvents()}_initObject(){createCustomClass(),initControl()}_initEvents(){const n=this.canvas;n.on("mouse:move",o=>{this.creatingElement&&this.creatingElement.type==="rect"&&this.updateRect(o),o.target&&console.log("Mouse move:",o.target.type),this.creatingElement&&this.creatingElement.type==="line"&&this.creatingElement&&this.updateLine(o)}),n.on("mouse:up",o=>{if(this.creatingElement){const v=this.creatingElement;if(n.setActiveObject(this.creatingElement),this.activeObject=this.creatingElement,v&&v.type==="rect"&&this.tool==="text"){this.canvas.remove(v);const{left:g,top:d,width:f,height:y}=v;this.createTextbox({text:"",scaleX:1,scaleY:1,left:g,top:d,width:f<1?100:f,height:y<1?16:y})}else v.type==="rect"?(this.updateRect(o),v.width<1&&v.height<1&&this.canvas.remove(v)):v.type==="line"&&(this.updateLine(o),v.width<1&&v.height<1&&this.canvas.remove(v));this.creatingElement=null;return}const{target:r}=o;if(!r)return;const u=r.getScaledWidth(),s=r.getScaledHeight(),w=o.transform.action;r.left<0&&((w==="resizing"||w==="scale")&&(r.scaleX=1,r.width=u+r.left-1),r.set("left",0),r.setCoords()),r.top<0&&((w==="resizing"||w==="scale")&&(r.scaleY=1,r.height=s+r.top-1),r.set("top",0),r.setCoords());const m=n.calcViewportBoundaries();r.left+u>m.br.x&&(w==="resizing"||w==="scale"?(r.scaleX=1,r.width=m.br.x-r.left-1):w==="drag"&&r.set("left",m.br.x-u+10),r.setCoords()),r.top+s>m.br.y&&(w==="resizing"||w==="scale"?(r.scaleY=1,r.height=m.br.y-r.top-1):w==="drag"&&r.set("top",m.br.y-s+10),r.setCoords()),n.renderAll()}),n.on("mouse:down",o=>{const{target:r}=o;if(!r&&this.activeObject){this.activeObject=null;return}if(r||this.activeObject)return;const u=this.tool,s=this.shape;u==="text"?this.createTextboxRect({left:o.absolutePointer.x,top:o.absolutePointer.y}):u==="shape"?s==="rect"?this.createRect({left:o.absolutePointer.x,top:o.absolutePointer.y}):s==="line"&&this.createLine({x:o.absolutePointer.x,y:o.absolutePointer.y}):u==="date"&&this.createDatetime({left:o.absolutePointer.x,top:o.absolutePointer.y,editable:!1})}),n.on("mouse:over",o=>{const{target:r}=o,u=r==null?void 0:r.__corner;u&&handleMouseOverCorner(u,o.target)}),this.canvas.on("mouse:out",o=>{const{target:r}=o;r&&(handleMouseOutCorner(r),n.requestRenderAll())}),n.on("selection:created",this.selectionHandler.bind(this)),n.on("object:scaling",o=>{const r=o.target,u=r.canvas.width,s=r.canvas.height;r.setCoords();const w=r.getBoundingRect(),m=r.getScaledWidth();if(r.getScaledHeight(),r.left+m>u){r.scaleX=1,r.setCoords();let v=r.getScaledWidth();r.scaleX=(u-w.left)/v,r.type==="f-text"&&(r.scaleY=r.scaleX),r.setCoords(),r.canvas.renderAll()}if(w.top+w.height>s){r.scaleY=1,r.setCoords();let v=r.getScaledHeight();r.scaleY=(s-w.top)/v,r.type==="f-text"&&(r.scaleX=r.scaleY),r.setCoords(),r.canvas.renderAll()}if(w.top<0){r.scaleY=1,r.setCoords();let v=r.getScaledHeight();r.scaleY=(w.height+w.top)/v,r.type==="f-text"&&(r.scaleX=r.scaleY),r.set("top",0),r.setCoords(),r.canvas.renderAll()}if(w.left<0){r.scaleX=1,r.setCoords();let v=r.getScaledWidth();r.scaleX=(w.width+w.left)/v,r.type==="f-text"&&(r.scaleY=r.scaleX),r.set("left",0),r.setCoords(),r.canvas.renderAll()}})}updateRect(n){const o=this.creatingElement,{left:r,top:u}=o,{x:s,y:w}=n.absolutePointer,m=this.canvas;if(s<=this.originalPoint.x)o.set("width",this.originalPoint.x-s),o.set("left",s);else if(s>r){const v=Math.min(s-r,m.width-r-3);o.set("width",v)}if(w<=this.originalPoint.y)o.set("height",this.originalPoint.y-w),o.set("top",w);else if(w>u){const v=Math.min(w-u,m.height-u-3);o.set("height",v)}o.setCoords(),m.renderAll()}updateLine(n){const o=this.creatingElement,{x:r,y:u}=n.absolutePointer;o.set("x2",r),o.set("y2",u),o.setCoords(),this.canvas.renderAll()}selectionHandler(n){const{selected:o}=n;if(o&&o.length){const r=this.canvas.getActiveObject();this.activeObject=r}else this.activeObject=null}createTextboxRect(n){const o=this.canvas,r=new fabric$1.fabric.Rect({fill:"",stroke:"#1460F3",strokeWidth:1,opacity:1,...n});return this.creatingElement=r,this.originalPoint={x:n.left,y:n.top},o.add(r),r}createTextbox(n){const o=this.canvas;let{text:r="",...u}=n||{};const s=new fabric$1.fabric.FText(r||"",{...TEXTBOX_DEFAULT_CONFIG,...u});return s.on("editing:entered",w=>{}),s.on("editing:exited",w=>{}),o.add(s),o.setActiveObject(s),this.activeObject=s,s.enterEditing(),o.requestRenderAll(),s}createRect(n){if(this.creating)return;const o=this.canvas,r=new fabric$1.fabric.Rect({...SQUARE_DEFAULT_CONFIG,...n});return this.creatingElement=r,this.originalPoint={x:n.left,y:n.top},o.add(r),r}createDatetime(n){const o=this.canvas,{text:r=""}=n||{},u=r||dayjs(new Date().toLocaleString()).format(DATETIME_DEFAULT_CONFIG.format),s=new fabric$1.fabric.FText(u,{...DATETIME_DEFAULT_CONFIG,...n});return this.creatingElement=s,o.add(s),o.setActiveObject(s),this.activeObject=s,o.requestRenderAll(),s}createLine(n){const o=this.canvas,{x:r,y:u}=n,s=new fabric$1.fabric.Line([r,u,r,u],{...SQUARE_DEFAULT_CONFIG});return this.creatingElement=s,o.add(s),s}destroy(){this.canvas&&(this.canvas.dispose(),this.canvas=null)}clear(){this.canvas&&this.canvas.clear()}}const CustomStamp_vue_vue_type_style_index_0_lang="",_hoisted_1$4a={class:"custom-stamp-wrapper"},_hoisted_2$3Y={class:"signatures-popup-wrapper"},_hoisted_3$3z={class:"custom-stamp-popup"},_hoisted_4$1n={class:"title"},_hoisted_5$S={class:"stamp-container"},_hoisted_6$F={class:"stamp-preview"},_hoisted_7$v={class:"preview-title"},_hoisted_8$q={class:"preview-container"},_hoisted_9$o={class:"custom-category"},_hoisted_10$o={class:"preview"},_hoisted_11$k={class:"canvas-container"},_hoisted_12$j={key:0,class:"canvas-placeholder"},_hoisted_13$j={ref:"workspaceEl"},_hoisted_14$k={class:"stamp-properties"},_hoisted_15$j={class:"properties-title"},_hoisted_16$j={key:0,class:"text-properties properties-container"},_hoisted_17$h={class:"font property"},_hoisted_18$h={class:"property-name"},_hoisted_19$g={class:"font-color property"},_hoisted_20$g={class:"property-name"},_hoisted_21$g={class:"property-container"},_hoisted_22$g={class:"color-picker"},_hoisted_23$e={class:"preview-container active"},_hoisted_24$e=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_25$e={class:"font-weight property"},_hoisted_26$d={class:"property-name"},_hoisted_27$c={class:"font-size property"},_hoisted_28$b={class:"property-name"},_hoisted_29$a={class:"text-align property"},_hoisted_30$a={class:"property-name"},_hoisted_31$8={class:"text-align property-container"},_hoisted_32$7={class:"text-align-content"},_hoisted_33$6={class:"border"},_hoisted_34$6={class:"border"},_hoisted_35$6={class:"fill-color property"},_hoisted_36$5={class:"property-name"},_hoisted_37$4={class:"property-container"},_hoisted_38$4={class:"color-picker"},_hoisted_39$4=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_40$4={class:"opacity property"},_hoisted_41$4={class:"property-name"},_hoisted_42$3={key:1,class:"shape-properties properties-container"},_hoisted_43$3={class:"shape property"},_hoisted_44$3={class:"property-name"},_hoisted_45$3={class:"shape-container property-container"},_hoisted_46$3={class:"border-color property"},_hoisted_47$3={class:"property-name"},_hoisted_48$3={class:"property-container"},_hoisted_49$3={class:"color-picker"},_hoisted_50$3={class:"preview-container active"},_hoisted_51$3=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_52$3={class:"border-width property"},_hoisted_53$2={class:"property-name"},_hoisted_54$2={key:0,class:"fill-color property"},_hoisted_55$2={class:"property-name"},_hoisted_56$2={class:"property-container"},_hoisted_57$2={class:"color-picker"},_hoisted_58$3=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_59$3={class:"fill-opacity property"},_hoisted_60$3={class:"property-name"},_hoisted_61$3={key:2,class:"date-properties properties-container"},_hoisted_62$3={class:"date property"},_hoisted_63$3={class:"property-name"},_hoisted_64$2={class:"font property"},_hoisted_65$2={class:"property-name"},_hoisted_66$2={class:"font-color property"},_hoisted_67$1={class:"property-name"},_hoisted_68$1={class:"property-container"},_hoisted_69$1={class:"color-picker"},_hoisted_70$1={class:"preview-container active"},_hoisted_71$1=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_72$1={class:"font-weight property"},_hoisted_73$1={class:"property-name"},_hoisted_74$1={class:"font-size property"},_hoisted_75$1={class:"property-name"},_hoisted_76$1={class:"text-align property"},_hoisted_77$1={class:"property-name"},_hoisted_78$1={class:"text-align property-container"},_hoisted_79$1={class:"text-align-content"},_hoisted_80$1={class:"border"},_hoisted_81$1={class:"border"},_hoisted_82$1={class:"fill-color property"},_hoisted_83$1={class:"property-name"},_hoisted_84$1={class:"property-container"},_hoisted_85={class:"color-picker"},_hoisted_86=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_87={class:"opacity property"},_hoisted_88={class:"property-name"},_hoisted_89={class:"footer"},_hoisted_90={class:"buttons-container"},_sfc_main$4z={__name:"CustomStamp",setup(e){const o=getCurrentInstance().appContext.app.config.globalProperties.$t,r=ref(null),u=useViewerStore(),s=ref("rgb(255, 255, 255)"),w=ref("rgb(255, 255, 255)"),m=ref("rgb(255, 255, 255)"),v=shallowRef(null),g=ref(0),d=ref("text"),f=()=>{const ve=v.value.canvas.toDataURL({format:"png",multiplier:2});u.addCustomStamps(ve),P()};onMounted(()=>{M();const ve=new Editor(r.value,{width:300,height:300,selection:!1});ve.init(),ve.canvas.on("selection:updated",()=>{x()}),ve.canvas.on("selection:created",()=>{x()}),ve.canvas.on("selection:cleared",()=>{M()}),ve.canvas.on("object:added",()=>{g.value=ve.canvas.getObjects().length}),ve.canvas.on("object:removed",()=>{g.value=ve.canvas.getObjects().length,v.value.activeObject=null}),v.value=ve});const y=(ve,J)=>ve==="bold"&&J==="oblique"?"boldOblique":ve==="bold"?"bold":J==="oblique"?"oblique":"normal",x=()=>{const ve=v.value.canvas.getActiveObject();if(ve&&ve.type==="f-text"&&ve.editable){d.value="text";const J=ve.fontSize,fe=ve.fontFamily,Z=ve.fill,j=ve.textAlign,X=ve.opacity,H=y(ve.fontWeight,ve.fontStyle);S.text.fontFamily=fe,S.text.fill=Z,S.text.fontStyle=H,S.text.fontSize=J,S.text.textAlign=j,S.text.backgroundColor=ve.backgroundColor,S.text.opacity=X*100+"%"}else if(ve&&ve.type==="f-text"&&!ve.editable){d.value="date";const J=ve.format,fe=ve.fontSize,Z=ve.fontFamily,j=ve.fill,X=ve.textAlign,H=ve.opacity,U=y(ve.fontWeight,ve.fontStyle);S.date.format=J,S.date.fontFamily=Z,S.date.fill=j,S.date.fontStyle=U,S.date.fontSize=fe,S.date.textAlign=X,S.date.backgroundColor=ve.backgroundColor,S.date.opacity=H*100+"%"}else if(ve&&ve.type==="rect"){d.value="shape",S.shape.tool="rect";const J=ve.fill,fe=ve.stroke,Z=ve.strokeWidth,j=ve.opacity;S.shape.fill=J,S.shape.stroke=fe,S.shape.strokeWidth=Z,S.shape.opacity=j*100+"%"}else if(ve&&ve.type==="line"){d.value="shape",S.shape.tool="line";const J=ve.stroke,fe=ve.strokeWidth,Z=ve.opacity;S.shape.stroke=J,S.shape.strokeWidth=fe,S.shape.opacity=Z*100+"%"}},k=()=>{v.value&&v.value.clear()},P=()=>{u.closeElement("createCustomStampDialog")},S=reactive({text:{fontFamily:"Arial",fill:"rgb(0, 0, 0)",fontSize:12,fontStyle:"normal",textAlign:"left",backgroundColor:"",borderWidth:1,opacity:"100%"},shape:{tool:"rect",stroke:"rgb(0, 0, 0)",strokeWidth:1,fill:"",opacity:"100%"},date:{fontFamily:"Arial",fill:"rgb(0, 0, 0)",fontSize:12,fontStyle:"normal",textAlign:"left",backgroundColor:"",opacity:"100%",format:"DD/MM/YYYY hh:mm:ss"}}),E=[{label:"Arial",value:"Arial"},{label:"Times-Roman",value:"Times-Roman"},{label:"Courier",value:"Courier"},{label:"Helvetica",value:"Helvetica"}],M=()=>{const ve={fontSize:TEXTBOX_DEFAULT_CONFIG.fontSize,fontFamily:TEXTBOX_DEFAULT_CONFIG.fontFamily,fill:TEXTBOX_DEFAULT_CONFIG.fill,textAlign:TEXTBOX_DEFAULT_CONFIG.textAlign,opacity:TEXTBOX_DEFAULT_CONFIG.opacity,fontStyle:y(TEXTBOX_DEFAULT_CONFIG.fontWeight,TEXTBOX_DEFAULT_CONFIG.fontStyle),backgroundColor:TEXTBOX_DEFAULT_CONFIG.backgroundColor};ve.backgroundColor&&(s.value=ve.backgroundColor),S.text.fontFamily=ve.fontFamily,S.text.fill=ve.fill,S.text.fontStyle=ve.fontStyle,S.text.fontSize=ve.fontSize,S.text.textAlign=ve.textAlign,S.text.backgroundColor=ve.backgroundColor,S.text.opacity=ve.opacity*100+"%";const J={stroke:SQUARE_DEFAULT_CONFIG.stroke,strokeWidth:SQUARE_DEFAULT_CONFIG.strokeWidth,fill:SQUARE_DEFAULT_CONFIG.fill,opacity:SQUARE_DEFAULT_CONFIG.opacity};J.fill&&(w.value=J.fill),S.shape.stroke=J.stroke,S.shape.strokeWidth=J.strokeWidth,S.shape.fill=J.fill,S.shape.opacity=J.opacity*100+"%";const fe={fontSize:DATETIME_DEFAULT_CONFIG.fontSize,fontFamily:DATETIME_DEFAULT_CONFIG.fontFamily,fill:DATETIME_DEFAULT_CONFIG.fill,textAlign:DATETIME_DEFAULT_CONFIG.textAlign,opacity:DATETIME_DEFAULT_CONFIG.opacity,fontStyle:y(DATETIME_DEFAULT_CONFIG.fontWeight,DATETIME_DEFAULT_CONFIG.fontStyle),backgroundColor:DATETIME_DEFAULT_CONFIG.backgroundColor,format:DATETIME_DEFAULT_CONFIG.format};fe.backgroundColor&&(m.value=fe.backgroundColor),S.date.fontSize=fe.fontSize,S.date.fontFamily=fe.fontFamily,S.date.fill=fe.fill,S.date.textAlign=fe.textAlign,S.date.opacity=fe.opacity*100+"%",S.date.fontStyle=fe.fontStyle,S.date.backgroundColor=fe.backgroundColor,S.date.format=fe.format},T=computed(()=>[{label:o("common.fontStyles.regular"),value:"normal"},{label:o("common.fontStyles.bold"),value:"bold"},{label:o("common.fontStyles.boldOblique"),value:"boldOblique"},{label:o("common.fontStyles.oblique"),value:"oblique"}]),D=(ve,J)=>{S[d.value][J]=ve,J==="backgroundColor"?d.value==="text"?s.value=ve:d.value==="date"&&(m.value=ve):J==="fill"&&d.value==="shape"&&(w.value=ve)},N=(ve,J)=>{S[d.value][J]=ve,J==="backgroundColor"?d.value==="text"?s.value=ve:d.value==="date"&&(m.value=ve):J==="fill"&&d.value==="shape"&&(w.value=ve)},I=ve=>{S[d.value].textAlign=ve},O=[{label:"6 pt",value:6},{label:"7 pt",value:7},{label:"8 pt",value:8},{label:"9 pt",value:9},{label:"10 pt",value:10},{label:"11 pt",value:11},{label:"12 pt",value:12},{label:"13 pt",value:13},{label:"14 pt",value:14},{label:"15 pt",value:15},{label:"16 pt",value:16},{label:"17 pt",value:17},{label:"18 pt",value:18},{label:"24 pt",value:20},{label:"36 pt",value:36},{label:"48 pt",value:48},{label:"72 pt",value:72}],F=[{label:"1 pt",value:1},{label:"2 pt",value:2},{label:"3 pt",value:3},{label:"4 pt",value:4},{label:"5 pt",value:5},{label:"6 pt",value:6},{label:"7 pt",value:7},{label:"8 pt",value:8},{label:"9 pt",value:9},{label:"10 pt",value:10}],q=[{label:"25%",value:"25%"},{label:"50%",value:"50%"},{label:"75%",value:"75%"},{label:"100%",value:"100%"}],Y=[{label:"dd/mm/yyyy",value:"DD/MM/YYYY"},{label:"dd.mm.yyyy",value:"DD.MM.YYYY"},{label:"dd-mm-yyyy",value:"DD-MM-YYYY"},{label:"dd mm yyyy",value:"DD MM YYYY"},{label:"yyyy/mm/dd",value:"YYYY/MM/DD"},{label:"yyyy.mm.dd",value:"YYYY.MM.DD"},{label:"yyyy-mm-dd",value:"YYYY-MM-DD"},{label:"yyyy mm dd",value:"YYYY MM DD"},{label:"dd/mm/yyyy hh:mm:ss",value:"DD/MM/YYYY hh:mm:ss"},{label:"dd.mm.yyyy hh:mm:ss",value:"DD.MM.YYYY hh:mm:ss"},{label:"dd-mm-yyyy hh:mm:ss",value:"DD-MM-YYYY hh:mm:ss"},{label:"dd mm yyyy hh:mm:ss",value:"DD MM YYYY hh:mm:ss"},{label:"yyyy/mm/dd hh:mm:ss",value:"YYYY/MM/DD hh:mm:ss"},{label:"yyyy.mm.dd hh:mm:ss",value:"YYYY.MM.DD hh:mm:ss"},{label:"yyyy-mm-dd hh:mm:ss",value:"YYYY-MM-DD hh:mm:ss"},{label:"yyyy mm dd hh:mm:ss",value:"YYYY MM DD hh:mm:ss"}],_e=ve=>{const J=v.value.canvas.getActiveObject();J&&(v.value.canvas.discardActiveObject(J),v.value.canvas.renderAll(),v.value.activeObject=null),d.value=ve},ne=ve=>{const J=v.value.canvas.getActiveObject();J&&(v.value.canvas.discardActiveObject(J),v.value.canvas.renderAll(),v.value.activeObject=null),S.shape.tool=ve};return watch(()=>d.value,(ve,J)=>{v.value.tool=ve}),watch(()=>S.shape.tool,(ve,J)=>{v.value.shape=ve}),watch(()=>S.text.fontFamily,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("fontFamily",ve),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.fontFamily=ve}}),watch(()=>S.text.fill,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("fill",ve),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.fill=ve}}),watch(()=>S.text.fontSize,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("fontSize",ve),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.fontSize=ve}}),watch(()=>S.text.fontStyle,ve=>{if(v.value){const J=v.value.canvas.getActiveObject(),fe=ve.toLowerCase().indexOf("oblique")>-1?"oblique":"normal",Z=ve.indexOf("bold")>-1?"bold":"normal";J&&J.type==="f-text"&&J.editable?(J.set("fontStyle",fe),J.set("fontWeight",Z),v.value.canvas.renderAll()):(TEXTBOX_DEFAULT_CONFIG.fontStyle=fe,TEXTBOX_DEFAULT_CONFIG.fontWeight=Z)}}),watch(()=>S.text.textAlign,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("textAlign",ve),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.textAlign=ve}}),watch(()=>S.text.backgroundColor,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("backgroundColor",ve),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.backgroundColor=ve}}),watch(()=>S.text.opacity,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&J.editable?(J.set("opacity",parseInt(ve)/100),v.value.canvas.renderAll()):TEXTBOX_DEFAULT_CONFIG.opacity=parseInt(ve)/100}}),watch(()=>S.shape.stroke,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&(J.type==="rect"&&S.shape.tool==="rect"||J.type==="line"&&S.shape.tool==="line")?(J.set("stroke",ve),v.value.canvas.renderAll()):SQUARE_DEFAULT_CONFIG.stroke=ve}}),watch(()=>S.shape.strokeWidth,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&(J.type==="rect"&&S.shape.tool==="rect"||J.type==="line"&&S.shape.tool==="line")?(J.set("strokeWidth",ve),v.value.canvas.renderAll()):SQUARE_DEFAULT_CONFIG.strokeWidth=ve}}),watch(()=>S.shape.fill,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="rect"&&S.shape.tool==="rect"?(J.set("fill",ve),v.value.canvas.renderAll()):SQUARE_DEFAULT_CONFIG.fill=ve}}),watch(()=>S.shape.opacity,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&(J.type==="rect"&&S.shape.tool==="rect"||J.type==="line"&&S.shape.tool==="line")?(J.set("opacity",parseInt(ve)/100),v.value.canvas.renderAll()):SQUARE_DEFAULT_CONFIG.opacity=parseInt(ve)/100}}),watch(()=>S.date.format,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();if(J&&J.type==="f-text"&&!J.editable){const fe=dayjs().format(ve);J.set("text",fe),v.value.canvas.renderAll()}else DATETIME_DEFAULT_CONFIG.format=ve}}),watch(()=>S.date.fontFamily,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("fontFamily",ve),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.fontFamily=ve}}),watch(()=>S.date.fill,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("fill",ve),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.fill=ve}}),watch(()=>S.date.fontSize,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("fontSize",ve),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.fontSize=ve}}),watch(()=>S.date.fontStyle,ve=>{if(v.value){const J=v.value.canvas.getActiveObject(),fe=ve.toLowerCase().indexOf("oblique")>-1?"oblique":"normal",Z=ve.indexOf("bold")>-1?"bold":"normal";J&&J.type==="f-text"&&!J.editable?(J.set("fontStyle",fe),J.set("fontWeight",Z),v.value.canvas.renderAll()):(DATETIME_DEFAULT_CONFIG.fontStyle=fe,DATETIME_DEFAULT_CONFIG.fontWeight=Z)}}),watch(()=>S.date.textAlign,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("textAlign",ve),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.textAlign=ve}}),watch(()=>S.date.backgroundColor,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("backgroundColor",ve),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.backgroundColor=ve}}),watch(()=>S.date.opacity,ve=>{if(v.value){const J=v.value.canvas.getActiveObject();J&&J.type==="f-text"&&!J.editable?(J.set("opacity",parseInt(ve)/100),v.value.canvas.renderAll()):DATETIME_DEFAULT_CONFIG.opacity=parseInt(ve)/100}}),(ve,J)=>{const fe=__unplugin_components_0$A,Z=_sfc_main$4C,j=__unplugin_components_2$g,X=__unplugin_components_3$g,H=__unplugin_components_0$B,U=__unplugin_components_6$a,te=__unplugin_components_4$f,Q=__unplugin_components_7$8,re=__unplugin_components_9$5,Pe=__unplugin_components_14$3;return openBlock(),createElementBlock("div",_hoisted_1$4a,[createBaseVNode("div",_hoisted_2$3Y,[createBaseVNode("div",_hoisted_3$3z,[createBaseVNode("div",_hoisted_4$1n,toDisplayString(unref(o)("panels.customStamp.title")),1),createBaseVNode("div",_hoisted_5$S,[createBaseVNode("div",_hoisted_6$F,[createBaseVNode("div",_hoisted_7$v,toDisplayString(unref(o)("panels.customStamp.preview")),1),createBaseVNode("div",_hoisted_8$q,[createBaseVNode("div",_hoisted_9$o,[createVNode(Z,{onClick:J[0]||(J[0]=be=>_e("text")),class:normalizeClass({active:d.value==="text"}),title:unref(o)("panels.customStamp.addText")},{default:withCtx(()=>[createVNode(fe)]),_:1},8,["class","title"]),createVNode(Z,{onClick:J[1]||(J[1]=be=>_e("shape")),class:normalizeClass({active:d.value==="shape"}),title:unref(o)("panels.customStamp.addShape")},{default:withCtx(()=>[createVNode(j)]),_:1},8,["class","title"]),createVNode(Z,{onClick:J[2]||(J[2]=be=>_e("date")),class:normalizeClass({active:d.value==="date"}),title:unref(o)("panels.customStamp.addDateTime")},{default:withCtx(()=>[createVNode(X)]),_:1},8,["class","title"])]),createBaseVNode("div",_hoisted_10$o,[createBaseVNode("div",_hoisted_11$k,[g.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_12$j,toDisplayString(unref(o)("panels.customStamp.createHere")),1)),createBaseVNode("div",_hoisted_13$j,[createBaseVNode("canvas",{ref_key:"canvasElement",ref:r,width:"300",height:"300"},null,512)],512)])])])]),createBaseVNode("div",_hoisted_14$k,[createBaseVNode("div",_hoisted_15$j,toDisplayString(unref(o)("panels.customStamp.properties")),1),d.value==="text"?(openBlock(),createElementBlock("div",_hoisted_16$j,[createBaseVNode("div",_hoisted_17$h,[createBaseVNode("div",_hoisted_18$h,toDisplayString(unref(o)("panels.customStamp.fontFamily")),1),createVNode(unref(NSelect),{value:S.text.fontFamily,"onUpdate:value":J[3]||(J[3]=be=>S.text.fontFamily=be),options:E,to:".text-properties",class:"font-family property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_19$g,[createBaseVNode("div",_hoisted_20$g,toDisplayString(unref(o)("panels.customStamp.fontColor")),1),createBaseVNode("div",_hoisted_21$g,[createBaseVNode("div",_hoisted_22$g,[createBaseVNode("div",_hoisted_23$e,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:S.text.fill})},null,4)]),createVNode(unref(NColorPicker),{to:".font-color",onComplete:J[4]||(J[4]=be=>D(be,"fill")),"onUpdate:value":J[5]||(J[5]=be=>N(be,"fill")),value:S.text.fill,"show-alpha":!1},{label:withCtx(()=>[_hoisted_24$e]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_25$e,[createBaseVNode("div",_hoisted_26$d,toDisplayString(unref(o)("panels.customStamp.fontStyle")),1),createVNode(unref(NSelect),{value:S.text.fontStyle,"onUpdate:value":J[6]||(J[6]=be=>S.text.fontStyle=be),options:T.value,to:".font-weight",class:"font-weight property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"])]),createBaseVNode("div",_hoisted_27$c,[createBaseVNode("div",_hoisted_28$b,toDisplayString(unref(o)("panels.customStamp.fontSize")),1),createVNode(unref(NSelect),{value:S.text.fontSize,"onUpdate:value":J[7]||(J[7]=be=>S.text.fontSize=be),options:O,to:".font-size",class:"font-size property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_29$a,[createBaseVNode("div",_hoisted_30$a,toDisplayString(unref(o)("panels.customStamp.alignment")),1),createBaseVNode("div",_hoisted_31$8,[createBaseVNode("div",_hoisted_32$7,[createBaseVNode("div",{class:normalizeClass({active:S.text.textAlign==="left"}),onClick:J[8]||(J[8]=be=>I("left"))},[createBaseVNode("span",_hoisted_33$6,[createVNode(U)])],2),createBaseVNode("div",{class:normalizeClass({active:S.text.textAlign==="center"}),onClick:J[9]||(J[9]=be=>I("center"))},[createBaseVNode("span",_hoisted_34$6,[createVNode(te)])],2),createBaseVNode("div",{class:normalizeClass({active:S.text.textAlign==="right"}),onClick:J[10]||(J[10]=be=>I("right"))},[createBaseVNode("span",null,[createVNode(Q)])],2)])])]),createBaseVNode("div",_hoisted_35$6,[createBaseVNode("div",_hoisted_36$5,toDisplayString(unref(o)("panels.customStamp.fillColor")),1),createBaseVNode("div",_hoisted_37$4,[createBaseVNode("span",{class:normalizeClass(["no-color",{active:S.text.backgroundColor===""}]),onClick:J[11]||(J[11]=be=>S.text.backgroundColor="")},[createVNode(__unplugin_components_0$z)],2),createBaseVNode("div",_hoisted_38$4,[createBaseVNode("div",{class:normalizeClass(["preview-container",{active:S.text.backgroundColor===s.value}])},[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:s.value})},null,4)],2),createVNode(unref(NColorPicker),{to:".fill-color",onComplete:J[12]||(J[12]=be=>D(be,"backgroundColor")),"onUpdate:value":J[13]||(J[13]=be=>N(be,"backgroundColor")),value:s.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_39$4]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_40$4,[createBaseVNode("div",_hoisted_41$4,toDisplayString(unref(o)("panels.customStamp.opacity")),1),createVNode(unref(NSelect),{value:S.text.opacity,"onUpdate:value":J[14]||(J[14]=be=>S.text.opacity=be),options:q,to:".text-properties",class:"opacity property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])])])):createCommentVNode("",!0),d.value==="shape"?(openBlock(),createElementBlock("div",_hoisted_42$3,[createBaseVNode("div",_hoisted_43$3,[createBaseVNode("div",_hoisted_44$3,toDisplayString(unref(o)("panels.customStamp.shape")),1),createBaseVNode("div",_hoisted_45$3,[createVNode(Z,{onClick:J[15]||(J[15]=be=>ne("rect")),class:normalizeClass({active:S.shape.tool==="rect"})},{default:withCtx(()=>[createVNode(re)]),_:1},8,["class"]),createVNode(Z,{onClick:J[16]||(J[16]=be=>ne("line")),class:normalizeClass({active:S.shape.tool==="line"})},{default:withCtx(()=>[createVNode(Pe)]),_:1},8,["class"])])]),createBaseVNode("div",_hoisted_46$3,[createBaseVNode("div",_hoisted_47$3,toDisplayString(unref(o)("panels.customStamp.borderColor")),1),createBaseVNode("div",_hoisted_48$3,[createBaseVNode("div",_hoisted_49$3,[createBaseVNode("div",_hoisted_50$3,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:S.shape.stroke})},null,4)]),createVNode(unref(NColorPicker),{to:".shape-properties",onComplete:J[17]||(J[17]=be=>D(be,"stroke")),"onUpdate:value":J[18]||(J[18]=be=>N(be,"stroke")),value:S.shape.stroke,"show-alpha":!1},{label:withCtx(()=>[_hoisted_51$3]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_52$3,[createBaseVNode("div",_hoisted_53$2,toDisplayString(unref(o)("panels.customStamp.borderWidth")),1),createVNode(unref(NSelect),{value:S.shape.strokeWidth,"onUpdate:value":J[19]||(J[19]=be=>S.shape.strokeWidth=be),options:F,to:".shape-properties",class:"border-width property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),S.shape.tool==="rect"?(openBlock(),createElementBlock("div",_hoisted_54$2,[createBaseVNode("div",_hoisted_55$2,toDisplayString(unref(o)("panels.customStamp.fillColor")),1),createBaseVNode("div",_hoisted_56$2,[createBaseVNode("span",{class:normalizeClass(["no-color",{active:S.shape.fill===""}]),onClick:J[20]||(J[20]=be=>S.shape.fill="")},[createVNode(__unplugin_components_0$z)],2),createBaseVNode("div",_hoisted_57$2,[createBaseVNode("div",{class:normalizeClass(["preview-container",{active:S.shape.fill===w.value}])},[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:w.value})},null,4)],2),createVNode(unref(NColorPicker),{to:".shape-properties",onComplete:J[21]||(J[21]=be=>D(be,"fill")),"onUpdate:value":J[22]||(J[22]=be=>N(be,"fill")),value:w.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_58$3]),_:1},8,["value"])])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_59$3,[createBaseVNode("div",_hoisted_60$3,toDisplayString(unref(o)("panels.customStamp.opacity")),1),createVNode(unref(NSelect),{value:S.shape.opacity,"onUpdate:value":J[23]||(J[23]=be=>S.shape.opacity=be),options:q,to:".shape-properties",class:"fill-opacity property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])])])):createCommentVNode("",!0),d.value==="date"?(openBlock(),createElementBlock("div",_hoisted_61$3,[createBaseVNode("div",_hoisted_62$3,[createBaseVNode("div",_hoisted_63$3,toDisplayString(unref(o)("panels.customStamp.dateTime")),1),createVNode(unref(NSelect),{"consistent-menu-width":!1,value:S.date.format,"onUpdate:value":J[24]||(J[24]=be=>S.date.format=be),options:Y,to:".date-properties",class:"text-family property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_64$2,[createBaseVNode("div",_hoisted_65$2,toDisplayString(unref(o)("panels.customStamp.fontFamily")),1),createVNode(unref(NSelect),{value:S.date.fontFamily,"onUpdate:value":J[25]||(J[25]=be=>S.date.fontFamily=be),options:E,to:".date-properties",class:"text-family property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_66$2,[createBaseVNode("div",_hoisted_67$1,toDisplayString(unref(o)("panels.customStamp.fontColor")),1),createBaseVNode("div",_hoisted_68$1,[createBaseVNode("div",_hoisted_69$1,[createBaseVNode("div",_hoisted_70$1,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:S.date.fill})},null,4)]),createVNode(unref(NColorPicker),{to:".date-properties",onComplete:J[26]||(J[26]=be=>D(be,"fill")),"onUpdate:value":J[27]||(J[27]=be=>N(be,"fill")),value:S.date.fill,"show-alpha":!1},{label:withCtx(()=>[_hoisted_71$1]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_72$1,[createBaseVNode("div",_hoisted_73$1,toDisplayString(unref(o)("panels.customStamp.fontStyle")),1),createVNode(unref(NSelect),{value:S.date.fontStyle,"onUpdate:value":J[28]||(J[28]=be=>S.date.fontStyle=be),options:T.value,to:".date-properties",class:"text-family property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"])]),createBaseVNode("div",_hoisted_74$1,[createBaseVNode("div",_hoisted_75$1,toDisplayString(unref(o)("panels.customStamp.fontSize")),1),createVNode(unref(NSelect),{value:S.date.fontSize,"onUpdate:value":J[29]||(J[29]=be=>S.date.fontSize=be),options:O,to:".date-properties",class:"font-size property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_76$1,[createBaseVNode("div",_hoisted_77$1,toDisplayString(unref(o)("panels.customStamp.alignment")),1),createBaseVNode("div",_hoisted_78$1,[createBaseVNode("div",_hoisted_79$1,[createBaseVNode("div",{class:normalizeClass({active:S.date.textAlign==="left"}),onClick:J[30]||(J[30]=be=>I("left"))},[createBaseVNode("span",_hoisted_80$1,[createVNode(U)])],2),createBaseVNode("div",{class:normalizeClass({active:S.date.textAlign==="center"}),onClick:J[31]||(J[31]=be=>I("center"))},[createBaseVNode("span",_hoisted_81$1,[createVNode(te)])],2),createBaseVNode("div",{class:normalizeClass({active:S.date.textAlign==="right"}),onClick:J[32]||(J[32]=be=>I("right"))},[createBaseVNode("span",null,[createVNode(Q)])],2)])])]),createBaseVNode("div",_hoisted_82$1,[createBaseVNode("div",_hoisted_83$1,toDisplayString(unref(o)("panels.customStamp.fillColor")),1),createBaseVNode("div",_hoisted_84$1,[createBaseVNode("span",{class:normalizeClass(["no-color",{active:S.date.backgroundColor===""}]),onClick:J[33]||(J[33]=be=>S.date.backgroundColor="")},[createVNode(__unplugin_components_0$z)],2),createBaseVNode("div",_hoisted_85,[createBaseVNode("div",{class:normalizeClass(["preview-container",{active:S.date.backgroundColor===m.value}])},[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:m.value})},null,4)],2),createVNode(unref(NColorPicker),{to:".date-properties",onComplete:J[34]||(J[34]=be=>D(be,"backgroundColor")),"onUpdate:value":J[35]||(J[35]=be=>N(be,"backgroundColor")),value:m.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_86]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_87,[createBaseVNode("div",_hoisted_88,toDisplayString(unref(o)("panels.customStamp.opacity")),1),createVNode(unref(NSelect),{value:S.date.opacity,"onUpdate:value":J[36]||(J[36]=be=>S.date.opacity=be),options:q,to:".date-properties",class:"opacity property-container"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value"])])])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_89,[createBaseVNode("span",{onClick:k},toDisplayString(unref(o)("common.actions.clear")),1),createBaseVNode("div",_hoisted_90,[createBaseVNode("span",{class:"cancel-container",onClick:P},toDisplayString(unref(o)("common.actions.cancel")),1),createBaseVNode("span",{class:normalizeClass({disabled:g.value===0}),onClick:f},toDisplayString(unref(o)("common.actions.ok")),3)])])])])])}}},_sfc_main$4y={},_hoisted_1$49={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3X=createBaseVNode("path",{d:"M13 1L1 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$3y=createBaseVNode("path",{d:"M1 1L13 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_4$1m=[_hoisted_2$3X,_hoisted_3$3y];function _sfc_render$2T(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$49,_hoisted_4$1m)}const __unplugin_components_14$2=_export_sfc(_sfc_main$4y,[["render",_sfc_render$2T]]),_sfc_main$4x={},_hoisted_1$48={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3W=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.6466 13.2531L13.0001 13.6066L13.7072 12.8995L13.3537 12.546L8.7072 7.8995L13.2532 3.35352L13.6067 2.99997L12.8996 2.29286L12.5461 2.64642L8.00009 7.19239L3.45418 2.64648L3.10063 2.29292L2.39352 3.00003L2.74708 3.35358L7.29299 7.8995L2.64657 12.5459L2.29302 12.8995L3.00013 13.6066L3.35368 13.253L8.0001 8.6066L12.6466 13.2531Z",fill:"currentColor"},null,-1),_hoisted_3$3x=[_hoisted_2$3W];function _sfc_render$2S(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$48,_hoisted_3$3x)}const __unplugin_components_0$y=_export_sfc(_sfc_main$4x,[["render",_sfc_render$2S]]),_sfc_main$4w={},_hoisted_1$47={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},_hoisted_2$3V=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.7331 15.7936C15.026 16.0864 15.5009 16.0864 15.7937 15.7936C16.0866 15.5007 16.0866 15.0258 15.7937 14.7329L11.3743 10.3135L15.7938 5.89408C16.0867 5.60119 16.0867 5.12631 15.7938 4.83342C15.5009 4.54052 15.026 4.54053 14.7331 4.83342L10.3137 9.25284L5.89425 4.8334C5.60136 4.54051 5.12649 4.54051 4.83359 4.8334C4.5407 5.12629 4.5407 5.60117 4.83359 5.89406L9.25303 10.3135L4.83361 14.7329C4.54072 15.0258 4.54072 15.5007 4.83361 15.7936C5.1265 16.0865 5.60138 16.0865 5.89427 15.7936L10.3137 11.3742L14.7331 15.7936Z",fill:"currentColor"},null,-1),_hoisted_3$3w=[_hoisted_2$3V];function _sfc_render$2R(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$47,_hoisted_3$3w)}const __unplugin_components_1$h=_export_sfc(_sfc_main$4w,[["render",_sfc_render$2R]]),Dialog_vue_vue_type_style_index_0_lang="",_hoisted_1$46={key:0,class:"dialog"},_hoisted_2$3U={class:"dialog-wrapper"},_hoisted_3$3v={class:"dialog-container"},_hoisted_4$1l={key:0,class:"close"},_sfc_main$4v={__name:"Dialog",props:["show","dialogName","close"],setup(e){const{show:n,dialogName:o,close:r}=e,u=useViewerStore(),s=()=>{u.closeElement(o)},w=m=>{typeof r=="function"?r(m):s()};return(m,v)=>{const g=__unplugin_components_1$h,d=__unplugin_components_0$y,f=__unplugin_components_14$2;return e.show?(openBlock(),createElementBlock("div",_hoisted_1$46,[createBaseVNode("div",_hoisted_2$3U,[createBaseVNode("div",_hoisted_3$3v,[e.close?(openBlock(),createElementBlock("div",_hoisted_4$1l,[e.close==="A"?(openBlock(),createBlock(g,{key:0,onClick:w})):createCommentVNode("",!0),e.close==="B"?(openBlock(),createBlock(d,{key:1,onClick:w})):(openBlock(),createBlock(f,{key:2,onClick:w}))])):createCommentVNode("",!0),createBaseVNode("header",null,[renderSlot(m.$slots,"header")]),createBaseVNode("main",null,[renderSlot(m.$slots,"default")]),createBaseVNode("footer",null,[renderSlot(m.$slots,"footer")])])])])):createCommentVNode("",!0)}}},_sfc_main$4u={},_hoisted_1$45={width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3T=createBaseVNode("path",{d:"M20 36.6667C29.2047 36.6667 36.6667 29.2047 36.6667 20C36.6667 10.7952 29.2047 3.33333 20 3.33333C10.7952 3.33333 3.33333 10.7952 3.33333 20C3.33333 29.2047 10.7952 36.6667 20 36.6667Z",fill:"#FFC061"},null,-1),_hoisted_3$3u=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M21.6667 12.5C21.6667 11.5795 20.9205 10.8333 20 10.8333C19.0795 10.8333 18.3333 11.5795 18.3333 12.5L18.3333 22.5C18.3333 23.4205 19.0795 24.1667 20 24.1667C20.9205 24.1667 21.6667 23.4205 21.6667 22.5L21.6667 12.5ZM20.1667 29.3333C21.0871 29.3333 21.8333 28.5871 21.8333 27.6667C21.8333 26.7462 21.0871 26 20.1667 26C19.2462 26 18.5 26.7462 18.5 27.6667C18.5 28.5871 19.2462 29.3333 20.1667 29.3333Z",fill:"white"},null,-1),_hoisted_4$1k=[_hoisted_2$3T,_hoisted_3$3u];function _sfc_render$2Q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$45,_hoisted_4$1k)}const __unplugin_components_2$f=_export_sfc(_sfc_main$4u,[["render",_sfc_render$2Q]]),_sfc_main$4t={},_hoisted_1$44={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3S=createBaseVNode("rect",{width:"14",height:"14",rx:"1",fill:"#2D77FA"},null,-1),_hoisted_3$3t=createBaseVNode("path",{d:"M10.2784 5.27848L5.84653 9.71032L4.20261 8.06642",stroke:"white","stroke-width":"1.5","stroke-linecap":"square"},null,-1),_hoisted_4$1j=[_hoisted_2$3S,_hoisted_3$3t];function _sfc_render$2P(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$44,_hoisted_4$1j)}const __unplugin_components_1$g=_export_sfc(_sfc_main$4t,[["render",_sfc_render$2P]]),_sfc_main$4s={},_hoisted_1$43={width:"8",height:"16",viewBox:"0 0 8 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3R=createBaseVNode("g",{id:".base / Sliders"},[createBaseVNode("rect",{id:"Rectangle",width:"8",height:"16",rx:"4",fill:"#1460F3"})],-1),_hoisted_3$3s=[_hoisted_2$3R];function _sfc_render$2O(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$43,_hoisted_3$3s)}const __unplugin_components_1$f=_export_sfc(_sfc_main$4s,[["render",_sfc_render$2O]]),_sfc_main$4r={},_hoisted_1$42={width:"112",height:"112",viewBox:"0 0 112 112",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3Q=createStaticVNode('<rect x="20" y="30" width="58" height="44" rx="3.168" fill="#4982E6" fill-opacity="0.15"></rect><rect x="20.5" y="30.5" width="57" height="43" rx="2.668" stroke="#4982E6" stroke-dasharray="4 4"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M30 41.168C30 39.4184 31.4184 38 33.168 38H84.832C86.5816 38 88 39.4184 88 41.168V78.832C88 80.5816 86.5816 82 84.832 82H33.168C31.4184 82 30 80.5816 30 78.832L30 41.168Z" fill="#FCFDFF"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M77 54C79.7614 54 82 51.7614 82 49C82 46.2386 79.7614 44 77 44C74.2386 44 72 46.2386 72 49C72 51.7614 74.2386 54 77 54ZM36 76H79.1397L61.8379 61L54.3148 68.1755L38.7391 56L36 58.8801V76Z" fill="#E2E3E6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M92.2373 71.6307L81.4619 68.3981L84.6945 79.1734C84.902 79.865 85.8082 80.0262 86.2414 79.4485L87.8623 77.2874L89.5512 78.9764C89.8949 79.32 90.4521 79.32 90.7957 78.9764L92.0402 77.7319C92.3839 77.3882 92.3839 76.831 92.0402 76.4874L90.3513 74.7984L92.5124 73.1775C93.09 72.7443 92.9289 71.8381 92.2373 71.6307Z" fill="#273C62" fill-opacity="0.6"></path>',5),_hoisted_7$u=[_hoisted_2$3Q];function _sfc_render$2N(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$42,_hoisted_7$u)}const __unplugin_components_3$f=_export_sfc(_sfc_main$4r,[["render",_sfc_render$2N]]),_sfc_main$4q={},_hoisted_1$41={width:"112",height:"112",viewBox:"0 0 112 112",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3P=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M27.2002 22.4002C27.2002 20.6329 28.6329 19.2002 30.4002 19.2002H68.8002L81.6002 32.0002V88.0002C81.6002 89.7675 80.1675 91.2002 78.4002 91.2002H30.4002C28.6329 91.2002 27.2002 89.7675 27.2002 88.0002V22.4002Z",fill:"#54575C"},null,-1),_hoisted_3$3r=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M68.7998 19.2002L81.5998 32.0002H71.9998C70.2325 32.0002 68.7998 30.5675 68.7998 28.8002V19.2002Z",fill:"#606773"},null,-1),_hoisted_4$1i=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M34.4002 36.7998C33.9584 36.7998 33.6002 37.158 33.6002 37.5998V41.5998C33.6002 42.0416 33.9584 42.3998 34.4002 42.3998H74.4002C74.842 42.3998 75.2002 42.0416 75.2002 41.5998V37.5998C75.2002 37.158 74.842 36.7998 74.4002 36.7998H34.4002ZM34.4001 47.2C33.9583 47.2 33.6001 47.5582 33.6001 48V52C33.6001 52.4418 33.9583 52.8 34.4001 52.8H74.4001C74.8419 52.8 75.2001 52.4418 75.2001 52V48C75.2001 47.5582 74.8419 47.2 74.4001 47.2H34.4001ZM33.6001 58.4C33.6001 57.9582 33.9583 57.6 34.4001 57.6H74.4001C74.8419 57.6 75.2001 57.9582 75.2001 58.4V62.4C75.2001 62.8418 74.8419 63.2 74.4001 63.2H34.4001C33.9583 63.2 33.6001 62.8418 33.6001 62.4V58.4ZM34.4001 68C33.9583 68 33.6001 68.3582 33.6001 68.8V72.8C33.6001 73.2418 33.9583 73.6 34.4001 73.6H55.2001C55.6419 73.6 56.0001 73.2418 56.0001 72.8V68.8C56.0001 68.3582 55.6419 68 55.2001 68H34.4001Z",fill:"#606773"},null,-1),_hoisted_5$R=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M77.6 67.2002C74.2863 67.2002 71.6 69.8865 71.6 73.2002C71.6 75.4018 72.7857 77.3264 74.5534 78.3703C74.7147 78.8387 74.8174 79.3262 74.8174 79.8082C74.8174 82.0522 72.5913 82.263 72.5913 82.263L67.2 82.2631C65.4327 82.2631 64 83.6958 64 85.4631V89.6002H91.2V85.4631C91.2 83.6958 89.7673 82.2631 88 82.2631L82.6087 82.263C82.6087 82.263 80.3826 82.0522 80.3826 79.8082C80.3826 79.3262 80.4853 78.8387 80.6466 78.3703C82.4143 77.3264 83.6 75.4018 83.6 73.2002C83.6 69.8865 80.9137 67.2002 77.6 67.2002ZM64 93.6002V91.2002H91.2V93.6002C91.2 94.042 90.8418 94.4002 90.4 94.4002H64.8C64.3582 94.4002 64 94.042 64 93.6002Z",fill:"#6499FF"},null,-1),_hoisted_6$E=[_hoisted_2$3P,_hoisted_3$3r,_hoisted_4$1i,_hoisted_5$R];function _sfc_render$2M(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$41,_hoisted_6$E)}const __unplugin_components_2$e=_export_sfc(_sfc_main$4q,[["render",_sfc_render$2M]]),type=["ink","line","square","arc","polygon","polyline","circle","freetext","text","highlight","underline","squiggly","strikeout","image","stamp","polygon","rectangle","polyline"],useDocumentStore=defineStore({id:"document",state:()=>({totalPages:0,loadingProgress:0,annotationsCount:0,info:null,optionUrl:null,markupTool:"highlight",selected:{data:null},highlight:{color:"#FFEC66"},underline:{color:"#FF0000"},squiggly:{color:"#FF0000"},strikeout:{color:"#FF0000"},shapeTool:"square",square:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},arc:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},polygon:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},polyline:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},circle:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},arrow:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},line:{color:"#FF0000",opacity:"0.8",stroke:"1pt"},ink:{color:"#FF0000",opacity:"0.8",stroke:"2pt"},freetext:{color:"#000000"},text:{color:"#FF0000"},activeTool:"",annotations:null,textfield:{color:"#DDE9FF"},checkbox:{color:"#DDE9FF",borderColor:"#43474D"},radiobutton:{color:"#DDE9FF",borderColor:"#43474D"},listbox:{color:"#DDE9FF",borderColor:"#43474D"},combobox:{color:"#DDE9FF",borderColor:"#43474D"},pushbutton:{color:"#DDE9FF",borderColor:"#43474D"},link:{color:"#DDE9FF"},signatureFields:{color:"#DDE9FF"},redaction:{color:"#000000"},remove:{color:"#FF0000"},propertyPanel:{fieldName:"",isHidden:"0",title:"",fillColor:"#DDE9FF",color:"#000000",fontName:"Helvetica",fontStyle:"normal",fontWeight:"normal",fontSize:"14",textAlignment:"0",contents:"",isMultiLine:!1,project:"",projectList:"",checkStyle:0,isChecked:"",actionType:"0",text:"OK",url:"",destPage:"",items:[],item:null,deleteItemIndex:null,moveOption:null,indicator:!1,indicatorText:"Fill"},compareFiles:{oldFile:null,oldFilePassword:"",newFile:null,newFilePassword:""},compareSettings:{oldFileColor:"#FBBDBF",newFileColor:"#93B9FD"},currentPdfData:null,fileHasPwd:!1,pwd:null,compareResult:null,outlines:[],activeOutlineId:null,searchResults:[],activeSearchResult:null,docEditorOperationList:[],signatures:[],selectedSignature:null,trustedCertificateLists:[],author:"ComPDFKit",annotator:"Guest",highlightLink:!0,highlightForm:!0,redactionPrompted:!1,autoJumpNextSign:!1,disableDigitalSignature:!1,disableElectronicSignature:!1,layers:[],selectedLayer:null,firstEnterRedactionTool:"",measure:{scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1}}),getters:{getTotalPages(){return this.totalPages},getLoadingProgress(){return this.loadingProgress},getAnnotationsCount(){return this.annotationsCount+" annotation"+(this.annotationsCount>1?"s":"")},getMeasure(){return this.measure},getPrecision(){return this.measure.precision===1?.1:.01},getInfo(){return this.info},getOptionUrl(){return this.optionUrl},getMarkupToolState(){return this.markupTool},getLineType(){return this.line.type},getActiveToolColor(){if(this.activeTool)return this[this.activeTool].color},getActiveTool(){return this.activeTool},getShapeToolState(){return this.shapeTool},getAllAnnotations(){const e={annotations:{},annotationsCount:0},n=this.annotations;if(!n)return e;const o=n.length;for(let r=0;r<o;r++){const u=n[r];if(type.includes(u.type)&&!u.inReplyTo){const s=u.PageNumber-1;e.annotations[s]||(e.annotations[s]={pageAnnotationsCount:0,annotations:[]}),e.annotations[s].pageAnnotationsCount++,e.annotationsCount++,e.annotations[s].annotations.push(u)}}return e},getAnnotations(e){return this.annotations&&this.annotations[e]},getCompareFile(e){return n=>e.compareFiles[n]},getCompareFiles(){return this.compareFiles},getCompareSetting(e){return n=>e.compareSettings[n]},getCurrentPdfData(){return this.currentPdfData},getFilehasPwd(){return this.fileHasPwd},getPassword(){return this.pwd},getCompareResult(){return this.compareResult},getOutlines(){return this.outlines},getActiveOutlineId(){return this.activeOutlineId},getSearchResults(){return this.searchResults},getActiveSearchResult(){return this.activeSearchResult},getDocEditorOperationList(){return this.docEditorOperationList},getSignatures(){const e=this.annotations;return e?e.filter(o=>o.type==="signatureFields"&&o.annotation.isSignedDigitally):[]},getSelectedSignature(){return this.selectedSignature},getPkcs12(){return this.pkcs12},getTrustedCertificateLists(){return this.trustedCertificateLists},getAuthor(){return this.author},getAnnotator(){return this.annotator},getHighlightLink(){return this.highlightLink},getHighlightForm(){return this.highlightForm},getRedactionPrompted(){return this.redactionPrompted},getAutoJumpNextSign(){return this.autoJumpNextSign},getDisableDigitalSignature(){return this.disableDigitalSignature},getDisableElectronicSignature(){return this.disableElectronicSignature},getLayers(){return this.layers},getSelectedLayer(){return this.selectedLayer},getFirstEnterRedactionTool(){return this.firstEnterRedactionTool},getSelectedAnnotation(){return this.selectedAnnotation},getSelect(){return this.selected}},actions:{resetSetting(){this.totalPages=0,this.loadingProgress=0,this.annotationsCount=0,this.annotations=null,this.outlines=[],this.activeOutlineId=null,this.searchResults=[],this.docEditorOperationList=[],this.signatures=[],this.layers=[],this.selectedAnnotation=null},setTotalPages(e){this.totalPages=e},setLoadingProgress(e){this.loadingProgress=e},setAnnotationsCount(e){this.annotationsCount=e},setOptionUrl(e){this.optionUrl=e},setToken(e){this.info=e},setDistance(e){this.measure.distance=Math.round(e*10)/10},setMarkupToolState(e){this.markupTool=e},setMarkupToolColor(e){this[this.markupTool]=e},setShapeToolState(e){this.shapeTool=e},setLineType(e){this.line.type=e},setLineColor(e){this.line.color=e},setActiveTool(e){this.activeTool=e},setActiveToolColor(e){this.activeTool&&(this[this.activeTool].color=e,core.setTool({tool:this.activeTool,color:e}))},setToolState(e){var n;this.activeTool===e||!e?(this.activeTool="",core.setTool({tool:"",color:""})):(this.activeTool=e,core.setTool({tool:e,color:((n=this[e])==null?void 0:n.color)||""}),(this.activeTool==="textfield"||this.activeTool==="checkbox"||this.activeTool==="radiobutton"||this.activeTool==="pushbutton")&&core.setInitProperty())},initAnnotations(e){this.annotations=null,this.annotations=shallowReactive(e)},setAnnotations(e,n){const o=this.annotations;if(n==="add")o[e[page]]||(o[page]=[]),o[page].push(e);else{const r=o[e[page]],u=r.findIndex(s=>s.index===e.index);n==="delete"?r[u].isDelete=!0:r[u]={...r[u],...e}}},setPropertyPanel(e){let n={};for(const o in e)for(const r in this.propertyPanel)o===r&&(n[r]=e[o]);core.setPropertyPanel(n)},setProperty(e,n){this.propertyPanel[e]=n},setCompareFiles(e,n){this.compareFiles[e]=n},initCompareFiles(){this.compareFiles.oldFile=null,this.compareFiles.oldFilePassword="",this.compareFiles.newFile=null,this.compareFiles.newFilePassword=""},setCompareSetting(e,n){this.compareSettings[e]=n},initCompareSetting(){this.compareSettings={oldFileColor:"#FBBDBF",newFileColor:"#93B9FD"}},setCurrentPdfData(e,n){e&&n?(this.currentPdfData||(this.currentPdfData={}),this.currentPdfData.pdf=e,this.currentPdfData.options=n):e?this.currentPdfData.pdf=e:this.currentPdfData=null},setFileHasPwd(e){this.fileHasPwd=e},setPassword(e){this.pwd=e},setCompareResult(e){this.compareResult=e},setOutline(e){this.outlines=e},setActiveOutlineId(e){this.activeOutlineId=e},setSearchResults(e){this.searchResults=e},setActiveSearchResult(e){this.activeSearchResult=e},setDocEditorOperationList(e){e==="reset"?this.docEditorOperationList=[]:e&&this.docEditorOperationList.push(e)},setSelectedSignature(e){this.selectedSignature=e},setPkcs12(e){this.pkcs12=e},setTrustedCertificateLists(e){this.trustedCertificateLists.push(e)},setAuthor(e){this.author=e},setAnnotator(e){this.annotator=e,core.setAnnotator(e)},setHighlightLink(e){this.highlightLink=e,core.setHighlightLink(e)},setHighlightForm(e){this.highlightForm=e,core.setHighlightForm(e)},dispatch(e){return this[e]},getState(e){return e?this.$state[e]:this.$state},setRedactionPrompted(e){this.redactionPrompted=e},setAutoJumpNextSign(e){this.autoJumpNextSign=e,core.setAutoJumpNextSign(e)},setDisableDigitalSignature(e){this.disableDigitalSignature=e},setDisableElectronicSignature(e){this.disableElectronicSignature=e},setLayers(e){this.layers=e},setSelectedLayer(e){this.selectedLayer=e},setFirstEnterRedactionTool(e){this.firstEnterRedactionTool=e},setSelectedAnnotation(e){this.selectedAnnotation=e,this.selected.data=e}}}),MessageError=""+new URL("icon-message-error.c91684dd.svg",import.meta.url).href,uploadFile=e=>new Promise((n,o)=>{const r=document.createElement("input");r.type="file",r.style.display="none",r.accept=e,r.onchange=()=>{r.files&&(n(r.files[0]),r.remove())},document.body.appendChild(r),r.click()}),hslToRgb=(e,n,o)=>{let r,u,s;if(n===0)r=u=s=o;else{const w=function(d,f,y){return y<0&&(y+=1),y>1&&(y-=1),y<.16666666666666666?d+(f-d)*6*y:y<.5?f:y<.6666666666666666?d+(f-d)*(.6666666666666666-y)*6:d},m=o<.5?o*(1+n):o+n-o*n,v=2*o-m;r=Math.round(w(v,m,e+1/3)*255),u=Math.round(w(v,m,e)*255),s=Math.round(w(v,m,e-1/3)*255)}return{R:r,G:u,B:s}},convertColor=e=>{if(!e)return null;if(e.startsWith("#")){const n=e.slice(1).match(/.{2}/g);if(n)return{R:parseInt(n[0],16),G:parseInt(n[1],16),B:parseInt(n[2],16)}}if(e.startsWith("rgb")){const n=e.match(/\d+/g);if(n&&n.length===3)return{R:parseInt(n[0]),G:parseInt(n[1]),B:parseInt(n[2])}}if(e.startsWith("hsl")){const n=e.match(/(\d+),\s*(\d+%),\s*(\d+%)/);if(n){const[o,r,u]=[parseInt(n[1]),parseInt(n[2])/100,parseInt(n[3])/100],{R:s,G:w,B:m}=hslToRgb(o/360,r,u);return{R:s,G:w,B:m}}}},areColorsSimilar=(e,n,o=10)=>{const r=convertColor(e),u=convertColor(n);if(!r||!u)return!1;const s=Math.abs(r.R-u.R),w=Math.abs(r.G-u.G),m=Math.abs(r.B-u.B);return s<=o&&w<=o&&m<=o},_sfc_main$4p={},_hoisted_1$40={width:"112",height:"112",viewBox:"0 0 112 112",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3O=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M27.2 22.4002C27.2 20.6329 28.6327 19.2002 30.4 19.2002H68.8L81.6 32.0002V88.0002C81.6 89.7675 80.1673 91.2002 78.4 91.2002H30.4C28.6327 91.2002 27.2 89.7675 27.2 88.0002V22.4002Z",fill:"#F5F6FA"},null,-1),_hoisted_3$3q=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M68.8 19.2002L81.6 32.0002H72C70.2327 32.0002 68.8 30.5675 68.8 28.8002V19.2002Z",fill:"#E2E3E6"},null,-1),_hoisted_4$1h=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M34.4 36.7998C33.9582 36.7998 33.6 37.158 33.6 37.5998V41.5998C33.6 42.0416 33.9582 42.3998 34.4 42.3998H74.4C74.8418 42.3998 75.2 42.0416 75.2 41.5998V37.5998C75.2 37.158 74.8418 36.7998 74.4 36.7998H34.4ZM34.4 47.2C33.9582 47.2 33.6 47.5582 33.6 48V52C33.6 52.4418 33.9582 52.8 34.4 52.8H74.4C74.8418 52.8 75.2 52.4418 75.2 52V48C75.2 47.5582 74.8418 47.2 74.4 47.2H34.4ZM33.6 58.4C33.6 57.9582 33.9582 57.6 34.4 57.6H74.4C74.8418 57.6 75.2 57.9582 75.2 58.4V62.4C75.2 62.8418 74.8418 63.2 74.4 63.2H34.4C33.9582 63.2 33.6 62.8418 33.6 62.4V58.4ZM34.4 68C33.9582 68 33.6 68.3582 33.6 68.8V72.8C33.6 73.2418 33.9582 73.6 34.4 73.6H55.2C55.6418 73.6 56 73.2418 56 72.8V68.8C56 68.3582 55.6418 68 55.2 68H34.4Z",fill:"#E2E3E6"},null,-1),_hoisted_5$Q=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M77.6 67.2002C74.2863 67.2002 71.6 69.8865 71.6 73.2002C71.6 75.4018 72.7857 77.3264 74.5534 78.3703C74.7147 78.8387 74.8174 79.3262 74.8174 79.8082C74.8174 82.0522 72.5913 82.263 72.5913 82.263L67.2 82.2631C65.4327 82.2631 64 83.6958 64 85.4631V89.6002H91.2V85.4631C91.2 83.6958 89.7673 82.2631 88 82.2631L82.6087 82.263C82.6087 82.263 80.3826 82.0522 80.3826 79.8082C80.3826 79.3262 80.4853 78.8387 80.6466 78.3703C82.4143 77.3264 83.6 75.4018 83.6 73.2002C83.6 69.8865 80.9137 67.2002 77.6 67.2002ZM64 93.6002V91.2002H91.2V93.6002C91.2 94.042 90.8418 94.4002 90.4 94.4002H64.8C64.3582 94.4002 64 94.042 64 93.6002Z",fill:"#273C62","fill-opacity":"0.6"},null,-1),_hoisted_6$D=[_hoisted_2$3O,_hoisted_3$3q,_hoisted_4$1h,_hoisted_5$Q];function _sfc_render$2L(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$40,_hoisted_6$D)}const __unplugin_components_1$e=_export_sfc(_sfc_main$4p,[["render",_sfc_render$2L]]),SignCreatePanel_vue_vue_type_style_index_0_lang="",_hoisted_1$3$={class:"signatures-popup"},_hoisted_2$3N={class:"sign-title"},_hoisted_3$3p={class:"sign-content"},_hoisted_4$1g={key:0,class:"sign-popup-header"},_hoisted_5$P={class:"signatures-popup-lists"},_hoisted_6$C={key:0,class:"signatures-popup-empty"},_hoisted_7$t={class:"no-signatures"},_hoisted_8$p={key:1,class:"signatures-popup-list-container"},_hoisted_9$n=["onClick"],_hoisted_10$n=["src"],_hoisted_11$j={class:"signatures-popup-create"},_hoisted_12$i={class:"create-sign-header"},_hoisted_13$i=["onClick"],_hoisted_14$j=["width","height"],_hoisted_15$i={class:"keyboard-paint"},_hoisted_16$i=["placeholder"],_hoisted_17$g={key:0,class:"property-container"},_hoisted_18$g={class:"width-tool"},_hoisted_19$f={key:0},_hoisted_20$f={class:"font-tool"},_hoisted_21$f={key:0},_hoisted_22$f=["value"],_hoisted_23$d={class:"color-tool"},_hoisted_24$d={key:0},_hoisted_25$d={class:"colors-container"},_hoisted_26$c=["onClick"],_hoisted_27$b={key:0,class:"color-picker"},_hoisted_28$a=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_29$9={class:"footer"},_hoisted_30$9={class:"clear-container"},_hoisted_31$7={key:0,class:"left-btns"},_hoisted_32$6={key:0},_hoisted_33$5={key:1},_hoisted_34$5={class:"buttons-container"},_hoisted_35$5={class:"right-btns"},_hoisted_36$4={key:0,class:"delete-page-popup"},_sfc_main$4o={__name:"SignCreatePanel",setup(e){const n=getCurrentInstance().appContext.app.config.globalProperties,o=useViewerStore(),r=useDocumentStore(),u=computed(()=>o.isElementOpen("signCreatePanel")),s=computed(()=>o.getActiveElementTab("signPanel")),w=computed(()=>o.getToolMode),m=computed(()=>o.getSignatureDialogTabs),v=computed(()=>o.getSignatureDialogProperties),g=computed(()=>r.getDisableDigitalSignature),d=computed(()=>r.getDisableElectronicSignature),f=computed(()=>o.getElectronicSignaturesList),y=computed(()=>o.getThemeMode),x=computed(()=>r.getActiveTool),k=computed(()=>o.getEnableSignatureTemplates),P=ref(!1),S=ref(0),E=ref(""),M=ref(""),T=ref(v.value.trackpad.lineWidth||5),D=ref(v.value[s.value].colors[0].value||"#000000"),N=ref(v.value.keyboard.fonts[0]||"Courier New"),I=ref(),O=ref(isMobile?289:578),F=ref(270),q=ref("rgb(0, 0, 0)"),Y=ref("create"),_e=ref(!0);f.value.length>=5&&(_e.value=!1);const ne=($e,Me)=>{$e.stopPropagation(),P.value=!0,S.value=Me},ve=()=>{o.removeElectronicSignature(S.value),P.value=!1};watch(()=>v.value.keyboard.fonts,($e,Me)=>{N.value=$e[0]||"Courier New"}),watch(()=>w.value,($e,Me)=>{if(!(Me==="sign"&&$e==="view")&&$e!==Me){const Ie=document.getElementById("sign-image-save");Ie&&Ie.remove()}}),watch(()=>T.value,($e,Me)=>{const Ie=/^\d+$/;$e!==""&&($e>10||$e<=0||!Ie.test($e))&&(T.value=Me),s.value==="trackpad"&&core.handleSign({flag:"update",param:{width:T.value,color:D.value}})}),watch(()=>D.value,($e,Me)=>{if(core.handleSign({flag:"update",param:{width:T.value,color:D.value}}),s.value==="keyboard"){q.value=D.value;let Ie=document.querySelector(".keyboard-paint input");Ie&&(Ie.style.color=D.value)}}),watch(()=>u.value,($e,Me)=>{$e&&(isMobile&&nextTick(()=>{const{clientWidth:Ie,clientHeight:Le}=I.value;Ie&&O.value!==Ie&&(O.value=Ie),Le&&F.value!==Le&&(F.value=Le)}),o.setActiveSignWay("keyboard"),E.value="",core.handleSign({flag:"create"}))}),watch(()=>Y.value,($e,Me)=>{$e==="create"&&isMobile&&nextTick(()=>{const{clientWidth:Ie,clientHeight:Le}=I.value;Ie&&O.value!==Ie&&(O.value=Ie),Le&&F.value!==Le&&(F.value=Le)})}),watch(()=>f.value,$e=>{$e&&$e.length>=5?_e.value=!1:_e.value||(_e.value=!0)},{deep:!0}),watch(()=>u.value,$e=>{!k.value||($e&&f.value.length>0?Y.value="list":$e&&f.value.length===0&&(Y.value="create"))}),watch(()=>s.value,($e,Me)=>{Me==="trackpad"&&core.handleSign({flag:"clear"}),E.value="",M.value=""});const J=$e=>{s.value!==$e&&(o.setActiveSignWay($e),Z(),j())},fe=$e=>{o.toggleElement("signCreatePanel"),core.handleSign({flag:"reset"}),s.value!=="trackpad"&&Z(),j(),document.body.style.overflow="",$e==="cancel"&&g.value&&d.value&&o.openElement("selectSignTypeDialog")},Z=()=>{if(s.value==="keyboard"&&(E.value=""),s.value==="image"){M.value="";let $e=document.querySelector(".image-paint"),Me=document.querySelector(".image-paint input"),Ie=document.querySelector(".image-paint a"),Le=document.querySelector(".image-paint img");$e&&(Le&&($e.removeChild(Le),Me.value=""),Ie&&(Ie.style.display="block"))}s.value==="trackpad"&&core.handleSign({flag:"clear"})},j=()=>{const $e=v.value.trackpad.lineWidth||5,Me=["trackpad","keyboard"].includes(s.value)&&v.value[s.value].colors[0].value||"#000000",Ie=v.value.keyboard.fonts[0]||"Courier New";D.value!==Me&&(D.value=Me),N.value!==Ie&&(N.value=Ie),T.value!==$e&&(T.value=$e,core.handleSign({flag:"update",param:{width:T.value,color:D.value}}))},X=$e=>{$e.preventDefault(),$e.stopPropagation();let Me=$e.dataTransfer.files[0];U(Me)},H=$e=>{let Me=$e.target.files[0];if(Me.size>1024*1024){window.$message.error(n.$t("signatures.uploadError"),{duration:5e3,icon:()=>h$1("img",{src:MessageError})}),$e.target.value="";return}$e.target.value="",U(Me)},U=$e=>{w.value==="annotation"&&(r.setToolState("image"),core.handleCreateStatus({bool:!0,fileData:$e}));const Me=new FileReader;Me.readAsDataURL($e),Me.onload=function(){M.value=Me.result;let Ie=document.querySelector(".image-paint"),Le=document.querySelector(".image-paint a");if(Ie){let le=document.createElement("img");le.setAttribute("src",M.value),le.style.maxHeight=220+"px",le.style.maxWidth=568+"px",Le.style.display="none",Ie.append(le)}if(x.value==="image"){const le=new Image;le.onload=function(){Q()},le.src=M.value}}},te=$e=>{w.value==="annotation"&&r.setToolState("image")},Q=async()=>{let $e="",Me=0,Ie=0;const Le=o.getSelectedSignatureField;if((s.value==="image"&&M.value!==""||M.value!=="")&&($e=M.value),s.value==="keyboard"&&E.value!==""){let oe=document.createElement("canvas"),ke=document.createElement("canvas"),Ce=oe.getContext("2d");Ce.font="46px "+N.value;let Ee=Ce.measureText(E.value).width;ke.width=Ee,ke.height=60,Ce=ke.getContext("2d"),Ce.font="46px "+N.value,Ce.fillStyle=D.value,Ce.fillText(E.value,0,50),Me=Ee,Ie=60,$e=ke.toDataURL()}$e&&s.value!=="trackpad"&&(core.handleSign({flag:"save",param:{imageBase64:$e,annotation:toRaw(Le)}}),f.value.length<5&&_e.value&&o.addElectronicSignature($e));let le=document.querySelector(".content");if(le&&x.value==="image"){let oe=document.getElementById("sign-image-save");oe||(oe=document.createElement("img"),oe.style.position="absolute",oe.style.zIndex=10,oe.style.pointerEvents="none",oe.style.maxHeight="220px",oe.style.maxWidth="568px",oe.style.border="2px solid blue",oe.style.cursor="crosshair",oe.id="sign-image-save"),oe.setAttribute("src",$e),oe.style.left="50%",oe.style.top="50%",oe.style.display="hidden",le.append(oe),oe.offsetWidth>0&&oe.offsetHeight>0&&(Me=oe.offsetWidth,Ie=oe.offsetHeight);let ke=Math.min(parseInt(Me/2),568/2),Ce=Math.min(parseInt(Ie/2),220/2);oe.style.left="calc(50% -"+ke+")",oe.style.top="calc(50% -"+Ce+")",oe.style.display="block",le.onmousemove=function(Ee){oe.style.left=Ee.clientX-ke+"px",oe.style.top=Ee.clientY-Ce+"px"};return}if(s.value==="trackpad"){const oe=await core.handleSign({flag:"save",param:{width:T.value,color:D.value,annotation:toRaw(Le)}});f.value.length<5&&_e.value&&o.addElectronicSignature(oe)}fe()},re=$e=>{const Me=o.getSelectedSignatureField;Me&&core.handleSign({flag:"save",param:{imageBase64:$e,annotation:toRaw(Me)}}),o.toggleElement("signCreatePanel")},Pe=$e=>{$e.target.value||(T.value=1)},be=$e=>{D.value=$e},we=$e=>{areColorsSimilar($e,D.value)||be($e)},Ae=$e=>{q.value=$e};return core.addEvent("signaturesImageChanged",$e=>{M.value=$e.imageBase64}),($e,Me)=>{const Ie=__unplugin_components_14$2,Le=__unplugin_components_2$e,le=_sfc_main$4C,oe=__unplugin_components_3$f,ke=__unplugin_components_1$f,Ce=__unplugin_components_1$g,Ee=__unplugin_components_2$f,Be=_sfc_main$4v;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:"signatures-popup-wrapper",onMousedown:Me[11]||(Me[11]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_1$3$,[createBaseVNode("div",_hoisted_2$3N,toDisplayString($e.$t("signatures.electronicSignature.title")),1),createBaseVNode("div",{onClick:Me[0]||(Me[0]=Ve=>fe("cancel")),class:"close-button"},[createVNode(Ie)]),createBaseVNode("div",_hoisted_3$3p,[k.value?(openBlock(),createElementBlock("div",_hoisted_4$1g,[createBaseVNode("div",{onClick:Me[1]||(Me[1]=Ve=>Y.value="list"),class:normalizeClass({active:Y.value==="list"})},toDisplayString($e.$t("signatures.electronicSignature.mySignatures")),3),createBaseVNode("div",{onClick:Me[2]||(Me[2]=Ve=>Y.value="create"),class:normalizeClass({active:Y.value==="create"})},toDisplayString($e.$t("signatures.electronicSignature.create")),3)])):createCommentVNode("",!0),withDirectives(createBaseVNode("div",_hoisted_5$P,[f.value.length===0?(openBlock(),createElementBlock("div",_hoisted_6$C,[createBaseVNode("div",_hoisted_7$t,[y.value==="light"?(openBlock(),createBlock(__unplugin_components_1$e,{key:0})):(openBlock(),createBlock(Le,{key:1})),createBaseVNode("div",{onClick:Me[3]||(Me[3]=Ve=>Y.value="create")},toDisplayString($e.$t("signatures.electronicSignature.empty")),1)])])):(openBlock(),createElementBlock("div",_hoisted_8$p,[(openBlock(!0),createElementBlock(Fragment,null,renderList(f.value,(Ve,Oe)=>(openBlock(),createElementBlock("div",{class:"signatures-popup-list",onClick:je=>re(Ve),key:Oe},[createBaseVNode("img",{src:Ve},null,8,_hoisted_10$n),createVNode(le,{class:"close-button",onClick:je=>ne(je,Oe)},{default:withCtx(()=>[createVNode(Ie)]),_:2},1032,["onClick"])],8,_hoisted_9$n))),128))]))],512),[[vShow,Y.value==="list"]]),withDirectives(createBaseVNode("div",_hoisted_11$j,[createBaseVNode("div",_hoisted_12$i,[(openBlock(!0),createElementBlock(Fragment,null,renderList(m.value,(Ve,Oe)=>(openBlock(),createElementBlock("div",{key:Oe,onClick:je=>J(Ve),class:normalizeClass({active:s.value===Ve})},toDisplayString($e.$t("signatures."+Ve)),11,_hoisted_13$i))),128))]),createBaseVNode("div",{class:normalizeClass(["sign-create-container",{mobile:unref(isMobile)}])},[createBaseVNode("div",{class:"paint-container",ref_key:"paintContainer",ref:I},[withDirectives(createBaseVNode("canvas",{id:"electronicTrackpadCanvas",width:O.value,height:F.value},null,8,_hoisted_14$j),[[vShow,s.value==="trackpad"]]),withDirectives(createBaseVNode("div",_hoisted_15$i,[withDirectives(createBaseVNode("input",{type:"text",placeholder:$e.$t("signatures.signHere"),"onUpdate:modelValue":Me[4]||(Me[4]=Ve=>E.value=Ve),name:"signature",style:normalizeStyle({fontFamily:N.value})},null,12,_hoisted_16$i),[[vModelText,E.value]])],512),[[vShow,s.value==="keyboard"]]),withDirectives(createBaseVNode("div",{class:"image-paint",onDrop:X,onDragover:Me[5]||(Me[5]=withModifiers(()=>{},["prevent"]))},[withDirectives(createBaseVNode("div",null,[createVNode(oe),createBaseVNode("div",null,toDisplayString($e.$t("signatures.electronicSignature.dropFile")),1),createBaseVNode("a",null,[createTextVNode(toDisplayString($e.$t("signatures.selectFile")),1),createBaseVNode("input",{type:"file",id:"signImageInput",onChange:H,accept:".png, .jpg, .jpeg",onClick:te,name:"signature"},null,32)])],512),[[vShow,!M.value]])],544),[[vShow,s.value==="image"]])],512),["trackpad","keyboard"].includes(s.value)?(openBlock(),createElementBlock("div",_hoisted_17$g,[withDirectives(createBaseVNode("div",_hoisted_18$g,[unref(isMobile)?createCommentVNode("",!0):(openBlock(),createElementBlock("span",_hoisted_19$f,toDisplayString($e.$t("signatures.lineWidth")),1)),createVNode(unref(NSlider),{value:T.value,"onUpdate:value":Me[6]||(Me[6]=Ve=>T.value=Ve),step:1,max:10,min:1,class:"width-slider"},{thumb:withCtx(()=>[createVNode(ke)]),_:1},8,["value"]),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Me[7]||(Me[7]=Ve=>T.value=Ve),type:"text",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onBlur:Pe,name:"signature"},null,544),[[vModelText,T.value]])],512),[[vShow,s.value==="trackpad"&&v.value.trackpad.enableLineWidth]]),withDirectives(createBaseVNode("div",_hoisted_20$f,[unref(isMobile)?createCommentVNode("",!0):(openBlock(),createElementBlock("span",_hoisted_21$f,toDisplayString($e.$t("common.uiElements.font")),1)),withDirectives(createBaseVNode("select",{id:"fontFamily","onUpdate:modelValue":Me[8]||(Me[8]=Ve=>N.value=Ve)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(v.value.keyboard.fonts,(Ve,Oe)=>(openBlock(),createElementBlock("option",{value:Ve,key:Oe},toDisplayString(Ve),9,_hoisted_22$f))),128))],512),[[vModelSelect,N.value]])],512),[[vShow,s.value==="keyboard"]]),withDirectives(createBaseVNode("div",_hoisted_23$d,[unref(isMobile)?createCommentVNode("",!0):(openBlock(),createElementBlock("span",_hoisted_24$d,toDisplayString($e.$t("common.uiElements.color")),1)),createBaseVNode("div",_hoisted_25$d,[(openBlock(!0),createElementBlock(Fragment,null,renderList(v.value[s.value].colors,(Ve,Oe)=>(openBlock(),createElementBlock("span",{class:"cell-container",key:Oe},[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(D.value,Ve.value)}]),onClick:je=>be(Ve.value)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ve.value}`)},null,4)],10,_hoisted_26$c)]))),128)),v.value[s.value].enableCustomColor?(openBlock(),createElementBlock("div",_hoisted_27$b,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:q.value})},null,4),createVNode(unref(NColorPicker),{to:".signatures-popup",onComplete:we,"onUpdate:value":Ae,value:q.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_28$a]),_:1},8,["value"])])):createCommentVNode("",!0)])],512),[[vShow,s.value==="trackpad"||s.value==="keyboard"]])])):createCommentVNode("",!0)],2),createBaseVNode("div",_hoisted_29$9,[createBaseVNode("div",_hoisted_30$9,[createBaseVNode("span",{class:"clear top",onClick:Z},toDisplayString($e.$t("common.actions.clear")),1),k.value?(openBlock(),createElementBlock("div",_hoisted_31$7,[createBaseVNode("div",{class:normalizeClass(["check",{active:_e.value,disabled:f.value.length>=5}]),onClick:Me[9]||(Me[9]=Ve=>f.value.length<5&&(_e.value=!_e.value))},[withDirectives(createVNode(Ce,null,null,512),[[vShow,_e.value]])],2),f.value.length<5?(openBlock(),createElementBlock("span",_hoisted_32$6,toDisplayString($e.$t("signatures.electronicSignature.saveTemplate")),1)):(openBlock(),createElementBlock("span",_hoisted_33$5,toDisplayString($e.$t("signatures.fullStorage")),1))])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_34$5,[createBaseVNode("span",{class:"clear bottom",onClick:Z},toDisplayString($e.$t("common.actions.clear")),1),createBaseVNode("div",_hoisted_35$5,[createBaseVNode("div",{class:"button",onClick:Me[10]||(Me[10]=Ve=>fe("cancel"))},toDisplayString($e.$t("common.actions.cancel")),1),createBaseVNode("div",{class:normalizeClass(["button blue",{disabled:!E.value&&!M.value}]),onClick:Q},toDisplayString($e.$t("common.actions.apply")),3)])])])],512),[[vShow,Y.value==="create"]])])])],32),P.value?(openBlock(),createElementBlock("div",_hoisted_36$4,[createVNode(Be,{show:P.value,dialogName:$e.dialogName},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:Me[12]||(Me[12]=Ve=>P.value=!1)},toDisplayString($e.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:ve},toDisplayString($e.$t("common.actions.ok")),1)]),default:withCtx(()=>[createVNode(Ee),createBaseVNode("p",null,toDisplayString($e.$t("signatures.deleteConfirm")),1)]),_:1},8,["show","dialogName"])])):createCommentVNode("",!0)],64)}}},_sfc_main$4n={},_hoisted_1$3_={width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3M=createBaseVNode("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:"#FF5050",stroke:"#FF5050","stroke-linejoin":"round"},null,-1),_hoisted_3$3o=createBaseVNode("path",{d:"M30 18L18 30",stroke:"white","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_4$1f=createBaseVNode("path",{d:"M18 18L30 30",stroke:"white","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_5$O=[_hoisted_2$3M,_hoisted_3$3o,_hoisted_4$1f];function _sfc_render$2K(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3_,_hoisted_5$O)}const __unplugin_components_16$1=_export_sfc(_sfc_main$4n,[["render",_sfc_render$2K]]),_sfc_main$4m={},_hoisted_1$3Z={width:"60",height:"60",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3L=createStaticVNode('<circle cx="47.0455" cy="16.3636" r="2.04545" fill="white"></circle><circle cx="53.1819" cy="32.0454" r="2.72727" fill="white"></circle><circle cx="47.0453" cy="47.0456" r="3.40909" fill="white"></circle><circle cx="31.3639" cy="53.8636" r="4.09091" fill="white"></circle><circle cx="15.6819" cy="47.7273" r="4.77273" fill="white"></circle><circle cx="9.54537" cy="32.0454" r="5.45455" fill="white"></circle><circle cx="15.6818" cy="17.0455" r="6.13636" fill="white"></circle><circle cx="31.3636" cy="9.54548" r="6.81818" fill="white"></circle>',8),_hoisted_10$m=[_hoisted_2$3L];function _sfc_render$2J(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3Z,_hoisted_10$m)}const __unplugin_components_13$2=_export_sfc(_sfc_main$4m,[["render",_sfc_render$2J]]),FreetextColorContainer_vue_vue_type_style_index_0_scoped_77b9368c_lang="",_withScopeId$1=e=>(pushScopeId("data-v-77b9368c"),e=e(),popScopeId(),e),_hoisted_1$3Y={class:"colors-container"},_hoisted_2$3K={key:0,class:"cell-container"},_hoisted_3$3n=["onClick"],_hoisted_4$1e={class:"color-picker"},_hoisted_5$N=_withScopeId$1(()=>createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1)),_sfc_main$4l={__name:"FreetextColorContainer",props:{propertyColor:{type:String},colors:{type:Array,default:()=>[]},noColor:{type:Boolean,default:!1}},emits:["setActiveColor"],setup(e,{emit:n}){const{propertyColor:o}=e,r=n,u=ref("rgb(0, 0, 0)"),s=v=>{r("setActiveColor",v)},w=v=>{areColorsSimilar(v,o)||s(v)},m=v=>{u.value=v};return(v,g)=>{const d=__unplugin_components_0$z;return openBlock(),createElementBlock("div",_hoisted_1$3Y,[e.noColor?(openBlock(),createElementBlock("span",_hoisted_2$3K,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:!e.propertyColor}]),onClick:g[0]||(g[0]=f=>s(""))},[createVNode(d)],2)])):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.colors,(f,y)=>(openBlock(),createElementBlock("span",{class:"cell-container",key:y},[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,f)}]),onClick:x=>s(f)},[createBaseVNode("span",{class:"cell",style:normalizeStyle({backgroundColor:f})},null,4)],10,_hoisted_3$3n)]))),128)),createBaseVNode("div",_hoisted_4$1e,[createBaseVNode("div",{class:normalizeClass(["preview-container",{active:e.propertyColor===u.value}])},[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:u.value})},null,4)],2),createVNode(unref(NColorPicker),{to:".freetext-panel",onComplete:w,"onUpdate:value":m,value:u.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_5$N]),_:1},8,["value"])])])}}},__unplugin_components_5$9=_export_sfc(_sfc_main$4l,[["__scopeId","data-v-77b9368c"]]),FreetextPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$3X={class:"sidebar-title"},_hoisted_2$3J={class:"edit-container"},_hoisted_3$3m={class:"text"},_hoisted_4$1d={class:"text-title subtitle"},_hoisted_5$M={class:"content-block"},_hoisted_6$B={class:"text-align"},_hoisted_7$s={class:"border"},_hoisted_8$o={class:"border"},_hoisted_9$m={class:"color"},_hoisted_10$l={class:"color-title subtitle"},_hoisted_11$i={class:"border-width"},_hoisted_12$h={class:"subtitle"},_hoisted_13$h={class:"tool slider"},_hoisted_14$i={class:"line-style"},_hoisted_15$h={class:"line-style-title subtitle"},_hoisted_16$h={class:"block"},_hoisted_17$f={class:"line-select"},_hoisted_18$f={class:"solid"},_hoisted_19$e=createBaseVNode("div",{class:"solid-line"},null,-1),_hoisted_20$e=createBaseVNode("div",null,null,-1),_hoisted_21$e={class:"line-select"},_hoisted_22$e={class:"solid"},_hoisted_23$c=createBaseVNode("div",{class:"dashed-line"},null,-1),_hoisted_24$c={class:"color"},_hoisted_25$c={class:"color-title subtitle"},_hoisted_26$b={class:"color"},_hoisted_27$a={class:"color-title subtitle"},_hoisted_28$9={class:"border-text-opacity"},_hoisted_29$8={class:"subtitle"},_hoisted_30$8={class:"tool slider"},_sfc_main$4k={__name:"FreetextPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=computed(()=>n.isElementOpen("freetextPanel")),r=computed(()=>n.getCustomFonts),s=getCurrentInstance().appContext.app.config.globalProperties.$t,w=["rgb(0, 0, 0)","rgb(255, 0, 0)","rgb(255, 236, 102)","rgb(45, 119, 250)"],m=["rgb(0, 0, 0)","rgb(255, 0, 0)","rgb(255, 236, 102)"];let v=null,g=reactive({fontName:"Helvetica",fontStyle:"regular",fontSize:14,textAlignment:"left",color:"rgb(0, 0, 0)",borderWidth:0,borderColor:"rgb(0, 0, 0)",opacity:1,fillColor:"",borderStyle:"solid",dashes:2});const d={fontName:"Helvetica",fontStyle:"regular",fontSize:14,textAlignment:"left",color:"rgb(0, 0, 0)",borderWidth:0,borderColor:"rgb(0, 0, 0)",opacity:1,fillColor:"",borderStyle:"solid",dashes:2},y=[2,4,6,8,10].map(Q=>({label:`${Q} pt`,value:Q})),x=Q=>({label:Q+" pt",value:Q}),k=Q=>{const re=Q.fontFamily;n.setCustomFonts(re)};core.addEvent("LoadFont",k),watch(()=>r.value,(Q,re)=>{S.value=P(Q)},{deep:!0});const P=Q=>{if(Q.length)return Q.map(re=>({label:re.fontFamily,value:re.fontName}))},S=ref([]);S.value=P(r.value);const E=computed(()=>[{label:s("common.fontStyles.regular"),value:"normal"},{label:s("common.fontStyles.bold"),value:"bold"},{label:s("common.fontStyles.boldOblique"),value:"boldOblique"},{label:s("common.fontStyles.oblique"),value:"oblique"}]),M=[{label:"25%",value:.25},{label:"50%",value:.5},{label:"75%",value:.75},{label:"100%",value:1}],T=Q=>({label:Math.round(Q*100)+"%",value:Q}),N=[6,8,10,12,14,16,20,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72].map(Q=>({label:`${Q} pt`,value:Q})),I=Q=>({label:Q+" pt",value:Q});watch(()=>o.value,(Q,re)=>{Q&&n.closeElement("pageModePanel")});const O=()=>{U({borderWidth:g.borderWidth})},F=()=>{U({opacity:g.opacity})},q=Q=>{Q!==null&&(g.dashes=Math.round(Q),U({dashes:`${g.dashes},${g.dashes}`}))},Y=Q=>Q===""?2:Number.parseInt(Q),_e=Q=>Q===null?"2 pt":Q+" pt";watch(()=>g.fontName,(Q,re)=>{U({fontName:Q})}),watch(()=>g.fontStyle,(Q,re)=>{const Pe=/bold/i.test(Q)?"bold":"normal",be=/(oblique|italic)/i.test(Q)?"oblique":"normal";U({fontStyle:be,fontWeight:Pe})}),watch(()=>g.fontSize,(Q,re)=>{typeof Q=="number"&&U({fontSize:g.fontSize})});const ne=(Q,re)=>{g[Q]=re,U({[Q]:re})},ve=Q=>{g.borderWidth=Number.parseInt(Q),U({borderWidth:g.borderWidth})},J=Q=>{g.opacity=Number.parseInt(Q),U({opacity:g.opacity})},fe=Q=>{g.textAlignment=Q,U({textAlignment:g.textAlignment})},Z=Q=>{g.borderStyle=Q,g.borderStyle==="dashed"?U({borderStyle:Q,dashes:`${g.dashes},${g.dashes}`}):U({borderStyle:Q})},j=Q=>{const re=Q.annotation;for(const Pe in re){if(Pe==="fontStyle"||Pe==="fontWeight"){const be=re.fontWeight||"normal",we=re.fontStyle||"normal";be==="bold"&&we==="oblique"?g.fontStyle="boldOblique":be==="bold"?g.fontStyle="bold":we==="oblique"?g.fontStyle="oblique":g.fontStyle="normal";continue}if(Pe in g){if(Pe==="dashes"){const be=Number(re.dashes.split(",")[0].trim());g.dashes=be;continue}g[Pe]=re[Pe]}}},X=Q=>{const{annotation:re}=Q;v&&v.annotation.name===re.name&&j(Q)},H=Q=>{j(Q),v=Q};core.addEvent("annotationChange",X),core.addEvent("annotationSelectedAttr",H),core.addEvent("annotationDeselected",Q=>{v===Q&&(v=null,Object.keys(d).forEach(re=>{g[re]=d[re]})),te()});const U=Q=>{v?core.setAnnotationStyles(v,Q):(Object.keys(Q).forEach(re=>{d[re]=Q[re]}),core.setFreetextDefault(Q))},te=()=>{n.closeElement("freetextPanel")};return(Q,re)=>{const Pe=__unplugin_components_14$2,be=__unplugin_components_0$B,we=__unplugin_components_6$a,Ae=__unplugin_components_4$f,$e=__unplugin_components_7$8,Me=__unplugin_components_5$9,Ie=__unplugin_components_1$f;return openBlock(),createElementBlock("div",{class:normalizeClass(["freetext-panel property-panel",{closed:!o.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$3X,[createTextVNode(toDisplayString(unref(v)&&unref(v).annotation.intent==="FreeTextCallout"?unref(s)("toolbar.annotationTools.callout"):unref(s)("panels.freeText.title"))+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(Pe,{key:0,class:"close-button",onClick:te})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$3J,[createBaseVNode("div",_hoisted_3$3m,[createBaseVNode("div",_hoisted_4$1d,toDisplayString(unref(s)("panels.freeText.fontStyle")),1),createVNode(unref(NSelect),{value:unref(g).fontName,"onUpdate:value":re[0]||(re[0]=Le=>unref(g).fontName=Le),options:S.value,to:".freetext-panel",class:"text-family"},{arrow:withCtx(()=>[createVNode(be)]),_:1},8,["value","options"]),createBaseVNode("div",_hoisted_5$M,[createVNode(unref(NSelect),{value:unref(g).fontStyle,"onUpdate:value":re[1]||(re[1]=Le=>unref(g).fontStyle=Le),options:E.value,to:".freetext-panel",class:"font-style-select"},{arrow:withCtx(()=>[createVNode(be)]),_:1},8,["value","options"]),createVNode(unref(NSelect),{value:unref(g).fontSize,"onUpdate:value":re[2]||(re[2]=Le=>unref(g).fontSize=Le),"fallback-option":I,options:unref(N),to:".freetext-panel",class:"font-size-select"},{arrow:withCtx(()=>[createVNode(be)]),_:1},8,["value","options"])])]),createBaseVNode("div",_hoisted_6$B,[createBaseVNode("div",{class:normalizeClass({active:unref(g).textAlignment==="left"}),onClick:re[3]||(re[3]=Le=>fe("left"))},[createBaseVNode("span",_hoisted_7$s,[createVNode(we)])],2),createBaseVNode("div",{class:normalizeClass({active:unref(g).textAlignment==="center"}),onClick:re[4]||(re[4]=Le=>fe("center"))},[createBaseVNode("span",_hoisted_8$o,[createVNode(Ae)])],2),createBaseVNode("div",{class:normalizeClass({active:unref(g).textAlignment==="right"}),onClick:re[5]||(re[5]=Le=>fe("right"))},[createBaseVNode("span",null,[createVNode($e)])],2)]),createBaseVNode("div",_hoisted_9$m,[createBaseVNode("div",_hoisted_10$l,toDisplayString(unref(s)("panels.freeText.fontColor")),1),createVNode(Me,{colors:w,propertyColor:unref(g).color,onSetActiveColor:re[6]||(re[6]=Le=>ne("color",Le))},null,8,["propertyColor"])]),createBaseVNode("div",_hoisted_11$i,[createBaseVNode("div",_hoisted_12$h,toDisplayString(unref(s)("panels.freeText.borderWidth")),1),createBaseVNode("div",_hoisted_13$h,[createVNode(unref(NSlider),{keyboard:!1,value:unref(g).borderWidth,"onUpdate:value":re[7]||(re[7]=Le=>unref(g).borderWidth=Le),tooltip:!1,step:1,max:10,min:0,class:"width-slider","on-dragend":O},{thumb:withCtx(()=>[createVNode(Ie)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(g).borderWidth,"onUpdate:value":[re[8]||(re[8]=Le=>unref(g).borderWidth=Le),ve],"fallback-option":x,options:unref(y),to:".freetext-panel"},{arrow:withCtx(()=>[createVNode(be)]),_:1},8,["value","options"])])]),createBaseVNode("div",_hoisted_14$i,[createBaseVNode("div",_hoisted_15$h,toDisplayString(unref(s)("panels.measurement.lineStyle")),1),createBaseVNode("div",_hoisted_16$h,[createBaseVNode("div",_hoisted_17$f,[createBaseVNode("div",{class:normalizeClass(["checkbox",{active:unref(g).borderStyle==="solid"}]),onClick:re[9]||(re[9]=Le=>Z("solid"))},[withDirectives(createBaseVNode("div",_hoisted_18$f,null,512),[[vShow,unref(g).borderStyle==="solid"]])],2),_hoisted_19$e]),_hoisted_20$e,createBaseVNode("div",_hoisted_21$e,[createBaseVNode("div",{class:normalizeClass(["checkbox",{active:unref(g).borderStyle==="dashed"}]),onClick:re[10]||(re[10]=Le=>Z("dashed"))},[withDirectives(createBaseVNode("div",_hoisted_22$e,null,512),[[vShow,unref(g).borderStyle==="dashed"]])],2),_hoisted_23$c]),createVNode(unref(NInputNumber),{value:unref(g).dashes,"onUpdate:value":[re[11]||(re[11]=Le=>unref(g).dashes=Le),q],placeholder:"2 pt",min:"0",max:"10",step:1,parse:Y,format:_e,"update-value-on-input":!1,disabled:unref(g).borderStyle!=="dashed"},{"minus-icon":withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["arrow down",{disabled:unref(g).borderStyle!=="dashed"}])},null,2)]),"add-icon":withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["arrow up",{disabled:unref(g).borderStyle!=="dashed"}])},null,2)]),_:1},8,["value","disabled"])])]),createBaseVNode("div",_hoisted_24$c,[createBaseVNode("div",_hoisted_25$c,toDisplayString(unref(s)("panels.freeText.borderColor")),1),createVNode(Me,{colors:w,propertyColor:unref(g).borderColor,onSetActiveColor:re[12]||(re[12]=Le=>ne("borderColor",Le))},null,8,["propertyColor"])]),createBaseVNode("div",_hoisted_26$b,[createBaseVNode("div",_hoisted_27$a,toDisplayString(unref(s)("panels.freeText.fillColor")),1),createVNode(Me,{colors:m,propertyColor:unref(g).fillColor,noColor:!0,onSetActiveColor:re[13]||(re[13]=Le=>ne("fillColor",Le))},null,8,["propertyColor"])]),createBaseVNode("div",_hoisted_28$9,[createBaseVNode("div",_hoisted_29$8,toDisplayString(unref(s)("panels.freeText.opacity")),1),createBaseVNode("div",_hoisted_30$8,[createVNode(unref(NSlider),{value:unref(g).opacity,"onUpdate:value":re[14]||(re[14]=Le=>unref(g).opacity=Le),tooltip:!1,step:.01,max:1,min:0,class:"width-slider","on-dragend":F},{thumb:withCtx(()=>[createVNode(Ie)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(g).opacity,"onUpdate:value":[re[15]||(re[15]=Le=>unref(g).opacity=Le),J],"fallback-option":T,options:M,to:".freetext-panel"},{arrow:withCtx(()=>[createVNode(be)]),_:1},8,["value"])])])])],6)}}},ColorContainer_vue_vue_type_style_index_0_scoped_46da3324_lang="",_withScopeId=e=>(pushScopeId("data-v-46da3324"),e=e(),popScopeId(),e),_hoisted_1$3W={class:"colors-container"},_hoisted_2$3I={key:0,class:"cell-container"},_hoisted_3$3l={key:1,class:"cell-container"},_hoisted_4$1c=_withScopeId(()=>createBaseVNode("span",{class:"cell green"},null,-1)),_hoisted_5$L=[_hoisted_4$1c],_hoisted_6$A={class:"cell-container"},_hoisted_7$r=_withScopeId(()=>createBaseVNode("span",{class:"cell red"},null,-1)),_hoisted_8$n=[_hoisted_7$r],_hoisted_9$l={class:"cell-container"},_hoisted_10$k=_withScopeId(()=>createBaseVNode("span",{class:"cell yellow"},null,-1)),_hoisted_11$h=[_hoisted_10$k],_hoisted_12$g={class:"cell-container"},_hoisted_13$g=_withScopeId(()=>createBaseVNode("span",{class:"cell blue"},null,-1)),_hoisted_14$h=[_hoisted_13$g],_hoisted_15$g={class:"cell-container"},_hoisted_16$g=_withScopeId(()=>createBaseVNode("span",{class:"cell",style:{background:"rgb(255, 246, 179)"}},null,-1)),_hoisted_17$e=[_hoisted_16$g],_hoisted_18$e={class:"cell-container"},_hoisted_19$d=_withScopeId(()=>createBaseVNode("span",{class:"cell",style:{background:"rgb(254, 191, 191)"}},null,-1)),_hoisted_20$d=[_hoisted_19$d],_hoisted_21$d={class:"cell-container"},_hoisted_22$d=_withScopeId(()=>createBaseVNode("span",{class:"cell",style:{background:"rgb(100, 188, 56)"}},null,-1)),_hoisted_23$b=[_hoisted_22$d],_hoisted_24$b={class:"color-picker"},_hoisted_25$b=_withScopeId(()=>createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1)),_sfc_main$4j={__name:"ColorContainer",props:{propertyColor:{type:String},noColor:{type:Boolean,default:!1}},emits:["setActiveColor"],setup(e,{emit:n}){const{propertyColor:o}=e,r=n,u=ref("rgb(0, 0, 0)"),s=v=>{r("setActiveColor",v)},w=v=>{areColorsSimilar(v,o)||s(v)},m=v=>{u.value=v};return(v,g)=>{const d=__unplugin_components_0$z;return openBlock(),createElementBlock("div",_hoisted_1$3W,[e.noColor?(openBlock(),createElementBlock("span",_hoisted_2$3I,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:!e.propertyColor}]),onClick:g[0]||(g[0]=f=>s(""))},[createVNode(d)],2)])):(openBlock(),createElementBlock("span",_hoisted_3$3l,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(100, 188, 56)")}]),onClick:g[1]||(g[1]=f=>s("rgb(100, 188, 56)"))},_hoisted_5$L,2)])),createBaseVNode("span",_hoisted_6$A,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(255, 0, 0)")}]),onClick:g[2]||(g[2]=f=>s("rgb(255, 0, 0)"))},_hoisted_8$n,2)]),createBaseVNode("span",_hoisted_9$l,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(255, 236, 102)")}]),onClick:g[3]||(g[3]=f=>s("rgb(255, 236, 102)"))},_hoisted_11$h,2)]),createBaseVNode("span",_hoisted_12$g,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(45, 119, 250)")}]),onClick:g[4]||(g[4]=f=>s("rgb(45, 119, 250)"))},_hoisted_14$h,2)]),unref(isMobileDevice)?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("span",_hoisted_15$g,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(255, 246, 179)")}]),onClick:g[5]||(g[5]=f=>s("rgb(255, 246, 179)"))},_hoisted_17$e,2)]),createBaseVNode("span",_hoisted_18$e,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(254, 191, 191)")}]),onClick:g[6]||(g[6]=f=>s("rgb(254, 191, 191)"))},_hoisted_20$d,2)]),createBaseVNode("span",_hoisted_21$d,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(e.propertyColor,"rgb(100, 188, 56)")}]),onClick:g[7]||(g[7]=f=>s("rgb(100, 188, 56)"))},_hoisted_23$b,2)])],64)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_24$b,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:u.value})},null,4),createVNode(unref(NColorPicker),{to:".measure-panel",onComplete:w,"onUpdate:value":m,value:u.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_25$b]),_:1},8,["value"])])])}}},__unplugin_components_1$d=_export_sfc(_sfc_main$4j,[["__scopeId","data-v-46da3324"]]),_sfc_main$4i={},_hoisted_1$3V={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3H=createBaseVNode("path",{d:"M56 7.5V8.5H0V7.5H56Z",fill:"currentColor"},null,-1),_hoisted_3$3k=[_hoisted_2$3H];function _sfc_render$2I(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3V,_hoisted_3$3k)}const HeadLine=_export_sfc(_sfc_main$4i,[["render",_sfc_render$2I]]),_sfc_main$4h={},_hoisted_1$3U={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3G=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.06066 4.35359L4.35355 3.64648L0 8.00004L4.35355 12.3536L5.06066 11.6465L1.91418 8.5H56V7.5H1.91425L5.06066 4.35359Z",fill:"currentColor"},null,-1),_hoisted_3$3j=[_hoisted_2$3G];function _sfc_render$2H(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3U,_hoisted_3$3j)}const HeadArrow=_export_sfc(_sfc_main$4h,[["render",_sfc_render$2H]]),_sfc_main$4g={},_hoisted_1$3T={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3F=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5 8.5V12L0 8L5 4V7.5H56V8.5H5Z",fill:"currentColor"},null,-1),_hoisted_3$3i=[_hoisted_2$3F];function _sfc_render$2G(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3T,_hoisted_3$3i)}const HeadClose=_export_sfc(_sfc_main$4g,[["render",_sfc_render$2G]]),_sfc_main$4f={},_hoisted_1$3S={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3E=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 5H6V7.5H56V8.5H6V11H0V8.5V7.5V5Z",fill:"currentColor"},null,-1),_hoisted_3$3h=[_hoisted_2$3E];function _sfc_render$2F(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3S,_hoisted_3$3h)}const HeadSquare=_export_sfc(_sfc_main$4f,[["render",_sfc_render$2F]]),_sfc_main$4e={},_hoisted_1$3R={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3D=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 8C0 6.34315 1.34315 5 3 5C4.4865 5 5.72048 6.08114 5.95852 7.5H56V8.5H5.95852C5.72048 9.91886 4.4865 11 3 11C1.34315 11 0 9.65685 0 8Z",fill:"currentColor"},null,-1),_hoisted_3$3g=[_hoisted_2$3D];function _sfc_render$2E(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3R,_hoisted_3$3g)}const HeadCircle=_export_sfc(_sfc_main$4e,[["render",_sfc_render$2E]]),_sfc_main$4d={},_hoisted_1$3Q={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3C=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 8L4 4L7.5 7.5H56V8.5H7.5L4 12L0 8Z",fill:"currentColor"},null,-1),_hoisted_3$3f=[_hoisted_2$3C];function _sfc_render$2D(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3Q,_hoisted_3$3f)}const HeadDiamond=_export_sfc(_sfc_main$4d,[["render",_sfc_render$2D]]),_sfc_main$4c={},_hoisted_1$3P={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3B=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1 7.5V5.5H0V7.5V8.5V10.5H1V8.5H56V7.5H1Z",fill:"currentColor"},null,-1),_hoisted_3$3e=[_hoisted_2$3B];function _sfc_render$2C(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3P,_hoisted_3$3e)}const HeadButt=_export_sfc(_sfc_main$4c,[["render",_sfc_render$2C]]),_sfc_main$4b={},_hoisted_1$3O={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3A=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 5.87004L0.508793 5L4.25147 7.5H56V8.5H4.25147L0.508793 11L0 10.13L3.19004 8L0 5.87004Z",fill:"currentColor"},null,-1),_hoisted_3$3d=[_hoisted_2$3A];function _sfc_render$2B(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3O,_hoisted_3$3d)}const HeadRopen=_export_sfc(_sfc_main$4b,[["render",_sfc_render$2B]]),_sfc_main$4a={},_hoisted_1$3N={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 7.5V5L4.16667 7.5H56V8.5H4.16667L0 11V8.5V7.5Z",fill:"currentColor"},null,-1),_hoisted_3$3c=[_hoisted_2$3z];function _sfc_render$2A(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3N,_hoisted_3$3c)}const HeadRclose=_export_sfc(_sfc_main$4a,[["render",_sfc_render$2A]]),_sfc_main$49={},_hoisted_1$3M={width:"56",height:"16",viewBox:"0 0 56 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3y=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 6.66667L2.5 6L0 9.33333L0.5 10L1.625 8.5H56V7.5H2.375L3 6.66667Z",fill:"currentColor"},null,-1),_hoisted_3$3b=[_hoisted_2$3y];function _sfc_render$2z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3M,_hoisted_3$3b)}const HeadSlash=_export_sfc(_sfc_main$49,[["render",_sfc_render$2z]]),_sfc_main$48={},_hoisted_1$3L={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3x=createBaseVNode("path",{d:"M0 1H86",stroke:"black"},null,-1),_hoisted_3$3a=[_hoisted_2$3x];function _sfc_render$2y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3L,_hoisted_3$3a)}const LinestyleSolidLine=_export_sfc(_sfc_main$48,[["render",_sfc_render$2y]]),_sfc_main$47={},_hoisted_1$3K={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3w=createBaseVNode("path",{d:"M0 1H86",stroke:"black","stroke-dasharray":"4 4"},null,-1),_hoisted_3$39=[_hoisted_2$3w];function _sfc_render$2x(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3K,_hoisted_3$39)}const LinestyleDash4_4=_export_sfc(_sfc_main$47,[["render",_sfc_render$2x]]),_sfc_main$46={},_hoisted_1$3J={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3v=createBaseVNode("path",{d:"M0 1H86",stroke:"black","stroke-dasharray":"6 6"},null,-1),_hoisted_3$38=[_hoisted_2$3v];function _sfc_render$2w(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3J,_hoisted_3$38)}const LinestyleDash6_6=_export_sfc(_sfc_main$46,[["render",_sfc_render$2w]]),_sfc_main$45={},_hoisted_1$3I={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3u=createBaseVNode("path",{d:"M0 1H86",stroke:"black","stroke-dasharray":"10 10"},null,-1),_hoisted_3$37=[_hoisted_2$3u];function _sfc_render$2v(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3I,_hoisted_3$37)}const LinestyleDash10_10=_export_sfc(_sfc_main$45,[["render",_sfc_render$2v]]),_sfc_main$44={},_hoisted_1$3H={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3t=createStaticVNode('<path d="M0 1H6" stroke="black"></path><path d="M8 1H9" stroke="black"></path><path d="M11 1H17" stroke="black"></path><path d="M19 1H20" stroke="black"></path><path d="M22 1H28" stroke="black"></path><path d="M30 1H31" stroke="black"></path><path d="M33 1H39" stroke="black"></path><path d="M41 1H42" stroke="black"></path><path d="M44 1H50" stroke="black"></path><path d="M52 1H53" stroke="black"></path><path d="M55 1H61" stroke="black"></path><path d="M63 1H64" stroke="black"></path><path d="M66 1H72" stroke="black"></path><path d="M74 1H75" stroke="black"></path><path d="M77 1H83" stroke="black"></path><path d="M85 1H86" stroke="black"></path>',16),_hoisted_18$d=[_hoisted_2$3t];function _sfc_render$2u(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3H,_hoisted_18$d)}const LinestyleDash6_2_1_2=_export_sfc(_sfc_main$44,[["render",_sfc_render$2u]]),_sfc_main$43={},_hoisted_1$3G={width:"86",height:"2",viewBox:"0 0 86 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3s=createStaticVNode('<path d="M0 1H6" stroke="black"></path><path d="M8 1H10" stroke="black"></path><path d="M12.5715 1H18.5715" stroke="black"></path><path d="M20.5715 1H22.5715" stroke="black"></path><path d="M25.1428 1H31.1428" stroke="black"></path><path d="M33.1428 1H35.1428" stroke="black"></path><path d="M37.7144 1H43.7144" stroke="black"></path><path d="M45.7144 1H47.7144" stroke="black"></path><path d="M50.2856 1H56.2856" stroke="black"></path><path d="M58.2856 1H60.2856" stroke="black"></path><path d="M62.8572 1H68.8572" stroke="black"></path><path d="M70.8572 1H72.8572" stroke="black"></path><path d="M75.4285 1H81.4285" stroke="black"></path><path d="M83.4285 1H85.4285" stroke="black"></path>',14),_hoisted_16$f=[_hoisted_2$3s];function _sfc_render$2t(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3G,_hoisted_16$f)}const LinestyleDash6_2_2_2=_export_sfc(_sfc_main$43,[["render",_sfc_render$2t]]),_sfc_main$42={},_hoisted_1$3F={width:"90",height:"2",viewBox:"0 0 90 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3r=createStaticVNode('<path d="M0 1H2" stroke="black"></path><path d="M4 1H14" stroke="black"></path><path d="M16 1H18" stroke="black"></path><path d="M20 1H30" stroke="black"></path><path d="M32 1H34" stroke="black"></path><path d="M36 1H46" stroke="black"></path><path d="M48 1H50" stroke="black"></path><path d="M52 1H62" stroke="black"></path><path d="M64 1H66" stroke="black"></path><path d="M68 1H78" stroke="black"></path><path d="M80 1H82" stroke="black"></path><path d="M84 1H90" stroke="black"></path>',12),_hoisted_14$g=[_hoisted_2$3r];function _sfc_render$2s(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3F,_hoisted_14$g)}const LinestyleDash2_2_10_2=_export_sfc(_sfc_main$42,[["render",_sfc_render$2s]]),_sfc_main$41={},_hoisted_1$3E={width:"87",height:"4",viewBox:"0 0 87 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3q=createBaseVNode("path",{d:"M1 0C1 1.36964 2.14004 2.49993 3.57129 2.5C5.00261 2.5 6.14258 1.36969 6.14258 0H7.14258C7.14258 1.36955 8.28275 2.49978 9.71387 2.5C11.0557 2.5 12.1419 1.50662 12.2725 0.253906L12.2861 0H13.2861C13.2861 1.36969 14.4261 2.5 15.8574 2.5C17.1991 2.49986 18.2845 1.50652 18.415 0.253906L18.4287 0H19.4287C19.4287 1.36969 20.5687 2.5 22 2.5C23.4313 2.5 24.5713 1.36969 24.5713 0H25.5713C25.5713 1.3696 26.7114 2.49985 28.1426 2.5C29.5739 2.5 30.7139 1.36969 30.7139 0H31.7139C31.7139 1.36969 32.8548 2.5 34.2861 2.5C35.6278 2.49979 36.7132 1.50648 36.8438 0.253906L36.8574 0H37.8574C37.8574 1.36969 38.9974 2.5 40.4287 2.5C41.86 2.49993 43 1.36964 43 0H44C44 1.36964 45.14 2.49993 46.5713 2.5C48.0026 2.5 49.1426 1.36969 49.1426 0H50.1426C50.1426 1.36955 51.2827 2.49978 52.7139 2.5C54.0557 2.5 55.1419 1.50662 55.2725 0.253906L55.2861 0H56.2861C56.2861 1.36969 57.4261 2.5 58.8574 2.5C60.1991 2.49986 61.2845 1.50652 61.415 0.253906L61.4287 0H62.4287C62.4287 1.36969 63.5687 2.5 65 2.5C66.4313 2.5 67.5713 1.36969 67.5713 0H68.5713C68.5713 1.3696 69.7114 2.49985 71.1426 2.5C72.5739 2.5 73.7139 1.36969 73.7139 0H74.7139C74.7139 1.36969 75.8548 2.5 77.2861 2.5C78.6278 2.4998 79.7132 1.50648 79.8438 0.253906L79.8574 0H80.8574C80.8574 1.36969 81.9974 2.5 83.4287 2.5C84.86 2.49993 86 1.36964 86 0H87C87 1.94398 85.3899 3.49993 83.4287 3.5C82.1277 3.5 80.981 2.81549 80.3564 1.78711C79.7319 2.81503 78.5867 3.49986 77.2861 3.5C75.9849 3.5 74.8383 2.81484 74.2139 1.78613C73.5894 2.81463 72.4436 3.5 71.1426 3.5C69.8415 3.4999 68.6957 2.8147 68.0713 1.78613C67.4468 2.8147 66.3011 3.5 65 3.5C63.6989 3.5 62.5532 2.8147 61.9287 1.78613C61.3043 2.8147 60.1585 3.4999 58.8574 3.5C57.5562 3.5 56.4096 2.81487 55.7852 1.78613C55.1607 2.8146 54.0149 3.5 52.7139 3.5C51.4132 3.49985 50.267 2.81527 49.6426 1.78711C49.018 2.81525 47.8721 3.5 46.5713 3.5C45.2699 3.49995 44.1243 2.81412 43.5 1.78516C42.8757 2.81412 41.7301 3.49995 40.4287 3.5C39.1277 3.5 37.981 2.81549 37.3564 1.78711C36.7319 2.81503 35.5867 3.49985 34.2861 3.5C32.9849 3.5 31.8383 2.81484 31.2139 1.78613C30.5894 2.81463 29.4436 3.5 28.1426 3.5C26.8415 3.4999 25.6957 2.8147 25.0713 1.78613C24.4468 2.8147 23.3011 3.5 22 3.5C20.6989 3.5 19.5532 2.8147 18.9287 1.78613C18.3043 2.8147 17.1585 3.4999 15.8574 3.5C14.5562 3.5 13.4096 2.81487 12.7852 1.78613C12.1607 2.8146 11.0149 3.5 9.71387 3.5C8.41315 3.49985 7.26705 2.81527 6.64258 1.78711C6.01801 2.81525 4.87207 3.5 3.57129 3.5C1.61006 3.49993 0 1.94398 0 0H1Z",fill:"black"},null,-1),_hoisted_3$36=[_hoisted_2$3q];function _sfc_render$2r(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3E,_hoisted_3$36)}const LinestyleCloudy1=_export_sfc(_sfc_main$41,[["render",_sfc_render$2r]]),_sfc_main$40={},_hoisted_1$3D={width:"88",height:"5",viewBox:"0 0 88 5",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3p=createBaseVNode("path",{d:"M1 -2.98023e-08C1 2.20914 3.75025 4 7.14286 4C10.5355 4 13.2857 2.20914 13.2857 -2.98023e-08C13.2857 2.20914 16.036 4 19.4286 4C22.8212 4 25.5714 2.20914 25.5714 -2.98023e-08C25.5714 2.20914 28.3217 4 31.7143 4C35.1069 4 37.8571 2.20914 37.8571 -2.98023e-08C37.8571 2.20914 40.6074 4 44 4C47.3926 4 50.1429 2.20914 50.1429 -2.98023e-08C50.1429 2.20914 52.8931 4 56.2857 4C59.6783 4 62.4286 2.20914 62.4286 -2.98023e-08C62.4286 2.20914 65.1788 4 68.5714 4C71.964 4 74.7143 2.20914 74.7143 -2.98023e-08C74.7143 2.20914 77.4645 4 80.8571 4C84.2498 4 87 2.20914 87 -2.98023e-08",stroke:"black"},null,-1),_hoisted_3$35=[_hoisted_2$3p];function _sfc_render$2q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3D,_hoisted_3$35)}const LinestyleCloudy2=_export_sfc(_sfc_main$40,[["render",_sfc_render$2q]]),MeasurePanel_vue_vue_type_style_index_0_lang="",_hoisted_1$3C={class:"sidebar-title"},_hoisted_2$3o={class:"edit-container"},_hoisted_3$34={key:0,class:"color"},_hoisted_4$1b={class:"color-title subtitle"},_hoisted_5$K={key:1,class:"color"},_hoisted_6$z={class:"color-title subtitle"},_hoisted_7$q={key:2,class:"opacity"},_hoisted_8$m={class:"subtitle"},_hoisted_9$k={class:"tool"},_hoisted_10$j={key:3,class:"color"},_hoisted_11$g={class:"color-title subtitle"},_hoisted_12$f={key:4,class:"line-style"},_hoisted_13$f={class:"line-style-title subtitle"},_hoisted_14$f={class:"block"},_hoisted_15$f={key:5,class:"border-width"},_hoisted_16$e={class:"subtitle"},_hoisted_17$d={class:"tool"},_hoisted_18$c={key:6,class:"opacity"},_hoisted_19$c={class:"subtitle"},_hoisted_20$c={class:"tool"},_hoisted_21$c={key:7,class:"arrow-style"},_hoisted_22$c={class:"subtitle"},_hoisted_23$a={class:"content-block"},_hoisted_24$a={key:8,class:"color"},_hoisted_25$a={class:"color-title subtitle"},_hoisted_26$a={key:9,class:"text"},_hoisted_27$9={class:"text-title subtitle"},_hoisted_28$8={class:"content-block"},_hoisted_29$7={class:"note"},_hoisted_30$7={class:"subtitle"},_sfc_main$3$={__name:"MeasurePanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen("measurePanel")),u=computed(()=>n.getCustomFonts),s=computed(()=>o.getActiveTool),w=computed(()=>n.getToolMode),m=computed(()=>o.getSelectedAnnotation),g=getCurrentInstance().appContext.app.config.globalProperties.$t;let d=reactive({measure:0,type:"",fillColor:"rgb(0, 0, 0)",fillTransparency:100,borderColor:"rgb(0, 0, 0)",opacity:100,borderStyle:"solid",dashes:2,borderWidth:2,head:"openarrow",tail:"openarrow",color:"rgb(0, 0, 0)",fontName:"Helvetica",fontStyle:"normal",fontSize:14,contents:""}),f=!1,y=ref(`${d.opacity}%`),x=ref(`${d.fillTransparency}%`);const P=[25,50,75,100].map(le=>({label:`${le}%`,value:`${le}%`}));let S=ref(`${d.borderWidth} pt`);const M=[2,4,6,8,10].map(le=>({label:`${le} pt`,value:`${le} pt`})),T=le=>{const oe=le.fontFamily;n.setCustomFonts(oe)};core.addEvent("LoadFont",T),watch(()=>u.value,(le,oe)=>{N.value=D(le)},{deep:!0});const D=le=>{if(le.length)return le.map(oe=>({label:oe.fontFamily,value:oe.fontName}))},N=ref([]);N.value=D(u.value);const I=computed(()=>[{label:g("common.fontStyles.regular"),value:"normal"},{label:g("common.fontStyles.bold"),value:"bold"},{label:g("common.fontStyles.boldOblique"),value:"boldOblique"},{label:g("common.fontStyles.oblique"),value:"oblique"}]),O=[6,8,10,12,14,16,20,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72],F=O.map(le=>({label:`${le} pt`,value:le})),q=[{label:LinestyleSolidLine,value:"solid"},{label:LinestyleDash4_4,value:"dashed-4-4"},{label:LinestyleDash6_6,value:"dashed-6-6"},{label:LinestyleDash10_10,value:"dashed-10-10"},{label:LinestyleDash6_2_1_2,value:"dashed-6-2-1-2"},{label:LinestyleDash6_2_2_2,value:"dashed-6-2-2-2"},{label:LinestyleDash2_2_10_2,value:"dashed-2-2-10-2"}],Y=[{label:LinestyleSolidLine,value:"solid"},{label:LinestyleDash4_4,value:"dashed-4-4"},{label:LinestyleDash6_6,value:"dashed-6-6"},{label:LinestyleDash10_10,value:"dashed-10-10"},{label:LinestyleDash6_2_1_2,value:"dashed-6-2-1-2"},{label:LinestyleDash6_2_2_2,value:"dashed-6-2-2-2"},{label:LinestyleDash2_2_10_2,value:"dashed-2-2-10-2"},{label:LinestyleCloudy1,value:"cloudy-1"},{label:LinestyleCloudy2,value:"cloudy-2"}],_e=[{label:LinestyleSolidLine,value:"solid"},{label:LinestyleDash4_4,value:"dashed-4-4"},{label:LinestyleDash6_6,value:"dashed-6-6"},{label:LinestyleDash10_10,value:"dashed-10-10"},{label:LinestyleDash6_2_1_2,value:"dashed-6-2-1-2"},{label:LinestyleDash6_2_2_2,value:"dashed-6-2-2-2"},{label:LinestyleDash2_2_10_2,value:"dashed-2-2-10-2"}],ne=[{label:HeadLine,value:"none"},{label:HeadArrow,value:"openarrow"},{label:HeadClose,value:"closedarrow"},{label:HeadSquare,value:"square"},{label:HeadCircle,value:"circle"},{label:HeadDiamond,value:"diamond"},{label:HeadButt,value:"butt"},{label:HeadRopen,value:"ropenarrow"},{label:HeadRclose,value:"rclosedarrow"},{label:HeadSlash,value:"slash"}],ve=le=>[h$1(le.label,{style:{verticalAlign:"middle"}})],J=le=>[h$1(le.label,{style:{verticalAlign:"-0.15em"}})],fe=le=>[h$1(le.label,{style:{verticalAlign:"-0.15em",transform:"scaleX(-1)"}})];watch(()=>r.value,(le,oe)=>{le&&n.closeElement("pageModePanel")});const Z=computed(()=>{if(d.measure){const oe=["line","polyline","polygon","rectangle","circle","curve","arc"].includes(s.value)?s.value:"";return d.type||oe}else return["text","ink","highlight","underline","squiggly","strikeout","square","circle","arrow","line","arc","polygon","polyline","stamp","image","freetext"].includes(d.type)?d.type:""}),j=computed(()=>!d.measure&&Z.value?m.value&&m.value.borderStyle==="cloudy"?g("toolbar.annotationTools.cloudy"):Z.value==="text"?g("toolbar.annotationTools.note"):g(`toolbar.annotationTools.${Z.value}`):g("panels.measurement.appearance")),X=()=>{Me({opacity:d.opacity/100})},H=()=>{Me({fillTransparency:d.fillTransparency/100})},U=()=>{Me({borderWidth:d.borderWidth})};watch(()=>d.fontName,(le,oe)=>{Me({fontName:le})}),watch(()=>d.fontStyle,(le,oe)=>{const ke=/bold/i.test(le)?"bold":"normal",Ce=/(oblique|italic)/i.test(le)?"oblique":"normal";Me({fontWeight:ke,fontStyle:Ce})}),watch(()=>d.opacity,(le,oe)=>{y.value=le+"%"}),watch(()=>d.fillTransparency,(le,oe)=>{x.value=le+"%"}),watch(()=>d.borderWidth,(le,oe)=>{S.value=le+" pt"}),watch(()=>d.fontSize,(le,oe)=>{typeof le=="number"&&Me({fontSize:d.fontSize})}),watch(()=>d.head,(le,oe)=>{Me({head:le})}),watch(()=>d.tail,(le,oe)=>{Me({tail:le})}),watch(()=>d.borderStyle,(le,oe)=>{we(le)});const te=(le,oe)=>{["highlight","underline","squiggly","strikeout"].includes(Z.value)&&le==="color"&&(d.borderColor=oe),d[le]=oe,Me({[le]:oe})},Q=()=>{d.opacity=Number.isNaN(Number.parseInt(y.value))?100:Number.parseInt(y.value),Me({opacity:d.opacity/100})},re=()=>{d.fillTransparency=Number.isNaN(Number.parseInt(x.value))?100:Number.parseInt(x.value),Me({fillTransparency:d.fillTransparency/100})},Pe=()=>{d.borderWidth=Number.parseInt(S.value),Me({borderWidth:d.borderWidth})},be=()=>{Me({contents:d.contents})},we=le=>{let oe=le.split("-");const ke=oe.shift();Me(ke==="dashed"?{borderStyle:ke,dashes:oe.join(",")}:ke==="cloudy"?{borderStyle:ke,intensity:oe.join(",")}:{borderStyle:le})},Ae=le=>{for(const oe in le){oe==="isOpen"&&(le.isOpen?n.openElement("measurePanel"):(Ie(),d.type=""));for(const ke in d)if(oe===ke){if(oe==="opacity"||oe==="fillTransparency"){d[ke]=Math.round(le[ke]*100);continue}if(oe==="borderStyle"){le.borderStyle==="solid"?d.borderStyle="solid":le.borderStyle==="dashed"?d.borderStyle=le.borderStyle+"-"+(le.dashes||"4,4").split(",").join("-"):d.borderStyle=le.borderStyle+"-"+le.intensity;continue}if(oe==="type"&&le.type==="ink"){d.type=le.arcPoints?"arc":"curve";continue}if(oe==="fontStyle"||oe==="fontWeight"){const Ce=le.fontWeight||"normal",Ee=le.fontStyle||"normal";Ce==="bold"&&Ee==="oblique"?d.fontStyle="boldOblique":Ce==="bold"?d.fontStyle="bold":Ee==="oblique"?d.fontStyle="oblique":d.fontStyle="normal";continue}d[ke]=le[oe],oe==="fontSize"&&!O.includes(le.fontSize)&&(d.fontSize=le.fontSize+" pt")}}};core.addEvent("measurePropertyChange",Ae);const $e=le=>{if(d.measure=le.measure||0,(!le.measure&&w.value==="measurement"||le.measure&&w.value==="annotation")&&r.value){Ie(),d.type="",w.value==="measurement"&&s.value&&(f=!0);return}for(const oe in le)for(const ke in d)if(oe===ke){if(oe==="opacity"||oe==="fillTransparency"){d[ke]=Math.round(le[ke]*100);continue}if(oe==="borderStyle"){le.borderStyle==="solid"?d.borderStyle="solid":le.borderStyle==="dashed"?d.borderStyle=le.borderStyle+"-"+(le.dashes||"4,4").split(",").join("-"):d.borderStyle=le.borderStyle+"-"+le.intensity;continue}if(!oe.measure&&oe==="type"&&le.type==="stamp"&&le.stampType==="image"){d.type="image";continue}if(["highlight","underline","squiggly","strikeout"].includes(le.type)&&oe==="color"){d.borderColor=le.color;continue}if(oe==="fontStyle"||oe==="fontWeight"){const Ce=le.fontWeight||"normal",Ee=le.fontStyle||"normal";Ce==="bold"&&Ee==="oblique"?d.fontStyle="boldOblique":Ce==="bold"?d.fontStyle="bold":Ee==="oblique"?d.fontStyle="oblique":d.fontStyle="normal";continue}d[ke]=le[oe],oe==="fontSize"&&!O.includes(le.fontSize)&&(d.fontSize=le.fontSize+" pt")}"contents"in le||(d.contents="")};core.addEvent("annotationSelected",$e);const Me=le=>{d.type?core.setPropertyPanel(le):core.setMeasurementDefaults(le)},Ie=()=>{n.closeElement("measurePanel")},Le=le=>{var oe,ke,Ce;le&&le.name!==m.value.name||(r.value&&Ie(),d.type="",f&&(f=!1,(Ce=(ke=(oe=core.getDocumentViewer())==null?void 0:oe.pdfViewer)==null?void 0:ke.measurementTool)==null||Ce.updateMeasurePanel()))};return core.addEvent("annotationDeselected",Le),(le,oe)=>{const ke=__unplugin_components_14$2,Ce=__unplugin_components_1$d,Ee=__unplugin_components_1$f,Be=__unplugin_components_0$B;return openBlock(),createElementBlock("div",{class:normalizeClass(["measure-panel property-panel annotation-panel",{closed:!r.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$3C,[createTextVNode(toDisplayString(j.value)+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(ke,{key:0,class:"close-button",onClick:Ie})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$3o,[["circle","polygon","rectangle","square"].includes(Z.value)?(openBlock(),createElementBlock("div",_hoisted_3$34,[createBaseVNode("div",_hoisted_4$1b,toDisplayString(unref(g)("panels.measurement.fillColor")),1),createVNode(Ce,{propertyColor:unref(d).fillColor,noColor:!0,onSetActiveColor:oe[0]||(oe[0]=Ve=>te("fillColor",Ve))},null,8,["propertyColor"])])):createCommentVNode("",!0),["freetext","text"].includes(Z.value)?(openBlock(),createElementBlock("div",_hoisted_5$K,[createBaseVNode("div",_hoisted_6$z,toDisplayString(Z.value==="freetext"?unref(g)("panels.measurement.fontColor"):unref(g)("common.uiElements.color")),1),createVNode(Ce,{propertyColor:unref(d).color,onSetActiveColor:oe[1]||(oe[1]=Ve=>te("color",Ve))},null,8,["propertyColor"])])):createCommentVNode("",!0),["circle","polygon","rectangle","square"].includes(Z.value)?(openBlock(),createElementBlock("div",_hoisted_7$q,[createBaseVNode("div",_hoisted_8$m,toDisplayString(unref(g)("panels.measurement.fillOpacity")),1),createBaseVNode("div",_hoisted_9$k,[createVNode(unref(NSlider),{value:unref(d).fillTransparency,"onUpdate:value":oe[2]||(oe[2]=Ve=>unref(d).fillTransparency=Ve),tooltip:!1,step:1,max:100,min:0,class:"width-slider","on-dragend":H},{thumb:withCtx(()=>[createVNode(Ee)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(x),"onUpdate:value":[oe[3]||(oe[3]=Ve=>isRef(x)?x.value=Ve:x=Ve),re],options:unref(P),to:".measure-panel"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"])])])):createCommentVNode("",!0),["freetext","text","stamp","image"].includes(Z.value)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_10$j,[createBaseVNode("div",_hoisted_11$g,toDisplayString(unref(g)("panels.measurement.lineColor")),1),createVNode(Ce,{propertyColor:unref(d).borderColor,onSetActiveColor:oe[4]||(oe[4]=Ve=>te(["highlight","underline","squiggly","strikeout"].includes(Z.value)?"color":"borderColor",Ve))},null,8,["propertyColor"])])),["arc","curve","highlight","underline","squiggly","strikeout","ink","freetext","text","stamp","image"].includes(Z.value)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_12$f,[createBaseVNode("div",_hoisted_13$f,toDisplayString(unref(g)("panels.measurement.lineStyle")),1),createBaseVNode("div",_hoisted_14$f,[["line","circle","arrow","line","polyline"].includes(Z.value)?(openBlock(),createBlock(unref(NSelect),{key:0,value:unref(d).borderStyle,"onUpdate:value":oe[5]||(oe[5]=Ve=>unref(d).borderStyle=Ve),options:q,to:".measure-panel",class:"line-style","render-label":ve},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value"])):unref(d).measure?(openBlock(),createBlock(unref(NSelect),{key:1,value:unref(d).borderStyle,"onUpdate:value":oe[6]||(oe[6]=Ve=>unref(d).borderStyle=Ve),options:_e,to:".measure-panel",class:"line-style","render-label":ve},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value"])):(openBlock(),createBlock(unref(NSelect),{key:2,value:unref(d).borderStyle,"onUpdate:value":oe[7]||(oe[7]=Ve=>unref(d).borderStyle=Ve),options:Y,to:".measure-panel",class:"line-style","render-label":ve},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value"]))])])),["highlight","underline","squiggly","strikeout","freetext","text","stamp","image"].includes(Z.value)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_15$f,[createBaseVNode("div",_hoisted_16$e,toDisplayString(unref(g)("panels.measurement.lineWidth")),1),createBaseVNode("div",_hoisted_17$d,[createVNode(unref(NSlider),{value:unref(d).borderWidth,"onUpdate:value":oe[8]||(oe[8]=Ve=>unref(d).borderWidth=Ve),tooltip:!1,step:1,max:10,min:1,class:"width-slider","on-dragend":U},{thumb:withCtx(()=>[createVNode(Ee)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(S),"onUpdate:value":[oe[9]||(oe[9]=Ve=>isRef(S)?S.value=Ve:S=Ve),Pe],options:unref(M),to:".measure-panel"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"])])])),["text","stamp","image"].includes(Z.value)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_18$c,[createBaseVNode("div",_hoisted_19$c,toDisplayString(Z.value==="freetext"?unref(g)("common.uiElements.opacity"):unref(d).measure?unref(g)("panels.measurement.lineTextOpacity"):unref(g)("panels.measurement.lineOpacity")),1),createBaseVNode("div",_hoisted_20$c,[createVNode(unref(NSlider),{value:unref(d).opacity,"onUpdate:value":oe[10]||(oe[10]=Ve=>unref(d).opacity=Ve),tooltip:!1,step:1,max:100,min:0,class:"width-slider","on-dragend":X},{thumb:withCtx(()=>[createVNode(Ee)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(y),"onUpdate:value":[oe[11]||(oe[11]=Ve=>isRef(y)?y.value=Ve:y=Ve),Q],options:unref(P),to:".measure-panel"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"])])])),Z.value==="line"?(openBlock(),createElementBlock("div",_hoisted_21$c,[createBaseVNode("div",_hoisted_22$c,toDisplayString(unref(g)("panels.measurement.lineStart"))+" & "+toDisplayString(unref(g)("panels.measurement.lineEnd")),1),createBaseVNode("div",_hoisted_23$a,[createVNode(unref(NSelect),{value:unref(d).head,"onUpdate:value":oe[12]||(oe[12]=Ve=>unref(d).head=Ve),options:ne,to:".measure-panel",class:"font-style-select","render-label":J},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(d).tail,"onUpdate:value":oe[13]||(oe[13]=Ve=>unref(d).tail=Ve),options:ne,to:".measure-panel",class:"font-size-select","render-label":fe},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value"])])])):createCommentVNode("",!0),unref(d).measure?(openBlock(),createElementBlock("div",_hoisted_24$a,[createBaseVNode("div",_hoisted_25$a,toDisplayString(unref(g)("panels.measurement.fontColor")),1),createVNode(Ce,{propertyColor:unref(d).color,onSetActiveColor:oe[14]||(oe[14]=Ve=>te("color",Ve))},null,8,["propertyColor"])])):createCommentVNode("",!0),unref(d).measure||Z.value==="freetext"?(openBlock(),createElementBlock("div",_hoisted_26$a,[createBaseVNode("div",_hoisted_27$9,toDisplayString(unref(g)("panels.measurement.fontStyle")),1),createVNode(unref(NSelect),{value:unref(d).fontName,"onUpdate:value":oe[15]||(oe[15]=Ve=>unref(d).fontName=Ve),options:N.value,to:".measure-panel",class:"text-family"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"]),createBaseVNode("div",_hoisted_28$8,[createVNode(unref(NSelect),{value:unref(d).fontStyle,"onUpdate:value":oe[16]||(oe[16]=Ve=>unref(d).fontStyle=Ve),options:I.value,to:".measure-panel",class:"font-style-select"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"]),createVNode(unref(NSelect),{value:unref(d).fontSize,"onUpdate:value":oe[17]||(oe[17]=Ve=>unref(d).fontSize=Ve),options:unref(F),to:".measure-panel",class:"font-size-select"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_29$7,[createBaseVNode("div",_hoisted_30$7,toDisplayString(unref(g)("panels.measurement.note")),1),withDirectives(createBaseVNode("textarea",{name:"note",rows:"4","onUpdate:modelValue":oe[18]||(oe[18]=Ve=>unref(d).contents=Ve),onBlur:be},null,544),[[vModelText,unref(d).contents]])])])],6)}}},_sfc_main$3_={},_hoisted_1$3B={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3n=createBaseVNode("rect",{width:"14",height:"14",rx:"1",fill:"currentColor"},null,-1),_hoisted_3$33=createBaseVNode("path",{d:"M10.2784 5.27848L5.84653 9.71032L4.20261 8.06642",stroke:"white","stroke-width":"1.5","stroke-linecap":"square"},null,-1),_hoisted_4$1a=[_hoisted_2$3n,_hoisted_3$33];function _sfc_render$2p(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3B,_hoisted_4$1a)}const __unplugin_components_1$c=_export_sfc(_sfc_main$3_,[["render",_sfc_render$2p]]),ColorSeparationPanel_vue_vue_type_style_index_0_scoped_babd6c8f_lang="",_hoisted_1$3A={class:"sidebar-title"},_hoisted_2$3m={class:"container"},_hoisted_3$32={class:"all"},_hoisted_4$19={class:"color-list"},_hoisted_5$J=["onClick"],_hoisted_6$y={class:"name"},_sfc_main$3Z={__name:"ColorSeparationPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=computed(()=>n.isElementOpen("colorSeparationPanel")),r=computed(()=>n.getToolMode),u=ref([]),s=ref(new Set);watch(r,(y,x)=>{y==="separation"?(n.openElement("colorSeparationPanel"),n.closeElement("pageModePanel")):o.value&&(n.closeElement("colorSeparationPanel"),s.value.clear())});const w=y=>{u.value=y};core.addEvent("colorSeparationUpdate",w);const m=y=>{s.value.clear(),y.forEach(x=>s.value.add(x))};core.addEvent("ignoreColorsUpdate",m);const v=()=>{n.closeElement("colorSeparationPanel")},g=async()=>{n.setCommonLoading(!0);const y=s.value.size!==0;u.value.forEach(x=>{y?s.value.delete(x.index):s.value.add(x.index)}),await core.updateViewWithColorIndex(Array.from(s.value)),n.setCommonLoading(!1)},d=async y=>{n.setCommonLoading(!0),s.value.has(y.index)?s.value.delete(y.index):s.value.add(y.index),await core.updateViewWithColorIndex(Array.from(s.value)),n.setCommonLoading(!1)},f=(y,x=220)=>{const P=/rgb\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)/.exec(y);if(!P)return null;const S=parseInt(P[1]),E=parseInt(P[2]),M=parseInt(P[3]);return .299*S+.587*E+.114*M>x};return(y,x)=>{const k=__unplugin_components_14$2,P=__unplugin_components_1$c;return openBlock(),createElementBlock("div",{class:normalizeClass(["color-separation-panel",{closed:!o.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":""})},[createBaseVNode("div",_hoisted_1$3A,[createTextVNode(toDisplayString(y.$t("toolbar.toolbarGroup.separation"))+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(k,{key:0,class:"close-button",onClick:v})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$3m,[createBaseVNode("div",_hoisted_3$32,[createBaseVNode("div",{class:normalizeClass(["check-box",{active:s.value.size===0}]),onClick:g},[withDirectives(createVNode(P,null,null,512),[[vShow,s.value.size===0]])],2),createBaseVNode("span",null,toDisplayString(y.$t("colorSeparation.toggleColor")),1)]),createBaseVNode("div",_hoisted_4$19,[(openBlock(!0),createElementBlock(Fragment,null,renderList(u.value,S=>(openBlock(),createElementBlock("div",{class:"row",key:S.index},[createBaseVNode("div",{class:normalizeClass(["check-box",{active:!s.value.has(S.index),darker:f(S.color)}]),onClick:E=>d(S),style:normalizeStyle({borderColor:S.color,color:S.color})},[withDirectives(createVNode(P,null,null,512),[[vShow,!s.value.has(S.index)]])],14,_hoisted_5$J),createBaseVNode("span",_hoisted_6$y,toDisplayString(S.name),1),createBaseVNode("span",null,toDisplayString(S.intensity||0)+"%",1)]))),128))])])],6)}}},__unplugin_components_10$6=_export_sfc(_sfc_main$3Z,[["__scopeId","data-v-babd6c8f"]]),_sfc_main$3Y={},_hoisted_1$3z={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3l=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.8 12.6V3.29999H11.7561L11.2345 3.85884L11.9655 4.54115L12.3 4.18279V12.6H3.8ZM2.6 13.2V3.29999H0V2.29999H2.6V0.399994H3.8V2.29999H12.8H13.3V2.79999V12.6H16V13.8H13.3V15.6H12.3V13.8H3.2H2.6V13.2ZM14.2055 2.14115L14.7655 1.54115L14.0345 0.858835L13.4745 1.45884L14.2055 2.14115ZM9.72553 6.94115L10.8455 5.74115L10.1145 5.05884L8.99447 6.25883L9.72553 6.94115ZM7.48553 9.34115L8.60553 8.14115L7.87447 7.45883L6.75447 8.65883L7.48553 9.34115ZM5.24553 11.7412L6.36553 10.5412L5.63447 9.85884L4.51447 11.0588L5.24553 11.7412Z",fill:"currentColor"},null,-1),_hoisted_3$31=[_hoisted_2$3l];function _sfc_render$2o(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3z,_hoisted_3$31)}const __unplugin_components_15$1=_export_sfc(_sfc_main$3Y,[["render",_sfc_render$2o]]),_sfc_main$3X={},_hoisted_1$3y={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3k=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.8537 7.17423L8.5001 10.5279L8.5001 1.60001V1.10001H7.5001V1.60001L7.5001 10.5277L4.14666 7.17423L3.7931 6.82068L3.086 7.52778L3.43955 7.88134L7.64664 12.0884C7.8419 12.2837 8.15849 12.2837 8.35375 12.0884L12.5608 7.88134L12.9144 7.52778L12.2073 6.82068L11.8537 7.17423ZM1.6001 13.9H1.1001V14.9H1.6001H14.4001H14.9001V13.9H14.4001H1.6001Z",fill:"currentColor"},null,-1),_hoisted_3$30=[_hoisted_2$3k];function _sfc_render$2n(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3y,_hoisted_3$30)}const __unplugin_components_14$1=_export_sfc(_sfc_main$3X,[["render",_sfc_render$2n]]),_sfc_main$3W={},_hoisted_1$3x={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3j=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0.904297 1.60429H0.404297V2.10429V11.5177V12.0177H0.904297H3.57684V13.2072V14.2072H4.57684H9.59007V13.532L9.59996 12.8L6.91751 11.5177L4.57684 12.9057V5.7938H14.6032V10.1729H15.6032V5.7938V4.7938H14.6032H13.4307V2.10429V1.60429H12.9307H0.904297ZM12.4307 4.7938V2.60429H1.4043V11.0177H3.57684V5.7938V4.7938H4.57684H12.4307ZM11.7263 8.42116C12.1681 8.42116 12.5263 8.06071 12.5263 7.61607C12.5263 7.17143 12.1681 6.81098 11.7263 6.81098C11.2845 6.81098 10.9263 7.17143 10.9263 7.61607C10.9263 8.06071 11.2845 8.42116 11.7263 8.42116ZM12.3683 9.91808L12.0502 9.53231L12.8218 8.89613L13.1399 9.2819L14.3095 10.7004L14.9841 11.5185H13.9237H10.3999H9.89994V10.5185H10.3999H12.8634L12.3683 9.91808ZM12.5638 13.9004L12.8819 14.2861L12.1104 14.9223L11.7923 14.5365L10.6227 13.1181L9.94808 12.3H11.0084H14.5322H15.0322V13.3H14.5322H12.0688L12.5638 13.9004Z",fill:"currentColor"},null,-1),_hoisted_3$2$=[_hoisted_2$3j];function _sfc_render$2m(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3x,_hoisted_3$2$)}const __unplugin_components_13$1=_export_sfc(_sfc_main$3W,[["render",_sfc_render$2m]]),_sfc_main$3V={},_hoisted_1$3w={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3i=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.5 7.5H13.1353H1.5H0.5V6.5V1.60353V0.5L1.5 0.966667L13.3571 6.5L15.5 7.5ZM10.9924 6.5H1.5V2.0702L10.9924 6.5ZM15.5 8.5H0.5V15.5L15.5 8.5Z",fill:"currentColor"},null,-1),_hoisted_3$2_=[_hoisted_2$3i];function _sfc_render$2l(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3w,_hoisted_3$2_)}const __unplugin_components_12$1=_export_sfc(_sfc_main$3V,[["render",_sfc_render$2l]]),_sfc_main$3U={},_hoisted_1$3v={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3h=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.52941 14.5H0L7.52941 1.5V14.5ZM9.47059 13.5H14.2652L9.47059 5.2218V13.5ZM16 14.5H14.8444H9.47059H8.47059V13.5V3.49524V1.5L9.47059 3.22656L15.4208 13.5L16 14.5Z",fill:"currentColor"},null,-1),_hoisted_3$2Z=[_hoisted_2$3h];function _sfc_render$2k(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3v,_hoisted_3$2Z)}const __unplugin_components_11$2=_export_sfc(_sfc_main$3U,[["render",_sfc_render$2k]]),_sfc_main$3T={},_hoisted_1$3u={width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3g=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.35355 2.26779L9.70711 2.62134L9.35355 2.97489L7.23223 5.09621L6.52513 4.38911L7.86416 3.05007L7.55768 3.0735C4.69176 3.52528 2.5 6.00714 2.5 9C2.5 12.3137 5.18629 15 8.5 15C11.8137 15 14.5 12.3137 14.5 9C14.5 7.01498 13.5366 5.25507 12.0496 4.16209L12.6419 3.35635C14.3741 4.62964 15.5 6.68338 15.5 9C15.5 12.866 12.366 16 8.5 16C4.63401 16 1.5 12.866 1.5 9C1.5 5.49977 4.06855 2.60038 7.4237 2.08231C7.52022 2.0674 7.61737 2.05447 7.71511 2.04356L6.52513 0.853572L7.23223 0.146465L9.35355 2.26779Z",fill:"currentColor"},null,-1),_hoisted_3$2Y=[_hoisted_2$3g];function _sfc_render$2j(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3u,_hoisted_3$2Y)}const __unplugin_components_10$5=_export_sfc(_sfc_main$3T,[["render",_sfc_render$2j]]),_sfc_main$3S={},_hoisted_1$3t={width:"14",height:"16",viewBox:"0 0 14 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3f=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.14645 2.26779L5.79289 2.62134L6.14645 2.97489L8.26777 5.09621L8.97487 4.38911L7.63584 3.05007L7.94232 3.0735C10.8082 3.52528 13 6.00714 13 9C13 12.3137 10.3137 15 7 15C3.68629 15 1 12.3137 1 9C1 7.01498 1.96344 5.25507 3.45037 4.16209L2.85811 3.35635C1.12586 4.62964 0 6.68338 0 9C0 12.866 3.13401 16 7 16C10.866 16 14 12.866 14 9C14 5.49977 11.4314 2.60038 8.0763 2.08231C7.97978 2.0674 7.88263 2.05447 7.78489 2.04356L8.97487 0.853572L8.26777 0.146465L6.14645 2.26779Z",fill:"currentColor"},null,-1),_hoisted_3$2X=[_hoisted_2$3f];function _sfc_render$2i(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3t,_hoisted_3$2X)}const __unplugin_components_9$4=_export_sfc(_sfc_main$3S,[["render",_sfc_render$2i]]),_sfc_main$3R={},_hoisted_1$3s={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3e=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.0315 11.1503L10.609 2.59406H9.39038L5.96788 11.1503H5.09998V12.0253H7.89998V11.1503H7.38147L8.08144 9.4003H11.9179L12.6179 11.1503H12.1V12.0253H14.9V11.1503H14.0315ZM11.568 8.5253L9.99969 4.60441L8.43142 8.5253H11.568Z",fill:"currentColor"},null,-1),_hoisted_3$2W=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.499 17.406L1.80957 14.7147L4.50088 12.0253L5.26929 12.7942L3.8888 14.1737L16.1078 14.1703L14.7306 12.7942L15.499 12.0252L18.1903 14.7146L15.5009 17.4059L14.732 16.6375L16.1106 15.2574L3.89264 15.2607L5.26795 16.6376L4.499 17.406Z",fill:"currentColor"},null,-1),_hoisted_4$18=[_hoisted_2$3e,_hoisted_3$2W];function _sfc_render$2h(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3s,_hoisted_4$18)}const __unplugin_components_8$6=_export_sfc(_sfc_main$3R,[["render",_sfc_render$2h]]),_sfc_main$3Q={},_hoisted_1$3r={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3d=createStaticVNode('<path fill-rule="evenodd" clip-rule="evenodd" d="M2.55957 5.99906L5.25088 3.30963L7.94031 6.00094L7.17136 6.76935L5.79198 5.38893L5.79519 14.6079L7.17142 13.2307L7.94037 13.9991L5.25094 16.6904L2.55963 14.001L3.32804 13.232L4.70812 14.6105L4.7049 5.39264L3.32798 6.76801L2.55957 5.99906Z" fill="currentColor"></path><rect x="9.44043" y="4.5" width="8" height="1.5" fill="currentColor"></rect><rect x="9.44043" y="7" width="8" height="1.5" fill="currentColor"></rect><rect x="9.44043" y="11.5" width="8" height="1.5" fill="currentColor"></rect><rect x="9.44043" y="14" width="8" height="1.5" fill="currentColor"></rect>',5),_hoisted_7$p=[_hoisted_2$3d];function _sfc_render$2g(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3r,_hoisted_7$p)}const __unplugin_components_7$7=_export_sfc(_sfc_main$3Q,[["render",_sfc_render$2g]]),_sfc_main$3P={},_hoisted_1$3q={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3c=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.55957 5.99906L5.25088 3.30963L7.94031 6.00094L7.17136 6.76935L5.79198 5.38893L5.79519 14.6079L7.17142 13.2307L7.94037 13.9991L5.25094 16.6904L2.55963 14.001L3.32804 13.232L4.70812 14.6105L4.7049 5.39264L3.32798 6.76801L2.55957 5.99906Z",fill:"currentColor"},null,-1),_hoisted_3$2V=createBaseVNode("rect",{x:"9.44043",y:"4.75",width:"8",height:"1.5",fill:"currentColor"},null,-1),_hoisted_4$17=createBaseVNode("rect",{x:"9.44043",y:"9.25",width:"8",height:"1.5",fill:"currentColor"},null,-1),_hoisted_5$I=createBaseVNode("rect",{x:"9.44043",y:"13.75",width:"8",height:"1.5",fill:"currentColor"},null,-1),_hoisted_6$x=[_hoisted_2$3c,_hoisted_3$2V,_hoisted_4$17,_hoisted_5$I];function _sfc_render$2f(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3q,_hoisted_6$x)}const __unplugin_components_6$9=_export_sfc(_sfc_main$3P,[["render",_sfc_render$2f]]),ContentEditorPanel_vue_vue_type_style_index_0_lang="",ContentEditorPanel_vue_vue_type_style_index_1_lang="",_hoisted_1$3p={class:"sidebar-title"},_hoisted_2$3b={class:"edit-container"},_hoisted_3$2U={class:"color"},_hoisted_4$16={class:"color-title subtitle"},_hoisted_5$H={class:"colors-container"},_hoisted_6$w={class:"cell-container"},_hoisted_7$o=createBaseVNode("span",{class:"cell red"},null,-1),_hoisted_8$l=[_hoisted_7$o],_hoisted_9$j={class:"cell-container"},_hoisted_10$i=createBaseVNode("span",{class:"cell yellow"},null,-1),_hoisted_11$f=[_hoisted_10$i],_hoisted_12$e={class:"cell-container"},_hoisted_13$e=createBaseVNode("span",{class:"cell blue"},null,-1),_hoisted_14$e=[_hoisted_13$e],_hoisted_15$e={class:"cell-container"},_hoisted_16$d=createBaseVNode("span",{class:"cell",style:{background:"rgb(255, 246, 179)"}},null,-1),_hoisted_17$c=[_hoisted_16$d],_hoisted_18$b={class:"cell-container"},_hoisted_19$b=createBaseVNode("span",{class:"cell",style:{background:"rgb(254, 191, 191)"}},null,-1),_hoisted_20$b=[_hoisted_19$b],_hoisted_21$b={class:"cell-container"},_hoisted_22$b=createBaseVNode("span",{class:"cell",style:{background:"rgb(100, 188, 56)"}},null,-1),_hoisted_23$9=[_hoisted_22$b],_hoisted_24$9={class:"color-picker"},_hoisted_25$9=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_26$9={class:"opacity"},_hoisted_27$8={class:"opacity-title subtitle"},_hoisted_28$7={class:"tool"},_hoisted_29$6={class:"text"},_hoisted_30$6={class:"text-title subtitle"},_hoisted_31$6={class:"content-block"},_hoisted_32$5={class:"text-align"},_hoisted_33$4={class:"spacing"},_hoisted_34$4={class:"spacing-title"},_hoisted_35$4={class:"block"},_hoisted_36$3=createBaseVNode("div",{class:"arrow down"},null,-1),_hoisted_37$3=createBaseVNode("div",{class:"arrow up"},null,-1),_hoisted_38$3=createBaseVNode("div",{class:"arrow down"},null,-1),_hoisted_39$3=createBaseVNode("div",{class:"arrow up"},null,-1),_hoisted_40$3=createBaseVNode("div",{class:"arrow down"},null,-1),_hoisted_41$3=createBaseVNode("div",{class:"arrow up"},null,-1),_hoisted_42$2={class:"edit-container"},_hoisted_43$2={class:"overview"},_hoisted_44$2=["src"],_hoisted_45$2={class:"rotate"},_hoisted_46$2={class:"subtitle"},_hoisted_47$2={class:"buttons"},_hoisted_48$2=["title"],_hoisted_49$2=["title"],_hoisted_50$2={class:"flips"},_hoisted_51$2={class:"subtitle"},_hoisted_52$2={class:"buttons"},_hoisted_53$1=["title"],_hoisted_54$1=["title"],_hoisted_55$1={class:"opacity"},_hoisted_56$1={class:"opacity-title subtitle"},_hoisted_57$1={class:"tool"},_hoisted_58$2={class:"tools"},_hoisted_59$2={class:"subtitle"},_hoisted_60$2={class:"buttons"},_hoisted_61$2=["title"],_hoisted_62$2=["title"],_hoisted_63$2=["title"],_sfc_main$3O={__name:"ContentEditorPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=computed(()=>n.isElementOpen("contentEditorPanel")),r=computed(()=>n.getContentEditorType);computed(()=>n.getRightPanelButtonDisabled);const u=computed(()=>n.getCustomFonts),w=getCurrentInstance().appContext.app.config.globalProperties.$t;let m=reactive({color:"rgb(0, 0, 0)",opacity:100,fontFamily:"Helvetica",fontStyle:0,alignType:2,fontSize:14,lineSpacing:1,paragraphSpacing:0,characterSpacing:0}),v=ref("100%");const d=[25,50,75,100].map(fe=>({label:`${fe}%`,value:`${fe}%`,class:"edit-select"})),f=fe=>{const Z=fe.fontFamily;n.setCustomFonts(Z)};core.addEvent("LoadFont",f),watch(()=>u.value,(fe,Z)=>{x.value=y(fe)},{deep:!0});const y=fe=>{if(fe.length)return fe.map(Z=>({label:Z.fontFamily,value:Z.fontName,class:"edit-select"}))},x=ref([]);x.value=y(u.value);const k=computed(()=>[{label:w("common.fontStyles.regular"),value:0,class:"edit-select"},{label:w("common.fontStyles.bold"),value:1,class:"edit-select"},{label:w("common.fontStyles.boldOblique"),value:3,class:"edit-select"},{label:w("common.fontStyles.oblique"),value:2,class:"edit-select"}]),P=[12,14,16,20,24,28],S=P.map(fe=>({label:`${fe} pt`,value:fe,class:"edit-select"})),E=ref(""),M=ref("rgb(0, 0, 0)");watch(()=>o.value,(fe,Z)=>{fe&&n.closeElement("pageModePanel")});const T=()=>{core.setContentEditorProperty(r.value,{opacity:m.opacity})};watch(()=>m.fontFamily,(fe,Z)=>{core.setContentEditorProperty(r.value,{fontFamily:fe})}),watch(()=>m.fontStyle,(fe,Z)=>{core.setContentEditorProperty(r.value,{fontStyle:fe})}),watch(()=>m.opacity,(fe,Z)=>{v.value=fe+"%"}),watch(()=>m.fontSize,(fe,Z)=>{typeof fe=="number"&&core.setContentEditorProperty(r.value,{fontSize:m.fontSize})});const D=fe=>{m.color=fe,core.setContentEditorProperty(r.value,{color:fe})},N=()=>{m.opacity=Number.isNaN(Number.parseInt(v.value))?100:Number.parseInt(v.value),core.setContentEditorProperty(r.value,{opacity:m.opacity})},I=fe=>{m.alignType=fe,core.setContentEditorProperty(r.value,{alignType:m.alignType})},O=fe=>{fe!==null&&(m.lineSpacing=Math.round(fe*2)/2,core.setContentEditorProperty(r.value,{lineSpacing:m.lineSpacing}))},F=fe=>{fe!==null&&(m.paragraphSpacing=Math.round(fe*2)/2,core.setContentEditorProperty(r.value,{paragraphSpacing:m.paragraphSpacing}))},q=fe=>{fe!==null&&(m.characterSpacing=Math.round(fe*2)/2,core.setContentEditorProperty(r.value,{characterSpacing:m.characterSpacing}))},Y=fe=>{for(const Z in fe){Z==="type"&&n.setContentEditorType(fe[Z]),Z==="isOpen"&&(fe.isOpen?n.openElement("contentEditorPanel"):n.closeElement("contentEditorPanel")),Z==="imageUrl"&&(E.value=fe[Z]);for(const j in m)Z===j&&(m[j]=fe[Z],Z==="fontSize"&&!P.includes(fe.fontSize)&&(m.fontSize=fe.fontSize+" pt"),Z==="color"&&(M.value=fe.color))}};core.addEvent("contentPropertyChange",Y);const _e=(fe,Z)=>{core.setContentEditorProperty(r.value,{[fe]:Z})},ne=fe=>{areColorsSimilar(fe,m.color)||D(fe)},ve=fe=>{M.value=fe},J=()=>{n.closeElement("contentEditorPanel")};return(fe,Z)=>{const j=__unplugin_components_14$2,X=__unplugin_components_1$f,H=__unplugin_components_0$B,U=__unplugin_components_6$a,te=__unplugin_components_4$f,Q=__unplugin_components_7$8,re=__unplugin_components_6$9,Pe=__unplugin_components_7$7,be=__unplugin_components_8$6,we=__unplugin_components_9$4,Ae=__unplugin_components_10$5,$e=__unplugin_components_11$2,Me=__unplugin_components_12$1,Ie=__unplugin_components_13$1,Le=__unplugin_components_14$1,le=__unplugin_components_15$1;return openBlock(),createElementBlock("div",{class:normalizeClass(["editor-panel property-panel",{closed:!o.value,mobile:unref(isMobileDevice)}]),id:"editorPanel",style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$3p,[createTextVNode(toDisplayString(r.value==="text"?unref(w)("contentEditor.textProperties.title"):unref(w)("contentEditor.imageProperties.title"))+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(j,{key:0,class:"close-button",onClick:J})):createCommentVNode("",!0)]),withDirectives(createBaseVNode("div",_hoisted_2$3b,[createBaseVNode("div",_hoisted_3$2U,[createBaseVNode("div",_hoisted_4$16,toDisplayString(unref(w)("contentEditor.textProperties.fontColor")),1),createBaseVNode("div",_hoisted_5$H,[createBaseVNode("span",_hoisted_6$w,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(255, 0, 0)")}]),onClick:Z[0]||(Z[0]=oe=>D("rgb(255, 0, 0)"))},_hoisted_8$l,2)]),createBaseVNode("span",_hoisted_9$j,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(255, 236, 102)")}]),onClick:Z[1]||(Z[1]=oe=>D("rgb(255, 236, 102)"))},_hoisted_11$f,2)]),createBaseVNode("span",_hoisted_12$e,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(45, 119, 250)")}]),onClick:Z[2]||(Z[2]=oe=>D("rgb(45, 119, 250)"))},_hoisted_14$e,2)]),unref(isMobileDevice)?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",_hoisted_15$e,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(255, 246, 179)")}]),onClick:Z[3]||(Z[3]=oe=>D("rgb(255, 246, 179)"))},_hoisted_17$c,2)]),createBaseVNode("span",_hoisted_18$b,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(254, 191, 191)")}]),onClick:Z[4]||(Z[4]=oe=>D("rgb(254, 191, 191)"))},_hoisted_20$b,2)]),createBaseVNode("span",_hoisted_21$b,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(m).color,"rgb(100, 188, 56)")}]),onClick:Z[5]||(Z[5]=oe=>D("rgb(100, 188, 56)"))},_hoisted_23$9,2)])],64)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_24$9,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:M.value})},null,4),createVNode(unref(NColorPicker),{to:"#editorPanel",onComplete:ne,"onUpdate:value":ve,value:M.value,"show-alpha":!1},{label:withCtx(()=>[_hoisted_25$9]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_26$9,[createBaseVNode("div",_hoisted_27$8,toDisplayString(unref(w)("common.uiElements.opacity")),1),createBaseVNode("div",_hoisted_28$7,[createVNode(unref(NSlider),{value:unref(m).opacity,"onUpdate:value":Z[6]||(Z[6]=oe=>unref(m).opacity=oe),tooltip:!1,step:1,max:100,min:0,class:"width-slider","on-dragend":T},{thumb:withCtx(()=>[createVNode(X)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(v),"onUpdate:value":[Z[7]||(Z[7]=oe=>isRef(v)?v.value=oe:v=oe),N],options:unref(d),to:"#editorPanel"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"])])]),createBaseVNode("div",_hoisted_29$6,[createBaseVNode("div",_hoisted_30$6,toDisplayString(unref(w)("common.uiElements.font")),1),createVNode(unref(NSelect),{value:unref(m).fontFamily,"onUpdate:value":Z[8]||(Z[8]=oe=>unref(m).fontFamily=oe),options:x.value,to:"#editorPanel",class:"text-family"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"]),createBaseVNode("div",_hoisted_31$6,[createVNode(unref(NSelect),{value:unref(m).fontStyle,"onUpdate:value":Z[9]||(Z[9]=oe=>unref(m).fontStyle=oe),options:k.value,to:"#editorPanel",class:"font-style-select"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"]),createVNode(unref(NSelect),{value:unref(m).fontSize,"onUpdate:value":Z[10]||(Z[10]=oe=>unref(m).fontSize=oe),options:unref(S),to:"#editorPanel",class:"font-size-select"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"])]),createBaseVNode("div",_hoisted_32$5,[createBaseVNode("div",{class:normalizeClass({active:unref(m).alignType===2}),onClick:Z[11]||(Z[11]=oe=>I(2))},[createBaseVNode("span",{class:normalizeClass({border:unref(m).alignType===3})},[createVNode(U)],2)],2),createBaseVNode("div",{class:normalizeClass({active:unref(m).alignType===5}),onClick:Z[12]||(Z[12]=oe=>I(5))},[createBaseVNode("span",{class:normalizeClass({border:unref(m).alignType===2})},[createVNode(te)],2)],2),createBaseVNode("div",{class:normalizeClass({active:unref(m).alignType===3}),onClick:Z[13]||(Z[13]=oe=>I(3))},[createBaseVNode("span",null,[createVNode(Q)])],2)])]),createBaseVNode("div",_hoisted_33$4,[createBaseVNode("div",_hoisted_34$4,toDisplayString(unref(w)("contentEditor.textProperties.spacing")),1),createBaseVNode("div",_hoisted_35$4,[createBaseVNode("div",null,[createVNode(re),createVNode(unref(NInputNumber),{value:unref(m).lineSpacing,"onUpdate:value":[Z[14]||(Z[14]=oe=>unref(m).lineSpacing=oe),O],placeholder:unref(w)("contentEditor.textProperties.lineSpacing"),min:"1",max:"10",step:.5,"update-value-on-input":!1},{"minus-icon":withCtx(()=>[_hoisted_36$3]),"add-icon":withCtx(()=>[_hoisted_37$3]),_:1},8,["value","placeholder"])]),createBaseVNode("div",null,[createVNode(Pe),createVNode(unref(NInputNumber),{value:unref(m).paragraphSpacing,"onUpdate:value":[Z[15]||(Z[15]=oe=>unref(m).paragraphSpacing=oe),F],placeholder:unref(w)("contentEditor.textProperties.paragraphSpacing"),min:"0",max:"10",step:.5,"update-value-on-input":!1},{"minus-icon":withCtx(()=>[_hoisted_38$3]),"add-icon":withCtx(()=>[_hoisted_39$3]),_:1},8,["value","placeholder"])]),createBaseVNode("div",null,[createVNode(be),createVNode(unref(NInputNumber),{value:unref(m).characterSpacing,"onUpdate:value":[Z[16]||(Z[16]=oe=>unref(m).characterSpacing=oe),q],placeholder:unref(w)("contentEditor.textProperties.characterSpacing"),min:"0",max:"10",step:.5,"update-value-on-input":!1},{"minus-icon":withCtx(()=>[_hoisted_40$3]),"add-icon":withCtx(()=>[_hoisted_41$3]),_:1},8,["value","placeholder"])])])])],512),[[vShow,r.value==="text"]]),withDirectives(createBaseVNode("div",_hoisted_42$2,[createBaseVNode("div",_hoisted_43$2,[withDirectives(createBaseVNode("img",{src:E.value},null,8,_hoisted_44$2),[[vShow,E.value]])]),createBaseVNode("div",_hoisted_45$2,[createBaseVNode("div",_hoisted_46$2,toDisplayString(unref(w)("contentEditor.imageProperties.rotate")),1),createBaseVNode("div",_hoisted_47$2,[createBaseVNode("div",{onClick:Z[17]||(Z[17]=oe=>_e("rotate","90")),title:unref(w)("contentEditor.imageProperties.rotateLeft")},[createVNode(we),createTextVNode(toDisplayString(unref(w)("contentEditor.imageProperties.rotateLeft")),1)],8,_hoisted_48$2),createBaseVNode("div",{onClick:Z[18]||(Z[18]=oe=>_e("rotate","-90")),title:unref(w)("contentEditor.imageProperties.rotateRight")},[createVNode(Ae),createTextVNode(toDisplayString(unref(w)("contentEditor.imageProperties.rotateRight")),1)],8,_hoisted_49$2)])]),createBaseVNode("div",_hoisted_50$2,[createBaseVNode("div",_hoisted_51$2,toDisplayString(unref(w)("contentEditor.imageProperties.flip")),1),createBaseVNode("div",_hoisted_52$2,[createBaseVNode("div",{onClick:Z[19]||(Z[19]=oe=>_e("flip","x")),title:unref(w)("contentEditor.imageProperties.flipHorizontal")},[createBaseVNode("span",null,[createVNode($e)])],8,_hoisted_53$1),createBaseVNode("div",{onClick:Z[20]||(Z[20]=oe=>_e("flip","y")),title:unref(w)("contentEditor.imageProperties.flipVertical")},[createBaseVNode("span",null,[createVNode(Me)])],8,_hoisted_54$1)])]),createBaseVNode("div",_hoisted_55$1,[createBaseVNode("div",_hoisted_56$1,toDisplayString(unref(w)("common.uiElements.opacity")),1),createBaseVNode("div",_hoisted_57$1,[createVNode(unref(NSlider),{value:unref(m).opacity,"onUpdate:value":Z[21]||(Z[21]=oe=>unref(m).opacity=oe),tooltip:!1,step:1,max:100,min:0,"on-dragend":T,class:"width-slider"},{thumb:withCtx(()=>[createVNode(X)]),_:1},8,["value"]),createVNode(unref(NSelect),{value:unref(v),"onUpdate:value":[Z[22]||(Z[22]=oe=>isRef(v)?v.value=oe:v=oe),N],options:unref(d),to:"#editorPanel"},{arrow:withCtx(()=>[createVNode(H)]),_:1},8,["value","options"])])]),createBaseVNode("div",_hoisted_58$2,[createBaseVNode("div",_hoisted_59$2,toDisplayString(unref(w)("contentEditor.imageProperties.tools")),1),createBaseVNode("div",_hoisted_60$2,[createBaseVNode("div",{onClick:Z[23]||(Z[23]=oe=>_e("tool","replace")),title:unref(w)("contentEditor.imageProperties.replace")},[createBaseVNode("span",null,[createVNode(Ie)])],8,_hoisted_61$2),createBaseVNode("div",{onClick:Z[24]||(Z[24]=oe=>_e("tool","export")),title:unref(w)("contentEditor.imageProperties.export")},[createBaseVNode("span",null,[createVNode(Le)])],8,_hoisted_62$2),createBaseVNode("div",{onClick:Z[25]||(Z[25]=oe=>_e("tool","crop")),title:unref(w)("contentEditor.imageProperties.crop")},[createBaseVNode("span",null,[createVNode(le)])],8,_hoisted_63$2)])])],512),[[vShow,r.value==="image"]])],6)}}},_sfc_main$3N={},_hoisted_1$3o={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3a=createBaseVNode("g",{id:"btn / close"},[createBaseVNode("circle",{id:"Ellipse 2704",cx:"8",cy:"8",r:"7",fill:"#999999"}),createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.07107 7.29289L4.88909 4.11091L4.18198 4.81802L7.36396 8L4.18198 11.182L4.88909 11.8891L8.07107 8.70711L11.253 11.8891L11.9602 11.182L8.77817 8L11.9602 4.81802L11.253 4.11091L8.07107 7.29289Z",fill:"white"})],-1),_hoisted_3$2T=[_hoisted_2$3a];function _sfc_render$2e(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3o,_hoisted_3$2T)}const __unplugin_components_0$x=_export_sfc(_sfc_main$3N,[["render",_sfc_render$2e]]),LinkPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$3n={class:"sidebar-title"},_hoisted_2$39={class:"sidebar-tabs-header"},_hoisted_3$2S={class:"sidebar-content"},_hoisted_4$15=["placeholder"],_sfc_main$3M={__name:"LinkPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=useDocumentStore(),r=ref("URL"),u=computed(()=>n.isElementOpen("linkPanel")),s=computed(()=>o.getActiveTool);computed(()=>n.getCurrentPage);const w=computed(()=>o.getTotalPages);let m=ref(""),v=ref(""),g=ref("");watch(()=>s.value,(M,T)=>{M!=="link"&&n.closeElement("linkPanel")}),watch(()=>u.value,(M,T)=>{M&&(n.closeElement("pageModePanel"),r.value=m.value?"URL":v.value?"PAGE":g.value?"EMAIL":"URL")}),watch(()=>v.value,(M,T)=>{const D=/^\d+$/;M!==""&&(M>w.value||M<=0||!D.test(M))&&(v.value=T)});const d=M=>{r.value=M},f=()=>r.value==="URL"&&x(m.value)||r.value==="PAGE"&&v.value||r.value==="EMAIL"&&y(g.value),y=M=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(M),x=M=>/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(M),k=()=>{if(r.value==="URL")o.setPropertyPanel({destPage:"",url:m.value});else if(r.value==="PAGE")o.setPropertyPanel({url:"",destPage:v.value});else if(r.value==="EMAIL"){const M=g.value.startsWith("mailto:");o.setPropertyPanel({destPage:"",url:M?g.value:"mailto:"+g.value})}n.closeElement("linkPanel")},P=M=>{M?(M.url&&M.url.startsWith("mailto:")?(g.value=M.url.replace("mailto:",""),m.value="",v.value="",r.value="email"):M.url?(m.value=M.url,g.value="",v.value="",r.value="URL"):M.destPage?(v.value=M.destPage,m.value="",g.value="",r.value="PAGE"):(v.value="",m.value="",g.value="",r.value="URL"),n.openElement("linkPanel")):n.closeElement("linkPanel")};core.addEvent("linkPanelChange",P);const S=()=>{r.value==="URL"?m.value="":r.value==="PAGE"?v.value="":r.value==="EMAIL"&&(g.value="")},E=()=>{n.closeElement("linkPanel")};return(M,T)=>{const D=__unplugin_components_14$2,N=_sfc_main$4C,I=__unplugin_components_0$x;return openBlock(),createElementBlock("div",{class:normalizeClass(["link-panel",{closed:!u.value,mobile:unref(isMobileDevice)}]),id:"linkPanel",style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$3n,[createTextVNode(toDisplayString(M.$t("panels.link.title"))+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(D,{key:0,class:"close-button",onClick:E})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$39,[createVNode(N,{className:r.value==="URL"?"active":"",isActive:r.value==="URL","data-element":"URL",onClick:T[0]||(T[0]=O=>d("URL"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(M.$t("panels.link.types.url")),1)]),_:1},8,["className","isActive"]),createVNode(N,{className:r.value==="PAGE"?"active":"",isActive:r.value==="PAGE","data-element":"PAGE",onClick:T[1]||(T[1]=O=>d("PAGE"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(M.$t("panels.link.types.pages")),1)]),_:1},8,["className","isActive"]),createVNode(N,{className:r.value==="EMAIL"?"active":"",isActive:r.value==="EMAIL","data-element":"EMAIL",onClick:T[2]||(T[2]=O=>d("EMAIL"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(M.$t("panels.link.types.email")),1)]),_:1},8,["className","isActive"])]),createBaseVNode("div",_hoisted_3$2S,[createBaseVNode("div",{class:normalizeClass(["input-container",{hidden:r.value!=="URL"}])},[withDirectives(createBaseVNode("input",{type:"text",placeholder:"https://www.example.com","onUpdate:modelValue":T[3]||(T[3]=O=>isRef(m)?m.value=O:m=O),name:"link"},null,512),[[vModelText,unref(m)]]),withDirectives(createVNode(I,{onClick:S},null,512),[[vShow,unref(m)]])],2),createBaseVNode("div",{class:normalizeClass(["input-container",{hidden:r.value!=="PAGE"}])},[withDirectives(createBaseVNode("input",{type:"text",pattern:"\\d*",placeholder:`1~${w.value}`,"onUpdate:modelValue":T[4]||(T[4]=O=>isRef(v)?v.value=O:v=O),onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",name:"link"},null,8,_hoisted_4$15),[[vModelText,unref(v)]]),withDirectives(createVNode(I,{onClick:S},null,512),[[vShow,unref(v)]])],2),createBaseVNode("div",{class:normalizeClass(["input-container",{hidden:r.value!=="EMAIL"}])},[withDirectives(createBaseVNode("input",{type:"text",placeholder:"support@compdf.com","onUpdate:modelValue":T[5]||(T[5]=O=>isRef(g)?g.value=O:g=O),name:"link"},null,512),[[vModelText,unref(g)]]),withDirectives(createVNode(I,{onClick:S},null,512),[[vShow,unref(g)]])],2),createBaseVNode("div",{class:normalizeClass(["save rect-button blue",{disabled:!f()}]),onClick:k},toDisplayString(M.$t("panels.link.action")),3)])],6)}}},_imports_0$1=""+new URL("../images/stamp/Approved.png",import.meta.url).href,_imports_1=""+new URL("../images/stamp/NotApproved.png",import.meta.url).href,_imports_2=""+new URL("../images/stamp/Completed.png",import.meta.url).href,_imports_3=""+new URL("../images/stamp/Final.png",import.meta.url).href,_imports_4=""+new URL("../images/stamp/Draft.png",import.meta.url).href,_imports_5=""+new URL("../images/stamp/Confidential.png",import.meta.url).href,_imports_6=""+new URL("../images/stamp/ForPublicRelease.png",import.meta.url).href,_imports_7=""+new URL("../images/stamp/NotForPublicRelease.png",import.meta.url).href,_imports_8=""+new URL("../images/stamp/ForComment.png",import.meta.url).href,_imports_9=""+new URL("../images/stamp/Void.png",import.meta.url).href,_imports_10=""+new URL("../images/stamp/PreliminaryResults.png",import.meta.url).href,_imports_11=""+new URL("../images/stamp/InformationOnly.png",import.meta.url).href,_imports_12=""+new URL("../images/stamp/Witness.png",import.meta.url).href,_imports_13=""+new URL("../images/stamp/InitialHere.png",import.meta.url).href,_imports_14=""+new URL("../images/stamp/SignHere.png",import.meta.url).href,_imports_15=""+new URL("../images/stamp/revised.png",import.meta.url).href;class renderStampPreview{updateStampPreview({imgSrc:n,width:o,height:r,stampType:u,contents:s,stampColor:w,time:m}){this.width=o,this.height=r,this.imgSrc=n,this.stampType=u,this.contents=s,this.stampColor=w,this.time=m;const v=this.stampPreviewElement||document.createElement("div");v.innerHTML="",v.className="stamp-preview",this.applyStyles(v,{position:"absolute",border:"1px solid #00A4E4","z-index":85,"pointer-events":"none",left:"-9999px",top:"-9999px",width:o+"px",height:r+"px"}),document.body.appendChild(v);const g=document.createElement("img");this.applyStyles(g,{width:"100%",height:"100%"}),g.src=n,v.appendChild(g);const d=document.querySelector(".document");d.addEventListener("mousemove",this.handleMouseMove.bind(this,v)),d.addEventListener("mouseleave",()=>{v.style.left="-9999px",v.style.top="-9999px"}),this.stampPreviewElement=v}handleMouseMove(n,o){const r=n.getBoundingClientRect();this.applyStyles(n,{left:o.clientX-r.width/2+"px",top:o.clientY-r.height/2+"px"})}handleMouseLeave(n){this.applyStyles(n,{left:-9999,top:-9999})}hidePreview(){const n=this.stampPreviewElement||document.querySelector(".stamp-preview");n&&(n.style.display="none",n.remove(),this.stampPreviewElement=null,this.width=null,this.height=null,this.imgSrc=null,this.stampType=null,this.contents=null,this.stampColor=null,this.time=null)}applyStyles(n,o){Object.keys(o).forEach(r=>{n.style[r]=o[r]})}}const StampPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$3m={class:"sidebar-title"},_hoisted_2$38={class:"sidebar-tabs-header"},_hoisted_3$2R={class:"sidebar-content"},_hoisted_4$14={class:"block"},_hoisted_5$G={class:"block"},_hoisted_6$v={class:"block"},_hoisted_7$n={class:"block"},_hoisted_8$k={class:"block"},_hoisted_9$i={class:"block"},_hoisted_10$h={class:"block"},_hoisted_11$e={class:"block"},_hoisted_12$d={class:"block"},_hoisted_13$d={class:"block"},_hoisted_14$d={class:"block"},_hoisted_15$d={class:"block"},_hoisted_16$c={class:"block"},_hoisted_17$b={class:"block"},_hoisted_18$a={class:"block"},_hoisted_19$a={class:"block"},_hoisted_20$a={class:"dynamic-stamp red"},_hoisted_21$a=createBaseVNode("p",{class:"title"},"REVISED",-1),_hoisted_22$a={class:"dynamic-stamp green"},_hoisted_23$8=createBaseVNode("p",{class:"title"},"REVIEWED",-1),_hoisted_24$8={key:0,class:"empty-list"},_hoisted_25$8=["src"],_hoisted_26$8={class:"create-container"},_hoisted_27$7={key:0,class:"delete-page-popup"},_sfc_main$3L={__name:"StampPanel",props:["isHeaderDisabled"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useViewerStore(),u=useDocumentStore(),s=ref(!1),w=ref(0),m=ref(null),v=computed(()=>r.getActiveElementTab("stampPanel")),g=computed(()=>r.isElementOpen("stampPanel")),d=computed(()=>u.getActiveTool),f=computed(()=>r.getCustomStamps),y=ref(""),x=new renderStampPreview,k=()=>{r.openElement("createCustomStampDialog")};onMounted(()=>{M(),setInterval(M,1e3);const q=document.querySelector(".document-container");q&&q.addEventListener("click",S)}),watch(f.value,()=>{f.value.length&&m.value.scrollTo({top:0,behavior:"smooth"})});const P=q=>{const Y=core.getScrollViewElement();if(!Y)return;const _e=Y.scrollLeft||0,ne=Y.scrollTop||0,{pageX:ve,pageY:J}=q;return{x:ve+_e,y:J+ne}},S=q=>{const Y=P(q),ne=core.getSelectedPage(Y,Y).first;if(ne<1)return;const ve=core.windowToPage(Y,ne);if(x.stampPreviewElement){const{width:J,height:fe}=x,Z={stampType:x.stampType,page:ne,rect:{x:ve.x-J/2,y:ve.y-fe/2,width:J,height:fe}};x.stampType==="dynamic"?(Z.stampColor=x.stampColor,Z.stampShape=0,Z.contents=x.contents,Z.time=y.value):x.stampType==="image"?Z.imageBase64=x.imgSrc:Z.contents=x.contents,core.handleStamp(Z),x.hidePreview(),window.innerWidth<=640&&(u.setToolState("stamp"),r.toggleActiveHand(!1),n(0),o(0),r.closeElement("stampPanel"))}};watch(()=>d.value,(q,Y)=>{q!=="stamp"&&r.closeElement("stampPanel")}),watch(()=>g.value,(q,Y)=>{q&&E("STANDARD")});const E=q=>{r.setActiveElementTab("stampPanel",q)},M=()=>{const q=new Date;y.value=T(q)},T=q=>{const Y=q.getFullYear(),_e=String(q.getMonth()+1).padStart(2,"0"),ne=String(q.getDate()).padStart(2,"0"),ve=String(q.getHours()).padStart(2,"0"),J=String(q.getMinutes()).padStart(2,"0"),fe=String(q.getSeconds()).padStart(2,"0");return`${ne}/${_e}/${Y} ${ve}:${J}:${fe}`},D=async(q,Y)=>{const _e=await core.getDynamicStampPreview({contents:Y,time:y.value,stampColor:q,stampShape:0});x.updateStampPreview({imgSrc:_e.imgSrc,width:_e.width,height:_e.height,stampType:"dynamic",stampColor:q,contents:Y,stampShape:0,time:y.value})},N=(q,Y,_e)=>{Y==="standard"?x.updateStampPreview({imgSrc:q.target.src,width:q.target.width,height:q.target.height,stampType:"standard",contents:_e}):x.updateStampPreview({imgSrc:q.target.src,width:q.target.width,height:q.target.height,stampType:"image",contents:_e})},I=()=>{r.closeElement("stampPanel"),u.setToolState("")},O=q=>{s.value=!0,w.value=q},F=()=>{r.removeCustomStamp(w.value),s.value=!1};return(q,Y)=>{const _e=__unplugin_components_14$2,ne=_sfc_main$4C,ve=__unplugin_components_2$f,J=_sfc_main$4v;return openBlock(),createElementBlock("div",{class:normalizeClass(["stamp-panel",{closed:!g.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$3m,[createTextVNode(toDisplayString(q.$t("toolbar.annotationTools.stamp"))+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(_e,{key:0,class:"close-button",onClick:I})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$38,[createVNode(ne,{className:v.value==="STANDARD"?"active":"",isActive:v.value==="STANDARD","data-element":"STANDARD",onClick:Y[0]||(Y[0]=fe=>E("STANDARD"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(q.$t("panels.stamp.standard")),1)]),_:1},8,["className","isActive"]),createVNode(ne,{className:v.value==="DYNAMIC"?"active":"",isActive:v.value==="DYNAMIC","data-element":"DYNAMIC",onClick:Y[1]||(Y[1]=fe=>E("DYNAMIC"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(q.$t("panels.stamp.dynamic")),1)]),_:1},8,["className","isActive"]),createVNode(ne,{class:normalizeClass({active:v.value==="CUSTOM",mobile:unref(isMobileDevice)}),isActive:v.value==="CUSTOM","data-element":"CUSTOM",onClick:Y[2]||(Y[2]=fe=>E("CUSTOM"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(q.$t("panels.stamp.custom")),1)]),_:1},8,["class","isActive"])]),createBaseVNode("div",_hoisted_3$2R,[createBaseVNode("div",{class:normalizeClass(["standard-container",{hidden:v.value!=="STANDARD"}])},[createBaseVNode("div",_hoisted_4$14,[createBaseVNode("img",{onClick:Y[3]||(Y[3]=fe=>N(fe,"standard","Approved")),src:_imports_0$1,alt:"Approved"})]),createBaseVNode("div",_hoisted_5$G,[createBaseVNode("img",{onClick:Y[4]||(Y[4]=fe=>N(fe,"standard","Not Approved")),src:_imports_1,alt:"Not Approved"})]),createBaseVNode("div",_hoisted_6$v,[createBaseVNode("img",{onClick:Y[5]||(Y[5]=fe=>N(fe,"standard","Completed")),src:_imports_2,alt:"Completed"})]),createBaseVNode("div",_hoisted_7$n,[createBaseVNode("img",{onClick:Y[6]||(Y[6]=fe=>N(fe,"standard","Final")),src:_imports_3,alt:"Final"})]),createBaseVNode("div",_hoisted_8$k,[createBaseVNode("img",{onClick:Y[7]||(Y[7]=fe=>N(fe,"standard","Draft")),src:_imports_4,alt:"Draft"})]),createBaseVNode("div",_hoisted_9$i,[createBaseVNode("img",{onClick:Y[8]||(Y[8]=fe=>N(fe,"standard","Confidential")),src:_imports_5,alt:"Confidential"})]),createBaseVNode("div",_hoisted_10$h,[createBaseVNode("img",{onClick:Y[9]||(Y[9]=fe=>N(fe,"standard","For Public Release")),src:_imports_6,alt:"For Public Release"})]),createBaseVNode("div",_hoisted_11$e,[createBaseVNode("img",{onClick:Y[10]||(Y[10]=fe=>N(fe,"standard","Not For Public Release")),src:_imports_7,alt:"Not For Public Release"})]),createBaseVNode("div",_hoisted_12$d,[createBaseVNode("img",{onClick:Y[11]||(Y[11]=fe=>N(fe,"standard","For Comment")),src:_imports_8,alt:"For Comment"})]),createBaseVNode("div",_hoisted_13$d,[createBaseVNode("img",{onClick:Y[12]||(Y[12]=fe=>N(fe,"standard","Void")),src:_imports_9,alt:"Void"})]),createBaseVNode("div",_hoisted_14$d,[createBaseVNode("img",{onClick:Y[13]||(Y[13]=fe=>N(fe,"standard","Preliminary Results")),src:_imports_10,alt:"Preliminary Results"})]),createBaseVNode("div",_hoisted_15$d,[createBaseVNode("img",{onClick:Y[14]||(Y[14]=fe=>N(fe,"standard","Information Only")),src:_imports_11,alt:"Information Only"})]),createBaseVNode("div",_hoisted_16$c,[createBaseVNode("img",{onClick:Y[15]||(Y[15]=fe=>N(fe,"standard","Witness")),src:_imports_12,alt:"Witness"})]),createBaseVNode("div",_hoisted_17$b,[createBaseVNode("img",{onClick:Y[16]||(Y[16]=fe=>N(fe,"standard","Initial Here")),src:_imports_13,alt:"Initial Here"})]),createBaseVNode("div",_hoisted_18$a,[createBaseVNode("img",{onClick:Y[17]||(Y[17]=fe=>N(fe,"standard","Sign Here")),src:_imports_14,alt:"Sign Here"})]),createBaseVNode("div",_hoisted_19$a,[createBaseVNode("img",{onClick:Y[18]||(Y[18]=fe=>N(fe,"standard","revised")),src:_imports_15,alt:"revised"})])],2),createBaseVNode("div",{class:normalizeClass(["customize-container",{hidden:v.value!=="DYNAMIC"}])},[createBaseVNode("div",{class:"block",onClick:Y[19]||(Y[19]=fe=>D(1,"REVISED"))},[createBaseVNode("div",_hoisted_20$a,[_hoisted_21$a,createBaseVNode("p",null,toDisplayString(y.value),1)])]),createBaseVNode("div",{class:"block",onClick:Y[20]||(Y[20]=fe=>D(2,"REVIEWED"))},[createBaseVNode("div",_hoisted_22$a,[_hoisted_23$8,createBaseVNode("p",null,toDisplayString(y.value),1)])])],2),createBaseVNode("div",{class:normalizeClass(["custom-container",{hidden:v.value!=="CUSTOM"}])},[f.value.length===0?(openBlock(),createElementBlock("div",_hoisted_24$8,toDisplayString(q.$t("panels.stamp.createHere")),1)):createCommentVNode("",!0),createBaseVNode("div",{ref_key:"stampsRef",ref:m,class:"stamps-container"},[(openBlock(!0),createElementBlock(Fragment,null,renderList(f.value,(fe,Z)=>(openBlock(),createElementBlock("div",{class:"block",key:Z},[createBaseVNode("img",{onClick:Y[21]||(Y[21]=j=>N(j,"custom","")),src:fe},null,8,_hoisted_25$8),createVNode(ne,{class:"close-button",onClick:j=>O(Z)},{default:withCtx(()=>[createVNode(_e)]),_:2},1032,["onClick"])]))),128))],512),createBaseVNode("div",_hoisted_26$8,[createBaseVNode("div",{class:"create-button",onClick:Y[22]||(Y[22]=fe=>k())},toDisplayString(q.$t("panels.stamp.create")),1)])],2)]),s.value?(openBlock(),createElementBlock("div",_hoisted_27$7,[createVNode(J,{show:s.value,dialogName:q.dialogName},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:Y[23]||(Y[23]=fe=>s.value=!1)},toDisplayString(q.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:F},toDisplayString(q.$t("common.actions.ok")),1)]),default:withCtx(()=>[createVNode(ve),createBaseVNode("p",null,toDisplayString(q.$t("signatures.deleteConfirm")),1)]),_:1},8,["show","dialogName"])])):createCommentVNode("",!0)],6)}}},_sfc_main$3K={},_hoisted_1$3l={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$37=createBaseVNode("mask",{id:"path-1-inside-1_334_4981",fill:"white"},[createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.58408 11.3387C4.3368 11.6625 7.20552 10.7684 9.31754 8.65635C11.1899 6.78404 12.105 4.31705 12.0631 1.86338C12.9045 2.2377 13.6927 2.76991 14.3828 3.46C17.399 6.47625 17.399 11.3666 14.3828 14.3828C11.3665 17.3991 6.47623 17.3991 3.45998 14.3828C2.57505 13.4979 1.94975 12.4516 1.58408 11.3387Z"})],-1),_hoisted_3$2Q=createBaseVNode("path",{d:"M1.58412 11.3387L1.75933 9.849L-0.574465 9.57451L0.159076 11.807L1.58412 11.3387ZM12.0631 1.86337L12.6728 0.492869L10.5232 -0.46347L10.5634 1.889L12.0631 1.86337ZM8.25692 7.59568C6.48322 9.36938 4.07577 10.1214 1.75933 9.849L1.40891 12.8285C4.59792 13.2035 7.9279 12.1673 10.3782 9.717L8.25692 7.59568ZM10.5634 1.889C10.5986 3.95285 9.82995 6.02265 8.25692 7.59568L10.3782 9.717C12.5498 7.54541 13.6115 4.68123 13.5629 1.83774L10.5634 1.889ZM11.4535 3.23387C12.1295 3.5346 12.7642 3.96264 13.3222 4.52064L15.4435 2.39932C14.6213 1.57714 13.6796 0.940768 12.6728 0.492869L11.4535 3.23387ZM13.3222 4.52064C15.7526 6.95111 15.7526 10.8917 13.3222 13.3221L15.4435 15.4435C19.0455 11.8414 19.0455 6.00136 15.4435 2.39932L13.3222 4.52064ZM13.3222 13.3221C10.8917 15.7526 6.95115 15.7526 4.52068 13.3221L2.39936 15.4435C6.0014 19.0455 11.8415 19.0455 15.4435 15.4435L13.3222 13.3221ZM4.52068 13.3221C3.80572 12.6072 3.30315 11.7652 3.00916 10.8705L0.159076 11.807C0.596442 13.1381 1.34447 14.3886 2.39936 15.4435L4.52068 13.3221Z",fill:"currentColor",mask:"url(#path-1-inside-1_334_4981)"},null,-1),_hoisted_4$13=[_hoisted_2$37,_hoisted_3$2Q];function _sfc_render$2d(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3l,_hoisted_4$13)}const __unplugin_components_8$5=_export_sfc(_sfc_main$3K,[["render",_sfc_render$2d]]),_sfc_main$3J={},_hoisted_1$3k={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$36=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.99938 3.50634C9.58517 3.50634 9.24938 3.17055 9.24938 2.75634V1.57727C9.24938 1.16306 9.58517 0.827271 9.99938 0.827271C10.4136 0.827271 10.7494 1.16306 10.7494 1.57727V2.75634C10.7494 3.17055 10.4136 3.50634 9.99938 3.50634ZM14.7034 9.9044C14.7034 12.5498 12.5589 14.6944 9.91347 14.6944C7.26804 14.6944 5.1235 12.5498 5.1235 9.9044C5.1235 7.25898 7.26804 5.11444 9.91347 5.11444C12.5589 5.11444 14.7034 7.25898 14.7034 9.9044ZM14.5886 4.34193C14.2954 4.63444 14.2954 5.1087 14.5886 5.40121C14.8819 5.69373 15.3574 5.69373 15.6507 5.40121L16.4865 4.56749C16.7798 4.27497 16.7798 3.80071 16.4865 3.5082C16.1933 3.21569 15.7178 3.21569 15.4245 3.5082L14.5886 4.34193ZM16.4906 9.97809C16.4906 9.56388 16.8264 9.22809 17.2406 9.22809H18.4227C18.837 9.22809 19.1727 9.56388 19.1727 9.97809C19.1727 10.3923 18.837 10.7281 18.4227 10.7281H17.2406C16.8264 10.7281 16.4906 10.3923 16.4906 9.97809ZM15.6507 14.555C15.3574 14.2624 14.8819 14.2624 14.5887 14.555C14.2954 14.8475 14.2954 15.3217 14.5887 15.6142L15.4245 16.448C15.7178 16.7405 16.1933 16.7405 16.4866 16.448C16.7798 16.1555 16.7798 15.6812 16.4866 15.3887L15.6507 14.555ZM9.99947 16.4497C10.4137 16.4497 10.7495 16.7855 10.7495 17.1997V18.3788C10.7495 18.793 10.4137 19.1288 9.99947 19.1288C9.58526 19.1288 9.24947 18.793 9.24947 18.3788V17.1997C9.24947 16.7855 9.58526 16.4497 9.99947 16.4497ZM5.41081 15.6142C5.70408 15.3217 5.70408 14.8474 5.41081 14.5549C5.11754 14.2624 4.64205 14.2624 4.34878 14.5549L3.51289 15.3887C3.21962 15.6812 3.21962 16.1554 3.51289 16.4479C3.80616 16.7405 4.28165 16.7405 4.57492 16.4479L5.41081 15.6142ZM3.50939 9.97805C3.50939 10.3923 3.1736 10.728 2.75939 10.728H1.57727C1.16306 10.728 0.827271 10.3923 0.827271 9.97805C0.827271 9.56384 1.16306 9.22805 1.57727 9.22805H2.75939C3.1736 9.22805 3.50939 9.56384 3.50939 9.97805ZM4.34874 5.40119C4.64201 5.6937 5.1175 5.6937 5.41077 5.40119C5.70405 5.10867 5.70405 4.63442 5.41077 4.3419L4.57489 3.50818C4.28162 3.21566 3.80613 3.21566 3.51286 3.50818C3.21958 3.80069 3.21958 4.27495 3.51286 4.56746L4.34874 5.40119Z",fill:"currentColor"},null,-1),_hoisted_3$2P=[_hoisted_2$36];function _sfc_render$2c(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3k,_hoisted_3$2P)}const __unplugin_components_7$6=_export_sfc(_sfc_main$3J,[["render",_sfc_render$2c]]),_sfc_main$3I={},_hoisted_1$3j={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$35=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M22.5 5H2.5V19H22.5V5ZM6.34628 13.75L6.6731 12.7365H8.05023L8.37455 13.75H8.96333L7.66353 10H7.05979L5.76 13.75H6.34628ZM7.90054 12.2687H6.82279L7.33921 10.6575H7.38162L7.90054 12.2687ZM12 18V6H13V18H12ZM18.0694 12.6923C18.0694 13.3498 17.6078 13.75 16.8394 13.75H15.36V10H16.807C17.4831 10 17.8897 10.3586 17.8897 10.933V10.9381C17.8897 11.328 17.6128 11.6788 17.2585 11.7412V11.7853C17.745 11.8399 18.0694 12.1985 18.0694 12.6871V12.6923ZM15.9188 11.5956H16.5825C17.0764 11.5956 17.3334 11.4033 17.3334 11.0395V11.0343C17.3334 10.6809 17.0914 10.4756 16.6773 10.4756H15.9188V11.5956ZM16.7272 13.2744H15.9188V12.04H16.6947C17.2211 12.04 17.498 12.2479 17.498 12.6507V12.6559C17.498 13.0587 17.2311 13.2744 16.7272 13.2744Z",fill:"currentColor"},null,-1),_hoisted_3$2O=[_hoisted_2$35];function _sfc_render$2b(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3j,_hoisted_3$2O)}const __unplugin_components_6$8=_export_sfc(_sfc_main$3I,[["render",_sfc_render$2b]]),_sfc_main$3H={},_hoisted_1$3i={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$34=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 4V20H20.5V4H3.5ZM4 12.5H20V11.5H4V12.5ZM11.4511 9.23649L11.1107 10.25H10.5L11.854 6.5H12.4828L13.8368 10.25H13.2235L12.8857 9.23649H11.4511ZM11.6071 8.76871H12.7297L12.1892 7.15748H12.145L11.6071 8.76871ZM13.8222 16.3923C13.8222 17.0498 13.3415 17.45 12.5411 17.45H11V13.7H12.5073C13.2115 13.7 13.6351 14.0586 13.6351 14.633V14.6382C13.6351 15.028 13.3467 15.3788 12.9777 15.4412V15.4854C13.4844 15.5399 13.8222 15.8986 13.8222 16.3871V16.3923ZM11.5821 15.2956H12.2734C12.7879 15.2956 13.0556 15.1033 13.0556 14.7395V14.7343C13.0556 14.3809 12.8035 14.1756 12.3721 14.1756H11.5821V15.2956ZM12.4241 16.9744H11.5821V15.74H12.3903C12.9387 15.74 13.2271 15.9479 13.2271 16.3507V16.3559C13.2271 16.7587 12.9491 16.9744 12.4241 16.9744Z",fill:"currentColor"},null,-1),_hoisted_3$2N=[_hoisted_2$34];function _sfc_render$2a(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3i,_hoisted_3$2N)}const __unplugin_components_5$8=_export_sfc(_sfc_main$3H,[["render",_sfc_render$2a]]),_sfc_main$3G={},_hoisted_1$3h={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$33=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11 15H1V21H11V15ZM23 15H13V21H23V15Z",fill:"currentColor"},null,-1),_hoisted_3$2M=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1 3H8L11 6.2V13H1V3Z",fill:"currentColor"},null,-1),_hoisted_4$12=[_hoisted_2$33,_hoisted_3$2M];function _sfc_render$29(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3h,_hoisted_4$12)}const __unplugin_components_4$e=_export_sfc(_sfc_main$3G,[["render",_sfc_render$29]]),_sfc_main$3F={},_hoisted_1$3g={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$32=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11 5H1V19H11V5ZM19 5H13V19H23V9.2L19 5Z",fill:"currentColor"},null,-1),_hoisted_3$2L=[_hoisted_2$32];function _sfc_render$28(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3g,_hoisted_3$2L)}const __unplugin_components_3$e=_export_sfc(_sfc_main$3F,[["render",_sfc_render$28]]),_sfc_main$3E={},_hoisted_1$3f={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$31=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6 4H14L18 8.2V20H6V4Z",fill:"currentColor"},null,-1),_hoisted_3$2K=[_hoisted_2$31];function _sfc_render$27(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3f,_hoisted_3$2K)}const __unplugin_components_1$b=_export_sfc(_sfc_main$3E,[["render",_sfc_render$27]]),RightPanelPageMode_vue_vue_type_style_index_0_lang="",_hoisted_1$3e={class:"sidebar-title"},_hoisted_2$30={class:"mode-container"},_hoisted_3$2J={class:"mode-item"},_hoisted_4$11={class:"mode-tabs"},_hoisted_5$F={class:"mode-item"},_hoisted_6$u={class:"mode-tabs"},_hoisted_7$m={class:"mode-item"},_hoisted_8$j={class:"mode-tabs"},_sfc_main$3D={__name:"RightPanelPageMode",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen("pageModePanel")),u=computed(()=>n.getScrollMode),s=computed(()=>n.getPageMode),w=computed(()=>n.getThemeMode),m=computed(()=>o.getActiveTool);watch(r,(y,x)=>{y&&m.value==="cropPage"&&o.setToolState("")});const v=(y,x)=>{s.value!==0&&y==="Horizontal"&&(core.switchSpreadMode(0),n.setPageMode(0)),n.setScrollMode(y),core.switchScrollMode(x)},g=y=>{u.value==="Horizontal"&&(n.setScrollMode("Vertical"),core.switchScrollMode(0)),core.switchSpreadMode(y),n.setPageMode(y)},d=y=>{y!==w.value&&n.setThemeMode(y)},f=()=>{n.closeElement("pageModePanel")};return(y,x)=>{const k=__unplugin_components_14$2,P=__unplugin_components_1$b,S=_sfc_main$4C,E=__unplugin_components_3$e,M=__unplugin_components_4$e,T=__unplugin_components_5$8,D=__unplugin_components_6$8,N=__unplugin_components_7$6,I=__unplugin_components_8$5;return openBlock(),createElementBlock("div",{class:normalizeClass(["right-panel-page",{closed:!r.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 44px)"})},[unref(isMobileDevice)?(openBlock(),createBlock(k,{key:0,class:"close-button",onClick:f})):createCommentVNode("",!0),createBaseVNode("div",_hoisted_1$3e,toDisplayString(y.$t("toolbar.viewControls.viewSetting")),1),createBaseVNode("div",_hoisted_2$30,[createBaseVNode("div",_hoisted_3$2J,[createBaseVNode("h2",null,toDisplayString(y.$t("panels.pageMode.displayMode.title")),1),createBaseVNode("div",_hoisted_4$11,[createVNode(S,{class:normalizeClass({active:s.value===0}),onClick:x[0]||(x[0]=O=>g(0)),title:y.$t("panels.pageMode.displayMode.singlePage")},{default:withCtx(()=>[createVNode(P)]),_:1},8,["class","title"]),createVNode(S,{class:normalizeClass({active:s.value===1}),onClick:x[1]||(x[1]=O=>g(1)),title:y.$t("panels.pageMode.displayMode.twoPages")},{default:withCtx(()=>[createVNode(E)]),_:1},8,["class","title"]),createVNode(S,{class:normalizeClass({active:s.value===2}),onClick:x[2]||(x[2]=O=>g(2)),title:y.$t("panels.pageMode.displayMode.coverMode")},{default:withCtx(()=>[createVNode(M)]),_:1},8,["class","title"])])]),createBaseVNode("div",_hoisted_5$F,[createBaseVNode("h2",null,toDisplayString(y.$t("panels.pageMode.splitView.title")),1),createBaseVNode("div",_hoisted_6$u,[createVNode(S,{class:normalizeClass({active:u.value==="Vertical"}),onClick:x[3]||(x[3]=O=>v("Vertical",0)),title:y.$t("panels.pageMode.splitView.vertical")},{default:withCtx(()=>[createVNode(T)]),_:1},8,["class","title"]),createVNode(S,{class:normalizeClass({active:u.value==="Horizontal"}),onClick:x[4]||(x[4]=O=>v("Horizontal",1)),title:y.$t("panels.pageMode.splitView.horizontal")},{default:withCtx(()=>[createVNode(D)]),_:1},8,["class","title"])])]),createBaseVNode("div",_hoisted_7$m,[createBaseVNode("h2",null,toDisplayString(y.$t("panels.pageMode.themes")),1),createBaseVNode("div",_hoisted_8$j,[createVNode(S,{onClick:x[5]||(x[5]=O=>d("light")),class:normalizeClass({active:w.value==="light"}),title:y.$t("toolbar.themeSwitcher.light")},{default:withCtx(()=>[createVNode(N)]),_:1},8,["class","title"]),createVNode(S,{onClick:x[6]||(x[6]=O=>d("dark")),class:normalizeClass({active:w.value==="dark"}),title:y.$t("toolbar.themeSwitcher.dark")},{default:withCtx(()=>[createVNode(I)]),_:1},8,["class","title"])])])])],6)}}},_sfc_main$3C={},_hoisted_1$3d={width:"10",height:"11",viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2$=createBaseVNode("path",{d:"M5 0.0517578C5.2793 0.0517578 5.47803 0.245117 5.47803 0.524414V7.59814L5.44043 8.74219L7.04639 6.98047L8.271 5.77734C8.35693 5.69141 8.48047 5.64844 8.60938 5.64844C8.87793 5.64844 9.07129 5.85254 9.07129 6.11572C9.07129 6.24463 9.02832 6.35742 8.92627 6.46484L5.35986 10.0366C5.25781 10.144 5.13428 10.1978 5 10.1978C4.86572 10.1978 4.74219 10.144 4.64014 10.0366L1.0791 6.46484C0.977051 6.35742 0.928711 6.24463 0.928711 6.11572C0.928711 5.85254 1.12207 5.64844 1.39062 5.64844C1.51953 5.64844 1.64844 5.69141 1.729 5.77734L2.95361 6.98047L4.56494 8.74756L4.52197 7.59814V0.524414C4.52197 0.245117 4.7207 0.0517578 5 0.0517578Z",fill:"currentColor"},null,-1),_hoisted_3$2I=[_hoisted_2$2$];function _sfc_render$26(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3d,_hoisted_3$2I)}const __unplugin_components_7$5=_export_sfc(_sfc_main$3C,[["render",_sfc_render$26]]),_sfc_main$3B={},_hoisted_1$3c={width:"10",height:"11",viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2_=createBaseVNode("path",{d:"M5 10.1978C4.7207 10.1978 4.52197 10.0044 4.52197 9.7251V2.65137L4.56494 1.50195L2.95361 3.26904L1.729 4.47217C1.64844 4.55811 1.51953 4.60107 1.39062 4.60107C1.12207 4.60107 0.928711 4.39697 0.928711 4.13379C0.928711 4.00488 0.977051 3.89209 1.0791 3.78467L4.64014 0.212891C4.74219 0.105469 4.86572 0.0517578 5 0.0517578C5.13428 0.0517578 5.25781 0.105469 5.35986 0.212891L8.92627 3.78467C9.02832 3.89209 9.07129 4.00488 9.07129 4.13379C9.07129 4.39697 8.87793 4.60107 8.60938 4.60107C8.48047 4.60107 8.35693 4.55811 8.271 4.47217L7.04639 3.26904L5.44043 1.50732L5.47803 2.65137V9.7251C5.47803 10.0044 5.2793 10.1978 5 10.1978Z",fill:"currentColor"},null,-1),_hoisted_3$2H=[_hoisted_2$2_];function _sfc_render$25(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3c,_hoisted_3$2H)}const __unplugin_components_6$7=_export_sfc(_sfc_main$3B,[["render",_sfc_render$25]]),_sfc_main$3A={},_hoisted_1$3b={width:"10",height:"2",viewBox:"0 0 10 2",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2Z=createBaseVNode("path",{d:"M1.04688 1.61084C0.789062 1.61084 0.568848 1.39062 0.568848 1.12744C0.568848 0.864258 0.789062 0.649414 1.04688 0.649414H8.95312C9.21094 0.649414 9.43115 0.864258 9.43115 1.12744C9.43115 1.39062 9.21094 1.61084 8.95312 1.61084H1.04688Z",fill:"currentColor"},null,-1),_hoisted_3$2G=[_hoisted_2$2Z];function _sfc_render$24(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3b,_hoisted_3$2G)}const __unplugin_components_5$7=_export_sfc(_sfc_main$3A,[["render",_sfc_render$24]]),_sfc_main$3z={},_hoisted_1$3a={width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2Y=createBaseVNode("path",{d:"M5 9.6499C4.73682 9.6499 4.52197 9.44043 4.52197 9.18262V5.61084H1.04688C0.789062 5.61084 0.568848 5.39062 0.568848 5.12744C0.568848 4.86426 0.789062 4.64941 1.04688 4.64941H4.52197V1.07227C4.52197 0.814453 4.73682 0.60498 5 0.60498C5.26318 0.60498 5.4834 0.814453 5.4834 1.07227V4.64941H8.95312C9.21094 4.64941 9.43115 4.86426 9.43115 5.12744C9.43115 5.39062 9.21094 5.61084 8.95312 5.61084H5.4834V9.18262C5.4834 9.44043 5.26318 9.6499 5 9.6499Z",fill:"currentColor"},null,-1),_hoisted_3$2F=[_hoisted_2$2Y];function _sfc_render$23(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$3a,_hoisted_3$2F)}const __unplugin_components_4$d=_export_sfc(_sfc_main$3z,[["render",_sfc_render$23]]),_sfc_main$3y={},_hoisted_1$39={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},_hoisted_2$2X=createStaticVNode('<mask id="mask0_3348_1984" style="mask-type:luminance;" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24"><circle cx="12" cy="12" r="12" fill="white"></circle></mask><g mask="url(#mask0_3348_1984)"><rect x="-22.2856" y="-29.1428" width="65.1427" height="80.5713" fill="url(#pattern0_3348_1984)"></rect></g><defs><pattern id="pattern0_3348_1984" patternContentUnits="objectBoundingBox" width="1" height="1"><use xlink:href="#image0_3348_1984" transform="scale(0.0263158 0.0212766)"></use></pattern><image id="image0_3348_1984" width="38" height="47" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAvCAYAAACPMrhmAAAKs2lDQ1BJQ0MgUHJvZmlsZQAASImVlgdUE9kax+/MpBdaAAEpoTfpLYD0Grp0EJWQUEKJMSGI2FBZVEBRRETAhi6CKLgWQNaCiGJFUSkquiCLirIuFkRFZQd4hLfvnffeeV/ON/d3vtz57n/uzD3nDwClj8Xnp8JSAKTx0gXBXq70yKhoOv45QAAWSAFFoMJiC/kuQUF+AI3Z8e/xqRtAU+MDo6le//7/fw1pTryQDQAUhHIcR8hOQ/kMmq1sviAdACQTrWuuTOdPcQXKsgJUIMonpzhxhtumOG6Ge6fnhAa7oTwCAIHCYgkSASB/Ruv0DHYi2oeigLIpj8PloeyNsiM7icVBeQvKC9LSlk8xqgHoxf1Tn8S/9YwT92SxEsU88yzTQXDnCvmprFX/53b870hLFc2uoYEmJUngHYyOSuieVacs9xUzLy4gcJa5nOn505wk8g6bZbbQLXqWOSx331kWpYS5zDJLMHcvN50ZOsuC5cHi/rzUAD9x/3immOOFHiGznMD1ZM5yVlJoxCxncMMDZlmYEuI7N8dNXBeIgsWaEwSe4mdME85pY7Pm1kpPCvWe0xAp1sOJd/cQ13lh4vn8dFdxT35q0Jz+VC9xXZgRIr43Hf3AZjmZ5RM01ydIvD8gHEQCc2CB/qwBHYQADxAMmOgVXTU9PjN9Srjbcv4qATcxKZ3ugp6ceDqTxzZeQDc3NWMAMHUOZ17zh97p8wXJE+ZqQvQ7X2gJAMZ8rhajBsDJCwBIbZur6TwDgCYBwEUeWyTImKlhpi5YQAKSQBY94apAE+gBI1SrNbAHzqhCHxAIQkEUWArYIAmkAQFYCdaADSAX5IMdYDcoAwfAYVANToBToBGcB5fBNXAL3ANd4AnoB0PgDRgFn8AEBEF4iArRIEVIDdKGDCFziAE5Qh6QHxQMRUGxUCLEg0TQGmgTlA8VQWXQIagG+gU6B12GbkCd0CNoABqG3kNfYQSmwLKwCqwDm8AM2AX2hUPhJXAivALOgnPg7XApXAkfhxvgy/AtuAvuh9/AYwhAyIg8oo4YIQzEDQlEopEERICsQ/KQEqQSqUOakXbkAdKPjCBfMDgMDUPHGGHsMd6YMAwbswKzDlOAKcNUYxowbZgHmAHMKOYHlopVxhpi7bBMbCQ2EbsSm4stwVZhz2KvYruwQ9hPOBxOHqeLs8F546JwybjVuALcPlw9rgXXiRvEjeHxeEW8Id4BH4hn4dPxufi9+OP4S/j7+CH8ZwKZoEYwJ3gSogk8wkZCCeEY4SLhPuElYYIoRdQm2hEDiRziKmIh8QixmXiXOEScIEmTdEkOpFBSMmkDqZRUR7pK6iN9IJPJGmRb8iIyl5xNLiWfJF8nD5C/UGQoBhQ3SgxFRNlOOUppoTyifKBSqTpUZ2o0NZ26nVpDvUJ9Rv0sQZMwlmBKcCTWS5RLNEjcl3grSZTUlnSRXCqZJVkieVryruSIFFFKR8pNiiW1Tqpc6pxUj9SYNE3aTDpQOk26QPqY9A3pVzJ4GR0ZDxmOTI7MYZkrMoM0hKZJc6OxaZtoR2hXaUOyOFldWaZssmy+7AnZDtlRORk5S7lwuUy5crkLcv3yiLyOPFM+Vb5Q/pR8t/zXeSrzXObFz9s6r27e/XnjCvMVnBXiFfIU6hW6FL4q0hU9FFMUdyo2Kj5VwigZKC1SWqm0X+mq0sh82fn289nz8+afmv9YGVY2UA5WXq18WPm28piKqoqXCl9lr8oVlRFVeVVn1WTVYtWLqsNqNDVHNa5asdoltdd0OboLPZVeSm+jj6orq3uri9QPqXeoT2joaoRpbNSo13iqSdJkaCZoFmu2ao5qqWn5a63RqtV6rE3UZmgnae/Rbtce19HVidDZrNOo80pXQZepm6Vbq9unR9Vz0luhV6n3UB+nz9BP0d+nf88ANrAySDIoN7hrCBtaG3IN9xl2LsAusF3AW1C5oMeIYuRilGFUazRgLG/sZ7zRuNH4rYmWSbTJTpN2kx+mVqappkdMn5jJmPmYbTRrNntvbmDONi83f2hBtfC0WG/RZPHO0tAy3nK/Za8VzcrfarNVq9V3axtrgXWd9bCNlk2sTYVND0OWEcQoYFy3xdq62q63PW/7xc7aLt3ulN2f9kb2KfbH7F8t1F0Yv/DIwkEHDQeWwyGHfke6Y6zjQcd+J3UnllOl03NnTWeOc5XzSxd9l2SX4y5vXU1dBa5nXcfd7NzWurW4I+5e7nnuHR4yHmEeZR7PPDU8Ez1rPUe9rLxWe7V4Y719vXd69zBVmGxmDXPUx8ZnrU+bL8U3xLfM97mfgZ/Ar9kf9vfx3+XfF6AdwAtoDASBzMBdgU+DdINWBP26CLcoaFH5ohfBZsFrgttDaCHLQo6FfAp1DS0MfRKmFyYKaw2XDI8Jrwkfj3CPKIrojzSJXBt5K0opihvVFI2PDo+uih5b7LF49+KhGKuY3JjuJbpLMpfcWKq0NHXphWWSy1jLTsdiYyNij8V+YwWyKlljccy4irhRtht7D/sNx5lTzBmOd4gvin+Z4JBQlPAq0SFxV+JwklNSSdII141bxn2X7J18IHk8JTDlaMpkakRqfRohLTbtHE+Gl8JrW666PHN5J9+Qn8vvX2G3YveKUYGvoEoICZcIm9JlUcNzW6Qn+kk0kOGYUZ7xeWX4ytOZ0pm8zNurDFZtXfUyyzPr59WY1ezVrWvU12xYM7DWZe2hddC6uHWt6zXX56wfyvbKrt5A2pCy4c5G041FGz9uitjUnKOSk50z+JPXT7W5ErmC3J7N9psPbMFs4W7p2Gqxde/WH3mcvJv5pvkl+d8K2AU3t5ltK902uT1he0ehdeH+HbgdvB3dO512VhdJF2UVDe7y39VQTC/OK/64e9nuGyWWJQf2kPaI9vSX+pU27dXau2Pvt7Kksq5y1/L6CuWKrRXj+zj77u933l93QOVA/oGvB7kHew95HWqo1KksOYw7nHH4xZHwI+0/M36uqVKqyq/6fpR3tL86uLqtxqam5pjyscJauFZUO3w85vi9E+4nmuqM6g7Vy9fnnwQnRSdf/xL7S/cp31Otpxmn685on6k4Szub1wA1rGoYbUxq7G+Kauo853Outdm++eyvxr8ePa9+vvyC3IXCi6SLORcnL2VdGmvht4xcTrw82Lqs9cmVyCsP2xa1dVz1vXr9mue1K+0u7ZeuO1w/f8PuxrmbjJuNt6xvNdy2un32jtWdsx3WHQ13be423bO919y5sPPifaf7lx+4P7j2kPnwVldAV2d3WHdvT0xPfy+n99Wj1EfvHmc8nniS3Yfty3sq9bTkmfKzyt/0f6vvt+6/MOA+cPt5yPMng+zBN78Lf/82lPOC+qLkpdrLmlfmr84Pew7fe7349dAb/puJkdw/pP+oeKv39syfzn/eHo0cHXoneDf5vuCD4oejHy0/to4FjT37lPZpYjzvs+Ln6i+ML+1fI76+nFj5Df+t9Lv+9+Yfvj/6JtMmJ/ksAWvaCiBowgkJALw/CgA1CvUK9wAgScz45OmAZrz9NIH/xDNeejqsAah0BiAMTf8WAA5mox4ETWk0g9BaqDOALSzE+Y8QJliYz/QiN6LWpGRy8gPqD/H6AHzvmZycaJyc/F6Fin0MQMunGX8+FdGoD3Y2mKI7W0nZ4F/iL/OdBdopifIkAAAEQklEQVRYCe2WzYsjRRjGn+5OV3cn6XxOdj7WHXFlHFdxRfak6ODFHUSvggcR9CK4Bw/+IR7FgwdBWA+KshcZFTzo4sJ6ED/AYVlFZnYnmWSSSXfS3elOp316x7mEwKRGD4t0haLo4q2qX5736bdaSdhwHzb1PmS6h5SByWYmUyxTTFYB2fjMY5lisgrIxmcek1UsJ7tgOt4PHPT72/Cc68h520A0wVhdR37hWZQbj8KyStNL5npWTvvZE0Uj3Gl/CVO9ipo4gD6aIBlOgH965IzRHdUQPvgmVh5/GbpuzgV0HHQqMC9wcbv7MVbqX6CiKVADA/A0gmlHYIMIcH3A8RA6IfYXX0Lj+Xdh5e3jc08cpVMZUqnrvQ8gGl+hqBmwUISZs6AIKhLxXYr43amHUHQfiepCjA+x/PM17E1sLF++Aj2Nm6NJg91g+n6pf4NVzUQeZfYS01RELk7hqFwKZowAfwCoBhJFhRqPcebbj7BXOovVjVfnwAKkwFwa/XPxCfScAhMF/krsVVhqFUXCKUIcgeUCQuUBhdunX+7jELrnQ3z2PvxLL8IqlE+EkwK75W7jVvkQC0xgPiGYYlOxCuHqEFoVhrCAkCA5755amKRQVG885HwBtd0Wun/8BuuJZ04EkyqwP4xuwmEKXdjosnforzZV6xDOVRcQ60uAWCFUg0pVCcRSEVK5gL7yTGh9Df73X58IlQZIKbad2+eSRST0VqzU4KOGIfXrc3SoWp4ptZQEypj/d0TVRlTQJ5hH7w2Y5p4G48ff5wPb2tqaGbi5uTlj/qhYKoQCYRL2mEAh+5AKuSF95icQAQ3PkdQEY23zx4Tjc8Aez1dwc7MBZjBxan18Hj8pbcJUEBEmJliYKpdU4FAZJU1VFygdVlEYWMj5NlSPRg+YVr/O8tFA8NTa7M2nZqVS+bRxAZ/GKiKNQITyCOXGZRi+AeVQwbAFFA4SDAlY6eVh9wVM14bm1AjYwFicQX7j4hTC7EcpsDX7ATT6TXRry/BoeidiDRvqSAgVtFm+mgmsToKBy8z1gXJHQ6lro9A1YcYV9M4JlNdWZ5NMzUqB2WYBr/cW8V5MP01KUB1eQT16nDAuwcTdBCbHAWtrWl+HB+wtBWVXwKb/g7frWCoWphBmP0qBpVu8sHAeu607uKqXEPPgsE2FOoC5nyB3l7cR0znoJwj4Ug7pN4/gvjbB4JUmHrs8n1rpOdJghi7w2sIinNs7uNZZht+ijwglmoC2SzCqNkhhWPy9kOAiRPWtFtbeWOI9yZIxZ5MGS/ctmnm888hZrGMHH/5poNmuA02B5K8E2h6BWCESPULhoQ4uXAlxafMchARUesapPnvShcfN9Txs7/Tw3c0Bfr1hsX4BT1708dxGEQ+v8Q4tssCeov1rsFOcOdcSqbtyrh3/o6AMTFbITLFMMVkFZOMzj2WKySogG5957H+j2N8vPYhqDhnSbgAAAABJRU5ErkJggg=="></image></defs>',3),_hoisted_5$E=[_hoisted_2$2X];function _sfc_render$22(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$39,_hoisted_5$E)}const __unplugin_components_3$d=_export_sfc(_sfc_main$3y,[["render",_sfc_render$22]]),_hoisted_1$38=createBaseVNode("div",{class:"divider"},null,-1),_hoisted_2$2W=createBaseVNode("div",{class:"divider"},null,-1),_sfc_main$3x={__name:"RightPanelTabs",props:["activePanelTab","selectedElement"],setup(e){const n=useViewerStore(),o=(r,u)=>{n.setActiveElementTab("rightPanel",r)};return(r,u)=>{const s=_sfc_main$4C;return openBlock(),createElementBlock(Fragment,null,[createVNode(s,{className:e.activePanelTab==="GENERAL"?"active":"","data-element":"GENERAL",isActive:e.activePanelTab==="GENERAL",onClick:u[0]||(u[0]=w=>o("GENERAL"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(r.$t("panels.right.general.title")),1)]),_:1},8,["className","isActive"]),_hoisted_1$38,e.selectedElement!=="signatureFields"?(openBlock(),createBlock(s,{key:0,className:e.activePanelTab==="APPEARANCE"?"active":"","data-element":"APPEARANCE",isActive:e.activePanelTab==="APPEARANCE",onClick:u[1]||(u[1]=w=>o("APPEARANCE"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(r.$t("panels.right.appearance.title")),1)]),_:1},8,["className","isActive"])):createCommentVNode("",!0),e.selectedElement!=="signatureFields"?(openBlock(),createElementBlock(Fragment,{key:1},[_hoisted_2$2W,createVNode(s,{className:e.activePanelTab==="PREFERENCE"?"active":"","data-element":"PREFERENCE",isActive:e.activePanelTab==="PREFERENCE",onClick:u[2]||(u[2]=w=>o("PREFERENCE"))},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(r.$t("panels.right.preferences.title")),1)]),_:1},8,["className","isActive"])],64)):createCommentVNode("",!0)],64)}}},RightPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$37={class:"sidebar-title"},_hoisted_2$2V={class:"sidebar-tabs-header"},_hoisted_3$2E={class:"sidebar-content"},_hoisted_4$10={class:"content-block"},_hoisted_5$D={key:0,class:"error-text"},_hoisted_6$t={key:0,class:"content-block"},_hoisted_7$l={class:"content-block"},_hoisted_8$i={value:"0"},_hoisted_9$h={value:"1"},_hoisted_10$g={class:"content-block"},_hoisted_11$d={class:"indicator-content"},_hoisted_12$c={class:"content-block"},_hoisted_13$c={class:"wider"},_hoisted_14$c={class:"colors-container"},_hoisted_15$c={class:"cell-container"},_hoisted_16$b=createBaseVNode("span",{class:"cell light-red"},null,-1),_hoisted_17$a=[_hoisted_16$b],_hoisted_18$9={class:"cell-container"},_hoisted_19$9=createBaseVNode("span",{class:"cell white"},null,-1),_hoisted_20$9=[_hoisted_19$9],_hoisted_21$9={class:"cell-container"},_hoisted_22$9=createBaseVNode("span",{class:"cell light-yellow"},null,-1),_hoisted_23$7=[_hoisted_22$9],_hoisted_24$7={class:"cell-container"},_hoisted_25$7=createBaseVNode("span",{class:"cell light-blue"},null,-1),_hoisted_26$7=[_hoisted_25$7],_hoisted_27$6={class:"color-picker"},_hoisted_28$6={class:"content-block"},_hoisted_29$5={class:"wider"},_hoisted_30$5={class:"colors-container"},_hoisted_31$5={class:"cell-container"},_hoisted_32$4=createBaseVNode("span",{class:"cell red"},null,-1),_hoisted_33$3=[_hoisted_32$4],_hoisted_34$3={class:"cell-container"},_hoisted_35$3=createBaseVNode("span",{class:"cell black"},null,-1),_hoisted_36$2=[_hoisted_35$3],_hoisted_37$2={class:"cell-container"},_hoisted_38$2=createBaseVNode("span",{class:"cell blue"},null,-1),_hoisted_39$2=[_hoisted_38$2],_hoisted_40$2={class:"color-picker"},_hoisted_41$2={class:"content-block"},_hoisted_42$1=createBaseVNode("option",{value:"Helvetica"},"Helvetica",-1),_hoisted_43$1=createBaseVNode("option",{value:"Courier"},"Courier",-1),_hoisted_44$1=createBaseVNode("option",{value:"Times"},"Times-Roman",-1),_hoisted_45$1=[_hoisted_42$1,_hoisted_43$1,_hoisted_44$1],_hoisted_46$1={class:"content-block"},_hoisted_47$1={class:"text-style"},_hoisted_48$1={value:"normal"},_hoisted_49$1={value:"bold"},_hoisted_50$1={value:"oblique"},_hoisted_51$1={value:"boldOblique"},_hoisted_52$1=createStaticVNode('<option value="12">12</option><option value="14">14</option><option value="16">16</option><option value="20">20</option><option value="24">24</option><option value="28">28</option>',6),_hoisted_58$1=[_hoisted_52$1],_hoisted_59$1={class:"content-block"},_hoisted_60$1={value:"left"},_hoisted_61$1={value:"center"},_hoisted_62$1={value:"right"},_hoisted_63$1={class:"content-block"},_hoisted_64$1={class:"content-block"},_hoisted_65$1={class:"content-block"},_hoisted_66$1={value:"0"},_hoisted_67={value:"1"},_hoisted_68={value:"2"},_hoisted_69={value:"3"},_hoisted_70={value:"4"},_hoisted_71={value:"5"},_hoisted_72={class:"content-block"},_hoisted_73={class:"content-block"},_hoisted_74={value:"1"},_hoisted_75={value:"6"},_hoisted_76={class:"content-block"},_hoisted_77=["placeholder"],_hoisted_78={class:"content-block"},_hoisted_79={class:"content-block"},_hoisted_80={class:"button-content"},_hoisted_81={class:"content-block"},_hoisted_82={class:"button-content item-list"},_hoisted_83=["onClick"],_hoisted_84={class:"buttons"},_sfc_main$3w={__name:"RightPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=useDocumentStore(),r=getCurrentInstance().appContext.app.config.globalProperties,u=computed(()=>{if(v.value==="form"){if(x.value==="textfield")return r.$t("toolbar.formTools.textField");if(x.value==="checkbox")return r.$t("toolbar.formTools.checkbox");if(x.value==="radiobutton")return r.$t("toolbar.formTools.radioButton");if(x.value==="pushbutton")return r.$t("toolbar.formTools.button");if(x.value==="listbox")return r.$t("toolbar.formTools.listBox");if(x.value==="combobox")return r.$t("toolbar.formTools.comboButton")}else if(v.value==="sign"&&x.value==="signatureFields")return r.$t("toolbar.formTools.signataireField")}),s=computed(()=>n.getActiveElementTab("rightPanel")),w=computed(()=>n.isElementOpen("rightPanel"));computed(()=>o.getActiveTool);const m=computed(()=>o.getTotalPages),v=computed(()=>n.getToolMode);computed(()=>n.getRightPanelButtonDisabled);let g=reactive(o.propertyPanel),d=g.destPage,f=g.url;const y=ref(!1),x=ref(null),k=ref(null),P=ref(null),S=ref([]),E=ref(!0),M=ref("rgb(0, 0, 0)"),T=ref("rgb(0, 0, 0)"),D=ref(null);o.setProperty("indicatorText",r.$t("panels.right.general.fill"));const N=re=>{if(re==="fieldName"&&o.setPropertyPanel({fieldName:g.fieldName}),re==="title"&&o.setPropertyPanel({title:g.title}),re==="destPage"){const Pe=g.destPage;Pe!==""&&Pe!=d&&(o.setPropertyPanel({actionType:1,destPage:Pe.toString()}),d=Pe)}else if(re==="url"){let Pe=g.url;Pe!==""?(!Pe.startsWith("http://")&&!Pe.startsWith("https://")&&(Pe="https://"+Pe),o.setPropertyPanel({url:Pe,actionType:6}),f=Pe):g.url=f}};watch(()=>w.value,(re,Pe)=>{re&&(n.closeElement("pageModePanel"),g.indicatorText&&(D.value.focus(),D.value.blur()))}),watch(()=>g.isHidden,(re,Pe)=>{o.setPropertyPanel({isHidden:re}),g.indicator&&(g.indicator=!1)}),watch(()=>g.fillColor,(re,Pe)=>{o.setPropertyPanel({fillColor:re})}),watch(()=>g.color,(re,Pe)=>{o.setPropertyPanel({color:re})}),watch(()=>g.fontName,(re,Pe)=>{o.setPropertyPanel({fontName:re})}),watch(()=>g.fontStyle,(re,Pe)=>{const be=/bold/i.test(re)?"bold":"normal",we=/(oblique|italic)/i.test(re)?"oblique":"normal";o.setPropertyPanel({fontWeight:be,fontStyle:we})}),watch(()=>g.fontSize,(re,Pe)=>{o.setPropertyPanel({fontSize:re})}),watch(()=>g.textAlignment,(re,Pe)=>{o.setPropertyPanel({textAlignment:re})}),watch(()=>g.isMultiLine,(re,Pe)=>{o.setPropertyPanel({isMultiLine:re})}),watch(()=>g.projectList,(re,Pe)=>{o.setPropertyPanel({projectList:re})}),watch(()=>g.checkStyle,(re,Pe)=>{o.setPropertyPanel({checkStyle:parseInt(re)})}),watch(()=>g.isChecked,(re,Pe)=>{o.setPropertyPanel({isChecked:+re})}),watch(()=>g.required,(re,Pe)=>{o.setPropertyPanel({required:+re})}),watch(()=>g.indicator,(re,Pe)=>{if(o.setPropertyPanel({indicator:re}),re&&!g.indicatorText){const be=x.value==="signatureFields"?r.$t("panels.right.general.signHere"):r.$t("panels.right.general.fill");g.indicatorText=be}}),watch(()=>g.indicatorText,(re,Pe)=>{o.setPropertyPanel({indicatorText:re})}),watch(()=>g.actionType,(re,Pe)=>{(re==="1"&&g.destPage!==""||re==="2"&&g.url!=="")&&o.setPropertyPanel({actionType:re})}),watch(()=>g.destPage,(re,Pe)=>{const be=/^\d+$/;re!==""&&(re>m.value||re<=0||!be.test(re))&&(g.destPage=Pe)});const I=re=>{if(k.value="",P.value=null,g.required=0,g.indicator=!1,g.indicatorText="",re)x.value=re.type.replace("-",""),(x.value==="listbox"||x.value==="combobox"||x.value==="pushbutton")&&n.setActiveElementTab("rightPanel","PREFERENCE"),x.value!=="checkbox"&&(E.value=!0);else{x.value=null,Q();return}for(const Pe in re)for(const be in g)if(Pe===be){if(Pe==="fontStyle"||Pe==="fontWeight"){const we=re.fontWeight||"normal",Ae=re.fontStyle||"normal";we==="bold"&&Ae==="oblique"?g.fontStyle="boldOblique":we==="bold"?g.fontStyle="bold":Ae==="oblique"?g.fontStyle="oblique":g.fontStyle="normal";continue}be==="items"?S.value=Array.from(re[Pe]):g[be]=re[Pe]}},O=re=>{re==="editor"?n.toggleElement("contentEditorPanel"):n.toggleElement("rightPanel")},F=(re,Pe)=>{g[re]=Pe},q=()=>{g.isChecked=!g.isChecked},Y=()=>{g.required=!g.required},_e=()=>{g.indicator=!g.indicator},ne=()=>{const re=g.contents===""?" ":g.contents;o.setPropertyPanel({contents:re})},ve=re=>{y.value=re};core.addEvent("judgeRadioBtnIsOne",ve);const J=re=>{E.value=re};core.addEvent("judgeCheckboxIsOne",J);const fe=(re,Pe)=>{P.value=re,k.value=Pe},Z=()=>{for(var re=0;re<S.value.length;re++)if(S.value[re]===k.value)return;if(k.value)S.value.push({Value:k.value,String:k.value});else return;P.value=null,o.setPropertyPanel({item:k.value}),k.value=""},j=()=>{for(var re=0;re<S.value.length;re++)S.value[re]===S.value[P.value]&&(S.value.splice(re,1),o.setPropertyPanel({deleteItemIndex:re,selected:0}),k.value="",P.value=null)},X=()=>{if(!!P.value){for(var re=0;re<S.value.length;re++)if(S.value[re]===S.value[P.value]){S.value.splice(re-1,2,S.value[re],S.value[re-1]),o.setPropertyPanel({moveOption:{fromIndex:re,toIndex:re-1}}),P.value-=1;break}}},H=()=>{if(P.value!==S.value.length-1){for(var re=0;re<S.value.length;re++)if(S.value[re]===S.value[P.value]&&re<S.value.length-1){S.value.splice(re,2,S.value[re+1],S.value[re]),o.setPropertyPanel({moveOption:{fromIndex:re,toIndex:re+1}}),P.value+=1;break}}},U=(re,Pe)=>{Pe==="fillColor"&&(M.value=re),Pe==="color"&&(T.value=re)},te=(re,Pe)=>{areColorsSimilar(re,g[Pe])||F(Pe,re)},Q=()=>{n.closeElement("rightPanel")};return core.addEvent("propertyChange",I),core.addEvent("toggleAttrbutePanel",O),core.addEvent("annotationDeselected",()=>{Q()}),(re,Pe)=>{const be=__unplugin_components_14$2,we=_sfc_main$3x,Ae=__unplugin_components_1$g,$e=__unplugin_components_3$d,Me=__unplugin_components_4$d,Ie=__unplugin_components_5$7,Le=__unplugin_components_6$7,le=__unplugin_components_7$5;return openBlock(),createElementBlock("div",{class:normalizeClass(["right-panel",{closed:!w.value,mobile:unref(isMobileDevice)}]),style:normalizeStyle({height:unref(isMobileDevice)?"70%":e.isHeaderDisabled?"100%":"calc(100% - 88px)"})},[createBaseVNode("div",_hoisted_1$37,[createTextVNode(toDisplayString(u.value)+" ",1),unref(isMobileDevice)?(openBlock(),createBlock(be,{key:0,class:"close-button",onClick:Q})):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_2$2V,[createVNode(we,{activePanelTab:s.value,selectedElement:x.value},null,8,["activePanelTab","selectedElement"])]),createBaseVNode("div",_hoisted_3$2E,[withDirectives(createBaseVNode("div",{class:"radio-top-tip"},toDisplayString(re.$t("panels.right.preferences.radioTips")[0]),513),[[vShow,y.value&&x.value==="radiobutton"]]),createBaseVNode("div",{class:normalizeClass(["general-container",{hidden:s.value!=="GENERAL"}])},[createBaseVNode("div",_hoisted_4$10,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.general.name")),1),withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":Pe[0]||(Pe[0]=oe=>unref(g).fieldName=oe),onBlur:Pe[1]||(Pe[1]=oe=>N("fieldName")),name:"form"},null,544),[[vModelText,unref(g).fieldName]]),E.value?createCommentVNode("",!0):(openBlock(),createElementBlock("p",_hoisted_5$D,toDisplayString(re.$t("panels.right.general.nameConflict")),1))]),x.value==="pushbutton"&&v.value==="form"?(openBlock(),createElementBlock("div",_hoisted_6$t,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.general.buttonText")),1),withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":Pe[2]||(Pe[2]=oe=>unref(g).title=oe),onBlur:Pe[3]||(Pe[3]=oe=>N("title")),name:"form"},null,544),[[vModelText,unref(g).title]])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_7$l,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.general.formField")),1),withDirectives(createBaseVNode("select",{name:"field",id:"field","onUpdate:modelValue":Pe[4]||(Pe[4]=oe=>unref(g).isHidden=oe)},[createBaseVNode("option",_hoisted_8$i,toDisplayString(re.$t("panels.right.general.visibility.visible")),1),createBaseVNode("option",_hoisted_9$h,toDisplayString(re.$t("panels.right.general.visibility.hidden")),1)],512),[[vModelSelect,unref(g).isHidden]])]),createBaseVNode("div",_hoisted_10$g,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.general.properties")),1),createBaseVNode("div",{class:"check-box",onClick:Y},[createBaseVNode("div",{class:normalizeClass(["check",{active:unref(g).required}])},[withDirectives(createVNode(Ae,null,null,512),[[vShow,unref(g).required]])],2),createBaseVNode("span",null,toDisplayString(re.$t("panels.right.general.required")),1)]),x.value!=="pushbutton"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["indicator-box",unref(g).isHidden==="1"&&"disabled"])},[createBaseVNode("div",{class:normalizeClass(["check",{active:unref(g).indicator}]),onClick:_e},[withDirectives(createVNode(Ae,null,null,512),[[vShow,unref(g).indicator]])],2),createBaseVNode("div",_hoisted_11$d,[createBaseVNode("div",{class:"label",onClick:_e},toDisplayString(re.$t("panels.right.general.indicator")),1),withDirectives(createBaseVNode("div",null,[withDirectives(createBaseVNode("input",{ref_key:"inputRef",ref:D,type:"text","onUpdate:modelValue":Pe[5]||(Pe[5]=oe=>unref(g).indicatorText=oe)},null,512),[[vModelText,unref(g).indicatorText]])],512),[[vShow,unref(g).indicator]])])],2)):createCommentVNode("",!0)])],2),createBaseVNode("div",{class:normalizeClass(["appearance-container",{hidden:s.value!=="APPEARANCE"}])},[createBaseVNode("div",_hoisted_12$c,[createBaseVNode("h2",_hoisted_13$c,toDisplayString(re.$t("panels.right.appearance.backgroundColor")),1),createBaseVNode("div",_hoisted_14$c,[createBaseVNode("span",_hoisted_15$c,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).fillColor,"rgb(251, 189, 191)")}]),onClick:Pe[6]||(Pe[6]=oe=>F("fillColor","rgb(251, 189, 191)"))},_hoisted_17$a,2)]),createBaseVNode("span",_hoisted_18$9,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).fillColor,"rgb(255, 255, 255)")}]),onClick:Pe[7]||(Pe[7]=oe=>F("fillColor","rgb(255, 255, 255)"))},_hoisted_20$9,2)]),createBaseVNode("span",_hoisted_21$9,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).fillColor,"rgb(253, 244, 178)")||unref(areColorsSimilar)(unref(g).fillColor,"rgb(253, 244, 177)")}]),onClick:Pe[8]||(Pe[8]=oe=>F("fillColor","rgb(253, 244, 178)"))},_hoisted_23$7,2)]),createBaseVNode("span",_hoisted_24$7,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).fillColor,"rgb(221, 233, 255)")}]),onClick:Pe[9]||(Pe[9]=oe=>F("fillColor","rgb(221, 233, 255)"))},_hoisted_26$7,2)]),createBaseVNode("div",_hoisted_27$6,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:M.value})},null,4),createVNode(unref(NColorPicker),{to:".right-panel",onComplete:Pe[10]||(Pe[10]=oe=>te(oe,"fillColor")),"onUpdate:value":Pe[11]||(Pe[11]=oe=>U(oe,"fillColor")),value:M.value,"show-alpha":!1},{label:withCtx(()=>[createVNode($e)]),_:1},8,["value"])])])]),(x.value==="textfield"||x.value==="pushbutton"||x.value==="combobox"||x.value==="listbox")&&v.value==="form"?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_28$6,[createBaseVNode("h2",_hoisted_29$5,toDisplayString(re.$t("common.uiElements.font")),1),createBaseVNode("div",_hoisted_30$5,[createBaseVNode("span",_hoisted_31$5,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).color,"rgb(255, 0, 0)")}]),onClick:Pe[12]||(Pe[12]=oe=>F("color","rgb(255, 0, 0)"))},_hoisted_33$3,2)]),createBaseVNode("span",_hoisted_34$3,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).color,"rgb(0, 0, 0)")}]),onClick:Pe[13]||(Pe[13]=oe=>F("color","rgb(0, 0, 0)"))},_hoisted_36$2,2)]),createBaseVNode("span",_hoisted_37$2,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:unref(areColorsSimilar)(unref(g).color,"rgb(45, 119, 250)")||unref(areColorsSimilar)(unref(g).color,"rgb(45, 119, 249)")}]),onClick:Pe[14]||(Pe[14]=oe=>F("color","rgb(45, 119, 250)"))},_hoisted_39$2,2)]),createBaseVNode("div",_hoisted_40$2,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:T.value})},null,4),createVNode(unref(NColorPicker),{to:".right-panel",onComplete:Pe[15]||(Pe[15]=oe=>te(oe,"color")),"onUpdate:value":Pe[16]||(Pe[16]=oe=>U(oe,"color")),value:T.value,"show-alpha":!1},{label:withCtx(()=>[createVNode($e)]),_:1},8,["value"])])])]),createBaseVNode("div",_hoisted_41$2,[withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Pe[17]||(Pe[17]=oe=>unref(g).fontName=oe)},_hoisted_45$1,512),[[vModelSelect,unref(g).fontName]])]),createBaseVNode("div",_hoisted_46$1,[createBaseVNode("div",_hoisted_47$1,[withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Pe[18]||(Pe[18]=oe=>unref(g).fontStyle=oe),class:"font-family-select"},[createBaseVNode("option",_hoisted_48$1,toDisplayString(re.$t("common.fontStyles.regular")),1),createBaseVNode("option",_hoisted_49$1,toDisplayString(re.$t("common.fontStyles.bold")),1),createBaseVNode("option",_hoisted_50$1,toDisplayString(re.$t("common.fontStyles.oblique")),1),createBaseVNode("option",_hoisted_51$1,toDisplayString(re.$t("common.fontStyles.boldOblique")),1)],512),[[vModelSelect,unref(g).fontStyle]]),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Pe[19]||(Pe[19]=oe=>unref(g).fontSize=oe),class:"font-size-select"},_hoisted_58$1,512),[[vModelSelect,unref(g).fontSize]])])])],64)):createCommentVNode("",!0)],2),createBaseVNode("div",{class:normalizeClass(["preferences-container",{hidden:s.value!=="PREFERENCE"}])},[x.value==="textfield"&&v.value==="form"?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_59$1,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.alignment.title")),1),withDirectives(createBaseVNode("select",{name:"alignment",id:"alignment","onUpdate:modelValue":Pe[20]||(Pe[20]=oe=>unref(g).textAlignment=oe)},[createBaseVNode("option",_hoisted_60$1,toDisplayString(re.$t("panels.right.preferences.alignment.left")),1),createBaseVNode("option",_hoisted_61$1,toDisplayString(re.$t("panels.right.preferences.alignment.center")),1),createBaseVNode("option",_hoisted_62$1,toDisplayString(re.$t("panels.right.preferences.alignment.right")),1)],512),[[vModelSelect,unref(g).textAlignment]])]),createBaseVNode("div",_hoisted_63$1,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.defaultValue")),1),withDirectives(createBaseVNode("textarea",{name:"default-value",id:"default-value",rows:"3","onUpdate:modelValue":Pe[21]||(Pe[21]=oe=>unref(g).contents=oe),onChange:ne},null,544),[[vModelText,unref(g).contents]])]),createBaseVNode("div",_hoisted_64$1,[createBaseVNode("div",{class:"check-box",onClick:Pe[22]||(Pe[22]=oe=>unref(g).isMultiLine=!unref(g).isMultiLine)},[createBaseVNode("div",{class:normalizeClass(["check",{active:unref(g).isMultiLine}])},[withDirectives(createVNode(Ae,null,null,512),[[vShow,unref(g).isMultiLine]])],2),createBaseVNode("span",null,toDisplayString(re.$t("panels.right.preferences.multiLine")),1)])])],64)):createCommentVNode("",!0),(x.value==="checkbox"||x.value==="radiobutton")&&v.value==="form"?(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("div",_hoisted_65$1,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.buttonStyle")),1),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Pe[23]||(Pe[23]=oe=>unref(g).checkStyle=oe)},[createBaseVNode("option",_hoisted_66$1,toDisplayString(re.$t("panels.right.preferences.styles.check")),1),createBaseVNode("option",_hoisted_67,toDisplayString(re.$t("panels.right.preferences.styles.circle")),1),createBaseVNode("option",_hoisted_68,toDisplayString(re.$t("panels.right.preferences.styles.cross")),1),createBaseVNode("option",_hoisted_69,toDisplayString(re.$t("panels.right.preferences.styles.diamond")),1),createBaseVNode("option",_hoisted_70,toDisplayString(re.$t("panels.right.preferences.styles.square")),1),createBaseVNode("option",_hoisted_71,toDisplayString(re.$t("panels.right.preferences.styles.star")),1)],512),[[vModelSelect,unref(g).checkStyle]])]),createBaseVNode("div",_hoisted_72,[createBaseVNode("div",{class:"check-box",onClick:q},[createBaseVNode("div",{class:normalizeClass(["check",{active:unref(g).isChecked}])},[withDirectives(createVNode(Ae,null,null,512),[[vShow,unref(g).isChecked]])],2),createBaseVNode("span",null,toDisplayString(re.$t("panels.right.preferences.defaultChecked")),1)])])],64)):createCommentVNode("",!0),x.value==="pushbutton"&&v.value==="form"?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("div",_hoisted_73,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.selectAction.title")),1),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Pe[24]||(Pe[24]=oe=>unref(g).actionType=oe)},[withDirectives(createBaseVNode("option",{value:"0"},toDisplayString(re.$t("panels.right.preferences.selectAction.none")),513),[[vShow,unref(g).actionType==0]]),createBaseVNode("option",_hoisted_74,toDisplayString(re.$t("panels.right.preferences.selectAction.goPage")),1),createBaseVNode("option",_hoisted_75,toDisplayString(re.$t("panels.right.preferences.selectAction.openLink")),1)],512),[[vModelSelect,unref(g).actionType]])]),withDirectives(createBaseVNode("div",_hoisted_76,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.selectAction.goPage")),1),withDirectives(createBaseVNode("input",{type:"text",pattern:"\\d*",placeholder:re.$t("panels.right.preferences.addResource.page"),"onUpdate:modelValue":Pe[25]||(Pe[25]=oe=>unref(g).destPage=oe),onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onBlur:Pe[26]||(Pe[26]=oe=>N("destPage")),name:"form"},null,40,_hoisted_77),[[vModelText,unref(g).destPage]])],512),[[vShow,unref(g).actionType==1]]),withDirectives(createBaseVNode("div",_hoisted_78,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.selectAction.openLink")),1),withDirectives(createBaseVNode("input",{type:"text",placeholder:"https://","onUpdate:modelValue":Pe[27]||(Pe[27]=oe=>unref(g).url=oe),onBlur:Pe[28]||(Pe[28]=oe=>N("url")),name:"form"},null,544),[[vModelText,unref(g).url]])],512),[[vShow,unref(g).actionType==6]])],64)):createCommentVNode("",!0),(x.value==="combobox"||x.value==="listbox")&&v.value==="form"?(openBlock(),createElementBlock(Fragment,{key:3},[createBaseVNode("div",_hoisted_79,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.item")),1),createBaseVNode("div",_hoisted_80,[withDirectives(createBaseVNode("input",{type:"text",class:"item","onUpdate:modelValue":Pe[29]||(Pe[29]=oe=>k.value=oe),name:"form"},null,512),[[vModelText,k.value,void 0,{trim:!0}]]),createBaseVNode("div",{class:normalizeClass(["operate-button",{disabled:!k.value}]),onClick:Z},[createVNode(Me)],2)])]),createBaseVNode("div",_hoisted_81,[createBaseVNode("h2",null,toDisplayString(re.$t("panels.right.preferences.itemList")),1),createBaseVNode("div",_hoisted_82,[createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(S.value,(oe,ke)=>(openBlock(),createElementBlock("li",{key:ke,class:normalizeClass({active:ke===P.value}),onClick:Ce=>fe(ke,oe.Value)},toDisplayString(oe.Value),11,_hoisted_83))),128))]),createBaseVNode("div",_hoisted_84,[createBaseVNode("div",{class:normalizeClass(["operate-button",{disabled:!P.value&&P.value!==0}]),onClick:j},[createVNode(Ie)],2),createBaseVNode("div",{class:normalizeClass(["operate-button",{disabled:P.value===0||!P.value}]),onClick:X},[createVNode(Le)],2),createBaseVNode("div",{class:normalizeClass(["operate-button",{disabled:P.value===S.value.length-1||!P.value&&P.value!==0}]),onClick:H},[createVNode(le)],2)])])])],64)):createCommentVNode("",!0)],2),withDirectives(createBaseVNode("div",{class:"radio-bottom-tip"},toDisplayString(re.$t("panels.right.preferences.radioTips")[1]),513),[[vShow,x.value==="radiobutton"]]),withDirectives(createBaseVNode("div",{class:"radio-bottom-tip"},toDisplayString(re.$t("panels.right.preferences.listBoxTip")),513),[[vShow,x.value==="combobox"]])])],6)}}},MovePageSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$36={key:0,class:"move-page-popup"},_hoisted_2$2U=["placeholder"],dialogName$i="movePageSettingDialog",_sfc_main$3v={__name:"MovePageSettingDialog",props:["totalPages","selectedPageList"],emits:["movePage"],setup(e,{emit:n}){const o=e,r=n,u=useViewerStore(),s=computed(()=>u.isElementOpen(dialogName$i)),w=ref("");let m=!1;const v=computed(()=>{if(typeof w.value!="number")return!0;const P=o.selectedPageList;return!!(P.length===1&&(P[0]===w.value||P[0]===w.value-1)||P.length>1&&g(P)&&(P.includes(w.value)||P.includes(w.value-1)))}),g=P=>{P.sort(function(E,M){return E-M});for(var S=0;S<P.length-1;S++)if(P[S]+1!==P[S+1])return!1;return!0},d=()=>{u.closeElement(dialogName$i),w.value=""},f=async()=>{r("movePage",w.value),d()},y=P=>{if(m)return;const S=P.target.valueAsNumber;isNaN(S)&&(P.target.value=""),S>o.totalPages&&(w.value=o.totalPages),S===0&&(P.target.value=S.toFixed(0))},x=()=>{m=!0},k=()=>{m=!1};return(P,S)=>{const E=_sfc_main$4v;return s.value?(openBlock(),createElementBlock("div",_hoisted_1$36,[createVNode(E,{show:s.value,dialogName:dialogName$i,close:!0},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(P.$t("documentEditor.moveTo")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:v.value}]),onClick:f},toDisplayString(P.$t("common.actions.ok")),3)]),default:withCtx(()=>[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":S[0]||(S[0]=M=>w.value=M),type:"number",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onInput:y,placeholder:P.$t("documentEditor.pageInputTip"),onCompositionstart:x,onCompositionend:k,name:"document-editor"},null,40,_hoisted_2$2U),[[vModelText,w.value,void 0,{number:!0}]])]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$3u={},_hoisted_1$35={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2T=createBaseVNode("g",{id:"ic_btn_radio_dis"},[createBaseVNode("circle",{id:"ic",cx:"7",cy:"7",r:"5.625",fill:"white",stroke:"#666666"})],-1),_hoisted_3$2D=[_hoisted_2$2T];function _sfc_render$21(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$35,_hoisted_3$2D)}const __unplugin_components_1$a=_export_sfc(_sfc_main$3u,[["render",_sfc_render$21]]),_sfc_main$3t={},_hoisted_1$34={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2S=createBaseVNode("g",{id:"ic_btn_radio_sel"},[createBaseVNode("circle",{id:"Radio",cx:"7",cy:"7",r:"6.125",fill:"#1460F3"}),createBaseVNode("circle",{id:"Radio_2",cx:"7",cy:"7",r:"2.625",fill:"white"})],-1),_hoisted_3$2C=[_hoisted_2$2S];function _sfc_render$20(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$34,_hoisted_3$2C)}const __unplugin_components_0$w=_export_sfc(_sfc_main$3t,[["render",_sfc_render$20]]),ExtractPageSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$33={key:0,class:"extract-page-setting-popup"},_hoisted_2$2R={class:"title"},_hoisted_3$2B={class:"container"},_hoisted_4$$={class:"select-content"},_hoisted_5$C={key:0,class:"disabled-btn"},_hoisted_6$s={class:"addition"},_hoisted_7$k=["placeholder"],_hoisted_8$h={class:"check-content"},dialogName$h="extractPageSettingDialog",_sfc_main$3s={__name:"ExtractPageSettingDialog",props:["selectedPageList","totalPages"],emits:["extractPage"],setup(e,{emit:n}){const o=e,r=n,u=useViewerStore(),s=computed(()=>u.isElementOpen(dialogName$h)),w=ref("custom"),m=ref(""),v=ref(""),g=ref(!1),d=ref(!1);let f="";watch(()=>s.value,(M,T)=>{if(M){const D=o.selectedPageList.map(function(N){return N+1}).join(",");f=P(D),m.value=v.value=f}});const y=()=>{u.closeElement(dialogName$h),w.value="custom"},x=async()=>{const M={range:w.value==="custom"?m.value:w.value,separateFile:g.value,deleteAfter:w.value==="all"?!1:d.value};r("extractPage",M),y()},k=()=>{v.value=P(m.value),m.value=v.value},P=M=>{const T=o.totalPages,N=M.replace(/\s/g,"").match(/\d+-\d+|\d+|\d+/g);if(N){const I=N.flatMap(Y=>{if(Y.includes("-")){const[_e,ne]=Y.split("-"),ve=Math.min(_e,ne),J=Math.min(Math.max(_e,ne),T);return Array.from({length:J-ve+1},(fe,Z)=>String(Number(ve)+Z))}else return Math.min(Math.max(Y,1),T)}).sort((Y,_e)=>Y-_e),O=[];let F=I[0],q=I[0];for(let Y=1;Y<I.length;Y++){const _e=I[Y],ne=Number(q);Number(_e)-ne>1&&(O.push(S(F,q)),F=_e),q=_e}return O.push(S(F,q)),O.join(", ")}return f},S=(M,T)=>M===T?M.toString():`${M}-${T}`,E=computed(()=>{if(w.value==="all"||o.totalPages===1&&w.value!=="even"||o.totalPages>1&&w.value==="custom"&&m.value==="1-"+o.totalPages)return!0});return(M,T)=>{const D=__unplugin_components_0$w,N=__unplugin_components_1$a,I=__unplugin_components_1$g,O=_sfc_main$4v;return s.value?(openBlock(),createElementBlock("div",_hoisted_1$33,[createVNode(O,{show:s.value,dialogName:dialogName$h,close:!1},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(M.$t("documentEditor.extract")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:y},toDisplayString(M.$t("common.actions.cancel")),1),createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:w.value==="pdf"&&(!M.inputFile||w.value==="custom"&&!v.value)}]),onClick:x},toDisplayString(M.$t("documentEditor.extract")),3)]),default:withCtx(()=>[createBaseVNode("p",_hoisted_2$2R,toDisplayString(M.$t("documentEditor.dialog.pageRange")),1),createBaseVNode("div",_hoisted_3$2B,[createBaseVNode("div",_hoisted_4$$,[createBaseVNode("div",{onClick:T[0]||(T[0]=F=>w.value="all"),class:"option"},[w.value==="all"?(openBlock(),createBlock(D,{key:0})):(openBlock(),createBlock(N,{key:1})),createTextVNode(toDisplayString(M.$t("documentEditor.dialog.allPages")),1)]),createBaseVNode("div",{onClick:T[1]||(T[1]=F=>w.value="odd"),class:"option"},[w.value==="odd"?(openBlock(),createBlock(D,{key:0})):(openBlock(),createBlock(N,{key:1})),createTextVNode(toDisplayString(M.$t("documentEditor.dialog.oddPage")),1)]),createBaseVNode("div",{onClick:T[2]||(T[2]=F=>w.value="even"),class:normalizeClass(["option",{disabled:e.totalPages===1}])},[e.totalPages===1?(openBlock(),createElementBlock("div",_hoisted_5$C)):w.value==="even"?(openBlock(),createBlock(D,{key:1})):(openBlock(),createBlock(N,{key:2})),createTextVNode(" "+toDisplayString(M.$t("documentEditor.dialog.evenPage")),1)],2),createBaseVNode("div",{onClick:T[4]||(T[4]=F=>w.value="custom"),class:"option custom-page"},[w.value==="custom"?(openBlock(),createBlock(D,{key:0})):(openBlock(),createBlock(N,{key:1})),createTextVNode(toDisplayString(M.$t("documentEditor.dialog.page"))+" ",1),createBaseVNode("div",_hoisted_6$s,[withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":T[3]||(T[3]=F=>m.value=F),placeholder:M.$t("documentEditor.dialog.tip"),onBlur:k,name:"document-editor"},null,40,_hoisted_7$k),[[vModelText,m.value]]),createBaseVNode("span",null,"/ "+toDisplayString(e.totalPages),1)])])])]),createBaseVNode("div",_hoisted_8$h,[createBaseVNode("div",{class:"check-box",onClick:T[5]||(T[5]=F=>g.value=!g.value)},[createBaseVNode("div",{class:normalizeClass(["check",{active:g.value}])},[withDirectives(createVNode(I,null,null,512),[[vShow,g.value]])],2),createBaseVNode("span",null,toDisplayString(M.$t("documentEditor.separateFiles")),1)]),createBaseVNode("div",{class:normalizeClass(["check-box",{disabled:E.value}]),onClick:T[6]||(T[6]=()=>{E.value||(d.value=!d.value)})},[createBaseVNode("div",{class:normalizeClass(["check",{active:d.value}])},[withDirectives(createVNode(I,null,null,512),[[vShow,d.value&&!E.value]])],2),createBaseVNode("span",null,toDisplayString(M.$t("documentEditor.deleteAfter")),1)],2)])]),_:1},8,["show"])])):createCommentVNode("",!0)}}},DeletePageDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$32={key:0,class:"delete-page-popup"},dialogName$g="deletePageDialog",_sfc_main$3r={__name:"DeletePageDialog",props:["selectedPageList"],emits:["deletePage"],setup(e,{emit:n}){const{i18next:o}=useTranslation(),r=e,u=n,s=useViewerStore(),w=computed(()=>s.isElementOpen(dialogName$g)),m=computed(()=>r.selectedPageList.sort((d,f)=>d-f).map(d=>d+1).join(", ")),v=()=>{s.closeElement(dialogName$g)},g=async()=>{u("deletePage"),v()};return(d,f)=>{const y=__unplugin_components_2$f,x=_sfc_main$4v;return w.value?(openBlock(),createElementBlock("div",_hoisted_1$32,[createVNode(x,{show:w.value,dialogName:dialogName$g,close:!1},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:v},toDisplayString(d.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:g},toDisplayString(d.$t("common.actions.delete")),1)]),default:withCtx(()=>[createVNode(y),createBaseVNode("p",null,toDisplayString(d.$t("documentEditor.deleteConfirmation"))+toDisplayString(unref(o).language==="en"?` ${m.value}?`:""),1)]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$3q={},_hoisted_1$31={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2Q=createBaseVNode("path",{d:"M6.82225 3.96144L6.99439 4.05909H7.19231H11.75V13.25H1.25V2.75H4.6867L6.82225 3.96144Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$2A=createBaseVNode("path",{d:"M1.55867 13.25L3.84383 6.75H14.4413L12.1562 13.25H1.55867Z",fill:"transparent",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$_=[_hoisted_2$2Q,_hoisted_3$2A];function _sfc_render$1$(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$31,_hoisted_4$_)}const __unplugin_components_0$v=_export_sfc(_sfc_main$3q,[["render",_sfc_render$1$]]),_sfc_main$3p={},_hoisted_1$30={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2P=createBaseVNode("g",{id:"ic_btn_arrow_down"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.0596 5.90869L11.9398 6.72429L8.24969 10.7068L4.55957 6.72429L5.4398 5.90869L8.24969 8.94084L11.0596 5.90869Z",fill:"currentColor"})],-1),_hoisted_3$2z=[_hoisted_2$2P];function _sfc_render$1_(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$30,_hoisted_3$2z)}const __unplugin_components_0$u=_export_sfc(_sfc_main$3p,[["render",_sfc_render$1_]]),InsertPageSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$2$={key:0,class:"add-page-setting-popup"},_hoisted_2$2O={class:"title"},_hoisted_3$2y={class:"container"},_hoisted_4$Z={class:"select-content"},_hoisted_5$B={key:0,class:"addition"},_hoisted_6$r=createBaseVNode("option",{value:"A3"},"A3",-1),_hoisted_7$j=createBaseVNode("option",{value:"A4"},"A4",-1),_hoisted_8$g=createBaseVNode("option",{value:"A5"},"A5",-1),_hoisted_9$g=[_hoisted_6$r,_hoisted_7$j,_hoisted_8$g],_hoisted_10$f={key:1,class:"addition"},_hoisted_11$c={class:"file-input-underbox"},_hoisted_12$b={key:2,class:"addition from-pdf"},_hoisted_13$b={class:"addition"},_hoisted_14$b={value:"all"},_hoisted_15$b={value:"odd"},_hoisted_16$a={value:"even"},_hoisted_17$9={value:"custom"},_hoisted_18$8=["placeholder"],_hoisted_19$8={class:"title"},_hoisted_20$8={class:"container"},_hoisted_21$8={class:"select-content"},_hoisted_22$8={class:"left"},_hoisted_23$6={key:0,class:"right"},_hoisted_24$6={class:"addition"},_hoisted_25$6=["max"],_hoisted_26$6={class:"addition"},_hoisted_27$5={value:0},_hoisted_28$5={value:1},dialogName$f="insertPageSettingDialog",_sfc_main$3o={__name:"InsertPageSettingDialog",props:["selectedPageList","totalPages"],emits:["insertPage"],setup(e,{emit:n}){const o=e,r=n,u=useViewerStore(),s=computed(()=>u.isElementOpen(dialogName$f)),w=ref("blank"),m=ref("A4"),v=ref(null),g=ref("all"),d=ref(""),f=ref(""),y=ref("first"),x=ref(1),k=ref(1),P=ref("");watch(()=>s.value,(F,q)=>{F&&(o.selectedPageList.length>0&&(y.value="custom"),x.value=o.selectedPageList[0]+1)});const S=()=>{u.closeElement(dialogName$f),w.value="blank",m.value="A4",v.value=null,g.value="all",d.value="",f.value="",y.value="first",k.value=1,P.value=""},E=async()=>{const F={type:w.value==="pdf"?"pdf":"blank"};if(w.value==="custom"){const q={A3:{width:297,height:420},A4:{width:210,height:297},A5:{width:148,height:210}};F.size={width:q[m.value].width/25.4*72,height:q[m.value].height/25.4*72}}w.value==="pdf"&&v.value&&(F.file=v.value,F.range=g.value==="custom"?d.value:g.value,F.password=P.value),y.value==="custom"?(F.place=x.value-1+k.value,F.targetPlace=k.value):y.value==="last"?F.place=o.totalPages:F.place=0,r("insertPage",F),S()},M=async F=>{if(!F.target.files[0])return;let q=URL.createObjectURL(F.target.files[0]);const Y=await core.checkPassword(q,!0);if(Y===!1){F.target.value="";return}v.value=F.target.files[0],P.value=Y},T=F=>{const q=F.target.valueAsNumber;q>o.totalPages?x.value=o.totalPages:q<1&&(x.value=1)},D=()=>{x.value||(x.value=1)},N=()=>{f.value=I(d.value),d.value=f.value},I=F=>{const Y=F.replace(/\s/g,"").match(/\d+-\d+|\d+|\d+/g);if(Y){const _e=Y.flatMap(fe=>{if(fe.includes("-")){const[Z,j]=fe.split("-"),X=Math.max(1,Math.min(Z,j)),H=Math.max(1,Z,j);return Array.from({length:H-X+1},(U,te)=>String(Number(X)+te))}else return Math.max(1,fe)}).sort((fe,Z)=>fe-Z),ne=[];let ve=_e[0],J=_e[0];for(let fe=1;fe<_e.length;fe++){const Z=_e[fe],j=Number(J);Number(Z)-j>1&&(ne.push(O(ve,J)),ve=Z),J=Z}return ne.push(O(ve,J)),ne.join(", ")}return"1"},O=(F,q)=>F===q?F.toString():`${F}-${q}`;return(F,q)=>{const Y=__unplugin_components_0$w,_e=__unplugin_components_1$a,ne=__unplugin_components_0$u,ve=__unplugin_components_0$v,J=_sfc_main$4v;return s.value?(openBlock(),createElementBlock("div",_hoisted_1$2$,[createVNode(J,{show:s.value,dialogName:dialogName$f,close:!1},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:S},toDisplayString(F.$t("common.actions.cancel")),1),createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:w.value==="pdf"&&(!v.value||g.value==="custom"&&!f.value)}]),onClick:E},toDisplayString(F.$t("documentEditor.insert")),3)]),default:withCtx(()=>{var fe,Z;return[createBaseVNode("p",_hoisted_2$2O,toDisplayString(F.$t("documentEditor.dialog.insertPages")),1),createBaseVNode("div",_hoisted_3$2y,[createBaseVNode("div",_hoisted_4$Z,[createBaseVNode("div",{onClick:q[0]||(q[0]=j=>w.value="blank"),class:"option"},[w.value==="blank"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.blankPage")),1)]),createBaseVNode("div",{onClick:q[1]||(q[1]=j=>w.value="custom"),class:"option"},[w.value==="custom"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.customPage")),1)]),w.value==="custom"?(openBlock(),createElementBlock("div",_hoisted_5$B,[withDirectives(createBaseVNode("select",{name:"customPageSize","onUpdate:modelValue":q[2]||(q[2]=j=>m.value=j)},_hoisted_9$g,512),[[vModelSelect,m.value]]),createVNode(ne)])):createCommentVNode("",!0),createBaseVNode("div",{onClick:q[3]||(q[3]=j=>w.value="pdf"),class:"option"},[w.value==="pdf"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.fromPdf")),1)]),w.value==="pdf"?(openBlock(),createElementBlock("div",_hoisted_10$f,[createBaseVNode("div",_hoisted_11$c,[createBaseVNode("span",{class:normalizeClass({uploaded:(fe=v.value)==null?void 0:fe.name})},toDisplayString(((Z=v.value)==null?void 0:Z.name)||F.$t("documentEditor.dialog.selectFile")),3),createVNode(ve)]),createBaseVNode("input",{type:"file",onChange:M,accept:".pdf",name:"document-editor"},null,32)])):createCommentVNode("",!0),w.value==="pdf"?(openBlock(),createElementBlock("div",_hoisted_12$b,[createBaseVNode("span",null,toDisplayString(F.$t("documentEditor.dialog.pageRange")),1),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_13$b,[withDirectives(createBaseVNode("select",{name:"inputFileRange","onUpdate:modelValue":q[4]||(q[4]=j=>g.value=j)},[createBaseVNode("option",_hoisted_14$b,toDisplayString(F.$t("documentEditor.dialog.allPages")),1),createBaseVNode("option",_hoisted_15$b,toDisplayString(F.$t("documentEditor.dialog.oddPage")),1),createBaseVNode("option",_hoisted_16$a,toDisplayString(F.$t("documentEditor.dialog.evenPage")),1),createBaseVNode("option",_hoisted_17$9,toDisplayString(F.$t("documentEditor.dialog.customRange")),1)],512),[[vModelSelect,g.value]]),createVNode(ne)]),g.value==="custom"?withDirectives((openBlock(),createElementBlock("input",{key:0,type:"text","onUpdate:modelValue":q[5]||(q[5]=j=>d.value=j),placeholder:F.$t("documentEditor.dialog.tip"),onBlur:N,name:"document-editor"},null,40,_hoisted_18$8)),[[vModelText,d.value]]):createCommentVNode("",!0)])])):createCommentVNode("",!0)])]),createBaseVNode("p",_hoisted_19$8,toDisplayString(F.$t("documentEditor.dialog.insertTo")),1),createBaseVNode("div",_hoisted_20$8,[createBaseVNode("div",_hoisted_21$8,[createBaseVNode("div",{onClick:q[6]||(q[6]=j=>y.value="first"),class:"option"},[y.value==="first"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.firstPage")),1)]),createBaseVNode("div",{onClick:q[7]||(q[7]=j=>y.value="last"),class:"option"},[y.value==="last"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.lastPage")),1)]),createBaseVNode("div",{onClick:q[10]||(q[10]=j=>y.value="custom"),class:normalizeClass(["option",{"custom-page":y.value==="custom"}])},[createBaseVNode("div",_hoisted_22$8,[y.value==="custom"?(openBlock(),createBlock(Y,{key:0})):(openBlock(),createBlock(_e,{key:1})),createTextVNode(toDisplayString(F.$t("documentEditor.dialog.page")),1)]),y.value==="custom"?(openBlock(),createElementBlock("div",_hoisted_23$6,[createBaseVNode("div",_hoisted_24$6,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":q[8]||(q[8]=j=>x.value=j),type:"number",max:e.totalPages,min:"1",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onInput:T,onBlur:D,name:"document-editor"},null,40,_hoisted_25$6),[[vModelText,x.value,void 0,{number:!0}]]),createBaseVNode("span",null,"/ "+toDisplayString(e.totalPages),1)]),createBaseVNode("div",_hoisted_26$6,[withDirectives(createBaseVNode("select",{name:"targetPlace","onUpdate:modelValue":q[9]||(q[9]=j=>k.value=j)},[createBaseVNode("option",_hoisted_27$5,toDisplayString(F.$t("documentEditor.dialog.before")),1),createBaseVNode("option",_hoisted_28$5,toDisplayString(F.$t("documentEditor.dialog.after")),1)],512),[[vModelSelect,k.value]]),createVNode(ne)])])):createCommentVNode("",!0)],2)])])]}),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$3n={},_hoisted_1$2_={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2N=createBaseVNode("g",{id:"toolbar / pageedit / all select"},[createBaseVNode("path",{id:"Union","fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.5 2.5H6.5V13.5H17.5V2.5ZM6.5 1H5V2.5V2.9342H2H1.25V3.6842V18V18.75H2H16.3158H17.0658V18V15H17.5H19V13.5V2.5V1H17.5H6.5ZM2.75 4.4342H5V13.5V15H6.5H15.5658V17.25H2.75V4.4342ZM15.4446 6.94453L15.9749 6.4142L14.9142 5.35355L14.3839 5.88388L11.1016 9.16615L10.2177 8.28227L9.68734 7.75195L8.62667 8.8126L9.15701 9.34293L10.5712 10.7571L11.1016 11.2875L11.6319 10.7571L15.4446 6.94453Z",fill:"currentColor"})],-1),_hoisted_3$2x=[_hoisted_2$2N];function _sfc_render$1Z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2_,_hoisted_3$2x)}const __unplugin_components_10$4=_export_sfc(_sfc_main$3n,[["render",_sfc_render$1Z]]),_sfc_main$3m={},_hoisted_1$2Z={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2M=createBaseVNode("g",{id:"toolbar / pageedit / unselect"},[createBaseVNode("path",{id:"Union","fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.5 2.5H6.5V13.5H17.5V2.5ZM6.5 1H5V2.5V2.9342H2H1.25V3.6842V18V18.75H2H16.3158H17.0658V18V15H17.5H19V13.5V2.5V1H17.5H6.5ZM2.75 4.4342H5V13.5V15H6.5H15.5658V17.25H2.75V4.4342ZM8 8.75H16V7.25H8V8.75Z",fill:"currentColor"})],-1),_hoisted_3$2w=[_hoisted_2$2M];function _sfc_render$1Y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2Z,_hoisted_3$2w)}const __unplugin_components_9$3=_export_sfc(_sfc_main$3m,[["render",_sfc_render$1Y]]),_sfc_main$3l={},_hoisted_1$2Y={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2L=createBaseVNode("g",{id:"toolbar / pageedit / reverse"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.9019 1.75H1.25V18.25H14.75V5.95882L10.9019 1.75ZM10.24 3.25L13.25 6.542V16.75H2.75V3.25H10.24ZM19.624 6.83397L16.25 1.77292V18.25H17.75V6.729L18.376 7.66603L19.624 6.83397Z",fill:"currentColor"})],-1),_hoisted_3$2v=[_hoisted_2$2L];function _sfc_render$1X(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2Y,_hoisted_3$2v)}const __unplugin_components_8$4=_export_sfc(_sfc_main$3l,[["render",_sfc_render$1X]]),_sfc_main$3k={},_hoisted_1$2X={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2K=createBaseVNode("g",{id:"toolbar / pageedit / replace"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.25 1H13.3107L17.75 5.43934V10.75H16.25V6.061L12.689 2.5H3.75V17H10V18.5H2.25V1ZM14.3454 12.7983L15.3689 11.7017L18.9028 15H11V13.5H15.097L14.3454 12.7983ZM14.5339 19.5L15.5574 18.4034L14.8058 17.7017H18.9028V16.2017H11L14.5339 19.5Z",fill:"currentColor"})],-1),_hoisted_3$2u=[_hoisted_2$2K];function _sfc_render$1W(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2X,_hoisted_3$2u)}const __unplugin_components_7$4=_export_sfc(_sfc_main$3k,[["render",_sfc_render$1W]]),_sfc_main$3j={},_hoisted_1$2W={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2J=createBaseVNode("g",{id:"toolbar / pageedit / extract"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.25 1.25H13.3107L17.75 5.68934V11H16.25V6.311L12.689 2.75H3.75V17.25H10V18.75H2.25V1.25ZM16.0174 16.25L15.1768 17.091L16.2374 18.1516L18.8891 15.5L16.2374 12.8483L15.1768 13.909L16.0174 14.75H11V16.25H16.0174Z",fill:"currentColor"})],-1),_hoisted_3$2t=[_hoisted_2$2J];function _sfc_render$1V(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2W,_hoisted_3$2t)}const __unplugin_components_6$6=_export_sfc(_sfc_main$3j,[["render",_sfc_render$1V]]),_sfc_main$3i={},_hoisted_1$2V={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2I=createBaseVNode("g",{id:"toolbar / pageedit / copy"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.75 0.75H14.3866L18.25 4.69386V16.25H15.25V19.25H1.75V3.75H4.75V0.75ZM4.75 16.25H13.75V17.75H3.25V5.25H4.75V16.25ZM16.75 5.306L13.756 2.25H6.25V14.75H16.75V5.306ZM14.1974 7.35361C13.8798 6.13053 12.7917 5.25 11.5202 5.25C9.98499 5.25 8.75 6.52361 8.75 8.08333V8.91667L8.75503 9.08874C8.84189 10.569 10.0418 11.75 11.5202 11.75C12.8491 11.75 13.9777 10.7882 14.2357 9.47867L12.764 9.18872L12.7319 9.3182C12.5675 9.86695 12.0782 10.25 11.5202 10.25C10.8239 10.25 10.25 9.65813 10.25 8.91667V8.08333L10.2566 7.94617C10.3222 7.2702 10.8674 6.75 11.5202 6.75C12.1213 6.75 12.6427 7.19453 12.7641 7.81182L14.2359 7.52247L14.1974 7.35361Z",fill:"currentColor"})],-1),_hoisted_3$2s=[_hoisted_2$2I];function _sfc_render$1U(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2V,_hoisted_3$2s)}const __unplugin_components_5$6=_export_sfc(_sfc_main$3i,[["render",_sfc_render$1U]]),_sfc_main$3h={},_hoisted_1$2U={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2H=createBaseVNode("g",{id:"toolbar / pageedit / rotate left"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 9.75V1.75H18.5V9.75V10.5V18.25H2V9.75H10ZM11.5 9.75V3.25H17V9.75H11.5ZM3.5 11.25V16.75H17.001V11.25H3.5ZM1.53769 5.46967L0.477028 6.53033L3.12868 9.18198L5.78033 6.53033L4.71967 5.46967L3.80559 6.38355C3.89386 5.03216 4.82757 3.82648 6.20838 3.4565C6.98256 3.24905 7.78597 3.33465 8.48622 3.68044L8.67454 3.78117L9.42454 2.48213C8.34118 1.85665 7.05293 1.67728 5.82015 2.00761C3.81662 2.54445 2.45713 4.28512 2.31137 6.24287L1.53769 5.46967Z",fill:"currentColor"})],-1),_hoisted_3$2r=[_hoisted_2$2H];function _sfc_render$1T(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2U,_hoisted_3$2r)}const __unplugin_components_4$c=_export_sfc(_sfc_main$3h,[["render",_sfc_render$1T]]),_sfc_main$3g={},_hoisted_1$2T={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2G=createBaseVNode("g",{id:"toolbar / pageedit / rotate left"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 9.75V1.75H1.5V9.75V10.5V18.25H18V9.75H10ZM8.5 9.75V3.25H3V9.75H8.5ZM16.5 11.25V16.75H2.999V11.25H16.5ZM18.4623 5.46967L19.523 6.53033L16.8713 9.18198L14.2197 6.53033L15.2803 5.46967L16.1944 6.38355C16.1061 5.03216 15.1724 3.82648 13.7916 3.4565C13.0174 3.24905 12.214 3.33465 11.5138 3.68044L11.3255 3.78117L10.5755 2.48213C11.6588 1.85665 12.9471 1.67728 14.1798 2.00761C16.1834 2.54445 17.5429 4.28512 17.6886 6.24287L18.4623 5.46967Z",fill:"currentColor"})],-1),_hoisted_3$2q=[_hoisted_2$2G];function _sfc_render$1S(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2T,_hoisted_3$2q)}const __unplugin_components_3$c=_export_sfc(_sfc_main$3g,[["render",_sfc_render$1S]]),_sfc_main$3f={},_hoisted_1$2S={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2F=createBaseVNode("g",{id:"toolbar / pageedit / delete"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M13 2.75V1.25H7V2.75H13ZM19 5.75V4.25H16.75H3.25H1V5.75H3.25V18.75H16.75V5.75H19ZM4.75 17.25V5.75H15.25V17.25H4.75ZM8.75 8.5V14.5H7.25V8.5H8.75ZM12.75 8.5V14.5H11.25V8.5H12.75Z",fill:"currentColor"})],-1),_hoisted_3$2p=[_hoisted_2$2F];function _sfc_render$1R(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2S,_hoisted_3$2p)}const __unplugin_components_8$3=_export_sfc(_sfc_main$3f,[["render",_sfc_render$1R]]),_sfc_main$3e={},_hoisted_1$2R={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2E=createBaseVNode("g",{id:"toolbar / pageedit / insert"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.25 1.25H13.3107L17.75 5.68934V11H16.25V6.311L12.689 2.75H3.75V17.25H10V18.75H2.25V1.25ZM14.75 18H13.25V15.75H11V14.25H13.25V12H14.75V14.25H17V15.75H14.75V18Z",fill:"currentColor"})],-1),_hoisted_3$2o=[_hoisted_2$2E];function _sfc_render$1Q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2R,_hoisted_3$2o)}const __unplugin_components_0$t=_export_sfc(_sfc_main$3e,[["render",_sfc_render$1Q]]),DocumentEditorContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$2Q=["onClick"],_hoisted_2$2D=["src"],_sfc_main$3d={__name:"DocumentEditorContainer",props:["Sortable"],setup(e){const{Sortable:n}=e,o=useViewerStore(),r=useDocumentStore(),u=reactive({pageList:[],selectedPageList:[]});let{pageList:s,selectedPageList:w}=u;const m=ref(null),v=ref(-2),g=ref(-2),d=ref(!1),f=ref(null),y=ref(0),x=ref(null),k=window.devicePixelRatio||1,P=window.innerWidth<768;let S=null;onMounted(()=>{n.create(m.value,{multiDrag:!0,selectedClass:"sortable-selected",dragClass:"sortable-drag",sort:!1,forceFallback:!0,fallbackTolerance:isMobileDevice?0:20,onStart:X,onEnd:U,delay:isMobileDevice?200:0});const{width:be,height:we}=f.value[0].getBoundingClientRect(),Ae={width:be,height:we};core.getDocEditorPages(Ae),window.addEventListener("resize",re),re()}),onUnmounted(()=>{core.removeEvent("getDocEditorPages",M),window.addEventListener("resize",re)});const E=core.getPagesCount();for(let be=0;be<E;be++)s.push({type:"page"});const M=be=>{const{index:we,pageData:Ae}=be;s[we]=Ae};core.addEvent("getDocEditorPages",M);const T=()=>{o.openElement("deletePageDialog")},D=async be=>{const we={type:"insert",pageIndex:be.place};if(be.type==="blank"){const Ae=be.targetPlace?s[be.place-1]:s[be.place]||s[be.place-1],$e={type:be.type,rotation:0,size:be.size||{width:Ae.size.width,height:Ae.size.height}};s.splice(be.place,0,$e),we.size=$e.size,core.saveDocumentEdit(we)}else if(be.type==="pdf"){we.file=be.file,we.range=be.range,we.password=be.password||"";const{width:Ae,height:$e}=f.value[0].getBoundingClientRect(),Me=await core.saveDocumentEdit(we);if(!Me)return;const Ie=s.length;for(let le=0;le<Me-Ie;le++)s.splice(be.place+le,0,{type:"page"});const Le={width:Ae,height:$e};core.getDocEditorPages(Le,be.place,Me-Ie)}r.setDocEditorOperationList(we),w.length=0},N=be=>{const{width:we,height:Ae}=be,$e=P?140:204,Me=P?141:216,Ie=we/k,Le=Ae/k,le=$e/Ie,oe=Me/Le;let ke=Math.min(le,oe);ke>1&&(ke=1);const Ce=Ie*ke,Ee=Le*ke;return{width:Ce,height:Ee}},I=be=>{const we=w.indexOf(be);we===-1?w.push(be):w.splice(we,1)},O=()=>{if(w.length<s.length){w.length=0;for(let be=0;be<s.length;be++)w.push(be)}else w.length=0},F=()=>{o.openElement("insertPageSettingDialog")},q=()=>{w.sort((we,Ae)=>Ae-we),w.forEach(we=>{s.splice(we,1)});const be={type:"delete",selectedPageIndexArray:Array.from(w)};core.saveDocumentEdit(be),r.setDocEditorOperationList(be),w.length=0},Y=be=>{w.forEach(Ae=>{const $e=s[Ae];$e.rotation+=be,($e.rotation>3||$e.rotation<-3)&&($e.rotation=0)});const we={type:"rotate",selectedPageIndexArray:Array.from(w),rotation:be};core.saveDocumentEdit(we),r.setDocEditorOperationList(we)},_e=be=>new Map([[-3,-270],[-2,180],[-1,-90],[0,0],[1,90],[2,180],[3,270]]).get(be),ne=()=>{w.sort((we,Ae)=>Ae-we),w.forEach(we=>{s.splice(we,0,{...s[we]})});const be={type:"copy",selectedPageIndexArray:Array.from(w)};core.saveDocumentEdit(be),r.setDocEditorOperationList(be),w.length=0},ve=()=>{const be=document.createElement("input");be.type="file",be.accept=".pdf",be.click(),be.addEventListener("change",async function(we){const Ae=we.target.files[0],$e=w[0];let Me=URL.createObjectURL(Ae);const Ie=await core.checkPassword(Me,!0);Ie!==!1&&(D({type:"pdf",file:Ae,range:"all",place:$e,password:Ie}),q())})},J=()=>{o.openElement("extractPageSettingDialog")},fe=async be=>{let we=be.range.replace(/\s/g,"");const Ae=s.length;be.range==="all"?we="1-"+Ae:be.range==="odd"?we=Array.from({length:Ae},(Le,le)=>le+1).filter(Le=>Le%2!==0).join(","):be.range==="even"&&(we=Array.from({length:Ae},(Le,le)=>le+1).filter(Le=>Le%2===0).join(","));let $e=we.split(","),Me=[];$e.forEach(Le=>{if(Le.includes("-")){let[le,oe]=Le.split("-").map(ke=>parseInt(ke));for(let ke=le;ke<=oe;ke++)Me.push(ke-1)}else Le&&Me.push(parseInt(Le)-1)});const Ie={type:"extract",range:be.separateFile?Me:we,separateFile:be.separateFile};if(await core.saveDocumentEdit(Ie),r.setDocEditorOperationList(Ie),be.deleteAfter){Me.reverse().forEach(le=>{s.splice(le,1)});const Le={type:"delete",selectedPageIndexArray:Me};core.saveDocumentEdit(Le),r.setDocEditorOperationList(Le),w.length=0}},Z=()=>{o.openElement("movePageSettingDialog")},j=be=>{if(w.length===1||w.length<2&&v.value>=0||w.length>1&&v.value>=0&&!w.includes(v.value)){const we=w.length===1&&w.includes(v.value)||w.length===1&&v.value<0,Ae=we?w[0]:[v.value],$e=Ae>be?be:be-1;if(Ae===$e)return;const[Me]=s.splice(Ae,1);s.splice($e,0,Me);const Ie={type:"move",pageIndex:Ae,targetPageIndex:$e};core.saveDocumentEdit(Ie),r.setDocEditorOperationList(Ie),we&&(w[0]=$e)}else{w.sort((we,Ae)=>we-Ae);for(let we=0;we<w.length;we++){let Ae,$e;if(w[we]===be)Ae=w[we],$e=be;else if(w[we]>be)if(Ae=w[we],w.includes(be)){$e=be;for(let Le=0;Le<w.length;Le++)w[Le]===$e&&Ae!==$e&&$e++}else $e=be;else Ae=w[we]-we,$e=be-1;if(w.includes(Ae)&&w.includes($e)&&Ae===$e)continue;const[Me]=s.splice(Ae,1);s.splice($e,0,Me);const Ie={type:"move",pageIndex:Ae,targetPageIndex:$e};core.saveDocumentEdit(Ie),r.setDocEditorOperationList(Ie),w[we]=w[we]>be?$e:$e-we}}},X=be=>{v.value=be.oldIndex,m.value.addEventListener(isMobileDevice?"touchmove":"mousemove",H),isMobileDevice&&(document.body.style.overscrollBehavior="none",document.body.style.userSelect="none",document.getElementById("app").style.touchAction="none",x.value.style.overflow="hidden")},H=be=>{w.length>1&&w.includes(v.value)&&m.value.querySelector(".sortable-drag").style.setProperty("--after-content","'"+w.length+"'");let we=isMobileDevice?document.elementFromPoint(be.touches[0].clientX,be.touches[0].clientY):be.target;const Ae=m.value.children;for(let $e=0;$e<Ae.length;$e++){const Me=Ae[$e];if(Me.contains(we)){const Ie=Me.getBoundingClientRect(),Le=isMobileDevice?be.touches[0].clientX-Ie.left:be.offsetX+30;d.value=Le<Ie.width/2,d.value?g.value=$e-1:g.value=$e}}isMobileDevice&&Pe(be.touches[0].clientY)},U=()=>{clearInterval(S),m.value.removeEventListener(isMobileDevice?"touchmove":"mousemove",H),g.value>-2&&!te(g.value)&&j(g.value+1),v.value=-2,g.value=-2,isMobileDevice&&(document.body.style.overscrollBehavior="auto",document.body.style.userSelect="auto",document.getElementById("app").style.touchAction="auto",x.value.style.overflow="auto")},te=be=>{if(![be-1,be,be+1].includes(g.value+1))return!1;if(w.includes(v.value)){if(w.length===1&&(w[0]===g.value+1||w[0]===g.value)||w.length>1&&Q(w)&&(w.includes(g.value+1)||w.includes(g.value)))return!0}else if([v.value,v.value-1].includes(g.value))return!0;return!1},Q=be=>{be.sort(function(Ae,$e){return Ae-$e});for(var we=0;we<be.length-1;we++)if(be[we]+1!==be[we+1])return!1;return!0},re=()=>{const be=window.innerWidth,we=be>767?280:170;y.value=parseInt(be%we/2)},Pe=be=>{const Ae=x.value,Me=Ae.getBoundingClientRect().height,Ie=be,Le=Ae.scrollHeight;Ie<=100||Ie>=Me-100?(clearInterval(S),S=setInterval(()=>{Ie<=100?(Ae.scrollTop-=10,Ae.scrollTop<=0&&clearInterval(S)):Ie>=Me-100&&(Ae.scrollTop+=10,Ae.scrollTop+Me>=Le&&clearInterval(S))},10)):clearInterval(S)};return(be,we)=>{const Ae=__unplugin_components_0$t,$e=_sfc_main$4C,Me=__unplugin_components_8$3,Ie=__unplugin_components_3$c,Le=__unplugin_components_4$c,le=__unplugin_components_5$6,oe=__unplugin_components_6$6,ke=__unplugin_components_7$4,Ce=__unplugin_components_8$4,Ee=__unplugin_components_9$3,Be=__unplugin_components_10$4,Ve=_sfc_main$3o,Oe=_sfc_main$3r,je=_sfc_main$3s,Ge=_sfc_main$3v;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:"document-editor-container",ref_key:"docEditorContainer",ref:x},[createBaseVNode("div",{class:normalizeClass(["tools-container",{mobile:unref(isMobileDevice)}])},[createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice)}),onClick:F},{default:withCtx(()=>[createVNode(Ae),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.insert")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length||unref(w).length==unref(s).length}),onClick:T},{default:withCtx(()=>[createVNode(Me),createBaseVNode("span",null,toDisplayString(be.$t("common.actions.delete")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:we[0]||(we[0]=Xe=>Y(1))},{default:withCtx(()=>[createVNode(Ie),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.rotateRight")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:we[1]||(we[1]=Xe=>Y(-1))},{default:withCtx(()=>[createVNode(Le),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.rotateLeft")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:ne},{default:withCtx(()=>[createVNode(le),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.copy")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:J},{default:withCtx(()=>[createVNode(oe),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.extract")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:ve},{default:withCtx(()=>[createVNode(ke),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.replace")),1)]),_:1},8,["class"]),createVNode($e,{class:normalizeClass({"with-text":!unref(isMobileDevice),disabled:!unref(w).length}),onClick:Z},{default:withCtx(()=>[createVNode(Ce),createBaseVNode("span",null,toDisplayString(be.$t("documentEditor.move")),1)]),_:1},8,["class"]),createVNode($e,{class:"select-all",onClick:O,title:unref(w).length===unref(s).length?be.$t("documentEditor.unselectAll"):be.$t("documentEditor.selectAll")},{default:withCtx(()=>[unref(w).length===unref(s).length?(openBlock(),createBlock(Ee,{key:0})):(openBlock(),createBlock(Be,{key:1}))]),_:1},8,["title"])],2),createBaseVNode("div",{class:"page-container",ref_key:"dragContainer",ref:m,style:normalizeStyle({"margin-left":y.value+"px"})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(s),(Xe,qe)=>(openBlock(),createElementBlock("div",{key:`${Xe.type} - ${qe}`,class:normalizeClass(["page",{selected:unref(w).includes(qe),"drag-indicate-right":g.value===qe&&!d.value,"drag-indicate-left":g.value+1===qe&&d.value,"drag-indicate-disable":v.value>=0&&g.value>=-1&&te(qe),"has-hover":!unref(isMobileDevice)&&v.value<0&&!unref(w).includes(qe)}]),ref_for:!0,ref_key:"imgBoxEl",ref:f},[createBaseVNode("div",{class:"img-box",onClick:Ke=>I(qe)},[Xe.img?(openBlock(),createElementBlock("img",{key:0,src:Xe.img,style:normalizeStyle(`transform: rotate(${_e(Xe.rotation)}deg);`)},null,12,_hoisted_2$2D)):Xe.type==="blank"?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass({"blank-page":Xe.type==="blank"}),style:normalizeStyle({transform:"rotate("+_e(Xe.rotation)+"deg)",width:N(Xe.size).width+"px",height:N(Xe.size).height+"px"})},null,6)):createCommentVNode("",!0)],8,_hoisted_1$2Q),createBaseVNode("p",null,toDisplayString(qe+1),1)],2))),128))],4)],512),createVNode(Ve,{onInsertPage:D,selectedPageList:unref(w),totalPages:unref(s).length},null,8,["selectedPageList","totalPages"]),createVNode(Oe,{onDeletePage:q,selectedPageList:unref(w)},null,8,["selectedPageList"]),createVNode(je,{onExtractPage:fe,totalPages:unref(s).length,selectedPageList:unref(w)},null,8,["totalPages","selectedPageList"]),createVNode(Ge,{onMovePage:j,totalPages:unref(s).length,selectedPageList:unref(w)},null,8,["totalPages","selectedPageList"])],64)}}},PrintSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$2P={key:0,class:"print-setting-popup"},_hoisted_2$2C={class:"select-content"},dialogName$e="printSettingDialog",_sfc_main$3c={__name:"PrintSettingDialog",setup(e){const{triggerPrinting:n}=core,o=useViewerStore(),r=useDocumentStore(),u=computed(()=>o.isElementOpen(dialogName$e)),s=computed(()=>r.getCompareResult),w=ref("old"),m=()=>{o.closeElement(dialogName$e)},v=async()=>{let g=null;w.value==="old"?g=s.value.oldFile.url:w.value==="new"&&(g=s.value.newFile.url),m(),o.setDownloading(!0);try{await n(g),o.setDownloading(!1)}catch(d){console.log(d)}};return(g,d)=>{const f=__unplugin_components_0$w,y=__unplugin_components_1$a,x=_sfc_main$4v;return u.value?(openBlock(),createElementBlock("div",_hoisted_1$2P,[createVNode(x,{show:u.value,dialogName:dialogName$e,close:!0},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(g.$t("compare.printSettings")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:m},toDisplayString(g.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:v},toDisplayString(g.$t("common.actions.ok")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2$2C,[createBaseVNode("div",{onClick:d[0]||(d[0]=k=>w.value="old"),class:"option"},[w.value==="old"?(openBlock(),createBlock(f,{key:0})):(openBlock(),createBlock(y,{key:1})),createTextVNode(toDisplayString(g.$t("compare.printOld")),1)]),createBaseVNode("div",{onClick:d[1]||(d[1]=k=>w.value="new"),class:"option"},[w.value==="new"?(openBlock(),createBlock(f,{key:0})):(openBlock(),createBlock(y,{key:1})),createTextVNode(toDisplayString(g.$t("compare.printNew")),1)])])]),_:1},8,["show"])])):createCommentVNode("",!0)}}};var FileSaver_min={exports:{}};(function(e,n){(function(o,r){r()})(commonjsGlobal,function(){function o(g,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\uFEFF",g],{type:g.type}):g}function r(g,d,f){var y=new XMLHttpRequest;y.open("GET",g),y.responseType="blob",y.onload=function(){v(y.response,d,f)},y.onerror=function(){console.error("could not download file")},y.send()}function u(g){var d=new XMLHttpRequest;d.open("HEAD",g,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function s(g){try{g.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(d)}}var w=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,m=w.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=w.saveAs||(typeof window!="object"||window!==w?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(g,d,f){var y=w.URL||w.webkitURL,x=document.createElement("a");d=d||g.name||"download",x.download=d,x.rel="noopener",typeof g=="string"?(x.href=g,x.origin===location.origin?s(x):u(x.href)?r(g,d,f):s(x,x.target="_blank")):(x.href=y.createObjectURL(g),setTimeout(function(){y.revokeObjectURL(x.href)},4e4),setTimeout(function(){s(x)},0))}:"msSaveOrOpenBlob"in navigator?function(g,d,f){if(d=d||g.name||"download",typeof g!="string")navigator.msSaveOrOpenBlob(o(g,f),d);else if(u(g))r(g,d,f);else{var y=document.createElement("a");y.href=g,y.target="_blank",setTimeout(function(){s(y)})}}:function(g,d,f,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof g=="string")return r(g,d,f);var x=g.type==="application/octet-stream",k=/constructor/i.test(w.HTMLElement)||w.safari,P=/CriOS\/[\d]+/.test(navigator.userAgent);if((P||x&&k||m)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var T=S.result;T=P?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=T:location=T,y=null},S.readAsDataURL(g)}else{var E=w.URL||w.webkitURL,M=E.createObjectURL(g);y?y.location=M:location.href=M,y=null,setTimeout(function(){E.revokeObjectURL(M)},4e4)}});w.saveAs=v.saveAs=v,e.exports=v})})(FileSaver_min);const DownloadSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$2O={key:0,class:"download-setting-popup"},_hoisted_2$2B={class:"select-content"},dialogName$d="downloadSettingDialog",_sfc_main$3b={__name:"DownloadSettingDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$d)),u=computed(()=>o.getCompareResult),s=ref(1),w=()=>{n.closeElement(dialogName$d)},m=async()=>{const v=[];s.value===1?v.push(u.value.mergeFile):s.value===2&&v.push(u.value.oldFile,u.value.newFile),w(),n.setDownloading(!0);try{v.forEach(g=>{FileSaver_min.exports.saveAs(g.url,g.filename)}),n.setDownloading(!1)}catch(g){console.log(g)}};return(v,g)=>{const d=__unplugin_components_0$w,f=__unplugin_components_1$a,y=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$2O,[createVNode(y,{show:r.value,dialogName:dialogName$d,close:!0},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(v.$t("compare.downloadOptions")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:w},toDisplayString(v.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:m},toDisplayString(v.$t("common.actions.ok")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2$2B,[createBaseVNode("div",{onClick:g[0]||(g[0]=x=>s.value=2),class:"option"},[s.value===2?(openBlock(),createBlock(d,{key:0})):(openBlock(),createBlock(f,{key:1})),createTextVNode(toDisplayString(v.$t("compare.separateFiles")),1)]),createBaseVNode("div",{onClick:g[1]||(g[1]=x=>s.value=1),class:"option"},[s.value===1?(openBlock(),createBlock(d,{key:0})):(openBlock(),createBlock(f,{key:1})),createTextVNode(toDisplayString(v.$t("compare.mergedFile")),1)])])]),_:1},8,["show"])])):createCommentVNode("",!0)}}};function getHash(){let e=window.location.href,n=e?e.indexOf("#"):-1;return 0<=n?e.substring(n+1):""}function getHashParameters(e,n){let o=typeof n,r=getHash().split("&").reduce(function(u,s){return s=s.split("="),u[decodeURIComponent(s[0])]=decodeURIComponent(s[1]),u},{});if(o==="boolean"&&typeof r[e]<"u"){if(o=r[e],o==="true"||o==="1")return!0;if(o==="false"||o==="0")return!1}return r[e]||n}const CompareSettingDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$2N={key:0,class:"compare-setting-popup"},_hoisted_2$2A={class:"mode pc"},_hoisted_3$2n={class:"dialog-content"},_hoisted_4$Y={class:"mode mobile"},_hoisted_5$A={class:"compare-items"},_hoisted_6$q={class:"title"},_hoisted_7$i={class:"row"},_hoisted_8$f={class:"row"},_hoisted_9$f={class:"opacity"},_hoisted_10$e={class:"title"},_hoisted_11$b={class:"row"},_hoisted_12$a={class:"percent-input"},_hoisted_13$a={class:"row"},_hoisted_14$a={class:"percent-input"},_hoisted_15$a={class:"mark-color"},_hoisted_16$9={class:"title"},_hoisted_17$8={class:"row"},_hoisted_18$7={class:"select color-select"},_hoisted_19$7={class:"colors-container mark"},_hoisted_20$7={class:"cell-container"},_hoisted_21$7={class:"cell-outer"},_hoisted_22$7={class:"drop-down"},_hoisted_23$5={class:"colors-container mark"},_hoisted_24$5={class:"cell-container"},_hoisted_25$5=["onClick"],_hoisted_26$5={class:"row"},_hoisted_27$4={class:"select color-select"},_hoisted_28$4={class:"colors-container mark"},_hoisted_29$4={class:"cell-container"},_hoisted_30$4={class:"cell-outer"},_hoisted_31$4={class:"drop-down"},_hoisted_32$3={class:"colors-container mark"},_hoisted_33$2={class:"cell-container"},_hoisted_34$2=["onClick"],_hoisted_35$2={class:"row"},_hoisted_36$1={class:"select"},_hoisted_37$1={class:"row"},_hoisted_38$1={class:"select color-select"},_hoisted_39$1={class:"colors-container mark"},_hoisted_40$1={class:"cell-container"},_hoisted_41$1={class:"cell-outer"},_hoisted_42={class:"drop-down"},_hoisted_43={class:"colors-container mark"},_hoisted_44={class:"cell-container"},_hoisted_45=["onClick"],_hoisted_46={class:"row"},_hoisted_47={class:"select color-select"},_hoisted_48={class:"colors-container mark"},_hoisted_49={class:"cell-container"},_hoisted_50={class:"cell-outer"},_hoisted_51={class:"drop-down"},_hoisted_52={class:"colors-container mark"},_hoisted_53={class:"cell-container"},_hoisted_54=["onClick"],_hoisted_55={class:"row"},_hoisted_56={class:"select color-select"},_hoisted_57={class:"colors-container mark"},_hoisted_58={class:"cell-container"},_hoisted_59={class:"cell-outer"},_hoisted_60={class:"drop-down"},_hoisted_61={class:"colors-container mark"},_hoisted_62={class:"cell-container"},_hoisted_63=["onClick"],_hoisted_64={class:"dialog-footer mobile"},_hoisted_65={class:"loading"},_hoisted_66={class:"loading-compare-tip"},dialogName$c="compareSettingDialog",_sfc_main$3a={__name:"CompareSettingDialog",setup(e){const{t:n}=useTranslation(),{compare:o,loadDocument:r,getOptionUrl:u}=core,s=useViewerStore(),w=useDocumentStore();getCurrentInstance().appContext.app.config.globalProperties;const m=computed(()=>s.isElementOpen(dialogName$c)),v=computed(()=>w.getCompareFiles),g=computed(()=>s.getCompareMode),d=ref(50),f=ref(50),y=computed(()=>w.getCompareSetting("oldFileColor")),x=computed(()=>w.getCompareSetting("newFileColor")),k=ref("0"),P=[{label:n("compare.overlayDialog.normal"),value:"0"},{label:n("compare.overlayDialog.multiply"),value:"1"},{label:n("compare.overlayDialog.screen"),value:"2"},{label:n("compare.overlayDialog.overlay"),value:"3"},{label:n("compare.overlayDialog.darken"),value:"4"},{label:n("compare.overlayDialog.lighten"),value:"5"},{label:n("compare.overlayDialog.colorDodge"),value:"6"},{label:n("compare.overlayDialog.colorBurn"),value:"7"},{label:n("compare.overlayDialog.hardLight"),value:"8"},{label:n("compare.overlayDialog.softLight"),value:"9"},{label:n("compare.overlayDialog.difference"),value:"10"},{label:n("compare.overlayDialog.exclusion"),value:"11"},{label:n("compare.overlayDialog.hue"),value:"12"},{label:n("compare.overlayDialog.saturation"),value:"13"},{label:n("compare.overlayDialog.colour"),value:"14"},{label:n("compare.overlayDialog.luminosity"),value:"15"}],S=ref(!0),E=ref(!0),M=ref("#93B9FD"),T=ref("#C0FFEC"),D=ref("#FBBDBF"),N=["#FBBDBF","#93B9FD","#FFF6B3","#C0FFEC"],I=ref(null),O=ref(null),F=ref(null),q=ref(null),Y=ref(null),_e=ref(!1),ne=ref(null),ve=ref(null);watch(()=>d.value,(re,Pe)=>{const be=/^\d+$/;re!==""&&(re>100||re<0||!be.test(re))&&(d.value=Pe)}),watch(()=>f.value,(re,Pe)=>{const be=/^\d+$/;re!==""&&(re>100||re<0||!be.test(re))&&(f.value=Pe)});const J=async()=>{const re={leftFile:v.value.oldFile,leftFilePassword:v.value.oldFilePassword,rightFile:v.value.newFile,rightFilePassword:v.value.newFilePassword};if(g.value==="content"){let Pe=S.value,be=E.value;!Pe&&!be&&(Pe=be=!0);const we={type:1,textCompare:Pe,imgCompare:be,replaceColor:M.value,insertColor:T.value,deleteColor:D.value};Object.assign(re,we)}else{const Pe={type:2,inTransparency:d.value+"",newTransparency:f.value+"",coverType:k.value,inColor:y.value,newColor:x.value};Object.assign(re,Pe)}try{s.closeElement(dialogName$c),_e.value=!0;const Pe=await o(re);if(Pe&&Pe.url){w.resetSetting();const be={filename:n("compare.credit")+".pdf",progress:w.setLoadingProgress,pageChangedCallback:s.setCurrentPage,scaleChangedCallback:s.setCurrentScale,annotationsNumChangedCallback:w.setAnnotationsCount,distanceChangedCallback:w.setDistance,notUpdatePwd:!0};await r(Pe.url,be),_e.value=!1;const we=core.getPagesCount(),Ae=core.getScale();w.setTotalPages(we),s.setCurrentScale(Ae),s.setCurrentPage(1),s.setUpload(!0),s.setCompareStatus("finished")}else if(Pe&&Array.isArray(Pe)){const be=Pe[0],we=Pe[1];w.setCompareResult({oldFile:be,newFile:we,mergeFile:Pe[2]}),H(be.url,be.fileName,2),H(we.url,we.fileName,3),_e.value=!1,s.setCompareStatus("next")}else _e.value=!1,s.setDownloadError("Compared")}catch(Pe){if(console.log(Pe),_e.value=!1,s.setDownloadError("Compared"),Pe==="invalid_file_error"||Pe==="no_password_given"||Pe==="incorrect_password"){s.setUpload(!1),w.setLoadingProgress(0),s.resetSetting();const be=document.getElementById("fileInput");be.value=""}}},fe=re=>{re.target.value||(d.value=1)},Z=re=>{re.target.value||(f.value=1)},j=(re,Pe)=>{re==="old"?w.setCompareSetting("oldFileColor",Pe):re==="new"?w.setCompareSetting("newFileColor",Pe):re==="replace"?M.value=Pe:re==="insert"?T.value=Pe:re==="delete"&&(D.value=Pe),g.value==="content"?(F.value.setShow(!1),q.value.setShow(!1),Y.value.setShow(!1)):(I.value.setShow(!1),O.value.setShow(!1))},X=()=>{s.closeElement(dialogName$c)};async function H(re,Pe=null,be){s.setUploadLoading(!0);let we=null;be===2?we=w.getCompareFile("oldFilePassword"):be===3&&(we=w.getCompareFile("newFilePassword"));const Ae={extension:getHashParameters("extension",null),filename:Pe||getHashParameters("filename",null),externalPath:getHashParameters("p",""),documentId:getHashParameters("did",null),progress:w.setLoadingProgress,pageChangedCallback:s.setCurrentPage,scaleChangedCallback:be===2?te():Q(),annotationsNumChangedCallback:w.setAnnotationsCount,distanceChangedCallback:w.setDistance,notUploadPdf:!0};we&&(Ae.pwd=we);try{await r(re,Ae,be)}catch($e){console.log($e),s.setDownloadError("Loaded")}s.setUploadLoading(!1)}const U=re=>{s.setCompareMode(re)},te=re=>{ne.value=re},Q=re=>{ve.value=re};return(re,Pe)=>{const be=__unplugin_components_1$g,we=__unplugin_components_1$f,Ae=__unplugin_components_0$u,$e=_sfc_main$4v,Me=__unplugin_components_13$2;return openBlock(),createElementBlock(Fragment,null,[m.value?(openBlock(),createElementBlock("div",_hoisted_1$2N,[createVNode($e,{show:m.value,dialogName:dialogName$c,close:!1},{header:withCtx(()=>[createBaseVNode("div",_hoisted_2$2A,[createBaseVNode("div",{class:normalizeClass({selected:g.value==="content"}),onClick:Pe[0]||(Pe[0]=Ie=>U("content"))},toDisplayString(re.$t("compare.contentDialog.title")),3),createBaseVNode("div",{class:normalizeClass({selected:g.value==="cover"}),onClick:Pe[1]||(Pe[1]=Ie=>U("cover"))},toDisplayString(re.$t("compare.overlayDialog.title")),3)])]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:X},toDisplayString(re.$t("compare.return")),1),createBaseVNode("div",{class:"rect-button blue",onClick:J},toDisplayString(re.$t("compare.compare")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3$2n,[createBaseVNode("div",_hoisted_4$Y,[createBaseVNode("div",{class:normalizeClass({selected:g.value==="content"}),onClick:Pe[2]||(Pe[2]=Ie=>U("content"))},toDisplayString(re.$t("compare.contentDialog.title")),3),createBaseVNode("div",{class:normalizeClass({selected:g.value==="cover"}),onClick:Pe[3]||(Pe[3]=Ie=>U("cover"))},toDisplayString(re.$t("compare.overlayDialog.title")),3)]),withDirectives(createBaseVNode("div",_hoisted_5$A,[createBaseVNode("p",_hoisted_6$q,toDisplayString(re.$t("compare.contentDialog.items")),1),createBaseVNode("div",_hoisted_7$i,[createBaseVNode("div",{class:"check-box",onClick:Pe[4]||(Pe[4]=Ie=>S.value=!S.value)},[createBaseVNode("div",{class:normalizeClass(["check",{active:S.value}])},[withDirectives(createVNode(be,null,null,512),[[vShow,S.value]])],2),createBaseVNode("span",null,toDisplayString(re.$t("compare.contentDialog.text")),1)])]),createBaseVNode("div",_hoisted_8$f,[createBaseVNode("div",{class:"check-box",onClick:Pe[5]||(Pe[5]=Ie=>E.value=!E.value)},[createBaseVNode("div",{class:normalizeClass(["check",{active:E.value}])},[withDirectives(createVNode(be,null,null,512),[[vShow,E.value]])],2),createBaseVNode("span",null,toDisplayString(re.$t("compare.contentDialog.images")),1)])])],512),[[vShow,g.value==="content"]]),withDirectives(createBaseVNode("div",_hoisted_9$f,[createBaseVNode("p",_hoisted_10$e,toDisplayString(re.$t("common.uiElements.opacity")),1),createBaseVNode("div",_hoisted_11$b,[createBaseVNode("span",null,toDisplayString(re.$t("compare.oldFile")),1),createVNode(unref(NSlider),{value:d.value,"onUpdate:value":Pe[6]||(Pe[6]=Ie=>d.value=Ie),step:10,max:100,min:0},{thumb:withCtx(()=>[createVNode(we)]),_:1},8,["value"]),createBaseVNode("div",_hoisted_12$a,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Pe[7]||(Pe[7]=Ie=>d.value=Ie),type:"number",step:"10",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onBlur:fe,name:"compare"},null,544),[[vModelText,d.value]])])]),createBaseVNode("div",_hoisted_13$a,[createBaseVNode("span",null,toDisplayString(re.$t("compare.newFile")),1),createVNode(unref(NSlider),{value:f.value,"onUpdate:value":Pe[8]||(Pe[8]=Ie=>f.value=Ie),step:10,max:100,min:0},{thumb:withCtx(()=>[createVNode(we)]),_:1},8,["value"]),createBaseVNode("div",_hoisted_14$a,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Pe[9]||(Pe[9]=Ie=>f.value=Ie),type:"number",step:"10",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onBlur:Z,name:"compare"},null,544),[[vModelText,f.value]])])])],512),[[vShow,g.value==="cover"]]),createBaseVNode("div",_hoisted_15$a,[createBaseVNode("p",_hoisted_16$9,toDisplayString(re.$t("compare.contentDialog.colorMark")),1),g.value==="cover"?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_17$8,[createBaseVNode("span",null,toDisplayString(re.$t("compare.oldFile")),1),createVNode(unref(NPopover),{ref_key:"oldColorPopover",ref:I,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"color-popover"},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_18$7,[createBaseVNode("div",_hoisted_19$7,[createBaseVNode("span",_hoisted_20$7,[createBaseVNode("span",_hoisted_21$7,[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${y.value};`)},null,4)])])]),createVNode(Ae)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_22$7,[(openBlock(),createElementBlock(Fragment,null,renderList(N,(Ie,Le)=>createBaseVNode("div",{class:"drop-item",key:Le},[createBaseVNode("div",_hoisted_23$5,[createBaseVNode("span",_hoisted_24$5,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:y.value===Ie}]),onClick:le=>j("old",Ie)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ie};`)},null,4)],10,_hoisted_25$5)])])])),64))])]),_:1},512)]),createBaseVNode("div",_hoisted_26$5,[createBaseVNode("span",null,toDisplayString(re.$t("compare.newFile")),1),createVNode(unref(NPopover),{ref_key:"newColorPopover",ref:O,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"color-popover"},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_27$4,[createBaseVNode("div",_hoisted_28$4,[createBaseVNode("span",_hoisted_29$4,[createBaseVNode("span",_hoisted_30$4,[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${x.value};`)},null,4)])])]),createVNode(Ae)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_31$4,[(openBlock(),createElementBlock(Fragment,null,renderList(N,(Ie,Le)=>createBaseVNode("div",{class:"drop-item",key:Le},[createBaseVNode("div",_hoisted_32$3,[createBaseVNode("span",_hoisted_33$2,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:x.value===Ie}]),onClick:le=>j("new",Ie)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ie};`)},null,4)],10,_hoisted_34$2)])])])),64))])]),_:1},512)]),createBaseVNode("div",_hoisted_35$2,[createBaseVNode("span",null,toDisplayString(re.$t("compare.overlayDialog.blendMode")),1),createVNode(unref(NPopselect),{value:k.value,"onUpdate:value":Pe[10]||(Pe[10]=Ie=>k.value=Ie),options:P,trigger:"click",placement:"bottom-start"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_36$1,[createBaseVNode("span",null,toDisplayString(P[parseInt(k.value)].label),1),createVNode(Ae)])]),_:1},8,["value"])])],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("div",_hoisted_37$1,[createBaseVNode("span",null,toDisplayString(re.$t("compare.contentDialog.replaced")),1),createVNode(unref(NPopover),{ref_key:"replaceColorPopover",ref:F,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"color-popover"},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_38$1,[createBaseVNode("div",_hoisted_39$1,[createBaseVNode("span",_hoisted_40$1,[createBaseVNode("span",_hoisted_41$1,[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${M.value};`)},null,4)])])]),createVNode(Ae)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_42,[(openBlock(),createElementBlock(Fragment,null,renderList(N,(Ie,Le)=>createBaseVNode("div",{class:"drop-item",key:Le},[createBaseVNode("div",_hoisted_43,[createBaseVNode("span",_hoisted_44,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:M.value===Ie}]),onClick:le=>j("replace",Ie)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ie};`)},null,4)],10,_hoisted_45)])])])),64))])]),_:1},512)]),createBaseVNode("div",_hoisted_46,[createBaseVNode("span",null,toDisplayString(re.$t("compare.contentDialog.inserted")),1),createVNode(unref(NPopover),{ref_key:"insertColorPopover",ref:q,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"color-popover"},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_47,[createBaseVNode("div",_hoisted_48,[createBaseVNode("span",_hoisted_49,[createBaseVNode("span",_hoisted_50,[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${T.value};`)},null,4)])])]),createVNode(Ae)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_51,[(openBlock(),createElementBlock(Fragment,null,renderList(N,(Ie,Le)=>createBaseVNode("div",{class:"drop-item",key:Le},[createBaseVNode("div",_hoisted_52,[createBaseVNode("span",_hoisted_53,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:T.value===Ie}]),onClick:le=>j("insert",Ie)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ie};`)},null,4)],10,_hoisted_54)])])])),64))])]),_:1},512)]),createBaseVNode("div",_hoisted_55,[createBaseVNode("span",null,toDisplayString(re.$t("compare.contentDialog.deleted")),1),createVNode(unref(NPopover),{ref_key:"deleteColorPopover",ref:Y,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"color-popover"},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_56,[createBaseVNode("div",_hoisted_57,[createBaseVNode("span",_hoisted_58,[createBaseVNode("span",_hoisted_59,[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${D.value};`)},null,4)])])]),createVNode(Ae)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_60,[(openBlock(),createElementBlock(Fragment,null,renderList(N,(Ie,Le)=>createBaseVNode("div",{class:"drop-item",key:Le},[createBaseVNode("div",_hoisted_61,[createBaseVNode("span",_hoisted_62,[createBaseVNode("span",{class:normalizeClass(["cell-outer",{active:D.value===Ie}]),onClick:le=>j("delete",Ie)},[createBaseVNode("span",{class:"cell",style:normalizeStyle(`background-color: ${Ie};`)},null,4)],10,_hoisted_63)])])])),64))])]),_:1},512)])],64))]),createBaseVNode("div",_hoisted_64,[createBaseVNode("div",{class:"rect-button white",onClick:X},toDisplayString(re.$t("compare.return")),1),createBaseVNode("div",{class:"rect-button blue",onClick:J},toDisplayString(re.$t("compare.compare")),1)])])]),_:1},8,["show"])])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["mask",{active:_e.value}])},[withDirectives(createBaseVNode("div",_hoisted_65,[createVNode(Me)],512),[[vShow,_e.value]]),createBaseVNode("div",_hoisted_66,[createBaseVNode("span",null,toDisplayString(re.$t("compare.status")),1)])],2)],64)}}},_sfc_main$39={},_hoisted_1$2M={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.625 9.375V3.75H9.375V9.375H3.75V10.625H9.375V16.25H10.625V10.625H16.25V9.375H10.625Z",fill:"currentColor"},null,-1),_hoisted_3$2m=[_hoisted_2$2z];function _sfc_render$1P(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2M,_hoisted_3$2m)}const __unplugin_components_3$b=_export_sfc(_sfc_main$39,[["render",_sfc_render$1P]]),_sfc_main$38={},_hoisted_1$2L={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2y=createBaseVNode("rect",{x:"3.75",y:"9.375",width:"12.5",height:"1.25",fill:"currentColor"},null,-1),_hoisted_3$2l=[_hoisted_2$2y];function _sfc_render$1O(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2L,_hoisted_3$2l)}const __unplugin_components_1$9=_export_sfc(_sfc_main$38,[["render",_sfc_render$1O]]),_sfc_main$37={},_hoisted_1$2K={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2x=createBaseVNode("rect",{opacity:"0.01",width:"16",height:"16",transform:"matrix(0 -1 -1 0 16 16)",fill:"currentColor"},null,-1),_hoisted_3$2k=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 5.51025L7.5041 10.5L11.5 5.5L3.5 5.51025Z",fill:"currentColor"},null,-1),_hoisted_4$X=[_hoisted_2$2x,_hoisted_3$2k];function _sfc_render$1N(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2K,_hoisted_4$X)}const __unplugin_components_11$1=_export_sfc(_sfc_main$37,[["render",_sfc_render$1N]]),ZoomOverlay_vue_vue_type_style_index_0_lang="",_hoisted_1$2J={class:"input-container"},_hoisted_2$2w={class:"drop-down-zoom"},_hoisted_3$2j=createBaseVNode("span",null,"%",-1),_hoisted_4$W={class:"drop-down zoom"},_sfc_main$36={__name:"ZoomOverlay",props:["docNum"],setup(e){const{docNum:n}=e,o=ref(null),{proxy:{$forceUpdate:r}}=getCurrentInstance(),u=useViewerStore(),s=computed(()=>n===2?u.getOldScale:n===3?u.getNewScale:u.getScale),w=computed(()=>u.getUpload),m=()=>{s.value<=5||core.zoomOut(n)},v=()=>{s.value>1e3||core.zoomIn(n)},g=x=>{const k=/^(\d){0,4}$/,P=x.target.value;k.test(P)||P===""?n===2?u.setOldCurrentScale(P/100):n===3?u.setNewCurrentScale(P/100):u.setCurrentScale(P/100):(n===2?u.setOldCurrentScale(u.getOldScale/100):n===3?u.setNewCurrentScale(u.getNewScale/100):u.setCurrentScale(u.getScale/100),r())},d=x=>{let k="";if(x.target&&x.target.value?k=x.target.value:k=x,!k){s.value=u.getScale;return}if(/^(\d){0,4}$/.test(k)){let S=Math.max(5,k);S=Math.min(1e3,S),n===2?u.setOldCurrentScale(S/100):n===3?u.setNewCurrentScale(S/100):u.setCurrentScale(S/100),core.scaleChanged(S/100,n)}else n===2?u.setOldCurrentScale(u.getOldScale/100):n===3?u.setNewCurrentScale(u.getNewScale/100):u.setCurrentScale(u.getScale/100),r();o.value.setShow(!1)},f=computed(()=>s.value?s.value.toString().length*9:0),y=x=>{x.target.value?d(x):d("100")};return(x,k)=>{const P=__unplugin_components_11$1,S=__unplugin_components_1$9,E=_sfc_main$4C,M=__unplugin_components_3$b;return openBlock(),createElementBlock("div",{class:normalizeClass(["zoom-overlay",{disabled:!w.value}])},[createBaseVNode("div",_hoisted_1$2J,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":k[0]||(k[0]=T=>s.value=T),type:"text",pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onInput:g,onKeydown:withKeys(d,["enter"]),onBlur:y,style:normalizeStyle({width:f.value+"px"}),name:"zoom"},null,36),[[vModelText,s.value]]),createBaseVNode("div",_hoisted_2$2w,[_hoisted_3$2j,createVNode(unref(NPopover),{ref_key:"popover",ref:o,placement:"bottom",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,"z-index":4,disabled:!w.value},{trigger:withCtx(()=>[createVNode(P,{class:"arrow-left"})]),default:withCtx(()=>[createBaseVNode("div",_hoisted_4$W,[createBaseVNode("div",{class:"drop-item",onClick:k[1]||(k[1]=T=>d("10"))},"10%"),createBaseVNode("div",{class:"drop-item",onClick:k[2]||(k[2]=T=>d("25"))},"25%"),createBaseVNode("div",{class:"drop-item",onClick:k[3]||(k[3]=T=>d("50"))},"50%"),createBaseVNode("div",{class:"drop-item",onClick:k[4]||(k[4]=T=>d("100"))},"100%"),createBaseVNode("div",{class:"drop-item",onClick:k[5]||(k[5]=T=>d("150"))},"150%"),createBaseVNode("div",{class:"drop-item",onClick:k[6]||(k[6]=T=>d("200"))},"200%"),createBaseVNode("div",{class:"drop-item",onClick:k[7]||(k[7]=T=>d("300"))},"300%"),createBaseVNode("div",{class:"drop-item",onClick:k[8]||(k[8]=T=>d("400"))},"400%"),createBaseVNode("div",{class:"drop-item",onClick:k[9]||(k[9]=T=>d("500"))},"500%"),createBaseVNode("div",{class:"drop-item",onClick:k[10]||(k[10]=T=>d("1000"))},"1000%")])]),_:1},8,["disabled"])])]),createVNode(E,{img:"icon-header-zoom-out",onClick:m,title:x.$t("toolbar.viewControls.zoomOut"),class:normalizeClass({disabled:!w.value})},{default:withCtx(()=>[createVNode(S)]),_:1},8,["title","class"]),createVNode(E,{img:"icon-header-zoom-in",onClick:v,title:x.$t("toolbar.viewControls.zoomIn"),class:normalizeClass({disabled:!w.value})},{default:withCtx(()=>[createVNode(M)]),_:1},8,["title","class"])],2)}}},CompareDocumentContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$2I={class:"old"},_hoisted_2$2v={class:"file-type"},_hoisted_3$2i={class:"upload-tip"},_hoisted_4$V=createBaseVNode("br",null,null,-1),_hoisted_5$z={class:"rect-button white"},_hoisted_6$p={key:1,class:"uploaded pc"},_hoisted_7$h={class:"header-info"},_hoisted_8$e={class:"file-name"},_hoisted_9$e={class:"drop-area mobile"},_hoisted_10$d={class:"upload-tip mobile"},_hoisted_11$a={class:"text"},_hoisted_12$9={class:"rect-button white"},_hoisted_13$9={key:0,class:"file-name"},_hoisted_14$9={class:"new"},_hoisted_15$9={class:"file-type"},_hoisted_16$8={class:"upload-tip"},_hoisted_17$7=createBaseVNode("br",null,null,-1),_hoisted_18$6={class:"rect-button white"},_hoisted_19$6={key:1,class:"uploaded pc"},_hoisted_20$6={class:"header-info"},_hoisted_21$6={class:"file-name"},_hoisted_22$6={class:"drop-area mobile"},_hoisted_23$4={class:"upload-tip"},_hoisted_24$4={class:"text"},_hoisted_25$4={class:"rect-button white"},_hoisted_26$4={key:0,class:"file-name"},_sfc_main$35={__name:"CompareDocumentContainer",props:{docNum:Number},setup(e){const{loadDocument:n,initializeViewer:o,initConfig:r}=core,u=useViewerStore(),s=useDocumentStore(),w=computed(()=>u.getToolMode),m=computed(()=>u.getCompareStatus),v=ref(),g=ref(),d=ref(),f=ref();let y=computed(()=>s.getCompareFile("oldFile")),x=computed(()=>s.getCompareFile("newFile")),k=ref(!1),P=ref(!1);const S=computed(()=>u.getVerified);watch(()=>w.value,(Y,_e)=>{_e==="compare"&&Y!==_e&&(M(),O()),Y==="compare"&&Y!==_e&&setTimeout(()=>{S.value||(core.eventBus().dispatch("message",{type:"ERROR",message:"Invalid license"}),console.log("Invalid license")),I()},1)});const E=async(Y,_e)=>{if(!Y.target.files[0])return;let ne=URL.createObjectURL(Y.target.files[0]);const ve=await core.checkPassword(ne,!0);if(ve===!1){Y.target.value="";return}const J=Y.target.files[0].name;_e==="old"&&(s.setCompareFiles("oldFile",Y.target.files[0]),s.setCompareFiles("oldFilePassword",ve),F(ne,J,2)),_e==="new"&&(s.setCompareFiles("newFile",Y.target.files[0]),s.setCompareFiles("newFilePassword",ve),F(ne,J,3))},M=Y=>{Y==="old"?(s.setCompareFiles("oldFile",null),s.setCompareFiles("oldFilePassword","")):Y==="new"?(s.setCompareFiles("newFile",null),s.setCompareFiles("newFilePassword","")):s.initCompareFiles(),u.setCompareStatus("")},T=async(Y,_e)=>{Y.preventDefault();const ne=Y.dataTransfer.files;if(k.value=!1,P.value=!1,ne[0].type!=="application/pdf")return;let ve=URL.createObjectURL(ne[0]);const J=await core.checkPassword(ve,!0);if(J===!1){Y.target.value="";return}const fe=ne[0].name;_e==="old"&&(s.setCompareFiles("oldFile",ne[0]),s.setCompareFiles("oldFilePassword",J),F(ve,fe,2)),_e==="new"&&(s.setCompareFiles("newFile",ne[0]),s.setCompareFiles("newFilePassword",J),F(ve,fe,3))},D=Y=>{Y==="old"&&(k.value=!0),Y==="new"&&(P.value=!0)},N=Y=>{const _e=document.getElementById("oldDropArea"),ne=document.getElementById("newDropArea");let ve=Y.relatedTarget;for(;ve;){if(ve===_e||_e.contains(ve)||ve===ne||ne.contains(ve))return;ve=ve.parentElement}k.value=!1,P.value=!1},I=()=>{const Y=u.getLicense;!Y||(core.setDocumentViewer(2,null,{$t:instance.$t}),core.setDocumentViewer(3,null,{$t:instance.$t}),r({license:Y},2),o({container:v.value,viewer:g.value},2),r({license:Y},3),o({container:d.value,viewer:f.value},3))},O=()=>{core.deleteDocumentViewer(2),core.deleteDocumentViewer(3)};async function F(Y,_e,ne){u.setUpload(!0),u.setUploadLoading(!0),await q(Y,_e,ne),u.setUploadLoading(!1)}async function q(Y,_e,ne){let ve=null;ne===2?ve=s.getCompareFile("oldFilePassword"):ne===3&&(ve=s.getCompareFile("newFilePassword"));const J={extension:getHashParameters("extension",null),filename:getHashParameters("filename",null)||_e,externalPath:getHashParameters("p",""),documentId:getHashParameters("did",null),progress:s.setLoadingProgress,pageChangedCallback:u.setCurrentPage,scaleChangedCallback:ne===2?u.setOldCurrentScale:u.setNewCurrentScale,annotationsNumChangedCallback:s.setAnnotationsCount,distanceChangedCallback:s.setDistance,notUploadPdf:!0};ve&&(J.pwd=ve);try{await n(Y,J,ne)}catch(fe){console.log(fe),(fe==="invalid_file_error"||fe==="no_password_given"||fe==="incorrect_password")&&(u.setUpload(!1),s.setLoadingProgress(0),u.resetSetting())}}return window.instance.UI.loadCompareDocument=async(Y,_e="",ne="",ve="")=>{if(!Y)return;const J=URL.createObjectURL(Y);ve==="old"&&(s.setCompareFiles("oldFile",Y),s.setCompareFiles("oldFilePassword",ne),F(J,_e,2)),ve==="new"&&(s.setCompareFiles("newFile",Y),s.setCompareFiles("newFilePassword",ne),F(J,_e,3))},(Y,_e)=>{const ne=_sfc_main$36,ve=__unplugin_components_1$h,J=_sfc_main$3a,fe=_sfc_main$3b,Z=_sfc_main$3c;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["compare-document-container",{under:w.value!=="compare"||w.value==="compare"&&m.value==="finished"}])},[createBaseVNode("div",_hoisted_1$2I,[createBaseVNode("div",_hoisted_2$2v,toDisplayString(Y.$t("compare.oldFile")),1),createBaseVNode("div",{class:normalizeClass(["file-content",{"no-file":!unref(y)}])},[unref(y)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["drop-area pc",{"drag-over":unref(k)}]),id:"oldDropArea",onDragover:_e[1]||(_e[1]=withModifiers(()=>{},["prevent"])),onDragenter:_e[2]||(_e[2]=j=>D("old")),onDragleave:N,onDrop:_e[3]||(_e[3]=j=>T(j,"old"))},[createBaseVNode("div",_hoisted_3$2i,[createBaseVNode("p",null,[createTextVNode(toDisplayString(Y.$t("compare.dropFile")[0]),1),_hoisted_4$V,createTextVNode(toDisplayString(Y.$t("compare.dropFile")[1]),1)]),createBaseVNode("div",_hoisted_5$z,[createTextVNode(toDisplayString(Y.$t("compare.chooseOld")),1),createBaseVNode("input",{type:"file",onChange:_e[0]||(_e[0]=j=>E(j,"old")),accept:".pdf",name:"compare"},null,32)])])],34)),unref(y)?(openBlock(),createElementBlock("div",_hoisted_6$p,[createBaseVNode("div",_hoisted_7$h,[createVNode(ne,{docNum:2}),createBaseVNode("p",_hoisted_8$e,toDisplayString(unref(y).name),1),createVNode(ve,{class:"close",onClick:_e[4]||(_e[4]=j=>M("old"))})])])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["old-file-container file-container pc",{"no-file":!unref(y)}]),ref_key:"oldFileContainer",ref:v},[createBaseVNode("div",{ref_key:"oldViewerContainer",ref:g,class:"document"},null,512)],2),createBaseVNode("div",_hoisted_9$e,[createBaseVNode("div",_hoisted_10$d,[createBaseVNode("div",_hoisted_11$a,[createBaseVNode("p",null,toDisplayString(Y.$t("compare.oldFile")),1)]),createBaseVNode("div",_hoisted_12$9,[createTextVNode(toDisplayString(Y.$t("compare.chooseOld"))+" ",1),createBaseVNode("input",{type:"file",onChange:_e[5]||(_e[5]=j=>E(j,"old")),accept:".pdf",name:"compare"},null,32),unref(y)?(openBlock(),createElementBlock("p",_hoisted_13$9,toDisplayString(unref(y).name),1)):createCommentVNode("",!0)])])])],2)]),createBaseVNode("div",_hoisted_14$9,[createBaseVNode("div",_hoisted_15$9,toDisplayString(Y.$t("compare.newFile")),1),createBaseVNode("div",{class:normalizeClass(["file-content",{"no-file":!unref(x)}])},[unref(x)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["drop-area pc",{"drag-over":unref(P)}]),id:"newDropArea",onDragover:_e[7]||(_e[7]=withModifiers(()=>{},["prevent"])),onDragenter:_e[8]||(_e[8]=j=>D("new")),onDragleave:N,onDrop:_e[9]||(_e[9]=j=>T(j,"new"))},[createBaseVNode("div",_hoisted_16$8,[createBaseVNode("p",null,[createTextVNode(toDisplayString(Y.$t("compare.dropFile")[0]),1),_hoisted_17$7,createTextVNode(toDisplayString(Y.$t("compare.dropFile")[1]),1)]),createBaseVNode("div",_hoisted_18$6,[createTextVNode(toDisplayString(Y.$t("compare.chooseNew")),1),createBaseVNode("input",{type:"file",onChange:_e[6]||(_e[6]=j=>E(j,"new")),accept:".pdf",name:"compare"},null,32)])])],34)),unref(x)?(openBlock(),createElementBlock("div",_hoisted_19$6,[createBaseVNode("div",_hoisted_20$6,[createVNode(ne,{docNum:3}),createBaseVNode("p",_hoisted_21$6,toDisplayString(unref(x).name),1),createVNode(ve,{class:"close",onClick:_e[10]||(_e[10]=j=>M("new"))})])])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["new-file-container file-container pc",{"no-file":!unref(x)}]),ref_key:"newFileContainer",ref:d},[createBaseVNode("div",{ref_key:"newViewerContainer",ref:f,class:"document"},null,512)],2),createBaseVNode("div",_hoisted_22$6,[createBaseVNode("div",_hoisted_23$4,[createBaseVNode("div",_hoisted_24$4,[createBaseVNode("p",null,toDisplayString(Y.$t("compare.newFile")),1)]),createBaseVNode("div",_hoisted_25$4,[createTextVNode(toDisplayString(Y.$t("compare.chooseNew"))+" ",1),createBaseVNode("input",{type:"file",onChange:_e[11]||(_e[11]=j=>E(j,"new")),accept:".pdf",name:"compare"},null,32),unref(x)?(openBlock(),createElementBlock("p",_hoisted_26$4,toDisplayString(unref(x).name),1)):createCommentVNode("",!0)])])])],2)])],2),createVNode(J),createVNode(fe),createVNode(Z)],64)}}},_imports_0=""+new URL("../images/curve-guide.gif",import.meta.url).href,MeasureCurveGuide_vue_vue_type_style_index_0_lang="",_hoisted_1$2H=createBaseVNode("img",{src:_imports_0,alt:""},null,-1),_hoisted_2$2u={class:"title"},_hoisted_3$2h={class:"got-button"},_sfc_main$34={__name:"MeasureCurveGuide",setup(e){const n=useDocumentStore(),o=computed(()=>n.getActiveTool),r=ref(!1),u=ref("calc(50% - 155px)"),s=ref("95px");let w=!1;watch(o,(v,g)=>{if(v==="curve"&&!w){const d=document.querySelector('[data-element="measureCurve"]');if(d){const f=d.getBoundingClientRect();u.value=f.left+f.width/2+"px",s.value=f.top+f.height+15+"px"}r.value=!0}else r.value=!1});const m=()=>{r.value=!1,w=!0};return(v,g)=>r.value?(openBlock(),createElementBlock("div",{key:0,class:"measure-curve-guide",style:normalizeStyle({left:u.value,top:s.value})},[_hoisted_1$2H,createBaseVNode("p",_hoisted_2$2u,toDisplayString(v.$t("measurement.curveMeasurement.title")),1),createBaseVNode("p",null,toDisplayString(v.$t("measurement.curveMeasurement.steps")[0]),1),createBaseVNode("p",null,toDisplayString(v.$t("measurement.curveMeasurement.steps")[1]),1),createBaseVNode("div",_hoisted_3$2h,[createBaseVNode("span",{onClick:m},toDisplayString(v.$t("measurement.curveMeasurement.confirmation")),1)])],4)):createCommentVNode("",!0)}},_sfc_main$33={},_hoisted_1$2G={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2t=createBaseVNode("path",{d:"M2.52442 5.684L10 1.36798L17.4756 5.684V14.3161L10 18.6321L2.52442 14.3161V5.684Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$2g=createBaseVNode("path",{d:"M10.0003 6.50003L13.0314 8.25003V11.75L10.0003 13.5L6.96919 11.75V8.25003L10.0003 6.50003Z",fill:"currentColor"},null,-1),_hoisted_4$U=[_hoisted_2$2t,_hoisted_3$2g];function _sfc_render$1M(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2G,_hoisted_4$U)}const __unplugin_components_4$b=_export_sfc(_sfc_main$33,[["render",_sfc_render$1M]]),_sfc_main$32={},_hoisted_1$2F={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2s=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.54546 4.375L16.6666 4.375V5.625L8.54546 5.625C8.29821 6.2358 7.69939 6.66667 6.99994 6.66667C6.30049 6.66667 5.70167 6.2358 5.45442 5.625L3.33325 5.625L3.33325 4.375L5.45442 4.375C5.70167 3.7642 6.30049 3.33333 6.99994 3.33333C7.69939 3.33333 8.29821 3.7642 8.54546 4.375ZM3.33325 10.625L11.2877 10.625C11.5349 11.2358 12.1337 11.6667 12.8332 11.6667C13.5326 11.6667 14.1314 11.2358 14.3787 10.625H16.6666V9.375H14.3787C14.1314 8.7642 13.5326 8.33333 12.8332 8.33333C12.1337 8.33333 11.5349 8.7642 11.2877 9.375L3.33325 9.375L3.33325 10.625ZM5.45432 15.625H3.33325L3.33325 14.375H5.45432C5.70156 13.7642 6.30038 13.3333 6.99984 13.3333C7.69929 13.3333 8.29811 13.7642 8.54535 14.375L16.6666 14.375V15.625L8.54535 15.625C8.29811 16.2358 7.69929 16.6667 6.99984 16.6667C6.30038 16.6667 5.70156 16.2358 5.45432 15.625Z",fill:"currentColor"},null,-1),_hoisted_3$2f=[_hoisted_2$2s];function _sfc_render$1L(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2F,_hoisted_3$2f)}const __unplugin_components_21=_export_sfc(_sfc_main$32,[["render",_sfc_render$1L]]),_sfc_main$31={},_hoisted_1$2E={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2r=createBaseVNode("path",{d:"M17.8252 2.743H2.17484V17.4101C2.17484 17.4943 2.27256 17.5408 2.33791 17.4877L6.16578 14.3765H17.8252V2.743Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$2e=createBaseVNode("path",{d:"M5.00003 6.77402H14",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$T=createBaseVNode("path",{d:"M5.00003 10.2973H11",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_5$y=[_hoisted_2$2r,_hoisted_3$2e,_hoisted_4$T];function _sfc_render$1K(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2E,_hoisted_5$y)}const __unplugin_components_1$8=_export_sfc(_sfc_main$31,[["render",_sfc_render$1K]]),_sfc_main$30={},_hoisted_1$2D={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2q=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 3H0V17H20V3ZM9.5918 10.3271C9.5918 12.3794 8.41406 13.6626 6.54199 13.6626C4.65674 13.6626 3.48779 12.3794 3.48779 10.3271C3.48779 8.27051 4.67432 6.99609 6.54199 6.99609C8.40967 6.99609 9.5918 8.2749 9.5918 10.3271ZM4.8457 10.3271C4.8457 11.6719 5.49609 12.5376 6.54199 12.5376C7.57471 12.5376 8.23389 11.6719 8.23389 10.3271C8.23389 8.97803 7.57031 8.12109 6.54199 8.12109C5.50928 8.12109 4.8457 8.97803 4.8457 10.3271ZM12.1758 13.5V11.562L12.8042 10.8062L14.6455 13.5H16.2363L13.7622 9.93604L16.0737 7.15869H14.5972L12.2549 10.0063H12.1758V7.15869H10.8486V13.5H12.1758Z",fill:"currentColor"},null,-1),_hoisted_3$2d=[_hoisted_2$2q];function _sfc_render$1J(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2D,_hoisted_3$2d)}const __unplugin_components_0$s=_export_sfc(_sfc_main$30,[["render",_sfc_render$1J]]),_sfc_main$2$={},_hoisted_1$2C={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2p=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0.25 2.25H19.75V10.75H15.75V17.75H0.25V10.75V9.25V2.25ZM1.75 10.75H14.25V16.25H1.75V10.75ZM18.25 9.25H15.75H1.75V3.75H18.25V9.25ZM15 8L17 5.5H13L15 8Z",fill:"currentColor"},null,-1),_hoisted_3$2c=[_hoisted_2$2p];function _sfc_render$1I(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2C,_hoisted_3$2c)}const __unplugin_components_0$r=_export_sfc(_sfc_main$2$,[["render",_sfc_render$1I]]),_sfc_main$2_={},_hoisted_1$2B={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2o=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.75 2.25H0.25V17.75H19.75V2.25ZM18.25 10.75V16.25H1.75V10.75H18.25ZM18.25 9.25V3.75H1.75V9.25H18.25ZM6 5.5H3V7.5H6V5.5ZM3 12.5H6V14.5H3V12.5Z",fill:"currentColor"},null,-1),_hoisted_3$2b=[_hoisted_2$2o];function _sfc_render$1H(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2B,_hoisted_3$2b)}const __unplugin_components_0$q=_export_sfc(_sfc_main$2_,[["render",_sfc_render$1H]]),_sfc_main$2Z={},_hoisted_1$2A={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2n=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 1.25C5.16751 1.25 1.25 5.16751 1.25 10C1.25 14.8325 5.16751 18.75 10 18.75C14.8325 18.75 18.75 14.8325 18.75 10C18.75 5.16751 14.8325 1.25 10 1.25ZM10 2.75C14.0041 2.75 17.25 5.99594 17.25 10C17.25 14.0041 14.0041 17.25 10 17.25C5.99594 17.25 2.75 14.0041 2.75 10C2.75 5.99594 5.99594 2.75 10 2.75ZM10 13C11.6569 13 13 11.6569 13 10C13 8.34315 11.6569 7 10 7C8.34315 7 7 8.34315 7 10C7 11.6569 8.34315 13 10 13Z",fill:"currentColor"},null,-1),_hoisted_3$2a=[_hoisted_2$2n];function _sfc_render$1G(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2A,_hoisted_3$2a)}const __unplugin_components_0$p=_export_sfc(_sfc_main$2Z,[["render",_sfc_render$1G]]),_sfc_main$2Y={},_hoisted_1$2z={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2m=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.25 1.75H1.75V18.25H18.25V1.75ZM16.75 3.25V16.75H3.25V3.25H16.75ZM15.532 7.52861L14.468 6.47139L9.038 11.935L6.53204 9.41291L5.46796 10.4701L9.03873 14.0641L15.532 7.52861Z",fill:"currentColor"},null,-1),_hoisted_3$29=[_hoisted_2$2m];function _sfc_render$1F(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2z,_hoisted_3$29)}const __unplugin_components_0$o=_export_sfc(_sfc_main$2Y,[["render",_sfc_render$1F]]),_sfc_main$2X={},_hoisted_1$2y={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2l=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0.25 2.25H19.75V17.75H0.25V2.25ZM18.25 11.75V3.75H1.75V16.25H13.75L18.25 11.75ZM11.25 5.5V8H9.75V7H8V13H8.75V14.5H5.75V13H6.5V7H4.75V8H3.25V5.5H11.25Z",fill:"currentColor"},null,-1),_hoisted_3$28=[_hoisted_2$2l];function _sfc_render$1E(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2y,_hoisted_3$28)}const __unplugin_components_0$n=_export_sfc(_sfc_main$2X,[["render",_sfc_render$1E]]),_sfc_main$2W={},_hoisted_1$2x={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2k=createBaseVNode("g",{id:"subtoolbar / mytools / links"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.8388 7.17154L14.331 11.6793L13.2703 10.6187L16.7175 7.17154L12.8284 3.28245L9.38125 6.7296L8.32059 5.66894L12.8284 1.16113L18.8388 7.17154ZM6.7296 9.38125L3.28245 12.8284L7.17154 16.7175L10.6187 13.2703L11.6793 14.331L7.17154 18.8388L1.16113 12.8284L5.66894 8.32059L6.7296 9.38125ZM9.11608 11.9445L11.9445 9.11608L10.8839 8.05542L8.05542 10.8839L9.11608 11.9445Z",fill:"currentColor"})],-1),_hoisted_3$27=[_hoisted_2$2k];function _sfc_render$1D(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2x,_hoisted_3$27)}const __unplugin_components_19=_export_sfc(_sfc_main$2W,[["render",_sfc_render$1D]]),_sfc_main$2V={},_hoisted_1$2w={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2j=createBaseVNode("g",{id:"subtoolbar / mytools / image"},[createBaseVNode("path",{id:"ic","fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.25 3.25H18.75V16.75H1.25V3.25ZM17.25 4.75H2.75V13.2095L5.79496 10L10.0643 13.5L12.3718 11.0678L17.1442 15.25H17.25V4.75ZM14.5 9C15.3284 9 16 8.32843 16 7.5C16 6.67157 15.3284 6 14.5 6C13.6716 6 13 6.67157 13 7.5C13 8.32843 13.6716 9 14.5 9Z",fill:"currentColor"})],-1),_hoisted_3$26=[_hoisted_2$2j];function _sfc_render$1C(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2w,_hoisted_3$26)}const __unplugin_components_18=_export_sfc(_sfc_main$2V,[["render",_sfc_render$1C]]),_sfc_main$2U={},_hoisted_1$2v={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2i=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.982 9.97521C13.1875 9.28619 14 7.98798 14 6.5C14 4.29086 12.2091 2.5 10 2.5C7.79086 2.5 6 4.29086 6 6.5C6 7.98798 6.81248 9.2862 8.018 9.97522C8.10745 10.1032 8.5 10.6962 8.5 11.25C8.5 11.875 8 12.5 8 12.5H2V14H18V12.5H12C12 12.5 11.5 11.875 11.5 11.25C11.5 10.6962 11.8926 10.1032 11.982 9.97521ZM18 17.5V16H2V17.5H18Z",fill:"currentColor"},null,-1),_hoisted_3$25=[_hoisted_2$2i];function _sfc_render$1B(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2v,_hoisted_3$25)}const __unplugin_components_17=_export_sfc(_sfc_main$2U,[["render",_sfc_render$1B]]),_sfc_main$2T={},_hoisted_1$2u={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2h=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.75 2.75V6H15.25V4.25H10.75V16.25H12.3337V17.75H7.66699V16.25H9.25V4.25H4.75V6H3.25V2.75H16.75Z",fill:"currentColor"},null,-1),_hoisted_3$24=[_hoisted_2$2h];function _sfc_render$1A(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2u,_hoisted_3$24)}const __unplugin_components_15=_export_sfc(_sfc_main$2T,[["render",_sfc_render$1A]]),_sfc_main$2S={},_hoisted_1$2t={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2g=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.99164 3.52673L9.24244 3.56122L9.31142 5.05963L10.0606 5.02514L14.0731 4.84043L3.46978 15.4438L2.93945 15.9741L4.00011 17.0348L4.53044 16.5044L15.3467 5.68818L15.5465 10.0282L15.581 10.7774L17.0794 10.7084L17.0449 9.95918L16.769 3.96553L16.7345 3.21632L15.9853 3.25081L9.99164 3.52673Z",fill:"currentColor"},null,-1),_hoisted_3$23=[_hoisted_2$2g];function _sfc_render$1z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2t,_hoisted_3$23)}const __unplugin_components_13=_export_sfc(_sfc_main$2S,[["render",_sfc_render$1z]]),_sfc_main$2R={},_hoisted_1$2s={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2f=createBaseVNode("circle",{cx:"10",cy:"10",r:"7",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$22=[_hoisted_2$2f];function _sfc_render$1y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2s,_hoisted_3$22)}const __unplugin_components_7$3=_export_sfc(_sfc_main$2R,[["render",_sfc_render$1y]]),_sfc_main$2Q={},_hoisted_1$2r={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2e=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.57675 19.1757L1 17.7787L2.23629 17.3267L3.39858 16.9142L4.48804 16.5416L5.17445 16.3153L5.82936 16.1069L6.4531 15.9162L7.04603 15.7435L7.60849 15.5886L8.14082 15.4517L8.64337 15.3328C8.72467 15.3145 8.80474 15.297 8.88359 15.2802L9.34212 15.1884L9.77173 15.1147C11.0868 14.91 11.972 14.9785 12.4769 15.3262C12.7932 15.544 13.0243 15.7942 13.1655 16.0808C13.4151 16.5876 13.3721 16.9889 13.1388 17.5664L13.0118 17.8607L13.1178 17.8549C13.3318 17.8376 13.6024 17.7943 13.926 17.7239L14.1265 17.6785L14.3516 17.6235L14.8394 17.4928C14.9249 17.4688 15.0125 17.4435 15.1022 17.4171L15.6652 17.245L16.2781 17.0452L16.9408 16.8178L17.653 16.5629L18.4146 16.2803L19 17.6741L17.9462 18.0639L17.2946 18.2959L16.6828 18.5054L16.1097 18.6922C15.925 18.7507 15.7466 18.8054 15.5744 18.8563L15.076 18.9974C14.9159 19.0406 14.7618 19.0799 14.6135 19.1154L14.186 19.2101C13.0235 19.4455 12.271 19.399 11.8322 19.0549C11.4563 18.7602 11.3001 18.3582 11.3527 17.9256C11.3673 17.8051 11.3855 17.7161 11.4219 17.6072L11.4922 17.4224L11.6818 16.9751L11.7255 16.8448C11.7439 16.7759 11.7424 16.7393 11.7305 16.715C11.7102 16.674 11.6563 16.6156 11.5457 16.5395C11.436 16.4639 11.2053 16.4374 10.8597 16.4606L10.6123 16.4834C10.5683 16.4885 10.5228 16.4941 10.476 16.5004L10.1783 16.5455L9.84745 16.6054L9.48395 16.6803L9.08816 16.7701C9.01952 16.7863 8.94956 16.8031 8.87827 16.8206L8.43479 16.933L7.95999 17.0604L7.45428 17.203L6.63861 17.4454L5.75561 17.7221L4.80659 18.0333L3.79289 18.3792L3.08181 18.6292L2.34296 18.8946L1.57675 19.1757Z",fill:"#64BC38"},null,-1),_hoisted_3$21=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.7275 1.00012L16.9702 5.24276L14.8385 7.37449L10.5958 3.13185L12.7275 1.00012ZM9.8887 3.83896L3.53515 10.1925L2.12094 15.8494L7.77779 14.4352L14.1313 8.0816L9.8887 3.83896Z",fill:"currentColor"},null,-1),_hoisted_4$S=[_hoisted_2$2e,_hoisted_3$21];function _sfc_render$1x(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2r,_hoisted_4$S)}const __unplugin_components_6$5=_export_sfc(_sfc_main$2Q,[["render",_sfc_render$1x]]),_sfc_main$2P={},_hoisted_1$2q={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2d=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13 14H13.9922L12.8923 11.25H7.10772L6.00776 14H7V15H3V14H4.39223L9.30364 1.72146H10.6964L15.6078 14H17V15H13V14ZM7.5077 10.25H12.4923L10 4.019L7.5077 10.25Z",fill:"currentColor"},null,-1),_hoisted_3$20=createBaseVNode("path",{d:"M5.08299 17.9328L5.22219 18.0199C6.28806 18.7527 7.65967 18.7912 8.75772 18.1356L8.93809 18.0199C9.52914 17.6135 10.2863 17.5845 10.9011 17.9328L11.0403 18.0199C12.1062 18.7527 13.4778 18.7912 14.5759 18.1356L14.7562 18.0199C15.3473 17.6135 16.1045 17.5845 16.7193 17.9328L16.8585 18.0199C17.0638 18.161 17.2824 18.2777 17.5107 18.3686C17.8854 18.5177 18.3064 18.3253 18.451 17.9389C18.5956 17.5525 18.4091 17.1183 18.0344 16.9692C17.9483 16.9349 17.8647 16.8942 17.784 16.8471L17.6653 16.7718C16.5994 16.039 15.2278 16.0004 14.1298 16.6561L13.9494 16.7718C13.3584 17.1781 12.6011 17.2072 11.9864 16.8589L11.8472 16.7718C10.7813 16.039 9.40969 16.0004 8.31164 16.6561L8.13126 16.7718C7.54022 17.1781 6.78301 17.2072 6.16823 16.8589L6.02902 16.7718C4.96316 16.039 3.59155 16.0004 2.4935 16.6561L2.31312 16.7718C2.23868 16.823 2.16125 16.8684 2.08133 16.908L1.95963 16.9629C1.5862 17.1154 1.40339 17.5513 1.55131 17.9364C1.69922 18.3215 2.12186 18.51 2.49529 18.3575C2.64087 18.298 2.78242 18.228 2.91898 18.1478L3.11995 18.0199C3.711 17.6135 4.46821 17.5845 5.08299 17.9328Z",fill:"#FF0000"},null,-1),_hoisted_4$R=[_hoisted_2$2d,_hoisted_3$20];function _sfc_render$1w(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2q,_hoisted_4$R)}const __unplugin_components_5$5=_export_sfc(_sfc_main$2P,[["render",_sfc_render$1w]]),_sfc_main$2O={},_hoisted_1$2p={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2c=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.3494 15.3928H13.2139V16.3928H17.4996V15.3928H15.9649L10.6964 2.22146H9.30364L4.03508 15.3929H2.5V16.3929H6.78571V15.3929H5.65062L10 4.519L14.3494 15.3928Z",fill:"currentColor"},null,-1),_hoisted_3$1$=createBaseVNode("rect",{y:"10.5",width:"20",height:"1.5",fill:"#FF0000"},null,-1),_hoisted_4$Q=[_hoisted_2$2c,_hoisted_3$1$];function _sfc_render$1v(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2p,_hoisted_4$Q)}const __unplugin_components_4$a=_export_sfc(_sfc_main$2O,[["render",_sfc_render$1v]]),_sfc_main$2N={},_hoisted_1$2o={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2b=createBaseVNode("rect",{y:"17",width:"20",height:"1.5",fill:"#FF0000"},null,-1),_hoisted_3$1_=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13 14H13.9922L12.8923 11.25H7.10772L6.00776 14H7V15H3V14H4.39223L9.30364 1.72146H10.6964L15.6078 14H17V15H13V14ZM7.5077 10.25H12.4923L10 4.019L7.5077 10.25Z",fill:"currentColor"},null,-1),_hoisted_4$P=[_hoisted_2$2b,_hoisted_3$1_];function _sfc_render$1u(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2o,_hoisted_4$P)}const __unplugin_components_3$a=_export_sfc(_sfc_main$2N,[["render",_sfc_render$1u]]),_sfc_main$2M={},_hoisted_1$2n={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2a=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2 2H20L18 18H0L2 2Z",fill:"#FEF87C"},null,-1),_hoisted_3$1Z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6078 15.5L10.6964 3.22145H9.30364L4.39223 15.5H3V16.5H7V15.5H6.00776L7.10772 12.75H12.8923L13.9922 15.5H13V16.5H17V15.5H15.6078ZM12.4923 11.75L10 5.51899L7.5077 11.75H12.4923Z",fill:"currentColor"},null,-1),_hoisted_4$O=[_hoisted_2$2a,_hoisted_3$1Z];function _sfc_render$1t(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2n,_hoisted_4$O)}const __unplugin_components_1$7=_export_sfc(_sfc_main$2M,[["render",_sfc_render$1t]]),CToolButton_vue_vue_type_style_index_0_scoped_3cda2a3c_lang="",_hoisted_1$2m=["title"],_sfc_main$2L={__name:"CToolButton",props:["item"],setup(e){const n=useViewerStore(),o=useDocumentStore(),{item:r}=e,{type:u,title:s,disabled:w,className:m,toolName:v}=r,g=computed(()=>Array.isArray(m)?m:[m]),d=["highlight","underline","squiggly","strikeout"],f=["square","circle","arrow","line"],y=["ink","freetext","stamp","image","link"],x=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton"];computed(()=>{if(d.includes(v))return"markup";if(f.includes(v))return"shape";if(y.includes(v))return"annotation";if(x.includes(v))return"form"});const k=computed(()=>o.getActiveTool),P=computed(()=>v===k.value),S=D=>{if(o.setToolState(D),n.toggleActiveHand(!1),core.switchTool(0),core.switchAnnotationEditorMode(0),D==="stamp"?n.toggleElement("stampPanel"):n.closeElement("stampPanel"),k.value==="image"){const N=isMobileDevice?"annotaionImageInput":"signImageInput";document.getElementById(N).click()}},E=D=>{o.setMarkupToolState(D),S(D)},M=D=>{o.setShapeToolState(D),S(D)},T=()=>{d.includes(v)&&E(v),f.includes(v)&&M(v),y.includes(v)&&S(v),x.includes(v)&&S(v)};return(D,N)=>{const I=__unplugin_components_1$7,O=__unplugin_components_3$a,F=__unplugin_components_4$a,q=__unplugin_components_5$5,Y=__unplugin_components_6$5,_e=__unplugin_components_7$3,ne=__unplugin_components_9$5,ve=__unplugin_components_13,J=__unplugin_components_14$3,fe=__unplugin_components_15,Z=__unplugin_components_17,j=__unplugin_components_18,X=__unplugin_components_19,H=__unplugin_components_0$n,U=__unplugin_components_0$o,te=__unplugin_components_0$p,Q=__unplugin_components_0$q,re=__unplugin_components_0$r,Pe=__unplugin_components_0$s;return openBlock(),createElementBlock("div",{class:normalizeClass(["button custom-button",[P.value&&"active",unref(u)&&unref(u),...g.value,x.includes(unref(v))&&"with-text"]]),onClick:N[0]||(N[0]=be=>T()),title:unref(s)},[unref(v)==="highlight"?(openBlock(),createBlock(I,{key:0})):createCommentVNode("",!0),unref(v)==="underline"?(openBlock(),createBlock(O,{key:1})):createCommentVNode("",!0),unref(v)==="strikeout"?(openBlock(),createBlock(F,{key:2})):createCommentVNode("",!0),unref(v)==="squiggly"?(openBlock(),createBlock(q,{key:3})):createCommentVNode("",!0),unref(v)==="ink"?(openBlock(),createBlock(Y,{key:4})):createCommentVNode("",!0),unref(v)==="circle"?(openBlock(),createBlock(_e,{key:5})):createCommentVNode("",!0),unref(v)==="square"?(openBlock(),createBlock(ne,{key:6})):createCommentVNode("",!0),unref(v)==="arrow"?(openBlock(),createBlock(ve,{key:7})):createCommentVNode("",!0),unref(v)==="line"?(openBlock(),createBlock(J,{key:8})):createCommentVNode("",!0),unref(v)==="freetext"?(openBlock(),createBlock(fe,{key:9})):createCommentVNode("",!0),unref(v)==="stamp"?(openBlock(),createBlock(Z,{key:10})):createCommentVNode("",!0),unref(v)==="image"?(openBlock(),createBlock(j,{key:11})):createCommentVNode("",!0),unref(v)==="link"?(openBlock(),createBlock(X,{key:12})):createCommentVNode("",!0),unref(v)==="textfield"?(openBlock(),createElementBlock(Fragment,{key:13},[createVNode(H),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.textField")),1)],64)):createCommentVNode("",!0),unref(v)==="checkbox"?(openBlock(),createElementBlock(Fragment,{key:14},[createVNode(U),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.checkbox")),1)],64)):createCommentVNode("",!0),unref(v)==="radiobutton"?(openBlock(),createElementBlock(Fragment,{key:15},[createVNode(te),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.radioButton")),1)],64)):createCommentVNode("",!0),unref(v)==="listbox"?(openBlock(),createElementBlock(Fragment,{key:16},[createVNode(Q),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.listBox")),1)],64)):createCommentVNode("",!0),unref(v)==="combobox"?(openBlock(),createElementBlock(Fragment,{key:17},[createVNode(re),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.comboButton")),1)],64)):createCommentVNode("",!0),unref(v)==="pushbutton"?(openBlock(),createElementBlock(Fragment,{key:18},[createVNode(Pe),createBaseVNode("span",null,toDisplayString(D.$t("toolbar.formTools.button")),1)],64)):createCommentVNode("",!0)],10,_hoisted_1$2m)}}},__unplugin_components_3$9=_export_sfc(_sfc_main$2L,[["__scopeId","data-v-3cda2a3c"]]),_hoisted_1$2l=["data-element","disabled","title"],_hoisted_2$29=["innerHTML"],_hoisted_3$1Y=["src"],_sfc_main$2K={__name:"ToggleButton",props:["item"],setup(e){const n=useViewerStore(),{item:o}=e,{type:r,img:u,dataElement:s,title:w,disabled:m,className:v,element:g}=o,d=computed(()=>Array.isArray(v)?v:[v]),f=u==null?void 0:u.trim().toLowerCase().startsWith("<svg"),y=P=>{P==null||P.stopPropagation(),P==null||P.preventDefault()},x=computed(()=>n.isElementOpen(g)),k=()=>{n.toggleElement(g)};return(P,S)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["button custom-button",[x.value&&"active",unref(r)&&unref(r),unref(m)&&unref(m),...d.value]]),"data-element":unref(s),onClick:S[0]||(S[0]=E=>unref(m)||!k?y():k()),disabled:unref(m),title:unref(w)},[unref(u)?(openBlock(),createElementBlock(Fragment,{key:0},[unref(f)?(openBlock(),createElementBlock("div",{key:0,innerHTML:unref(u),class:"img"},null,8,_hoisted_2$29)):(openBlock(),createElementBlock("img",{key:1,src:unref(u),alt:"",class:"img"},null,8,_hoisted_3$1Y))],64)):createCommentVNode("",!0)],10,_hoisted_1$2l))}},StatefulButton_vue_vue_type_style_index_0_lang="",_hoisted_1$2k=["data-element","disabled","title"],_hoisted_2$28=["innerHTML"],_hoisted_3$1X=["src"],_hoisted_4$N={key:1,class:"text"},_sfc_main$2J={__name:"StatefulButton",props:["item"],setup(e){const{item:n}=e,{type:o,dataElement:r,title:u,disabled:s,className:w,initialState:m,states:v,mount:g,unmount:d}=n,f=computed(()=>Array.isArray(w)?w:[w]),y=N=>{N==null||N.stopPropagation(),N==null||N.preventDefault()},x=ref(m),k=v[x.value],P=ref(!1),{img:S}=k,E=S==null?void 0:S.trim().toLowerCase().startsWith("<svg"),M=()=>{T(),k.onClick(k)},T=()=>{x.value=m},D=computed(()=>k.getContent instanceof Function?k.getContent(k):k.getContent);return g&&onMounted(()=>{g()}),d&&onUnmounted(()=>{d()}),(N,I)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["button custom-button",[P.value&&"active",unref(o)&&unref(o),unref(s)&&unref(s),...f.value]]),"data-element":unref(r),onClick:I[0]||(I[0]=O=>unref(s)||!M?y():M()),onDblclick:I[1]||(I[1]=O=>unref(s)?y:N.onDoubleClick),onMouseup:I[2]||(I[2]=O=>unref(s)?y:N.onDoubleClick),disabled:unref(s),title:unref(u)},[unref(S)?(openBlock(),createElementBlock(Fragment,{key:0},[unref(E)?(openBlock(),createElementBlock("div",{key:0,innerHTML:unref(S),class:"img"},null,8,_hoisted_2$28)):(openBlock(),createElementBlock("img",{key:1,src:unref(S),alt:"",class:"img"},null,8,_hoisted_3$1X))],64)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(D.value)+" ",1),e.item.dropItem?(openBlock(),createElementBlock("span",_hoisted_4$N,toDisplayString(e.item.text),1)):createCommentVNode("",!0)],42,_hoisted_1$2k))}},_hoisted_1$2j=["data-element","disabled","title"],_hoisted_2$27=["innerHTML"],_hoisted_3$1W=["src"],_hoisted_4$M={key:1},_hoisted_5$x={key:2,class:"text"},_sfc_main$2I={__name:"ActionButton",props:["item"],setup(e){const{item:n}=e,{type:o,img:r,text:u,dataElement:s,onClick:w,title:m,disabled:v,className:g}=n,d=computed(()=>Array.isArray(g)?g:[g]),f=r==null?void 0:r.trim().toLowerCase().startsWith("<svg"),y=x=>{x==null||x.stopPropagation(),x==null||x.preventDefault()};return(x,k)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["button custom-button",[unref(o)&&unref(o),unref(v)&&unref(v),...d.value]]),"data-element":unref(s),onClick:k[0]||(k[0]=P=>unref(v)||!unref(w)?y():unref(w)(P)),onDblclick:k[1]||(k[1]=P=>unref(v)?y:x.onDoubleClick),onMouseup:k[2]||(k[2]=P=>unref(v)?y:x.onDoubleClick),disabled:unref(v),title:unref(m)},[unref(r)?(openBlock(),createElementBlock(Fragment,{key:0},[unref(f)?(openBlock(),createElementBlock("div",{key:0,innerHTML:unref(r),class:"img"},null,8,_hoisted_2$27)):(openBlock(),createElementBlock("img",{key:1,src:unref(r),alt:"",class:"img"},null,8,_hoisted_3$1W))],64)):unref(u)?(openBlock(),createElementBlock("div",_hoisted_4$M,toDisplayString(unref(u)),1)):createCommentVNode("",!0),e.item.dropItem?(openBlock(),createElementBlock("span",_hoisted_5$x,toDisplayString(e.item.text),1)):createCommentVNode("",!0)],42,_hoisted_1$2j))}},CustomButton_vue_vue_type_style_index_0_lang="",_sfc_main$2H={__name:"CustomButton",props:["item"],setup(e){const{item:n}=e,{type:o}=n;return(r,u)=>{const s=_sfc_main$2I,w=_sfc_main$2J,m=_sfc_main$2K,v=__unplugin_components_3$9;return unref(o)==="actionButton"?(openBlock(),createBlock(s,{key:0,item:e.item},null,8,["item"])):unref(o)==="statefulButton"?(openBlock(),createBlock(w,{key:1,item:e.item},null,8,["item"])):unref(o)==="toggleButton"?(openBlock(),createBlock(m,{key:2,item:e.item},null,8,["item"])):unref(o)==="toolButton"?(openBlock(),createBlock(v,{key:3,item:e.item},null,8,["item"])):createCommentVNode("",!0)}}},MeasurementPopup_vue_vue_type_style_index_0_scoped_7867bd2b_lang="",_sfc_main$2G={__name:"MeasurementPopup",setup(e){const n=useDocumentStore(),o=useViewerStore(),r=computed(()=>n.getAnnotator),u=computed(()=>o.getPopupItems("measurementPopup")),s=computed(()=>o.isElementOpen("measurePanel")),w=computed(()=>o.isElementOpen("measurementSettingsDialog")),m=computed(()=>o.getIsAnnotationPopup),v=computed(()=>o.getUserAdmin),g=computed(()=>o.getReadOnly),d=ref(!1),f=ref(0),y=ref(0),x=ref(null);let k,P=!1,S,E=null;const M=ref(!v.value&&(g.value||E&&r!==E.author)),T=q=>{q==="reply"&&!o.isElementOpen("leftPanel")&&(d.value=!1),core.handlePopup({type:"measurement",tool:q})};watch([v,g],()=>{M.value=!v.value&&(g.value||E&&r!==E.author)});const D=async(q={})=>{const{rect:Y}=q;if(d.value=!!Y,await nextTick(),Y&&d.value){const _e=x.value.children[0];if(!_e)return;const ne=_e.offsetWidth,ve=_e.offsetHeight+10;let J=Y.right-ne,fe=Y.bottom;const Z=window.innerWidth,j=window.innerHeight;J>Z-ne&&(J=Z-ne),J=Math.max(0,J),fe+ve>j&&(fe=Math.max(0,Y.top-ve)),f.value=fe,y.value=s.value?J+130:J}};core.addEvent("showMeasurementPopup",D);const N=()=>{d.value&&(d.value=!1,P=!0),P&&(clearTimeout(S),S=setTimeout(()=>{core.showPopup({type:"measurementPopup",pageIndex:E.pageIndex,annotation:E}),P=!1},200))},I=()=>{o.toggleElement("measurePanel")},O=()=>{o.openElement("measurementSettingsDialog")};onMounted(()=>{k=document.querySelector(".document-container"),k&&k.addEventListener("scroll",N)}),onUnmounted(()=>{k&&k.removeEventListener("scroll",N)});const F=q=>{if(!q.measure){d.value=!1;return}d.value=!0,E=q,M.value=!v.value&&(g.value||E&&r.value!==E.author)};return core.addEvent("annotationSelected",F),(q,Y)=>{const _e=_sfc_main$2H,ne=__unplugin_components_1$8,ve=_sfc_main$4C,J=__unplugin_components_21,fe=__unplugin_components_4$b,Z=__unplugin_components_8$3;return openBlock(),createElementBlock("div",{ref_key:"measurementPopupRef",ref:x},[withDirectives(createBaseVNode("div",{class:normalizeClass(["measurement-popup popup","no-edit"]),style:normalizeStyle({top:`${f.value}px`,left:`${y.value}px`,transform:`translateX(${!unref(isMobileDevice)&&s.value?-130:0}px) translateY(5px)`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(u.value,(j,X)=>(openBlock(),createElementBlock(Fragment,{key:`${j.dataElement||new Date}-${X}`},[j.name==="customButton"&&!j.hidden?(openBlock(),createBlock(_e,{key:0,item:j,"data-element":j.dataElement},null,8,["item","data-element"])):j.type==="reply"&&!j.hidden?(openBlock(),createBlock(ve,{key:1,onClick:Y[0]||(Y[0]=H=>T("reply")),title:q.$t("common.actions.reply"),"data-element":j.dataElement},{default:withCtx(()=>[createVNode(ne)]),_:2},1032,["title","data-element"])):j.type==="property"&&!j.hidden&&!M.value?(openBlock(),createBlock(ve,{key:2,onClick:I,title:q.$t("common.properties"),"data-element":j.dataElement,isActive:s.value},{default:withCtx(()=>[createVNode(J)]),_:2},1032,["title","data-element","isActive"])):j.type==="settings"&&!j.hidden&&!M.value?(openBlock(),createBlock(ve,{key:3,onClick:O,title:q.$t("toolbar.settings.title"),"data-element":j.dataElement,isActive:w.value},{default:withCtx(()=>[createVNode(fe)]),_:2},1032,["title","data-element","isActive"])):j.type==="delete"&&!j.hidden&&!M.value?(openBlock(),createBlock(ve,{key:4,onClick:Y[1]||(Y[1]=H=>T("delete")),title:q.$t("common.actions.delete"),"data-element":j.dataElement},{default:withCtx(()=>[createVNode(Z)]),_:2},1032,["title","data-element"])):["spacer","divider"].includes(j.type)?(openBlock(),createElementBlock("div",{key:5,class:normalizeClass(j.type)},null,2)):createCommentVNode("",!0)],64))),128))],4),[[vShow,d.value&&u.value.length&&m.value]])],512)}}},__unplugin_components_22=_export_sfc(_sfc_main$2G,[["__scopeId","data-v-7867bd2b"]]),_sfc_main$2F={},_hoisted_1$2i={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$26=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.9596 4.80005L13.2 5.88792L8 11.2L2.8 5.88792L4.0404 4.80005L8 8.84446L11.9596 4.80005Z",fill:"currentColor"},null,-1),_hoisted_3$1V=[_hoisted_2$26];function _sfc_render$1s(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2i,_hoisted_3$1V)}const __unplugin_components_0$m=_export_sfc(_sfc_main$2F,[["render",_sfc_render$1s]]),MeasurementSettingsDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$2h={class:"measurements-settings"},_hoisted_2$25={class:"subtitle"},_hoisted_3$1U={class:"scale"},_hoisted_4$L={class:"left-text"},_hoisted_5$w={class:"right-text"},_hoisted_6$o={class:"form-box"},_hoisted_7$g={class:"form-box"},_hoisted_8$d={value:"pt"},_hoisted_9$d={value:"in"},_hoisted_10$c={value:"mm"},_hoisted_11$9={value:"cm"},_hoisted_12$8={value:"m"},_hoisted_13$8={value:"km"},_hoisted_14$8={value:"ft"},_hoisted_15$8={value:"yd"},_hoisted_16$7={value:"mi"},_hoisted_17$6=createBaseVNode("span",null,"=",-1),_hoisted_18$5={class:"form-box"},_hoisted_19$5={class:"form-box"},_hoisted_20$5={value:"pt"},_hoisted_21$5={value:"in"},_hoisted_22$5={value:"mm"},_hoisted_23$3={value:"cm"},_hoisted_24$3={value:"m"},_hoisted_25$3={value:"km"},_hoisted_26$3={value:"ft"},_hoisted_27$3={value:"yd"},_hoisted_28$3={value:"mi"},_hoisted_29$3={key:0,class:"error"},_hoisted_30$3={class:"discription"},_hoisted_31$3={class:"form-box"},_hoisted_32$2=createBaseVNode("option",{value:1},"1",-1),_hoisted_33$1=createBaseVNode("option",{value:.1},"0.1",-1),_hoisted_34$1=createBaseVNode("option",{value:.01},"0.01",-1),_hoisted_35$1=createBaseVNode("option",{value:.001},"0.001",-1),_hoisted_36=createBaseVNode("option",{value:1e-4},"0.0001",-1),_hoisted_37=[_hoisted_32$2,_hoisted_33$1,_hoisted_34$1,_hoisted_35$1,_hoisted_36],_hoisted_38={key:0,class:"caption"},_hoisted_39={class:"subtitle"},_hoisted_40={class:"check-content"},_hoisted_41=["onClick"],dialogName$b="measurementSettingsDialog",_sfc_main$2E={__name:"MeasurementSettingsDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$b)),u=computed(()=>o.getActiveTool),s=reactive({scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1}),w=reactive({showRadius:!0,showPerimeter:!0,showArea:!0,showArcLength:!0,showAngle:!0}),m={polygon:["showPerimeter","showArea"],rectangle:["showPerimeter","showArea"],circle:["showPerimeter","showArea","showRadius"],arc:["showRadius","showArcLength","showAngle"]},v=[{key:"showRadius",types:["circle","arc"],label:"measurement.dimensions.radius"},{key:"showPerimeter",types:["circle","polygon","rectangle"],label:"measurement.dimensions.perimeter"},{key:"showArea",types:["circle","polygon","rectangle"],label:"measurement.dimensions.area"},{key:"showArcLength",types:["arc"],label:"measurement.dimensions.arcLength"},{key:"showAngle",types:["arc"],label:"measurement.dimensions.angle"}];let g={scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1},d={showPerimeter:!0,showArea:!0,showRadius:!0,showArcLength:!0,showAngle:!0};const f=ref(!1),y=ref("");let x="";const k=ref(!1);watch(r,(D,N)=>{D&&(k.value=!1,g||d?M({...g,...d}):(s.scale={base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},s.precision=1,w.showPerimeter=!0,w.showArea=!0,w.showRadius=!0,w.showArcLength=!0,w.showAngle=!0),f.value=!1,y.value=x||u.value)}),watch([s,w],D=>{if(D[0].scale.base===g.scale.base&&D[0].scale.baseUnit===g.scale.baseUnit&&D[0].scale.translate===g.scale.translate&&D[0].scale.translateUnit===g.scale.translateUnit&&D[0].precision===g.precision&&D[1].showPerimeter===d.showPerimeter&&D[1].showArea===d.showArea&&D[1].showRadius===d.showRadius&&D[1].showArcLength===d.showArcLength&&D[1].showAngle===d.showAngle){k.value=!1;return}k.value=!0});const P=()=>{n.closeElement(dialogName$b)},S=()=>{s.scale.base.toString().length>6&&(s.scale.base=s.scale.base.toString().slice(0,6)),s.scale.translate.toString().length>6&&(s.scale.translate=s.scale.translate.toString().slice(0,6)),f.value=s.scale.base<=0||s.scale.translate<=0},E=()=>{const N=(m[y.value]||[]).reduce((I,O)=>({...I,[O]:w[O]}),{});JSON.stringify(g)===JSON.stringify(s)?core.setMeasurementDefaults({...N}):core.setMeasurementDefaults({...JSON.parse(JSON.stringify(s)),...N}),P()},M=D=>{Object.entries(D).forEach(([N,I])=>{if(N==="scale"){Object.assign(s.scale,I);return}N in s&&(s[N]=I),N in w&&(w[N]=I)}),g=JSON.parse(JSON.stringify(s)),d=JSON.parse(JSON.stringify(w))};core.addEvent("updateMeasureData",M);const T=D=>{if(x="",!!D.hasOwnProperty("type")){if(D.type==="ink"&&D.arcPoints){x="arc";return}x=D.type}};return core.addEvent("measurePropertyChange",T),(D,N)=>{const I=__unplugin_components_0$m,O=__unplugin_components_1$g,F=_sfc_main$4v;return withDirectives((openBlock(),createElementBlock("div",_hoisted_1$2h,[createVNode(F,{show:r.value,dialogName:dialogName$b},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(D.$t("measurement.settings")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:P},toDisplayString(D.$t("common.actions.cancel")),1),createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:f.value||!k.value}]),onClick:E},toDisplayString(D.$t("measurement.done")),3)]),default:withCtx(()=>[createBaseVNode("p",_hoisted_2$25,toDisplayString(D.$t("measurement.scale")),1),createBaseVNode("div",_hoisted_3$1U,[createBaseVNode("span",_hoisted_4$L,toDisplayString(D.$t("measurement.drawingDimensions")),1),createBaseVNode("span",_hoisted_5$w,toDisplayString(D.$t("measurement.actualSize")),1),createBaseVNode("div",_hoisted_6$o,[withDirectives(createBaseVNode("input",{type:"number",min:"1",max:"999999","onUpdate:modelValue":N[0]||(N[0]=q=>s.scale.base=q),onInput:S},null,544),[[vModelText,s.scale.base]])]),createBaseVNode("div",_hoisted_7$g,[withDirectives(createBaseVNode("select",{class:"unit-input","onUpdate:modelValue":N[1]||(N[1]=q=>s.scale.baseUnit=q)},[createBaseVNode("option",_hoisted_8$d,toDisplayString(D.$t("measurement.units.pt")),1),createBaseVNode("option",_hoisted_9$d,toDisplayString(D.$t("measurement.units.in")),1),createBaseVNode("option",_hoisted_10$c,toDisplayString(D.$t("measurement.units.mm")),1),createBaseVNode("option",_hoisted_11$9,toDisplayString(D.$t("measurement.units.cm")),1),createBaseVNode("option",_hoisted_12$8,toDisplayString(D.$t("measurement.units.m")),1),createBaseVNode("option",_hoisted_13$8,toDisplayString(D.$t("measurement.units.km")),1),createBaseVNode("option",_hoisted_14$8,toDisplayString(D.$t("measurement.units.ft")),1),createBaseVNode("option",_hoisted_15$8,toDisplayString(D.$t("measurement.units.yd")),1),createBaseVNode("option",_hoisted_16$7,toDisplayString(D.$t("measurement.units.mi")),1)],512),[[vModelSelect,s.scale.baseUnit]]),createVNode(I)]),_hoisted_17$6,createBaseVNode("div",_hoisted_18$5,[withDirectives(createBaseVNode("input",{type:"number",min:"1",max:"999999","onUpdate:modelValue":N[2]||(N[2]=q=>s.scale.translate=q),onInput:S},null,544),[[vModelText,s.scale.translate]])]),createBaseVNode("div",_hoisted_19$5,[withDirectives(createBaseVNode("select",{class:"unit-input","onUpdate:modelValue":N[3]||(N[3]=q=>s.scale.translateUnit=q)},[createBaseVNode("option",_hoisted_20$5,toDisplayString(D.$t("measurement.units.pt")),1),createBaseVNode("option",_hoisted_21$5,toDisplayString(D.$t("measurement.units.in")),1),createBaseVNode("option",_hoisted_22$5,toDisplayString(D.$t("measurement.units.mm")),1),createBaseVNode("option",_hoisted_23$3,toDisplayString(D.$t("measurement.units.cm")),1),createBaseVNode("option",_hoisted_24$3,toDisplayString(D.$t("measurement.units.m")),1),createBaseVNode("option",_hoisted_25$3,toDisplayString(D.$t("measurement.units.km")),1),createBaseVNode("option",_hoisted_26$3,toDisplayString(D.$t("measurement.units.ft")),1),createBaseVNode("option",_hoisted_27$3,toDisplayString(D.$t("measurement.units.yd")),1),createBaseVNode("option",_hoisted_28$3,toDisplayString(D.$t("measurement.units.mi")),1)],512),[[vModelSelect,s.scale.translateUnit]]),createVNode(I)]),f.value?(openBlock(),createElementBlock("p",_hoisted_29$3,toDisplayString(D.$t("measurement.scaleError")),1)):createCommentVNode("",!0)]),createBaseVNode("p",_hoisted_30$3,toDisplayString(D.$t("measurement.precision")),1),createBaseVNode("div",_hoisted_31$3,[withDirectives(createBaseVNode("select",{"onUpdate:modelValue":N[4]||(N[4]=q=>s.precision=q)},_hoisted_37,512),[[vModelSelect,s.precision]]),createVNode(I)]),["polygon","rectangle","circle","arc"].includes(y.value)?(openBlock(),createElementBlock("div",_hoisted_38,[createBaseVNode("p",_hoisted_39,toDisplayString(D.$t("measurement.showCaption")),1),createBaseVNode("div",_hoisted_40,[(openBlock(),createElementBlock(Fragment,null,renderList(v,q=>(openBlock(),createElementBlock(Fragment,{key:q.key},[q.types.includes(y.value)?(openBlock(),createElementBlock("div",{key:0,class:"check-box",onClick:Y=>w[q.key]=!w[q.key]},[createBaseVNode("div",{class:normalizeClass(["check",{active:w[q.key]}])},[withDirectives(createVNode(O,null,null,512),[[vShow,w[q.key]]])],2),createBaseVNode("span",null,toDisplayString(D.$t(q.label)),1)],8,_hoisted_41)):createCommentVNode("",!0)],64))),64))])])):createCommentVNode("",!0)]),_:1},8,["show"])],512)),[[vShow,r.value]])}}},_sfc_main$2D={},_hoisted_1$2g={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$24=createBaseVNode("circle",{cx:"8",cy:"7.99976",r:"7",fill:"currentColor"},null,-1),_hoisted_3$1T=createBaseVNode("path",{d:"M7.40967 10.8826H8.47852V11.9998H7.40967V10.8826ZM5.59961 6.58032C5.59961 5.80688 5.81803 5.18563 6.25488 4.71655C6.69173 4.2439 7.2915 4.00757 8.0542 4.00757C8.7596 4.00757 9.32357 4.20988 9.74609 4.6145C10.1722 5.01554 10.3853 5.52938 10.3853 6.15601C10.3853 6.53556 10.3065 6.84351 10.1489 7.07983C9.99495 7.31616 9.68164 7.66349 9.20898 8.12183C8.86523 8.45483 8.64144 8.73771 8.5376 8.97046C8.43734 9.19963 8.38721 9.53979 8.38721 9.99097H7.43115C7.43115 9.47892 7.49202 9.06714 7.61377 8.75562C7.73551 8.44051 8.00228 8.08065 8.41406 7.67603L8.84375 7.25171C8.97266 7.12996 9.0765 7.00285 9.15527 6.87036C9.2985 6.63761 9.37012 6.39591 9.37012 6.14526C9.37012 5.79435 9.26449 5.48999 9.05322 5.23218C8.84554 4.97437 8.5 4.84546 8.0166 4.84546C7.41862 4.84546 7.00505 5.06746 6.77588 5.51147C6.64697 5.75854 6.57357 6.11483 6.55566 6.58032H5.59961Z",fill:"white"},null,-1),_hoisted_4$K=[_hoisted_2$24,_hoisted_3$1T];function _sfc_render$1r(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2g,_hoisted_4$K)}const __unplugin_components_9$2=_export_sfc(_sfc_main$2D,[["render",_sfc_render$1r]]),_sfc_main$2C={},_hoisted_1$2f={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$23=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.96069 10.2896L2.96069 16.2896L2.96069 17.0396L3.71069 17.0396L9.71069 17.0396L9.71069 15.5396L5.52124 15.5396L9.71582 11.345L8.65516 10.2843L4.46069 14.4788L4.46069 10.2896L2.96069 10.2896Z",fill:"currentColor"},null,-1),_hoisted_3$1S=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.0393 9.71045L17.0393 3.71045L17.0393 2.96045L16.2893 2.96045L10.2893 2.96045L10.2893 4.46045L14.4788 4.46045L10.2842 8.65503L11.3448 9.71569L15.5393 5.52122L15.5393 9.71045L17.0393 9.71045Z",fill:"currentColor"},null,-1),_hoisted_4$J=[_hoisted_2$23,_hoisted_3$1S];function _sfc_render$1q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2f,_hoisted_4$J)}const __unplugin_components_1$6=_export_sfc(_sfc_main$2C,[["render",_sfc_render$1q]]),_sfc_main$2B={},_hoisted_1$2e={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$22=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.1853 17.5647L9.1853 11.5647L9.1853 10.8147L8.4353 10.8147L2.4353 10.8147L2.4353 12.3147L6.62476 12.3147L2.43018 16.5093L3.49084 17.5699L7.6853 13.3755L7.6853 17.5647L9.1853 17.5647Z",fill:"currentColor"},null,-1),_hoisted_3$1R=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.8147 2.4353L10.8147 8.4353L10.8147 9.1853L11.5647 9.1853L17.5647 9.1853L17.5647 7.6853L13.3752 7.6853L17.5698 3.49072L16.5092 2.43006L12.3147 6.62453L12.3147 2.4353L10.8147 2.4353Z",fill:"currentColor"},null,-1),_hoisted_4$I=[_hoisted_2$22,_hoisted_3$1R];function _sfc_render$1p(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2e,_hoisted_4$I)}const __unplugin_components_0$l=_export_sfc(_sfc_main$2B,[["render",_sfc_render$1p]]),_sfc_main$2A={},_hoisted_1$2d={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$21=createBaseVNode("path",{d:"M2.5 11.9037C3.09643 7.58461 4.96299 -0.313125 7.65776 2.64854C11.0262 6.35062 10.8157 17.4568 13.342 17.9857C15.3631 18.4088 17.6228 9.34754 18.5 4.76404",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$1Q=[_hoisted_2$21];function _sfc_render$1o(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2d,_hoisted_3$1Q)}const __unplugin_components_3$8=_export_sfc(_sfc_main$2A,[["render",_sfc_render$1o]]),_sfc_main$2z={},_hoisted_1$2c={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$20=createBaseVNode("path",{d:"M2.63672 18C2.63672 15.9828 3.03403 13.9854 3.80595 12.1218C4.57788 10.2582 5.70932 8.56494 7.13565 7.1386C8.56199 5.71227 10.2553 4.58083 12.1189 3.80891C13.9825 3.03698 15.9799 2.63968 17.997 2.63968",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$1P=createBaseVNode("path",{d:"M17.9966 2V18H2.00293",stroke:"currentColor","stroke-width":"1.5","stroke-dasharray":"3.6 1.8"},null,-1),_hoisted_4$H=createBaseVNode("path",{d:"M16.7554 4.56842L18.6333 2.63967L16.7298 0.736165",stroke:"currentColor","stroke-width":"1.4"},null,-1),_hoisted_5$v=createBaseVNode("path",{d:"M0.708008 16.838L2.63675 18.7159L4.54026 16.8124",stroke:"currentColor","stroke-width":"1.4"},null,-1),_hoisted_6$n=[_hoisted_2$20,_hoisted_3$1P,_hoisted_4$H,_hoisted_5$v];function _sfc_render$1n(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2c,_hoisted_6$n)}const __unplugin_components_4$9=_export_sfc(_sfc_main$2z,[["render",_sfc_render$1n]]),_sfc_main$2y={},_hoisted_1$2b={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1$=createBaseVNode("circle",{cx:"10.5",cy:"10",r:"8.25",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$1O=createBaseVNode("path",{d:"M17.0664 5.21002L3.37442 15.2833",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$G=createBaseVNode("path",{d:"M13.5967 2.37137L2.12094 11.0831",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_5$u=createBaseVNode("path",{d:"M18.9043 9.01334L7.85905 17.3793",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_6$m=[_hoisted_2$1$,_hoisted_3$1O,_hoisted_4$G,_hoisted_5$u];function _sfc_render$1m(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2b,_hoisted_6$m)}const __unplugin_components_5$4=_export_sfc(_sfc_main$2y,[["render",_sfc_render$1m]]),_sfc_main$2x={},_hoisted_1$2a={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1_=createBaseVNode("rect",{x:"2.25",y:"3.75",width:"16.5",height:"12.5",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$1N=createBaseVNode("path",{d:"M18.2759 4.31778L2.203 16.3053",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$F=createBaseVNode("path",{d:"M12.2065 3.56934L2.14012 11.148",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_5$t=createBaseVNode("path",{d:"M18.8979 9.27121L9.43893 16.3618",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_6$l=[_hoisted_2$1_,_hoisted_3$1N,_hoisted_4$F,_hoisted_5$t];function _sfc_render$1l(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$2a,_hoisted_6$l)}const __unplugin_components_6$4=_export_sfc(_sfc_main$2x,[["render",_sfc_render$1l]]),_sfc_main$2w={},_hoisted_1$29={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1Z=createBaseVNode("path",{d:"M14.2041 4.48883L3.08548 11.1043",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$1M=createBaseVNode("path",{d:"M16.9145 8.71439L5.51183 15.5114",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$E=createBaseVNode("path",{d:"M2.95577 5.93301L10 1.86603L17.0442 5.93301V14.067L10 18.134L2.95577 14.067V5.93301Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_5$s=[_hoisted_2$1Z,_hoisted_3$1M,_hoisted_4$E];function _sfc_render$1k(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$29,_hoisted_5$s)}const __unplugin_components_7$2=_export_sfc(_sfc_main$2w,[["render",_sfc_render$1k]]),_sfc_main$2v={},_hoisted_1$28={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1Y=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1 3C1 1.89543 1.89543 1 3 1C3.83934 1 4.55793 1.51704 4.85462 2.25H16.1454C16.4421 1.51704 17.1607 1 18 1C19.1046 1 20 1.89543 20 3C20 3.83934 19.483 4.55793 18.75 4.85462V17V17.75H18H14.2011L15.0167 18.5765L14.0138 19.5928L11.9986 17.5505L11.4972 17.0423L11.9986 16.5342L14.0138 14.4918L15.0167 15.5082L14.2847 16.25H17.25V4.85462C16.7487 4.65168 16.3483 4.25135 16.1454 3.75H4.85462C4.65168 4.25135 4.25135 4.65168 3.75 4.85462V16.25H6.75V15H8.25V19H6.75V17.75H3H2.25V17V4.85462C1.51704 4.55793 1 3.83934 1 3Z",fill:"currentColor"},null,-1),_hoisted_3$1L=[_hoisted_2$1Y];function _sfc_render$1j(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$28,_hoisted_3$1L)}const __unplugin_components_2$d=_export_sfc(_sfc_main$2v,[["render",_sfc_render$1j]]),_sfc_main$2u={},_hoisted_1$27={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1X=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.278 5.75735L14.7425 2.22181L13.505 3.45925L15.98 5.93421L14.9193 6.99487L12.4444 4.51991L10.6766 6.28768L13.1516 8.76264L12.0909 9.8233L9.61596 7.34834L7.84819 9.11611L10.3232 11.5911L9.26249 12.6517L6.78753 10.1768L5.01977 11.9445L7.49473 14.4195L6.43407 15.4802L3.95911 13.0052L2.72167 14.2426L6.2572 17.7782L18.278 5.75735ZM15.8031 1.16115L14.7425 0.100494L13.6818 1.16115L1.66101 13.182L0.600348 14.2426L1.66101 15.3033L5.19654 18.8388L6.2572 19.8995L7.31786 18.8388L19.3387 6.81801L20.3993 5.75735L19.3387 4.69669L15.8031 1.16115Z",fill:"currentColor"},null,-1),_hoisted_3$1K=[_hoisted_2$1X];function _sfc_render$1i(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$27,_hoisted_3$1K)}const __unplugin_components_0$k=_export_sfc(_sfc_main$2u,[["render",_sfc_render$1i]]),MeasurementBoard_vue_vue_type_style_index_0_lang="",_hoisted_1$26={class:"header-container"},_hoisted_2$1W={key:0,class:"title"},_hoisted_3$1J={key:1,class:"title"},_hoisted_4$D={key:2,class:"title"},_hoisted_5$r={key:3,class:"title"},_hoisted_6$k={key:4,class:"title"},_hoisted_7$f={key:5,class:"title"},_hoisted_8$c={key:6,class:"title"},_hoisted_9$c={class:"content"},_hoisted_10$b={class:"has-input"},_hoisted_11$8={class:"has-tip"},_hoisted_12$7={class:"has-input"},_hoisted_13$7={class:"has-tip"},_hoisted_14$7={class:"has-tip"},_hoisted_15$7={class:"has-tip"},_hoisted_16$6={class:"has-tip"},_hoisted_17$5={class:"has-input"},_hoisted_18$4={class:"has-tip"},_hoisted_19$4={class:"has-input"},_hoisted_20$4={class:"has-tip"},_hoisted_21$4={class:"has-input"},_hoisted_22$4={class:"setting"},_sfc_main$2t={__name:"MeasurementBoard",setup(e){const n=useViewerStore(),o=useDocumentStore(),u=getCurrentInstance().appContext.app.config.globalProperties.$t,s=computed(()=>n.getToolMode),w=computed(()=>o.getActiveTool),m=computed(()=>n.getReadOnly),v=computed(()=>{const fe=s.value==="measurement"&&f.includes(w.value);return!m.value&&(E.value||fe)}),g=computed(()=>{const fe=f.includes(w.value)?w.value:"";return M.value||fe});computed(()=>o.getMeasure),computed(()=>o.getPrecision);const d=computed(()=>n.isElementOpen("measurePanel")),f=["line","polyline","polygon","rectangle","circle","curve","arc"],y=reactive({scale:{base:1,baseUnit:"cm",translate:1,translateUnit:"cm"},precision:.1,length:0,angle:0,radius:0,perimeter:0,area:0,X:0,Y:0,arcLength:0,width:0}),x=ref(),k=ref(!1),P=reactive({right:30,y:100}),S=reactive({x:0,y:0}),E=ref(!1),M=ref(""),T=ref(!1),D=ref(0),N=computed(()=>`${y.scale.base} ${u("measurement.units."+y.scale.baseUnit)} = ${y.scale.translate} ${u("measurement.units."+y.scale.translateUnit)}`);watch(d,(fe,Z)=>{fe&&P.right<260?D.value=P.right-260-30:D.value=0}),watch([v,w],(fe,Z)=>{(fe[0]||fe[1])&&!E.value&&ve()});const I=fe=>{for(const Z in fe)for(const j in y)if(Z===j){if(Z==="scale"){Object.assign(y.scale,fe.scale);continue}y[j]=fe[Z]}};core.addEvent("updateMeasureData",I);const O=fe=>{if(E.value=!!fe.measure,!fe.measure){M.value="";return}fe.type==="ink"?M.value=fe.arcPoints?"arc":"curve":M.value=fe.type};core.addEvent("annotationSelected",O);const F=()=>{!E.value||(E.value=!1,M.value="",ve())};core.addEvent("annotationDeselected",F);const q=()=>{n.openElement("measurementSettingsDialog")},Y=fe=>{k.value=!0,S.x=window.innerWidth-fe.clientX-P.right,S.y=fe.clientY-P.y,document.addEventListener("mousemove",ne),document.addEventListener("mouseup",_e)},_e=()=>{k.value=!1,document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",_e)},ne=fe=>{if(k.value){const Z=x.value.offsetWidth,j=x.value.offsetHeight,X=window.innerWidth-fe.clientX-S.x,H=fe.clientY-S.y,U=window.innerWidth-Z,te=window.innerHeight-j;P.right=Math.min(Math.max(X,0),U),P.y=Math.min(Math.max(H,0),te)}},ve=()=>{y.length=0,y.angle=0,y.radius=0,y.perimeter=0,y.area=0,y.X=0,y.Y=0,y.arcLength=0,y.width=0},J=(fe,Z)=>{core.setPropertyPanel({[Z]:fe})};return(fe,Z)=>{const j=__unplugin_components_0$k,X=__unplugin_components_2$d,H=__unplugin_components_7$2,U=__unplugin_components_6$4,te=__unplugin_components_5$4,Q=__unplugin_components_4$9,re=__unplugin_components_3$8,Pe=__unplugin_components_0$l,be=__unplugin_components_1$6,we=__unplugin_components_9$2;return withDirectives((openBlock(),createElementBlock("div",{ref_key:"measurementBoard",ref:x,class:normalizeClass(["measurement-board",{fold:T.value}]),style:normalizeStyle({top:P.y+"px",right:P.right+"px",transform:`translateX(${D.value}px)`}),onMousedown:Y},[createBaseVNode("div",_hoisted_1$26,[g.value==="line"?(openBlock(),createElementBlock("div",_hoisted_2$1W,[createVNode(j),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureLine")),1)])):g.value==="polyline"?(openBlock(),createElementBlock("div",_hoisted_3$1J,[createVNode(X),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureMultiline")),1)])):g.value==="polygon"?(openBlock(),createElementBlock("div",_hoisted_4$D,[createVNode(H),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measurePolygon")),1)])):g.value==="rectangle"?(openBlock(),createElementBlock("div",_hoisted_5$r,[createVNode(U),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureRectangle")),1)])):g.value==="circle"?(openBlock(),createElementBlock("div",_hoisted_6$k,[createVNode(te),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureCircle")),1)])):g.value==="arc"?(openBlock(),createElementBlock("div",_hoisted_7$f,[createVNode(Q),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureArc")),1)])):g.value==="curve"?(openBlock(),createElementBlock("div",_hoisted_8$c,[createVNode(re),createBaseVNode("span",null,toDisplayString(unref(u)("toolbar.measurementTools.measureCurve")),1)])):createCommentVNode("",!0),createBaseVNode("div",{onClick:Z[0]||(Z[0]=Ae=>T.value=!T.value),class:"fold-button"},[T.value?(openBlock(),createBlock(be,{key:1})):(openBlock(),createBlock(Pe,{key:0}))])]),withDirectives(createBaseVNode("div",_hoisted_9$c,[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.scale"))+":",1),createBaseVNode("span",null,toDisplayString(N.value),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.precision"))+":",1),createBaseVNode("span",null,toDisplayString(y.precision),1),g.value==="line"?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.distance"))+":",1),createBaseVNode("span",_hoisted_10$b,[createVNode(unref(NInputNumber),{value:y.length,"onUpdate:value":[Z[1]||(Z[1]=Ae=>y.length=Ae),Z[2]||(Z[2]=Ae=>J(Ae,"length"))],placeholder:"1",min:"1",max:"100",step:1,"update-value-on-input":!1,"show-button":!1,disabled:!M.value},null,8,["value","disabled"]),createTextVNode(" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)]),createBaseVNode("span",_hoisted_11$8,[createTextVNode(toDisplayString(unref(u)("measurement.dimensions.angle"))+": ",1),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.lineAngle")),1)]),_:1})]),createBaseVNode("span",_hoisted_12$7,[createVNode(unref(NInputNumber),{value:y.angle,"onUpdate:value":[Z[3]||(Z[3]=Ae=>y.angle=Ae),Z[4]||(Z[4]=Ae=>J(Ae,"angle"))],placeholder:"1",min:"-180",max:"180",step:1,"update-value-on-input":!1,"show-button":!1,disabled:!M.value},null,8,["value","disabled"]),createTextVNode("\xB0 ")]),createBaseVNode("span",_hoisted_13$7,[createTextVNode(" X: "),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.xAxis")),1)]),_:1})]),createBaseVNode("span",null,toDisplayString(y.X)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",_hoisted_14$7,[createTextVNode(" Y: "),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.yAxis")),1)]),_:1})]),createBaseVNode("span",null,toDisplayString(y.Y)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)],64)):createCommentVNode("",!0),g.value==="polyline"?(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.distance"))+":",1),createBaseVNode("span",null,toDisplayString(y.length)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",_hoisted_15$7,[createTextVNode(toDisplayString(unref(u)("measurement.dimensions.angle"))+": ",1),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"250px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.multilineAngle")),1)]),_:1})]),createBaseVNode("span",null,toDisplayString(y.angle)+"\xB0",1)],64)):createCommentVNode("",!0),g.value==="curve"?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.distance"))+":",1),createBaseVNode("span",null,toDisplayString(y.length)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)],64)):createCommentVNode("",!0),g.value==="circle"?(openBlock(),createElementBlock(Fragment,{key:3},[createBaseVNode("span",_hoisted_16$6,[createTextVNode(toDisplayString(unref(u)("measurement.dimensions.radius"))+": ",1),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.circleRadius")),1)]),_:1})]),createBaseVNode("span",_hoisted_17$5,[createVNode(unref(NInputNumber),{value:y.radius,"onUpdate:value":[Z[5]||(Z[5]=Ae=>y.radius=Ae),Z[6]||(Z[6]=Ae=>J(Ae,"radius"))],placeholder:"1",min:"1",max:"100",step:1,"update-value-on-input":!1,"show-button":!1,disabled:!M.value},null,8,["value","disabled"]),createTextVNode(" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)]),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.perimeter"))+":",1),createBaseVNode("span",null,toDisplayString(y.perimeter)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.area"))+":",1),createBaseVNode("span",null,toDisplayString(y.area)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`))+"\xB2",1)],64)):createCommentVNode("",!0),g.value==="arc"?(openBlock(),createElementBlock(Fragment,{key:4},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.radius"))+":",1),createBaseVNode("span",null,toDisplayString(y.radius)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.arcLength"))+":",1),createBaseVNode("span",null,toDisplayString(y.arcLength)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.angle"))+":",1),createBaseVNode("span",null,toDisplayString(y.angle)+"\xB0",1)],64)):createCommentVNode("",!0),g.value==="rectangle"?(openBlock(),createElementBlock(Fragment,{key:5},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.perimeter"))+":",1),createBaseVNode("span",null,toDisplayString(y.perimeter)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.area"))+":",1),createBaseVNode("span",null,toDisplayString(y.area)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`))+"\xB2",1),createBaseVNode("span",_hoisted_18$4,[createTextVNode(toDisplayString(unref(u)("measurement.dimensions.height"))+": ",1),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.horizontally")),1)]),_:1})]),createBaseVNode("span",_hoisted_19$4,[createVNode(unref(NInputNumber),{value:y.length,"onUpdate:value":[Z[7]||(Z[7]=Ae=>y.length=Ae),Z[8]||(Z[8]=Ae=>J(Ae,"length"))],placeholder:"1",min:"1",max:"100",step:1,"update-value-on-input":!1,"show-button":!1,disabled:!M.value},null,8,["value","disabled"]),createTextVNode(" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)]),createBaseVNode("span",_hoisted_20$4,[createTextVNode(toDisplayString(unref(u)("measurement.dimensions.width"))+": ",1),createVNode(unref(NTooltip),{trigger:"hover",style:{padding:"2px 10px","background-color":"#414960","box-shadow":"none","max-width":"280px","text-align":"center"},"arrow-style":"background-color: #414960;"},{trigger:withCtx(()=>[createVNode(we)]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(u)("measurement.tooltips.vertically")),1)]),_:1})]),createBaseVNode("span",_hoisted_21$4,[createVNode(unref(NInputNumber),{value:y.width,"onUpdate:value":[Z[9]||(Z[9]=Ae=>y.width=Ae),Z[10]||(Z[10]=Ae=>J(Ae,"width"))],placeholder:"1",min:"1",max:"100",step:1,"update-value-on-input":!1,"show-button":!1,disabled:!M.value},null,8,["value","disabled"]),createTextVNode(" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1)])],64)):createCommentVNode("",!0),g.value==="polygon"?(openBlock(),createElementBlock(Fragment,{key:6},[createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.perimeter"))+":",1),createBaseVNode("span",null,toDisplayString(y.perimeter)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`)),1),createBaseVNode("span",null,toDisplayString(unref(u)("measurement.dimensions.area"))+":",1),createBaseVNode("span",null,toDisplayString(y.area)+" "+toDisplayString(unref(u)(`measurement.units.${y.scale.translateUnit}`))+"\xB2",1)],64)):createCommentVNode("",!0)],512),[[vShow,!T.value]]),withDirectives(createBaseVNode("div",_hoisted_22$4,[createBaseVNode("span",{onClick:q},toDisplayString(unref(u)("toolbar.settings.title")),1)],512),[[vShow,!T.value]])],38)),[[vShow,v.value]])}}},RedactionTipDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$25={key:0,class:"redaction-tip-dialog"},_hoisted_2$1V={class:"title"},dialogName$a="redactionTipDialog",_sfc_main$2s={__name:"RedactionTipDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$a)),u=computed(()=>o.getFirstEnterRedactionTool),s=()=>{o.setRedactionPrompted(!0),o.setToolState(u.value),n.setDisableHeader(!0),n.resetPanels(),n.closeElement(dialogName$a)};return(w,m)=>{const v=__unplugin_components_2$f,g=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$25,[createVNode(g,{show:r.value,dialogName:dialogName$a,close:!0},{default:withCtx(()=>[createVNode(v),createBaseVNode("p",_hoisted_2$1V,toDisplayString(w.$t("redaction.caution")),1),createBaseVNode("p",null,toDisplayString(w.$t("redaction.warning")),1),createBaseVNode("div",{class:"rect-button blue",onClick:s},toDisplayString(w.$t("redaction.understand")),1)]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_hoisted_1$24={key:0,class:"layer-locked-tip-popup"},dialogName$9="unsupportedMobileDialog",_sfc_main$2r={__name:"UnsupportedMobileDialog",setup(e){const n=useViewerStore(),o=computed(()=>n.isElementOpen(dialogName$9)),r=()=>{n.closeElement(dialogName$9)};return(u,s)=>{const w=__unplugin_components_2$f,m=_sfc_main$4v;return o.value?(openBlock(),createElementBlock("div",_hoisted_1$24,[createVNode(m,{class:"layer-locked-tip-popup",show:o.value,dialogName:dialogName$9},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button blue",onClick:s[0]||(s[0]=v=>r())},toDisplayString(u.$t("common.actions.ok")),1)]),default:withCtx(()=>[createVNode(w),createBaseVNode("p",null,toDisplayString(u.$t("colorSeparation.mobileWarning")),1)]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$2q={},_hoisted_1$23={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1U=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 2.25H2.25V3V15H3.75V3.75H15V2.25H3ZM7.5 7.5H16.5V16.5H7.5V7.5ZM6 6H7.5H16.5H18V7.5V16.5V18H16.5H7.5H6V16.5V7.5V6Z",fill:"currentColor"},null,-1),_hoisted_3$1I=[_hoisted_2$1U];function _sfc_render$1h(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$23,_hoisted_3$1I)}const __unplugin_components_1$5=_export_sfc(_sfc_main$2q,[["render",_sfc_render$1h]]),_sfc_main$2p={__name:"ContentEditorPopup",setup(e){const n=useViewerStore();useDocumentStore();const o=computed(()=>n.getPopupItems("contentEditorPopup")),r=computed(()=>n.isElementOpen("contentEditorPanel")),u=ref(!1),s=ref(0),w=ref(0),m=ref(null);let v,g=!1,d;const f=P=>{u.value=!1,core.handlePopup({type:"contentEditor",tool:P})},y=async(P={})=>{const{rect:S}=P;if(u.value=!!S,await nextTick(),S&&u.value){const E=m.value.children[0];if(!E)return;const M=E.offsetWidth,T=E.offsetHeight+10;let D=S.right-M,N=S.bottom;const I=window.innerWidth,O=window.innerHeight;D>I-M&&(D=I-M),D<0&&(D=0),N+T>O&&(N=Math.max(0,S.top-T)),s.value=N,w.value=r.value?D+130:D}};core.addEvent("showContentEditorPopup",y);const x=()=>{u.value&&(u.value=!1,g=!0),g&&(clearTimeout(d),d=setTimeout(()=>{core.showPopup({type:"contentEditorPupop"}),g=!1},200))},k=()=>{n.toggleElement("contentEditorPanel")};return onMounted(()=>{v=document.querySelector(".document-container"),v&&v.addEventListener("scroll",x)}),onUnmounted(()=>{v&&v.removeEventListener("scroll",x)}),(P,S)=>{const E=_sfc_main$2H,M=__unplugin_components_1$5,T=_sfc_main$4C,D=__unplugin_components_8$3,N=__unplugin_components_21;return openBlock(),createElementBlock("div",{ref_key:"contentEditorPopupRef",ref:m},[withDirectives(createBaseVNode("div",{class:"content-editor-popup popup",style:normalizeStyle({top:`${s.value}px`,left:`${w.value}px`,transform:`translateX(${!unref(isMobileDevice)&&r.value?-130:0}px) translateY(5px)`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,(I,O)=>(openBlock(),createElementBlock(Fragment,{key:`${I.dataElement||new Date}-${O}`},[I.name==="customButton"&&!I.hidden?(openBlock(),createBlock(E,{key:0,item:I,"data-element":I.dataElement},null,8,["item","data-element"])):I.type==="copy"&&!I.hidden?(openBlock(),createBlock(T,{key:1,onClick:S[0]||(S[0]=F=>f("copy")),title:P.$t("documentEditor.copy"),"data-element":I.dataElement},{default:withCtx(()=>[createVNode(M)]),_:2},1032,["title","data-element"])):I.type==="delete"&&!I.hidden?(openBlock(),createBlock(T,{key:2,onClick:S[1]||(S[1]=F=>f("delete")),title:P.$t("common.actions.delete"),"data-element":I.dataElement},{default:withCtx(()=>[createVNode(D)]),_:2},1032,["title","data-element"])):I.type==="property"&&!I.hidden?(openBlock(),createBlock(T,{key:3,onClick:k,title:P.$t("common.properties"),"data-element":I.dataElement,isActive:r.value},{default:withCtx(()=>[createVNode(N)]),_:2},1032,["title","data-element","isActive"])):["spacer","divider"].includes(I.type)?(openBlock(),createElementBlock("div",{key:4,class:normalizeClass(I.type)},null,2)):createCommentVNode("",!0)],64))),128))],4),[[vShow,u.value&&o.value.length]])],512)}}},_sfc_main$2o={},_hoisted_1$22={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1T=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.3596 8.35973L10.7499 11.9694L10.7499 2C10.7499 1.58579 10.4142 1.25 9.99994 1.25C9.58573 1.25 9.24994 1.58579 9.24994 2L9.24994 11.9694L5.64024 8.35973C5.34735 8.06683 4.87247 8.06683 4.57958 8.35973C4.28669 8.65262 4.28669 9.12749 4.57958 9.42039L9.46961 14.3104C9.7625 14.6033 10.2374 14.6033 10.5303 14.3104L15.4203 9.42039C15.7132 9.12749 15.7132 8.65262 15.4203 8.35973C15.1274 8.06683 14.6525 8.06683 14.3596 8.35973ZM2.99994 16.1538C2.58573 16.1538 2.24994 16.4896 2.24994 16.9038C2.24994 17.318 2.58573 17.6538 2.99994 17.6538H17.3076C17.7218 17.6538 18.0576 17.318 18.0576 16.9038C18.0576 16.4896 17.7218 16.1538 17.3076 16.1538H2.99994Z",fill:"currentColor"},null,-1),_hoisted_3$1H=[_hoisted_2$1T];function _sfc_render$1g(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$22,_hoisted_3$1H)}const __unplugin_components_0$j=_export_sfc(_sfc_main$2o,[["render",_sfc_render$1g]]),_sfc_main$2n={__name:"CropPagePopup",setup(e){const n=useViewerStore(),o=computed(()=>n.getPopupItems("cropPagePopup")),r=ref(!1),u=ref(0),s=ref(0),w=ref(null),m=ref(!0);let v,g=!1,d,f=0;const y=E=>{core.handlePopup({type:"cropPage",tool:E})},x=async E=>{var T;let{rect:M}=E;if(f=E.pageNumber,r.value=!!M,await nextTick(),n.setDisableHeader(r.value),r.value&&n.resetPanels(),M&&r.value){const D=core.pageToWindow({x:M.left,y:M.top},E.pageNumber),N=core.pageToWindow({x:M.right,y:M.bottom},E.pageNumber),I=core.getScrollViewElement();M={left:D.x-I.scrollLeft,top:D.y-I.scrollTop,right:N.x-I.scrollLeft,bottom:N.y-I.scrollTop};const O=(T=w.value)==null?void 0:T.children[0];if(!O)return;let F=M.left+(M.right-M.left)/2,q=M.bottom;const Y=O.offsetWidth,_e=O.offsetHeight+10,ne=window.innerWidth,ve=window.innerHeight;m.value=!0,F-Y/2<0?(F=0,m.value=!1):F+Y/2>ne&&(F=ne-Y,m.value=!1),q+_e>ve&&(q=Math.max(0,M.top-_e)),u.value=q,s.value=F}};core.addEvent("snipSelected",x);const k=async()=>{const E=await core.getCropedPageImage(f);P(E),y("close")},P=(E,M)=>{const T=document.createElement("a");T.href=E,T.download=M||"image",document.body.appendChild(T),T.click(),document.body.removeChild(T)},S=()=>{r.value&&(r.value=!1,g=!0),g&&(clearTimeout(d),d=setTimeout(()=>{core.showPopup({type:"cropPagePupop",pageIndex:f-1}),g=!1},200))};return onMounted(()=>{v=document.querySelector(".document-container"),v&&v.addEventListener("scroll",S)}),onUnmounted(()=>{v&&v.removeEventListener("scroll",S)}),(E,M)=>{const T=_sfc_main$2H,D=__unplugin_components_0$j,N=_sfc_main$4C,I=__unplugin_components_1$h;return openBlock(),createElementBlock("div",{ref_key:"cropPagePopupRef",ref:w,onMousedown:M[1]||(M[1]=withModifiers(()=>{},["stop"])),onTouchstart:M[2]||(M[2]=withModifiers(()=>{},["stop"]))},[r.value&&o.value.length?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["crop-page-popup popup",{transform:m.value}]),style:normalizeStyle({top:`${u.value}px`,left:`${s.value}px`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,(O,F)=>(openBlock(),createElementBlock(Fragment,{key:`${O.dataElement||new Date}-${F}`},[O.name==="customButton"&&!O.hidden?(openBlock(),createBlock(T,{key:0,item:O},null,8,["item"])):O.type==="cropPage"&&!O.hidden?(openBlock(),createBlock(N,{key:1,onClick:k,title:E.$t("toolbar.fileOperations.download"),"data-element":O.dataElement},{default:withCtx(()=>[createVNode(D)]),_:2},1032,["title","data-element"])):O.type==="close"&&!O.hidden?(openBlock(),createBlock(N,{key:2,onClick:M[0]||(M[0]=q=>y("close")),title:E.$t("common.actions.exit"),"data-element":O.dataElement},{default:withCtx(()=>[createVNode(I)]),_:2},1032,["title","data-element"])):["spacer","divider"].includes(O.type)?(openBlock(),createElementBlock("div",{key:3,class:normalizeClass(O.type)},null,2)):createCommentVNode("",!0)],64))),128))],6)):createCommentVNode("",!0)],544)}}},_sfc_main$2m={},_hoisted_1$21={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1S=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.4216 5.35913H9.36765V3.85913H13.3676V5.35913H11.9745L9.48752 14.6409H10.6323V16.1409H6.63232V14.6409H7.9346L10.4216 5.35913Z",fill:"currentColor"},null,-1),_hoisted_3$1G=[_hoisted_2$1S];function _sfc_render$1f(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$21,_hoisted_3$1G)}const __unplugin_components_6$3=_export_sfc(_sfc_main$2m,[["render",_sfc_render$1f]]),_sfc_main$2l={},_hoisted_1$20={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1R=createBaseVNode("path",{d:"M10.4934 16H5V4H10.8882C12.3739 4.02171 13.4265 4.44776 14.0461 5.27815C14.4189 5.78833 14.6053 6.39891 14.6053 7.10991C14.6053 7.84261 14.4189 8.43148 14.0461 8.87653C13.8377 9.12619 13.5307 9.35414 13.125 9.56038C13.7445 9.7829 14.2105 10.1357 14.523 10.6187C14.841 11.1018 15 11.6879 15 12.3772C15 13.0882 14.8191 13.7259 14.4572 14.2904C14.227 14.6649 13.9391 14.9796 13.5938 15.2347C13.2045 15.5278 12.744 15.7286 12.2122 15.8372C11.6859 15.9457 11.1129 16 10.4934 16ZM10.4359 10.7164H7.41776V13.9159H10.3947C10.9265 13.9159 11.3405 13.8453 11.6365 13.7042C12.1738 13.4437 12.4424 12.9444 12.4424 12.2062C12.4424 11.5821 12.182 11.1533 11.6612 10.9199C11.3706 10.7897 10.9622 10.7218 10.4359 10.7164ZM11.6941 8.42877C12.023 8.23338 12.1875 7.88331 12.1875 7.37856C12.1875 6.81954 11.9682 6.45047 11.5296 6.27137C11.1513 6.14654 10.6689 6.08412 10.0822 6.08412H7.41776V8.72999H10.3947C10.9265 8.72999 11.3596 8.62958 11.6941 8.42877Z",fill:"currentColor"},null,-1),_hoisted_3$1F=[_hoisted_2$1R];function _sfc_render$1e(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$20,_hoisted_3$1F)}const __unplugin_components_5$3=_export_sfc(_sfc_main$2l,[["render",_sfc_render$1e]]),_sfc_main$2k={},_hoisted_1$1$={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1Q=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.394 4.97046H12.394V6.47046H17.394V4.97046ZM9.29604 4.99995L13.2075 14.7785H14.2V15.7785H11V14.7785H11.5919L10.792 12.7785H6.4074L5.60744 14.7785H6.2V15.7785H3V14.7785H3.9919L7.90332 4.99995H9.29604ZM8.59968 7.29749L10.392 11.7785H6.80738L8.59968 7.29749Z",fill:"currentColor"},null,-1),_hoisted_3$1E=[_hoisted_2$1Q];function _sfc_render$1d(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1$,_hoisted_3$1E)}const __unplugin_components_4$8=_export_sfc(_sfc_main$2k,[["render",_sfc_render$1d]]),_sfc_main$2j={},_hoisted_1$1_={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1P=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 6.5V5H5V6.5H18Z",fill:"currentColor"},null,-1),_hoisted_3$1D=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 11V9.5H2V11H18Z",fill:"currentColor"},null,-1),_hoisted_4$C=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 15.5V14H8V15.5H18Z",fill:"currentColor"},null,-1),_hoisted_5$q=[_hoisted_2$1P,_hoisted_3$1D,_hoisted_4$C];function _sfc_render$1c(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1_,_hoisted_5$q)}const __unplugin_components_2$c=_export_sfc(_sfc_main$2j,[["render",_sfc_render$1c]]),_sfc_main$2i={},_hoisted_1$1Z={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1O=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 6.5V5H2V6.5H18ZM15 11V9.5H5V11H15ZM18 14V15.5H2V14H18Z",fill:"currentColor"},null,-1),_hoisted_3$1C=[_hoisted_2$1O];function _sfc_render$1b(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1Z,_hoisted_3$1C)}const __unplugin_components_1$4=_export_sfc(_sfc_main$2i,[["render",_sfc_render$1b]]);var _a;const isClient=typeof window<"u",isString$1=e=>typeof e=="string",noop=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(e){return typeof e=="function"?e():unref(e)}function promiseTimeout(e,n=!1,o="Timeout"){return new Promise((r,u)=>{setTimeout(n?()=>u(o):r,e)})}function identity(e){return e}function tryOnScopeDispose(e){return getCurrentScope()?(onScopeDispose(e),!0):!1}function createUntil(e,n=!1){function o(f,{flush:y="sync",deep:x=!1,timeout:k,throwOnTimeout:P}={}){let S=null;const M=[new Promise(T=>{S=watch(e,D=>{f(D)!==n&&(S==null||S(),T(D))},{flush:y,deep:x,immediate:!0})})];return k!=null&&M.push(promiseTimeout(k,P).then(()=>resolveUnref(e)).finally(()=>S==null?void 0:S())),Promise.race(M)}function r(f,y){if(!isRef(f))return o(D=>D===f,y);const{flush:x="sync",deep:k=!1,timeout:P,throwOnTimeout:S}=y!=null?y:{};let E=null;const T=[new Promise(D=>{E=watch([e,f],([N,I])=>{n!==(N===I)&&(E==null||E(),D(N))},{flush:x,deep:k,immediate:!0})})];return P!=null&&T.push(promiseTimeout(P,S).then(()=>resolveUnref(e)).finally(()=>(E==null||E(),resolveUnref(e)))),Promise.race(T)}function u(f){return o(y=>Boolean(y),f)}function s(f){return r(null,f)}function w(f){return r(void 0,f)}function m(f){return o(Number.isNaN,f)}function v(f,y){return o(x=>{const k=Array.from(x);return k.includes(f)||k.includes(resolveUnref(f))},y)}function g(f){return d(1,f)}function d(f=1,y){let x=-1;return o(()=>(x+=1,x>=f),y)}return Array.isArray(resolveUnref(e))?{toMatch:o,toContains:v,changed:g,changedTimes:d,get not(){return createUntil(e,!n)}}:{toMatch:o,toBe:r,toBeTruthy:u,toBeNull:s,toBeNaN:m,toBeUndefined:w,changed:g,changedTimes:d,get not(){return createUntil(e,!n)}}}function until(e){return createUntil(e)}function unrefElement(e){var n;const o=resolveUnref(e);return(n=o==null?void 0:o.$el)!=null?n:o}const defaultWindow=isClient?window:void 0;isClient&&window.document;isClient&&window.navigator;isClient&&window.location;function useEventListener(...e){let n,o,r,u;if(isString$1(e[0])||Array.isArray(e[0])?([o,r,u]=e,n=defaultWindow):[n,o,r,u]=e,!n)return noop;Array.isArray(o)||(o=[o]),Array.isArray(r)||(r=[r]);const s=[],w=()=>{s.forEach(d=>d()),s.length=0},m=(d,f,y,x)=>(d.addEventListener(f,y,x),()=>d.removeEventListener(f,y,x)),v=watch(()=>[unrefElement(n),resolveUnref(u)],([d,f])=>{w(),d&&s.push(...o.flatMap(y=>r.map(x=>m(d,y,x,f))))},{immediate:!0,flush:"post"}),g=()=>{v(),w()};return tryOnScopeDispose(g),g}let _iOSWorkaround=!1;function onClickOutside(e,n,o={}){const{window:r=defaultWindow,ignore:u=[],capture:s=!0,detectIframe:w=!1}=o;if(!r)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(r.document.body.children).forEach(y=>y.addEventListener("click",noop)));let m=!0;const v=y=>u.some(x=>{if(typeof x=="string")return Array.from(r.document.querySelectorAll(x)).some(k=>k===y.target||y.composedPath().includes(k));{const k=unrefElement(x);return k&&(y.target===k||y.composedPath().includes(k))}}),d=[useEventListener(r,"click",y=>{const x=unrefElement(e);if(!(!x||x===y.target||y.composedPath().includes(x))){if(y.detail===0&&(m=!v(y)),!m){m=!0;return}n(y)}},{passive:!0,capture:s}),useEventListener(r,"pointerdown",y=>{const x=unrefElement(e);x&&(m=!y.composedPath().includes(x)&&!v(y))},{passive:!0}),w&&useEventListener(r,"blur",y=>{var x;const k=unrefElement(e);((x=r.document.activeElement)==null?void 0:x.tagName)==="IFRAME"&&!(k!=null&&k.contains(r.document.activeElement))&&n(y)})].filter(Boolean);return()=>d.forEach(y=>y())}const _global=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global[globalKey]=_global[globalKey]||{};_global[globalKey];var SwipeDirection;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp$1=Object.defineProperty,__getOwnPropSymbols$1=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum$1=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(e,n,o)=>n in e?__defProp$1(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,__spreadValues$1=(e,n)=>{for(var o in n||(n={}))__hasOwnProp$1.call(n,o)&&__defNormalProp$1(e,o,n[o]);if(__getOwnPropSymbols$1)for(var o of __getOwnPropSymbols$1(n))__propIsEnum$1.call(n,o)&&__defNormalProp$1(e,o,n[o]);return e};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues$1({linear:identity},_TransitionPresets);const _sfc_main$2h={},_hoisted_1$1Y={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1N=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.644 4.97046V3.22046H14.144V4.97046H12.394V6.47046H14.144V8.22046H15.644V6.47046H17.394V4.97046H15.644ZM13.2075 14.7785L9.29604 4.99995H7.90332L3.9919 14.7785H3V15.7785H6.2V14.7785H5.60744L6.4074 12.7785H10.792L11.5919 14.7785H11V15.7785H14.2V14.7785H13.2075ZM10.392 11.7785L8.59968 7.29749L6.80738 11.7785H10.392Z",fill:"currentColor"},null,-1),_hoisted_3$1B=[_hoisted_2$1N];function _sfc_render$1a(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1Y,_hoisted_3$1B)}const IncreaseFont=_export_sfc(_sfc_main$2h,[["render",_sfc_render$1a]]),_sfc_main$2g={},_hoisted_1$1X={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1M=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15 6.5V5H2V6.5H15ZM18 11V9.5H2V11H18ZM12 14V15.5H2V14H12Z",fill:"currentColor"},null,-1),_hoisted_3$1A=[_hoisted_2$1M];function _sfc_render$19(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1X,_hoisted_3$1A)}const TextalignLeft=_export_sfc(_sfc_main$2g,[["render",_sfc_render$19]]),FreetextPopup_vue_vue_type_style_index_0_lang="",_hoisted_1$1W={class:"popup-container"},_hoisted_2$1L={class:"color-picker"},_hoisted_3$1z={class:"preview-container active"},_hoisted_4$B=createBaseVNode("img",{src:_imports_0$2,alt:"colorPicker"},null,-1),_hoisted_5$p={class:"text-font"},_hoisted_6$j=createBaseVNode("div",{class:"divider"},null,-1),_sfc_main$2f={__name:"FreetextPopup",emits:["setActiveColor"],setup(e,{emit:n}){const o=useDocumentStore(),r=useViewerStore(),u=ref(null),s=ref(null),w=ref(null),m=ref("top"),v=ref(0),g=ref(!1),d=ref(!1),f=computed(()=>r.isElementOpen("freetextPanel")),y=computed(()=>r.isElementOpen("leftPanel")),x=computed(()=>r.getIsAnnotationPopup),k=computed(()=>o.getActiveTool),P=computed(()=>r.getCustomFonts),S=computed(()=>r.getUserAdmin),E=computed(()=>r.getReadOnly),M=computed(()=>o.getAnnotator),T=ref(0),D=ref(0),N=ref(null);let I=!1,O=null,F,q=null;const Y=ref(!S.value&&(E.value||q&&M.value!==q.author)),_e=le=>{const oe=le.fontFamily;r.setCustomFonts(oe)};core.addEvent("LoadFont",_e),watch([S,E],()=>{Y.value=!S.value&&(E.value||q&&M!==q.author)}),watch(()=>P.value,(le,oe)=>{ve.value=ne(le)},{deep:!0});const ne=le=>{if(le.length)return le.map(oe=>({label:oe.fontFamily,value:oe.fontName}))},ve=ref([]);ve.value=ne(P.value);const J=reactive({fontName:"Helvetica",fontStyle:"normal",fontWeight:"normal",fontSize:14,color:"rgb(0, 0, 0)",textAlignment:"left"});onClickOutside(w,()=>{g.value=!1});const fe=()=>{r.toggleElement("freetextPanel")},Z=()=>{J.fontWeight=J.fontWeight==="bold"?"normal":"bold",Ie({fontWeight:J.fontWeight})},j=le=>{let oe=J.fontSize;le==="increase"?oe+=1:le==="decrease"&&(oe-=1),oe=Math.max(6,oe),oe=Math.min(72,oe),J.fontSize=oe,Ie({fontSize:J.fontSize})},X=()=>{J.fontStyle=J.fontStyle==="oblique"?"normal":"oblique",Ie({fontStyle:J.fontStyle})},H=async le=>{const{rect:oe,pageNumber:ke}=le,Ce=core.pageToWindow({x:oe.left,y:oe.top},ke),Ee=core.pageToWindow({x:oe.right,y:oe.bottom},ke),Be=Ee.x-Ce.x,Ve={x:Ce.x+Be/2,y:Ce.y};if(d.value=!0,await nextTick(),!N.value)return;const Oe=N.value,je=Oe.offsetWidth,Ge=Oe.offsetHeight+10;let Xe=Math.max(Ve.x-je/2-F.scrollLeft,0);Xe+je>F.offsetWidth+F.offsetLeft+(!isMobileDevice&&f.value?260:0)&&(Xe=F.offsetWidth-je);let qe=Ve.y-Ge-8-F.scrollTop;m.value="top",qe<=150&&(qe=Ee.y+15-F.scrollTop,m.value="bottom"),D.value=Xe,T.value=qe},U=async()=>{if(g.value=!g.value,!g.value)return;const le=w.value.offsetLeft-u.value.scrollLeft,oe=w.value.offsetWidth;await nextTick();const ke=s.value.offsetWidth;let Ce=le+oe/2-ke/2;v.value=Ce},te=()=>{d.value=!1},Q=le=>{H(le)},re=le=>{const oe=le.annotation;Me(le);const ke=oe.rect;H({rect:ke,pageNumber:oe.pageIndex+1}),q=le,Y.value=!S.value&&(E.value||q&&M.value!==q.author)},Pe=le=>{const{annotation:oe}=le;q&&q.annotation.name===oe.name&&Me(le)};watch([y,f],()=>{if(!q)return;const le=q.annotation;setTimeout(()=>{H({rect:le.rect,pageNumber:le.pageIndex+1})},320)}),core.addEvent("annotationDeselected",le=>{q&&le!==q?d.value=!0:q&&(q=null,te())}),core.addEvent("annotationSelectedAttr",re),core.addEvent("mouseMoving",Q),core.addEvent("annotationChange",Pe);const be=()=>{d.value&&(d.value=!1,I=!0),I&&(clearTimeout(O),O=setTimeout(()=>{if(q){const le=q.annotation,oe=le.rect;H({rect:oe,pageNumber:le.pageIndex+1})}I=!1},200))};onMounted(()=>{F=document.querySelector(".document-container"),F&&F.addEventListener("scroll",be),u.value.addEventListener("scroll",()=>{g.value&&(g.value=!1)})}),onUnmounted(()=>{F&&F.removeEventListener("scroll",be)});const we=le=>{areColorsSimilar(le,J.color)||(J.color=le)},Ae=le=>{J.color=le=le};watch(()=>J.color,le=>{le&&Ie({color:le})}),watch(()=>J.fontName,le=>{le&&Ie({fontName:le})}),watch(()=>k.value,(le,oe)=>{oe==="freetext"&&le!=="freetext"&&f.value&&r.closeElement("freetextPanel")});const $e=le=>{J.textAlignment=le,Ie({textAlignment:J.textAlignment}),g.value=!1},Me=le=>{const oe=le.annotation;for(const ke in J)for(const Ce in oe)ke===Ce&&(J[Ce]=oe[ke])},Ie=le=>{q&&core.setAnnotationStyles(q,le)},Le=le=>{q&&q.handleDelete()};return(le,oe)=>{const ke=_sfc_main$4C,Ce=__unplugin_components_1$4,Ee=__unplugin_components_2$c,Be=__unplugin_components_0$B,Ve=__unplugin_components_4$8,Oe=__unplugin_components_5$3,je=__unplugin_components_6$3,Ge=__unplugin_components_21,Xe=__unplugin_components_8$3;return withDirectives((openBlock(),createElementBlock("div",{ref_key:"freetextPopupRef",ref:N,class:"freetext-popup popup",style:normalizeStyle({top:`${T.value}px`,left:`${D.value}px`})},[createBaseVNode("div",{ref_key:"popupWrapperRef",ref:u,class:"popup-wrapper"},[withDirectives(createBaseVNode("div",{ref_key:"alignContainerRef",ref:s,class:normalizeClass(["align-container",m.value]),style:normalizeStyle({left:v.value+"px"}),onClick:oe[3]||(oe[3]=withModifiers(()=>{},["stop"]))},[createVNode(ke,{isActive:J.textAlignment==="left",onClick:oe[0]||(oe[0]=qe=>$e("left"))},{default:withCtx(()=>[createVNode(TextalignLeft)]),_:1},8,["isActive"]),createVNode(ke,{isActive:J.textAlignment==="center",onClick:oe[1]||(oe[1]=qe=>$e("center"))},{default:withCtx(()=>[createVNode(Ce)]),_:1},8,["isActive"]),createVNode(ke,{isActive:J.textAlignment==="right",onClick:oe[2]||(oe[2]=qe=>$e("right"))},{default:withCtx(()=>[createVNode(Ee)]),_:1},8,["isActive"])],6),[[vShow,g.value]]),createBaseVNode("div",_hoisted_1$1W,[createBaseVNode("div",_hoisted_2$1L,[createBaseVNode("div",_hoisted_3$1z,[createBaseVNode("div",{class:"preview",style:normalizeStyle({backgroundColor:J.color})},null,4)]),createVNode(unref(NColorPicker),{to:".freetext-popup",onComplete:we,"onUpdate:value":Ae,value:J.color,"show-alpha":!1},{label:withCtx(()=>[_hoisted_4$B]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_5$p,[createVNode(unref(NSelect),{"consistent-menu-width":!1,value:J.fontName,"onUpdate:value":oe[4]||(oe[4]=qe=>J.fontName=qe),options:ve.value,to:".freetext-popup",class:"text-family"},{arrow:withCtx(()=>[createVNode(Be)]),_:1},8,["value","options"])]),createVNode(ke,{onClick:oe[5]||(oe[5]=qe=>j("increase")),class:"button"},{default:withCtx(()=>[createVNode(IncreaseFont)]),_:1}),createVNode(ke,{onClick:oe[6]||(oe[6]=qe=>j("decrease")),class:"button"},{default:withCtx(()=>[createVNode(Ve)]),_:1}),createVNode(ke,{isActive:J.fontWeight==="bold",onClick:oe[7]||(oe[7]=qe=>Z())},{default:withCtx(()=>[createVNode(Oe)]),_:1},8,["isActive"]),createVNode(ke,{isActive:J.fontStyle==="oblique",onClick:oe[8]||(oe[8]=qe=>X()),class:"button"},{default:withCtx(()=>[createVNode(je)]),_:1},8,["isActive"]),createBaseVNode("div",{ref_key:"alignRef",ref:w},[createVNode(ke,{isActive:g.value,class:"alignment",onClick:U},{default:withCtx(()=>[J.textAlignment==="left"?(openBlock(),createBlock(TextalignLeft,{key:0})):J.textAlignment==="center"?(openBlock(),createBlock(Ce,{key:1})):J.textAlignment==="right"?(openBlock(),createBlock(Ee,{key:2})):createCommentVNode("",!0)]),_:1},8,["isActive"])],512),_hoisted_6$j,createVNode(ke,{onClick:fe,isActive:f.value,class:"property sidebar-style"},{default:withCtx(()=>[createVNode(Ge)]),_:1},8,["isActive"]),createVNode(ke,{onClick:Le,class:"property sidebar-style"},{default:withCtx(()=>[createVNode(Xe)]),_:1})])],512)],4)),[[vShow,d.value&&x.value&&!Y.value]])}}},_sfc_main$2e={},_hoisted_1$1V={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1K=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.6964 3L14.6078 12.7785H15.6004V13.7785H12.4004V12.7785H12.9923L12.1923 10.7785H7.80779L7.00783 12.7785H7.60039V13.7785H4.40039V12.7785H5.39229L9.30371 3H10.6964ZM10.0001 5.29754L11.7924 9.77853H8.20777L10.0001 5.29754ZM5.22219 16.9266L5.08299 16.8542C4.46821 16.565 3.711 16.5891 3.11995 16.9266L2.91898 17.0328C2.78242 17.0994 2.64087 17.1575 2.49529 17.2069C2.12186 17.3336 1.69922 17.177 1.55131 16.8572C1.40339 16.5374 1.5862 16.1755 1.95963 16.0488L2.08133 16.0032C2.16125 15.9703 2.23868 15.9326 2.31312 15.8901L2.4935 15.794C3.59155 15.2495 4.96316 15.2815 6.02902 15.8901L6.16823 15.9624C6.78301 16.2516 7.54022 16.2275 8.13126 15.8901L8.31164 15.794C9.40969 15.2495 10.7813 15.2815 11.8472 15.8901L11.9864 15.9624C12.6011 16.2516 13.3584 16.2275 13.9494 15.8901L14.1298 15.794C15.2278 15.2495 16.5994 15.2815 17.6653 15.8901L17.784 15.9526C17.8647 15.9917 17.9483 16.0256 18.0344 16.054C18.4091 16.1778 18.5956 16.5384 18.451 16.8593C18.3064 17.1802 17.8854 17.34 17.5107 17.2161C17.2824 17.1407 17.0638 17.0438 16.8585 16.9266L16.7193 16.8542C16.1045 16.565 15.3473 16.5891 14.7562 16.9266L14.5759 17.0226C13.4778 17.5671 12.1062 17.5351 11.0403 16.9266L10.9011 16.8542C10.2863 16.565 9.52914 16.5891 8.93809 16.9266L8.75772 17.0226C7.65967 17.5671 6.28806 17.5351 5.22219 16.9266Z",fill:"currentColor"},null,-1),_hoisted_3$1y=[_hoisted_2$1K];function _sfc_render$18(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1V,_hoisted_3$1y)}const __unplugin_components_6$2=_export_sfc(_sfc_main$2e,[["render",_sfc_render$18]]),_sfc_main$2d={},_hoisted_1$1U={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1J=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.696 3L13.8882 10.6785H18V12.1785H14.5118L15.8006 15.2785H17V16.2785H13V15.2785H14.1738L12.8773 12.1785H7.12195L5.82551 15.2785H7V16.2785H3V15.2785H4.19873L5.48749 12.1785H2V10.6785H6.11109L9.30329 3H10.696ZM9.99965 5.29754L12.25 10.6785H7.74927L9.99965 5.29754Z",fill:"currentColor"},null,-1),_hoisted_3$1x=[_hoisted_2$1J];function _sfc_render$17(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1U,_hoisted_3$1x)}const __unplugin_components_5$2=_export_sfc(_sfc_main$2d,[["render",_sfc_render$17]]),_sfc_main$2c={},_hoisted_1$1T={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1I=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.6964 3L14.6078 12.7785H15.6004V13.7785H12.4004V12.7785H12.9923L12.1923 10.7785H7.80779L7.00783 12.7785H7.60039V13.7785H4.40039V12.7785H5.39229L9.30371 3H10.6964ZM10.0001 5.29754L11.7924 9.77853H8.20777L10.0001 5.29754ZM18 15.2785H2V16.7785H18V15.2785Z",fill:"currentColor"},null,-1),_hoisted_3$1w=[_hoisted_2$1I];function _sfc_render$16(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1T,_hoisted_3$1w)}const __unplugin_components_4$7=_export_sfc(_sfc_main$2c,[["render",_sfc_render$16]]),_sfc_main$2b={},_hoisted_1$1S={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1H=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19 2.79999H2.8L1 17.2H17.2L19 2.79999ZM10.333 3.83661L14.7334 14.8375H15.85V15.9625H12.25V14.8375H12.9159L12.016 12.5875H7.08332L6.18337 14.8375H6.85V15.9625H3.25V14.8375H4.3659L8.76624 3.83661H10.333ZM9.54964 6.42134L11.566 11.4625H7.5333L9.54964 6.42134Z",fill:"currentColor"},null,-1),_hoisted_3$1v=[_hoisted_2$1H];function _sfc_render$15(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1S,_hoisted_3$1v)}const __unplugin_components_3$7=_export_sfc(_sfc_main$2b,[["render",_sfc_render$15]]);var toggleSelection=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var n=document.activeElement,o=[],r=0;r<e.rangeCount;r++)o.push(e.getRangeAt(r));switch(n.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":n.blur();break;default:n=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||o.forEach(function(u){e.addRange(u)}),n&&n.focus()}},deselectCurrent=toggleSelection,clipboardToIE11Formatting={"text/plain":"Text","text/html":"Url",default:"Text"},defaultMessage="Copy to clipboard: #{key}, Enter";function format(e){var n=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,n)}function copy(e,n){var o,r,u,s,w,m,v=!1;n||(n={}),o=n.debug||!1;try{u=deselectCurrent(),s=document.createRange(),w=document.getSelection(),m=document.createElement("span"),m.textContent=e,m.ariaHidden="true",m.style.all="unset",m.style.position="fixed",m.style.top=0,m.style.clip="rect(0, 0, 0, 0)",m.style.whiteSpace="pre",m.style.webkitUserSelect="text",m.style.MozUserSelect="text",m.style.msUserSelect="text",m.style.userSelect="text",m.addEventListener("copy",function(d){if(d.stopPropagation(),n.format)if(d.preventDefault(),typeof d.clipboardData>"u"){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var f=clipboardToIE11Formatting[n.format]||clipboardToIE11Formatting.default;window.clipboardData.setData(f,e)}else d.clipboardData.clearData(),d.clipboardData.setData(n.format,e);n.onCopy&&(d.preventDefault(),n.onCopy(d.clipboardData))}),document.body.appendChild(m),s.selectNodeContents(m),w.addRange(s);var g=document.execCommand("copy");if(!g)throw new Error("copy command was unsuccessful");v=!0}catch(d){o&&console.error("unable to copy using execCommand: ",d),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",e),n.onCopy&&n.onCopy(window.clipboardData),v=!0}catch(f){o&&console.error("unable to copy using clipboardData: ",f),o&&console.error("falling back to prompt"),r=format("message"in n?n.message:defaultMessage),window.prompt(r,e)}}finally{w&&(typeof w.removeRange=="function"?w.removeRange(s):w.removeAllRanges()),m&&document.body.removeChild(m),u()}return v}var copyToClipboard=copy;const TextPopup_vue_vue_type_style_index_0_lang="",_sfc_main$2a={__name:"TextPopup",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.getPopupItems("textPopup")),u=computed(()=>n.getReadOnly),s=ref(!1),w=ref(0),m=ref(0),v=ref(null),g=ref(!0),d=ref(null);let f,y=!1,x,k=0;const P=T=>{var I;if(T==="copy"&&d.value){if(!core.getPermission("allowsCopying")){n.openElement("permissionPasswordDialog");return}copyToClipboard(d.value),s.value=!1,d.value=null;return}const D={tool:T},N=(I=o[T])==null?void 0:I.color;N&&(D.color=N),core.handlePopup({type:"text",tool:D})},S=async T=>{const{show:D,rect:N,text:I}=T;if(s.value=D,d.value=I,await nextTick(),N&&s.value){const O=v.value.children[0];if(!O)return;let F=N.left+(N.right-N.left)/2,q=N.bottom;const Y=O.offsetWidth,_e=O.offsetHeight+10,ne=window.innerWidth,ve=window.innerHeight;g.value=!0,F-Y/2<0?(F=0,g.value=!1):F+Y/2>ne&&(F=ne-Y,g.value=!1),q+_e>ve&&(q=Math.max(0,N.top-_e)),w.value=q,m.value=F}};core.addEvent("showTextPopup",S);const E=()=>{s.value&&(s.value=!1,y=!0),y&&(clearTimeout(x),x=setTimeout(()=>{core.showPopup({type:"textPupop",pageIndex:k}),y=!1},200))};onMounted(()=>{f=document.querySelector(".document-container"),f&&f.addEventListener("scroll",E)}),onUnmounted(()=>{f&&f.removeEventListener("scroll",E)});const M=T=>{k=T.pageNumber-1};return core.addEvent("textSelected",M),(T,D)=>{const N=_sfc_main$2H,I=__unplugin_components_1$5,O=_sfc_main$4C,F=__unplugin_components_3$7,q=__unplugin_components_4$7,Y=__unplugin_components_5$2,_e=__unplugin_components_6$2;return openBlock(),createElementBlock("div",{ref_key:"textPopupRef",ref:v},[s.value&&r.value.length?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["text-popup popup",{transform:g.value}]),style:normalizeStyle({top:`${w.value}px`,left:`${m.value}px`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,(ne,ve)=>(openBlock(),createElementBlock(Fragment,{key:`${ne.dataElement||new Date}-${ve}`},[ne.name==="customButton"&&!ne.hidden?(openBlock(),createBlock(N,{key:0,item:ne,"data-element":ne.dataElement},null,8,["item","data-element"])):ne.type==="copy"&&!ne.hidden?(openBlock(),createBlock(O,{key:1,onClick:D[0]||(D[0]=J=>P("copy")),title:T.$t("documentEditor.copy"),"data-element":ne.dataElement},{default:withCtx(()=>[createVNode(I)]),_:2},1032,["title","data-element"])):ne.type==="highlight"&&!ne.hidden&&!u.value?(openBlock(),createBlock(O,{key:2,onClick:D[1]||(D[1]=J=>P("highlight")),title:T.$t("toolbar.annotationTools.highlight"),"data-element":ne.dataElement},{default:withCtx(()=>[createVNode(F)]),_:2},1032,["title","data-element"])):ne.type==="underline"&&!ne.hidden&&!u.value?(openBlock(),createBlock(O,{key:3,onClick:D[2]||(D[2]=J=>P("underline")),title:T.$t("toolbar.annotationTools.underline"),"data-element":ne.dataElement},{default:withCtx(()=>[createVNode(q)]),_:2},1032,["title","data-element"])):ne.type==="strikeout"&&!ne.hidden&&!u.value?(openBlock(),createBlock(O,{key:4,onClick:D[3]||(D[3]=J=>P("strikeout")),title:T.$t("toolbar.annotationTools.strikeout"),"data-element":ne.dataElement},{default:withCtx(()=>[createVNode(Y)]),_:2},1032,["title","data-element"])):ne.type==="squiggly"&&!ne.hidden&&!u.value?(openBlock(),createBlock(O,{key:5,onClick:D[4]||(D[4]=J=>P("squiggly")),title:T.$t("toolbar.annotationTools.squiggly"),"data-element":ne.dataElement},{default:withCtx(()=>[createVNode(_e)]),_:2},1032,["title","data-element"])):["spacer","divider"].includes(ne.type)?(openBlock(),createElementBlock("div",{key:6,class:normalizeClass(ne.type)},null,2)):createCommentVNode("",!0)],64))),128))],6)):createCommentVNode("",!0)],512)}}},RedactionConfirmDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1R={key:0,class:"redaction-confirm-dialog"},_hoisted_2$1G=createBaseVNode("br",null,null,-1),_hoisted_3$1u={key:1},_sfc_main$29={__name:"RedactionConfirmDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.getRedactionConfirmDialog),u=computed(()=>r.value>=0),s=()=>{n.setRedactionConfirmDialog(-1)},w=async()=>{const m=r.value===1?"all":null;n.setCommonLoading(!0),s(),await core.applyRedactions(m),o.setToolState(""),n.setActiveToolMode("view"),n.setCommonLoading(!1)};return(m,v)=>{const g=_sfc_main$4v;return u.value?(openBlock(),createElementBlock("div",_hoisted_1$1R,[createVNode(g,{show:u.value,close:s,class:"confirm-dialog"},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(r.value===1?m.$t("common.actions.save"):m.$t("redaction.note")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:s},toDisplayString(m.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:w},toDisplayString(r.value===1?m.$t("common.actions.save"):m.$t("common.actions.exit")),1)]),default:withCtx(()=>[r.value===1?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("p",null,toDisplayString(m.$t("redaction.saveWarning")[0]),1),_hoisted_2$1G,createBaseVNode("p",null,toDisplayString(m.$t("redaction.saveWarning")[1]),1)],64)):(openBlock(),createElementBlock("p",_hoisted_3$1u,toDisplayString(m.$t("redaction.exitWarning")),1))]),_:1},8,["show"])])):createCommentVNode("",!0)}}},AddDigitalFileDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1Q={key:0,class:"add-digital-file-dialog"},_hoisted_2$1F={class:"input-file row"},_hoisted_3$1t={class:"addition"},_hoisted_4$A={class:"icon-file"},_hoisted_5$o={class:"input-pwd row"},_hoisted_6$i=["placeholder"],_hoisted_7$e={key:0,class:"error-text"},dialogName$8="addDigitalFileDialog",_sfc_main$28={__name:"AddDigitalFileDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),u=getCurrentInstance().appContext.app.config.globalProperties.$t,s=computed(()=>n.isElementOpen(dialogName$8)),w=ref(null),m=ref(!1),v=ref(""),g=ref(null);watch(()=>s.value,(P,S)=>{P&&(w.value=null,m.value=!1)});const d=P=>{P&&(document.body.style.overflow=""),n.closeElement(dialogName$8),v.value=""},f=async()=>{if(!w.value)return;const P=await y();if(!P)return;n.setCommonLoading(!0);const S=P.subject,E=new Date,M=E.getFullYear(),T=E.getMonth()+1<10?`0${E.getMonth()+1}`:E.getMonth()+1,D=E.getDate()<10?`0${E.getDate()}`:E.getDate(),N=E.getHours()<10?`0${E.getHours()}`:E.getHours(),I=E.getMinutes()<10?`0${E.getMinutes()}`:E.getMinutes(),O=E.getSeconds()<10?`0${E.getSeconds()}`:E.getSeconds(),F=`${M}.${T}.${D} ${N}:${I}:${O}`,q=`${u("signatures.appearance.name")}: ${S.CN}
${u("signatures.appearance.date")}: ${F}`,Y=await core.getSignature({rect:{width:582,height:187,top:0,left:0,right:582,bottom:187},content:q,text:S.CN,isDrawLogo:!0,logoBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAYAAACHjumMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAA9kSURBVHgB7d1vbJXlGcfx635KpUWqJWgiZGgxg2ZG52k1pmqmJdYl6kZwW8S5F4hlKvGFmG3RZWYU4wuX7QUsMdpsSn3j3LJMo3FLJobqMmMWpDUuS4BkdpKAyWAFi4JAz737Oj2Hlv45PX+e+/x57u8nOZ4/Lbw4nvPjuq77fp7HSAy67x9tPSWyzhhJpSNzhbGSsmJa3fNWAeqBtSNiZMSk7YfWyLCkZfD9gSUjgrIYKVEmVKLoUTG22/013QIkjBE7bK3dQdiUruiAyQWLFdlChYJgWBmQdHobQVOcogKm64HjWwkWBM1K3/svXrxNUJCCAqbr/tE20xC96sIlJUDorIy4amYN1cz8ovl+oav3sw02ioYIFyDLSJttiIZu7B1dJ8grb8BoS+TieoCWCDifK/1brUSvTnxHMJc5W6TMG2ekTwDkx1xmTrMGjJZ+ms4CoEDm/vdfuOglwXlmBIwOdHXmQlsEFM7NKI+Z8XQHg9/zzZzBRNFuwgUojs5kdKVVcJ7zAiY7d2kTAEXTldauB0b7BOeca5G0NZKG6GMBUDJtlZrH0ysHB5YcE0ypYFgxAsqmrdKpSLYIMjIVDNULEB+qmElR9r/dAiAWVDGTMgFjTPSoAIiPabhVIIb2CPCjaTy9JPQ2KaI9AvxwbVLwB0NGenpLARA7vlsuYGxkrhUAsUtHUZsELnJraisFQOxcBRP8P96RW0K6QgDEznJM3/xntANQGt0PI4EjYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAmwUCFGjZUiOXXRLJMr0tjTLPFy8y0uJu+ppa3DzxHBM6v/+8lTpgjYyIdbe0fOieDcu4DA7fsXlEykTAYAYNiK+uiGTVigZZ7e5XX94gl7lAITiSy1hpc3dtrqfpds8yvU1qV/+wpNM7ygkbAgaZ4PhGxwIXJg1yi7vX6gQwYlMSmZ0TYfP8gJyx24oNGtPVe7wuSjjEq6O9QW7taJROd6+VCvzofLtfksQa0zd820PbCv19AiYguVC586ZG2p0KSVrAZI3YM3ZNIdUMLVLCESrwoM00ypCb0Wwc7nnotXy/SMAkkAbJHS5QbnXzlM52/hfDB9PqZjSvpt7uz9sy8elLEA2We3oaZX3PQqoVVISxts+FjMwVMgRMAugelN61C+UuV7UAlZYJmV39I65demn6z1iPrGMaLM/+ZJH86ZnFhAuqykh6e+ovz7VNf50Kpg5RsaD2uJlMo3nVPeiY+ioVTB3RuUrv2gvkpZ9fSLigBtlU6q3n+qa+QsDUCd1h+9LWC2XT2iYGuKhZxsijqd07W3PPaZFqnLZDT25sYrkZdcK0ytlTW9yDPn1GBVPD1vdMtEOEC+rJ1CqGT24NompBfZusYvgE1xitWnSFiDkL6pkx5la9J2BqRG6FSHfhAgnQrW0SAVMDchvmOA8LEuXMqXUETJXp8vOTG5tpiZA8kUkRMFW0aa3OW5oESCJjbRsBUyVb7l3IvAXJZsy1BEyFaSv0zCPNLEEjAJYhbyXpMPcXLlw4By7CYAiYSmGlCCHi014BhAtCxSfeM8IFIeNT7xHhgtDxyfdEV4t0oEu4IGR8+j352cYmVosQPALGA91Epxc7A0JHwMRsE0dEA+cQMDHSAxc5tgiYRMDEZOIsdM0CYBIBEwNdMdLlaE65AJyPgImBnomO5WhgJr4VZbrz5kaGusAcCJgy6Nxly3qGusBcCJgy6KVFmLsAcyNgSqT7XThpFJAfAVMCbY3uYe4CzIuAKQEXRgMKQ8AUSVeN7rqJ44yAQhAwRdCqZdNaWiOgUARMEdb3NLKhDigC35YC6WCXAxmB4hAwBeqlNQKKRsAUQKsXBrtA8QiYAlC9AKUhYOZB9QKUjoCZB9ULUDoCJg+qF6A8BEweVC9AeQiYPDrbua4RUA4CZg56zBG7doHy8A2aw709FwiA8nDGpFmsXtHAZV8LdPjUmOz53yHZd+Jo5vEhdxs7czpzDxAws7jndqqXfD4YPSS7/zsig+5GkCAfAmYWDHdnGjv7pbx88J/y8icfZR4DhSBgptFwYbg7iWBBOQiYae68mfYoR0Ol/+MPCBaUjICZhvZIMnOVvn8Nyh43awHKQcBMQXtE1YJ4ETBT3NIR9nFHvzrwXiZggLgQMFOE3B5tdS3RG4f3CRAnAiZLj5wOdXPdvf/4o+wfOypA3FiPzVq1Isy3QisXwgW+EDBZIc5f+v+9h7YIXhEwWasDq2Byq0WATwSMTFyxMaT5i+5zIVxQCQSMhDd/+eHeN9jngoogYESCql5edzOXwyc5AhqVQcCI7n8JY7We1giVRsCI7oExEoKXD35E9YKKImAkjBZJq5c3Du0XoJKCDxjdwRsCPTKawS4qjYBZGkZ7xOwF1RB8wFx2SfLbIz2HLrMXVAMVTAAVzOuHmb2gOgiYAGYwe45xZjpUR/AB09Kc7ApGV49oj1AtwQfM4kWSaPvHjghQLVQwi5JdwezjXC+oIiqYRcl+C/SSrkC1EDDNkmiHubQrqogWKeEt0mdnTgtQLRyLlHBUMKgmAgaANwQMAG8IGADeEDAJt6ypRYBqCT5gxr6wkmQXNV4gQLUEHzAnTkqiUcGgmmiREm45AYMqCj5gDh8ZlyRbvXipANVCi/SFJNr1S5YLUC0MeU8me8i7vLmFOQyqhhbpSFqSbs2lbQJUAwFzNNkVjOomYFAlwQfMpwkf8iqdw7QsWChApVHBBFDBqPtWXC1ApREwbgaT9N286r7Lr6GKQcWx0c759GjyB70aLlQxqDQCxtl/MPkBo6hiUGkEjHPgk+QPepWGy4MrOwWoFALGOXAwjIBRP7j863Jd6zIBKoGAEQ2YMFqknG1XraFVQkUQMDJxTphQlquVHj5Aq4RKIGCy3h06IyHRVum+FdcI4BMBkxXKStJUP159k3xrWbsAvhAwWX8LrILJeeqqblndwjlj4AcBk6VzmJBWk6Z65YbvUcnACwJmir37wgwYpZXMgyuvEyBOBMwUoQ16p3v4yuvlR6tuZAkbsSFgptAKJoQDH/PR1aXf3fBdzoKHWBAw0/z5vbCrGKX7ZN68+T7p+1o3QYOyEDDThN4mTbV2ebv8pvPbmf0ytE0ohenqPR52TzCLv/66RVoWGcGkQyfHZM/oIen/+AM5fGpMgEI0fKXzp32C8yy9OJKrr2wQTGppXCjtLZe4Gc01cl32UihjZ0/LCXcD5rJAMIO2Set7uKbzXPQcv7nrLWlls+/EEdk/dtTdH8081+ChyoEiYGahq0l7952VznbenvnoQFhvay5dKZip8+1+CRlD3jm8O3RWAJSHgJmDLleHvicGKBcBMwcNlz/sYoAJlIOAyeP3BAxQFgImD61i3mRnL1AyAmYeL7z+pQAoDQEzD73yoy5ZAygeAVOAp3eeEgDFI2AKoFUMsxigeARMgXQWw74YoDgETIG0imFfDFAcAqYIui/m8NHwLm8ClIqAKYK2SNtfYeALFIqAKZIeBMmyNVAYAqYEumzNwBeYHwFTAh34vsgOX2BeBEyJXnEDX1olID8Cpgy0SkB+BEwZaJWA/AiYMmmrxHljgNkRMDHQwwjYgAfMRMDEQOcwj/zyC+YxwDQETEx0HvP0zpMCYBIBEyPd5csZ8IBJBEzMfusChqEvMIGA8UAPiGQTHkDAePPEsyflwMFxAUJGwHiiK0qPu5Bh+RohI2A80pUlXb4mZBAqAsYzQgYhI2AqgJBBqAiYCsmFDINfhCSyIscEFZELmXeGuMYSwhAZa48LKkZXl3QJm814CEFkjB0WVJxuxuOwAiRdJGkZEVSFHlbw+LMchY3kiqwRKpgq0gMkNzz1OStMSKSoKS2vCapKh78btn3OXAaJEw0OLHGrSGZQUFW5q0bqOWVomZAUE/tg7Pg7gprw5t/PZFomjsZGEmQCxrVJ29kPUzty+2V0lYlqBvUsEzDaJhmb3iGoKbrKpNXMm++xMQ/16dyhAlQxtSlzrt8XT2ZmM6w0od6cCxiqmNqWmc24lSY256GemOkv3Nh7fMhVMilBzVp2SSS9axfKXTc1Cmpb59v9ErIZR1PbxvTdtEq1Ldc2feeJE8xnUNPMbC92PTB6v5hop6AuUNHUrtArGDPXD7o2He8TK1sFdSMXNJ3tDbJsKaf6qQUETB6ETP266+ZGWd+zUFatIGiqiYCZx429o+vSEu10v9gqqDurVjTI+tsvoKqpEgKmAF0Pj7bJmWi3e9gmqFud7QvkTlfZEDaVQ8AUgZYpOTRsbulYkLmnjfKHgClStprpcw83CBJBh8PaSmngrHb3BE58CJgSZYLmtHS7v2KLGHOtIDFaFplM4GjQdLgKZ3kmgAidUhAwMciFjTFRylqru4DbXOhcIUgUndtotXOZuy1bajLPF7swasne9PHi5omAwgQCJnAdu57nfAiAJ9S9ALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANASP2mADwgoAROS4AfBgJPmCsNcMCIH7W/ocKxsiIAIidNWaYgDGWCgbwwX23CJio6TUBEL9IBoMPmOE1G3UVaVAAxGl4eM1mhrzKWvuOAIiNNXaH3hMwakHTdvbDADGKJroCAkYm2iRrZYcAKJsxMqDtkT4mYHKoYoBYpCO7LfeYgMmiigHKZ6zdlqteMs8F5+nY1T/kKpmUACiOkZGh2x5eOfUlKphpbEP6bloloEjGHrORXTP9ZQJmGi3vrJHHBEDBrI02Tm2NcgiYWQzftnlAe0kBMK/M3KXnoVl3xDODyaPzref6rDFbBcCsNFz23r65b86fC/JK7epfZyS9071VrQJggpu5mHF5bO83Nw/k/TXBvFK7n2szabNbrLQJEDwzrIshs81cZvymoGC0TAiaVi1p2ZGvJZrxRwRFyVQz49Ln3roNAoQgGyzpBU3bs2cfKPyPCkqiQSNp6TbWbHFPrxUgaax9xwXEYCnBkkPAxCAXNpE1KWttyr2rbe6tvUKAeuAqFDdfPO5uw8aYkbSe5TFqeq3UUJnq/zPmsRQ9GquGAAAAAElFTkSuQmCC"});n.setCertSubject(S),n.setDigitalSignaturePreview(Y),n.setCommonLoading(!1),d(),n.openElement("signatureAppearanceDialog")},y=async()=>{const P=new FileReader,E=await new Promise((T,D)=>{P.addEventListener("load",async N=>{T(new Uint8Array(N.target.result))}),P.addEventListener("error",()=>{D("Error reading the local certificate")}),P.readAsArrayBuffer(w.value)}),M=await core.loadCertificates({pkcs12Buffer:E,password:v.value});return m.value=!M,M&&o.setPkcs12({pkcs12Buffer:E,password:v.value}),M},x=()=>{g.value.click()},k=P=>{const S=P.target.files[0],E=S==null?void 0:S.name.split(".").pop().toLowerCase();E!=="pfx"&&E!=="p12"||(w.value=S,g.value.value="")};return(P,S)=>{const E=__unplugin_components_0$v,M=_sfc_main$4v;return s.value?(openBlock(),createElementBlock("div",_hoisted_1$1Q,[createVNode(M,{show:s.value,dialogName:dialogName$8,close:!0,onMousedown:S[3]||(S[3]=withModifiers(()=>{},["stop"]))},{header:withCtx(()=>[createTextVNode(toDisplayString(unref(u)("signatures.digitalDialog.title")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:S[2]||(S[2]=T=>d("cancel"))},toDisplayString(unref(u)("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:f},toDisplayString(unref(u)("common.actions.continue")),1)]),default:withCtx(()=>{var T,D;return[createBaseVNode("p",null,toDisplayString(unref(u)("signatures.digitalDialog.description")),1),createBaseVNode("div",_hoisted_2$1F,[createBaseVNode("span",null,toDisplayString(unref(u)("signatures.digitalDialog.certificateFile")),1),createBaseVNode("div",_hoisted_3$1t,[createBaseVNode("div",{class:"file-input-underbox",onClick:x},[createBaseVNode("span",{class:normalizeClass({uploaded:(T=w.value)==null?void 0:T.name})},toDisplayString(((D=w.value)==null?void 0:D.name)||unref(u)("signatures.digitalDialog.uploadFile")),3),createBaseVNode("span",_hoisted_4$A,[createVNode(E)])]),createBaseVNode("input",{ref_key:"uploadFileEl",ref:g,type:"file",onChange:k,accept:".pfx,.p12",name:"digital-signature"},null,544)])]),createBaseVNode("div",_hoisted_5$o,[createBaseVNode("span",null,toDisplayString(unref(u)("signatures.digitalDialog.password")),1),createBaseVNode("div",null,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":S[0]||(S[0]=N=>v.value=N),type:"password",placeholder:unref(u)("signatures.digitalDialog.enterPassword"),onInput:S[1]||(S[1]=N=>m.value&&(m.value=!1)),name:"digital-signature"},null,40,_hoisted_6$i),[[vModelText,v.value]]),m.value?(openBlock(),createElementBlock("p",_hoisted_7$e,toDisplayString(unref(u)("signatures.digitalDialog.invalidPassword")),1)):createCommentVNode("",!0)])])]}),_:1},8,["show"])])):createCommentVNode("",!0)}}},_hoisted_1$1P={key:0,class:"delete-page-popup"},dialogName$7="deleteConfirmDialog",_sfc_main$27={__name:"DeleteSignatureDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$7)),u=computed(()=>o.getSelectedSignature),s=()=>{n.closeElement(dialogName$7),o.setSelectedSignature(null)},w=()=>{core.deleteSignature(JSON.parse(JSON.stringify(u.value))),s(),n.setSignatureVerify(0)};return(m,v)=>{const g=__unplugin_components_2$f,d=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$1P,[createVNode(d,{show:r.value,dialogName:dialogName$7},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:s},toDisplayString(m.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:w},toDisplayString(m.$t("common.actions.ok")),1)]),default:withCtx(()=>[createVNode(g),createBaseVNode("p",null,toDisplayString(m.$t("signatures.deleteConfirm")),1)]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$26={},_hoisted_1$1O={width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1E=createBaseVNode("path",{d:"M17.5 10.5C17.5 14.6421 14.1421 18 10 18C5.85786 18 2.5 14.6421 2.5 10.5C2.5 6.35786 5.85786 3 10 3C14.1421 3 17.5 6.35786 17.5 10.5Z",fill:"#FF6666"},null,-1),_hoisted_3$1s=createBaseVNode("path",{d:"M12 8.5L8 12.5",stroke:"white","stroke-width":"1.5","stroke-linecap":"square","stroke-linejoin":"round"},null,-1),_hoisted_4$z=createBaseVNode("path",{d:"M8 8.5L12 12.5",stroke:"white","stroke-width":"1.5","stroke-linecap":"square","stroke-linejoin":"round"},null,-1),_hoisted_5$n=[_hoisted_2$1E,_hoisted_3$1s,_hoisted_4$z];function _sfc_render$14(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1O,_hoisted_5$n)}const __unplugin_components_1$3=_export_sfc(_sfc_main$26,[["render",_sfc_render$14]]),_sfc_main$25={},_hoisted_1$1N={width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1D=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 18C14.1421 18 17.5 14.6421 17.5 10.5C17.5 6.35786 14.1421 3 10 3C5.85786 3 2.5 6.35786 2.5 10.5C2.5 14.6421 5.85786 18 10 18ZM9.74283 13.4801L13.9095 8.48014L12.7572 7.51986L9.11627 11.8889L7.197 9.96967L6.13634 11.0303L8.63634 13.5303L9.21707 14.1111L9.74283 13.4801Z",fill:"#3CCD75"},null,-1),_hoisted_3$1r=[_hoisted_2$1D];function _sfc_render$13(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1N,_hoisted_3$1r)}const __unplugin_components_0$i=_export_sfc(_sfc_main$25,[["render",_sfc_render$13]]),CertificationViewerDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1M={key:0,class:"certification-details-dialog"},_hoisted_2$1C={class:"title"},_hoisted_3$1q={class:"desc"},_hoisted_4$y={class:"container"},_hoisted_5$m={class:"left"},_hoisted_6$h=["onFocus"],_hoisted_7$d={class:"right"},_hoisted_8$b={class:"tabs"},_hoisted_9$b={class:"panel"},_hoisted_10$a={class:"summary"},_hoisted_11$7={class:"title"},_hoisted_12$6={class:"info"},_hoisted_13$6={class:"abstracts"},_hoisted_14$6=createBaseVNode("span",null,"Digital Signature, Non-Repudiation",-1),_hoisted_15$6={class:"details"},_hoisted_16$5={class:"trust"},_hoisted_17$4={class:"trust-button"},dialogName$6="certificateViewerDialog",_sfc_main$24={__name:"CertificationViewerDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$6)),u=computed(()=>o.getSelectedSignature),s=computed(()=>u.value.signerList[0].certificateList[m.value]),w=ref(1),m=ref(0),v=()=>{n.closeElement(dialogName$6)},g=f=>{let y=f.slice(0,4),x=f.slice(4,6),k=f.slice(6,8),P=f.slice(8,10),S=f.slice(10,12),E=f.slice(12,14);return`${y}/${x}/${k} ${P}:${S}:${E}`},d=()=>{if(s.value.isTrusted)return;const f=core.addToTrustedCertificateLists(m.value);s.value.isTrusted=!!f,f&&o.setTrustedCertificateLists(f)};return(f,y)=>{const x=__unplugin_components_0$i,k=__unplugin_components_1$3,P=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$1M,[createVNode(P,{show:r.value,dialogName:dialogName$6},{header:withCtx(()=>[createBaseVNode("p",_hoisted_2$1C,toDisplayString(f.$t("signatures.certificateViewer.title")),1),createBaseVNode("p",_hoisted_3$1q,toDisplayString(f.$t("signatures.certificateViewer.title")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button blue",onClick:v},toDisplayString(f.$t("signatures.certificateViewer.trust.done")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_4$y,[createBaseVNode("div",_hoisted_5$m,[(openBlock(!0),createElementBlock(Fragment,null,renderList(u.value.signerList,(S,E)=>(openBlock(),createElementBlock("p",{key:E,class:normalizeClass({highlighted:m.value===E}),onFocus:M=>m.value=E,onBlur:y[0]||(y[0]=M=>m.value=0),tabindex:"-1"},toDisplayString(S.certificateList[0].subject.CN),43,_hoisted_6$h))),128))]),createBaseVNode("div",_hoisted_7$d,[createBaseVNode("div",_hoisted_8$b,[createBaseVNode("div",{onClick:y[1]||(y[1]=S=>w.value=1),class:normalizeClass({active:w.value===1})},toDisplayString(f.$t("signatures.certificateViewer.abstracts")),3),createBaseVNode("div",{onClick:y[2]||(y[2]=S=>w.value=2),class:normalizeClass({active:w.value===2})},toDisplayString(f.$t("signatures.certificateViewer.details.title")),3),createBaseVNode("div",{onClick:y[3]||(y[3]=S=>w.value=3),class:normalizeClass({active:w.value===3})},toDisplayString(f.$t("signatures.certificateViewer.trust.title")),3)]),createBaseVNode("div",_hoisted_9$b,[createBaseVNode("div",_hoisted_10$a,[createBaseVNode("div",_hoisted_11$7,toDisplayString(w.value===3?f.$t("signatures.certificateViewer.trust.sign"):f.$t("signatures.certificateViewer.summary")),1),createBaseVNode("div",_hoisted_12$6,[withDirectives(createBaseVNode("div",_hoisted_13$6,[createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.issuedTo"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.issuer.CN)+" <"+toDisplayString(s.value.issuer.email)+">",1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.issuer"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.issuer.CN),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.validFrom"))+" ",1),createBaseVNode("span",null,toDisplayString(g(s.value.validDateStart)),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.validTo"))+" ",1),createBaseVNode("span",null,toDisplayString(g(s.value.validDateEnd)),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.intendedUsage"))+" ",1),_hoisted_14$6])],512),[[vShow,w.value===1]]),withDirectives(createBaseVNode("div",_hoisted_15$6,[createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.version"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.version),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.algorithm"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.signAlgOidType)+" ("+toDisplayString(s.value.signAlgOid)+")",1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.subject"))+" ",1),createBaseVNode("span",null,"C="+toDisplayString(s.value.subject.C)+",ST="+toDisplayString(s.value.subject.ST)+",L="+toDisplayString(s.value.subject.L)+",O="+toDisplayString(s.value.subject.O)+",OU="+toDisplayString(s.value.subject.OU)+",CN="+toDisplayString(s.value.subject.CN)+",emailAddress="+toDisplayString(s.value.subject.email),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.issuer"))+" ",1),createBaseVNode("span",null,"C="+toDisplayString(s.value.issuer.C)+",ST="+toDisplayString(s.value.issuer.ST)+",L="+toDisplayString(s.value.issuer.L)+",O="+toDisplayString(s.value.issuer.O)+",OU="+toDisplayString(s.value.issuer.OU)+",CN="+toDisplayString(s.value.issuer.CN)+",emailAddress="+toDisplayString(s.value.issuer.email),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.serialNumber"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.serialNumber),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.validFrom"))+" ",1),createBaseVNode("span",null,toDisplayString(g(s.value.validDateStart)),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.validTo"))+" ",1),createBaseVNode("span",null,toDisplayString(g(s.value.validDateEnd)),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.certificatePolicy"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.certificatePolicies[0]),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.crlDistribution"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.CRLDistributionPoints),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.issuerInfoAccess"))+" ",1),(openBlock(!0),createElementBlock(Fragment,null,renderList(s.value.sccessInfo,(S,E)=>(openBlock(),createElementBlock("span",{key:E},toDisplayString(S.Key)+"="+toDisplayString(S.AccessInfo)+toDisplayString(E===s.value.sccessInfo.length-1?"":","),1))),128))]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.issuerKeyIdentifier"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.authorityKeyIdentifier),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.subjectKeyIdentifier"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.subjectKeyIdentifier),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.constraints"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.basicConstraints),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.keyUsage"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.keyUsage),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.publicKey"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.publicKey),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.x509"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.X509Data),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.sha1Digests"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.SHA1Digest),1)]),createBaseVNode("p",null,[createTextVNode(toDisplayString(f.$t("signatures.certificateViewer.details.md5Digests"))+" ",1),createBaseVNode("span",null,toDisplayString(s.value.MD5Digest),1)])],512),[[vShow,w.value===2]]),withDirectives(createBaseVNode("div",_hoisted_16$5,[createBaseVNode("p",null,[s.value.isTrusted?(openBlock(),createBlock(x,{key:0})):(openBlock(),createBlock(k,{key:1})),createBaseVNode("span",null,toDisplayString(f.$t("signatures.certificateViewer.trust.sign")),1)]),createBaseVNode("p",null,[s.value.isTrusted?(openBlock(),createBlock(x,{key:0})):(openBlock(),createBlock(k,{key:1})),createBaseVNode("span",null,toDisplayString(f.$t("signatures.certificateViewer.trust.certify")),1)])],512),[[vShow,w.value===3]])]),withDirectives(createBaseVNode("div",_hoisted_17$4,[createBaseVNode("div",{class:normalizeClass(s.value.isTrusted&&"disabled"),onClick:d},toDisplayString(f.$t("signatures.certificateViewer.trust.addToTrust")),3)],512),[[vShow,w.value===3]])])])])])]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$23={},_hoisted_1$1L={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1B=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.15125 14.4995C8.30837 14.4995 9.2063 13.7913 9.7756 12.6064H16.4175C16.6582 12.6064 16.8433 12.4074 16.8433 12.1713C16.8433 11.9353 16.6582 11.7409 16.4175 11.7409H10.1089C10.3264 11.0327 10.4514 10.2135 10.4838 9.31556C10.7754 9.25076 11.0762 9.21836 11.3863 9.21836C11.4928 9.21836 11.5483 9.26465 11.5483 9.3387C11.5483 9.68584 11.3169 9.98207 11.3169 10.431C11.3169 10.8476 11.6224 11.1207 12.0528 11.1207C13.0572 11.1207 14.256 9.5655 14.5568 9.5655C14.816 9.5655 14.5661 10.9309 15.7464 10.9309C15.9824 10.9309 16.2601 10.8661 16.4684 10.7273C16.6212 10.6208 16.7276 10.4681 16.7276 10.269C16.7276 10.0098 16.5517 9.77841 16.2786 9.77841C16.1305 9.77841 15.9963 9.88024 15.8852 9.88024C15.5288 9.88024 15.876 8.38986 14.8346 8.38986C13.9783 8.38986 12.8628 9.75527 12.599 9.75527C12.5573 9.75527 12.5342 9.73676 12.5342 9.69047C12.5342 9.5655 12.636 9.36185 12.636 9.13968C12.636 8.54723 12.2102 8.20009 11.5205 8.20009C11.1595 8.20009 10.8078 8.23249 10.4699 8.29266C10.2986 5.78865 9.0443 3.93262 7.26696 3.93262C5.91544 3.93262 4.97122 4.96014 4.97122 6.39035C4.97122 7.95941 5.96635 9.26465 7.04479 10.1209C6.54028 10.6301 6.14686 11.1901 5.90155 11.7409H2.856C2.61532 11.7409 2.43018 11.9353 2.43018 12.1713C2.43018 12.4028 2.61994 12.6064 2.856 12.6064H5.64235C5.62847 12.7221 5.61921 12.8378 5.61921 12.9443C5.61921 13.8978 6.15612 14.4995 7.15125 14.4995ZM7.81306 9.45897C6.93828 8.78784 5.99406 7.74643 5.99406 6.38565C5.99406 5.55715 6.51708 4.95544 7.27153 4.95544C8.50271 4.95544 9.38213 6.50599 9.46544 8.56567C8.85911 8.78784 8.29906 9.09795 7.81306 9.45897ZM3.15682 10.9678L3.67521 10.4494L4.1936 10.9631C4.35097 11.1159 4.5824 11.1159 4.73977 10.9631C4.89251 10.8104 4.89251 10.5697 4.73977 10.417L4.22137 9.90321L4.73977 9.38482C4.89251 9.23208 4.89251 8.99602 4.73977 8.84328C4.58703 8.68591 4.34634 8.68591 4.1936 8.83865L3.67521 9.35705L3.15682 8.84328C2.99945 8.69054 2.7634 8.69054 2.61066 8.84328C2.45329 8.99139 2.45329 9.2367 2.61066 9.38945L3.12442 9.90321L2.61066 10.417C2.45329 10.5743 2.45792 10.8058 2.61066 10.9631C2.7634 11.1205 3.00408 11.1159 3.15682 10.9678ZM9.01653 11.7409H7.07256C7.28084 11.3984 7.5678 11.0374 7.91957 10.7041C7.99826 10.7504 8.07231 10.7875 8.14637 10.8245C8.23894 10.8754 8.32688 10.8939 8.41482 10.8939C8.67402 10.8939 8.89156 10.7041 8.89156 10.4542C8.89156 10.3153 8.84064 10.1858 8.71567 10.0747C8.94247 9.92193 9.18315 9.78307 9.44235 9.66736C9.38218 10.4496 9.23406 11.1531 9.01653 11.7409ZM7.27156 13.481C6.88739 13.481 6.69299 13.231 6.69299 12.8423C6.69299 12.7682 6.70225 12.6895 6.71614 12.6062H8.59068C8.22965 13.1616 7.77606 13.481 7.27156 13.481Z",fill:"currentColor"},null,-1),_hoisted_3$1p=createBaseVNode("rect",{x:"10.625",y:"10.625",width:"7.5",height:"7.5",rx:"3.64583",fill:"#FFA400"},null,-1),_hoisted_4$x=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.625 15.247V15.3482H13.9881V15.247C13.9881 15.0268 14.0238 14.8363 14.1071 14.6815C14.1845 14.5149 14.4107 14.2708 14.7798 13.9435L14.881 13.8304C14.9881 13.6935 15.0476 13.5506 15.0476 13.3958C15.0476 13.1875 14.9881 13.0268 14.875 12.9077C14.756 12.7887 14.5833 12.7292 14.369 12.7292C14.1012 12.7292 13.9048 12.8125 13.7857 12.9851C13.6786 13.128 13.625 13.3304 13.625 13.5923H13C13 13.1577 13.125 12.8185 13.375 12.5685C13.625 12.3125 13.9702 12.1875 14.4107 12.1875C14.7917 12.1875 15.1012 12.2887 15.3393 12.503C15.5774 12.7113 15.6964 12.997 15.6964 13.3542C15.6964 13.6458 15.619 13.8899 15.4702 14.0804C15.4167 14.1458 15.25 14.3006 14.9702 14.5446C14.8571 14.6399 14.7738 14.747 14.7202 14.8542C14.6548 14.9732 14.625 15.1042 14.625 15.247ZM14.6131 16.4017C14.5298 16.4791 14.4227 16.5207 14.3036 16.5207C14.1846 16.5207 14.0774 16.4791 13.9941 16.3957C13.9108 16.3124 13.8691 16.2112 13.8691 16.0922C13.8691 15.9672 13.9108 15.866 13.9941 15.7886C14.0774 15.7053 14.1846 15.6696 14.3036 15.6696C14.4286 15.6696 14.5358 15.7053 14.6191 15.7886C14.7024 15.866 14.7441 15.9672 14.7441 16.0922C14.7441 16.2172 14.6965 16.3184 14.6131 16.4017Z",fill:"white"},null,-1),_hoisted_5$l=[_hoisted_2$1B,_hoisted_3$1p,_hoisted_4$x];function _sfc_render$12(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1L,_hoisted_5$l)}const __unplugin_components_2$b=_export_sfc(_sfc_main$23,[["render",_sfc_render$12]]),_sfc_main$22={},_hoisted_1$1K={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1A=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.15125 14.4995C8.30837 14.4995 9.2063 13.7913 9.7756 12.6064H16.4175C16.6582 12.6064 16.8433 12.4074 16.8433 12.1713C16.8433 11.9353 16.6582 11.7409 16.4175 11.7409H10.1089C10.3264 11.0327 10.4514 10.2135 10.4838 9.31556C10.7754 9.25076 11.0762 9.21836 11.3863 9.21836C11.4928 9.21836 11.5483 9.26465 11.5483 9.3387C11.5483 9.68584 11.3169 9.98207 11.3169 10.431C11.3169 10.8476 11.6224 11.1207 12.0528 11.1207C13.0572 11.1207 14.256 9.5655 14.5568 9.5655C14.816 9.5655 14.5661 10.9309 15.7464 10.9309C15.9824 10.9309 16.2601 10.8661 16.4684 10.7273C16.6212 10.6208 16.7276 10.4681 16.7276 10.269C16.7276 10.0098 16.5517 9.77841 16.2786 9.77841C16.1305 9.77841 15.9963 9.88024 15.8852 9.88024C15.5288 9.88024 15.876 8.38986 14.8346 8.38986C13.9783 8.38986 12.8628 9.75527 12.599 9.75527C12.5573 9.75527 12.5342 9.73676 12.5342 9.69047C12.5342 9.5655 12.636 9.36185 12.636 9.13968C12.636 8.54723 12.2102 8.20009 11.5205 8.20009C11.1595 8.20009 10.8078 8.23249 10.4699 8.29266C10.2986 5.78865 9.0443 3.93262 7.26696 3.93262C5.91544 3.93262 4.97122 4.96014 4.97122 6.39035C4.97122 7.95941 5.96635 9.26465 7.04479 10.1209C6.54028 10.6301 6.14686 11.1901 5.90155 11.7409H2.856C2.61532 11.7409 2.43018 11.9353 2.43018 12.1713C2.43018 12.4028 2.61994 12.6064 2.856 12.6064H5.64235C5.62847 12.7221 5.61921 12.8378 5.61921 12.9443C5.61921 13.8978 6.15612 14.4995 7.15125 14.4995ZM7.81306 9.45897C6.93828 8.78784 5.99406 7.74643 5.99406 6.38565C5.99406 5.55715 6.51708 4.95544 7.27153 4.95544C8.50271 4.95544 9.38213 6.50599 9.46544 8.56567C8.85911 8.78784 8.29906 9.09795 7.81306 9.45897ZM3.15682 10.9678L3.67521 10.4494L4.1936 10.9631C4.35097 11.1159 4.5824 11.1159 4.73977 10.9631C4.89251 10.8104 4.89251 10.5697 4.73977 10.417L4.22137 9.90321L4.73977 9.38482C4.89251 9.23208 4.89251 8.99602 4.73977 8.84328C4.58703 8.68591 4.34634 8.68591 4.1936 8.83865L3.67521 9.35705L3.15682 8.84328C2.99945 8.69054 2.7634 8.69054 2.61066 8.84328C2.45329 8.99139 2.45329 9.2367 2.61066 9.38945L3.12442 9.90321L2.61066 10.417C2.45329 10.5743 2.45792 10.8058 2.61066 10.9631C2.7634 11.1205 3.00408 11.1159 3.15682 10.9678ZM9.01653 11.7409H7.07256C7.28084 11.3984 7.5678 11.0374 7.91957 10.7041C7.99826 10.7504 8.07231 10.7875 8.14637 10.8245C8.23894 10.8754 8.32688 10.8939 8.41482 10.8939C8.67402 10.8939 8.89156 10.7041 8.89156 10.4542C8.89156 10.3153 8.84064 10.1858 8.71567 10.0747C8.94247 9.92193 9.18315 9.78307 9.44235 9.66736C9.38218 10.4496 9.23406 11.1531 9.01653 11.7409ZM7.27156 13.481C6.88739 13.481 6.69299 13.231 6.69299 12.8423C6.69299 12.7682 6.70225 12.6895 6.71614 12.6062H8.59068C8.22965 13.1616 7.77606 13.481 7.27156 13.481Z",fill:"currentColor"},null,-1),_hoisted_3$1o=createBaseVNode("rect",{x:"10.625",y:"10.625",width:"7.5",height:"7.5",rx:"3.64583",fill:"#BF3030"},null,-1),_hoisted_4$w=createBaseVNode("path",{d:"M15.625 13.125L13.125 15.625",stroke:"white","stroke-width":"0.9375","stroke-linecap":"square","stroke-linejoin":"round"},null,-1),_hoisted_5$k=createBaseVNode("path",{d:"M13.125 13.125L15.625 15.625",stroke:"white","stroke-width":"0.9375","stroke-linecap":"square","stroke-linejoin":"round"},null,-1),_hoisted_6$g=[_hoisted_2$1A,_hoisted_3$1o,_hoisted_4$w,_hoisted_5$k];function _sfc_render$11(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1K,_hoisted_6$g)}const __unplugin_components_1$2=_export_sfc(_sfc_main$22,[["render",_sfc_render$11]]),_sfc_main$21={},_hoisted_1$1J={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.15125 14.4995C8.30837 14.4995 9.2063 13.7913 9.7756 12.6064H16.4175C16.6582 12.6064 16.8433 12.4074 16.8433 12.1713C16.8433 11.9353 16.6582 11.7409 16.4175 11.7409H10.1089C10.3264 11.0327 10.4514 10.2135 10.4838 9.31556C10.7754 9.25076 11.0762 9.21836 11.3863 9.21836C11.4928 9.21836 11.5483 9.26465 11.5483 9.3387C11.5483 9.68584 11.3169 9.98207 11.3169 10.431C11.3169 10.8476 11.6224 11.1207 12.0528 11.1207C13.0572 11.1207 14.256 9.5655 14.5568 9.5655C14.816 9.5655 14.5661 10.9309 15.7464 10.9309C15.9824 10.9309 16.2601 10.8661 16.4684 10.7273C16.6212 10.6208 16.7276 10.4681 16.7276 10.269C16.7276 10.0098 16.5517 9.77841 16.2786 9.77841C16.1305 9.77841 15.9963 9.88024 15.8852 9.88024C15.5288 9.88024 15.876 8.38986 14.8346 8.38986C13.9783 8.38986 12.8628 9.75527 12.599 9.75527C12.5573 9.75527 12.5342 9.73676 12.5342 9.69047C12.5342 9.5655 12.636 9.36185 12.636 9.13968C12.636 8.54723 12.2102 8.20009 11.5205 8.20009C11.1595 8.20009 10.8078 8.23249 10.4699 8.29266C10.2986 5.78865 9.0443 3.93262 7.26696 3.93262C5.91544 3.93262 4.97122 4.96014 4.97122 6.39035C4.97122 7.95941 5.96635 9.26465 7.04479 10.1209C6.54028 10.6301 6.14686 11.1901 5.90155 11.7409H2.856C2.61532 11.7409 2.43018 11.9353 2.43018 12.1713C2.43018 12.4028 2.61994 12.6064 2.856 12.6064H5.64235C5.62847 12.7221 5.61921 12.8378 5.61921 12.9443C5.61921 13.8978 6.15612 14.4995 7.15125 14.4995ZM7.81306 9.45897C6.93828 8.78784 5.99406 7.74643 5.99406 6.38565C5.99406 5.55715 6.51708 4.95544 7.27153 4.95544C8.50271 4.95544 9.38213 6.50599 9.46544 8.56567C8.85911 8.78784 8.29906 9.09795 7.81306 9.45897ZM3.15682 10.9678L3.67521 10.4494L4.1936 10.9631C4.35097 11.1159 4.5824 11.1159 4.73977 10.9631C4.89251 10.8104 4.89251 10.5697 4.73977 10.417L4.22137 9.90321L4.73977 9.38482C4.89251 9.23208 4.89251 8.99602 4.73977 8.84328C4.58703 8.68591 4.34634 8.68591 4.1936 8.83865L3.67521 9.35705L3.15682 8.84328C2.99945 8.69054 2.7634 8.69054 2.61066 8.84328C2.45329 8.99139 2.45329 9.2367 2.61066 9.38945L3.12442 9.90321L2.61066 10.417C2.45329 10.5743 2.45792 10.8058 2.61066 10.9631C2.7634 11.1205 3.00408 11.1159 3.15682 10.9678ZM9.01653 11.7409H7.07256C7.28084 11.3984 7.5678 11.0374 7.91957 10.7041C7.99826 10.7504 8.07231 10.7875 8.14637 10.8245C8.23894 10.8754 8.32688 10.8939 8.41482 10.8939C8.67402 10.8939 8.89156 10.7041 8.89156 10.4542C8.89156 10.3153 8.84064 10.1858 8.71567 10.0747C8.94247 9.92193 9.18315 9.78307 9.44235 9.66736C9.38218 10.4496 9.23406 11.1531 9.01653 11.7409ZM7.27156 13.481C6.88739 13.481 6.69299 13.231 6.69299 12.8423C6.69299 12.7682 6.70225 12.6895 6.71614 12.6062H8.59068C8.22965 13.1616 7.77606 13.481 7.27156 13.481Z",fill:"currentColor"},null,-1),_hoisted_3$1n=createBaseVNode("rect",{x:"10.625",y:"10.625",width:"7.5",height:"7.5",rx:"3.64583",fill:"#30BF83"},null,-1),_hoisted_4$v=createBaseVNode("path",{d:"M12.8125 14.6875L14.2969 15.625L16.25 13.125",stroke:"white","stroke-width":"0.9375"},null,-1),_hoisted_5$j=[_hoisted_2$1z,_hoisted_3$1n,_hoisted_4$v];function _sfc_render$10(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1J,_hoisted_5$j)}const __unplugin_components_0$h=_export_sfc(_sfc_main$21,[["render",_sfc_render$10]]),SignatureDetailsDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1I={key:0,class:"signature-details-dialog"},_hoisted_2$1y={class:"info"},_hoisted_3$1m={class:"title"},_hoisted_4$u={class:"desc"},_hoisted_5$i={class:"summary"},_hoisted_6$f={class:"title"},_hoisted_7$c=createBaseVNode("div",{class:"line-left"},null,-1),_hoisted_8$a=createBaseVNode("div",{class:"line-right"},null,-1),_hoisted_9$a={class:"content"},_hoisted_10$9={key:3},dialogName$5="signatureDetailsDialog",_sfc_main$20={__name:"SignatureDetailsDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$5)),u=computed(()=>o.getSelectedSignature),s=computed(()=>{const v=u.value.signerList[0].certificateList[0].validDateEnd,g=v.substring(0,4),d=v.substring(4,6),f=v.substring(6,8),y=v.substring(8,10),x=v.substring(10,12),k=v.substring(12,14),P=v.substring(14);return new Date(`${g}-${d}-${f}T${y}:${x}:${k}${P}`)<new Date}),w=()=>{n.closeElement(dialogName$5)},m=()=>{w(),n.openElement("certificateViewerDialog")};return(v,g)=>{const d=__unplugin_components_0$y,f=__unplugin_components_0$h,y=__unplugin_components_1$2,x=__unplugin_components_2$b,k=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$1I,[createVNode(k,{show:r.value,dialogName:dialogName$5},{header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.title")),1),createVNode(d,{class:"close",onClick:w})]),footer:withCtx(()=>[createBaseVNode("div",{class:"view-button",onClick:m},toDisplayString(v.$t("signatures.details.viewCertificate")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1y,[u.value.signerList[0].isCertTrusted&&u.value.signerList[0].isSignVerified?(openBlock(),createBlock(f,{key:0})):u.value.signerList[0].isCertTrusted||u.value.signerList[0].isSignVerified?(openBlock(),createBlock(y,{key:1})):(openBlock(),createBlock(x,{key:2})),createBaseVNode("div",null,[createBaseVNode("p",_hoisted_3$1m,toDisplayString(v.$t("signatures.details.signer"))+' "'+toDisplayString(u.value.signerList[0].certificateList[0].subject.CN)+toDisplayString(u.value.signerList[0].certificateList[0].subject.email?"<"+u.value.signerList[0].certificateList[0].subject.email+">":"")+'"',1),createBaseVNode("p",_hoisted_4$u,toDisplayString(v.$t("signatures.details.signingTime"))+" "+toDisplayString(unref(dayjs)(u.value.date).format("YYYY-MM-DD HH:mm:ss")),1)])]),createBaseVNode("div",_hoisted_5$i,[createBaseVNode("div",_hoisted_6$f,[_hoisted_7$c,createBaseVNode("span",null,toDisplayString(v.$t("signatures.details.validitySummary")),1),_hoisted_8$a]),createBaseVNode("div",_hoisted_9$a,[!u.value.signerList[0].isCertTrusted&&!u.value.signerList[0].isSignVerified?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.invalidIdentity")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.invalidSignature")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.altered")),1)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[u.value.signerList[0].isCertTrusted&&u.value.signerList[0].isSignVerified?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.validIdentity")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.validSignature")),1)],64)):!u.value.signerList[0].isCertTrusted&&u.value.signerList[0].isSignVerified?(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.invalidIdentity")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.validSignature")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.unknownIdentity")),1)],64)):u.value.signerList[0].isCertTrusted&&!u.value.signerList[0].isSignVerified?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.validIdentity")),1),createBaseVNode("p",null,toDisplayString(v.$t("signatures.details.invalidSignature")),1)],64)):createCommentVNode("",!0),s.value?(openBlock(),createElementBlock("p",_hoisted_10$9,toDisplayString(v.$t("signatures.details.expiredCertificate")),1)):createCommentVNode("",!0),createBaseVNode("p",null,toDisplayString(u.value.signerList[0].diffInfo.length?v.$t("signatures.details.altered"):v.$t("signatures.details.notModified")),1)],64))])])]),_:1},8,["show"])])):createCommentVNode("",!0)}}},DigitalKeyboardCreatePanel_vue_vue_type_style_index_0_lang="",_hoisted_1$1H={class:"paint-container"},_hoisted_2$1x={class:"keyboard-paint",style:{}},_hoisted_3$1l=["placeholder"],dialogName$4="digitalKeyboardCreatePanel",_sfc_main$1$={__name:"DigitalKeyboardCreatePanel",props:["text"],emits:["modifyText"],setup(e,{emit:n}){const{text:o}=e,r=n,u=ref(o),s=useViewerStore();computed(()=>s.isElementOpen(dialogName$4));const w=()=>{s.closeElement(dialogName$4),m()},m=()=>{u.value=""},v=()=>{r("modifyText",u.value),w()};return(g,d)=>{const f=__unplugin_components_0$y,y=_sfc_main$4v;return openBlock(),createBlock(y,{class:"digital-signature-dialog keyboard",show:!0,dialogName:dialogName$4},{header:withCtx(()=>[createVNode(f,{class:"close",onClick:w})]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:m},toDisplayString(g.$t("common.actions.clear")),1),createBaseVNode("div",{class:"rect-button white",onClick:w},toDisplayString(g.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:v},toDisplayString(g.$t("common.actions.ok")),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1H,[createBaseVNode("div",_hoisted_2$1x,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":d[0]||(d[0]=x=>u.value=x),type:"text",placeholder:g.$t("signatures.appearance.signHere"),name:"signature"},null,8,_hoisted_3$1l),[[vModelText,u.value]])])])]),_:1})}}},DigitalSignCreatePanel_vue_vue_type_style_index_0_lang="",_hoisted_1$1G=["width","height"],dialogName$3="digitalSignCreatePanel",_sfc_main$1_={__name:"DigitalSignCreatePanel",emits:["modifyImage"],setup(e,{emit:n}){const o=n,r=useViewerStore();useDocumentStore();const u=computed(()=>r.isElementOpen(dialogName$3)),s=ref(578),w=ref(isMobile?0:270),m=ref();watch(()=>u.value,(f,y)=>{f&&isMobile&&nextTick(()=>{const{clientWidth:x,clientHeight:k}=m.value;x&&s.value!==x&&(s.value=x),k&&w.value!==k&&(w.value=k)})});const v=()=>{r.closeElement(dialogName$3),g()},g=()=>{core.handleSign({flag:"clear"})},d=async()=>{const f=await core.handleSign({type:1,flag:"image"});o("modifyImage",f),v()};return(f,y)=>{const x=__unplugin_components_0$y,k=_sfc_main$4v;return openBlock(),createBlock(k,{class:"digital-signature-dialog trackpad",show:!0,dialogName:dialogName$3},{header:withCtx(()=>[createVNode(x,{class:"close",onClick:v})]),footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:g},toDisplayString(f.$t("common.actions.clear")),1),createBaseVNode("div",{class:"rect-button white",onClick:v},toDisplayString(f.$t("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:d},toDisplayString(f.$t("common.actions.ok")),1)]),default:withCtx(()=>[createBaseVNode("div",{class:"paint-container",ref_key:"paintContainer",ref:m},[createBaseVNode("canvas",{id:"digitalTrackpadCanvas",width:s.value,height:w.value},null,8,_hoisted_1$1G)],512)]),_:1})}}},SignatureAppearanceDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1F={class:"sign-content"},_hoisted_2$1w={class:"sign-popup-header"},_hoisted_3$1k={key:0,class:"signatures-popup-lists"},_hoisted_4$t={key:0,class:"signatures-popup-empty"},_hoisted_5$h={class:"no-signatures"},_hoisted_6$e={key:1,class:"signatures-popup-list-container"},_hoisted_7$b=["onClick","src"],_hoisted_8$9={key:1,class:"signatures-popup-create"},_hoisted_9$9={class:"create-sign-header"},_hoisted_10$8=["src"],_hoisted_11$6={class:"preview-options"},_hoisted_12$5={class:"title"},_hoisted_13$5={class:"configurations"},_hoisted_14$5={class:"left"},_hoisted_15$5={class:"checkboxes"},_hoisted_16$4={class:"right"},_hoisted_17$3={class:"text-align"},_hoisted_18$3={class:"buttons"},_hoisted_19$3={key:0,class:"addition"},_hoisted_20$3={key:0},_hoisted_21$3={class:"select-box"},_hoisted_22$3=["value"],_hoisted_23$2=["value"],_hoisted_24$2=["value"],_hoisted_25$2=["value"],_hoisted_26$2={key:1},_hoisted_27$2={class:"left-btns"},_hoisted_28$2={key:0},_hoisted_29$2={key:1},_hoisted_30$2={class:"right-btns"},_hoisted_31$2={key:1,class:"delete-page-popup"},dialogName$2="signatureAppearanceDialog",_sfc_main$1Z={__name:"SignatureAppearanceDialog",setup(e){const{t:n}=useTranslation(),r=getCurrentInstance().appContext.app.config.globalProperties.$t,u=useViewerStore(),s=useDocumentStore(),w=ref(!1),m=ref(0),v=computed(()=>u.isElementOpen(dialogName$2)),g=computed(()=>u.getActiveElementTab("signPanel")),d=computed(()=>s.getActiveTool),f=computed(()=>u.getDigitalSignaturePreview),y=computed(()=>u.isElementOpen("digitalSignCreatePanel")),x=computed(()=>u.isElementOpen("digitalKeyboardCreatePanel")),k=computed(()=>s.getDisableDigitalSignature),P=computed(()=>s.getDisableElectronicSignature),S=computed(()=>u.getCertSubject),E=computed(()=>u.getThemeMode),M=ref(null),T=computed(()=>u.getDigitalSignaturesList),D=ref(""),N=ref(""),I=ref("create"),O=ref(!0);T.value.length>=5&&(O.value=!1);const F=reactive({name:!0,dName:!1,date:!0,version:!1,logo:!0,location:!1,reason:!1,labels:!0,alignment:"left",reasonText:n("signatures.none"),locationText:""});watch(v,(we,Ae)=>{var $e;we&&(D.value=($e=S.value)==null?void 0:$e.CN)}),watch(F,async(we,Ae)=>{const $e=fe();await Z($e)},{deep:!0}),watch(()=>T.value,we=>{we&&we.length>=5?O.value=!1:O.value||(O.value=!0)},{deep:!0}),watch(()=>v.value,we=>{we&&T.value.length>0?I.value="list":we&&T.value.length===0&&(I.value="create")});const q=we=>{w.value=!0,m.value=we},Y=()=>{u.removeDigitalSignature(m.value),w.value=!1};function _e(we){const Ae=new Image;return Ae.src=we,new Promise($e=>{Ae.onload=function(){const{width:Me,height:Ie}=Ae;$e({width:Me,height:Ie})}})}const ne=async we=>{const{width:Ae,height:$e}=await _e(we);u.setCommonLoading(!0);const Me=fe(),Ie=X(Me);Ie.imageBase64=we,Ie.width=Ae,Ie.height=$e;const Le=s.getPkcs12;await core.handleSign({type:1,flag:"save",param:{annotation:toRaw(u.getSelectedSignatureField),...Ie,appearance:"image"},pkcs12Buffer:Le.pkcs12Buffer,password:Le.password}),U(),u.setCommonLoading(!1)},ve=async we=>{N.value=we;const Ae=fe();await Z(Ae)},J=async we=>{D.value=we;const Ae=fe();await Z(Ae)},fe=()=>{let we="";return F.name&&(we+=j("name")+`
`),F.date&&(we+=j("date")+`
`),F.reason&&(we+=j("reason")+`
`),F.dName&&(we+=j("dName")+`
`),F.version&&(we+=j("version")+`
`),F.location&&(we+=j("location")),we},Z=async we=>{const Ae=X(we);Ae.rect={width:582,height:187,top:0,left:0,right:582,bottom:187};const $e=await core.getSignature(Ae);u.setDigitalSignaturePreview($e)},j=we=>{let Ae={};switch(we){case"name":Ae.title=r("signatures.appearance.name"),Ae.value=S.value.CN;break;case"date":const $e=new Date,Me=$e.getFullYear(),Ie=$e.getMonth()+1<10?`0${$e.getMonth()+1}`:$e.getMonth()+1,Le=$e.getDate()<10?`0${$e.getDate()}`:$e.getDate(),le=$e.getHours()<10?`0${$e.getHours()}`:$e.getHours(),oe=$e.getMinutes()<10?`0${$e.getMinutes()}`:$e.getMinutes(),ke=$e.getSeconds()<10?`0${$e.getSeconds()}`:$e.getSeconds(),Ce=`${Me}.${Ie}.${Le} ${le}:${oe}:${ke}`;Ae.title=r("signatures.appearance.date"),Ae.value=Ce;break;case"reason":Ae.title=r("signatures.appearance.reason"),Ae.value=F.reasonText;break;case"dName":const Be=["CN","O","OU","email","L","ST","C"].map(Ve=>`${Ve}=${S.value[Ve]}`).join(",");Ae.title=r("signatures.appearance.distinguishableName"),Ae.value=Be;break;case"version":Ae.title=r("signatures.appearance.version"),Ae.value="2.8.1";break;case"location":Ae.title=r("signatures.appearance.location"),Ae.value=F.locationText;break}return F.labels?`${Ae.title}: ${Ae.value}`:Ae.value},X=we=>{const Ae={content:we,isContentAlginLeft:F.alignment!=="left"};return g.value!=="keyboard"?Ae.text="":Ae.text=D.value,(g.value==="image"||g.value==="trackpad")&&(Ae.imageBase64=N.value),F.logo&&(Ae.isDrawLogo=!0,Ae.logoBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAYAAACHjumMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAA9kSURBVHgB7d1vbJXlGcfx635KpUWqJWgiZGgxg2ZG52k1pmqmJdYl6kZwW8S5F4hlKvGFmG3RZWYU4wuX7QUsMdpsSn3j3LJMo3FLJobqMmMWpDUuS4BkdpKAyWAFi4JAz737Oj2Hlv45PX+e+/x57u8nOZ4/Lbw4nvPjuq77fp7HSAy67x9tPSWyzhhJpSNzhbGSsmJa3fNWAeqBtSNiZMSk7YfWyLCkZfD9gSUjgrIYKVEmVKLoUTG22/013QIkjBE7bK3dQdiUruiAyQWLFdlChYJgWBmQdHobQVOcogKm64HjWwkWBM1K3/svXrxNUJCCAqbr/tE20xC96sIlJUDorIy4amYN1cz8ovl+oav3sw02ioYIFyDLSJttiIZu7B1dJ8grb8BoS+TieoCWCDifK/1brUSvTnxHMJc5W6TMG2ekTwDkx1xmTrMGjJZ+ms4CoEDm/vdfuOglwXlmBIwOdHXmQlsEFM7NKI+Z8XQHg9/zzZzBRNFuwgUojs5kdKVVcJ7zAiY7d2kTAEXTldauB0b7BOeca5G0NZKG6GMBUDJtlZrH0ysHB5YcE0ypYFgxAsqmrdKpSLYIMjIVDNULEB+qmElR9r/dAiAWVDGTMgFjTPSoAIiPabhVIIb2CPCjaTy9JPQ2KaI9AvxwbVLwB0NGenpLARA7vlsuYGxkrhUAsUtHUZsELnJraisFQOxcBRP8P96RW0K6QgDEznJM3/xntANQGt0PI4EjYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAmwUCFGjZUiOXXRLJMr0tjTLPFy8y0uJu+ppa3DzxHBM6v/+8lTpgjYyIdbe0fOieDcu4DA7fsXlEykTAYAYNiK+uiGTVigZZ7e5XX94gl7lAITiSy1hpc3dtrqfpds8yvU1qV/+wpNM7ygkbAgaZ4PhGxwIXJg1yi7vX6gQwYlMSmZ0TYfP8gJyx24oNGtPVe7wuSjjEq6O9QW7taJROd6+VCvzofLtfksQa0zd820PbCv19AiYguVC586ZG2p0KSVrAZI3YM3ZNIdUMLVLCESrwoM00ypCb0Wwc7nnotXy/SMAkkAbJHS5QbnXzlM52/hfDB9PqZjSvpt7uz9sy8elLEA2We3oaZX3PQqoVVISxts+FjMwVMgRMAugelN61C+UuV7UAlZYJmV39I65demn6z1iPrGMaLM/+ZJH86ZnFhAuqykh6e+ovz7VNf50Kpg5RsaD2uJlMo3nVPeiY+ioVTB3RuUrv2gvkpZ9fSLigBtlU6q3n+qa+QsDUCd1h+9LWC2XT2iYGuKhZxsijqd07W3PPaZFqnLZDT25sYrkZdcK0ytlTW9yDPn1GBVPD1vdMtEOEC+rJ1CqGT24NompBfZusYvgE1xitWnSFiDkL6pkx5la9J2BqRG6FSHfhAgnQrW0SAVMDchvmOA8LEuXMqXUETJXp8vOTG5tpiZA8kUkRMFW0aa3OW5oESCJjbRsBUyVb7l3IvAXJZsy1BEyFaSv0zCPNLEEjAJYhbyXpMPcXLlw4By7CYAiYSmGlCCHi014BhAtCxSfeM8IFIeNT7xHhgtDxyfdEV4t0oEu4IGR8+j352cYmVosQPALGA91Epxc7A0JHwMRsE0dEA+cQMDHSAxc5tgiYRMDEZOIsdM0CYBIBEwNdMdLlaE65AJyPgImBnomO5WhgJr4VZbrz5kaGusAcCJgy6Nxly3qGusBcCJgy6KVFmLsAcyNgSqT7XThpFJAfAVMCbY3uYe4CzIuAKQEXRgMKQ8AUSVeN7rqJ44yAQhAwRdCqZdNaWiOgUARMEdb3NLKhDigC35YC6WCXAxmB4hAwBeqlNQKKRsAUQKsXBrtA8QiYAlC9AKUhYOZB9QKUjoCZB9ULUDoCJg+qF6A8BEweVC9AeQiYPDrbua4RUA4CZg56zBG7doHy8A2aw709FwiA8nDGpFmsXtHAZV8LdPjUmOz53yHZd+Jo5vEhdxs7czpzDxAws7jndqqXfD4YPSS7/zsig+5GkCAfAmYWDHdnGjv7pbx88J/y8icfZR4DhSBgptFwYbg7iWBBOQiYae68mfYoR0Ol/+MPCBaUjICZhvZIMnOVvn8Nyh43awHKQcBMQXtE1YJ4ETBT3NIR9nFHvzrwXiZggLgQMFOE3B5tdS3RG4f3CRAnAiZLj5wOdXPdvf/4o+wfOypA3FiPzVq1Isy3QisXwgW+EDBZIc5f+v+9h7YIXhEwWasDq2Byq0WATwSMTFyxMaT5i+5zIVxQCQSMhDd/+eHeN9jngoogYESCql5edzOXwyc5AhqVQcCI7n8JY7We1giVRsCI7oExEoKXD35E9YKKImAkjBZJq5c3Du0XoJKCDxjdwRsCPTKawS4qjYBZGkZ7xOwF1RB8wFx2SfLbIz2HLrMXVAMVTAAVzOuHmb2gOgiYAGYwe45xZjpUR/AB09Kc7ApGV49oj1AtwQfM4kWSaPvHjghQLVQwi5JdwezjXC+oIiqYRcl+C/SSrkC1EDDNkmiHubQrqogWKeEt0mdnTgtQLRyLlHBUMKgmAgaANwQMAG8IGADeEDAJt6ypRYBqCT5gxr6wkmQXNV4gQLUEHzAnTkqiUcGgmmiREm45AYMqCj5gDh8ZlyRbvXipANVCi/SFJNr1S5YLUC0MeU8me8i7vLmFOQyqhhbpSFqSbs2lbQJUAwFzNNkVjOomYFAlwQfMpwkf8iqdw7QsWChApVHBBFDBqPtWXC1ApREwbgaT9N286r7Lr6GKQcWx0c759GjyB70aLlQxqDQCxtl/MPkBo6hiUGkEjHPgk+QPepWGy4MrOwWoFALGOXAwjIBRP7j863Jd6zIBKoGAEQ2YMFqknG1XraFVQkUQMDJxTphQlquVHj5Aq4RKIGCy3h06IyHRVum+FdcI4BMBkxXKStJUP159k3xrWbsAvhAwWX8LrILJeeqqblndwjlj4AcBk6VzmJBWk6Z65YbvUcnACwJmir37wgwYpZXMgyuvEyBOBMwUoQ16p3v4yuvlR6tuZAkbsSFgptAKJoQDH/PR1aXf3fBdzoKHWBAw0/z5vbCrGKX7ZN68+T7p+1o3QYOyEDDThN4mTbV2ebv8pvPbmf0ytE0ohenqPR52TzCLv/66RVoWGcGkQyfHZM/oIen/+AM5fGpMgEI0fKXzp32C8yy9OJKrr2wQTGppXCjtLZe4Gc01cl32UihjZ0/LCXcD5rJAMIO2Set7uKbzXPQcv7nrLWlls+/EEdk/dtTdH8081+ChyoEiYGahq0l7952VznbenvnoQFhvay5dKZip8+1+CRlD3jm8O3RWAJSHgJmDLleHvicGKBcBMwcNlz/sYoAJlIOAyeP3BAxQFgImD61i3mRnL1AyAmYeL7z+pQAoDQEzD73yoy5ZAygeAVOAp3eeEgDFI2AKoFUMsxigeARMgXQWw74YoDgETIG0imFfDFAcAqYIui/m8NHwLm8ClIqAKYK2SNtfYeALFIqAKZIeBMmyNVAYAqYEumzNwBeYHwFTAh34vsgOX2BeBEyJXnEDX1olID8Cpgy0SkB+BEwZaJWA/AiYMmmrxHljgNkRMDHQwwjYgAfMRMDEQOcwj/zyC+YxwDQETEx0HvP0zpMCYBIBEyPd5csZ8IBJBEzMfusChqEvMIGA8UAPiGQTHkDAePPEsyflwMFxAUJGwHiiK0qPu5Bh+RohI2A80pUlXb4mZBAqAsYzQgYhI2AqgJBBqAiYCsmFDINfhCSyIscEFZELmXeGuMYSwhAZa48LKkZXl3QJm814CEFkjB0WVJxuxuOwAiRdJGkZEVSFHlbw+LMchY3kiqwRKpgq0gMkNzz1OStMSKSoKS2vCapKh78btn3OXAaJEw0OLHGrSGZQUFW5q0bqOWVomZAUE/tg7Pg7gprw5t/PZFomjsZGEmQCxrVJ29kPUzty+2V0lYlqBvUsEzDaJhmb3iGoKbrKpNXMm++xMQ/16dyhAlQxtSlzrt8XT2ZmM6w0od6cCxiqmNqWmc24lSY256GemOkv3Nh7fMhVMilBzVp2SSS9axfKXTc1Cmpb59v9ErIZR1PbxvTdtEq1Ldc2feeJE8xnUNPMbC92PTB6v5hop6AuUNHUrtArGDPXD7o2He8TK1sFdSMXNJ3tDbJsKaf6qQUETB6ETP266+ZGWd+zUFatIGiqiYCZx429o+vSEu10v9gqqDurVjTI+tsvoKqpEgKmAF0Pj7bJmWi3e9gmqFud7QvkTlfZEDaVQ8AUgZYpOTRsbulYkLmnjfKHgClStprpcw83CBJBh8PaSmngrHb3BE58CJgSZYLmtHS7v2KLGHOtIDFaFplM4GjQdLgKZ3kmgAidUhAwMciFjTFRylqru4DbXOhcIUgUndtotXOZuy1bajLPF7swasne9PHi5omAwgQCJnAdu57nfAiAJ9S9ALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANAQPAGwIGgDcEDABvCBgA3hAwALwhYAB4Q8AA8IaAAeANASP2mADwgoAROS4AfBgJPmCsNcMCIH7W/ocKxsiIAIidNWaYgDGWCgbwwX23CJio6TUBEL9IBoMPmOE1G3UVaVAAxGl4eM1mhrzKWvuOAIiNNXaH3hMwakHTdvbDADGKJroCAkYm2iRrZYcAKJsxMqDtkT4mYHKoYoBYpCO7LfeYgMmiigHKZ6zdlqteMs8F5+nY1T/kKpmUACiOkZGh2x5eOfUlKphpbEP6bloloEjGHrORXTP9ZQJmGi3vrJHHBEDBrI02Tm2NcgiYWQzftnlAe0kBMK/M3KXnoVl3xDODyaPzref6rDFbBcCsNFz23r65b86fC/JK7epfZyS9071VrQJggpu5mHF5bO83Nw/k/TXBvFK7n2szabNbrLQJEDwzrIshs81cZvymoGC0TAiaVi1p2ZGvJZrxRwRFyVQz49Ln3roNAoQgGyzpBU3bs2cfKPyPCkqiQSNp6TbWbHFPrxUgaax9xwXEYCnBkkPAxCAXNpE1KWttyr2rbe6tvUKAeuAqFDdfPO5uw8aYkbSe5TFqeq3UUJnq/zPmsRQ9GquGAAAAAElFTkSuQmCC"),g.value==="none"&&(Ae.isDrawOnlyContent=!0),Ae},H=async we=>{if(!(we===g.value&&["image","none"].includes(we))){if(core.handleSign({flag:"create",type:1}),u.setActiveSignWay(we),we==="trackpad"&&u.openElement("digitalSignCreatePanel"),we==="keyboard"){u.openElement("digitalKeyboardCreatePanel"),await nextTick();const Ae=document.querySelector(".digital-signature-dialog .keyboard-paint input");Ae.select(),Ae.focus()}te()}},U=we=>{u.closeElement(dialogName$2),g.value!=="trackpad"&&te(),core.handleSign({flag:"reset"}),document.body.style.overflow="",!d.value&&we==="cancel"&&k.value&&P.value&&u.openElement("selectSignTypeDialog"),u.setActiveSignWay("keyboard"),Object.assign(F,{name:!0,dName:!1,date:!0,version:!1,logo:!0,location:!1,reason:!1,labels:!0,alignment:"left",reasonText:r("signatures.none"),locationText:""})},te=async()=>{N.value="",g.value==="trackpad"&&core.handleSign({flag:"clear"});const we=fe();await Z(we)},Q=()=>{M.value.click()},re=async we=>{let Ae=we.target.files[0];if(Ae.size>1024*1024){window.$message.error(r("signatures.uploadError"),{duration:5e3,icon:()=>h$1("img",{src:MessageError})}),we.target.value="";return}const $e=new FileReader,Ie=await new Promise((le,oe)=>{$e.addEventListener("load",async ke=>{le(ke.target.result)}),$e.addEventListener("error",()=>{oe("Error reading the local image")}),$e.readAsDataURL(Ae)});N.value=Ie;const Le=fe();await Z(Le)},Pe=async()=>{u.setCommonLoading(!0);const we=fe(),Ae=X(we),$e=s.getPkcs12;await core.handleSign({type:1,flag:"save",param:{annotation:toRaw(u.getSelectedSignatureField),...Ae},pkcs12Buffer:$e.pkcs12Buffer,password:$e.password}),U(),u.setCommonLoading(!1),O.value&&T.value.length<5&&u.addDigitalSignature(f.value)},be=()=>{g.value==="keyboard"&&H("keyboard"),g.value==="trackpad"&&H("trackpad")};return(we,Ae)=>{const $e=__unplugin_components_0$y,Me=__unplugin_components_1$e,Ie=__unplugin_components_2$e,Le=__unplugin_components_14$2,le=_sfc_main$4C,oe=__unplugin_components_1$g,ke=__unplugin_components_6$a,Ce=__unplugin_components_7$8,Ee=__unplugin_components_0$u,Be=_sfc_main$4v,Ve=_sfc_main$1_,Oe=_sfc_main$1$,je=__unplugin_components_2$f;return openBlock(),createElementBlock(Fragment,null,[v.value?(openBlock(),createElementBlock("div",{key:0,class:"signature-appearance-dialog",onMousedown:Ae[22]||(Ae[22]=withModifiers(()=>{},["stop"]))},[createVNode(Be,{show:v.value,dialogName:dialogName$2,class:"appearance-dialog"},createSlots({header:withCtx(()=>[createBaseVNode("p",null,toDisplayString(unref(r)("signatures.appearance.title")),1),createVNode($e,{class:"close",onClick:U})]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1F,[createBaseVNode("div",_hoisted_2$1w,[createBaseVNode("div",{onClick:Ae[0]||(Ae[0]=Ge=>I.value="list"),class:normalizeClass({active:I.value==="list"})},toDisplayString(unref(r)("signatures.electronicSignature.mySignatures")),3),createBaseVNode("div",{onClick:Ae[1]||(Ae[1]=Ge=>I.value="create"),class:normalizeClass({active:I.value==="create"})},toDisplayString(unref(r)("signatures.electronicSignature.create")),3)]),I.value==="list"?(openBlock(),createElementBlock("div",_hoisted_3$1k,[T.value.length===0?(openBlock(),createElementBlock("div",_hoisted_4$t,[createBaseVNode("div",_hoisted_5$h,[E.value==="light"?(openBlock(),createBlock(Me,{key:0})):(openBlock(),createBlock(Ie,{key:1})),createBaseVNode("div",{onClick:Ae[2]||(Ae[2]=Ge=>I.value="create")},toDisplayString(unref(r)("signatures.electronicSignature.empty")),1)])])):(openBlock(),createElementBlock("div",_hoisted_6$e,[(openBlock(!0),createElementBlock(Fragment,null,renderList(T.value,(Ge,Xe)=>(openBlock(),createElementBlock("div",{class:"signatures-popup-list",key:Xe},[createBaseVNode("img",{onClick:qe=>ne(Ge),src:Ge},null,8,_hoisted_7$b),createVNode(le,{class:"close-button",onClick:qe=>q(Xe)},{default:withCtx(()=>[createVNode(Le)]),_:2},1032,["onClick"])]))),128))]))])):(openBlock(),createElementBlock("div",_hoisted_8$9,[createBaseVNode("div",_hoisted_9$9,[createBaseVNode("div",{onClick:Ae[3]||(Ae[3]=Ge=>H("keyboard")),class:normalizeClass({active:g.value==="keyboard"})},toDisplayString(unref(r)("signatures.keyboard")),3),createBaseVNode("div",{onClick:Ae[4]||(Ae[4]=Ge=>H("trackpad")),class:normalizeClass({active:g.value==="trackpad"})},toDisplayString(unref(r)("signatures.trackpad")),3),createBaseVNode("div",{onClick:Ae[5]||(Ae[5]=Ge=>H("image")),class:normalizeClass({active:g.value==="image"})},toDisplayString(unref(r)("signatures.image")),3),createBaseVNode("div",{onClick:Ae[6]||(Ae[6]=Ge=>H("none")),class:normalizeClass({active:g.value==="none"})},toDisplayString(unref(r)("signatures.none")),3)]),createBaseVNode("div",{class:"preview-area",onClick:Ae[7]||(Ae[7]=Ge=>be())},[createBaseVNode("img",{src:f.value},null,8,_hoisted_10$8)]),createBaseVNode("div",_hoisted_11$6,[g.value==="image"?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:"upload",onClick:Q},[createTextVNode(toDisplayString(unref(r)("common.actions.upload")),1),createBaseVNode("input",{ref_key:"uploadImageEl",ref:M,type:"file",onChange:re,accept:".png, .jpg, .jpeg",name:"signature"},null,544)]),createBaseVNode("span",{onClick:te},toDisplayString(unref(r)("common.actions.clear")),1)],64)):createCommentVNode("",!0)]),createBaseVNode("p",_hoisted_12$5,toDisplayString(unref(r)("signatures.appearance.includeText")),1),createBaseVNode("div",_hoisted_13$5,[createBaseVNode("div",_hoisted_14$5,[createBaseVNode("div",_hoisted_15$5,[createBaseVNode("div",{class:"check-box",onClick:Ae[8]||(Ae[8]=Ge=>F.name=!F.name)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.name}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.name]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.name")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[9]||(Ae[9]=Ge=>F.dName=!F.dName)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.dName}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.dName]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.distinguishableName")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[10]||(Ae[10]=Ge=>F.date=!F.date)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.date}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.date]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.date")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[11]||(Ae[11]=Ge=>F.version=!F.version)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.version}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.version]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.version")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[12]||(Ae[12]=Ge=>F.logo=!F.logo)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.logo}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.logo]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.logo")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[13]||(Ae[13]=Ge=>F.location=!F.location)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.location}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.location]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.location")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[14]||(Ae[14]=Ge=>F.reason=!F.reason)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.reason}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.reason]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.reason")),1)]),createBaseVNode("div",{class:"check-box",onClick:Ae[15]||(Ae[15]=Ge=>F.labels=!F.labels)},[createBaseVNode("div",{class:normalizeClass(["check",{active:F.labels}])},[withDirectives(createVNode(oe,null,null,512),[[vShow,F.labels]])],2),createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.labels")),1)])])]),createBaseVNode("div",_hoisted_16$4,[createBaseVNode("div",_hoisted_17$3,[createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.textAlignment")),1),createBaseVNode("div",_hoisted_18$3,[createBaseVNode("div",{class:normalizeClass({active:F.alignment==="left"}),onClick:Ae[16]||(Ae[16]=Ge=>F.alignment="left")},[createVNode(ke)],2),createBaseVNode("div",{class:normalizeClass({active:F.alignment==="right"}),onClick:Ae[17]||(Ae[17]=Ge=>F.alignment="right")},[createVNode(Ce)],2)])]),F.reason||F.location?(openBlock(),createElementBlock("div",_hoisted_19$3,[F.reason?(openBlock(),createElementBlock("div",_hoisted_20$3,[createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.reason")),1),createBaseVNode("div",_hoisted_21$3,[withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Ae[18]||(Ae[18]=Ge=>F.reasonText=Ge)},[createBaseVNode("option",{value:unref(r)("signatures.none")},toDisplayString(unref(r)("signatures.none")),9,_hoisted_22$3),createBaseVNode("option",{value:unref(r)("signatures.appearance.docOwner")},toDisplayString(unref(r)("signatures.appearance.docOwner")),9,_hoisted_23$2),createBaseVNode("option",{value:unref(r)("signatures.appearance.approving")},toDisplayString(unref(r)("signatures.appearance.approving")),9,_hoisted_24$2),createBaseVNode("option",{value:unref(r)("signatures.appearance.reviewed")},toDisplayString(unref(r)("signatures.appearance.reviewed")),9,_hoisted_25$2)],512),[[vModelSelect,F.reasonText]]),createVNode(Ee)])])):createCommentVNode("",!0),F.location?(openBlock(),createElementBlock("div",_hoisted_26$2,[createBaseVNode("span",null,toDisplayString(unref(r)("signatures.appearance.location")),1),withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":Ae[19]||(Ae[19]=Ge=>F.locationText=Ge),name:"signature"},null,512),[[vModelText,F.locationText]])])):createCommentVNode("",!0)])):createCommentVNode("",!0)])])]))])]),_:2},[I.value==="create"?{name:"footer",fn:withCtx(()=>[createBaseVNode("div",_hoisted_27$2,[createBaseVNode("div",{class:normalizeClass(["check",{active:O.value,disabled:T.value.length>=5}]),onClick:Ae[20]||(Ae[20]=Ge=>T.value.length<5&&(O.value=!O.value))},[withDirectives(createVNode(oe,null,null,512),[[vShow,O.value]])],2),T.value.length<5?(openBlock(),createElementBlock("span",_hoisted_28$2,toDisplayString(unref(r)("signatures.electronicSignature.saveTemplate")),1)):(openBlock(),createElementBlock("span",_hoisted_29$2,toDisplayString(unref(r)("signatures.fullStorage")),1))]),createBaseVNode("div",_hoisted_30$2,[createBaseVNode("div",{class:"rect-button white",onClick:Ae[21]||(Ae[21]=Ge=>U("cancel"))},toDisplayString(unref(r)("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:Pe},toDisplayString(unref(r)("common.actions.ok")),1)])]),key:"0"}:void 0]),1032,["show"]),withDirectives(createVNode(Ve,{onModifyImage:ve},null,512),[[vShow,y.value]]),x.value?(openBlock(),createBlock(Oe,{key:0,text:D.value,onModifyText:J},null,8,["text"])):createCommentVNode("",!0)],32)):createCommentVNode("",!0),w.value?(openBlock(),createElementBlock("div",_hoisted_31$2,[createVNode(Be,{show:w.value,dialogName:dialogName$2},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:Ae[23]||(Ae[23]=Ge=>w.value=!1)},toDisplayString(unref(r)("common.actions.cancel")),1),createBaseVNode("div",{class:"rect-button blue",onClick:Y},toDisplayString(unref(r)("common.actions.ok")),1)]),default:withCtx(()=>[createVNode(je),createBaseVNode("p",null,toDisplayString(unref(r)("signatures.deleteConfirm")),1)]),_:1},8,["show"])])):createCommentVNode("",!0)],64)}}},SelectSignTypeDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1E={class:"title title-color"},_hoisted_2$1v={class:"select-text"},_hoisted_3$1j={class:"text"},_hoisted_4$s={class:"title"},_hoisted_5$g={class:"text"},_hoisted_6$d={class:"title"},dialogName$1="selectSignTypeDialog",_sfc_main$1Y={__name:"SelectSignTypeDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName$1)),u=computed(()=>o.getActiveTool),s=computed(()=>o.getDisableDigitalSignature),w=computed(()=>o.getDisableElectronicSignature),m=ref("electronic"),v=f=>{n.setSelectedSignatureField(f),u.value==="addDigitalSign"||!s.value&&w.value?n.openElement("addDigitalFileDialog"):u.value==="addElectronicSign"||s.value&&!w.value?d():n.openElement("selectSignTypeDialog")};core.addEvent("openSelectSignTypeDialog",v);const g=()=>{n.closeElement(dialogName$1),document.body.style.overflow="hidden",m.value==="digital"?n.openElement("addDigitalFileDialog"):d()},d=()=>{n.toggleElement("signCreatePanel"),n.toggleActiveHand(!1),core.switchTool(0),core.switchAnnotationEditorMode(0)};return(f,y)=>{const x=__unplugin_components_0$w,k=__unplugin_components_1$a,P=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",{key:0,class:"select-type-popup",onMousedown:y[2]||(y[2]=withModifiers(()=>{},["stop"]))},[createVNode(P,{show:r.value,dialogName:dialogName$1,close:!0},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button blue",onClick:g},toDisplayString(f.$t("signatures.startSigning")),1)]),default:withCtx(()=>[createBaseVNode("p",_hoisted_1$1E,toDisplayString(f.$t("signatures.electronicSignature.title")),1),createBaseVNode("div",_hoisted_2$1v,[createBaseVNode("div",{onClick:y[0]||(y[0]=S=>m.value="electronic"),class:"option"},[m.value==="electronic"?(openBlock(),createBlock(x,{key:0})):(openBlock(),createBlock(k,{key:1})),createBaseVNode("div",_hoisted_3$1j,[createBaseVNode("p",_hoisted_4$s,toDisplayString(f.$t("signatures.electronic.title")),1),createBaseVNode("p",null,toDisplayString(f.$t("signatures.electronic.description")),1)])]),createBaseVNode("div",{onClick:y[1]||(y[1]=S=>m.value="digital"),class:"option"},[m.value==="digital"?(openBlock(),createBlock(x,{key:0})):(openBlock(),createBlock(k,{key:1})),createBaseVNode("div",_hoisted_5$g,[createBaseVNode("p",_hoisted_6$d,toDisplayString(f.$t("signatures.digital.title")),1),createBaseVNode("p",null,toDisplayString(f.$t("signatures.digital.description")),1)])])])]),_:1},8,["show"])],32)):createCommentVNode("",!0)}}},PreventDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1D={key:0,class:"edit-dialog"},_hoisted_2$1u={class:"edit"},_hoisted_3$1i={class:"close"},_hoisted_4$r={class:"warning"},_hoisted_5$f={class:"title"},_hoisted_6$c={class:"des"},_sfc_main$1X={__name:"PreventDialog",setup(e){const n=useViewerStore(),o=computed(()=>n.isElementOpen("contentEditorPreventDialog")),r=computed(()=>n.isElementOpen("docEditorPreventDialog")),u=()=>n.closeElement(o.value?"contentEditorPreventDialog":"docEditorPreventDialog");return(s,w)=>{const m=__unplugin_components_14$2,v=__unplugin_components_2$f;return o.value||r.value?(openBlock(),createElementBlock("div",_hoisted_1$1D,[createBaseVNode("div",_hoisted_2$1u,[createBaseVNode("div",_hoisted_3$1i,[createVNode(m,{onClick:u})]),createBaseVNode("div",_hoisted_4$r,[createVNode(v)]),createBaseVNode("div",_hoisted_5$f,toDisplayString(s.$t("prevent.title")),1),createBaseVNode("div",_hoisted_6$c,toDisplayString(o.value?s.$t("prevent.description"):s.$t("prevent.description1")),1),createBaseVNode("div",{class:"button",onClick:u},toDisplayString(s.$t("common.actions.ok")),1)])])):createCommentVNode("",!0)}}},SettingsDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1C={class:"settings-popup"},_hoisted_2$1t={class:"title"},_hoisted_3$1h={class:"container"},_hoisted_4$q={class:"info"},_hoisted_5$e={class:"row"},_hoisted_6$b={class:"row"},_hoisted_7$a={class:"row"},_hoisted_8$8={class:"select-box"},_hoisted_9$8=["value"],_hoisted_10$7={class:"row"},_hoisted_11$5={class:"controller"},_hoisted_12$4={class:"row"},_hoisted_13$4={class:"controller"},_hoisted_14$4={class:"form-sign"},_hoisted_15$4={class:"row"},_hoisted_16$3={class:"select-box"},_hoisted_17$2=["value"],_hoisted_18$2={key:0,class:"row"},_hoisted_19$2={class:"controller"},_hoisted_20$2={class:"title"},_hoisted_21$2={class:"version row"},_hoisted_22$2=createBaseVNode("span",null,"2.8.1",-1),_sfc_main$1W={__name:"SettingsDialog",setup(e){const{i18next:n,t:o}=useTranslation(),r=useViewerStore(),u=useDocumentStore(),s=ref(u.getAuthor),w=ref(u.getAnnotator),m=computed(()=>r.isElementOpen("settingsDialog")),v=computed(()=>u.getAuthor),g=computed(()=>u.getAnnotator),d=ref(n.language),f=ref(!0),y=ref(!0),x=ref(!1),k=computed(()=>r.getLanguages),P=ref(!1),S=ref("signForm"),E=[{label:computed(()=>o("toolbar.settings.signForm")),value:"signForm"},{label:computed(()=>o("toolbar.settings.sign")),value:"sign"},{label:computed(()=>o("toolbar.settings.form")),value:"form"},{label:computed(()=>o("toolbar.settings.disableConsecutively")),value:!1}];watch(()=>m.value,(I,O)=>{I&&(x.value=!1)}),watch(()=>n.language,I=>{d.value=I}),watch(v,(I,O)=>{s.value=I}),watch(g,(I,O)=>{w.value=I}),watch([s,w,d,f,y,P,S],(I,O)=>{I[0]!==u.getAuthor||I[1]!==u.getAnnotator||I[2]!==n.language||I[3]!==u.getHighlightLink||I[4]!==u.getHighlightForm||I[5]!==core.isSkipNoRequired()||I[6]!==core.getConsecutiveType()?x.value=!0:x.value=!1});const M=()=>{r.closeElement("settingsDialog"),d.value=n.language,s.value=v.value,w.value=g.value,f.value=u.getHighlightLink,y.value=u.getHighlightForm,S.value=r.getConsecutiveType,P.value=core.isSkipNoRequired()},T=async()=>{await n.changeLanguage(d.value),window.localStorage.setItem("language",d.value),r.closeElement("settingsDialog"),u.setAuthor(s.value?s.value:"ComPDFKit"),u.setAnnotator(w.value?w.value:"Guest"),u.setHighlightLink(f.value),u.setHighlightForm(y.value),P.value?core.enableSkipNoRequired():core.disableSkipNoRequired(),r.setConsecutiveType(S.value),core.setConsecutiveType(S.value)},D=()=>{const I=core.getCurrentUser();I!==g.value&&u.setAnnotator(I)},N=()=>{const I=core.isSkipNoRequired();P.value=I,r.setSkipNoRequired(I);const O=core.getConsecutiveType();r.setConsecutiveType(O),S.value=O};return core.addEvent("updateAnnotationPermission",D),core.addEvent("updateConsecutivelyType",N),core.addEvent("update",D),onMounted(()=>{const I=core.getCurrentUser();u.setAnnotator(I);const O=core.getConsecutiveType();r.setConsecutiveType(O),S.value=O}),(I,O)=>{const F=__unplugin_components_0$B,q=_sfc_main$4v;return openBlock(),createElementBlock("div",_hoisted_1$1C,[createVNode(q,{show:m.value},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:M},toDisplayString(I.$t("common.actions.cancel")),1),createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:!x.value}]),onClick:T},toDisplayString(I.$t("common.actions.save")),3)]),default:withCtx(()=>[createBaseVNode("p",_hoisted_2$1t,toDisplayString(I.$t("toolbar.settings.title")),1),createBaseVNode("div",_hoisted_3$1h,[createBaseVNode("div",_hoisted_4$q,[createBaseVNode("div",_hoisted_5$e,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.author")),1),withDirectives(createBaseVNode("input",{type:"text",placeholder:"ComPDFKit","onUpdate:modelValue":O[0]||(O[0]=Y=>s.value=Y),name:"settings"},null,512),[[vModelText,s.value]])]),createBaseVNode("div",_hoisted_6$b,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.annotator")),1),withDirectives(createBaseVNode("input",{type:"text",placeholder:"Guest","onUpdate:modelValue":O[1]||(O[1]=Y=>w.value=Y),name:"settings"},null,512),[[vModelText,w.value]])]),createBaseVNode("div",_hoisted_7$a,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.language")),1),createBaseVNode("div",_hoisted_8$8,[withDirectives(createBaseVNode("select",{name:"language","onUpdate:modelValue":O[2]||(O[2]=Y=>d.value=Y)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(k.value,Y=>(openBlock(),createElementBlock("option",{value:Y.code},toDisplayString(Y.name),9,_hoisted_9$8))),256))],512),[[vModelSelect,d.value]]),createVNode(F)])])]),createBaseVNode("div",_hoisted_10$7,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.highlightLink")),1),createBaseVNode("div",_hoisted_11$5,[createVNode(unref(NSwitch),{value:f.value,"onUpdate:value":O[3]||(O[3]=Y=>f.value=Y)},null,8,["value"])])]),createBaseVNode("div",_hoisted_12$4,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.highlightForm")),1),createBaseVNode("div",_hoisted_13$4,[createVNode(unref(NSwitch),{value:y.value,"onUpdate:value":O[4]||(O[4]=Y=>y.value=Y)},null,8,["value"])])]),createBaseVNode("div",_hoisted_14$4,[createBaseVNode("div",_hoisted_15$4,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.signFill")),1),createBaseVNode("div",_hoisted_16$3,[withDirectives(createBaseVNode("select",{name:"consecutively","onUpdate:modelValue":O[5]||(O[5]=Y=>S.value=Y)},[(openBlock(),createElementBlock(Fragment,null,renderList(E,Y=>createBaseVNode("option",{value:Y.value},toDisplayString(Y.label.value),9,_hoisted_17$2)),64))],512),[[vModelSelect,S.value]]),createVNode(F)])]),S.value?(openBlock(),createElementBlock("div",_hoisted_18$2,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.skip")),1),createBaseVNode("div",_hoisted_19$2,[createVNode(unref(NSwitch),{value:P.value,"onUpdate:value":O[6]||(O[6]=Y=>P.value=Y)},null,8,["value"])])])):createCommentVNode("",!0)])]),createBaseVNode("p",_hoisted_20$2,toDisplayString(I.$t("toolbar.settings.creationInfo")),1),createBaseVNode("div",_hoisted_21$2,[createBaseVNode("span",null,toDisplayString(I.$t("toolbar.settings.version")),1),_hoisted_22$2])]),_:1},8,["show"])])}}},_sfc_main$1V={},_hoisted_1$1B={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1s=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3033 12.5962L3.40381 2.69666L2.6967 3.40376L12.5962 13.3033L13.3033 12.5962ZM2 7.99996C2 7.99996 2.69777 6.96095 3.82074 5.94202L9.58576 11.707C9.08063 11.8902 8.54892 12 8 12C4.68629 12 2 7.99996 2 7.99996ZM14 7.99996C14 7.99996 13.3022 9.03896 12.1793 10.0579L6.41424 4.29288C6.91937 4.10972 7.45108 3.99996 8 3.99996C11.3137 3.99996 14 7.99996 14 7.99996Z",fill:"currentColor"},null,-1),_hoisted_3$1g=[_hoisted_2$1s];function _sfc_render$$(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1B,_hoisted_3$1g)}const __unplugin_components_4$6=_export_sfc(_sfc_main$1V,[["render",_sfc_render$$]]),_sfc_main$1U={},_hoisted_1$1A={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1r=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 12C11.3137 12 14 8 14 8C14 8 11.3137 4 8 4C4.68629 4 2 8 2 8C2 8 4.68629 12 8 12ZM8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z",fill:"currentColor"},null,-1),_hoisted_3$1f=[_hoisted_2$1r];function _sfc_render$_(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1A,_hoisted_3$1f)}const __unplugin_components_3$6=_export_sfc(_sfc_main$1U,[["render",_sfc_render$_]]),_sfc_main$1T={},_hoisted_1$1z={width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1q=createBaseVNode("path",{d:"M32.5 19.2321V13.1607C32.5 8.46629 28.6944 4.66071 24 4.66071V4.66071C19.3056 4.66071 15.5 8.46628 15.5 13.1607V19.2321",stroke:"#93B9FD","stroke-width":"4"},null,-1),_hoisted_3$1e=createBaseVNode("rect",{x:"7",y:"16.8036",width:"34",height:"26.7143",rx:"2",fill:"currentColor"},null,-1),_hoisted_4$p=createBaseVNode("rect",{x:"15",y:"28",width:"18",height:"3",fill:"white"},null,-1),_hoisted_5$d=[_hoisted_2$1q,_hoisted_3$1e,_hoisted_4$p];function _sfc_render$Z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1z,_hoisted_5$d)}const __unplugin_components_2$a=_export_sfc(_sfc_main$1T,[["render",_sfc_render$Z]]),_sfc_main$1S={},_hoisted_1$1y={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1p=createBaseVNode("path",{d:"M13 1L1 13",stroke:"#BABABA","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$1d=createBaseVNode("path",{d:"M1 1L13 13",stroke:"#BABABA","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_4$o=[_hoisted_2$1p,_hoisted_3$1d];function _sfc_render$Y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1y,_hoisted_4$o)}const __unplugin_components_0$g=_export_sfc(_sfc_main$1S,[["render",_sfc_render$Y]]),EnterDocumentPassword_vue_vue_type_style_index_0_lang="",_hoisted_1$1x={id:"passwordDialog",class:"enter-document-password-dialog"},_hoisted_2$1o={class:"password-container"},_hoisted_3$1c={class:"modal-container"},_hoisted_4$n={class:"wrapper"},_hoisted_5$c={class:"header-container"},_hoisted_6$a=createBaseVNode("span",{class:"title"},null,-1),_hoisted_7$9={class:"password-title"},_hoisted_8$7={class:"input-container"},_hoisted_9$7=["type","placeholder"],_hoisted_10$6={class:"wrong-password",id:"passwordText"},_sfc_main$1R={__name:"EnterDocumentPassword",setup(e){const{t:n}=useTranslation(),o=useViewerStore(),r=ref(!1),u=ref(""),s=ref(""),w=computed(()=>o.isElementOpen("permissionPasswordDialog")),m=g=>{g.param===!0||g.param===!1?r.value=g.param:r.value=!r.value};watch(()=>u.value,()=>{s.value=""}),watch(()=>w.value,()=>{u.value="",s.value=""});const v=async()=>{if(!await core.checkPermissionPassword(u.value)){s.value=n("passwordDialog.wrongPwd");return}o.closeElement("permissionPasswordDialog")};return(g,d)=>{const f=__unplugin_components_0$g,y=_sfc_main$4C,x=__unplugin_components_2$a,k=__unplugin_components_3$6,P=__unplugin_components_4$6;return withDirectives((openBlock(),createElementBlock("div",_hoisted_1$1x,[createBaseVNode("div",_hoisted_2$1o,[createBaseVNode("div",_hoisted_3$1c,[createBaseVNode("div",_hoisted_4$n,[createBaseVNode("div",_hoisted_5$c,[_hoisted_6$a,createVNode(y,{class:"close-button",id:"passwordCancel",onClick:d[0]||(d[0]=S=>unref(o).closeElement("permissionPasswordDialog"))},{default:withCtx(()=>[createVNode(f)]),_:1})]),createVNode(x,{class:"lock-icon"}),createBaseVNode("div",_hoisted_7$9,toDisplayString(g.$t("passwordDialog.enterPermissionPwd")),1),createBaseVNode("div",_hoisted_8$7,[withDirectives(createBaseVNode("input",{id:"permission-password","onUpdate:modelValue":d[1]||(d[1]=S=>u.value=S),type:r.value?"text":"password",name:"password",placeholder:g.$t("passwordDialog.placeholder")},null,8,_hoisted_9$7),[[vModelDynamic,u.value]]),createBaseVNode("span",{class:"eye-btn",id:"eyeVisible",onClick:m},[r.value?(openBlock(),createBlock(k,{key:0})):(openBlock(),createBlock(P,{key:1}))]),createBaseVNode("div",_hoisted_10$6,toDisplayString(s.value),1)]),createBaseVNode("span",{class:normalizeClass(["set-btn",!u.value.length&&"disabled"]),id:"passwordSubmit",onClick:v},toDisplayString(g.$t("common.actions.ok")),3)])])])],512)),[[vShow,w.value]])}}},ModalContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$1w={className:"modal-container"},_hoisted_2$1n={className:"wrapper"},_hoisted_3$1b={className:"header-container"},_hoisted_4$m={class:"title"},_sfc_main$1Q={__name:"ModalContainer",props:["title","onCloseClick"],setup(e){return(n,o)=>{const r=__unplugin_components_0$g,u=_sfc_main$4C;return openBlock(),createElementBlock("div",_hoisted_1$1w,[createBaseVNode("div",_hoisted_2$1n,[createBaseVNode("div",_hoisted_3$1b,[createBaseVNode("span",_hoisted_4$m,toDisplayString(e.title),1),createVNode(u,{className:"close-button",onClick:e.onCloseClick},{default:withCtx(()=>[createVNode(r)]),_:1},8,["onClick"])]),renderSlot(n.$slots,"default")])])}}},MessageSuccess=""+new URL("icon-message-success.c9ccee05.svg",import.meta.url).href,SetPassword_vue_vue_type_style_index_0_lang="",_hoisted_1$1v={class:"password-container"},_hoisted_2$1m={class:"encrypt-container"},_hoisted_3$1a={class:"encrypt-document"},_hoisted_4$l={class:"document-title"},_hoisted_5$b=["disabled","type","placeholder"],_hoisted_6$9={class:"wrong-password"},_hoisted_7$8={class:"permission"},_hoisted_8$6={class:"permission-title"},_hoisted_9$6=["disabled","type","placeholder"],_hoisted_10$5={class:"wrong-password"},_hoisted_11$4={class:"printing item"},_hoisted_12$3={class:"copy item"},_hoisted_13$3={class:"edit item"},_hoisted_14$3={class:"note"},_hoisted_15$3={class:"btn-container"},_sfc_main$1P={__name:"SetPassword",setup(e){const n=getCurrentInstance().appContext.app.config.globalProperties,o=useViewerStore(),r=ref(!1),u=ref(""),s=ref(""),w=ref(!1),m=ref(""),v=ref(""),g=ref(!1),d=ref(!1),f=ref(!1),y=ref(!1),x=reactive({allowsPrinting:!1,allowsCopying:!1,allowsDocumentChanges:!1}),k=computed(()=>o.isElementOpen("setPasswordModal"));watch(()=>u.value,(M,T)=>{M&&(M=M.replace(/\s/g,""),M=M.replace(/[^a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/,""),M=M.replace(/[\u4e00-\u9fa5\uFE30-\uFFA0]/,""),u.value=M),m.value=""}),watch(()=>s.value,(M,T)=>{M&&(M=M.replace(/\s/g,""),M=M.replace(/[^a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/,""),M=M.replace(/[\u4e00-\u9fa5\uFE30-\uFFA0]/,""),s.value=M),v.value=""});const P=()=>{o.closeElement("setPasswordModal"),r.value=!1,u.value="",g.value=!1,s.value="",d.value=!1,f.value=!1,x.allowsPrinting=!1,x.allowsCopying=!1,x.allowsDocumentChanges=!1},S=async()=>{if(!u.value.length&&!s.value.length||w.value)return;if(E())g.value=!1;else{g.value=!0;return}w.value=!0;const M={};d.value&&(M.password=u.value),f.value&&(M.permissionPassword=s.value,M.permission={allowsPrinting:x.allowsPrinting,allowsCopying:x.allowsCopying,allowsDocumentChanges:x.allowsDocumentChanges});const T=await core.setPassword(M);P(),T?window.$message.success(n.$t("passwordDialog.setSuccess"),{duration:3e3,icon:()=>h$1("img",{src:MessageSuccess})}):window.$message.error(n.$t("passwordDialog.setFailure"),{duration:3e3,icon:()=>h$1("img",{src:MessageError})}),w.value=!1},E=()=>{const M=/^(?=.*[a-zA-Z]+$|.*\d+$|.*[@$!%*?&]+$)[a-zA-Z\d@$!%*?&]{1,20}$/,T=M.test(u.value),D=M.test(s.value);return d.value&&!T&&(m.value=n.$t("passwordDialog.support")),f.value&&!D&&(v.value=n.$t("passwordDialog.support")),d.value&&f.value&&u.value===s.value?(m.value=n.$t("passwordDialog.samePwd"),v.value=n.$t("passwordDialog.samePwd"),!1):u.value.length>20||s.value.length>20?(d.value&&u.value.length>20&&(m.value=n.$t("passwordDialog.longPwd")),f.value&&s.value.length>20&&(v.value=n.$t("passwordDialog.longPwd")),!1):(!d.value||T)&&(!f.value||D)};return(M,T)=>{const D=__unplugin_components_1$g,N=__unplugin_components_3$6,I=__unplugin_components_4$6,O=_sfc_main$1Q;return withDirectives((openBlock(),createElementBlock("div",_hoisted_1$1v,[createVNode(O,{onCloseClick:P,title:M.$t("passwordDialog.encryptTitle")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1m,[createBaseVNode("div",_hoisted_3$1a,[createBaseVNode("div",_hoisted_4$l,[createBaseVNode("div",{class:normalizeClass(["check",{active:d.value}]),onClick:T[0]||(T[0]=F=>d.value=!d.value)},[withDirectives(createVNode(D,null,null,512),[[vShow,d.value]])],2),createBaseVNode("span",null,toDisplayString(M.$t("passwordDialog.documentPwd")),1)]),createBaseVNode("div",{class:normalizeClass(["input-container",!d.value&&"disable"])},[createBaseVNode("div",{class:normalizeClass(["input",!d.value&&"disabled"])},[withDirectives(createBaseVNode("input",{disabled:!d.value,type:r.value?"text":"password",name:"password","onUpdate:modelValue":T[1]||(T[1]=F=>u.value=F),placeholder:M.$t("passwordDialog.placeholder")},null,8,_hoisted_5$b),[[vModelDynamic,u.value]]),createBaseVNode("span",{class:"eye-btn",onClick:T[2]||(T[2]=F=>r.value=!r.value)},[r.value?(openBlock(),createBlock(N,{key:0})):(openBlock(),createBlock(I,{key:1}))])],2),withDirectives(createBaseVNode("div",_hoisted_6$9,[createBaseVNode("p",null,toDisplayString(m.value),1)],512),[[vShow,m.value]])],2)]),createBaseVNode("div",_hoisted_7$8,[createBaseVNode("div",_hoisted_8$6,[createBaseVNode("div",{class:normalizeClass(["check",{active:f.value}]),onClick:T[3]||(T[3]=F=>f.value=!f.value)},[withDirectives(createVNode(D,null,null,512),[[vShow,f.value]])],2),createBaseVNode("span",null,toDisplayString(M.$t("passwordDialog.permissionPwd")),1)]),createBaseVNode("div",{class:normalizeClass(["input-container",!f.value&&"disable"])},[createBaseVNode("div",{class:normalizeClass(["input",!f.value&&"disabled"])},[withDirectives(createBaseVNode("input",{disabled:!f.value,type:y.value?"text":"password",name:"password","onUpdate:modelValue":T[4]||(T[4]=F=>s.value=F),placeholder:M.$t("passwordDialog.placeholder")},null,8,_hoisted_9$6),[[vModelDynamic,s.value]]),createBaseVNode("span",{class:"eye-btn",onClick:T[5]||(T[5]=F=>y.value=!y.value)},[y.value?(openBlock(),createBlock(N,{key:0})):(openBlock(),createBlock(I,{key:1}))])],2),withDirectives(createBaseVNode("div",_hoisted_10$5,[createBaseVNode("p",null,toDisplayString(v.value),1)],512),[[vShow,v.value]])],2),createBaseVNode("div",{class:normalizeClass(["items",!f.value&&"disabled"])},[createBaseVNode("div",_hoisted_11$4,[createBaseVNode("div",{class:normalizeClass(["check",{active:x.allowsPrinting}]),onClick:T[6]||(T[6]=F=>f.value&&(x.allowsPrinting=!x.allowsPrinting))},[withDirectives(createVNode(D,null,null,512),[[vShow,x.allowsPrinting]])],2),createBaseVNode("span",null,toDisplayString(M.$t("passwordDialog.disablePrinting")),1)]),createBaseVNode("div",_hoisted_12$3,[createBaseVNode("div",{class:normalizeClass(["check",{active:x.allowsCopying}]),onClick:T[7]||(T[7]=F=>f.value&&(x.allowsCopying=!x.allowsCopying))},[withDirectives(createVNode(D,null,null,512),[[vShow,x.allowsCopying]])],2),createBaseVNode("span",null,toDisplayString(M.$t("passwordDialog.disableCopying")),1)]),createBaseVNode("div",_hoisted_13$3,[createBaseVNode("div",{class:normalizeClass(["check",{active:x.allowsDocumentChanges}]),onClick:T[8]||(T[8]=F=>f.value&&(x.allowsDocumentChanges=!x.allowsDocumentChanges))},[withDirectives(createVNode(D,null,null,512),[[vShow,x.allowsDocumentChanges]])],2),createBaseVNode("span",null,toDisplayString(M.$t("passwordDialog.disableEdit")),1)])],2)])]),createBaseVNode("div",_hoisted_14$3,[createBaseVNode("p",null,toDisplayString(M.$t("passwordDialog.notes")[0]),1),createBaseVNode("p",null,toDisplayString(M.$t("passwordDialog.notes")[1]),1),createBaseVNode("p",null,toDisplayString(M.$t("passwordDialog.notes")[2]),1)]),createBaseVNode("div",_hoisted_15$3,[createBaseVNode("span",{onClick:P},toDisplayString(M.$t("common.actions.cancel")),1),createBaseVNode("span",{class:normalizeClass(["blue",{disabled:!u.value&&d.value&&!f.value||!s.value&&f.value||!d.value&&!f.value||f.value&&!x.allowsPrinting&&!x.allowsCopying&&!x.allowsDocumentChanges}]),onClick:S},toDisplayString(M.$t("passwordDialog.encrypt")),3)])]),_:1},8,["title"])],512)),[[vShow,k.value]])}}},EnterPassword_vue_vue_type_style_index_0_lang="",_hoisted_1$1u={id:"passwordDialog",class:"password-dialog enter-password-dialog"},_hoisted_2$1l={class:"password-container"},_hoisted_3$19={class:"modal-container"},_hoisted_4$k={class:"wrapper"},_hoisted_5$a={class:"header-container"},_hoisted_6$8=createBaseVNode("span",{class:"title"},null,-1),_hoisted_7$7={class:"password-title"},_hoisted_8$5={class:"input-container"},_hoisted_9$5=["type","placeholder"],_hoisted_10$4=createBaseVNode("div",{class:"wrong-password",id:"passwordText"},null,-1),_hoisted_11$3={class:"set-btn",id:"passwordSubmit"},_sfc_main$1O={__name:"EnterPassword",setup(e){const n=ref(!1),o=r=>{r.param===!0||r.param===!1?n.value=r.param:n.value=!n.value};return(r,u)=>{const s=__unplugin_components_0$g,w=_sfc_main$4C,m=__unplugin_components_2$a,v=__unplugin_components_3$6,g=__unplugin_components_4$6;return openBlock(),createElementBlock("div",_hoisted_1$1u,[createBaseVNode("div",_hoisted_2$1l,[createBaseVNode("div",_hoisted_3$19,[createBaseVNode("div",_hoisted_4$k,[createBaseVNode("div",_hoisted_5$a,[_hoisted_6$8,createVNode(w,{class:"close-button",id:"passwordCancel"},{default:withCtx(()=>[createVNode(s)]),_:1})]),createVNode(m,{class:"lock-icon"}),createBaseVNode("div",_hoisted_7$7,toDisplayString(r.$t("passwordDialog.enterPwd")),1),createBaseVNode("div",_hoisted_8$5,[createBaseVNode("input",{id:"password",type:n.value?"text":"password",name:"password",placeholder:r.$t("passwordDialog.placeholder")},null,8,_hoisted_9$5),createBaseVNode("span",{class:"eye-btn",id:"eyeVisible",onClick:o},[n.value?(openBlock(),createBlock(v,{key:0})):(openBlock(),createBlock(g,{key:1}))]),_hoisted_10$4]),createBaseVNode("span",_hoisted_11$3,toDisplayString(r.$t("common.actions.ok")),1)])])])])}}},_sfc_main$1N={},_hoisted_1$1t={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1k=createBaseVNode("path",{d:"M7 4.07123L13 10.071L7 16.0709",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$18=[_hoisted_2$1k];function _sfc_render$X(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1t,_hoisted_3$18)}const __unplugin_components_10$3=_export_sfc(_sfc_main$1N,[["render",_sfc_render$X]]),_sfc_main$1M={},_hoisted_1$1s={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1j=createBaseVNode("path",{d:"M13 4.07123L7 10.071L13 16.0709",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$17=[_hoisted_2$1j];function _sfc_render$W(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1s,_hoisted_3$17)}const __unplugin_components_0$f=_export_sfc(_sfc_main$1M,[["render",_sfc_render$W]]),PageNavOverlay_vue_vue_type_style_index_0_lang="",_hoisted_1$1r={key:0,class:"page-nav","data-element":"pageNavOverlay"},_hoisted_2$1i={class:"form-container"},_sfc_main$1L={__name:"PageNavOverlay",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=ref(n.getCurrentPage);effect(()=>r.value=n.getCurrentPage);const u=computed(()=>n.getFullMode),s=computed(()=>n.getCurrentPage===1),w=computed(()=>o.getTotalPages),m=computed(()=>w.value===n.getCurrentPage);watch(r,(f,y)=>{f!==""&&w.value!==0&&(f>w.value||f<=0)&&(r.value=y)});const v=()=>{core.previousPage()&&n.setCurrentPage(core.getCurrentPage())},g=()=>{core.nextPage()&&n.setCurrentPage(core.getCurrentPage())},d=f=>{if(f.target.blur(),!f.target.value){r.value=n.getCurrentPage;return}core.pageNumberChanged(f.target)};return(f,y)=>{const x=__unplugin_components_0$f,k=_sfc_main$4C,P=__unplugin_components_10$3;return w.value>0&&!u.value?(openBlock(),createElementBlock("div",_hoisted_1$1r,[createVNode(k,{className:"side-arrow-container",img:"icon-previous-left",title:s.value?null:f.$t("common.navigation.previousPage"),onClick:v,disabled:s.value},{default:withCtx(()=>[createVNode(x)]),_:1},8,["title","disabled"]),createBaseVNode("div",_hoisted_2$1i,[withDirectives(createBaseVNode("input",{type:"number","onUpdate:modelValue":y[0]||(y[0]=S=>r.value=S),onInput:y[1]||(y[1]=(...S)=>f.onChange&&f.onChange(...S)),onBlur:d,onKeydown:withKeys(d,["enter"]),tabIndex:"-1",style:normalizeStyle({width:r.value.toString().length*8+2+"px"}),pattern:"\\d*",onkeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",name:"page-nav"},null,36),[[vModelText,r.value]]),createBaseVNode("span",null,toDisplayString(`/${w.value}`),1)]),createVNode(k,{className:"side-arrow-container",img:"icon-next-right",title:m.value?null:f.$t("common.navigation.nextPage"),onClick:g,disabled:m.value},{default:withCtx(()=>[createVNode(P)]),_:1},8,["title","disabled"])])):createCommentVNode("",!0)}}},DocumentContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$1q=createStaticVNode('<div id="printServiceDialog" class="print-dialog"><div class="print-container"><div class="print-title">Preparing document for printing\u2026</div><div class="print-progress"><progress value="0" max="100"></progress><span class="relative-progress">0%</span></div></div></div>',1),_hoisted_2$1h=["innerHTML"],_hoisted_3$16={class:"loading"},_hoisted_4$j={class:"upload-container"},_hoisted_5$9={for:"fileInput"},_sfc_main$1K={__name:"DocumentContainer",props:["isHeaderDisabled"],setup(e){const{isHeaderDisabled:n}=e,{loadDocument:o,initializeViewer:r,getDocumentViewer:u,switchTool:s,switchAnnotationEditorMode:w}=core,m=ref(),v=ref(),g=useViewerStore(),d=useDocumentStore();let f=null;const y=computed(()=>g.getCustomLoading),x=window.localStorage.getItem("customStamps"),k=window.localStorage.getItem("electronicSignatures"),P=window.localStorage.getItem("digitalSignatures");x&&g.setCustomStamps(JSON.parse(x)),k&&g.setElectronicSignature(JSON.parse(k)),P&&g.setDigitalSignature(JSON.parse(P));const S=computed(()=>g.getDisableSignatureTool),E=computed(()=>g.isElementOpen("leftPanel")),M=computed(()=>isMobileDevice?0:E.value?260:0),T=computed(()=>isMobileDevice?0:g.isElementOpen("rightPanel")||g.isElementOpen("pageModePanel")||g.isElementOpen("stampPanel")||g.isElementOpen("linkPanel")||g.isElementOpen("contentEditorPanel")||g.isElementOpen("colorSeparationPanel")||g.isElementOpen("measurePanel")||g.isElementOpen("freetextPanel")||g.isElementOpen("stylePanel")?260:0),D=computed(()=>g.getToolMode),N=computed(()=>g.getCompareStatus),I=computed(()=>n||["view","document","separation"].includes(g.getToolMode)||D.value==="compare"&&N.value!=="finished"?0:["redaction","remove"].includes(_e.value)?window.innerWidth>500?44+48:44+88:D.value==="sign"&&S.value?0:ve.value&&D.value==="sign"?44+44:44),O=computed(()=>g.getUploadLoading&&g.getUpload),F=computed(()=>g.getActiveElementTab("leftPanel")),q=computed(()=>g.getUpload),Y=computed(()=>g.getDisabledElements("pageNavOverlay")),_e=computed(()=>d.getActiveTool),ne=computed(()=>g.getScale),ve=computed(()=>g.getSignatureVerify),J=computed(()=>g.getCommonLoading),fe=computed(()=>g.getVerified);let Z=100,j=0;getHashParameters("d","");function X(Le){if(!isMobileDevice)return;if(_e.value==="polygon"||_e.value==="polyline"||_e.value==="cloudy"){const Ce=Ie(Le),Be=core.getSelectedPage(Ce,Ce).first;if(Be<1)return;const Ve=core.windowToPage(Ce,Be);core.eventBus().dispatch("pdfDbclick",{event:Le,...Ve});return}const le=50,oe=2,ke=ne.value<Z+oe*le?ne.value+le:Z;g.setCurrentScale(ke/100),core.scaleChanged(ke/100)}function H(Le){const le=m.value.querySelector(".page-nav");if(Le.target.nodeName==="A"||(le==null?void 0:le.contains(Le.target))||Le.target.nodeName==="rect")return;const oe=new Date().getTime();oe-j<300&&X(Le),j=oe}async function U(Le){const le=Le.target.files[0];if(!le)return;E.value&&g.closeElement("leftPanel"),g.$patch({fullMode:!1,currentPage:0,scale:"",pageMode:0,scrollMode:"Vertical",activeTab:0,searchStatus:!1,activeElements:{leftPanel:!1,rightPanel:!1,pageModePanel:!1},activeElementsTab:{leftPanel:"THUMBS",rightPanel:"GENERAL"},signatureVerify:0}),d.resetSetting(),core.clearSearchResults(),d.setToolState(""),g.setActiveToolMode("view"),g.setUploadLoading(!0);let oe=le.name;g.setUpload(!0),await Q(le,{filename:oe}),g.setUploadLoading(!1)}const te=computed(()=>d.getLoadingProgress);async function Q(Le,{filename:le=null,password:oe="",onError:ke=null}){const Ce={extension:getHashParameters("extension",null),filename:getHashParameters("filename",null)||le,externalPath:getHashParameters("p",""),documentId:getHashParameters("did",null),progress:d.setLoadingProgress,pageChangedCallback:g.setCurrentPage,scaleChangedCallback:g.setCurrentScale,annotationsNumChangedCallback:d.setAnnotationsCount,distanceChangedCallback:d.setDistance,permissionPasswordCallback:()=>g.openElement("permissionPasswordDialog"),onError:ke,password:oe};try{const Ve=await o(Le,Ce);if(!Ve||!Ve.verified)return;fe.value||(g.setVerified(Ve.verified),g.setLicense(u()._license));const{pwd:Oe}=Ve;d.setFileHasPwd(!!Oe),d.setPassword(Oe),d.setCurrentPdfData(Le,Ce),d.setOutline(core.getOutlines())}catch(Ve){console.log(Ve),g.resetSetting();const Oe=document.getElementById("fileInput");Oe.value="",d.setCurrentPdfData()}const Ee=core.getPagesCount(),Be=core.getScale();d.setTotalPages(Ee),g.setCurrentPage(1),g.setCurrentScale(Be),Z=Math.round(Be*100)}const re=Le=>{d.setSelectedAnnotation(Le)},Pe=()=>{core.getAnnotationManager().getSelectedAnnotation()||d.setSelectedAnnotation(null)},be=Le=>{F.value!=="ANNOTATION"&&g.setActiveElementTab("leftPanel","ANNOTATION"),E.value||g.openElement("leftPanel"),g.openElement("reply"),f&&(clearTimeout(f),f=null),setTimeout(()=>{const le=document.querySelector(".annotation-item.selected");le.scrollIntoView({behavior:"smooth"}),le.classList.contains("flash-border")?(le.classList.remove("flash-border"),clearTimeout(f),f=null):(le.classList.add("flash-border"),f=setTimeout(()=>{var oe;return(oe=document.querySelector(".annotation-item.selected"))==null?void 0:oe.classList.remove("flash-border")},2e3))},300)};function we(Le){Le.isTrusted&&typeof Le.data=="object"&&Le.data.type==="viewerLoaded"&&$e(Le.data.options)}function Ae(){g.setUploadLoading(!1);const Le=Ve=>{Ve!==D.value&&g.setActiveToolMode(Ve)},le=({tool:Ve})=>{d.setActiveTool(Ve)},oe=()=>{const Ve=core.isReadOnlyModeEnabled();if(Ve){D.value&&g.setActiveToolMode("view"),d.setToolState("");const je=core.getAnnotationManager(),Ge=je.getSelectedAnnotation();Ge&&je.deselectAnnotation(Ge)}const Oe=core.isUserAdmin();g.setReadOnly(Ve),g.setUserAdmin(Oe)};core.addEvent("updateAnnotationPermission",oe),core.addEvent("toolModeChanged",Le),core.addEvent("toolChanged",le),core.addEvent("annotationSelected",re),core.addEvent("annotationDeselected",Pe),core.addEvent("openAnnotationReply",be);const ke=document.querySelector(".thumbnail-view"),Ce=document.querySelector(".outline-view"),Ee=document.querySelector(".findbar-view");r({container:m.value,viewer:v.value,thumbnailView:ke,outlineView:Ce,findbarView:Ee,toggleButton:document.querySelector(".toggle-button")}),core.addEvent("onPagesUpdated",Ve=>{const{pageNumber:Oe}=Ve;d.setOutline(core.getOutlines());const je=core.getPagesCount(),Ge=core.getScale();d.setTotalPages(je),g.setCurrentPage(Oe||1),g.setCurrentScale(Ge);const Xe=g.getScrollMode,qe=g.getPageMode,Ke=Xe==="Vertical"?0:1;core.switchScrollMode(Ke),core.switchSpreadMode(qe)});const Be=(Ve,Oe)=>{const je=core.getAnnotationsList();d.initAnnotations(je),setTimeout(()=>{if(Oe==="add"){const Ge=document.getElementById(`annotationList-${Ve.name}`);Ge&&Ge.scrollIntoView({behavior:"smooth",block:"start"})}})};core.addEvent("annotationChanged",Be),core.addEvent("documentloaded",Be)}async function $e(Le){if(!!Le&&Le.pdfUrl){const le=Le.pdfUrl;delete Le.pdfUrl,await window.instance.UI.loadDocument(le,Le)}}window.instance.UI.loadDocument=async(Le,{filename:le="",password:oe="",onError:ke=null}={})=>{!Le||(E.value&&g.closeElement("leftPanel"),g.$patch({fullMode:!1,currentPage:0,scale:"",pageMode:0,scrollMode:"Vertical",activeTab:0,searchStatus:!1,activeElements:{leftPanel:!1,rightPanel:!1},activeElementsTab:{leftPanel:"THUMBS",rightPanel:"GENERAL"}}),d.resetSetting(),core.clearSearchResults(),d.setToolState(""),g.setActiveToolMode("view"),g.setUploadLoading(!0),g.setUpload(!0),await Q(Le,{filename:Le.name||le,password:oe,onError:ke}),g.setUploadLoading(!1))};const Me=(Le,le)=>{const oe=Ie(Le),Ce=core.getSelectedPage(oe,oe).first;if(Ce<1)return;const Ee=core.windowToPage(oe,Ce);core.eventBus().dispatch(le,{event:Le,...Ee})},Ie=Le=>{const le=core.getScrollViewElement(),oe=le.scrollLeft||0,ke=le.scrollTop||0;return{x:Le.pageX+oe,y:Le.pageY+ke}};return onMounted(()=>{document.documentElement.addEventListener("keydown",Le=>{if(Le.target.tagName==="INPUT"||Le.target.tagName==="TEXTAREA")return;(Le.keyCode||Le.which)===27&&_e.value&&(d.setToolState(_e.value),g.toggleActiveHand(!1),s(0),w(0))}),Ae(),window.addEventListener("message",we,!1)}),(Le,le)=>{const oe=_sfc_main$1L,ke=_sfc_main$1O,Ce=_sfc_main$1P,Ee=_sfc_main$1R,Be=_sfc_main$1W,Ve=_sfc_main$1X,Oe=_sfc_main$1Y,je=_sfc_main$1Z,Ge=_sfc_main$20,Xe=_sfc_main$24,qe=_sfc_main$27,Ke=_sfc_main$28,Je=_sfc_main$29,rt=__unplugin_components_13$2,ht=_sfc_main$2a,vt=_sfc_main$2f,Ct=_sfc_main$2n,kt=_sfc_main$2p,mt=_sfc_main$2r,Vt=_sfc_main$2s,bt=_sfc_main$2t,ot=_sfc_main$2E,gt=__unplugin_components_22,tt=_sfc_main$34;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{ref_key:"mainContainer",ref:m,class:normalizeClass(["document-container",{under:D.value==="compare"&&N.value!=="finished"||D.value==="document","no-touch":["selectText","highlight","underline","squiggly","strikeout"].includes(_e.value),redact:["redaction","remove"].includes(_e.value)}]),style:normalizeStyle({width:`calc(100% - ${M.value}px - ${T.value}px)`,"margin-left":`${M.value}px`,"margin-right":`${T.value}px`,"margin-top":`${I.value}px`,top:e.isHeaderDisabled?"0px":"44px"}),onDblclick:X,onClick:H},[createBaseVNode("div",{ref_key:"viewerContainer",ref:v,class:"document",onClick:le[0]||(le[0]=ut=>Me(ut,"pdfClick")),onMousedown:le[1]||(le[1]=ut=>Me(ut,"pdfMousedown")),onDblclick:le[2]||(le[2]=ut=>Me(ut,"pdfDbclick"))},null,544),Y.value?createCommentVNode("",!0):(openBlock(),createBlock(oe,{key:0,style:normalizeStyle({left:`calc(50% + ${M.value/2}px - ${T.value/2}px)`})},null,8,["style"]))],38),createVNode(ke),_hoisted_1$1q,createVNode(Ce),createVNode(Ee),createVNode(Be),createVNode(Ve),createVNode(Oe),createVNode(je),createVNode(Ge),createVNode(Xe),createVNode(qe),createVNode(Ke),createVNode(Je),O.value&&te.value<100?(openBlock(),createElementBlock("div",{key:0,class:"loading-state",innerHTML:y.value?y.value.element:`${Le.$t("common.actions.loading")}...`,style:normalizeStyle(y.value&&y.value.styles?y.value.styles:"")},null,12,_hoisted_2$1h)):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["mask",{active:J.value}])},[withDirectives(createBaseVNode("div",_hoisted_3$16,[createVNode(rt)],512),[[vShow,J.value]])],2),withDirectives(createBaseVNode("div",_hoisted_4$j,[createBaseVNode("input",{id:"fileInput",type:"file",accept:".pdf",onChange:U,name:"document"},null,32),createBaseVNode("label",_hoisted_5$9,toDisplayString(Le.$t("common.actions.upload")),1)],512),[[vShow,!q.value&&F.value!=="COMPARISON"&&["compare","view"].includes(D.value)]]),createVNode(ht),createVNode(vt),createVNode(Ct),createVNode(kt),createVNode(mt),createVNode(Vt),createVNode(bt),createVNode(ot),createVNode(gt),createVNode(tt)],64)}}},SearchItem_vue_vue_type_style_index_0_lang="",_hoisted_1$1p={key:0,class:"page-title"},_hoisted_2$1g=["innerHTML"],_sfc_main$1J={__name:"SearchItem",props:["searchResults","result","currentIndex"],setup(e){const{searchResults:n,result:o,currentIndex:r}=e,u=r===0?r:r-1,s=n[r],w=n[u],m=w===s,v=w.pageNum!==s.pageNum,g=new RegExp(o.searchValue,"gi"),d=o.content.replace(g,function(x,k){return`<span class="highlight">${x}</span>`}),f=useDocumentStore(),y=x=>{core.setActiveSearchResult(toRaw(n[x]),x),f.setActiveSearchResult({index:x,searchResult:n[x]})};return(x,k)=>(openBlock(),createElementBlock(Fragment,null,[m||v?(openBlock(),createElementBlock("div",_hoisted_1$1p,toDisplayString(e.result.pageNum),1)):createCommentVNode("",!0),createBaseVNode("div",{class:"item-content",innerHTML:unref(d),onClick:k[0]||(k[0]=P=>y(e.currentIndex))},null,8,_hoisted_2$1g)],64))}},SearchContent_vue_vue_type_style_index_0_lang="",_hoisted_1$1o={class:"search-number"},_hoisted_2$1f=createBaseVNode("div",{id:"findResultsCount",class:"toolbarLabel"},null,-1),_hoisted_3$15={class:"search-container"},_hoisted_4$i={key:1,class:"no-annotations"},_sfc_main$1I={__name:"SearchContent",setup(e){const n=useDocumentStore(),o=computed(()=>n.getSearchResults);return(r,u)=>{const s=_sfc_main$1J;return openBlock(),createElementBlock(Fragment,null,[withDirectives(createBaseVNode("div",_hoisted_1$1o,[_hoisted_2$1f,createBaseVNode("div",null,toDisplayString(r.$t("panels.left.search.page")),1)],512),[[vShow,o.value.length]]),createBaseVNode("div",_hoisted_3$15,[o.value.length?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(o.value,(w,m)=>(openBlock(),createBlock(s,{key:w,searchResults:o.value,result:w,currentIndex:m},null,8,["searchResults","result","currentIndex"]))),128)):(openBlock(),createElementBlock("div",_hoisted_4$i,toDisplayString(r.$t("panels.left.search.noResults")),1))])],64)}}};var FUNC_ERROR_TEXT="Expected a function",NAN=0/0,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(e,n,o){var r,u,s,w,m,v,g=0,d=!1,f=!1,y=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT);n=toNumber(n)||0,isObject$1(o)&&(d=!!o.leading,f="maxWait"in o,s=f?nativeMax(toNumber(o.maxWait)||0,n):s,y="trailing"in o?!!o.trailing:y);function x(I){var O=r,F=u;return r=u=void 0,g=I,w=e.apply(F,O),w}function k(I){return g=I,m=setTimeout(E,n),d?x(I):w}function P(I){var O=I-v,F=I-g,q=n-O;return f?nativeMin(q,s-F):q}function S(I){var O=I-v,F=I-g;return v===void 0||O>=n||O<0||f&&F>=s}function E(){var I=now();if(S(I))return M(I);m=setTimeout(E,P(I))}function M(I){return m=void 0,y&&r?x(I):(r=u=void 0,w)}function T(){m!==void 0&&clearTimeout(m),g=0,r=v=u=m=void 0}function D(){return m===void 0?w:M(now())}function N(){var I=now(),O=S(I);if(r=arguments,u=this,v=I,O){if(m===void 0)return k(v);if(f)return m=setTimeout(E,n),x(v)}return m===void 0&&(m=setTimeout(E,n)),w}return N.cancel=T,N.flush=D,N}function isObject$1(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function isObjectLike(e){return!!e&&typeof e=="object"}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if(typeof e=="number")return e;if(isSymbol(e))return NAN;if(isObject$1(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=isObject$1(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=e.replace(reTrim,"");var o=reIsBinary.test(e);return o||reIsOctal.test(e)?freeParseInt(e.slice(2),o?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_debounce=debounce;const SearchHeader_vue_vue_type_style_index_0_lang="",_hoisted_1$1n={id:"findbarInputContainer",class:"findbar-input-container"},_hoisted_2$1e={class:"input-container"},_hoisted_3$14=["placeholder"],_hoisted_4$h={class:"button-container"},waitTime=200,_sfc_main$1H={__name:"SearchHeader",setup(e){const n=ref(!1),o=ref(""),r=useDocumentStore(),u=useViewerStore(),s=ref([]),w=ref(0),m=()=>{const k=s.value,P=w.value;if(k.length>0){const S=P<=0?k.length-1:P-1;core.setActiveSearchResult(toRaw(k[S]),S),r.setActiveSearchResult({index:S,searchResult:k[S]}),w.value=S}},v=()=>{const k=s.value,P=w.value;if(k.length>0){const S=P===k.length-1?0:P+1;core.setActiveSearchResult(toRaw(k[S]),S),r.setActiveSearchResult({index:S,searchResult:k[S]}),w.value=S}},g=()=>{n.value=!1,o.value="",r.setSearchResults([]),core.clearSearchResults(),s.value=[],r.setActiveSearchResult(null)},d=lodash_debounce(async k=>{if(k&&k.length>0){n.value=!0;const P=await core.search(k);r.setSearchResults(P),s.value=P,r.setActiveSearchResult({index:0,searchResult:P[0]})}else g()},waitTime),f=k=>{d(k)};watch(o,()=>{f(o.value),w.value=0});const y=computed(()=>u.getActiveElementTab("leftPanel")),x=computed(()=>u.isElementOpen("leftPanel"));return watch([y,x],()=>{(y.value!=="SEARCH"||!x.value)&&(core.clearSearchResults(),o.value="",w.value=0,r.setActiveSearchResult(null))}),(k,P)=>{const S=__unplugin_components_0$x,E=__unplugin_components_0$f,M=_sfc_main$4C,T=__unplugin_components_10$3;return openBlock(),createElementBlock("div",{id:"findbar",class:normalizeClass(["findbar",{mobile:unref(isMobileDevice)}])},[createBaseVNode("div",_hoisted_1$1n,[createBaseVNode("div",_hoisted_2$1e,[withDirectives(createBaseVNode("input",{type:"text",autocomplete:"off",placeholder:k.$t("panels.left.search.placeholder"),"onUpdate:modelValue":P[0]||(P[0]=D=>o.value=D),name:"search"},null,8,_hoisted_3$14),[[vModelText,o.value]]),createVNode(S,{id:"emptyInput",class:normalizeClass(["empty-input",!o.value&&"hidden"]),onClick:g},null,8,["class"])]),createBaseVNode("div",_hoisted_4$h,[createVNode(M,{img:"icon-previous-left",id:"findPrevious",class:normalizeClass(["toolbarButton",!s.value.length&&"disabled"]),title:k.$t("panels.left.search.previous"),onClick:m},{default:withCtx(()=>[createVNode(E)]),_:1},8,["class","title"]),createVNode(M,{img:"icon-next-right",id:"findNext",class:normalizeClass(["toolbarButton",!s.value.length&&"disabled"]),title:k.$t("panels.left.search.next"),onClick:v},{default:withCtx(()=>[createVNode(T)]),_:1},8,["class","title"])])])],2)}}},_sfc_main$1G={};function _sfc_render$V(e,n){const o=_sfc_main$1H,r=_sfc_main$1I;return openBlock(),createElementBlock(Fragment,null,[createVNode(o),createVNode(r)],64)}const __unplugin_components_6$1=_export_sfc(_sfc_main$1G,[["render",_sfc_render$V]]),_sfc_main$1F={},_hoisted_1$1m={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1d=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11 6C11 6.55228 10.5523 7 10 7C9.44772 7 9 6.55228 9 6C9 5.44772 9.44772 5 10 5C10.5523 5 11 5.44772 11 6ZM11 10C11 10.5523 10.5523 11 10 11C9.44772 11 9 10.5523 9 10C9 9.44772 9.44772 9 10 9C10.5523 9 11 9.44772 11 10ZM10 15C10.5523 15 11 14.5523 11 14C11 13.4477 10.5523 13 10 13C9.44772 13 9 13.4477 9 14C9 14.5523 9.44772 15 10 15Z",fill:"currentColor"},null,-1),_hoisted_3$13=[_hoisted_2$1d];function _sfc_render$U(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1m,_hoisted_3$13)}const __unplugin_components_4$5=_export_sfc(_sfc_main$1F,[["render",_sfc_render$U]]),SignatureContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$1l={class:"container"},_hoisted_2$1c={class:"signature-title"},_hoisted_3$12={key:0,class:"signatures"},_hoisted_4$g=["onClick"],_hoisted_5$8=["title"],_hoisted_6$7={class:"drop-down medium"},_hoisted_7$6={key:1,class:"no-signatures"},_sfc_main$1E={__name:"SignatureContainer",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>o.getSignatures),u=computed(()=>o.getSelectedSignature),s=ref(!1),w=d=>{d<0||core.pageNumberChanged({value:(d*1+1).toString()})},m=()=>{s.value=!1,o.setSelectedSignature(null)},v=d=>{s.value=!1,n.openElement(d)},g=(d,f)=>{s.value=!0;const y=d.signature;y.index=f,o.setSelectedSignature(y)};return(d,f)=>{const y=__unplugin_components_0$h,x=__unplugin_components_1$2,k=__unplugin_components_2$b,P=__unplugin_components_4$5,S=_sfc_main$4C;return openBlock(),createElementBlock("div",_hoisted_1$1l,[createBaseVNode("div",_hoisted_2$1c,toDisplayString(d.$t("panels.left.signatures.list")),1),r.value.length?(openBlock(),createElementBlock("div",_hoisted_3$12,[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,(E,M)=>(openBlock(),createElementBlock("div",{key:M,class:normalizeClass(["signature",{focus:u.value&&u.value.index===E.index}]),onClick:T=>w(E.pageIndex)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(E.signature.signerList,(T,D)=>{var N;return openBlock(),createElementBlock(Fragment,null,[T.isCertTrusted&&T.isSignVerified?(openBlock(),createBlock(y,{key:0})):T.isCertTrusted||T.isSignVerified?(openBlock(),createBlock(x,{key:1})):(openBlock(),createBlock(k,{key:2})),createBaseVNode("span",{title:E.name},toDisplayString((T.certificateList[0].subject.CN?T.certificateList[0].subject.CN:"")+"'s signature"),9,_hoisted_5$8),createVNode(unref(NPopover),{placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,show:((N=u.value)==null?void 0:N.index)===M&&s.value,onClickoutside:m},{trigger:withCtx(()=>[createVNode(S,{class:"more",onClick:withModifiers(I=>g(E,M),["stop"])},{default:withCtx(()=>[createVNode(P)]),_:2},1032,["onClick"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_6$7,[createBaseVNode("div",{class:"drop-item",onClick:f[0]||(f[0]=I=>v("signatureDetailsDialog"))},toDisplayString(d.$t("panels.left.signatures.details")),1),createBaseVNode("div",{class:"drop-item",onClick:f[1]||(f[1]=I=>v("certificateViewerDialog"))},toDisplayString(d.$t("panels.left.signatures.certification")),1),createBaseVNode("div",{class:"drop-item",onClick:f[2]||(f[2]=I=>v("deleteConfirmDialog"))},toDisplayString(d.$t("common.actions.delete")),1)])]),_:2},1032,["show"])],64)}),256))],10,_hoisted_4$g))),128))])):(openBlock(),createElementBlock("div",_hoisted_7$6,toDisplayString(d.$t("panels.left.signatures.empty")),1))])}}},Icon_vue_vue_type_style_index_0_lang="",_hoisted_1$1k=["xlink:href"],_sfc_main$1D={__name:"Icon",props:["className","color","glyph","fillColor","strokeColor","disabled"],setup(e){const n=e,o={filter:n.color};n.disabled||(o.color=n.color);const r=computed(()=>`#${n.glyph}`);return(u,s)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["icon",[e.className,{disabled:e.disabled}]]),style:o},[(openBlock(),createElementBlock("svg",mergeProps({class:"svg-icon","aria-hidden":"true"},toHandlers(u.$attrs,!0)),[createBaseVNode("use",{"xlink:href":r.value},null,8,_hoisted_1$1k)],16))],2))}};var axios$3={exports:{}},axios$2={exports:{}},bind$2=function e(n,o){return function(){for(var u=new Array(arguments.length),s=0;s<u.length;s++)u[s]=arguments[s];return n.apply(o,u)}},bind$1=bind$2,toString=Object.prototype.toString,kindOf=function(e){return function(n){var o=toString.call(n);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())}}(Object.create(null));function kindOfTest(e){return e=e.toLowerCase(),function(o){return kindOf(o)===e}}function isArray(e){return Array.isArray(e)}function isUndefined(e){return typeof e>"u"}function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){var n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&isArrayBuffer(e.buffer),n}function isString(e){return typeof e=="string"}function isNumber(e){return typeof e=="number"}function isObject(e){return e!==null&&typeof e=="object"}function isPlainObject(e){if(kindOf(e)!=="object")return!1;var n=Object.getPrototypeOf(e);return n===null||n===Object.prototype}var isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList");function isFunction(e){return toString.call(e)==="[object Function]"}function isStream(e){return isObject(e)&&isFunction(e.pipe)}function isFormData(e){var n="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||toString.call(e)===n||isFunction(e.toString)&&e.toString()===n)}var isURLSearchParams=kindOfTest("URLSearchParams");function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function isStandardBrowserEnv(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function forEach(e,n){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),isArray(e))for(var o=0,r=e.length;o<r;o++)n.call(null,e[o],o,e);else for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&n.call(null,e[u],u,e)}function merge(){var e={};function n(u,s){isPlainObject(e[s])&&isPlainObject(u)?e[s]=merge(e[s],u):isPlainObject(u)?e[s]=merge({},u):isArray(u)?e[s]=u.slice():e[s]=u}for(var o=0,r=arguments.length;o<r;o++)forEach(arguments[o],n);return e}function extend$1(e,n,o){return forEach(n,function(u,s){o&&typeof u=="function"?e[s]=bind$1(u,o):e[s]=u}),e}function stripBOM(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function inherits(e,n,o,r){e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,o&&Object.assign(e.prototype,o)}function toFlatObject(e,n,o){var r,u,s,w={};n=n||{};do{for(r=Object.getOwnPropertyNames(e),u=r.length;u-- >0;)s=r[u],w[s]||(n[s]=e[s],w[s]=!0);e=Object.getPrototypeOf(e)}while(e&&(!o||o(e,n))&&e!==Object.prototype);return n}function endsWith(e,n,o){e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=n.length;var r=e.indexOf(n,o);return r!==-1&&r===o}function toArray(e){if(!e)return null;var n=e.length;if(isUndefined(n))return null;for(var o=new Array(n);n-- >0;)o[n]=e[n];return o}var isTypedArray=function(e){return function(n){return e&&n instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),utils$b={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isFunction,isStream,isURLSearchParams,isStandardBrowserEnv,forEach,merge,extend:extend$1,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,isTypedArray,isFileList},utils$a=utils$b;function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$1=function e(n,o,r){if(!o)return n;var u;if(r)u=r(o);else if(utils$a.isURLSearchParams(o))u=o.toString();else{var s=[];utils$a.forEach(o,function(v,g){v===null||typeof v>"u"||(utils$a.isArray(v)?g=g+"[]":v=[v],utils$a.forEach(v,function(f){utils$a.isDate(f)?f=f.toISOString():utils$a.isObject(f)&&(f=JSON.stringify(f)),s.push(encode(g)+"="+encode(f))}))}),u=s.join("&")}if(u){var w=n.indexOf("#");w!==-1&&(n=n.slice(0,w)),n+=(n.indexOf("?")===-1?"?":"&")+u}return n},utils$9=utils$b;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function e(n,o,r){return this.handlers.push({fulfilled:n,rejected:o,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};InterceptorManager$1.prototype.eject=function e(n){this.handlers[n]&&(this.handlers[n]=null)};InterceptorManager$1.prototype.forEach=function e(n){utils$9.forEach(this.handlers,function(r){r!==null&&n(r)})};var InterceptorManager_1=InterceptorManager$1,utils$8=utils$b,normalizeHeaderName$1=function e(n,o){utils$8.forEach(n,function(u,s){s!==o&&s.toUpperCase()===o.toUpperCase()&&(n[o]=u,delete n[s])})},utils$7=utils$b;function AxiosError$2(e,n,o,r,u){Error.call(this),this.message=e,this.name="AxiosError",n&&(this.code=n),o&&(this.config=o),r&&(this.request=r),u&&(this.response=u)}utils$7.inherits(AxiosError$2,Error,{toJSON:function e(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var prototype=AxiosError$2.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){descriptors[e]={value:e}});Object.defineProperties(AxiosError$2,descriptors);Object.defineProperty(prototype,"isAxiosError",{value:!0});AxiosError$2.from=function(e,n,o,r,u,s){var w=Object.create(prototype);return utils$7.toFlatObject(e,w,function(v){return v!==Error.prototype}),AxiosError$2.call(w,e.message,n,o,r,u),w.name=e.name,s&&Object.assign(w,s),w};var AxiosError_1=AxiosError$2,transitional={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},utils$6=utils$b;function toFormData$1(e,n){n=n||new FormData;var o=[];function r(s){return s===null?"":utils$6.isDate(s)?s.toISOString():utils$6.isArrayBuffer(s)||utils$6.isTypedArray(s)?typeof Blob=="function"?new Blob([s]):Buffer.from(s):s}function u(s,w){if(utils$6.isPlainObject(s)||utils$6.isArray(s)){if(o.indexOf(s)!==-1)throw Error("Circular reference detected in "+w);o.push(s),utils$6.forEach(s,function(v,g){if(!utils$6.isUndefined(v)){var d=w?w+"."+g:g,f;if(v&&!w&&typeof v=="object"){if(utils$6.endsWith(g,"{}"))v=JSON.stringify(v);else if(utils$6.endsWith(g,"[]")&&(f=utils$6.toArray(v))){f.forEach(function(y){!utils$6.isUndefined(y)&&n.append(d,r(y))});return}}u(v,d)}}),o.pop()}else n.append(w,r(s))}return u(e),n}var toFormData_1=toFormData$1,settle,hasRequiredSettle;function requireSettle(){if(hasRequiredSettle)return settle;hasRequiredSettle=1;var e=AxiosError_1;return settle=function(o,r,u){var s=u.config.validateStatus;!u.status||!s||s(u.status)?o(u):r(new e("Request failed with status code "+u.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(u.status/100)-4],u.config,u.request,u))},settle}var cookies,hasRequiredCookies;function requireCookies(){if(hasRequiredCookies)return cookies;hasRequiredCookies=1;var e=utils$b;return cookies=e.isStandardBrowserEnv()?function(){return{write:function(r,u,s,w,m,v){var g=[];g.push(r+"="+encodeURIComponent(u)),e.isNumber(s)&&g.push("expires="+new Date(s).toGMTString()),e.isString(w)&&g.push("path="+w),e.isString(m)&&g.push("domain="+m),v===!0&&g.push("secure"),document.cookie=g.join("; ")},read:function(r){var u=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return u?decodeURIComponent(u[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),cookies}var isAbsoluteURL$1=function e(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)},combineURLs$1=function e(n,o){return o?n.replace(/\/+$/,"")+"/"+o.replace(/^\/+/,""):n},isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1,buildFullPath$1=function e(n,o){return n&&!isAbsoluteURL(o)?combineURLs(n,o):o},parseHeaders,hasRequiredParseHeaders;function requireParseHeaders(){if(hasRequiredParseHeaders)return parseHeaders;hasRequiredParseHeaders=1;var e=utils$b,n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return parseHeaders=function(r){var u={},s,w,m;return r&&e.forEach(r.split(`
`),function(g){if(m=g.indexOf(":"),s=e.trim(g.substr(0,m)).toLowerCase(),w=e.trim(g.substr(m+1)),s){if(u[s]&&n.indexOf(s)>=0)return;s==="set-cookie"?u[s]=(u[s]?u[s]:[]).concat([w]):u[s]=u[s]?u[s]+", "+w:w}}),u},parseHeaders}var isURLSameOrigin,hasRequiredIsURLSameOrigin;function requireIsURLSameOrigin(){if(hasRequiredIsURLSameOrigin)return isURLSameOrigin;hasRequiredIsURLSameOrigin=1;var e=utils$b;return isURLSameOrigin=e.isStandardBrowserEnv()?function(){var o=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),u;function s(w){var m=w;return o&&(r.setAttribute("href",m),m=r.href),r.setAttribute("href",m),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return u=s(window.location.href),function(m){var v=e.isString(m)?s(m):m;return v.protocol===u.protocol&&v.host===u.host}}():function(){return function(){return!0}}(),isURLSameOrigin}var CanceledError_1,hasRequiredCanceledError;function requireCanceledError(){if(hasRequiredCanceledError)return CanceledError_1;hasRequiredCanceledError=1;var e=AxiosError_1,n=utils$b;function o(r){e.call(this,r==null?"canceled":r,e.ERR_CANCELED),this.name="CanceledError"}return n.inherits(o,e,{__CANCEL__:!0}),CanceledError_1=o,CanceledError_1}var parseProtocol,hasRequiredParseProtocol;function requireParseProtocol(){return hasRequiredParseProtocol||(hasRequiredParseProtocol=1,parseProtocol=function(n){var o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return o&&o[1]||""}),parseProtocol}var xhr,hasRequiredXhr;function requireXhr(){if(hasRequiredXhr)return xhr;hasRequiredXhr=1;var e=utils$b,n=requireSettle(),o=requireCookies(),r=buildURL$1,u=buildFullPath$1,s=requireParseHeaders(),w=requireIsURLSameOrigin(),m=transitional,v=AxiosError_1,g=requireCanceledError(),d=requireParseProtocol();return xhr=function(y){return new Promise(function(k,P){var S=y.data,E=y.headers,M=y.responseType,T;function D(){y.cancelToken&&y.cancelToken.unsubscribe(T),y.signal&&y.signal.removeEventListener("abort",T)}e.isFormData(S)&&e.isStandardBrowserEnv()&&delete E["Content-Type"];var N=new XMLHttpRequest;if(y.auth){var I=y.auth.username||"",O=y.auth.password?unescape(encodeURIComponent(y.auth.password)):"";E.Authorization="Basic "+btoa(I+":"+O)}var F=u(y.baseURL,y.url);N.open(y.method.toUpperCase(),r(F,y.params,y.paramsSerializer),!0),N.timeout=y.timeout;function q(){if(!!N){var ne="getAllResponseHeaders"in N?s(N.getAllResponseHeaders()):null,ve=!M||M==="text"||M==="json"?N.responseText:N.response,J={data:ve,status:N.status,statusText:N.statusText,headers:ne,config:y,request:N};n(function(Z){k(Z),D()},function(Z){P(Z),D()},J),N=null}}if("onloadend"in N?N.onloadend=q:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(q)},N.onabort=function(){!N||(P(new v("Request aborted",v.ECONNABORTED,y,N)),N=null)},N.onerror=function(){P(new v("Network Error",v.ERR_NETWORK,y,N,N)),N=null},N.ontimeout=function(){var ve=y.timeout?"timeout of "+y.timeout+"ms exceeded":"timeout exceeded",J=y.transitional||m;y.timeoutErrorMessage&&(ve=y.timeoutErrorMessage),P(new v(ve,J.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,y,N)),N=null},e.isStandardBrowserEnv()){var Y=(y.withCredentials||w(F))&&y.xsrfCookieName?o.read(y.xsrfCookieName):void 0;Y&&(E[y.xsrfHeaderName]=Y)}"setRequestHeader"in N&&e.forEach(E,function(ve,J){typeof S>"u"&&J.toLowerCase()==="content-type"?delete E[J]:N.setRequestHeader(J,ve)}),e.isUndefined(y.withCredentials)||(N.withCredentials=!!y.withCredentials),M&&M!=="json"&&(N.responseType=y.responseType),typeof y.onDownloadProgress=="function"&&N.addEventListener("progress",y.onDownloadProgress),typeof y.onUploadProgress=="function"&&N.upload&&N.upload.addEventListener("progress",y.onUploadProgress),(y.cancelToken||y.signal)&&(T=function(ne){!N||(P(!ne||ne&&ne.type?new g:ne),N.abort(),N=null)},y.cancelToken&&y.cancelToken.subscribe(T),y.signal&&(y.signal.aborted?T():y.signal.addEventListener("abort",T))),S||(S=null);var _e=d(F);if(_e&&["http","https","file"].indexOf(_e)===-1){P(new v("Unsupported protocol "+_e+":",v.ERR_BAD_REQUEST,y));return}N.send(S)})},xhr}var _null,hasRequired_null;function require_null(){return hasRequired_null||(hasRequired_null=1,_null=null),_null}var utils$5=utils$b,normalizeHeaderName=normalizeHeaderName$1,AxiosError$1=AxiosError_1,transitionalDefaults=transitional,toFormData=toFormData_1,DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,n){!utils$5.isUndefined(e)&&utils$5.isUndefined(e["Content-Type"])&&(e["Content-Type"]=n)}function getDefaultAdapter(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=requireXhr()),e}function stringifySafely(e,n,o){if(utils$5.isString(e))try{return(n||JSON.parse)(e),utils$5.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(o||JSON.stringify)(e)}var defaults$4={transitional:transitionalDefaults,adapter:getDefaultAdapter(),transformRequest:[function e(n,o){if(normalizeHeaderName(o,"Accept"),normalizeHeaderName(o,"Content-Type"),utils$5.isFormData(n)||utils$5.isArrayBuffer(n)||utils$5.isBuffer(n)||utils$5.isStream(n)||utils$5.isFile(n)||utils$5.isBlob(n))return n;if(utils$5.isArrayBufferView(n))return n.buffer;if(utils$5.isURLSearchParams(n))return setContentTypeIfUnset(o,"application/x-www-form-urlencoded;charset=utf-8"),n.toString();var r=utils$5.isObject(n),u=o&&o["Content-Type"],s;if((s=utils$5.isFileList(n))||r&&u==="multipart/form-data"){var w=this.env&&this.env.FormData;return toFormData(s?{"files[]":n}:n,w&&new w)}else if(r||u==="application/json")return setContentTypeIfUnset(o,"application/json"),stringifySafely(n);return n}],transformResponse:[function e(n){var o=this.transitional||defaults$4.transitional,r=o&&o.silentJSONParsing,u=o&&o.forcedJSONParsing,s=!r&&this.responseType==="json";if(s||u&&utils$5.isString(n)&&n.length)try{return JSON.parse(n)}catch(w){if(s)throw w.name==="SyntaxError"?AxiosError$1.from(w,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):w}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:require_null()},validateStatus:function e(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};utils$5.forEach(["delete","get","head"],function e(n){defaults$4.headers[n]={}});utils$5.forEach(["post","put","patch"],function e(n){defaults$4.headers[n]=utils$5.merge(DEFAULT_CONTENT_TYPE)});var defaults_1=defaults$4,utils$4=utils$b,defaults$3=defaults_1,transformData$1=function e(n,o,r){var u=this||defaults$3;return utils$4.forEach(r,function(w){n=w.call(u,n,o)}),n},isCancel$1,hasRequiredIsCancel;function requireIsCancel(){return hasRequiredIsCancel||(hasRequiredIsCancel=1,isCancel$1=function(n){return!!(n&&n.__CANCEL__)}),isCancel$1}var utils$3=utils$b,transformData=transformData$1,isCancel=requireIsCancel(),defaults$2=defaults_1,CanceledError=requireCanceledError();function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError}var dispatchRequest$1=function e(n){throwIfCancellationRequested(n),n.headers=n.headers||{},n.data=transformData.call(n,n.data,n.headers,n.transformRequest),n.headers=utils$3.merge(n.headers.common||{},n.headers[n.method]||{},n.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],function(u){delete n.headers[u]});var o=n.adapter||defaults$2.adapter;return o(n).then(function(u){return throwIfCancellationRequested(n),u.data=transformData.call(n,u.data,u.headers,n.transformResponse),u},function(u){return isCancel(u)||(throwIfCancellationRequested(n),u&&u.response&&(u.response.data=transformData.call(n,u.response.data,u.response.headers,n.transformResponse))),Promise.reject(u)})},utils$2=utils$b,mergeConfig$2=function e(n,o){o=o||{};var r={};function u(d,f){return utils$2.isPlainObject(d)&&utils$2.isPlainObject(f)?utils$2.merge(d,f):utils$2.isPlainObject(f)?utils$2.merge({},f):utils$2.isArray(f)?f.slice():f}function s(d){if(utils$2.isUndefined(o[d])){if(!utils$2.isUndefined(n[d]))return u(void 0,n[d])}else return u(n[d],o[d])}function w(d){if(!utils$2.isUndefined(o[d]))return u(void 0,o[d])}function m(d){if(utils$2.isUndefined(o[d])){if(!utils$2.isUndefined(n[d]))return u(void 0,n[d])}else return u(void 0,o[d])}function v(d){if(d in o)return u(n[d],o[d]);if(d in n)return u(void 0,n[d])}var g={url:w,method:w,data:w,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:v};return utils$2.forEach(Object.keys(n).concat(Object.keys(o)),function(f){var y=g[f]||s,x=y(f);utils$2.isUndefined(x)&&y!==v||(r[f]=x)}),r},data,hasRequiredData;function requireData(){return hasRequiredData||(hasRequiredData=1,data={version:"0.27.2"}),data}var VERSION=requireData().version,AxiosError=AxiosError_1,validators$1={};["object","boolean","number","function","string","symbol"].forEach(function(e,n){validators$1[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});var deprecatedWarnings={};validators$1.transitional=function e(n,o,r){function u(s,w){return"[Axios v"+VERSION+"] Transitional option '"+s+"'"+w+(r?". "+r:"")}return function(s,w,m){if(n===!1)throw new AxiosError(u(w," has been removed"+(o?" in "+o:"")),AxiosError.ERR_DEPRECATED);return o&&!deprecatedWarnings[w]&&(deprecatedWarnings[w]=!0,console.warn(u(w," has been deprecated since v"+o+" and will be removed in the near future"))),n?n(s,w,m):!0}};function assertOptions(e,n,o){if(typeof e!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),u=r.length;u-- >0;){var s=r[u],w=n[s];if(w){var m=e[s],v=m===void 0||w(m,s,e);if(v!==!0)throw new AxiosError("option "+s+" must be "+v,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new AxiosError("Unknown option "+s,AxiosError.ERR_BAD_OPTION)}}var validator$1={assertOptions,validators:validators$1},utils$1=utils$b,buildURL=buildURL$1,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2,buildFullPath=buildFullPath$1,validator=validator$1,validators=validator.validators;function Axios$1(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function e(n,o){typeof n=="string"?(o=o||{},o.url=n):o=n||{},o=mergeConfig$1(this.defaults,o),o.method?o.method=o.method.toLowerCase():this.defaults.method?o.method=this.defaults.method.toLowerCase():o.method="get";var r=o.transitional;r!==void 0&&validator.assertOptions(r,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1);var u=[],s=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(o)===!1||(s=s&&x.synchronous,u.unshift(x.fulfilled,x.rejected))});var w=[];this.interceptors.response.forEach(function(x){w.push(x.fulfilled,x.rejected)});var m;if(!s){var v=[dispatchRequest,void 0];for(Array.prototype.unshift.apply(v,u),v=v.concat(w),m=Promise.resolve(o);v.length;)m=m.then(v.shift(),v.shift());return m}for(var g=o;u.length;){var d=u.shift(),f=u.shift();try{g=d(g)}catch(y){f(y);break}}try{m=dispatchRequest(g)}catch(y){return Promise.reject(y)}for(;w.length;)m=m.then(w.shift(),w.shift());return m};Axios$1.prototype.getUri=function e(n){n=mergeConfig$1(this.defaults,n);var o=buildFullPath(n.baseURL,n.url);return buildURL(o,n.params,n.paramsSerializer)};utils$1.forEach(["delete","get","head","options"],function e(n){Axios$1.prototype[n]=function(o,r){return this.request(mergeConfig$1(r||{},{method:n,url:o,data:(r||{}).data}))}});utils$1.forEach(["post","put","patch"],function e(n){function o(r){return function(s,w,m){return this.request(mergeConfig$1(m||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:w}))}}Axios$1.prototype[n]=o(),Axios$1.prototype[n+"Form"]=o(!0)});var Axios_1=Axios$1,CancelToken_1,hasRequiredCancelToken;function requireCancelToken(){if(hasRequiredCancelToken)return CancelToken_1;hasRequiredCancelToken=1;var e=requireCanceledError();function n(o){if(typeof o!="function")throw new TypeError("executor must be a function.");var r;this.promise=new Promise(function(w){r=w});var u=this;this.promise.then(function(s){if(!!u._listeners){var w,m=u._listeners.length;for(w=0;w<m;w++)u._listeners[w](s);u._listeners=null}}),this.promise.then=function(s){var w,m=new Promise(function(v){u.subscribe(v),w=v}).then(s);return m.cancel=function(){u.unsubscribe(w)},m},o(function(w){u.reason||(u.reason=new e(w),r(u.reason))})}return n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.prototype.subscribe=function(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]},n.prototype.unsubscribe=function(r){if(!!this._listeners){var u=this._listeners.indexOf(r);u!==-1&&this._listeners.splice(u,1)}},n.source=function(){var r,u=new n(function(w){r=w});return{token:u,cancel:r}},CancelToken_1=n,CancelToken_1}var spread,hasRequiredSpread;function requireSpread(){return hasRequiredSpread||(hasRequiredSpread=1,spread=function(n){return function(r){return n.apply(null,r)}}),spread}var isAxiosError,hasRequiredIsAxiosError;function requireIsAxiosError(){if(hasRequiredIsAxiosError)return isAxiosError;hasRequiredIsAxiosError=1;var e=utils$b;return isAxiosError=function(o){return e.isObject(o)&&o.isAxiosError===!0},isAxiosError}var utils=utils$b,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults$1=defaults_1;function createInstance(e){var n=new Axios(e),o=bind(Axios.prototype.request,n);return utils.extend(o,Axios.prototype,n),utils.extend(o,n),o.create=function(u){return createInstance(mergeConfig(e,u))},o}var axios$1=createInstance(defaults$1);axios$1.Axios=Axios;axios$1.CanceledError=requireCanceledError();axios$1.CancelToken=requireCancelToken();axios$1.isCancel=requireIsCancel();axios$1.VERSION=requireData().version;axios$1.toFormData=toFormData_1;axios$1.AxiosError=AxiosError_1;axios$1.Cancel=axios$1.CanceledError;axios$1.all=function e(n){return Promise.all(n)};axios$1.spread=requireSpread();axios$1.isAxiosError=requireIsAxiosError();axios$2.exports=axios$1;axios$2.exports.default=axios$1;(function(e){e.exports=axios$2.exports})(axios$3);const axios=getDefaultExportFromCjs(axios$3.exports);var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,n,o)=>n in e?__defProp(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,__spreadValues=(e,n)=>{for(var o in n||(n={}))__hasOwnProp.call(n,o)&&__defNormalProp(e,o,n[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(n))__propIsEnum.call(n,o)&&__defNormalProp(e,o,n[o]);return e},__spreadProps=(e,n)=>__defProps(e,__getOwnPropDescs(n));function useAxios(...e){const n=typeof e[0]=="string"?e[0]:void 0,o=isString$1(n)?1:0;let r={},u=axios,s={immediate:!!o,shallow:!0};const w=N=>!!(N!=null&&N.request);e.length>0+o&&(w(e[0+o])?u=e[0+o]:r=e[0+o]),e.length>1+o&&w(e[1+o])&&(u=e[1+o]),(e.length===2+o&&!w(e[1+o])||e.length===3+o)&&(s=e[e.length-1]);const m=shallowRef(),v=s.shallow?shallowRef():ref(),g=ref(!1),d=ref(!1),f=ref(!1),y=shallowRef(),x=axios.CancelToken.source;let k=x();const P=N=>{g.value||!d.value||(k.cancel(N),k=x(),f.value=!0,d.value=!1,g.value=!1)},S=N=>{d.value=N,g.value=!N},E=()=>new Promise((N,I)=>{until(g).toBe(!0).then(()=>N(D)).catch(I)}),M=(N,I)=>E().then(N,I),T=(N=n,I={})=>{y.value=void 0;const O=typeof N=="string"?N:n!=null?n:I.url;return O===void 0?(y.value=new axios$3.exports.AxiosError(axios$3.exports.AxiosError.ERR_INVALID_URL),g.value=!0,{then:M}):(P(),S(!0),u(O,__spreadProps(__spreadValues(__spreadValues({},r),typeof N=="object"?N:I),{cancelToken:k.token})).then(F=>{var q;m.value=F;const Y=F.data;v.value=Y,(q=s.onSuccess)==null||q.call(s,Y)}).catch(F=>{var q;y.value=F,(q=s.onError)==null||q.call(s,F)}).finally(()=>S(!1)),{then:M})};s.immediate&&n&&T();const D={response:m,data:v,error:y,finished:g,loading:d,isFinished:g,isLoading:d,cancel:P,isAborted:f,canceled:f,aborted:f,isCanceled:f,abort:P,execute:T};return __spreadProps(__spreadValues({},D),{then:M})}const Compare_vue_vue_type_style_index_0_lang="",_hoisted_1$1j=createBaseVNode("div",{class:"file-text"},[createBaseVNode("span",{class:"circle circle-red"}),createBaseVNode("p",null,"First File")],-1),_hoisted_2$1b=createBaseVNode("div",{class:"file-text"},[createBaseVNode("span",{class:"circle circle-blue"}),createBaseVNode("p",null,"Second File")],-1),_sfc_main$1C={__name:"Compare",setup(e){const{loadDocument:n,getOptionUrl:o}=core,r=ref(),u=ref(),s=useViewerStore(),w=useDocumentStore();let m=reactive({firstFile:null,secondFile:null});const v=ref(!1),g=x=>x.click(),d=computed(()=>!(m.firstFile&&m.secondFile)),f=(x,k)=>{x.preventDefault(),m[k]=x.target.files[0]},y=async()=>{const x=o();if(!v.value&&!d.value){v.value=!0;const k=new FormData;k.append("firstFile",m.firstFile),k.append("secondFile",m.secondFile);const{data:P,isFinished:S}=await useAxios(`${x.compareBaseUrl||x.baseUrl}${x.compareUrl}`,{method:"POST",data:k,responseType:"arraybuffer"});if(S.value){v.value=!1;const E={progress:w.setLoadingProgress,pageChangedCallback:s.setCurrentPage,scaleChangedCallback:s.setCurrentScale,annotationsNumChangedCallback:w.setAnnotationsCount,distanceChangedCallback:w.setDistance};await n(P.value,E),s.toggleElement("leftPanel");const M=core.getPagesCount(),T=core.getScale();w.setTotalPages(M),s.setCurrentScale(T),s.setCurrentPage(1)}}};return(x,k)=>{const P=_sfc_main$1D;return openBlock(),createElementBlock(Fragment,null,[_hoisted_1$1j,createBaseVNode("button",{onClick:k[0]||(k[0]=S=>g(r.value))},"Select File"),createBaseVNode("input",{ref_key:"firstFileInput",ref:r,class:"hidden",type:"file",onChange:k[1]||(k[1]=S=>f(S,"firstFile")),accept:".pdf",name:"compare"},null,544),createBaseVNode("p",null,toDisplayString(unref(m).firstFile&&unref(m).firstFile.name),1),_hoisted_2$1b,createBaseVNode("button",{onClick:k[2]||(k[2]=S=>g(u.value))},"Select File"),createBaseVNode("input",{ref_key:"secondFileInput",ref:u,class:"hidden",type:"file",onChange:k[3]||(k[3]=S=>f(S,"secondFile")),accept:".pdf",name:"compare"},null,544),createBaseVNode("p",null,toDisplayString(unref(m).secondFile&&unref(m).secondFile.name),1),createBaseVNode("button",{class:normalizeClass(["compare-button",{disabled:d.value}]),onClick:y},[createTextVNode(" Compare "),v.value?(openBlock(),createBlock(P,{key:0,glyph:"icon-loading",class:normalizeClass(x.iconClassName)},null,8,["class"])):createCommentVNode("",!0)],2)],64)}}},LayerPropertyDialog_vue_vue_type_style_index_0_lang="",_hoisted_1$1i={key:0,class:"layer-property-popup"},_hoisted_2$1a={class:"title"},_hoisted_3$11={class:"container"},_hoisted_4$f=["placeholder"],_hoisted_5$7={class:"text-start"},_hoisted_6$6={class:"select-container"},_hoisted_7$5={value:1},_hoisted_8$4={value:0},_hoisted_9$4={class:"select-container"},_hoisted_10$3={value:0},_hoisted_11$2={value:1},_hoisted_12$2={value:2},_hoisted_13$2={class:"select-container"},_hoisted_14$2={value:0},_hoisted_15$2={value:1},_hoisted_16$2={value:2},dialogName="layerPropertyDialog",_sfc_main$1B={__name:"LayerPropertyDialog",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.isElementOpen(dialogName)),u=computed(()=>o.getSelectedLayer),s=ref(""),w=ref(0),m=ref(0),v=ref(3),g=ref(3),d=ref(!1);watch(r,(x,k)=>{x&&(s.value=u.value.name,w.value=u.value.defaultVisible,m.value=u.value.isLocked,v.value=u.value.printState,g.value=u.value.exportState),d.value=!1}),watch([s,w,m,v,g],(x,k)=>{!u.value||(d.value=!((u.value.name===x[0]||x[0].trim()==="")&&u.value.defaultVisible===x[1]&&u.value.isLocked===x[2]&&u.value.printState===x[3]&&u.value.exportState===x[4]))});const f=()=>{n.closeElement(dialogName),o.setSelectedLayer(null)},y=async()=>{const x={node:u.value.node};s.value!==""&&s.value!==u.value.name&&(x.name=u.value.name=s.value),w.value!==u.value.defaultVisible&&(x.defaultVisible=u.value.defaultVisible=w.value),m.value!==u.value.isLocked&&(x.isLocked=u.value.isLocked=m.value),v.value!==u.value.printState&&(x.printState=u.value.printState=v.value),g.value!==u.value.exportState&&(x.exportState=u.value.exportState=g.value),w.value!==u.value.visible&&(x.visible=u.value.visible=w.value,x.ocg=u.value.ocg),core.setLayers(x),f()};return(x,k)=>{const P=__unplugin_components_0$u,S=__unplugin_components_1$g,E=_sfc_main$4v;return r.value?(openBlock(),createElementBlock("div",_hoisted_1$1i,[createVNode(E,{show:r.value,dialogName,close:f},{header:withCtx(()=>[createBaseVNode("p",_hoisted_2$1a,toDisplayString(x.$t("layer.properties.layerProperty")),1)]),footer:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:!d.value}]),onClick:y},toDisplayString(x.$t("common.actions.ok")),3)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3$11,[createBaseVNode("span",null,toDisplayString(x.$t("layer.properties.name")),1),withDirectives(createBaseVNode("input",{type:"text",placeholder:x.$t("layer.properties.namePlaceholder"),name:"layerName","onUpdate:modelValue":k[0]||(k[0]=M=>s.value=M),maxlength:"50"},null,8,_hoisted_4$f),[[vModelText,s.value]]),createBaseVNode("span",_hoisted_5$7,toDisplayString(x.$t("layer.properties.defaultSettings")),1),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_6$6,[withDirectives(createBaseVNode("select",{name:"defaultSetting","onUpdate:modelValue":k[1]||(k[1]=M=>w.value=M)},[createBaseVNode("option",_hoisted_7$5,toDisplayString(x.$t("layer.properties.defaultShow")),1),createBaseVNode("option",_hoisted_8$4,toDisplayString(x.$t("layer.properties.defaultHide")),1)],512),[[vModelSelect,w.value]]),createVNode(P)]),createBaseVNode("div",{class:"check-box",onClick:k[2]||(k[2]=M=>m.value=(m.value+1)%2)},[createBaseVNode("div",{class:normalizeClass(["check",{active:m.value}])},[withDirectives(createVNode(S,null,null,512),[[vShow,m.value]])],2),createBaseVNode("span",null,toDisplayString(x.$t("layer.properties.lockLayer")),1)])]),createBaseVNode("span",null,toDisplayString(x.$t("layer.properties.printProperty")),1),createBaseVNode("div",_hoisted_9$4,[withDirectives(createBaseVNode("select",{name:"printProperty","onUpdate:modelValue":k[3]||(k[3]=M=>v.value=M)},[createBaseVNode("option",_hoisted_10$3,toDisplayString(x.$t("layer.properties.always")),1),createBaseVNode("option",_hoisted_11$2,toDisplayString(x.$t("layer.properties.never")),1),createBaseVNode("option",_hoisted_12$2,toDisplayString(x.$t("layer.properties.printVisible")),1)],512),[[vModelSelect,v.value]]),createVNode(P)]),createBaseVNode("span",null,toDisplayString(x.$t("layer.properties.exportProperty")),1),createBaseVNode("div",_hoisted_13$2,[withDirectives(createBaseVNode("select",{name:"exportProperty","onUpdate:modelValue":k[4]||(k[4]=M=>g.value=M)},[createBaseVNode("option",_hoisted_14$2,toDisplayString(x.$t("layer.properties.always")),1),createBaseVNode("option",_hoisted_15$2,toDisplayString(x.$t("layer.properties.never")),1),createBaseVNode("option",_hoisted_16$2,toDisplayString(x.$t("layer.properties.exportVisible")),1)],512),[[vModelSelect,g.value]]),createVNode(P)])])]),_:1},8,["show"])])):createCommentVNode("",!0)}}},_sfc_main$1A={},_hoisted_1$1h={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$19=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 8H12V7C12 5.89543 11.1046 5 10 5C8.89543 5 8 5.89543 8 7V8ZM7 8H6C5.44772 8 5 8.44772 5 9V15C5 15.5523 5.44772 16 6 16H14C14.5523 16 15 15.5523 15 15V9C15 8.44772 14.5523 8 14 8H13V7C13 5.34315 11.6569 4 10 4C8.34315 4 7 5.34315 7 7V8Z",fill:"currentColor"},null,-1),_hoisted_3$10=[_hoisted_2$19];function _sfc_render$T(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1h,_hoisted_3$10)}const __unplugin_components_3$5=_export_sfc(_sfc_main$1A,[["render",_sfc_render$T]]),_sfc_main$1z={},_hoisted_1$1g={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$18=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 3H17V17H3V3ZM2 3C2 2.44772 2.44772 2 3 2H17C17.5523 2 18 2.44772 18 3V17C18 17.5523 17.5523 18 17 18H3C2.44772 18 2 17.5523 2 17V3ZM5.40381 5L15.3033 14.8995L14.5962 15.6066L4.6967 5.70711L5.40381 5ZM5.82074 8.24536C4.69777 9.2643 4 10.3033 4 10.3033C4 10.3033 6.68629 14.3033 10 14.3033C10.5489 14.3033 11.0806 14.1935 11.5858 14.0104L5.82074 8.24536ZM14.1793 12.3612C15.3022 11.3423 16 10.3033 16 10.3033C16 10.3033 13.3137 6.3033 10 6.3033C9.45108 6.3033 8.91937 6.41306 8.41424 6.59622L14.1793 12.3612Z",fill:"currentColor"},null,-1),_hoisted_3$$=[_hoisted_2$18];function _sfc_render$S(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1g,_hoisted_3$$)}const __unplugin_components_2$9=_export_sfc(_sfc_main$1z,[["render",_sfc_render$S]]),_sfc_main$1y={},_hoisted_1$1f={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$17=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 3H17V17H3V3ZM2 3C2 2.44772 2.44772 2 3 2H17C17.5523 2 18 2.44772 18 3V17C18 17.5523 17.5523 18 17 18H3C2.44772 18 2 17.5523 2 17V3ZM16 10C16 10 13.3137 14 10 14C6.68629 14 4 10 4 10C4 10 6.68629 6 10 6C13.3137 6 16 10 16 10ZM12 10C12 11.1046 11.1046 12 10 12C8.89543 12 8 11.1046 8 10C8 8.89543 8.89543 8 10 8C11.1046 8 12 8.89543 12 10Z",fill:"currentColor"},null,-1),_hoisted_3$_=[_hoisted_2$17];function _sfc_render$R(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1f,_hoisted_3$_)}const __unplugin_components_1$1=_export_sfc(_sfc_main$1y,[["render",_sfc_render$R]]),_sfc_main$1x={},_hoisted_1$1e={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$16=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.01025 4L11 8.0041L6 12L6.01025 4Z",fill:"currentColor"},null,-1),_hoisted_3$Z=[_hoisted_2$16];function _sfc_render$Q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1e,_hoisted_3$Z)}const __unplugin_components_0$e=_export_sfc(_sfc_main$1x,[["render",_sfc_render$Q]]),Layer_vue_vue_type_style_index_0_lang="",_hoisted_1$1d={class:"layer"},_hoisted_2$15=["title"],_hoisted_3$Y={class:"drop-down medium"},_sfc_main$1w={__name:"Layer",props:["layer","level"],setup(e,{emit:n}){const o=n,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getSelectedLayer),w=ref(!1),m=ref(!1),v=ref(!1),g=ref(""),d=ref(null),f=N=>{N.stopPropagation(),w.value=!w.value},y=()=>{m.value=!1,r.setSelectedLayer(null)},x=N=>{m.value=!1,u.openElement(N)},k=N=>{m.value=!0,r.setSelectedLayer(N)},P=N=>{if(N.isLocked){S(N);return}N.visible=(N.visible+1)%2,core.setLayers({node:N.node,visible:N.visible,ocg:N.ocg})},S=N=>{r.setSelectedLayer(N),o("showTipDialog",N)},E=async N=>{m.value=!1,u.setCommonLoading(!0);const O=(F=>{for(;F;){if(F.ocg)return F.ocg;F=F.children[0]}})(N);if(!O){console.error("Unable to export."),r.setSelectedLayer(null),u.setCommonLoading(!1);return}await core.exportLayers(O,!0),r.setSelectedLayer(null),u.setCommonLoading(!1)},M=N=>{g.value=N,v.value=!0,nextTick(()=>{d.value.focus(),d.value.select()})},T=N=>{if(!g.value.trim()){v.value=!1;return}N.name=g.value,core.setLayers({node:N.node,name:g.value}),v.value=!1},D=N=>{v.value&&d.value&&!d.value.contains(N.target)&&(v.value=!1)};return onMounted(()=>{window.addEventListener("click",D)}),onBeforeUnmount(()=>{window.removeEventListener("click",D)}),(N,I)=>{var J;const O=__unplugin_components_0$e,F=__unplugin_components_1$1,q=__unplugin_components_2$9,Y=__unplugin_components_3$5,_e=__unplugin_components_4$5,ne=_sfc_main$4C,ve=resolveComponent("Layer",!0);return openBlock(),createElementBlock("div",_hoisted_1$1d,[createBaseVNode("div",{class:normalizeClass(["layer-item",{focus:s.value&&s.value.node===e.layer.node}])},[createBaseVNode("div",{class:normalizeClass(["layer-item-toggle",w.value&&"active"]),style:normalizeStyle({marginLeft:12*e.level+"px"})},[e.layer.children.length?(openBlock(),createBlock(O,{key:0,onClick:f})):createCommentVNode("",!0)],6),e.layer.visible?(openBlock(),createBlock(F,{key:0,onClick:I[0]||(I[0]=fe=>P(e.layer))})):(openBlock(),createBlock(q,{key:1,onClick:I[1]||(I[1]=fe=>P(e.layer))})),createBaseVNode("div",{class:"layer-item-name",onClick:D},[v.value?withDirectives((openBlock(),createElementBlock("input",{key:1,type:"text","onUpdate:modelValue":I[3]||(I[3]=fe=>g.value=fe),onBlur:I[4]||(I[4]=fe=>v.value=!1),onKeyup:I[5]||(I[5]=withKeys(fe=>T(e.layer),["enter"])),ref_key:"nameInputRef",ref:d,maxlength:"50"},null,544)),[[vModelText,g.value]]):(openBlock(),createElementBlock("span",{key:0,onDblclick:I[2]||(I[2]=fe=>M(e.layer.name)),title:e.layer.name},toDisplayString(e.layer.name),41,_hoisted_2$15))]),e.layer.isLocked?(openBlock(),createBlock(Y,{key:2,onClick:I[6]||(I[6]=fe=>S(e.layer))})):createCommentVNode("",!0),createVNode(unref(NPopover),{placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,show:((J=s.value)==null?void 0:J.name)===e.layer.name&&m.value,onClickoutside:y,class:"no-margin-top"},{trigger:withCtx(()=>[createVNode(ne,{class:"more",onClick:I[7]||(I[7]=withModifiers(fe=>k(e.layer),["stop"])),title:N.$t("panels.left.layers.menu")},{default:withCtx(()=>[createVNode(_e)]),_:1},8,["title"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3$Y,[createBaseVNode("div",{class:"drop-item",onClick:I[8]||(I[8]=fe=>x("layerPropertyDialog"))},toDisplayString(N.$t("panels.left.layers.layerProperty")),1),createBaseVNode("div",{class:"drop-item",onClick:I[9]||(I[9]=fe=>E(e.layer))},toDisplayString(N.$t("panels.left.layers.exportLayer")),1)])]),_:1},8,["show"])],2),w.value?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(e.layer.children,fe=>(openBlock(),createBlock(ve,{layer:fe,level:e.level+1,onShowTipDialog:S},null,8,["layer","level"]))),256)):createCommentVNode("",!0)])}}},_sfc_main$1v={},_hoisted_1$1c={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$14=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 5.25C3 4.83579 3.33579 4.5 3.75 4.5H16.2516C16.6659 4.5 17.0016 4.83579 17.0016 5.25C17.0016 5.66421 16.6659 6 16.2516 6H3.75C3.33579 6 3 5.66421 3 5.25ZM3 10.0006C3 9.58635 3.33579 9.25056 3.75 9.25056H16.2516C16.6659 9.25056 17.0016 9.58635 17.0016 10.0006C17.0016 10.4148 16.6659 10.7506 16.2516 10.7506H3.75C3.33579 10.7506 3 10.4148 3 10.0006ZM3.75 14.0012C3.33579 14.0012 3 14.337 3 14.7512C3 15.1654 3.33579 15.5012 3.75 15.5012H16.2516C16.6659 15.5012 17.0016 15.1654 17.0016 14.7512C17.0016 14.337 16.6659 14.0012 16.2516 14.0012H3.75Z",fill:"currentColor"},null,-1),_hoisted_3$X=[_hoisted_2$14];function _sfc_render$P(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$1c,_hoisted_3$X)}const __unplugin_components_0$d=_export_sfc(_sfc_main$1v,[["render",_sfc_render$P]]),LayerContainer_vue_vue_type_style_index_0_lang="",_hoisted_1$1b={class:"container"},_hoisted_2$13={class:"layer-title"},_hoisted_3$W={class:"drop-down medium"},_hoisted_4$e={key:1,class:"no-layers"},_hoisted_5$6={key:0,class:"layer-locked-tip-popup"},_sfc_main$1u={__name:"LayerContainer",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>o.getLayers),u=computed(()=>{const P=S=>S.some(E=>{if(E.exportState===0||E.exportState!==1&&E.visible)return!0;if(Array.isArray(E.children)&&E.children.length)return P(E.children)});return P(r.value)}),s=computed(()=>k(!1)),w=computed(()=>k(!0)),m=ref(!1),v=ref(),g=ref(!1),d=P=>{o.setLayers(P),g.value=!P.some(S=>S.children.length)};core.addEvent("getLayers",d);const f=P=>{m.value=!1,P?n.openElement("layerPropertyDialog"):o.setSelectedLayer(null)},y=()=>{m.value=!0},x=async P=>{if(v.value.setShow(!1),P==="show"||P==="hide"){const S=[],E=(M,T)=>{M.forEach(D=>{D.isLocked||(D.visible=T,S.push({node:D.node,visible:T,ocg:D.ocg})),Array.isArray(D.children)&&D.children.length&&E(D.children,T)})};E(r.value,P==="show"?1:0),S.length&&core.setLayers(S)}if(P==="restore"){const S=[],E=M=>{M.forEach(T=>{T.visible!==T.defaultVisible&&(T.visible=T.defaultVisible,S.push({node:T.node,visible:T.defaultVisible,ocg:T.ocg})),Array.isArray(T.children)&&T.children.length&&E(T.children)})};E(r.value),S.length&&core.setLayers(S)}P==="export"&&(n.setCommonLoading(!0),await core.exportLayers(null,!0),n.setCommonLoading(!1))},k=P=>r.value.some(S=>(P?S.visible:!S.visible)?!0:Array.isArray(S.children)&&S.children.length?k(S.children):!1);return(P,S)=>{const E=__unplugin_components_0$d,M=_sfc_main$1w,T=__unplugin_components_2$f,D=_sfc_main$4v,N=_sfc_main$1B;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$1b,[createBaseVNode("div",_hoisted_2$13,[createTextVNode(toDisplayString(P.$t("panels.left.layers.title"))+" ",1),r.value.length?(openBlock(),createBlock(unref(NPopover),{key:0,placement:"bottom-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,class:"no-margin-top layer-title-popover",ref_key:"layersMenuPopover",ref:v},{trigger:withCtx(()=>[createVNode(E)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3$W,[createBaseVNode("div",{class:normalizeClass(["drop-item",{disabled:!s.value}]),onClick:S[0]||(S[0]=I=>x("show"))},toDisplayString(P.$t("panels.left.layers.showAll")),3),createBaseVNode("div",{class:normalizeClass(["drop-item",{disabled:!w.value}]),onClick:S[1]||(S[1]=I=>x("hide"))},toDisplayString(P.$t("panels.left.layers.hideAll")),3),createBaseVNode("div",{class:"drop-item",onClick:S[2]||(S[2]=I=>x("restore"))},toDisplayString(P.$t("panels.left.layers.restoreSettings")),1),createBaseVNode("div",{class:normalizeClass(["drop-item",{disabled:!u.value}]),onClick:S[3]||(S[3]=I=>x("export"))},toDisplayString(P.$t("panels.left.layers.exportLayers")),3)])]),_:1},512)):createCommentVNode("",!0)]),r.value.length?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["layers",{single:g.value}])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,I=>(openBlock(),createBlock(M,{layer:I,level:0,onShowTipDialog:y},null,8,["layer"]))),256))],2)):(openBlock(),createElementBlock("div",_hoisted_4$e,toDisplayString(P.$t("panels.left.layers.empty")),1))]),m.value?(openBlock(),createElementBlock("div",_hoisted_5$6,[createVNode(D,{show:m.value,close:!1},{footer:withCtx(()=>[createBaseVNode("div",{class:"rect-button white",onClick:S[4]||(S[4]=I=>f())},toDisplayString(P.$t("common.actions.ok")),1),createBaseVNode("div",{class:"rect-button blue",onClick:S[5]||(S[5]=I=>f(!0))},toDisplayString(P.$t("layer.properties.title")),1)]),default:withCtx(()=>[createVNode(T),createBaseVNode("p",null,toDisplayString(P.$t("layer.lockedWarning")),1)]),_:1},8,["show"])])):createCommentVNode("",!0),createVNode(N)],64)}}},Outlines_vue_vue_type_style_index_0_lang="",_hoisted_1$1a={class:"outlines"},_hoisted_2$12={class:"outline-item-title"},splitter="-",_sfc_main$1t={__name:"Outlines",props:{outline:{type:Object,required:!0}},setup(e,{emit:n}){const o=useDocumentStore(),r=useViewerStore(),{outline:u}=e,s=x=>{const k=x.title;return`${w(x)}${splitter}${k}`},w=x=>m(x).reverse().join(splitter),m=x=>{const k=[];let P=x;for(;P;)k.push(P.index),P=P.parent;return k},v=computed(()=>s(u)),g=ref(!1),d=computed(()=>o.getActiveOutlineId===v.value),f=()=>{o.setActiveOutlineId(v.value),core.pageNumberChanged({value:u.pageNumber}),isMobile&&r.closeElement("leftPanel")},y=x=>{x.stopPropagation(),g.value=!g.value};return(x,k)=>{const P=__unplugin_components_0$e,S=resolveComponent("Outlines",!0);return openBlock(),createElementBlock("div",_hoisted_1$1a,[createBaseVNode("div",{class:normalizeClass(["outline-item",d.value&&"selected"]),onClick:f},[createBaseVNode("div",{class:normalizeClass(["outline-item-toggle",g.value&&"active"]),style:normalizeStyle({marginLeft:12*e.outline.level+"px"})},[e.outline.children.length?(openBlock(),createBlock(P,{key:0,onClick:y})):createCommentVNode("",!0)],6),createBaseVNode("div",_hoisted_2$12,toDisplayString(e.outline.title),1)],2),g.value?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(e.outline.children,E=>(openBlock(),createBlock(S,{outline:E},null,8,["outline"]))),256)):createCommentVNode("",!0)])}}},OutlinesPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$19={class:"outline"},_hoisted_2$11={class:"outline-title"},_hoisted_3$V={key:0,class:"outlines-container"},_hoisted_4$d={key:1,class:"no-outlines"},_sfc_main$1s={__name:"OutlinesPanel",setup(e){const n=useDocumentStore(),o=computed(()=>n.getOutlines);return(r,u)=>{const s=_sfc_main$1t;return openBlock(),createElementBlock("div",_hoisted_1$19,[createBaseVNode("div",_hoisted_2$11,toDisplayString(r.$t("panels.left.outlines.title")),1),o.value.length?(openBlock(),createElementBlock("div",_hoisted_3$V,[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,w=>(openBlock(),createBlock(s,{outline:w},null,8,["outline"]))),256))])):(openBlock(),createElementBlock("div",_hoisted_4$d,toDisplayString(r.$t("panels.left.outlines.empty")),1))])}}},_sfc_main$1r={},_hoisted_1$18={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$10=createBaseVNode("path",{d:"M6.36661 7L3.19995 10.1667L6.36661 13.3333",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$U=createBaseVNode("path",{d:"M13.3333 3.2V7.63332C13.3333 8.3052 13.0664 8.94957 12.5913 9.42466C12.1162 9.89975 11.4718 10.1667 10.7999 10.1667H3.19995",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_4$c=[_hoisted_2$10,_hoisted_3$U];function _sfc_render$O(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$18,_hoisted_4$c)}const __unplugin_components_32=_export_sfc(_sfc_main$1r,[["render",_sfc_render$O]]),_sfc_main$1q={},_hoisted_1$17={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$$=createBaseVNode("path",{d:"M12.8 9.86666C12.8 10.1613 12.683 10.444 12.4746 10.6523C12.2662 10.8607 11.9836 10.9778 11.6889 10.9778H5.02227L2.80005 13.2V4.31111C2.80005 4.01642 2.91711 3.73381 3.12549 3.52543C3.33386 3.31706 3.61647 3.2 3.91116 3.2H11.6889C11.9836 3.2 12.2662 3.31706 12.4746 3.52543C12.683 3.73381 12.8 4.01642 12.8 4.31111V9.86666Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$T=[_hoisted_2$$];function _sfc_render$N(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$17,_hoisted_3$T)}const __unplugin_components_31=_export_sfc(_sfc_main$1q,[["render",_sfc_render$N]]),_sfc_main$1p={},_hoisted_1$16={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$_=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 4H15.5V15.5H4V4ZM2.5 2.5H4H15.5H17V4V15.5V17H15.5H4H2.5V15.5V4V2.5ZM7 9.25H6.25V10.75H7H13H13.75V9.25H13H7Z",fill:"currentColor"},null,-1),_hoisted_3$S=[_hoisted_2$_];function _sfc_render$M(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$16,_hoisted_3$S)}const __unplugin_components_30=_export_sfc(_sfc_main$1p,[["render",_sfc_render$M]]),_sfc_main$1o={},_hoisted_1$15={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$Z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 4H15.5V15.5H4V4ZM2.5 2.5H4H15.5H17V4V15.5V17H15.5H4H2.5V15.5V4V2.5ZM13.6441 8.40148L14.1745 7.87115L13.1138 6.81049L12.5835 7.34082L8.87115 11.0531L7.53033 9.71231L7 9.18198L5.93934 10.2426L6.46967 10.773L8.34082 12.6441L8.87115 13.1745L9.40148 12.6441L13.6441 8.40148Z",fill:"currentColor"},null,-1),_hoisted_3$R=[_hoisted_2$Z];function _sfc_render$L(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$15,_hoisted_3$R)}const __unplugin_components_29=_export_sfc(_sfc_main$1o,[["render",_sfc_render$L]]),_sfc_main$1n={},_hoisted_1$14={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$Y=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 4H15.5V15.5H4V4ZM2.5 2.5H4H15.5H17V4V15.5V17H15.5H4H2.5V15.5V4V2.5ZM7.06066 6L7.59099 6.53033L9.56066 8.5L11.5303 6.53033L12.0607 6L13.1213 7.06066L12.591 7.59099L10.6213 9.56066L12.591 11.5303L13.1213 12.0607L12.0607 13.1213L11.5303 12.591L9.56066 10.6213L7.59099 12.591L7.06066 13.1213L6 12.0607L6.53033 11.5303L8.5 9.56066L6.53033 7.59099L6 7.06066L7.06066 6Z",fill:"currentColor"},null,-1),_hoisted_3$Q=[_hoisted_2$Y];function _sfc_render$K(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$14,_hoisted_3$Q)}const __unplugin_components_28=_export_sfc(_sfc_main$1n,[["render",_sfc_render$K]]),_sfc_main$1m={},_hoisted_1$13={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$X=createBaseVNode("path",{d:"M13.5224 10.8835L10.6558 17.3333C10.0856 17.3333 9.53871 17.1068 9.13551 16.7036C8.73232 16.3004 8.5058 15.7536 8.5058 15.1834V12.3168H4.44954C4.24178 12.3191 4.03598 12.2763 3.84642 12.1912C3.65686 12.1061 3.48807 11.9808 3.35173 11.8241C3.21539 11.6673 3.11477 11.4827 3.05684 11.2832C2.99891 11.0836 2.98505 10.8739 3.01623 10.6685L4.00521 4.21857C4.05704 3.87679 4.23065 3.56526 4.49404 3.34138C4.75743 3.1175 5.09286 2.99635 5.43852 3.00026H13.5224M13.5224 10.8835V3.00026M13.5224 10.8835H15.4359C15.8415 10.8906 16.2356 10.7486 16.5434 10.4844C16.8512 10.2202 17.0513 9.85215 17.1057 9.45015V4.43357C17.0513 4.03157 16.8512 3.66352 16.5434 3.39931C16.2356 3.13509 15.8415 2.99309 15.4359 3.00026H13.5224",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$P=[_hoisted_2$X];function _sfc_render$J(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$13,_hoisted_3$P)}const __unplugin_components_27=_export_sfc(_sfc_main$1m,[["render",_sfc_render$J]]),_sfc_main$1l={},_hoisted_1$12={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$W=createBaseVNode("path",{d:"M6.58333 8.44989L9.44994 1.99999C10.0202 1.99999 10.567 2.22651 10.9702 2.6297C11.3734 3.0329 11.5999 3.57975 11.5999 4.14996V7.01658H15.6562C15.8639 7.01422 16.0697 7.05707 16.2593 7.14215C16.4489 7.22722 16.6176 7.3525 16.754 7.50929C16.8903 7.66608 16.9909 7.85063 17.0489 8.05017C17.1068 8.24971 17.1207 8.45946 17.0895 8.66488L16.1005 15.1148C16.0487 15.4565 15.8751 15.7681 15.6117 15.992C15.3483 16.2158 15.0129 16.337 14.6672 16.3331H6.58333M6.58333 8.44989V16.3331M6.58333 8.44989H4.66986C4.26426 8.44271 3.87015 8.58471 3.56233 8.84893C3.25452 9.11315 3.05443 9.48119 3.00005 9.88319V14.8998C3.05443 15.3018 3.25452 15.6698 3.56233 15.934C3.87015 16.1983 4.26426 16.3403 4.66986 16.3331H6.58333",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),_hoisted_3$O=[_hoisted_2$W];function _sfc_render$I(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$12,_hoisted_3$O)}const __unplugin_components_26=_export_sfc(_sfc_main$1l,[["render",_sfc_render$I]]),_sfc_main$1k={},_hoisted_1$11={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$V=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.5 10C6.5 10.8284 5.82843 11.5 5 11.5C4.17157 11.5 3.5 10.8284 3.5 10C3.5 9.17157 4.17157 8.5 5 8.5C5.82843 8.5 6.5 9.17157 6.5 10ZM11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5C10.8284 8.5 11.5 9.17157 11.5 10ZM15 11.5C15.8284 11.5 16.5 10.8284 16.5 10C16.5 9.17157 15.8284 8.5 15 8.5C14.1716 8.5 13.5 9.17157 13.5 10C13.5 10.8284 14.1716 11.5 15 11.5Z",fill:"currentColor"},null,-1),_hoisted_3$N=[_hoisted_2$V];function _sfc_render$H(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$11,_hoisted_3$N)}const __unplugin_components_24=_export_sfc(_sfc_main$1k,[["render",_sfc_render$H]]),_sfc_main$1j={},_hoisted_1$10={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$U=createBaseVNode("path",{d:"M10.0282 2L18.2999 10.2717L1.75648 10.6988L10.0282 18.9706",stroke:"currentColor","stroke-width":"1.5","stroke-linejoin":"round"},null,-1),_hoisted_3$M=[_hoisted_2$U];function _sfc_render$G(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$10,_hoisted_3$M)}const __unplugin_components_12=_export_sfc(_sfc_main$1j,[["render",_sfc_render$G]]),_sfc_main$1i={},_hoisted_1$$={width:"21",height:"20",viewBox:"5 5 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$T=createBaseVNode("path",{d:"M8.20577 10.933L15.25 6.86603L22.2942 10.933V19.067L15.25 23.134L8.20577 19.067V10.933Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$L=[_hoisted_2$T];function _sfc_render$F(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$$,_hoisted_3$L)}const __unplugin_components_10$2=_export_sfc(_sfc_main$1i,[["render",_sfc_render$F]]),_sfc_main$1h={},_hoisted_1$_={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$S=createBaseVNode("mask",{id:"path-1-inside-1_172_2280",fill:"white"},[createBaseVNode("path",{d:"M10 3C13.0376 3 15.5 5.46243 15.5 8.5C15.5 8.66861 15.4904 8.83526 15.4756 9C15.4837 8.99995 15.4919 9 15.5 9C17.7091 9 19.5 10.7909 19.5 13C19.5 15.2091 17.7091 17 15.5 17H5.5C2.73858 17 0.5 14.7614 0.5 12C0.5 9.51456 2.3135 7.45274 4.68945 7.06543C5.32052 4.72359 7.45876 3 10 3Z"})],-1),_hoisted_3$K=createBaseVNode("path",{d:"M15.4756 9L13.9816 8.86532C13.9437 9.28642 14.0852 9.70398 14.3714 10.0152C14.6575 10.3265 15.0618 10.5025 15.4846 10.5L15.4756 9ZM4.68945 7.06543L4.93078 8.54589C5.51231 8.45109 5.98448 8.02463 6.13779 7.45572L4.68945 7.06543ZM10 3V4.5C12.2091 4.5 14 6.29086 14 8.5H15.5H17C17 4.63401 13.866 1.5 10 1.5V3ZM15.5 8.5H14C14 8.61249 13.9936 8.73267 13.9816 8.86532L15.4756 9L16.9695 9.13468C16.9873 8.93785 17 8.72473 17 8.5H15.5ZM15.4756 9L15.4846 10.5C15.483 10.5 15.4826 10.5 15.4855 10.5C15.4873 10.5 15.4883 10.5 15.4911 10.5C15.4934 10.5 15.4966 10.5 15.5 10.5V9V7.5C15.4972 7.5 15.4973 7.49999 15.49 7.49998C15.4848 7.49998 15.4763 7.49997 15.4666 7.50003L15.4756 9ZM15.5 9V10.5C16.8807 10.5 18 11.6193 18 13H19.5H21C21 9.96243 18.5376 7.5 15.5 7.5V9ZM19.5 13H18C18 14.3807 16.8807 15.5 15.5 15.5V17V18.5C18.5376 18.5 21 16.0376 21 13H19.5ZM15.5 17V15.5H5.5V17V18.5H15.5V17ZM5.5 17V15.5C3.567 15.5 2 13.933 2 12H0.5H-1C-1 15.5899 1.91015 18.5 5.5 18.5V17ZM0.5 12H2C2 10.2617 3.26878 8.81681 4.93078 8.54589L4.68945 7.06543L4.44812 5.58497C1.35821 6.08866 -1 8.76744 -1 12H0.5ZM4.68945 7.06543L6.13779 7.45572C6.59695 5.75182 8.15414 4.5 10 4.5V3V1.5C6.76339 1.5 4.0441 3.69536 3.24112 6.67514L4.68945 7.06543Z",fill:"currentColor",mask:"url(#path-1-inside-1_172_2280)"},null,-1),_hoisted_4$b=[_hoisted_2$S,_hoisted_3$K];function _sfc_render$E(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$_,_hoisted_4$b)}const __unplugin_components_11=_export_sfc(_sfc_main$1h,[["render",_sfc_render$E]]),_sfc_main$1g={},_hoisted_1$Z={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$R=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 3H2V15H5V18L10 15H18V3ZM5 6H11V7.5H5V6ZM5 9.5H15V11H5V9.5Z",fill:"currentColor"},null,-1),_hoisted_3$J=[_hoisted_2$R];function _sfc_render$D(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$Z,_hoisted_3$J)}const __unplugin_components_0$c=_export_sfc(_sfc_main$1g,[["render",_sfc_render$D]]),_sfc_main$1f={},_hoisted_1$Y={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$Q=createStaticVNode('<mask id="path-1-inside-1_172_2287" fill="white"><rect x="2" y="2" width="16" height="10" rx="1"></rect></mask><rect x="2" y="2" width="16" height="10" rx="1" stroke="currentColor" stroke-width="3" stroke-linejoin="round" mask="url(#path-1-inside-1_172_2287)"></rect><path d="M8.59809 16L8.59809 16.75C8.34414 16.75 8.10745 16.6215 7.96912 16.4085L8.59809 16ZM5.37103 12.4085L4.9625 11.7796L6.22044 10.9625L6.62897 11.5915L6 12L5.37103 12.4085ZM14 16L14 16.75L8.59809 16.75L8.59809 16L8.59809 15.25L14 15.25L14 16ZM8.59809 16L7.96912 16.4085L5.37103 12.4085L6 12L6.62897 11.5915L9.22706 15.5915L8.59809 16Z" fill="currentColor"></path><path d="M12.5 14L14.5 16.065L12.626 18" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"></path>',4),_hoisted_6$5=[_hoisted_2$Q];function _sfc_render$C(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$Y,_hoisted_6$5)}const __unplugin_components_16=_export_sfc(_sfc_main$1f,[["render",_sfc_render$C]]),_sfc_main$1e={},_hoisted_1$X={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$P=createBaseVNode("path",{d:"M3.25 18C3.25 9.71573 9.96573 3 18.25 3",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$I=[_hoisted_2$P];function _sfc_render$B(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$X,_hoisted_3$I)}const __unplugin_components_8$2=_export_sfc(_sfc_main$1e,[["render",_sfc_render$B]]),AnnotationContent_vue_vue_type_style_index_0_lang="",_hoisted_1$W={class:"page-title"},_hoisted_2$O=["id","onClick"],_hoisted_3$H={class:"item-header"},_hoisted_4$a={class:"info"},_hoisted_5$5={class:"name"},_hoisted_6$4={class:"date"},_hoisted_7$4={key:0,class:"content"},_hoisted_8$3=["onClick"],_hoisted_9$3={key:0,class:"item-reply"},_hoisted_10$2={key:0},_hoisted_11$1=["placeholder"],_hoisted_12$1={class:"buttons"},_hoisted_13$1=["onClick"],_hoisted_14$1={class:"replies"},_hoisted_15$1={key:0,class:"info"},_hoisted_16$1={class:"info-header"},_hoisted_17$1={class:"name"},_hoisted_18$1={class:"date"},_hoisted_19$1={key:0,class:"content"},_hoisted_20$1={class:"buttons"},_hoisted_21$1=["onClick"],_hoisted_22$1={key:1,class:"content"},_hoisted_23$1={class:"drop-down"},_hoisted_24$1=["onClick"],_hoisted_25$1=["onClick"],_hoisted_26$1={key:1,class:"item-footer"},_hoisted_27$1={class:"drop-down"},_hoisted_28$1=["onClick"],_hoisted_29$1=["onClick"],_hoisted_30$1=["onClick"],_hoisted_31$1=["onClick"],_hoisted_32$1=["onClick"],_hoisted_33={class:"re"},_hoisted_34={key:0},_hoisted_35={key:1,class:"no-annotations"},_sfc_main$1d={__name:"AnnotationContent",setup(e){const n=useDocumentStore(),o=useViewerStore();let r=computed(()=>n.getAllAnnotations);const u=computed(()=>o.getActiveElementTab("leftPanel")),s=computed(()=>o.isElementOpen("leftPanel")),w=computed(()=>n.getAnnotator),m=computed(()=>o.getToolMode),v=computed(()=>n.getSelectedAnnotation),g=computed(()=>o.isElementOpen("reply")),d=ref(null),f=ref(null);let y=null;const x=ref(!1),k=ref(""),P=ref(!1),S=ref(""),E=computed(()=>o.getUserAdmin),M=computed(()=>o.getReadOnly),T=ref(""),D=ref(!1),N=ref(0),I=ref(0),O=ref(!1);watch([u,s],(Q,re)=>{re[0]==="ANNOTATION"&&re[1]&&q()});const F=Q=>{var Pe;core.jumpToAnnotation(Q);const re=core.getAnnotationManager();m.value!=="editor"&&re.selectAnnotation(Q),((Pe=d.value)==null?void 0:Pe.name)!==Q.name&&(k.value="",d.value=Q,x.value=!1),isMobile&&o.closeElement("leftPanel")},q=()=>{x.value=!1,k.value=""},Y=async(Q,re)=>{if(Q=toRaw(Q),Q.getStatus()){let Pe=Q.getReplies().filter(be=>be.isReply&&be.stateModel==="Review");Pe&&Pe.length&&(Pe.sort((be,we)=>we.dateCreated-be.dateCreated),Pe[0].setState(re))}else await core.getAnnotationManager().createAnnotationReply(Q,{state:re});T.value=""},_e=Q=>{T.value?T.value="":T.value=Q.name},ne=(Q,re)=>{if(D.value){X();return}let Pe=Q.target;for(;Pe.parentElement&&!Pe.classList.contains("more");)Pe=Pe.parentElement;if(Pe.classList.contains("more")){const be=Pe.getBoundingClientRect();N.value=be.left,I.value=be.bottom,D.value=!0,f.value=re,y=re}},ve=async Q=>{Q=toRaw(Q);const re=Q.getMarked();if(re){let Pe=Q.getReplies().filter(be=>be.isReply&&be.stateModel==="Marked");if(Pe&&Pe.length){Pe.sort((we,Ae)=>Ae.dateCreated-we.dateCreated);const be=re==="MARKED"?"UNMARKED":"MARKED";Pe[0].setState(be)}}else await core.getAnnotationManager().createAnnotationReply(Q,{state:"MARKED"});O.value=!O.value},J=async Q=>{if(k.value==="")return;Q=toRaw(Q),await core.getAnnotationManager().createAnnotationReply(Q,{author:w.value,title:w.value,contents:k.value,date:new Date}),k.value=""},fe=Q=>{x.value=!1,D.value=!1,P.value&&S.value!==f.value.contents?(Q.setContents(S.value),P.value=!1):(P.value=!0,S.value=f.value.contents,nextTick(()=>{const re=document.querySelector(".replyEditInput");re.focus(),re.setSelectionRange(re.value.length,re.value.length)}))},Z=()=>{core.getAnnotationManager().deleteAnnotation(y),X()},j=Q=>{document.querySelector(".button.more.active").contains(Q.target)||X()},X=()=>{D.value=!1,P.value||(f.value=null,y=null)},H=()=>{P.value=!1,S.value="",f.value=null,y=null},U=Q=>{document.querySelector(".button.state.active").contains(Q.target)||(T.value="")},te=(Q,re)=>{var Pe;x.value=!0,((Pe=d.value)==null?void 0:Pe.name)!==Q.name&&(d.value=Q,k.value=""),!re&&nextTick(()=>{var be;(be=document.querySelector(".annotReplyInput"))==null||be.focus()})};return watch(()=>g.value,Q=>{Q&&(d.value=v.value,x.value=!0)}),watch(()=>v.value,Q=>{(!Q||d.value&&v.value.name!==d.value.name)&&(o.closeElement("reply"),X(),d.value=null,x.value=!1),d.value=v.value,x.value=!1}),onMounted(()=>{v.value&&g.value&&(d.value=v.value,x.value=!0)}),(Q,re)=>{const Pe=__unplugin_components_1$7,be=__unplugin_components_5$5,we=__unplugin_components_4$a,Ae=__unplugin_components_3$a,$e=__unplugin_components_2$d,Me=__unplugin_components_4$9,Ie=__unplugin_components_3$8,Le=__unplugin_components_8$2,le=__unplugin_components_6$5,oe=__unplugin_components_0$k,ke=__unplugin_components_14$3,Ce=__unplugin_components_13,Ee=__unplugin_components_9$5,Be=__unplugin_components_5$4,Ve=__unplugin_components_7$3,Oe=__unplugin_components_15,je=__unplugin_components_16,Ge=__unplugin_components_0$c,Xe=__unplugin_components_17,qe=__unplugin_components_11,Ke=__unplugin_components_7$2,Je=__unplugin_components_6$4,rt=__unplugin_components_10$2,ht=__unplugin_components_12,vt=__unplugin_components_24,Ct=_sfc_main$4C,kt=__unplugin_components_26,mt=__unplugin_components_27,Vt=__unplugin_components_28,bt=__unplugin_components_29,ot=__unplugin_components_30,gt=__unplugin_components_31,tt=__unplugin_components_32;return openBlock(),createElementBlock("div",{class:normalizeClass(["annotation-view",{pb:!["view","sign","document"].includes(m.value)}])},[unref(r).annotationsCount>0?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(unref(r).annotations,(ut,Re)=>(openBlock(),createElementBlock("div",null,[ut.pageAnnotationsCount>0?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_1$W,[createBaseVNode("span",null,toDisplayString(Q.$t("panels.left.search.pageIndicator",{page:Re*1+1})),1),createBaseVNode("span",null,toDisplayString(ut.pageAnnotationsCount),1)]),(openBlock(!0),createElementBlock(Fragment,null,renderList(ut.annotations,(Te,He)=>{var Fe,ze,We;return openBlock(),createElementBlock(Fragment,null,[!["link","reply"].includes(Te.type)&&!Te.isDelete&&!Te.isHidden?(openBlock(),createElementBlock("div",{class:normalizeClass(["annotation-item",{selected:d.value&&d.value.name===Te.name,"selected-annotation":v.value&&v.value.name===Te.name}]),id:Te.name?`annotationList-${Te.name}`:null,onClick:Ue=>F(Te),key:He,onMousedown:re[6]||(re[6]=withModifiers(()=>{},["stop"])),onTouchstart:re[7]||(re[7]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_3$H,[Te.type==="highlight"?(openBlock(),createBlock(Pe,{key:0})):Te.type==="squiggly"?(openBlock(),createBlock(be,{key:1})):Te.type==="strikeout"?(openBlock(),createBlock(we,{key:2})):Te.type==="underline"?(openBlock(),createBlock(Ae,{key:3})):Te.type==="polyline"&&Te.measure?(openBlock(),createBlock($e,{key:4})):Te.type==="ink"&&Te.measure&&Te.arcPoints?(openBlock(),createBlock(Me,{key:5})):Te.type==="ink"&&Te.measure?(openBlock(),createBlock(Ie,{key:6})):Te.type==="arc"?(openBlock(),createBlock(Le,{key:7})):Te.type==="ink"?(openBlock(),createBlock(le,{key:8})):Te.type==="line"&&Te.measure?(openBlock(),createBlock(oe,{key:9})):Te.type==="line"&&((Te.tail==="none"||Te.tail==="unknown")&&(Te.head==="none"||Te.head==="unknown")||!Te.tail&&!Te.head)?(openBlock(),createBlock(ke,{key:10})):Te.type==="line"&&(Te.tail==="openarrow"||Te.head==="openarrow"||Te.arrow)?(openBlock(),createBlock(Ce,{key:11})):Te.type==="square"||Te.type==="rectangle"&&!Te.measure?(openBlock(),createBlock(Ee,{key:12})):Te.type==="circle"&&Te.measure?(openBlock(),createBlock(Be,{key:13})):Te.type==="circle"?(openBlock(),createBlock(Ve,{key:14})):Te.type==="freetext"&&Te.annotation.intent==="FreeText"?(openBlock(),createBlock(Oe,{key:15})):Te.type==="freetext"&&Te.annotation.intent==="FreeTextCallout"?(openBlock(),createBlock(je,{key:16})):Te.type==="text"?(openBlock(),createBlock(Ge,{key:17})):Te.type==="image"||Te.type==="stamp"?(openBlock(),createBlock(Xe,{key:18})):Te.type==="polygon"&&Te.borderStyle==="cloudy"?(openBlock(),createBlock(qe,{key:19})):Te.type==="polygon"&&Te.measure?(openBlock(),createBlock(Ke,{key:20})):Te.type==="rectangle"&&Te.measure?(openBlock(),createBlock(Je,{key:21})):Te.type==="polygon"?(openBlock(),createBlock(rt,{key:22})):Te.type==="polyline"?(openBlock(),createBlock(ht,{key:23})):createCommentVNode("",!0),createBaseVNode("div",_hoisted_4$a,[createBaseVNode("p",_hoisted_5$5,toDisplayString(Te.author||Te.title||"Guest"),1),createBaseVNode("p",_hoisted_6$4,toDisplayString(unref(dayjs)(Te.dateCreated).format("DD/MM/YYYY HH:mm:ss")),1),Te.contents?(openBlock(),createElementBlock("div",_hoisted_7$4,toDisplayString(Te.contents),1)):createCommentVNode("",!0)]),E.value||!(M.value||w.value!==Te.author)?(openBlock(),createBlock(unref(NPopover),{key:24,trigger:"hover",placement:"bottom",to:"#outerContainer",class:"mark-popover"},{trigger:withCtx(()=>[(openBlock(),createElementBlock("div",{class:normalizeClass(["mark-box",{marked:Te.getMarked()==="MARKED"}]),onClick:withModifiers(Ue=>ve(Te),["stop"]),key:O.value},null,10,_hoisted_8$3))]),default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Te.getMarked()==="MARKED"?Q.$t("panels.left.reply.marked"):Q.$t("panels.left.reply.unmarked")),1)]),_:2},1024)):createCommentVNode("",!0)]),d.value&&d.value.name===Te.name&&(x.value||((Fe=Te.replies)==null?void 0:Fe.length))?(openBlock(),createElementBlock("div",_hoisted_9$3,[x.value?(openBlock(),createElementBlock("div",_hoisted_10$2,[withDirectives(createBaseVNode("textarea",{onClick:re[0]||(re[0]=withModifiers(()=>{},["stop"])),onMousedown:re[1]||(re[1]=withModifiers(()=>{},["stop"])),placeholder:Q.$t("panels.left.reply.replyPlaceholder"),"onUpdate:modelValue":re[2]||(re[2]=Ue=>k.value=Ue),class:"annotReplyInput"},null,40,_hoisted_11$1),[[vModelText,k.value]]),createBaseVNode("div",_hoisted_12$1,[createBaseVNode("span",{onClick:withModifiers(q,["stop"])},toDisplayString(Q.$t("common.actions.cancel")),1),createBaseVNode("button",{class:normalizeClass({active:k.value,disabled:!k.value}),onClick:withModifiers(Ue=>J(Te),["stop"])},toDisplayString(Q.$t("common.actions.reply")),11,_hoisted_13$1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_14$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(Te.replies,(Ue,et)=>{var it,nt;return openBlock(),createElementBlock(Fragment,{key:et},[Ue.contents?(openBlock(),createElementBlock("div",_hoisted_15$1,[createBaseVNode("div",_hoisted_16$1,[createBaseVNode("div",null,[createBaseVNode("p",_hoisted_17$1,toDisplayString(Ue.author||Ue.title||w.value),1),createBaseVNode("p",_hoisted_18$1,toDisplayString(unref(dayjs)(Ue.dateCreated).format("DD/MM/YYYY HH:mm:ss")),1)]),createVNode(Ct,{class:normalizeClass(["more",{active:D.value&&Ue.name===((it=f.value)==null?void 0:it.name)}]),onClick:withModifiers(dt=>ne(dt,Ue),["stop"])},{default:withCtx(()=>[createVNode(vt)]),_:2},1032,["class","onClick"])]),P.value&&Ue.name===((nt=f.value)==null?void 0:nt.name)?(openBlock(),createElementBlock("div",_hoisted_19$1,[withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":re[3]||(re[3]=dt=>S.value=dt),class:"replyEditInput"},null,512),[[vModelText,S.value]]),createBaseVNode("div",_hoisted_20$1,[createBaseVNode("span",{onClick:withModifiers(H,["stop"])},toDisplayString(Q.$t("common.actions.cancel")),1),createBaseVNode("button",{class:normalizeClass([S.value&&S.value!==Ue.contents?"active":"disabled"]),onClick:withModifiers(dt=>fe(Ue),["stop"])},toDisplayString(Q.$t("common.actions.confirm")),11,_hoisted_21$1)])])):(openBlock(),createElementBlock("div",_hoisted_22$1,toDisplayString(Ue.contents),1))])):createCommentVNode("",!0)],64)}),128))]),createVNode(unref(NPopover),{placement:"bottom-start",trigger:"manual","show-arrow":!1,to:"#outerContainer",raw:!0,"z-index":96,class:"reply-popover",show:D.value,x:N.value,y:I.value,onClickoutside:j},{default:withCtx(()=>[createBaseVNode("div",_hoisted_23$1,[createBaseVNode("div",{class:"drop-item",onMousedown:re[4]||(re[4]=withModifiers(()=>{},["stop"])),onClick:withModifiers(Ue=>fe(Te),["stop"])},toDisplayString(Q.$t("common.actions.edit")),41,_hoisted_24$1),createBaseVNode("div",{class:"drop-item",onMousedown:re[5]||(re[5]=withModifiers(()=>{},["stop"])),onClick:withModifiers(Ue=>Z(Te),["stop"])},toDisplayString(Q.$t("common.actions.delete")),41,_hoisted_25$1)])]),_:2},1032,["show","x","y"])])):createCommentVNode("",!0),E.value||!(M.value||w.value!==Te.author)?(openBlock(),createElementBlock("div",_hoisted_26$1,[createVNode(unref(NPopover),{placement:"bottom",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,"z-index":96,class:"state-popover",show:T.value===Te.name,onClickoutside:U},{trigger:withCtx(()=>[createVNode(Ct,{class:normalizeClass(["state",{active:T.value===Te.name}]),onClick:withModifiers(Ue=>_e(Te),["stop"])},{default:withCtx(()=>[Te.getStatus()==="ACCEPTED"?(openBlock(),createBlock(kt,{key:0})):Te.getStatus()==="REJECTED"?(openBlock(),createBlock(mt,{key:1})):Te.getStatus()==="CANCELLED"?(openBlock(),createBlock(Vt,{key:2})):Te.getStatus()==="COMPLETED"?(openBlock(),createBlock(bt,{key:3})):(openBlock(),createBlock(ot,{key:4}))]),_:2},1032,["class","onClick"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_27$1,[createBaseVNode("div",{class:"drop-item",onClick:withModifiers(Ue=>Y(Te,"ACCEPTED"),["stop"])},[createVNode(kt),createTextVNode(toDisplayString(Q.$t("panels.left.reply.accepted")),1)],8,_hoisted_28$1),createBaseVNode("div",{class:"drop-item",onClick:withModifiers(Ue=>Y(Te,"REJECTED"),["stop"])},[createVNode(mt),createTextVNode(toDisplayString(Q.$t("panels.left.reply.rejected")),1)],8,_hoisted_29$1),createBaseVNode("div",{class:"drop-item",onClick:withModifiers(Ue=>Y(Te,"CANCELLED"),["stop"])},[createVNode(Vt),createTextVNode(toDisplayString(Q.$t("panels.left.reply.cancelled")),1)],8,_hoisted_30$1),createBaseVNode("div",{class:"drop-item",onClick:withModifiers(Ue=>Y(Te,"COMPLETED"),["stop"])},[createVNode(bt),createTextVNode(toDisplayString(Q.$t("panels.left.reply.completed")),1)],8,_hoisted_31$1),createBaseVNode("div",{class:"drop-item",onClick:withModifiers(Ue=>Y(Te,"NONE"),["stop"])},[createVNode(ot),createTextVNode(toDisplayString(Q.$t("panels.left.reply.none")),1)],8,_hoisted_32$1)])]),_:2},1032,["show"]),createBaseVNode("div",_hoisted_33,[createVNode(gt),(We=(ze=Te==null?void 0:Te.replies)==null?void 0:ze.filter(Ue=>Ue.contents))!=null&&We.length?(openBlock(),createElementBlock("span",_hoisted_34,toDisplayString(Te.replies.filter(Ue=>Ue.contents).length),1)):createCommentVNode("",!0),createVNode(tt,{class:"return",onClick:withModifiers(Ue=>te(Te),["stop"])},null,8,["onClick"])])])):createCommentVNode("",!0)],42,_hoisted_2$O)):createCommentVNode("",!0)],64)}),256))],64)):createCommentVNode("",!0)]))),256)):(openBlock(),createElementBlock("div",_hoisted_35,toDisplayString(Q.$t("panels.left.annotations.empty")),1))],2)}}},_sfc_main$1c={},_hoisted_1$V={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$N=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.56181 13.8733C9.85977 14.1611 10.3429 14.1611 10.6408 13.8733L14.7421 9.91282C15.0401 9.62509 15.0401 9.15858 14.7421 8.87085C14.4442 8.58311 13.9611 8.58311 13.6631 8.87085L10.75 11.6839L10.75 4C10.75 3.58579 10.4142 3.25 10 3.25C9.58581 3.25 9.25002 3.58579 9.25002 4L9.25003 11.4883L6.53951 8.87085C6.24155 8.58311 5.75846 8.58311 5.46049 8.87085C5.16253 9.15858 5.16253 9.62509 5.46049 9.91282L9.56181 13.8733ZM4 15.7543C3.58579 15.7543 3.25 16.0901 3.25 16.5043C3.25 16.9185 3.58579 17.2543 4 17.2543H16C16.4142 17.2543 16.75 16.9185 16.75 16.5043C16.75 16.0901 16.4142 15.7543 16 15.7543H4Z",fill:"currentColor"},null,-1),_hoisted_3$G=[_hoisted_2$N];function _sfc_render$A(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$V,_hoisted_3$G)}const __unplugin_components_2$8=_export_sfc(_sfc_main$1c,[["render",_sfc_render$A]]),_sfc_main$1b={},_hoisted_1$U={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$M=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.6374 2.96451C10.3413 2.67483 9.8613 2.67483 9.56523 2.96451L5.46391 6.97719C5.16784 7.26687 5.16784 7.73652 5.46391 8.0262C5.75999 8.31588 6.24002 8.31588 6.53609 8.0262L9.25012 5.37083L9.25012 12.8271C9.25012 13.2413 9.58591 13.5771 10.0001 13.5771C10.4143 13.5771 10.7501 13.2413 10.7501 12.8271L10.7501 5.17281L13.6665 8.0262C13.9626 8.31588 14.4426 8.31588 14.7387 8.0262C15.0348 7.73652 15.0348 7.26687 14.7387 6.97719L10.6374 2.96451ZM4 15.7516C3.58579 15.7516 3.25 16.0873 3.25 16.5016C3.25 16.9158 3.58579 17.2516 4 17.2516H16C16.4142 17.2516 16.75 16.9158 16.75 16.5016C16.75 16.0873 16.4142 15.7516 16 15.7516H4Z",fill:"currentColor"},null,-1),_hoisted_3$F=[_hoisted_2$M];function _sfc_render$z(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$U,_hoisted_3$F)}const __unplugin_components_0$b=_export_sfc(_sfc_main$1b,[["render",_sfc_render$z]]),AnnotationHeader_vue_vue_type_style_index_0_lang="",_hoisted_1$T={class:"annotation-header"},_hoisted_2$L={class:"annotation-title"},_hoisted_3$E={class:"annotation-header-buttons"},_sfc_main$1a={__name:"AnnotationHeader",setup(e){const n=useDocumentStore(),o=useViewerStore(),r=computed(()=>o.isAnnotationExport),u=computed(()=>o.isAnnotationImport),{removeAllAnnotations:s,importAnnotations:w,exportXfdf:m}=core,v=()=>{uploadFile(isIOS$1?"":".xfdf").then(k=>{k.name.split(".").pop().toLowerCase()==="xfdf"&&w(k)})},g=computed(()=>n.getTotalPages),d=computed(()=>n.getAllAnnotations);computed(()=>n.getOptionUrl);const f=computed(()=>n.info);f.value&&f.value.token&&atob(f.value.token).replace(".pdf",".xfdf");const y=async()=>{try{o.setDownloading(!0);const x=await m(!0);o.setDownloading(!1),x||o.setDownloadError("Downloaded")}catch(x){console.log(x),o.setDownloading(!1),o.setDownloadError("Downloaded")}};return(x,k)=>{const P=__unplugin_components_0$b,S=_sfc_main$4C,E=__unplugin_components_2$8;return openBlock(),createElementBlock("div",_hoisted_1$T,[createBaseVNode("h2",_hoisted_2$L,toDisplayString(x.$t("panels.left.annotations.title")),1),createBaseVNode("div",_hoisted_3$E,[r.value?(openBlock(),createBlock(S,{key:0,className:"button-icon",img:"icon-import",onClick:y,title:x.$t("panels.left.annotations.export"),disabled:!d.value||d.value.annotationsCount===0},{default:withCtx(()=>[createVNode(P)]),_:1},8,["title","disabled"])):createCommentVNode("",!0),u.value?(openBlock(),createBlock(S,{key:1,className:"button-icon",img:"icon-export",onClick:v,title:x.$t("panels.left.annotations.import"),disabled:g.value<=0},{default:withCtx(()=>[createVNode(E)]),_:1},8,["title","disabled"])):createCommentVNode("",!0)])])}}},LeftPanel_vue_vue_type_style_index_0_lang="",_hoisted_1$S={class:"sidebar-content"},_hoisted_2$K=createBaseVNode("div",{class:"thumbnail-view"},null,-1),_sfc_main$19={__name:"LeftPanel",props:["isHeaderDisabled"],setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.getActiveElementTab("leftPanel")),u=computed(()=>n.isElementOpen("leftPanel")),s=computed(()=>o.getActiveTool);return watch(u,(w,m)=>{w&&s.value==="cropPage"&&o.setToolState("")}),(w,m)=>{const v=_sfc_main$1a,g=_sfc_main$1d,d=_sfc_main$1s,f=_sfc_main$1u,y=_sfc_main$1C,x=_sfc_main$1E,k=__unplugin_components_6$1;return openBlock(),createElementBlock("div",{class:normalizeClass(["left-panel",{closed:!u.value,mobile:unref(isMobileDevice)}]),id:"leftPanel",style:normalizeStyle({height:e.isHeaderDisabled?"100%":"calc(100% - 44px)"})},[createBaseVNode("div",_hoisted_1$S,[createBaseVNode("div",{class:normalizeClass(["thumbnail-container",{hidden:r.value!=="THUMBS"}])},[createBaseVNode("h2",null,toDisplayString(w.$t("panels.left.thumbnails")),1),_hoisted_2$K],2),r.value==="ANNOTATION"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["annotation-container",{hidden:r.value!=="ANNOTATION"}])},[createVNode(v),createVNode(g)],2)):createCommentVNode("",!0),withDirectives(createVNode(d,null,null,512),[[vShow,r.value==="OUTLINE"]]),createBaseVNode("div",{class:normalizeClass(["layer-container",{hidden:r.value!=="LAYER"}])},[createVNode(f)],2),createBaseVNode("div",{class:normalizeClass(["compare-container",{hidden:r.value!=="COMPARISON"}])},[createVNode(y)],2),createBaseVNode("div",{class:normalizeClass(["signature-container",{hidden:r.value!=="SIGNATURE"}])},[createVNode(x)],2),createBaseVNode("div",{class:normalizeClass(["findbar-container",{hidden:r.value!=="SEARCH"}])},[createVNode(k)],2)])],6)}}},SecurityApplyBar_vue_vue_type_style_index_0_lang="",_hoisted_1$R={class:"security-apply-bar"},_hoisted_2$J={class:"buttons"},_sfc_main$18={__name:"SecurityApplyBar",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=ref(0),u=w=>{if(!r.value){o.setToolState(""),n.setActiveToolMode("view");return}n.setRedactionConfirmDialog(w)},s=w=>{r.value=w};return core.addEvent("redactAnnotationChanged",s),(w,m)=>(openBlock(),createElementBlock("div",_hoisted_1$R,[createBaseVNode("span",null,toDisplayString(w.$t("redaction.applyWarning")),1),createBaseVNode("div",_hoisted_2$J,[createBaseVNode("div",{class:"view-button",onClick:m[0]||(m[0]=v=>u(0))},toDisplayString(w.$t("common.actions.exit")),1),createBaseVNode("div",{class:normalizeClass(["view-button apply-btn",{disabled:!r.value}]),onClick:m[1]||(m[1]=v=>u(1))},toDisplayString(w.$t("common.actions.apply")),3)])]))}},SignatureVerifyBar_vue_vue_type_style_index_0_scoped_91ed1d2a_lang="",_hoisted_1$Q={class:"signature-verify"},_hoisted_2$I={key:0},_hoisted_3$D={key:0},_hoisted_4$9={key:1},_hoisted_5$4={key:2},_sfc_main$17={__name:"SignatureVerifyBar",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>n.getSignatureVerify),u=computed(()=>o.getSignatures),s=()=>{n.openElement("leftPanel"),n.setActiveElementTab("leftPanel","SIGNATURE")};return(w,m)=>{const v=__unplugin_components_0$h,g=__unplugin_components_1$2,d=__unplugin_components_2$b;return openBlock(),createElementBlock("div",_hoisted_1$Q,[r.value===1?(openBlock(),createElementBlock("div",_hoisted_2$I,[createVNode(v),createBaseVNode("span",null,toDisplayString(w.$t("signatures.details.validSignature")),1)])):u.value.length===1?(openBlock(),createElementBlock(Fragment,{key:1},[r.value===2?(openBlock(),createElementBlock("div",_hoisted_3$D,[createVNode(g),createBaseVNode("span",null,toDisplayString(w.$t("signatures.details.invalidSignature")),1)])):(openBlock(),createElementBlock("div",_hoisted_4$9,[createVNode(d),createBaseVNode("span",null,toDisplayString(w.$t("signatures.details.unknownSignature")),1)]))],64)):r.value===2||r.value===3?(openBlock(),createElementBlock("div",_hoisted_5$4,[createVNode(g),createBaseVNode("span",null,toDisplayString(w.$t("signatures.details.invalidSignatures")),1)])):createCommentVNode("",!0),createBaseVNode("div",{class:"view-button",onClick:s},toDisplayString(w.$t("signatures.details.viewAll")),1)])}}},__unplugin_components_3$4=_export_sfc(_sfc_main$17,[["__scopeId","data-v-91ed1d2a"]]),_sfc_main$16={},_hoisted_1$P={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$H=createBaseVNode("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H16C18.2091 0 20 1.79086 20 4V16C20 18.2091 18.2091 20 16 20H4C1.79086 20 0 18.2091 0 16V4Z",fill:"#DDE9FF"},null,-1),_hoisted_3$C=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.01271 6.08121C7.01378 5.2426 7.98452 4.7777 8.63857 5.30256L13.5261 9.22462C14.0256 9.62544 14.0248 10.3859 13.5245 10.7857L8.62697 14.6998C7.97166 15.2235 7.00159 14.7562 7.00267 13.9173L7.01271 6.08121Z",fill:"currentColor"},null,-1),_hoisted_4$8=[_hoisted_2$H,_hoisted_3$C];function _sfc_render$y(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$P,_hoisted_4$8)}const __unplugin_components_4$4=_export_sfc(_sfc_main$16,[["render",_sfc_render$y]]),_sfc_main$15={},_hoisted_1$O={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$G=createBaseVNode("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H16C18.2091 0 20 1.79086 20 4V16C20 18.2091 18.2091 20 16 20H4C1.79086 20 0 18.2091 0 16V4Z",fill:"#DDE9FF"},null,-1),_hoisted_3$B=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.4873 6.08121C12.4862 5.2426 11.5155 4.7777 10.8614 5.30256L5.97391 9.22462C5.47443 9.62544 5.47519 10.3859 5.97548 10.7857L10.873 14.6998C11.5283 15.2235 12.4984 14.7562 12.4973 13.9173L12.4873 6.08121Z",fill:"currentColor"},null,-1),_hoisted_4$7=[_hoisted_2$G,_hoisted_3$B];function _sfc_render$x(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$O,_hoisted_4$7)}const __unplugin_components_2$7=_export_sfc(_sfc_main$15,[["render",_sfc_render$x]]),FormBoard_vue_vue_type_style_index_0_lang="",_hoisted_1$N={class:"fold-button"},_hoisted_2$F={class:"content"},_hoisted_3$A={key:0,class:"text"},_hoisted_4$6={key:1,class:"text"},_hoisted_5$3={key:2,class:"text"},_hoisted_6$3={key:3,class:"text"},_hoisted_7$3={key:4,class:"text"},_hoisted_8$2={key:5,class:"text"},_hoisted_9$2={class:"text"},_sfc_main$14={__name:"FormBoard",setup(e){const n=useViewerStore(),o=computed(()=>n.getToolMode),r=computed(()=>n.getConsecutiveType),u=computed(()=>n.getEnableFillForm),s=computed(()=>n.getReadOnly),w=computed(()=>n.getSkipNoRequired),m=computed(()=>n.isElementOpen("leftPanel")),v=ref(),g=ref(!1),d=ref(!1),f=reactive({x:30,y:100}),y=reactive({x:0,y:0}),x=computed(()=>n.getUploadLoading),k=ref(!1),P=ref(0),S=reactive({formFields:0,requiredFormFields:0,unfilledFormFields:0,unfilledRequiredFormFields:0,signFields:0,requiredSignFields:0,unsignFields:0,unsignRequiredSignFields:0}),E=computed(()=>{if(s.value)return!1;const fe=w.value,Z=r.value,j=u.value&&o.value==="form"||o.value==="view";let X=!1;return Z==="signForm"?X=!fe&&(S.formFields>0||S.signFields>0)||fe&&(S.requiredFormFields>0||S.requiredSignFields>0):Z==="sign"?X=!fe&&S.signFields>0||fe&&S.requiredSignFields>0:Z==="form"?X=!fe&&S.formFields>0||fe&&S.requiredFormFields>0:X=!1,X&&j});let M=null;const T=()=>{const J=core.getFormSignFilledAndUnfilled();S.formFields=J.formFields,S.requiredFormFields=J.requiredFormFields,S.unfilledFormFields=J.unfilledFormFields,S.unfilledRequiredFormFields=J.unfilledRequiredFormFields,S.signFields=J.signFields,S.requiredSignFields=J.requiredSignFields,S.unsignFields=J.unsignFields,S.unsignRequiredSignFields=J.unsignRequiredSignFields};core.addEvent("annotationChanged",()=>{T()}),core.addEvent("documentloaded",()=>{T()}),watch(m,(J,fe)=>{J?P.value=260:P.value=0});const D=()=>{const J=core.getAnnotationManager(),fe=J.getConsecutiveAnnotations();fe.length&&(core.jumpToAnnotation(fe[0]),J.focus(fe[0]))},N=()=>{const J=core.getAnnotationManager(),fe=J.getPreviousConsecutiveAnnotation();fe&&(core.jumpToAnnotation(fe),J.focus(fe))},I=()=>{const J=core.getAnnotationManager(),fe=J.getNextConsecutiveAnnotation();fe&&(core.jumpToAnnotation(fe),J.focus(fe))},O=()=>{core.setConsecutiveType(!1),n.setConsecutiveType(!1)},F=J=>{M&&clearTimeout(M),g.value=!0};core.addEvent("focus",F);const q=J=>{g.value=!1};core.addEvent("blur",q);const Y=()=>{M=setTimeout(()=>{I()},500)};core.addEvent("fieldChanged",Y);const _e=J=>{d.value=!0,y.x=J.clientX-f.x,y.y=J.clientY-f.y,document.addEventListener("mousemove",ve),document.addEventListener("mouseup",ne)},ne=()=>{d.value=!1,document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",ne)},ve=J=>{if(d.value){const fe=v.value.offsetWidth+(m.value?260:0),Z=v.value.offsetHeight,j=J.clientX-y.x,X=J.clientY-y.y,H=window.innerWidth-fe,U=window.innerHeight-Z;f.x=Math.min(Math.max(j,0),H),f.y=Math.min(Math.max(X,0),U)}};return(J,fe)=>{const Z=__unplugin_components_0$l,j=__unplugin_components_1$6,X=__unplugin_components_2$7,H=_sfc_main$4C,U=__unplugin_components_4$4;return withDirectives((openBlock(),createElementBlock("div",{ref_key:"formBoard",ref:v,class:normalizeClass(["form-board",{fold:k.value}]),style:normalizeStyle({left:f.x+"px",top:f.y+"px",transform:`translateX(${P.value}px)`}),onMousedown:_e},[createBaseVNode("div",_hoisted_1$N,[createBaseVNode("div",{onClick:fe[0]||(fe[0]=te=>k.value=!k.value)},[k.value?(openBlock(),createBlock(j,{key:1})):(openBlock(),createBlock(Z,{key:0}))])]),withDirectives(createBaseVNode("div",_hoisted_2$F,[r.value==="signForm"&&(S.unfilledFormFields>0||S.unsignFields>0)?(openBlock(),createElementBlock("div",_hoisted_3$A,toDisplayString(J.$t("form.note1",{formFields:S.formFields,unfilledFormFields:S.unfilledRequiredFormFields,signFields:S.signFields,unsignFields:S.unsignRequiredSignFields})),1)):r.value==="sign"&&S.unsignFields>0?(openBlock(),createElementBlock("div",_hoisted_4$6,toDisplayString(J.$t("form.note2",{signFields:S.signFields,unsignFields:S.unsignRequiredSignFields})),1)):r.value==="form"&&S.unfilledFormFields>0?(openBlock(),createElementBlock("div",_hoisted_5$3,toDisplayString(J.$t("form.note3",{formFields:S.formFields,unfilledFormFields:S.unfilledRequiredFormFields})),1)):r.value==="signForm"&&S.unfilledFormFields===0&&S.unsignFields===0?(openBlock(),createElementBlock("div",_hoisted_6$3,toDisplayString(J.$t("form.formSignFilled")),1)):r.value==="sign"&&S.unsignFields===0?(openBlock(),createElementBlock("div",_hoisted_7$3,toDisplayString(J.$t("form.signFilled")),1)):r.value==="form"&&S.unfilledFormFields===0?(openBlock(),createElementBlock("div",_hoisted_8$2,toDisplayString(J.$t("form.formFilled")),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_9$2,[createBaseVNode("div",null,[createTextVNode(toDisplayString(J.$t("form.startFill")),1),createBaseVNode("span",{class:"disable",onClick:O},toDisplayString(J.$t("form.consecutively")),1)])])],512),[[vShow,!k.value]]),createBaseVNode("div",{class:"navigator",onMousedown:fe[4]||(fe[4]=withModifiers(()=>{},["stop","self"])),onMouseup:fe[5]||(fe[5]=withModifiers(()=>{},["stop","self"])),onClick:fe[6]||(fe[6]=withModifiers(()=>{},["stop","prevent","self"])),onDblclick:fe[7]||(fe[7]=withModifiers(()=>{},["stop","self"]))},[createBaseVNode("span",{class:"start-btn",onClick:D,onMousedown:fe[1]||(fe[1]=withModifiers(()=>{},["stop","self"]))},toDisplayString(J.$t("form.start")),33),createVNode(H,{title:J.$t("form.previous"),onClick:N,onMousedown:fe[2]||(fe[2]=withModifiers(()=>{},["stop","self"])),disabled:!g.value},{default:withCtx(()=>[createVNode(X)]),_:1},8,["title","disabled"]),createVNode(H,{title:J.$t("form.next"),onClick:I,onMousedown:fe[3]||(fe[3]=withModifiers(()=>{},["stop","self"])),disabled:!g.value},{default:withCtx(()=>[createVNode(U)]),_:1},8,["title","disabled"])],32)],38)),[[vShow,E.value&&!x.value]])}}},_sfc_main$13={},_hoisted_1$M={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$E=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5663 0.846478C12.3457 0.625895 11.9792 0.658942 11.8017 0.915427L9.00221 4.95911C8.97541 4.99782 8.93581 5.02583 8.89039 5.03822L5.20212 6.04411C5.12329 6.06561 5.06548 6.13203 5.05485 6.21304C4.99741 6.65059 4.78835 8.10157 4.36452 9.61523C4.00509 10.8989 2.91361 13.3787 2.30714 14.7167C1.93791 14.5472 1.48666 14.6144 1.18254 14.9186C0.792017 15.3091 0.792017 15.9423 1.18254 16.3328C1.57307 16.7233 2.20623 16.7233 2.59676 16.3328C2.90731 16.0222 2.9709 15.5582 2.78754 15.1848C3.97427 14.6183 6.12247 13.6485 7.90006 13.1508C9.90855 12.5884 10.9209 12.4728 11.2798 12.4494C11.3716 12.4434 11.4526 12.3813 11.4768 12.2925L12.4771 8.6249C12.4895 8.57948 12.5175 8.53988 12.5562 8.51308L16.5999 5.71361C16.8563 5.53604 16.8894 5.16954 16.6688 4.94896L12.5663 0.846478ZM8.34417 7.93803C8.29817 7.89203 8.22119 7.90151 8.18771 7.95729L6.33809 11.04C6.28453 11.1293 6.38602 11.2308 6.47529 11.1772L9.558 9.32758C9.61378 9.2941 9.62326 9.21712 9.57726 9.17112L8.34417 7.93803ZM12.3814 12.3738C12.3814 12.1505 12.5293 11.9543 12.744 11.893L15.8033 11.0189C15.8931 10.9933 15.9883 10.9933 16.078 11.0189L19.1374 11.893C19.352 11.9543 19.5 12.1505 19.5 12.3738V15.913C19.5 16.0117 19.4713 16.1076 19.4146 16.1884C19.0137 16.7602 17.2809 19.1153 15.9407 19.1153C14.6004 19.1153 12.8677 16.7602 12.4667 16.1884C12.41 16.1076 12.3814 16.0117 12.3814 15.913V12.3738ZM14.9114 15.9254L14.9114 15.9255L15.6305 16.6446L17.9549 14.3201L17.2358 13.601L15.6305 15.2063L14.6993 14.2752L13.9802 14.9943L14.9114 15.9254Z",fill:"currentColor"},null,-1),_hoisted_3$z=[_hoisted_2$E];function _sfc_render$w(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$M,_hoisted_3$z)}const __unplugin_components_4$3=_export_sfc(_sfc_main$13,[["render",_sfc_render$w]]),_sfc_main$12={},_hoisted_1$L={width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$D=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5623 7.9067L14.6557 3L11.5014 7.55623L7.64623 8.60766C7.64623 8.60766 7.44842 10.3155 6.94528 12.1125C6.58896 13.3851 5.50688 15.8434 4.90572 17.1698C4.5396 17.0014 4.09196 17.068 3.79034 17.3696C3.40322 17.7568 3.40322 18.3844 3.79034 18.7715C4.17746 19.1587 4.80511 19.1587 5.19223 18.7715C5.5 18.4638 5.56308 18.004 5.38149 17.6339C6.55777 17.0723 8.68764 16.1107 10.45 15.6172C13.034 14.8937 13.9547 14.9163 13.9547 14.9163L15.0061 11.061L19.5623 7.9067ZM10.7997 10.3601L12.2016 11.762L8.69685 13.8649L10.7997 10.3601ZM17.9547 17.5658C17.6177 16.9944 17.0028 16.7812 16.1476 16.8013C16.0495 16.8036 15.9455 16.8091 15.8353 16.8179L15.4861 16.854L15.0991 16.9101C15.0313 16.9211 14.962 16.933 14.891 16.9457L14.445 17.0323L13.9583 17.1398L13.4299 17.2684L12.8587 17.4186L12.2436 17.5906L11.2363 17.8906L10.5067 18.119L9.32254 18.5051L8.47165 18.7921L7.10044 19.2678L7.68591 21L8.57815 20.6888L9.82355 20.2659L10.5929 20.0127L11.3145 19.782L12.3087 19.4775L12.9138 19.3017L13.737 19.0778L14.2305 18.9546L14.6806 18.8519L15.088 18.7692L15.4535 18.7063L15.7779 18.6628C15.93 18.6459 16.0669 18.636 16.189 18.6332L16.3181 18.6327L16.2761 18.8388C16.2125 19.1636 16.1998 19.3368 16.2394 19.5948C16.324 20.1475 16.6955 20.5595 17.257 20.7155C17.7746 20.8593 18.5301 20.7995 19.6673 20.5229L20.2199 20.3798C20.4134 20.327 20.6166 20.2689 20.8298 20.2057L21.5002 20.0001L20.9702 18.2494L20.3733 18.4324L19.8368 18.5865L19.3603 18.7128L18.9431 18.8123C18.8784 18.8267 18.8163 18.8401 18.7565 18.8524L18.4273 18.9139C18.3273 18.9303 18.237 18.9427 18.1562 18.9514L18.0859 18.9576L18.118 18.7913C18.2062 18.2932 18.1885 17.9622 17.9547 17.5658Z",fill:"currentColor"},null,-1),_hoisted_3$y=[_hoisted_2$D];function _sfc_render$v(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$L,_hoisted_3$y)}const __unplugin_components_3$3=_export_sfc(_sfc_main$12,[["render",_sfc_render$v]]),_sfc_main$11={},_hoisted_1$K={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$C=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5663 1.73124C12.3457 1.51066 11.9792 1.54371 11.8017 1.80019L9.00221 5.84387C8.97541 5.88258 8.93581 5.9106 8.89039 5.92298L5.20212 6.92888C5.12329 6.95038 5.06548 7.01679 5.05485 7.0978C4.99741 7.53536 4.78835 8.98634 4.36452 10.5C4.00509 11.7837 2.91361 14.2634 2.30714 15.6015C1.93791 15.4319 1.48666 15.4992 1.18254 15.8033C0.792017 16.1939 0.792017 16.827 1.18254 17.2175C1.57307 17.6081 2.20623 17.6081 2.59676 17.2175C2.90731 16.907 2.9709 16.443 2.78754 16.0696C3.97427 15.503 6.12247 14.5333 7.90006 14.0355C9.90855 13.4732 10.9209 13.3576 11.2798 13.3342C11.3716 13.3282 11.4526 13.266 11.4768 13.1773L12.4771 9.50966C12.4895 9.46424 12.5175 9.42465 12.5562 9.39785L16.5999 6.59838C16.8563 6.42081 16.8894 6.05431 16.6688 5.83373L12.5663 1.73124ZM8.34417 8.8228C8.29817 8.77679 8.22119 8.78627 8.18771 8.84206L6.33809 11.9248C6.28453 12.014 6.38602 12.1155 6.47529 12.062L9.558 10.2123C9.61378 10.1789 9.62326 10.1019 9.57726 10.0559L8.34417 8.8228ZM16.027 16.5933C15.9522 16.5981 15.8766 16.6005 15.8006 16.6005C15.7254 16.6005 15.6507 16.5982 15.5767 16.5935L14.0309 19.2709C13.9525 19.4067 13.7553 19.4035 13.6813 19.2651L13.0771 18.1343C13.0412 18.0671 12.9702 18.0262 12.8941 18.0287L11.6126 18.0708C11.4558 18.0759 11.3544 17.9067 11.4329 17.7709L12.9536 15.1369C12.5425 14.5632 12.3006 13.8601 12.3006 13.1005C12.3006 11.1675 13.8676 9.60053 15.8006 9.60053C17.7336 9.60053 19.3006 11.1675 19.3006 13.1005C19.3006 13.8592 19.0592 14.5615 18.649 15.1348L20.171 17.7709C20.2494 17.9067 20.148 18.0759 19.9912 18.0708L18.7098 18.0287C18.6336 18.0262 18.5627 18.0671 18.5268 18.1343L17.9225 19.2651C17.8486 19.4035 17.6514 19.4067 17.5729 19.2709L16.027 16.5933Z",fill:"currentColor"},null,-1),_hoisted_3$x=[_hoisted_2$C];function _sfc_render$u(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$K,_hoisted_3$x)}const __unplugin_components_2$6=_export_sfc(_sfc_main$11,[["render",_sfc_render$u]]),_sfc_main$10={},_hoisted_1$J={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$B=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 16V4H18V16H3ZM1.5 3.5C1.5 2.94772 1.94772 2.5 2.5 2.5H18.5C19.0523 2.5 19.5 2.94772 19.5 3.5V16.5C19.5 17.0523 19.0523 17.5 18.5 17.5H2.5C1.94772 17.5 1.5 17.0523 1.5 16.5V3.5ZM10.3774 13.1117C9.88462 14.0732 9.12745 14.6461 8.15796 14.6461C7.29663 14.6461 6.83191 14.1213 6.83191 13.3C6.83191 13.2359 6.83592 13.1758 6.84393 13.1117H4V12.2865H7.06427C7.2766 11.8017 7.62113 11.305 8.06982 10.8523C7.13237 10.1151 6.27505 8.98137 6.27505 7.62728C6.27505 6.38937 7.09231 5.5 8.25811 5.5C9.79649 5.5 10.8862 7.10247 11.0304 9.27383C11.3268 9.21774 11.6313 9.1897 11.9398 9.1897C12.5407 9.1897 12.9093 9.49417 12.9093 10.003C12.9093 10.067 12.8995 10.1298 12.8864 10.1889L12.844 10.3525C12.8309 10.4018 12.8212 10.445 12.8212 10.4797C12.8212 10.5238 12.8372 10.5398 12.8732 10.5398C12.9385 10.5398 13.0642 10.443 13.2278 10.3047L13.4031 10.1546L13.5985 9.98918C13.9722 9.67931 14.4221 9.35395 14.8082 9.35395C15.3152 9.35395 15.4429 9.75975 15.5112 10.1168L15.5627 10.4004C15.5929 10.5465 15.6313 10.6479 15.7176 10.6479C15.7399 10.6479 15.7763 10.6396 15.8268 10.623L15.9467 10.5788L16.1042 10.5123L16.2995 10.4238L16.4637 11.245L16.2383 11.3483L16.0433 11.4309C15.8337 11.5152 15.6864 11.5574 15.6014 11.5574C15.0514 11.5574 14.8602 11.2147 14.7653 10.8984L14.7297 10.7655L14.6756 10.5353C14.6496 10.4385 14.6205 10.3755 14.5679 10.3755C14.501 10.3755 14.3806 10.4669 14.2239 10.6019L13.8668 10.916L13.6613 11.0903C13.2715 11.4106 12.8163 11.7176 12.4005 11.7176C12.0279 11.7176 11.7635 11.4812 11.7635 11.1207C11.7635 10.9165 11.8211 10.7485 11.8751 10.5908C11.9229 10.4515 11.9678 10.3202 11.9678 10.1792C11.9678 10.1151 11.9158 10.0711 11.8236 10.0711C11.5592 10.0711 11.2948 10.1031 11.0424 10.1552C11.0144 10.9484 10.9022 11.6695 10.7099 12.2865H16.6226V13.1117H10.3774ZM7.15643 7.61933C7.15643 8.80115 7.97369 9.69854 8.73086 10.2834C9.15551 9.96695 9.63625 9.70254 10.1611 9.51025C10.089 7.72749 9.32778 6.38542 8.26213 6.38542C7.60912 6.38542 7.15643 6.90222 7.15643 7.61933ZM8.07385 12.2865H9.76046C9.95676 11.7737 10.089 11.1528 10.141 10.4597C9.9207 10.5639 9.70837 10.684 9.51207 10.8122C9.58685 10.8763 9.70169 10.9542 9.85658 11.0458L9.22061 11.5887L8.82301 11.3611C8.51053 11.6576 8.25413 11.978 8.07385 12.2865ZM7.76133 13.2119C7.76133 13.5444 7.9336 13.7648 8.2621 13.7648C8.66673 13.7648 9.03129 13.5244 9.33176 13.1118H7.76934C7.76894 13.1154 7.76853 13.119 7.76813 13.1226C7.76457 13.1543 7.76133 13.1831 7.76133 13.2119Z",fill:"currentColor"},null,-1),_hoisted_3$w=[_hoisted_2$B];function _sfc_render$t(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$J,_hoisted_3$w)}const __unplugin_components_0$a=_export_sfc(_sfc_main$10,[["render",_sfc_render$t]]),Danger=""+new URL("icon-danger.e75f0c25.svg",import.meta.url).href,SignatureToolBar_vue_vue_type_style_index_0_lang="",_hoisted_1$I={key:0,class:"signature-tool"},_sfc_main$$={__name:"SignatureToolBar",setup(e){const{t:n}=useTranslation(),{switchTool:o,switchAnnotationEditorMode:r,verifySignature:u}=core,s=useDocumentStore(),w=useViewerStore(),m=computed(()=>s.getActiveTool),v=computed(()=>s.getSignatures),g=computed(()=>s.getDisableDigitalSignature),d=computed(()=>s.getDisableElectronicSignature),f=computed(()=>w.getDisableSignatureTool);watch(()=>m.value,k=>{(k==="addDigitalSign"||k==="addElectronicSign")&&window.$message.warning(n("signatures.danger"),{duration:3e3,icon:()=>h$1("img",{src:Danger}),max:1,class:"sign-danger",style:{backgroundColor:"#FFF4E5"}})});const y=k=>{s.setToolState(k),w.toggleActiveHand(!1),o(0),r(0)},x=async()=>{y(""),await u();const k=v.value;if(k.length!==0){if(k.length===1){const P=k[0].signature,S=P.signerList[0].isSignVerified,E=P.signerList[0].isCertTrusted;S&&E?w.setSignatureVerify(1):S?S&&!E&&w.setSignatureVerify(3):w.setSignatureVerify(2);return}else for(let P=0;P<k.length;P++){const S=k[P].signature,E=S.signerList[0].isSignVerified,M=S.signerList[0].isCertTrusted;if(!(E&&M)&&(!E||!M)){w.setSignatureVerify(2);return}}w.setSignatureVerify(1)}};return(k,P)=>{const S=__unplugin_components_0$a,E=_sfc_main$4C,M=__unplugin_components_2$6,T=__unplugin_components_3$3,D=__unplugin_components_4$3;return f.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_1$I,[createVNode(E,{id:"createSignFieldButton",class:normalizeClass({active:m.value==="signatureFields"}),onClick:P[0]||(P[0]=N=>y("signatureFields")),title:k.$t("toolbar.signatureTools.createSignField")},{default:withCtx(()=>[createVNode(S),createBaseVNode("span",null,toDisplayString(k.$t("toolbar.signatureTools.createSignField")),1)]),_:1},8,["class","title"]),g.value?createCommentVNode("",!0):(openBlock(),createBlock(E,{key:0,class:normalizeClass({active:m.value==="addDigitalSign"}),onClick:P[1]||(P[1]=N=>y("addDigitalSign")),title:k.$t("toolbar.signatureTools.addDigitalSign")},{default:withCtx(()=>[createVNode(M),createBaseVNode("span",null,toDisplayString(k.$t("toolbar.signatureTools.addDigitalSign")),1)]),_:1},8,["class","title"])),d.value?createCommentVNode("",!0):(openBlock(),createBlock(E,{key:1,class:normalizeClass({active:m.value==="addElectronicSign"}),onClick:P[2]||(P[2]=N=>y("addElectronicSign")),title:k.$t("toolbar.signatureTools.addElectronicSign")},{default:withCtx(()=>[createVNode(T),createBaseVNode("span",null,toDisplayString(k.$t("toolbar.signatureTools.addElectronicSign")),1)]),_:1},8,["class","title"])),g.value?createCommentVNode("",!0):(openBlock(),createBlock(E,{key:2,onClick:x,title:k.$t("toolbar.signatureTools.verifyDigitalSign"),disabled:!v.value.length},{default:withCtx(()=>[createVNode(D),createBaseVNode("span",null,toDisplayString(k.$t("toolbar.signatureTools.verifyDigitalSign")),1)]),_:1},8,["title","disabled"]))]))}}},ComparedToolbar_vue_vue_type_style_index_0_lang="",_hoisted_1$H={class:"compare-toolbar"},_hoisted_2$A={class:"file-color"},_sfc_main$_={__name:"ComparedToolbar",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>o.getCompareSetting("oldFileColor")),u=computed(()=>o.getCompareSetting("newFileColor")),s=()=>{n.setCompareStatus("end"),o.initCompareFiles()};return(w,m)=>{const v=_sfc_main$36,g=__unplugin_components_1$h;return openBlock(),createElementBlock("div",_hoisted_1$H,[createVNode(v),createBaseVNode("div",_hoisted_2$A,[createBaseVNode("div",null,[createBaseVNode("div",{class:"color",style:normalizeStyle({"background-color":r.value})},null,4),createBaseVNode("span",null,toDisplayString(w.$t("compare.oldFile")),1)]),createBaseVNode("div",null,[createBaseVNode("div",{class:"color",style:normalizeStyle({"background-color":u.value})},null,4),createBaseVNode("span",null,toDisplayString(w.$t("compare.newFile")),1)])]),createVNode(g,{class:"close",onClick:s})])}}},_sfc_main$Z={},_hoisted_1$G={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$z=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3107 1.25H2.25V18.75H10V17.25H3.75V2.75H12.689L16.25 6.311V10H17.75V5.68934L13.3107 1.25ZM5 6H14V10H5V6ZM11.4945 15.1106L12.7372 13.5H17.5V16.5H12.6887L11.4945 15.1106ZM9.56053 15.1617L12 18H17.5H19V16.5V13.5V12H17.5H12L9.56053 15.1617Z",fill:"currentColor"},null,-1),_hoisted_3$v=[_hoisted_2$z];function _sfc_render$s(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$G,_hoisted_3$v)}const __unplugin_components_2$5=_export_sfc(_sfc_main$Z,[["render",_sfc_render$s]]),_sfc_main$Y={},_hoisted_1$F={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$y=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3107 1.25H2.25V18.75H17.75V5.68934L13.3107 1.25ZM12.689 2.75L16.25 6.311V17.25H3.75V2.75H12.689ZM15 8H5V12H15V8Z",fill:"currentColor"},null,-1),_hoisted_3$u=[_hoisted_2$y];function _sfc_render$r(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$F,_hoisted_3$u)}const __unplugin_components_0$9=_export_sfc(_sfc_main$Y,[["render",_sfc_render$r]]),RedactionToolbar_vue_vue_type_style_index_0_lang="",_hoisted_1$E={class:"redaction-toolbar"},_sfc_main$X={__name:"RedactionToolbar",props:["items"],setup(e){const n=useDocumentStore(),o=useViewerStore(),r=computed(()=>n.getActiveTool),u=computed(()=>n.getRedactionPrompted),s=w=>{u.value?r.value!==w&&(n.setToolState(w),o.resetPanels()):(n.setFirstEnterRedactionTool(w),o.openElement("redactionTipDialog"))};return(w,m)=>{const v=__unplugin_components_0$9,g=_sfc_main$4C,d=__unplugin_components_2$5,f=_sfc_main$2H;return openBlock(),createElementBlock("div",_hoisted_1$E,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(y,x)=>(openBlock(),createElementBlock(Fragment,{key:x},[y.type==="fillBlack"?(openBlock(),createBlock(g,{key:0,"data-element":y.dataElement,class:normalizeClass(["with-text",{active:r.value==="redaction"}]),onClick:m[0]||(m[0]=k=>s("redaction")),title:w.$t(y.title)},{default:withCtx(()=>[createVNode(v),createBaseVNode("span",null,toDisplayString(w.$t(y.title)),1)]),_:2},1032,["data-element","class","title"])):y.type==="fillWhite"?(openBlock(),createBlock(g,{key:1,"data-element":y.dataElement,class:normalizeClass(["with-text",{active:r.value==="remove"}]),onClick:m[1]||(m[1]=k=>s("remove")),title:w.$t(y.title)},{default:withCtx(()=>[createVNode(d),createBaseVNode("span",null,toDisplayString(w.$t(y.title)),1)]),_:2},1032,["data-element","class","title"])):y.name==="customButton"&&!y.hidden&&!y.dropItem?(openBlock(),createBlock(f,{key:2,item:y},null,8,["item"])):createCommentVNode("",!0)],64))),128))])}}},_sfc_main$W={},_hoisted_1$D={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$x=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.8333 7.33333H15.8333H14.5H13.1666H11.8333H7.83331V6C7.83331 4.52724 9.02722 3.33333 10.5 3.33333C11.9727 3.33333 13.1666 4.52724 13.1666 6H14.5C14.5 3.79086 12.7091 2 10.5 2C8.29084 2 6.49998 3.79086 6.49998 6V7.33333H5.16665C4.43027 7.33333 3.83331 7.93029 3.83331 8.66667V16.6667C3.83331 17.403 4.43027 18 5.16665 18H15.8333C16.5697 18 17.1666 17.403 17.1666 16.6667V8.66667C17.1666 7.93029 16.5697 7.33333 15.8333 7.33333ZM6.49998 8.6784V8.66667H5.16665L5.16665 16.6667H15.8333L15.8333 8.66667H14.5V8.6784H13.1666H7.83331H6.49998Z",fill:"currentColor"},null,-1),_hoisted_3$t=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.1667 13.4263C11.8182 13.1626 12.2778 12.5238 12.2778 11.7778C12.2778 10.7959 11.4818 10 10.5 10C9.51817 10 8.72223 10.7959 8.72223 11.7778C8.72223 12.5239 9.18185 13.1626 9.83339 13.4264V14.6667C9.83339 15.0349 10.1319 15.3333 10.5001 15.3333C10.8683 15.3333 11.1667 15.0349 11.1667 14.6667V13.4263Z",fill:"currentColor"},null,-1),_hoisted_4$5=[_hoisted_2$x,_hoisted_3$t];function _sfc_render$q(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$D,_hoisted_4$5)}const __unplugin_components_2$4=_export_sfc(_sfc_main$W,[["render",_sfc_render$q]]),_sfc_main$V={},_hoisted_1$C={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$w=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.1666 7.25722V6C13.1666 4.52724 11.9727 3.33333 10.4999 3.33333C9.02716 3.33333 7.83325 4.52724 7.83325 6V7.25722H13.1666ZM10.4999 2C8.29078 2 6.49992 3.79086 6.49992 6V7.25722V7.33333H4.72214C4.23122 7.33333 3.83325 7.7313 3.83325 8.22222V17.1111C3.83325 17.602 4.23122 18 4.72214 18H16.2777C16.7686 18 17.1666 17.602 17.1666 17.1111V8.22222C17.1666 7.7313 16.7686 7.33333 16.2777 7.33333H14.4999V7.25722V6C14.4999 3.79086 12.7091 2 10.4999 2ZM5.16659 8.66667V16.6667H15.8333V8.66667H5.16659ZM7.50005 11.5707V13.0707H13.5001V11.5707H7.50005Z",fill:"currentColor"},null,-1),_hoisted_3$s=[_hoisted_2$w];function _sfc_render$p(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$C,_hoisted_3$s)}const __unplugin_components_0$8=_export_sfc(_sfc_main$V,[["render",_sfc_render$p]]),SecurityToolbar_vue_vue_type_style_index_0_lang="",_hoisted_1$B={class:"security-toolbar"},_sfc_main$U={__name:"SecurityToolbar",props:["items"],setup(e){const n=getCurrentInstance().appContext.app.config.globalProperties,o=ref(!1),r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getFilehasPwd),w=computed(()=>u.getWebviewerMode),m=computed(()=>u.isElementOpen("setPasswordModal")),v=()=>{u.openElement("setPasswordModal")},g=async()=>{if(!s.value&&w.value!=="Standalone"||o.value)return;o.value=!0,await core.removePassword()?window.$message.success(n.$t("passwordDialog.removeSuccess"),{duration:3e3,icon:()=>h$1("img",{src:MessageSuccess})}):window.$message.error(n.$t("passwordDialog.removeFailure"),{duration:3e3,icon:()=>h$1("img",{src:MessageError})}),o.value=!1};return(d,f)=>{const y=__unplugin_components_0$8,x=_sfc_main$4C,k=__unplugin_components_2$4,P=_sfc_main$2H;return openBlock(),createElementBlock("div",_hoisted_1$B,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(S,E)=>(openBlock(),createElementBlock(Fragment,{key:E},[S.type==="encryption"?(openBlock(),createBlock(x,{key:0,"data-element":S.dataElement,class:normalizeClass(["with-text",{active:m.value}]),onClick:v,title:d.$t(S.title)},{default:withCtx(()=>[createVNode(y),createBaseVNode("span",null,toDisplayString(d.$t(S.title)),1)]),_:2},1032,["data-element","class","title"])):S.type==="decryption"?(openBlock(),createBlock(x,{key:1,"data-element":S.dataElement,class:normalizeClass(["with-text",{disabled:!s.value&&w.value!=="Standalone"}]),onClick:g,title:d.$t(S.title)},{default:withCtx(()=>[createVNode(k),createBaseVNode("span",null,toDisplayString(d.$t(S.title)),1)]),_:2},1032,["data-element","class","title"])):S.name==="customButton"&&!S.hidden&&!S.dropItem?(openBlock(),createBlock(P,{key:2,item:S},null,8,["item"])):createCommentVNode("",!0)],64))),128))])}}},_sfc_main$T={},_hoisted_1$A={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$v=createBaseVNode("path",{d:"M16.5 7.75H15V3.5H3.5V17H8.5V18.5H2V2H16.5V7.75ZM19.0029 12.0068L12.6064 18.25H9.07129L9.10352 14.835L15.4668 8.47168L19.0029 12.0068ZM10.5977 15.4629L10.585 16.75H11.9951L16.8682 11.9941L15.4668 10.5928L10.5977 15.4629ZM10 10H5V8.5H10V10ZM13 6.5H5V5H13V6.5Z",fill:"currentColor"},null,-1),_hoisted_3$r=[_hoisted_2$v];function _sfc_render$o(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$A,_hoisted_3$r)}const __unplugin_components_0$7=_export_sfc(_sfc_main$T,[["render",_sfc_render$o]]),_sfc_main$S={__name:"FillForm",setup(e){const n=computed(()=>o.getEnableFillForm),o=useViewerStore(),r=useDocumentStore(),u=computed(()=>r.getActiveTool);watch(()=>u.value,v=>{v&&n.value&&(o.setEnableFillForm(!1),core.getAnnotationManager().endFormFieldFillMode())});const s=()=>{const v=core.getAnnotationManager();v.isInFormFieldFillMode()?(v.endFormFieldFillMode(),o.setEnableFillForm(!1)):(v.startFormFieldFillMode(),o.setEnableFillForm(!0),r.setToolState(""),o.toggleActiveHand(!1))},w=()=>{o.setEnableFillForm(!0)},m=()=>{o.setEnableFillForm(!1)};return core.addEvent("formFieldFillModeStarted",w),core.addEvent("formFieldFillModeEnded",m),onMounted(()=>{core.getAnnotationManager().isInFormFieldFillMode()&&o.setEnableFillForm(!0)}),(v,g)=>{const d=__unplugin_components_0$7,f=_sfc_main$4C;return openBlock(),createBlock(f,{class:normalizeClass(["with-text",{active:n.value}]),title:v.$t("toolbar.formTools.FillSign"),onClick:s},{default:withCtx(()=>[createVNode(d),createBaseVNode("span",null,toDisplayString(v.$t("toolbar.formTools.FillSign")),1)]),_:1},8,["title","class"])}}},_sfc_main$R={__name:"PushButton",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$s,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="pushbutton"}]),title:m.$t("toolbar.formTools.button"),onClick:v[0]||(v[0]=f=>w("pushbutton"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.button")),1)]),_:1},8,["title","class"])}}},_sfc_main$Q={__name:"ComboBox",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$r,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="combobox"}]),title:m.$t("toolbar.formTools.comboButton"),onClick:v[0]||(v[0]=f=>w("combobox"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.comboButton")),1)]),_:1},8,["title","class"])}}},_sfc_main$P={__name:"ListBox",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$q,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="listbox"}]),title:m.$t("toolbar.formTools.listBox"),onClick:v[0]||(v[0]=f=>w("listbox"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.listBox")),1)]),_:1},8,["title","class"])}}},_sfc_main$O={__name:"RadioButton",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$p,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="radiobutton"}]),title:m.$t("toolbar.formTools.radioButton"),onClick:v[0]||(v[0]=f=>w("radiobutton"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.radioButton")),1)]),_:1},8,["title","class"])}}},_sfc_main$N={__name:"CheckBoxButton",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$o,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="checkbox"}]),title:m.$t("toolbar.formTools.checkbox"),onClick:v[0]||(v[0]=f=>w("checkbox"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.checkbox")),1)]),_:1},8,["title","class"])}}},_sfc_main$M={__name:"TextFieldButton",props:["item"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=m=>{r.setToolState(m),u.toggleActiveHand(!1),n(0),o(0)};return(m,v)=>{const g=__unplugin_components_0$n,d=_sfc_main$4C;return openBlock(),createBlock(d,{class:normalizeClass(["with-text",{active:s.value==="textfield"}]),title:m.$t("toolbar.formTools.textField"),onClick:v[0]||(v[0]=f=>w("textfield"))},{default:withCtx(()=>[createVNode(g),createBaseVNode("span",null,toDisplayString(m.$t("toolbar.formTools.textField")),1)]),_:1},8,["title","class"])}}},FormToolBar_vue_vue_type_style_index_0_scoped_8ad4ff66_lang="",_hoisted_1$z={class:"form-tool"},_sfc_main$L={__name:"FormToolBar",props:["items"],setup(e){const n=useDocumentStore(),o=useViewerStore(),r=computed(()=>o.getToolMode),u=computed(()=>o.getIsAnnotationPopup),s=computed(()=>o.isElementOpen("rightPanel")),w=computed(()=>o.getEnableFillForm),m=computed(()=>o.getUserAdmin),v=computed(()=>o.getReadOnly),g=computed(()=>n.getAnnotator),d=ref(!0);let f=null;const y=ref(!m.value&&(v.value||f&&g!==f.author)),x=["textfield","checkbox","radiobutton","listbox","combobox","pushbutton","signatureFields"];watch([m,v],()=>{y.value=!m.value&&(v.value||f&&g!==f.author)});const k=()=>{o.toggleElement("rightPanel")},P=E=>{f=E,y.value=!m.value&&(v.value||f&&g.value!==f.author)};core.addEvent("annotationSelected",P);const S=()=>{setTimeout(()=>{document.getElementsByClassName("outline-container").length&&x.includes(f==null?void 0:f.type)?d.value=!1:d.value=!0})};return core.addEvent("changeRightPanelBtnDisabled",S),(E,M)=>{const T=_sfc_main$M,D=_sfc_main$N,N=_sfc_main$O,I=_sfc_main$P,O=_sfc_main$Q,F=_sfc_main$R,q=_sfc_main$S,Y=_sfc_main$2H,_e=__unplugin_components_21,ne=_sfc_main$4C;return openBlock(),createElementBlock("div",_hoisted_1$z,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(ve,J)=>(openBlock(),createElementBlock(Fragment,{key:J},[ve.type==="textFieldButton"&&!ve.hidden?(openBlock(),createBlock(T,{key:0,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="checkBoxButton"&&!ve.hidden?(openBlock(),createBlock(D,{key:1,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="radioButton"&&!ve.hidden?(openBlock(),createBlock(N,{key:2,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="listBox"&&!ve.hidden?(openBlock(),createBlock(I,{key:3,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="comboBox"&&!ve.hidden?(openBlock(),createBlock(O,{key:4,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="pushButton"&&!ve.hidden?(openBlock(),createBlock(F,{key:5,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.type==="fillForm"&&!ve.hidden?(openBlock(),createBlock(q,{key:6,item:ve,"data-element":ve.dataElement},null,8,["item","data-element"])):ve.name==="customButton"&&!ve.hidden&&!ve.dropItem?(openBlock(),createBlock(Y,{key:7,item:ve},null,8,["item"])):["spacer","divider"].includes(ve.type)?(openBlock(),createElementBlock("div",{key:8,class:normalizeClass(ve.type)},null,2)):ve.type==="property"&&!ve.hidden&&u.value?(openBlock(),createBlock(ne,{key:9,onClick:k,title:E.$t(ve.title),"data-element":ve.dataElement,isActive:s.value,disabled:d.value&&r.value==="form"||w.value||y.value,id:ve.id,class:"property"},{default:withCtx(()=>[createVNode(_e)]),_:2},1032,["title","data-element","isActive","disabled","id"])):createCommentVNode("",!0)],64))),128))])}}},__unplugin_components_5$1=_export_sfc(_sfc_main$L,[["__scopeId","data-v-8ad4ff66"]]),MeasurementToolBar_vue_vue_type_style_index_0_scoped_c8b76144_lang="",_hoisted_1$y={class:"measurement-tool"},_sfc_main$K={__name:"MeasurementToolBar",props:["items"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool),w=computed(()=>u.isElementOpen("measurePanel")),m=computed(()=>u.getIsAnnotationPopup),v=ref(!0);let g=null;const d=k=>{r.setToolState(k),u.toggleActiveHand(!1),n(0),o(0)},f=()=>{u.toggleElement("measurePanel")},y=k=>{g=k,setTimeout(()=>{document.getElementsByClassName("outline-container").length&&g&&g.measure?v.value=!1:v.value=!0})};core.addEvent("annotationSelected",y);const x=()=>{g=null,v.value=!0};return core.addEvent("annotationDeselected",x),(k,P)=>{const S=__unplugin_components_0$k,E=_sfc_main$4C,M=__unplugin_components_2$d,T=__unplugin_components_3$8,D=__unplugin_components_4$9,N=__unplugin_components_5$4,I=__unplugin_components_6$4,O=__unplugin_components_7$2,F=_sfc_main$2H,q=__unplugin_components_21;return openBlock(),createElementBlock("div",_hoisted_1$y,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(Y,_e)=>(openBlock(),createElementBlock(Fragment,{key:_e},[Y.type==="line"&&!Y.hidden?(openBlock(),createBlock(E,{key:0,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="line"}]),title:k.$t(Y.title),onClick:P[0]||(P[0]=ne=>d("line"))},{default:withCtx(()=>[createVNode(S),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="polyline"&&!Y.hidden?(openBlock(),createBlock(E,{key:1,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="polyline"}]),title:k.$t(Y.title),onClick:P[1]||(P[1]=ne=>d("polyline"))},{default:withCtx(()=>[createVNode(M),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="curve"&&!Y.hidden?(openBlock(),createBlock(E,{key:2,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="curve"}]),title:k.$t(Y.title),onClick:P[2]||(P[2]=ne=>d("curve"))},{default:withCtx(()=>[createVNode(T),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="arc"&&!Y.hidden?(openBlock(),createBlock(E,{key:3,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="arc"}]),title:k.$t(Y.title),onClick:P[3]||(P[3]=ne=>d("arc"))},{default:withCtx(()=>[createVNode(D),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="circle"&&!Y.hidden?(openBlock(),createBlock(E,{key:4,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="circle"}]),title:k.$t(Y.title),onClick:P[4]||(P[4]=ne=>d("circle"))},{default:withCtx(()=>[createVNode(N),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="rectangle"&&!Y.hidden?(openBlock(),createBlock(E,{key:5,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="rectangle"}]),title:k.$t(Y.title),onClick:P[5]||(P[5]=ne=>d("rectangle"))},{default:withCtx(()=>[createVNode(I),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.type==="polygon"&&!Y.hidden?(openBlock(),createBlock(E,{key:6,"data-element":Y.dataElement,class:normalizeClass(["with-text",{active:s.value==="polygon"}]),title:k.$t(Y.title),onClick:P[6]||(P[6]=ne=>d("polygon"))},{default:withCtx(()=>[createVNode(O),createBaseVNode("span",null,toDisplayString(k.$t(Y.title)),1)]),_:2},1032,["data-element","class","title"])):Y.name==="customButton"&&!Y.hidden&&!Y.dropItem?(openBlock(),createBlock(F,{key:7,item:Y},null,8,["item"])):["spacer","divider"].includes(Y.type)?(openBlock(),createElementBlock("div",{key:8,class:normalizeClass(Y.type)},null,2)):Y.type==="property"&&!Y.hidden&&m.value?(openBlock(),createBlock(E,{key:9,onClick:f,title:k.$t(Y.title),"data-element":Y.dataElement,isActive:w.value,disabled:v.value&&!["line","polyline","curve","arc","circle","rectangle","polygon"].includes(s.value),id:Y.id,class:"property"},{default:withCtx(()=>[createVNode(q)]),_:2},1032,["title","data-element","isActive","disabled","id"])):createCommentVNode("",!0)],64))),128))])}}},__unplugin_components_4$2=_export_sfc(_sfc_main$K,[["__scopeId","data-v-c8b76144"]]),_sfc_main$J={},_hoisted_1$x={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$u=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.2802 7.62131L16.8105 8.15164L16.2802 8.68197L12.6589 12.3033L11.5982 11.2426L13.9392 8.90164H7.24989C5.7311 8.90164 4.49989 10.1329 4.49989 11.6516C4.49989 13.1704 5.7311 14.4016 7.24989 14.4016H14.7499V15.9016H7.24989C4.90268 15.9016 2.99989 13.9988 2.99989 11.6516C2.99989 9.30443 4.90268 7.40164 7.24989 7.40164H13.9392L11.5982 5.06066L12.6589 4L16.2802 7.62131Z",fill:"currentColor"},null,-1),_hoisted_3$q=[_hoisted_2$u];function _sfc_render$n(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$x,_hoisted_3$q)}const __unplugin_components_4$1=_export_sfc(_sfc_main$J,[["render",_sfc_render$n]]),_sfc_main$I={},_hoisted_1$w={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$t=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.53033 7.62131L3 8.15164L3.53033 8.68197L7.15164 12.3033L8.2123 11.2426L5.87132 8.90164H12.5607C14.0794 8.90164 15.3107 10.1329 15.3107 11.6516C15.3107 13.1704 14.0794 14.4016 12.5607 14.4016H5.06066V15.9016H12.5607C14.9079 15.9016 16.8107 13.9988 16.8107 11.6516C16.8107 9.30443 14.9079 7.40164 12.5607 7.40164H5.87132L8.2123 5.06066L7.15164 4L3.53033 7.62131Z",fill:"currentColor"},null,-1),_hoisted_3$p=[_hoisted_2$t];function _sfc_render$m(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$w,_hoisted_3$p)}const __unplugin_components_3$2=_export_sfc(_sfc_main$I,[["render",_sfc_render$m]]),_sfc_main$H={},_hoisted_1$v={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$s=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.5 3H1.75V3.75V16.25V17H2.5H19H19.75V16.25V10H18.25V15.5H18.2147L12.8718 10.8178L10.5643 13.25L6.29496 9.75L3.25 12.9595V4.5H13.75V3H2.5ZM14.5 8.25C14.5 9.07843 13.8284 9.75 13 9.75C12.1716 9.75 11.5 9.07843 11.5 8.25C11.5 7.42157 12.1716 6.75 13 6.75C13.8284 6.75 14.5 7.42157 14.5 8.25ZM16.75 6.75H14.5V5.25H16.75V3H18.25V5.25H20.5V6.75H18.25V9H16.75V6.75Z",fill:"currentColor"},null,-1),_hoisted_3$o=[_hoisted_2$s];function _sfc_render$l(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$v,_hoisted_3$o)}const __unplugin_components_2$3=_export_sfc(_sfc_main$H,[["render",_sfc_render$l]]),_sfc_main$G={},_hoisted_1$u={width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$r=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.25 3H1.5V3.75V16.25V17H2.25H18.75H19.5V16.25V10H18V15.5H3V4.5H13.5V3H2.25ZM12.5 8V5.5H4.5V8H6V7H7.75V13H7V14.5H10V13H9.25V7H11V8H12.5ZM16.75 6.75H14.5V5.25H16.75V3H18.25V5.25H20.5V6.75H18.25V9H16.75V6.75Z",fill:"currentColor"},null,-1),_hoisted_3$n=[_hoisted_2$r];function _sfc_render$k(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$u,_hoisted_3$n)}const __unplugin_components_0$6=_export_sfc(_sfc_main$G,[["render",_sfc_render$k]]),ContentEditorToolBar_vue_vue_type_style_index_0_scoped_10c19a71_lang="",_hoisted_1$t={class:"edit-tool"},_hoisted_2$q=["data-element"],_sfc_main$F={__name:"ContentEditorToolBar",props:["items"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o,resetOperate:r}=core,u=useDocumentStore(),s=useViewerStore(),w=computed(()=>s.getToolMode),m=computed(()=>u.getActiveTool),v=computed(()=>s.getCurrentPage),g=computed(()=>s.isElementOpen("contentEditorPanel")),d=ref(0),f=ref(0),y=ref(!0),x=ref(!0),k=()=>{s.toggleElement("contentEditorPanel")},P=N=>{w.value==="editor"&&(x.value=N)};core.addEvent("changeRightPanelBtnDisabled",P);const S=N=>{u.setToolState(N),s.toggleActiveHand(!1),n(0),o(0),m.value==="addImage"&&isMobileDevice&&document.getElementById("editorImageInput").click()},E=N=>{const I=N.target.files[0];if(!I)return;if(I.size>2*1024*1024){window.$message.error(instance.$t("contentEditor.imageProperties.maxSize"),{duration:3e3,icon:()=>h$1("img",{src:MessageError})}),N.target.value="";return}const O=new FileReader;O.onload=function(F){const q=new Image;q.onload=function(){const Y={imageBase64:F.target.result,width:q.width,height:q.height,pageNum:v.value};core.addEditorImage(Y)},q.onerror=function(Y){console.log(Y)},q.src=F.target.result},O.onerror=function(F){console.log(F)},O.readAsDataURL(I)},M=N=>{r({operation:N,pageNumber:v.value})},T=N=>{d.value=N.undoListLength,f.value=N.redoListLength};core.addEvent("changeOperateList",T);const D=N=>{if(!y.value)return;const I=N.key.toLowerCase();(N.ctrlKey||N.metaKey)&&I==="z"&&!N.shiftKey&&d.value&&M("undo"),(N.ctrlKey&&I==="y"||N.metaKey&&N.shiftKey&&I==="z")&&f.value&&M("redo")};return onMounted(()=>{document.addEventListener("keydown",D)}),onUnmounted(()=>{document.removeEventListener("keydown",D),y.value=!1}),(N,I)=>{const O=__unplugin_components_0$6,F=_sfc_main$4C,q=__unplugin_components_2$3,Y=__unplugin_components_3$2,_e=__unplugin_components_4$1,ne=_sfc_main$2H,ve=__unplugin_components_21;return openBlock(),createElementBlock("div",_hoisted_1$t,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(J,fe)=>(openBlock(),createElementBlock(Fragment,{key:fe},[J.type==="addText"?(openBlock(),createBlock(F,{key:0,"data-element":J.dataElement,class:normalizeClass(["operate",{active:m.value==="addText"}]),onClick:I[0]||(I[0]=Z=>S("addText")),title:N.$t(J.title)},{default:withCtx(()=>[createVNode(O),createTextVNode(toDisplayString(N.$t(J.title)),1)]),_:2},1032,["data-element","class","title"])):J.type==="addImage"?(openBlock(),createBlock(F,{key:1,"data-element":J.dataElement,class:normalizeClass(["operate",{active:m.value==="addImage"}]),onClick:I[1]||(I[1]=Z=>S("addImage")),title:"Add Image"},{default:withCtx(()=>[createVNode(q),createTextVNode(toDisplayString(N.$t(J.title)),1),unref(isMobileDevice)?(openBlock(),createElementBlock("input",{key:0,type:"file",id:"editorImageInput",accept:".png, .jpg, .jpeg",style:{display:"none"},onChange:E,name:"editor"},null,32)):createCommentVNode("",!0)]),_:2},1032,["data-element","class"])):J.type==="divider"?(openBlock(),createElementBlock("div",{key:2,"data-element":J.dataElement,class:"divider pc"},null,8,_hoisted_2$q)):J.type==="undo"?(openBlock(),createBlock(F,{key:3,"data-element":J.dataElement,class:normalizeClass(["history",{disabled:!d.value}]),id:"undo",title:N.$t(J.title),onClick:I[2]||(I[2]=Z=>M("undo"))},{default:withCtx(()=>[createVNode(Y)]),_:2},1032,["data-element","class","title"])):J.type==="redo"?(openBlock(),createBlock(F,{key:4,"data-element":J.dataElement,class:normalizeClass(["history",{disabled:!f.value}]),id:"redo",title:N.$t(J.title),onClick:I[3]||(I[3]=Z=>M("redo"))},{default:withCtx(()=>[createVNode(_e)]),_:2},1032,["data-element","class","title"])):J.name==="customButton"&&!J.hidden&&!J.dropItem?(openBlock(),createBlock(ne,{key:5,item:J},null,8,["item"])):["spacer","divider"].includes(J.type)?(openBlock(),createElementBlock("div",{key:6,class:normalizeClass(J.type)},null,2)):J.type==="property"&&!J.hidden?(openBlock(),createBlock(F,{key:7,onClick:k,title:N.$t(J.title),"data-element":J.dataElement,isActive:g.value,disabled:x.value&&w.value==="editor",id:J.id,class:"property"},{default:withCtx(()=>[createVNode(ve)]),_:2},1032,["title","data-element","isActive","disabled","id"])):createCommentVNode("",!0)],64))),128))])}}},__unplugin_components_3$1=_export_sfc(_sfc_main$F,[["__scopeId","data-v-10c19a71"]]),_sfc_main$E={__name:"StickyNoteButton",props:["item"],setup(e){const{switchAnnotationEditorMode:n,switchTool:o}=core,r=useViewerStore(),u=useDocumentStore(),s=v=>{u.setToolState(v),r.toggleActiveHand(!1)},w=computed(()=>u.getActiveTool);computed(()=>r.getActiveStickNote);const m=()=>{s("text"),r.toggleActiveStickNote(),n(0),o(0),r.closeActiveHand(),r.closeActiveMeasure()};return(v,g)=>{const d=__unplugin_components_0$c,f=_sfc_main$4C;return openBlock(),createBlock(f,mergeProps({isActive:w.value==="text"},{...e.item},{onClick:m,title:v.$t("toolbar.annotationTools.note")}),{default:withCtx(()=>[createVNode(d)]),_:1},16,["isActive","title"])}}},Annotate_vue_vue_type_style_index_0_lang="",Annotate_vue_vue_type_style_index_1_scoped_0a1a6af5_lang="",_hoisted_1$s={key:1,class:"markup-container"},_hoisted_2$p={key:3,class:"shape-container"},_sfc_main$D={__name:"Annotate",props:["items"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useDocumentStore(),u=useViewerStore(),s=computed(()=>r.getActiveTool);computed(()=>!["text","ink","highlight","underline","squiggly","strikeout","arc","circle","square","polygon","cloudy","polyline","arrow","line","freetext","callout"].includes(s.value));const w=computed(()=>["highlight","underline","squiggly","strikeout"].includes(s.value)),m=computed(()=>["square","circle","arrow","line","arc","polygon","polyline"].includes(s.value)),v=computed(()=>r.getMarkupToolState),g=computed(()=>r.getShapeToolState),d=computed(()=>u.isElementOpen("measurePanel")||u.isElementOpen("freetextPanel")),f=computed(()=>u.getToolMode),y=computed(()=>u.getIsAnnotationPopup),x=computed(()=>u.getUserAdmin),k=computed(()=>u.getReadOnly),P=computed(()=>r.getAnnotator);let S=null;const E=ref(!x.value&&(k.value||S&&P!==S.author)),M=ref(!0),T=["text","ink","highlight","underline","squiggly","strikeout","square","circle","arrow","line","arc","polygon","polyline","freetext","stamp","image"];watch([x,k],()=>{E.value=!x.value&&(k.value||S&&P!==S.author)});const D=_e=>{const ne=core.getScrollViewElement();s===_e&&w?ne.style.touchAction="auto":ne.style.touchAction="none",r.setMarkupToolState(_e),q(_e)},N=_e=>{r.setShapeToolState(_e),q(_e)},I=()=>{s.value==="image"&&q("image")};core.addEvent("imageChange",I),onUnmounted(()=>{core.removeEvent("imageChange",I)});const O=()=>{if(!S&&s.value==="freetext"){u.toggleElement("freetextPanel");return}else if(!S&&["text","ink","highlight","underline","squiggly","strikeout","arc","circle","square","polygon","cloudy","polyline","arrow","line","freetext","callout"].includes(s.value)){u.toggleElement("stylePanel");return}S.type==="freetext"?u.toggleElement("freetextPanel"):u.toggleElement("measurePanel")};computed(()=>r.getActiveToolColor);const F=_e=>{S=_e,E.value=!x.value&&(k.value||S&&P.value!==S.author),setTimeout(()=>{(document.getElementsByClassName("outline-container").length||document.getElementsByClassName("text-editor").length)&&T.includes(S==null?void 0:S.type)&&!S.measure?M.value=!1:M.value=!0})},q=_e=>{if(r.setToolState(_e),u.toggleActiveHand(!1),n(0),o(0),_e==="stamp"?u.toggleElement("stampPanel"):u.closeElement("stampPanel"),s.value==="image"){const ne=isMobileDevice?"annotaionImageInput":"signImageInput";document.getElementById(ne).click()}};core.addEvent("annotationSelected",F);const Y=_e=>{_e&&_e.name!==S.name||(S=null,M.value=!0)};return core.addEvent("annotationDeselected",Y),(_e,ne)=>{const ve=_sfc_main$E,J=__unplugin_components_1$7,fe=_sfc_main$4C,Z=__unplugin_components_3$a,j=__unplugin_components_4$a,X=__unplugin_components_5$5,H=__unplugin_components_6$5,U=__unplugin_components_7$3,te=__unplugin_components_8$2,Q=__unplugin_components_9$5,re=__unplugin_components_10$2,Pe=__unplugin_components_11,be=__unplugin_components_12,we=__unplugin_components_13,Ae=__unplugin_components_14$3,$e=__unplugin_components_15,Me=__unplugin_components_16,Ie=__unplugin_components_17,Le=__unplugin_components_18,le=__unplugin_components_19,oe=_sfc_main$2H,ke=__unplugin_components_21;return openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(Ce,Ee)=>(openBlock(),createElementBlock(Fragment,{key:`${Ce.type}-${Ce.dataElement||Ee}`},[Ce.type==="note"&&!Ce.hidden?(openBlock(),createBlock(ve,{key:0,"data-element":Ce.dataElement},null,8,["data-element"])):createCommentVNode("",!0),["highlight","underline","strikeout","squiggly"].includes(Ce.type)?(openBlock(),createElementBlock("div",_hoisted_1$s,[Ce.type==="highlight"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:0,"data-element":Ce.dataElement,class:normalizeClass({active:w.value&&v.value==="highlight"}),onClick:ne[0]||(ne[0]=withModifiers(Be=>D("highlight"),["stop"])),title:_e.$t("toolbar.annotationTools.highlight")},{default:withCtx(()=>[createVNode(J)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="underline"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:1,"data-element":Ce.dataElement,class:normalizeClass({active:w.value&&v.value==="underline"}),onClick:ne[1]||(ne[1]=withModifiers(Be=>D("underline"),["stop"])),title:_e.$t("toolbar.annotationTools.underline")},{default:withCtx(()=>[createVNode(Z)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="strikeout"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:2,"data-element":Ce.dataElement,class:normalizeClass({active:w.value&&v.value==="strikeout"}),onClick:ne[2]||(ne[2]=withModifiers(Be=>D("strikeout"),["stop"])),title:_e.$t("toolbar.annotationTools.strikeout")},{default:withCtx(()=>[createVNode(j)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="squiggly"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:3,"data-element":Ce.dataElement,class:normalizeClass({active:w.value&&v.value==="squiggly"}),onClick:ne[3]||(ne[3]=withModifiers(Be=>D("squiggly"),["stop"])),title:_e.$t("toolbar.annotationTools.squiggly")},{default:withCtx(()=>[createVNode(X)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0)])):createCommentVNode("",!0),Ce.type==="ink"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:2,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="ink"}),onClick:ne[4]||(ne[4]=Be=>q("ink")),title:_e.$t("toolbar.annotationTools.ink")},{default:withCtx(()=>[createVNode(H)]),_:2},1032,["data-element","class","title"])):["circle","square","cloudy","arrow","line","arc","polygon","polyline"].includes(Ce.type)?(openBlock(),createElementBlock("div",_hoisted_2$p,[Ce.type==="circle"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:0,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="circle"}),onClick:ne[5]||(ne[5]=withModifiers(Be=>N("circle"),["stop"])),title:_e.$t("toolbar.annotationTools.circle")},{default:withCtx(()=>[createVNode(U)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="arc"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:1,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="arc"}),onClick:ne[6]||(ne[6]=withModifiers(Be=>N("arc"),["stop"])),title:_e.$t("toolbar.annotationTools.arc")},{default:withCtx(()=>[createVNode(te)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="square"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:2,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="square"}),onClick:ne[7]||(ne[7]=withModifiers(Be=>N("square"),["stop"])),title:_e.$t("toolbar.annotationTools.square")},{default:withCtx(()=>[createVNode(Q)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="polygon"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:3,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="polygon"}),onClick:ne[8]||(ne[8]=withModifiers(Be=>N("polygon"),["stop"])),title:_e.$t("toolbar.annotationTools.polygon")},{default:withCtx(()=>[createVNode(re)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="cloudy"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:4,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="cloudy"}),onClick:ne[9]||(ne[9]=Be=>N("cloudy")),title:_e.$t("toolbar.annotationTools.cloudy")},{default:withCtx(()=>[createVNode(Pe)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="polyline"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:5,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="polyline"}),onClick:ne[10]||(ne[10]=withModifiers(Be=>N("polyline"),["stop"])),title:_e.$t("toolbar.annotationTools.polyline")},{default:withCtx(()=>[createVNode(be)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="arrow"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:6,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="arrow"}),onClick:ne[11]||(ne[11]=withModifiers(Be=>N("arrow"),["stop"])),title:_e.$t("toolbar.annotationTools.arrow")},{default:withCtx(()=>[createVNode(we)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0),Ce.type==="line"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:7,"data-element":Ce.dataElement,class:normalizeClass({active:m.value&&g.value==="line"}),onClick:ne[12]||(ne[12]=withModifiers(Be=>N("line"),["stop"])),title:_e.$t("toolbar.annotationTools.line")},{default:withCtx(()=>[createVNode(Ae)]),_:2},1032,["data-element","class","title"])):createCommentVNode("",!0)])):Ce.type==="freetext"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:4,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="freetext"}),onClick:ne[13]||(ne[13]=Be=>q("freetext")),title:_e.$t("toolbar.annotationTools.freetext")},{default:withCtx(()=>[createVNode($e)]),_:2},1032,["data-element","class","title"])):Ce.type==="callout"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:5,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="callout"}),onClick:ne[14]||(ne[14]=Be=>N("callout")),title:_e.$t("toolbar.annotationTools.callout")},{default:withCtx(()=>[createVNode(Me)]),_:2},1032,["data-element","class","title"])):Ce.type==="stamp"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:6,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="stamp"}),onClick:ne[15]||(ne[15]=Be=>q("stamp")),title:_e.$t("toolbar.annotationTools.stamp")},{default:withCtx(()=>[createVNode(Ie)]),_:2},1032,["data-element","class","title"])):Ce.type==="image"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:7,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="image"}),onClick:ne[16]||(ne[16]=Be=>q("image")),title:_e.$t("toolbar.annotationTools.image")},{default:withCtx(()=>[createVNode(Le)]),_:2},1032,["data-element","class","title"])):Ce.type==="link"&&!Ce.hidden?(openBlock(),createBlock(fe,{key:8,"data-element":Ce.dataElement,class:normalizeClass({active:s.value==="link"}),onClick:ne[17]||(ne[17]=Be=>q("link")),title:_e.$t("toolbar.annotationTools.link")},{default:withCtx(()=>[createVNode(le)]),_:2},1032,["data-element","class","title"])):Ce.name==="customButton"&&!Ce.hidden&&!Ce.dropItem?(openBlock(),createBlock(oe,{key:9,item:Ce},null,8,["item"])):["spacer","divider"].includes(Ce.type)?(openBlock(),createElementBlock("div",{key:10,class:normalizeClass(Ce.type)},null,2)):Ce.type==="property"&&!Ce.hidden&&y.value?(openBlock(),createBlock(fe,{key:11,onClick:O,title:_e.$t(Ce.title),"data-element":Ce.dataElement,isActive:d.value,disabled:M.value&&f.value==="annotation"&&s.value!=="freetext"||E.value,id:Ce.id,class:"property sidebar-style"},{default:withCtx(()=>[createVNode(ke)]),_:2},1032,["title","data-element","isActive","disabled","id"])):createCommentVNode("",!0)],64))),128)}}},__unplugin_components_2$2=_export_sfc(_sfc_main$D,[["__scopeId","data-v-0a1a6af5"]]),Toolbar_vue_vue_type_style_index_0_scoped_717dbea3_lang="",_hoisted_1$r={class:"scroll-container left"},_hoisted_2$o={class:"scroll-container right"},_sfc_main$C={__name:"Toolbar",setup(e){const n=getCurrentInstance().appContext.app.config.globalProperties,o=useViewerStore(),r=useDocumentStore(),u=o.getToolItems,s=computed(()=>o.getCompareStatus),w=computed(()=>o.getDisabledHeader),m=computed(()=>o.getToolMode),v=computed(()=>r.getActiveTool),g=computed(()=>o.getCurrentPage),d=computed(()=>o.getDisableSignatureTool),f=ref(!1),y=ref(null),x=ref(!1),k=ref(!1);watch(m,async(N,I)=>{f.value=!(["view","document","separation"].includes(N)||N==="compare"&&s!=="finished"),x.value=!1,k.value=!1,await nextTick(),f.value&&(y.value&&y.value.scrollLeft>0&&(x.value=!0),y.value&&y.value.scrollLeft+y.value.clientWidth<y.value.scrollWidth&&(k.value=!0))}),watch(s,async(N,I)=>{f.value=!(["view","document"].includes(m.value)||m.value==="compare"&&N!=="finished"),x.value=!1,k.value=!1});const P=()=>{y.value.scrollTo({left:y.value.scrollLeft-y.value.clientWidth,behavior:"smooth"})},S=()=>{y.value.scrollTo({left:y.value.scrollLeft+y.value.clientWidth,behavior:"smooth"})},E=N=>{x.value=N.target.scrollLeft>0,k.value=N.target.scrollLeft+N.target.clientWidth<N.target.scrollWidth-1},M=N=>{let I=N.target.files[0];if(!I)return;if(I&&I.size>2*1024*1024){window.$message.error(n.$t("signatures.uploadError"),{duration:5e3,icon:()=>h("img",{src:MessageError})}),N.target.value="";return}if(m.value==="annotation"&&(r.setToolState("image"),core.handleCreateStatus({bool:!0,fileData:I})),v.value!=="image")return;const O=new FileReader;O.onload=function(F){const q=new Image;q.onload=function(){const Y={imageBase64:F.target.result,width:q.width,height:q.height,pageNum:g.value};core.addAnnotationImage(Y)},q.onerror=function(Y){console.log(Y)},q.src=F.target.result},O.onerror=function(F){console.log(F)},O.readAsDataURL(I)},T=()=>{r.setToolState("image")},D=()=>{o.toggleElement("measurePanel")};return core.addEvent("toggleAnnotAttrbutePanel",D),(N,I)=>{const O=__unplugin_components_0$f,F=_sfc_main$4C,q=__unplugin_components_2$2,Y=__unplugin_components_3$1,_e=__unplugin_components_4$2,ne=__unplugin_components_5$1,ve=_sfc_main$U,J=_sfc_main$X,fe=_sfc_main$_,Z=_sfc_main$$,j=__unplugin_components_10$3;return m.value==="sign"&&d.value?createCommentVNode("",!0):withDirectives((openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["toolbar",{security:m.value==="security",editor:m.value==="editor",disabled:w.value}])},[withDirectives(createBaseVNode("div",_hoisted_1$r,[createVNode(F,{class:"flip-button",onClick:P},{default:withCtx(()=>[createVNode(O)]),_:1})],512),[[vShow,unref(isMobileDevice)&&x.value]]),createBaseVNode("div",{class:"tools",ref_key:"toolbarRef",ref:y,onScroll:E},[m.value==="annotation"?(openBlock(),createBlock(q,{key:0,items:unref(u)[m.value]},null,8,["items"])):m.value==="editor"?(openBlock(),createBlock(Y,{key:1,items:unref(u)[m.value]},null,8,["items"])):m.value==="measurement"?(openBlock(),createBlock(_e,{key:2,items:unref(u)[m.value]},null,8,["items"])):m.value==="form"?(openBlock(),createBlock(ne,{key:3,items:unref(u)[m.value]},null,8,["items"])):m.value==="security"?(openBlock(),createBlock(ve,{key:4,items:unref(u)[m.value]},null,8,["items"])):m.value==="redaction"?(openBlock(),createBlock(J,{key:5,items:unref(u)[m.value]},null,8,["items"])):(openBlock(!0),createElementBlock(Fragment,{key:6},renderList(unref(u)[m.value],(X,H)=>(openBlock(),createElementBlock(Fragment,{key:`${X.type}-${X.dataElement||H}`},[X.type==="comparedToolbar"?(openBlock(),createBlock(fe,{key:0})):X.type==="signatureToolBar"?(openBlock(),createBlock(Z,{key:1})):createCommentVNode("",!0)],64))),128))],544),withDirectives(createBaseVNode("div",_hoisted_2$o,[createVNode(F,{class:"flip-button",onClick:S},{default:withCtx(()=>[createVNode(j)]),_:1})],512),[[vShow,unref(isMobileDevice)&&k.value]]),unref(isMobileDevice)?(openBlock(),createElementBlock("input",{key:0,type:"file",id:"annotaionImageInput",accept:".png, .jpg, .jpeg",style:{display:"none"},onChange:M,onClick:T,name:"annotaion"},null,32)):createCommentVNode("",!0)],2)),[[vShow,f.value]])}}},__unplugin_components_1=_export_sfc(_sfc_main$C,[["__scopeId","data-v-717dbea3"]]),DocumentEditorHeader_vue_vue_type_style_index_0_lang="",_hoisted_1$q={class:"header-items document-editor-header"},_hoisted_2$n={class:"left-container"},_hoisted_3$m={class:"right-container"},_sfc_main$B={__name:"DocumentEditorHeader",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=computed(()=>o.getDocEditorOperationList),u=computed(()=>n.getToolMode),s=computed(()=>n.getScrollMode),w=computed(()=>n.getPageMode),m=computed(()=>n.getDocumentEditorSaveStatus),v=computed(()=>n.getDocumentEditorSaveAsStatus),g=computed(()=>n.getDocumentEditorHeaders);watch(u,(x,k)=>{k==="document"&&o.setDocEditorOperationList("reset")});const d=()=>{o.setToolState(""),n.setActiveToolMode("view"),n.setCompareStatus(""),core.saveDocumentEdit("common.actions.cancel")},f=async()=>{o.resetSetting(),o.setToolState(""),n.setActiveToolMode("view"),n.setUpload(!0),n.setUploadLoading(!0);const x=n.getScale,k=await core.saveDocumentEdit(),P=o.getPassword;await core.loadDocument(k,{password:P}),o.setCurrentPdfData(k);const S=core.getPagesCount();o.setTotalPages(S),o.setOutline(core.getOutlines()),n.setCurrentPage(1),core.switchScrollMode(s.value==="Vertical"?0:1),core.switchSpreadMode(w.value);const E=()=>{n.setCurrentScale(x/100),core.scaleChanged(x/100),core.removeEvent("documentloaded",E)};core.addEvent("documentloaded",E),n.setUploadLoading(!1)},y=async()=>{const{blobData:x,filename:k}=await core.saveDocumentEdit("saveAs");FileSaver_min.exports.saveAs(x,k)};return(x,k)=>{const P=_sfc_main$2H;return openBlock(),createElementBlock("div",_hoisted_1$q,[createBaseVNode("div",_hoisted_2$n,[(openBlock(!0),createElementBlock(Fragment,null,renderList(g.value.leftHeaders,(S,E)=>(openBlock(),createElementBlock(Fragment,null,[S.dataElement==="toggleCancelButton"?(openBlock(),createElementBlock("div",{key:0,class:"rect-button white",onClick:d},toDisplayString(x.$t("common.actions.cancel")),1)):S.name==="customButton"&&!S.hidden?(openBlock(),createBlock(P,{key:1,item:S,"data-element":S.dataElement},null,8,["item","data-element"])):createCommentVNode("",!0)],64))),256))]),createBaseVNode("div",_hoisted_3$m,[(openBlock(!0),createElementBlock(Fragment,null,renderList(g.value.rightHeaders,(S,E)=>(openBlock(),createElementBlock(Fragment,null,[S.dataElement==="toggleSaveButton"&&m.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["rect-button blue",{disabled:!r.value.length}]),onClick:f},toDisplayString(x.$t("common.actions.save")),3)):S.dataElement==="toggleSaveAsButton"&&v.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(["rect-button blue",{disabled:!r.value.length}]),onClick:y},toDisplayString(x.$t("documentEditor.saveAs")),3)):S.name==="customButton"&&!S.hidden?(openBlock(),createBlock(P,{key:2,item:S,"data-element":S.dataElement},null,8,["item","data-element"])):createCommentVNode("",!0)],64))),256))])])}}},_sfc_main$A={},_hoisted_1$p={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$m=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.25 1.25H5H15H15.75V2V5.25H18H18.75V6V15V15.75H18H15V17.5V19H13.5H6.5H5V17.5V15.75H2H1.25V15V6V5.25H2H4.25V2V1.25ZM14.25 2.75V5.25H5.75V2.75H14.25ZM15 14.25H17.25V6.75H2.75V14.25H5V12.5V11H6.5H13.5H15V12.5V14.25ZM6.5 12.5H13.5V17.5H6.5V12.5ZM15 10C15.5523 10 16 9.55229 16 9C16 8.44772 15.5523 8 15 8C14.4477 8 14 8.44772 14 9C14 9.55229 14.4477 10 15 10Z",fill:"currentColor"},null,-1),_hoisted_3$l=[_hoisted_2$m];function _sfc_render$j(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$p,_hoisted_3$l)}const __unplugin_components_0$5=_export_sfc(_sfc_main$A,[["render",_sfc_render$j]]),_sfc_main$z={__name:"PrintButton",props:["item"],setup(e){const n=useViewerStore(),o=computed(()=>n.getToolMode),r=computed(()=>n.getCompareMode),u=async()=>{if(o.value==="compare"&&r.value==="content"){n.openElement("printSettingDialog");return}n.setDownloading(!0);try{const s=await core.webViewerNamedAction("Print");n.setDownloading(!1),s||n.setDownloadError("Print")}catch(s){console.log(s)}};return(s,w)=>{const m=__unplugin_components_0$5,v=_sfc_main$4C;return openBlock(),createBlock(v,mergeProps({...e.item},{onClick:u,title:s.$t("toolbar.fileOperations.print")}),{default:withCtx(()=>[createVNode(m)]),_:1},16,["title"])}}},DownloadButton_vue_vue_type_style_index_0_lang="",_sfc_main$y={__name:"DownloadButton",setup(e){const n=useViewerStore(),o=computed(()=>n.getToolMode),r=computed(()=>n.getCompareMode),{download:u}=core,s=async()=>{if(o.value==="compare"&&r.value==="content"){n.openElement("downloadSettingDialog");return}n.setDownloading(!0);try{const w=await u();n.setDownloading(!1),w||n.setDownloadError("Downloaded")}catch(w){console.log(w)}};return(w,m)=>{const v=__unplugin_components_0$j,g=_sfc_main$4C;return openBlock(),createBlock(g,{onClick:s,title:w.$t("toolbar.fileOperations.download")},{default:withCtx(()=>[createVNode(v)]),_:1},8,["title"])}}},CompareButtons_vue_vue_type_style_index_0_lang="",_hoisted_1$o={class:"compare-buttons"},_sfc_main$x={__name:"CompareButtons",setup(e){const{loadDocument:n}=core,o=useViewerStore(),r=useDocumentStore(),u=computed(()=>o.getCompareStatus),s=computed(()=>r.getCompareFile("oldFile")&&r.getCompareFile("newFile")&&u.value!=="finished"),w=computed(()=>r.getCurrentPdfData),m=()=>{o.closeElement("compareSettingDialog"),r.setToolState(""),o.setActiveToolMode("view"),u.value&&v(),o.setCompareStatus("")},v=async()=>{if(w.value){o.setUploadLoading(!0),r.setTotalPages(0);try{const y=w.value;y.options.notUpdatePwd=!0,await n(y.pdf,y.options)}catch(y){if(console.log(y),y==="invalid_file_error"||y==="no_password_given"||y==="incorrect_password"){o.setUpload(!1),r.setLoadingProgress(0),o.resetSetting();const x=document.getElementById("fileInput");x.value="",r.setCurrentPdfData();return}}o.setUploadLoading(!1);const d=core.getPagesCount(),f=core.getScale();r.setTotalPages(d),o.setCurrentPage(1),o.setCurrentScale(f)}},g=()=>{o.openElement("compareSettingDialog"),r.initCompareSetting(),o.setCompareMode("content"),o.setShowCompareTip(!1)};return(d,f)=>(openBlock(),createElementBlock("div",_hoisted_1$o,[createBaseVNode("div",{class:normalizeClass(["rect-button blue",{disabled:!s.value}]),onClick:g},toDisplayString(d.$t("compare.startCompare")),3),createBaseVNode("div",{class:"rect-button white",onClick:m},toDisplayString(d.$t("common.actions.exit")),1)]))}},_sfc_main$w={},_hoisted_1$n={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$l=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.70581 6.36601L10 2.73204L16.2943 6.36601V13.634L10 17.2679L3.70581 13.634V6.36601ZM9.43754 1.32475C9.78562 1.12379 10.2145 1.12379 10.5625 1.32475L17.2318 5.17523C17.5798 5.37619 17.7943 5.74758 17.7943 6.14951V13.8505C17.7943 14.2524 17.5798 14.6238 17.2318 14.8247L10.5625 18.6752C10.2145 18.8762 9.78561 18.8762 9.43754 18.6752L2.76831 14.8247C2.42023 14.6238 2.20581 14.2524 2.20581 13.8505V6.14951C2.20581 5.74758 2.42023 5.37619 2.76831 5.17523L9.43754 1.32475ZM11.875 9.99999C11.875 11.0355 11.0356 11.875 10 11.875C8.96451 11.875 8.12504 11.0355 8.12504 9.99999C8.12504 8.96445 8.96451 8.12499 10 8.12499C11.0356 8.12499 11.875 8.96445 11.875 9.99999ZM13.375 9.99999C13.375 11.8639 11.864 13.375 10 13.375C8.13608 13.375 6.62504 11.8639 6.62504 9.99999C6.62504 8.13603 8.13608 6.62499 10 6.62499C11.864 6.62499 13.375 8.13603 13.375 9.99999Z",fill:"currentColor"},null,-1),_hoisted_3$k=[_hoisted_2$l];function _sfc_render$i(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$n,_hoisted_3$k)}const __unplugin_components_10$1=_export_sfc(_sfc_main$w,[["render",_sfc_render$i]]),_sfc_main$v={},_hoisted_1$m={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$k=createBaseVNode("path",{d:"M18.3327 10C18.3327 10 14.6017 16.25 9.99935 16.25C5.39698 16.25 1.66602 10 1.66602 10C1.66602 10 5.39698 3.75 9.99935 3.75C14.6017 3.75 18.3327 10 18.3327 10Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_3$j=createBaseVNode("circle",{cx:"10",cy:"10",r:"2",stroke:"currentColor","stroke-width":"1.5"},null,-1),_hoisted_4$4=[_hoisted_2$k,_hoisted_3$j];function _sfc_render$h(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$m,_hoisted_4$4)}const __unplugin_components_9$1=_export_sfc(_sfc_main$v,[["render",_sfc_render$h]]),_sfc_main$u={},_hoisted_1$l={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$j=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.1722 3.67907C9.75796 3.67907 9.42218 3.34328 9.42218 2.92907V1.75C9.42218 1.33579 9.75796 1 10.1722 1C10.5864 1 10.9222 1.33579 10.9222 1.75V2.92907C10.9222 3.34328 10.5864 3.67907 10.1722 3.67907ZM10.0862 13.3672C11.9032 13.3672 13.3761 11.8942 13.3761 10.0772C13.3761 8.26024 11.9032 6.78727 10.0862 6.78727C8.26916 6.78727 6.79619 8.26024 6.79619 10.0772C6.79619 11.8942 8.26916 13.3672 10.0862 13.3672ZM10.0862 14.8672C12.7316 14.8672 14.8761 12.7227 14.8761 10.0772C14.8761 7.43181 12.7316 5.28727 10.0862 5.28727C7.44074 5.28727 5.29619 7.43181 5.29619 10.0772C5.29619 12.7227 7.44074 14.8672 10.0862 14.8672ZM14.7612 4.51466C14.468 4.80718 14.468 5.28144 14.7612 5.57395C15.0545 5.86646 15.53 5.86646 15.8233 5.57395L16.6592 4.74023C16.9524 4.44771 16.9524 3.97345 16.6592 3.68094C16.3659 3.38842 15.8904 3.38842 15.5971 3.68094L14.7612 4.51466ZM16.6633 10.1509C16.6633 9.73669 16.9991 9.4009 17.4133 9.4009H18.5954C19.0096 9.4009 19.3454 9.73669 19.3454 10.1509C19.3454 10.5651 19.0096 10.9009 18.5954 10.9009H17.4133C16.9991 10.9009 16.6633 10.5651 16.6633 10.1509ZM15.8233 14.7278C15.53 14.4353 15.0546 14.4353 14.7613 14.7278C14.468 15.0203 14.468 15.4946 14.7613 15.7871L15.5972 16.6208C15.8904 16.9134 16.3659 16.9134 16.6592 16.6208C16.9525 16.3283 16.9525 15.8541 16.6592 15.5615L15.8233 14.7278ZM10.1721 16.6227C10.5863 16.6227 10.9221 16.9585 10.9221 17.3727V18.5517C10.9221 18.966 10.5863 19.3017 10.1721 19.3017C9.75784 19.3017 9.42206 18.966 9.42206 18.5517V17.3727C9.42206 16.9585 9.75784 16.6227 10.1721 16.6227ZM5.58357 15.7871C5.87684 15.4946 5.87684 15.0204 5.58357 14.7279C5.2903 14.4353 4.81481 14.4353 4.52154 14.7279L3.68565 15.5616C3.39238 15.8541 3.39238 16.3284 3.68565 16.6209C3.97893 16.9134 4.45441 16.9134 4.74769 16.6209L5.58357 15.7871ZM3.68212 10.1509C3.68212 10.5651 3.34633 10.9009 2.93212 10.9009H1.75C1.33579 10.9009 1 10.5651 1 10.1509C1 9.7367 1.33579 9.40091 1.75 9.40091H2.93212C3.34633 9.40091 3.68212 9.7367 3.68212 10.1509ZM4.52151 5.57399C4.81478 5.8665 5.29027 5.8665 5.58354 5.57399C5.87681 5.28147 5.87681 4.80721 5.58354 4.5147L4.74765 3.68098C4.45438 3.38846 3.97889 3.38846 3.68562 3.68098C3.39235 3.97349 3.39235 4.44775 3.68562 4.74026L4.52151 5.57399Z",fill:"currentColor"},null,-1),_hoisted_3$i=[_hoisted_2$j];function _sfc_render$g(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$l,_hoisted_3$i)}const __unplugin_components_7$1=_export_sfc(_sfc_main$u,[["render",_sfc_render$g]]),_sfc_main$t={},_hoisted_1$k={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$i=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6 1.25H5.25V2V4H6.75V2.75H14.0533L17.25 6.75603V17.1111V17.25H6.75V16H5.25V18V18.75H6H18H18.75V18V17.1111V6.49346V6.23089L18.5862 6.02566L15.0005 1.5322L14.7753 1.25H14.4143H6ZM2 4.95819H1.25V5.70819V15V16.1967L2.32698 15.675L4.83876 14.4582H11.7778H12.5278V13.7082V5.70819V4.95819H11.7778H2ZM2.75 13.8033V6.45819H11.0278V12.9582H4.66667H4.49457L4.33969 13.0332L2.75 13.8033ZM9.11107 11.8166H4.66663V10.3166H9.11107V11.8166ZM4.66663 8.97222H9.11107V7.47222H4.66663V8.97222Z",fill:"currentColor"},null,-1),_hoisted_3$h=[_hoisted_2$i];function _sfc_render$f(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$k,_hoisted_3$h)}const __unplugin_components_0$4=_export_sfc(_sfc_main$t,[["render",_sfc_render$f]]),FlattenButton_vue_vue_type_style_index_0_lang="",_sfc_main$s={__name:"FlattenButton",props:["item"],setup(e){const n=useViewerStore(),{flattenPdfDownload:o}=core,r=async()=>{n.setDownloading(!0);try{const u=await o();n.setDownloading(!1),u||n.setDownloadError("Downloaded")}catch(u){console.log(u)}};return(u,s)=>{const w=__unplugin_components_0$4,m=_sfc_main$4C;return openBlock(),createBlock(m,mergeProps({...e.item},{onClick:r}),{default:withCtx(()=>[createVNode(w)]),_:1},16)}}},_sfc_main$r={},_hoisted_1$j={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$h=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 3V17H11.5625V18.5H3.5H2V17V3V1.5H3.5H11.5625L16.875 5.75V10H15.375V6.47094L11.0363 3H3.5ZM6.25001 6.0625H5.50001V7.5625H6.25001H8.37501H9.12501V6.0625H8.37501H6.25001ZM5.50001 9.25H6.25001H9.96876H10.7188V10.75H9.96876H6.25001H5.50001V9.25ZM6.25001 12.4375H5.50001V13.9375H6.25001H9.96876H10.7188V12.4375H9.96876H6.25001ZM12.5842 14.8916L13.62 13.8558V17.604V18.354H15.12V17.604V13.8558L16.1558 14.8916L17.2165 13.831L14.9003 11.5148L14.37 10.9845L13.8397 11.5148L11.5235 13.831L12.5842 14.8916Z",fill:"currentColor"},null,-1),_hoisted_3$g=[_hoisted_2$h];function _sfc_render$e(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$j,_hoisted_3$g)}const __unplugin_components_0$3=_export_sfc(_sfc_main$r,[["render",_sfc_render$e]]),_sfc_main$q={__name:"OpenFileButton",props:["item"],setup(e){return(n,o)=>{const r=__unplugin_components_0$3,u=_sfc_main$4C;return openBlock(),createBlock(u,mergeProps({...e.item},{title:n.$t("common.actions.upload")}),{default:withCtx(()=>[createVNode(r)]),_:1},16,["title"])}}},_sfc_main$p={},_hoisted_1$i={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$g=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.62109 10C2.62109 5.92468 5.9248 2.62097 10.0001 2.62097C14.0755 2.62097 17.3792 5.92468 17.3792 10C17.3792 14.0753 14.0755 17.379 10.0001 17.379C5.9248 17.379 2.62109 14.0753 2.62109 10ZM10.0001 1.12097C5.09637 1.12097 1.12109 5.09625 1.12109 10C1.12109 14.9038 5.09637 18.879 10.0001 18.879C14.9039 18.879 18.8792 14.9038 18.8792 10C18.8792 5.09625 14.9039 1.12097 10.0001 1.12097ZM6.02432 11.5C6.71468 11.5 7.27432 10.9404 7.27432 10.25C7.27432 9.55967 6.71468 9.00003 6.02432 9.00003C5.33396 9.00003 4.77432 9.55967 4.77432 10.25C4.77432 10.9404 5.33396 11.5 6.02432 11.5ZM10.0888 11.5C10.7792 11.5 11.3388 10.9404 11.3388 10.25C11.3388 9.55967 10.7792 9.00003 10.0888 9.00003C9.39848 9.00003 8.83884 9.55967 8.83884 10.25C8.83884 10.9404 9.39848 11.5 10.0888 11.5ZM15.4034 10.25C15.4034 10.9404 14.8437 11.5 14.1534 11.5C13.463 11.5 12.9034 10.9404 12.9034 10.25C12.9034 9.55967 13.463 9.00003 14.1534 9.00003C14.8437 9.00003 15.4034 9.55967 15.4034 10.25Z",fill:"currentColor"},null,-1),_hoisted_3$f=[_hoisted_2$g];function _sfc_render$d(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$i,_hoisted_3$f)}const __unplugin_components_0$2=_export_sfc(_sfc_main$p,[["render",_sfc_render$d]]),Dropdown_vue_vue_type_style_index_0_scoped_1a6fc4b4_lang="",Dropdown_vue_vue_type_style_index_1_lang="",_hoisted_1$h={class:"drop-down"},_hoisted_2$f=["data-element"],_hoisted_3$e=["data-element"],_hoisted_4$3=["data-element"],_hoisted_5$2=["data-element"],_hoisted_6$2=["data-element"],_hoisted_7$2=["data-element"],_hoisted_8$1=["data-element"],_hoisted_9$1=["data-element"],_hoisted_10$1=["data-element"],_sfc_main$o={__name:"Dropdown",props:["rightItems"],setup(e){const n=e,o=useViewerStore(),r=ref(null),{download:u,webViewerNamedAction:s,flattenPdfDownload:w}=core,m=computed(()=>o.getPopoverChanged),v=computed(()=>r.value&&r.value.getMergedShow()),g=computed(()=>o.getUpload),d=computed(()=>o.getThemeMode),f=computed(()=>{const T=["downloadButton","flattenButton","printButton","settingButton"];return isMobileDevice&&T.push("themeMode","pageModeButton"),n.rightItems.filter(D=>T.includes(D.type)||D.name==="customButton"&&D.dropItem).every(D=>D.hidden)});watch(()=>m.value,(T,D)=>{T&&(r.value.setShow(!1),o.setPopoverChanged(!1))});const y=()=>{window.instance.changeFile(),r.value.setShow(!1)},x=async()=>{if(!core.getPermission("allowsCopying")){o.openElement("permissionPasswordDialog");return}r.value.setShow(!1),o.setDownloading(!0);try{const D=await u();o.setDownloading(!1),D||o.setDownloadError("Downloaded")}catch(D){console.log(D)}},k=async()=>{r.value.setShow(!1),o.setDownloading(!0);try{const T=await w();o.setDownloading(!1),T||o.setDownloadError("Downloaded")}catch(T){console.log(T)}},P=async()=>{if(!core.getPermission("allowsPrinting")){o.openElement("permissionPasswordDialog");return}r.value.setShow(!1),o.setDownloading(!0);try{const D=await s("Print");o.setDownloading(!1),D||o.setDownloadError("Print")}catch(D){console.log(D)}},S=()=>{r.value.setShow(!1),o.setPopoverChanged(!1),o.openElement("settingsDialog")},E=T=>{r.value.setShow(!1),T!==d.value&&o.setThemeMode(T)};watch(()=>d.value,T=>{THEME_CONFIG.mode=T,T==="light"?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark")});const M=()=>{r.value.setShow(!1),o.isElementOpen("pageModePanel")?o.closeElement("pageModePanel"):(o.openElement("pageModePanel"),o.closeElement("contentEditorPanel"))};return(T,D)=>{const N=__unplugin_components_0$2,I=__unplugin_components_11$1,O=_sfc_main$4C,F=_sfc_main$q,q=_sfc_main$y,Y=_sfc_main$s,_e=_sfc_main$z,ne=__unplugin_components_7$1,ve=__unplugin_components_8$5,J=__unplugin_components_9$1,fe=__unplugin_components_10$1,Z=_sfc_main$2H;return openBlock(),createBlock(unref(NPopover),{ref_key:"popover",ref:r,placement:"top-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,"z-index":6},{trigger:withCtx(()=>[withDirectives(createVNode(O,{class:normalizeClass(["more",{active:v.value,disabled:!g.value}])},{default:withCtx(()=>[createVNode(N),createVNode(I)]),_:1},8,["class"]),[[vShow,!f.value]])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$h,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rightItems,(j,X)=>(openBlock(),createElementBlock(Fragment,{key:`${j.type}-${j.dataElement||X}`},[j.type==="openFileButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:0,"data-element":j.dataElement,class:"drop-item",onClick:y},[createVNode(F),createTextVNode(toDisplayString(T.$t("toolbar.fileOperations.openFile")),1)],8,_hoisted_2$f)):createCommentVNode("",!0),j.type==="downloadButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:1,"data-element":j.dataElement,class:"drop-item",onClick:x},[createVNode(q),createTextVNode(toDisplayString(T.$t("toolbar.fileOperations.download")),1)],8,_hoisted_3$e)):createCommentVNode("",!0),j.type==="flattenButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:2,"data-element":j.dataElement,class:"drop-item",onClick:k},[createVNode(Y),createTextVNode(toDisplayString(T.$t("toolbar.fileOperations.flatten")),1)],8,_hoisted_4$3)):createCommentVNode("",!0),j.type==="printButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:3,"data-element":j.dataElement,class:"drop-item",onClick:P},[createVNode(_e),createTextVNode(toDisplayString(T.$t("toolbar.fileOperations.print")),1)],8,_hoisted_5$2)):createCommentVNode("",!0),j.type==="themeMode"&&!j.hidden?(openBlock(),createElementBlock("div",{key:4,"data-element":j.dataElement,class:"drop-item",onClick:D[0]||(D[0]=H=>E("light"))},[createVNode(O,null,{default:withCtx(()=>[createVNode(ne)]),_:1}),createTextVNode(toDisplayString(T.$t("toolbar.themeSwitcher.lightMode")),1)],8,_hoisted_6$2)):createCommentVNode("",!0),j.type==="themeMode"&&!j.hidden?(openBlock(),createElementBlock("div",{key:5,"data-element":j.dataElement,class:"drop-item",onClick:D[1]||(D[1]=H=>E("dark"))},[createVNode(O,null,{default:withCtx(()=>[createVNode(ve)]),_:1}),createTextVNode(toDisplayString(T.$t("toolbar.themeSwitcher.darkMode")),1)],8,_hoisted_7$2)):createCommentVNode("",!0)],64))),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rightItems,(j,X)=>(openBlock(),createElementBlock(Fragment,{key:`${j.type}-${j.dataElement||X}`},[j.type==="pageModeButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:0,"data-element":j.dataElement,class:"drop-item",onClick:M},[createVNode(O,null,{default:withCtx(()=>[createVNode(J)]),_:1}),createTextVNode(toDisplayString(T.$t("toolbar.viewControls.viewSetting")),1)],8,_hoisted_8$1)):createCommentVNode("",!0)],64))),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rightItems,(j,X)=>(openBlock(),createElementBlock(Fragment,{key:`${j.type}-${j.dataElement||X}`},[j.type==="settingButton"&&!j.hidden?(openBlock(),createElementBlock("div",{key:0,"data-element":j.dataElement,class:"drop-item",onClick:S},[createVNode(O,null,{default:withCtx(()=>[createVNode(fe)]),_:1}),createTextVNode(toDisplayString(T.$t("toolbar.settings.title")),1)],8,_hoisted_9$1)):createCommentVNode("",!0),j.name==="customButton"&&j.dropItem&&!j.hidden?(openBlock(),createElementBlock("div",{key:1,"data-element":j.dataElement,class:"drop-item"},[createVNode(Z,{item:j},null,8,["item"])],8,_hoisted_10$1)):createCommentVNode("",!0)],64))),128))])]),_:1},512)}}},__unplugin_components_14=_export_sfc(_sfc_main$o,[["__scopeId","data-v-1a6fc4b4"]]),_sfc_main$n={},_hoisted_1$g={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$e=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.10986 13.9354C2.71178 11.5373 2.71178 7.64923 5.10986 5.25114C7.50795 2.85306 11.396 2.85306 13.7941 5.25114C16.1922 7.64923 16.1922 11.5373 13.7941 13.9354C11.396 16.3335 7.50795 16.3335 5.10986 13.9354ZM4.0492 4.19048C1.06533 7.17436 1.06533 12.0122 4.0492 14.996C6.85416 17.801 11.2974 17.9692 14.2988 15.5006L17.1989 18.4006C17.4918 18.6935 17.9666 18.6935 18.2595 18.4006C18.5524 18.1078 18.5524 17.6329 18.2595 17.34L15.3595 14.4399C17.8279 11.4385 17.6597 6.99539 14.8548 4.19048C11.8709 1.20661 7.03307 1.20661 4.0492 4.19048Z",fill:"currentColor"},null,-1),_hoisted_3$d=[_hoisted_2$e];function _sfc_render$c(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$g,_hoisted_3$d)}const __unplugin_components_0$1=_export_sfc(_sfc_main$n,[["render",_sfc_render$c]]),index_vue_vue_type_style_index_0_lang$1="",_hoisted_1$f={class:"search-container"},_sfc_main$m={__name:"index",props:["item"],setup(e){const n=useViewerStore(),o=computed(()=>n.getSearchStatus),r=computed(()=>n.getUpload),u=computed(()=>n.isElementOpen("leftPanel")),s=computed(()=>n.getActiveElementTab("leftPanel")),w=()=>{core.webViewerNamedAction("Find"),u.value&&s.value!=="SEARCH"?n.setSearchStatus(!0):u.value?(n.setSearchStatus(!1),n.toggleElement("leftPanel")):(n.setSearchStatus(!0),n.toggleElement("leftPanel")),n.setActiveElementTab("leftPanel","SEARCH")};return(m,v)=>{const g=__unplugin_components_0$1,d=_sfc_main$4C;return openBlock(),createElementBlock("div",_hoisted_1$f,[createVNode(d,mergeProps({id:"viewFind"},{...e.item},{isActive:o.value&&u.value,onClick:w,class:{disabled:!r.value},title:m.$t("toolbar.viewControls.search")}),{default:withCtx(()=>[createVNode(g)]),_:1},16,["isActive","class","title"])])}}},_sfc_main$l={},_hoisted_1$e={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$d=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.7463 7.94055L8.43134 3.20358C8.38986 2.6073 8.82031 2.08322 9.40947 2.01273L9.46546 2.00656C9.75502 1.97416 10.0451 2.06271 10.2681 2.25159C10.4911 2.44047 10.6276 2.71317 10.6457 3.00614L10.9886 8.17061C10.999 8.31659 11.1097 8.43516 11.2537 8.45444C11.3176 8.46288 11.382 8.44409 11.4315 8.40258C11.481 8.36108 11.5111 8.30063 11.5145 8.23584L11.7612 3.47595C11.7918 2.85998 12.3116 2.38523 12.923 2.41468H12.9309C13.5429 2.44972 14.0111 2.97745 13.9773 3.59407L13.7218 8.51438C13.7137 8.66679 13.8235 8.79975 13.9738 8.81936C14.1225 8.83876 14.2625 8.73915 14.2914 8.59018L14.8006 6.02337C14.9178 5.41517 15.497 5.01851 16.0954 5.13574L16.1041 5.13751C16.7058 5.25854 17.0969 5.84695 16.979 6.45353L16.3684 9.53687C15.8189 13.3474 15.0586 15.5052 14.3946 16.4246C13.3649 17.8508 11.5573 17.8667 10.1251 17.8667C8.69381 17.8667 7.16012 17.5291 6.44796 16.9993C5.73492 16.4696 4.77079 15.2575 4.15837 13.9327L4.16712 13.9283C4.11876 13.8639 4.0774 13.7945 4.04376 13.7212L3.105 11.685C2.84552 11.1243 3.08338 10.4577 3.63781 10.1918L3.64656 10.1874C3.91235 10.0626 4.21656 10.0497 4.49179 10.1517C4.76702 10.2536 4.99055 10.4619 5.11287 10.7304C5.62206 11.8234 5.94227 12.324 6.07526 12.2324C6.27386 12.0949 6.12075 11.7176 5.85478 9.21249C5.67578 7.53039 5.45319 5.85328 5.18724 4.18289C5.07653 3.5968 5.44002 3.02581 6.01489 2.88273L6.07526 2.86775C6.35866 2.79957 6.65742 2.85178 6.90147 3.01215C7.14552 3.17252 7.3134 3.42693 7.36572 3.71571L8.168 8.02341C8.19642 8.17613 8.33897 8.27937 8.49171 8.25787C8.64561 8.23564 8.75656 8.09774 8.7463 7.94143V7.94055Z",fill:"currentColor"},null,-1),_hoisted_3$c=[_hoisted_2$d];function _sfc_render$b(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$e,_hoisted_3$c)}const __unplugin_components_10=_export_sfc(_sfc_main$l,[["render",_sfc_render$b]]),_sfc_main$k={},_hoisted_1$d={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$c=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.33187 3.41643C4.74608 3.41643 5.08187 3.08064 5.08187 2.66643C5.08187 2.25221 4.74608 1.91643 4.33187 1.91643L1.66643 1.91643C1.25221 1.91643 0.916428 2.25221 0.916428 2.66643C0.916428 3.08064 1.25221 3.41643 1.66643 3.41643L2.35645 3.41643V3.8183L2.35645 15.3384V15.7404H1.66643C1.25221 15.7404 0.916428 16.0762 0.916428 16.4904C0.916428 16.9047 1.25221 17.2404 1.66643 17.2404H4.33187C4.74608 17.2404 5.08187 16.9047 5.08187 16.4904C5.08187 16.0762 4.74608 15.7404 4.33187 15.7404H3.85645V15.3384L3.85645 3.8183V3.41643H4.33187ZM7.30219 4.09613C7.10328 4.09613 6.91251 4.17515 6.77186 4.3158C6.63121 4.45645 6.55219 4.64722 6.55219 4.84613V12.8425C6.55219 13.1458 6.73492 13.4193 7.01518 13.5354C7.29543 13.6514 7.61802 13.5873 7.83252 13.3728L9.88684 11.3185L14.7821 16.2137C15.075 16.5066 15.5498 16.5066 15.8427 16.2137L18.6699 13.3866C18.8105 13.2459 18.8895 13.0551 18.8895 12.8562C18.8895 12.6573 18.8105 12.4665 18.6699 12.3259L13.7746 7.43067L15.8288 5.37646C16.0433 5.16196 16.1075 4.83937 15.9914 4.55912C15.8753 4.27886 15.6019 4.09613 15.2985 4.09613L7.30219 4.09613ZM9.35651 9.72747L8.05219 11.0318V5.59613L13.4879 5.59613L12.1836 6.90034C12.043 7.041 11.964 7.23176 11.964 7.43067C11.964 7.62959 12.043 7.82035 12.1836 7.961L17.0789 12.8562L15.3124 14.6227L10.4172 9.72747C10.1243 9.43458 9.64941 9.43458 9.35651 9.72747Z",fill:"currentColor"},null,-1),_hoisted_3$b=[_hoisted_2$c];function _sfc_render$a(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$d,_hoisted_3$b)}const __unplugin_components_9=_export_sfc(_sfc_main$k,[["render",_sfc_render$a]]),_sfc_main$j={},_hoisted_1$c={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$b=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.1142 2.47079H2V6.57766H6.1142V2.47079ZM18.0002 2.47076H13.886V6.57763H18.0002V2.47076ZM6.11436 13.4224H2.00016V17.5293H6.11436V13.4224ZM18.0002 13.4224H13.886V17.5293H18.0002V13.4224ZM9.08594 5.20866V3.8397H7.25741V5.20866H9.08594ZM12.743 5.20866V3.8397H10.9145V5.20866H12.743ZM4.74251 9.08729H3.3711V7.26201H4.74251V9.08729ZM4.74251 12.7379H3.3711V10.9126H4.74251V12.7379ZM15.2571 9.08734H16.6285V7.26206H15.2571V9.08734ZM15.2571 12.7379H16.6285V10.9126H15.2571V12.7379ZM9.08594 14.7913V16.1603H7.25741V14.7913H9.08594ZM12.743 14.7913V16.1603H10.9145V14.7913H12.743Z",fill:"currentColor"},null,-1),_hoisted_3$a=[_hoisted_2$b];function _sfc_render$9(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$c,_hoisted_3$a)}const __unplugin_components_8$1=_export_sfc(_sfc_main$j,[["render",_sfc_render$9]]),_sfc_main$i={__name:"ViewRotationControls",setup(e){const n=()=>{core.rotateCounterclockwise()},o=()=>{core.rotateClockwise()};return(r,u)=>{const s=_sfc_main$4C;return openBlock(),createElementBlock(Fragment,null,[createVNode(s,{img:"icon-header-counter-clockwise",title:"Rotate Counterclockwise",onClick:n}),createVNode(s,{img:"icon-header-clockwise",title:"Rotate Clockwise",onClick:o})],64)}}},_sfc_main$h={__name:"CropPageButton",props:["item","popoverTool"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useViewerStore(),u=useDocumentStore(),{item:s,popoverTool:w}=e,m=computed(()=>u.getActiveTool),v=()=>{w&&w[0].setShow(!1),u.setToolState(m.value==="cropPage"?"":"cropPage"),m.value==="cropPage"&&(r.resetPanels(),r.setActiveToolMode("view")),n(0),o(0),r.closeActiveStickNote(),r.setSearchStatus(!1),r.toggleActiveHand(!1)};return(g,d)=>{const f=__unplugin_components_8$1,y=_sfc_main$4C;return openBlock(),createBlock(y,mergeProps({isActive:m.value==="cropPage"&&!unref(isMobileDevice)},{...e.item},{onClick:v,title:g.$t("toolbar.viewControls.cropPage")}),{default:withCtx(()=>[createVNode(f)]),_:1},16,["isActive","title"])}}},_sfc_main$g={__name:"HandButton",props:["item","popoverTool"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,r=useViewerStore(),u=useDocumentStore(),{item:s,popoverTool:w}=e,m=computed(()=>r.getActiveHand),v=()=>{w&&w[0].setShow(!1),window.getSelection().empty(),r.toggleActiveHand(!m.value);const g=m.value?1:0;n(g),o(0),r.closeActiveStickNote(),core.webViewerNamedAction("Find",4),u.setToolState(""),r.setSearchStatus(!1)};return(g,d)=>{const f=__unplugin_components_10,y=_sfc_main$4C;return openBlock(),createBlock(y,mergeProps({isActive:m.value&&!unref(isMobileDevice),img:"icon-hand-tool"},{...e.item},{onClick:v,title:g.$t("toolbar.viewControls.pan")}),{default:withCtx(()=>[createVNode(f)]),_:1},16,["isActive","title"])}}},_sfc_main$f={},_hoisted_1$b={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$a=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 3.5H16.5V16.5H3.5V3.5ZM2 2H3.5H16.5H18V3.5V16.5V18H16.5H3.5H2V16.5V3.5V2ZM14.2461 14.9961H11.6868V13.4961H13.4961V11.6893H14.9961V14.2461V14.9961H14.2461ZM13.4961 6.5H11.6868V5H14.2461H14.9961V5.75V8.3078H13.4961V6.5ZM6.5 6.5H8.30664V5H5.75H5V5.75V8.3078H6.5V6.5ZM5.75 14.9961H8.30664V13.4961H6.5V11.6893H5V14.2461V14.9961H5.75Z",fill:"currentColor"},null,-1),_hoisted_3$9=[_hoisted_2$a];function _sfc_render$8(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$b,_hoisted_3$9)}const __unplugin_components_0=_export_sfc(_sfc_main$f,[["render",_sfc_render$8]]),FullScreenButton_vue_vue_type_style_index_0_lang="",_sfc_main$e={__name:"FullScreenButton",props:["item"],setup(e){const{requestFullScreenMode:n}=core,o=useViewerStore(),r=useDocumentStore(),u=computed(()=>o.isElementOpen("leftPanel"));core.addEvent("presentationmodechanged",({state:w})=>{w===1?o.setFullMode(!1):w===3&&o.setFullMode(!0)});const s=()=>{const w=navigator.userAgent.match(/(iPad)/)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;u.value&&(window.innerWidth<930||w)&&o.toggleElement("leftPanel");const m=document.getElementById("sign-image-save");m&&m.remove(),n(),r.setToolState("")};return(w,m)=>{const v=__unplugin_components_0,g=_sfc_main$4C;return openBlock(),createBlock(g,mergeProps({img:"icon-full-screen",className:"full-screen"},{...e.item},{onClick:s,title:w.$t("toolbar.viewControls.fullScreen")}),{default:withCtx(()=>[createVNode(v)]),_:1},16,["title"])}}},_sfc_main$d={};function _sfc_render$7(e,n){return openBlock(),createElementBlock("div")}const __unplugin_components_2$1=_export_sfc(_sfc_main$d,[["render",_sfc_render$7]]),_sfc_main$c={},_hoisted_1$a={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$9=createBaseVNode("rect",{x:"2",y:"8",width:"6",height:"9",fill:"#999999"},null,-1),_hoisted_3$8=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.5 3.5H2.5V7.25H8H17.5V3.5ZM7.25 8.75H2.5V16.5H7.25V8.75ZM8.75 16.5V8.75H17.5V16.5H8.75ZM2.5 2H1V3.5V16.5V18H2.5H17.5H19V16.5V3.5V2H17.5H2.5Z",fill:"currentColor"},null,-1),_hoisted_4$2=[_hoisted_2$9,_hoisted_3$8];function _sfc_render$6(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$a,_hoisted_4$2)}const __unplugin_components_8=_export_sfc(_sfc_main$c,[["render",_sfc_render$6]]),_sfc_main$b={},_hoisted_1$9={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$8=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.11004 13.9353C2.71196 11.5372 2.71196 7.64917 5.11004 5.25108C7.50813 2.853 11.3962 2.853 13.7943 5.25108C16.1924 7.64917 16.1924 11.5372 13.7943 13.9353C11.3962 16.3334 7.50813 16.3334 5.11004 13.9353ZM4.04938 4.19042C1.06551 7.17429 1.06551 12.0121 4.04938 14.996C6.85434 17.8009 11.2976 17.9691 14.299 15.5005L17.1991 18.4006C17.4919 18.6935 17.9668 18.6935 18.2597 18.4006C18.5526 18.1077 18.5526 17.6328 18.2597 17.3399L15.3596 14.4399C17.8281 11.4384 17.6598 6.99532 14.8549 4.19042C11.8711 1.20655 7.03325 1.20655 4.04938 4.19042Z",fill:"currentColor"},null,-1),_hoisted_3$7=[_hoisted_2$8];function _sfc_render$5(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$9,_hoisted_3$7)}const __unplugin_components_7=_export_sfc(_sfc_main$b,[["render",_sfc_render$5]]),_sfc_main$a={},_hoisted_1$8={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$7=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.0663 1.73124C11.8457 1.51066 11.4792 1.54371 11.3017 1.80019L8.50221 5.84387C8.47541 5.88258 8.43581 5.9106 8.39039 5.92299L4.70212 6.92888C4.62329 6.95038 4.56548 7.01679 4.55485 7.0978C4.49741 7.53536 4.28835 8.98634 3.86452 10.5C3.50509 11.7837 2.41361 14.2634 1.80715 15.6014C1.43791 15.4319 0.986657 15.4992 0.682542 15.8033C0.292017 16.1938 0.292017 16.827 0.682542 17.2175C1.07307 17.6081 1.70623 17.6081 2.09676 17.2175C2.40731 16.907 2.4709 16.443 2.28754 16.0696C3.47428 15.503 5.62248 14.5333 7.40006 14.0355C9.40855 13.4732 10.4209 13.3576 10.7798 13.3342C10.8716 13.3282 10.9526 13.266 10.9768 13.1773L11.9771 9.50966C11.9895 9.46424 12.0175 9.42465 12.0562 9.39785L16.0999 6.59838C16.3563 6.42081 16.3894 6.05431 16.1688 5.83373L12.0663 1.73124ZM7.84432 8.82278C7.79831 8.77678 7.72133 8.78626 7.68786 8.84204L5.83823 11.9248C5.78467 12.014 5.88616 12.1155 5.97543 12.062L9.05814 10.2123C9.11392 10.1789 9.1234 10.1019 9.0774 10.0559L7.84432 8.82278ZM15.5271 16.5933C15.4522 16.5981 15.3767 16.6005 15.3006 16.6005C15.2254 16.6005 15.1508 16.5982 15.0768 16.5935L13.531 19.2708C13.4525 19.4067 13.2553 19.4035 13.1814 19.2651L12.5771 18.1343C12.5412 18.0671 12.4703 18.0261 12.3942 18.0286L11.1127 18.0707C10.9559 18.0759 10.8545 17.9067 10.9329 17.7708L12.4536 15.1369C12.0425 14.5632 11.8006 13.8601 11.8006 13.1005C11.8006 11.1675 13.3676 9.60052 15.3006 9.60052C17.2336 9.60052 18.8006 11.1675 18.8006 13.1005C18.8006 13.8592 18.5592 14.5614 18.1491 15.1347L19.671 17.7708C19.7495 17.9067 19.6481 18.0759 19.4912 18.0707L18.2098 18.0286C18.1336 18.0261 18.0627 18.0671 18.0268 18.1343L17.4225 19.2651C17.3486 19.4035 17.1514 19.4067 17.0729 19.2708L15.5271 16.5933Z",fill:"currentColor"},null,-1),_hoisted_3$6=[_hoisted_2$7];function _sfc_render$4(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$8,_hoisted_3$6)}const __unplugin_components_6=_export_sfc(_sfc_main$a,[["render",_sfc_render$4]]),_sfc_main$9={},_hoisted_1$7={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$6=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 3.5H13.3V13.3H3.5V3.5ZM2 2H3.5H13.3H14.8V3.5V5.2H16.5H18V6.7V16.5V18H16.5H6.7H5.2V16.5V14.8H3.5H2V13.3V3.5V2ZM6.7 14.8V16.5H16.5V6.7H14.8V13.3V14.8H13.3H6.7Z",fill:"currentColor"},null,-1),_hoisted_3$5=[_hoisted_2$6];function _sfc_render$3(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$7,_hoisted_3$5)}const __unplugin_components_5=_export_sfc(_sfc_main$9,[["render",_sfc_render$3]]),_sfc_main$8={},_hoisted_1$6={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$5=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 1.25H2L0 18.75H18L20 1.25ZM10.4361 3.51788L15.0866 15.1442H16.5866V16.3942H12.7404V15.1442H13.7403L12.798 12.7885H6.91309L5.9711 15.1442H6.97115V16.3942H3.125V15.1442H4.62492L9.27547 3.51788H10.4361ZM9.85499 5.43124L12.298 11.5385H7.41292L9.85499 5.43124Z",fill:"currentColor"},null,-1),_hoisted_3$4=[_hoisted_2$5];function _sfc_render$2(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$6,_hoisted_3$4)}const __unplugin_components_4=_export_sfc(_sfc_main$8,[["render",_sfc_render$2]]),_sfc_main$7={},_hoisted_1$5={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$4=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5 1.875H1.25V5.625H5V1.875ZM5 8.125H1.25V11.875H5V8.125ZM1.25 14.375H5V18.125H1.25V14.375ZM18.75 4.6875V2.8125H7.5V4.6875H18.75ZM18.75 9.0625V10.9375H7.5V9.0625H18.75ZM18.75 17.1875V15.3125H7.5V17.1875H18.75Z",fill:"currentColor"},null,-1),_hoisted_3$3=[_hoisted_2$4];function _sfc_render$1(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$5,_hoisted_3$3)}const __unplugin_components_3=_export_sfc(_sfc_main$7,[["render",_sfc_render$1]]),_sfc_main$6={},_hoisted_1$4={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3=createBaseVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.4375 1.4375H2.6875V2.1875V17.8125V18.5625H3.4375H16.5612H17.3112V17.8125V10V7.07031V6.77538L17.1103 6.55944L12.5675 1.67663L12.345 1.4375H12.0184H9.99936H3.4375ZM4.1875 17.0625V2.9375H9.99936H10.5V7.5V8.25H11.25H15.8112V10V17.0625H4.1875ZM15.2388 6.75L12 3.2688V6.75H15.2388Z",fill:"currentColor"},null,-1),_hoisted_3$2=[_hoisted_2$3];function _sfc_render(e,n){return openBlock(),createElementBlock("svg",_hoisted_1$4,_hoisted_3$2)}const __unplugin_components_2=_export_sfc(_sfc_main$6,[["render",_sfc_render]]),_sfc_main$5={__name:"LeftPanelTabs",props:["activePanelTab","popover"],setup(e){const n=useViewerStore(),{popover:o}=e,r=computed(()=>n.isElementOpen("leftPanel")),u=computed(()=>n.getActiveElementTab("leftPanel")),s=computed(()=>n.getDisabledElements("thumbnails")),w=computed(()=>n.getDisabledElements("outlines")),m=computed(()=>n.getDisabledElements("annotation")),v=computed(()=>n.getDisabledElements("layers")),g=computed(()=>n.getDisabledElements("signature")),d=computed(()=>n.getDisabledElements("search")),f=y=>{o&&o.setShow(!1),r.value||n.openElement("leftPanel"),y!==u.value&&(n.setActiveElementTab("leftPanel",y),y==="SEARCH"?(core.webViewerNamedAction("FindOpen"),n.setSearchStatus(!0)):(core.clearSearchResults(),n.setSearchStatus(!1)))};return(y,x)=>{const k=__unplugin_components_2,P=__unplugin_components_3,S=__unplugin_components_4,E=__unplugin_components_5,M=__unplugin_components_6,T=__unplugin_components_7;return openBlock(),createElementBlock(Fragment,null,[s.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["drop-item",{active:u.value==="THUMBS"}]),"data-element":"THUMBS",onClick:x[0]||(x[0]=D=>f("THUMBS"))},[createVNode(k),createTextVNode(toDisplayString(y.$t("panels.left.thumbnails")),1)],2)),w.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(["drop-item",{active:u.value==="OUTLINE"}]),"data-element":"OUTLINE",onClick:x[1]||(x[1]=D=>f("OUTLINE"))},[createVNode(P),createTextVNode(toDisplayString(y.$t("panels.left.outlines.title")),1)],2)),m.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(["drop-item",{active:u.value==="ANNOTATION"}]),"data-element":"ANNOTATION",onClick:x[2]||(x[2]=D=>f("ANNOTATION"))},[createVNode(S),createTextVNode(toDisplayString(y.$t("panels.left.annotations.title")),1)],2)),v.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:3,class:normalizeClass(["drop-item",{active:u.value==="LAYER"}]),"data-element":"LAYER",onClick:x[3]||(x[3]=D=>f("LAYER"))},[createVNode(E),createTextVNode(toDisplayString(y.$t("panels.left.layers.title")),1)],2)),r.value&&u.value==="COMPARISON"?(openBlock(),createElementBlock("div",{key:4,class:normalizeClass(["drop-item",{active:u.value==="COMPARISON"}]),"data-element":"COMPARISON",onClick:x[4]||(x[4]=D=>f("COMPARISON"))},[createVNode(k),createTextVNode("Compare")],2)):createCommentVNode("",!0),g.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:5,"data-element":"SIGNATURE",class:normalizeClass(["drop-item",{active:u.value==="SIGNATURE"}]),onClick:x[5]||(x[5]=D=>f("SIGNATURE"))},[createVNode(M),createTextVNode(toDisplayString(y.$t("panels.left.signatures.title")),1)],2)),d.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:6,"data-element":"SEARCH",class:normalizeClass(["drop-item",{active:u.value==="SEARCH"}]),onClick:x[6]||(x[6]=D=>f("SEARCH"))},[createVNode(T),createTextVNode(toDisplayString(y.$t("panels.left.search.title")),1)],2))],64)}}},ToggleElementButton_vue_vue_type_style_index_0_lang="",_hoisted_1$3=["title"],_hoisted_2$2={class:"drop-down medium left-panel-button-popover"},_sfc_main$4={__name:"ToggleElementButton",props:["item"],setup(e){const n=useViewerStore(),{item:o}=e,r=computed(()=>n.isElementOpen(o.element)),u=computed(()=>n.getActiveElementTab("leftPanel")),s=computed(()=>n.getPopoverChanged),w=computed(()=>n.getDisabledElements("thumbnails")),m=computed(()=>n.getDisabledElements("outlines")),v=computed(()=>n.getDisabledElements("annotation")),g=computed(()=>n.getDisabledElements("layers")),d=computed(()=>n.getDisabledElements("signature")),f=computed(()=>n.getDisabledElements("search")),y=computed(()=>!w.value||!m.value||!v.value||!g.value||!d.value||!f.value),x=S=>{S.stopPropagation()},k=ref(null),P=()=>{u.value==="SEARCH"&&core.webViewerNamedAction("Find"),n.toggleElement(o.element)};return watch(()=>s.value,(S,E)=>{S&&(k.value.setShow(!1),n.setPopoverChanged(!1))}),(S,E)=>{const M=__unplugin_components_11$1,T=_sfc_main$5,D=__unplugin_components_2,N=__unplugin_components_3,I=__unplugin_components_4,O=__unplugin_components_5,F=__unplugin_components_6,q=__unplugin_components_7,Y=__unplugin_components_8,_e=_sfc_main$4C;return openBlock(),createElementBlock("div",{title:S.$t("toolbar.viewControls.leftPanel"),class:normalizeClass(["left-panel-button toggle-button",{active:r.value}]),onClick:P},[createVNode(unref(NPopover),{ref_key:"popover",ref:k,placement:"top-start",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0,"z-index":4},{trigger:withCtx(()=>[createBaseVNode("div",{class:"arrow-container",onClick:x},[withDirectives(createVNode(M,{class:"arrow"},null,512),[[vShow,y.value]])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2$2,[createVNode(T,{activePanelTab:u.value,popover:k.value},null,8,["activePanelTab","popover"])])]),_:1},512),createVNode(_e,{isActive:r.value},{default:withCtx(()=>[u.value==="THUMBS"?(openBlock(),createBlock(D,{key:0})):u.value==="OUTLINE"?(openBlock(),createBlock(N,{key:1})):u.value==="ANNOTATION"?(openBlock(),createBlock(I,{key:2})):u.value==="LAYER"?(openBlock(),createBlock(O,{key:3})):u.value==="SIGNATURE"?(openBlock(),createBlock(F,{key:4})):u.value==="SEARCH"?(openBlock(),createBlock(q,{key:5})):(openBlock(),createBlock(Y,{key:6}))]),_:1},8,["isActive"])],10,_hoisted_1$3)}}},HeaderItems_vue_vue_type_style_index_0_lang="",_hoisted_1$2=["data-element"],_hoisted_2$1={class:"drop-down narrower hand-tools"},_hoisted_3$1={key:0,class:"tool-menu"},_hoisted_4$1={class:"drop-menu"},_hoisted_5$1={class:"drop-down narrower"},_hoisted_6$1=["data-element"],_hoisted_7$1=["data-element"],_hoisted_8=["data-element"],_hoisted_9=["data-element"],_hoisted_10=["data-element"],_hoisted_11=["data-element"],_hoisted_12=["data-element"],_hoisted_13=["data-element"],_hoisted_14=["data-element"],_hoisted_15=["data-element"],_hoisted_16=["data-element"],_hoisted_17={key:0,class:"tool-menu"},_hoisted_18=["data-element"],_hoisted_19=["data-element"],_hoisted_20=["data-element"],_hoisted_21=["data-element"],_hoisted_22=["data-element"],_hoisted_23=["data-element"],_hoisted_24=["data-element"],_hoisted_25=["data-element"],_hoisted_26=["data-element"],_hoisted_27=["data-element"],_hoisted_28=["data-element"],_hoisted_29={class:"right-container"},_hoisted_30={key:1,class:"header-items"},_hoisted_31=createBaseVNode("div",{class:"divider"},null,-1),_hoisted_32={class:"right-container"},_sfc_main$3={__name:"HeaderItems",props:["items","rightItems","toolMode"],setup(e){const{switchTool:n,switchAnnotationEditorMode:o}=core,u=getCurrentInstance().appContext.app.config.globalProperties.$t,s=e,w=useViewerStore(),m=useDocumentStore(),v=computed(()=>w.getCompareStatus),g=computed(()=>w.getUpload&&w.getVerified&&!w.getUploadLoading),d=computed(()=>w.getTools),f=computed(()=>w.getReadOnly);let y=computed(()=>{const N={view:u("toolbar.toolbarGroup.viewer"),form:u("toolbar.toolbarGroup.forms"),annotation:u("toolbar.toolbarGroup.annotations"),sign:u("toolbar.toolbarGroup.signatures"),security:u("toolbar.toolbarGroup.security"),redaction:u("toolbar.toolbarGroup.redaction"),compare:u("toolbar.toolbarGroup.compare"),editor:u("toolbar.toolbarGroup.editor"),document:u("toolbar.toolbarGroup.documentEditor"),separation:u("toolbar.toolbarGroup.separation"),measurement:u("toolbar.toolbarGroup.measurement")};return N[s.toolMode]?N[s.toolMode]:""});const x=computed(()=>w.getWebviewerMode),k=computed(()=>m.getActiveTool),P=computed(()=>m.getDisableDigitalSignature),S=ref(null),E=ref(null),M=N=>{var F,q;if(x.value!=="Standalone"&&["editor","document"].includes(N)){N==="editor"?w.openElement("contentEditorPreventDialog"):w.openElement("docEditorPreventDialog");return}if(N==="sign"&&!P&&window.$message.info(u("signatures.tip"),{duration:3e3,showIcon:!1}),isMobileDevice&&["separation","measurement"].includes(N)){(F=S.value)==null||F.setShow(!1),w.openElement("unsupportedMobileDialog");return}w.setActiveToolMode(N),m.setToolState(""),w.toggleActiveHand(!1),n(0);const I=core.getAnnotationManager(),O=I.isInFormFieldFillMode();N==="form"&&!O?(I.endFormFieldFillMode(),w.setEnableFillForm(!1)):(I.startFormFieldFillMode(),w.setEnableFillForm(!0)),o(0),(q=S.value)==null||q.setShow(!1),(N==="compare"||N==="document")&&w.resetPanels()},T=()=>{E.value[0].setShow(!1),m.setToolState("selectText"),n(0),o(0),w.closeActiveStickNote(),w.setSearchStatus(!1),w.toggleActiveHand(!1)},D=N=>!N.length||N.length&&N.every(I=>I.hidden);return watch(()=>s.toolMode,N=>{N==="form"&&(core.getAnnotationManager().endFormFieldFillMode(),w.setEnableFillForm(!1))}),(N,I)=>{const O=_sfc_main$2H,F=_sfc_main$4,q=__unplugin_components_2$1,Y=_sfc_main$e,_e=_sfc_main$g,ne=_sfc_main$h,ve=_sfc_main$36,J=_sfc_main$i,fe=__unplugin_components_8$1,Z=__unplugin_components_9,j=__unplugin_components_10,X=__unplugin_components_11$1,H=_sfc_main$4C,U=_sfc_main$m,te=__unplugin_components_14,Q=_sfc_main$x,re=_sfc_main$y,Pe=_sfc_main$z,be=_sfc_main$B;return e.toolMode!=="compare"&&e.toolMode!=="document"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["header-items",{mobile:unref(isMobileDevice)}])},[unref(isMobileDevice)?(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(e.items,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.type}-${we.dataElement||Ae}-mobile`},[we.name==="customButton"&&!we.hidden&&!we.dropItem?(openBlock(),createBlock(O,{key:0,item:we},null,8,["item"])):we.type==="toggleElementButton"&&!we.hidden?(openBlock(),createBlock(F,{key:1,item:we,class:normalizeClass({disabled:!g.value}),"data-element":we.dataElement},null,8,["item","class","data-element"])):we.type==="selectTools"&&!we.hidden?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(["hand-tools",{"events-none":!g.value}]),"data-element":we.dataElement},[createVNode(unref(NPopover),{ref_for:!0,ref_key:"popoverTool",ref:E,placement:"bottom",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0},{trigger:withCtx(()=>[createVNode(H,{class:normalizeClass(["drop-menu",{disabled:!g.value}])},{default:withCtx(()=>[k.value==="cropPage"?(openBlock(),createBlock(fe,{key:0})):["selectText","highlight","underline","squiggly","strikeout"].includes(k.value)?(openBlock(),createBlock(Z,{key:1})):(openBlock(),createBlock(j,{key:2})),createVNode(X)]),_:1},8,["class"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,($e,Me)=>(openBlock(),createElementBlock(Fragment,{key:`${$e.type}-${$e.dataElement||Me}`},[$e.type==="handToolButton"&&!$e.hidden?(openBlock(),createBlock(_e,{key:0,item:$e,"data-element":$e.dataElement,popoverTool:E.value},null,8,["item","data-element","popoverTool"])):$e.type==="cropPageButton"&&!$e.hidden?(openBlock(),createBlock(ne,{key:1,item:$e,"data-element":$e.dataElement,popoverTool:E.value},null,8,["item","data-element","popoverTool"])):$e.type==="selectTools"&&!$e.hidden?(openBlock(),createBlock(H,{key:2,"data-element":$e.dataElement,onClick:T},{default:withCtx(()=>[createVNode(Z)]),_:2},1032,["data-element"])):createCommentVNode("",!0)],64))),128))])]),_:2},1536)],10,_hoisted_1$2)):createCommentVNode("",!0)],64))),128)):(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(e.items,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.type}-${we.dataElement||Ae}`},[we.name==="customButton"&&!we.hidden&&!we.dropItem?(openBlock(),createBlock(O,{key:0,item:we},null,8,["item"])):we.type==="toggleElementButton"&&!we.hidden?(openBlock(),createBlock(F,{key:1,item:we,class:normalizeClass({disabled:!g.value}),"data-element":we.dataElement},null,8,["item","class","data-element"])):we.type==="toolButton"&&!we.hidden?(openBlock(),createBlock(q,{key:2,item:we,"data-element":we.dataElement},null,8,["item","data-element"])):we.type==="fullScreenButton"&&!we.hidden?(openBlock(),createBlock(Y,{key:3,item:we,class:normalizeClass({disabled:!g.value}),"data-element":we.dataElement},null,8,["item","class","data-element"])):we.type==="handToolButton"&&!we.hidden?(openBlock(),createBlock(_e,{key:4,item:we,class:normalizeClass({disabled:!g.value}),"data-element":we.dataElement},null,8,["item","class","data-element"])):we.type==="cropPageButton"&&!we.hidden?(openBlock(),createBlock(ne,{key:5,item:we,class:normalizeClass({disabled:!g.value}),"data-element":we.dataElement},null,8,["item","class","data-element"])):we.type==="zoomOverlay"&&!we.hidden?(openBlock(),createBlock(ve,{key:6,"data-element":we.dataElement},null,8,["data-element"])):we.type==="viewRotationControls"&&!we.hidden?(openBlock(),createBlock(J,{key:7,"data-element":we.dataElement},null,8,["data-element"])):["spacer","divider"].includes(we.type)?(openBlock(),createElementBlock("div",{key:8,class:normalizeClass(we.type)},null,2)):createCommentVNode("",!0)],64))),128)),createBaseVNode("div",{class:normalizeClass(["tool-container mobile",{"events-none":!g.value}])},[!D(d.value)&&f.value?(openBlock(),createElementBlock("div",_hoisted_3$1,[createBaseVNode("div",{class:normalizeClass(["item",{active:e.toolMode==="view"}]),onClick:I[0]||(I[0]=we=>M("view"))},toDisplayString(unref(u)("toolbar.toolbarGroup.viewer")),3)])):!D(d.value)&&!f.value?(openBlock(),createBlock(unref(NPopover),{key:1,ref_key:"popoverMode",ref:S,placement:"bottom",trigger:"click","show-arrow":!1,to:"#outerContainer",raw:!0},{trigger:withCtx(()=>[createBaseVNode("div",_hoisted_4$1,[createBaseVNode("span",null,toDisplayString(unref(y)),1),createVNode(X,{class:"arrow-left"})])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_5$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(d.value,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.dataElement||Ae}`},[we.element==="view"&&!we.hidden?(openBlock(),createElementBlock("div",{key:0,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="view"}]),onClick:I[1]||(I[1]=$e=>M("view"))},toDisplayString(unref(u)("toolbar.toolbarGroup.viewer")),11,_hoisted_6$1)):we.element==="annotation"&&!we.hidden?(openBlock(),createElementBlock("div",{key:1,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="annotation"}]),onClick:I[2]||(I[2]=$e=>M("annotation"))},toDisplayString(unref(u)("toolbar.toolbarGroup.annotations")),11,_hoisted_7$1)):we.element==="form"&&!we.hidden?(openBlock(),createElementBlock("div",{key:2,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="form"}]),onClick:I[3]||(I[3]=$e=>M("form"))},toDisplayString(unref(u)("toolbar.toolbarGroup.forms")),11,_hoisted_8)):we.element==="sign"&&!we.hidden&&x.value==="Standalone"?(openBlock(),createElementBlock("div",{key:3,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="sign"}]),onClick:I[4]||(I[4]=$e=>M("sign"))},toDisplayString(unref(u)("toolbar.toolbarGroup.signatures")),11,_hoisted_9)):we.element==="security"&&!we.hidden?(openBlock(),createElementBlock("div",{key:4,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="security"}]),onClick:I[5]||(I[5]=$e=>M("security"))},toDisplayString(unref(u)("toolbar.toolbarGroup.security")),11,_hoisted_10)):we.element==="redaction"&&!we.hidden?(openBlock(),createElementBlock("div",{key:5,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="redaction"}]),onClick:I[6]||(I[6]=$e=>M("redaction"))},toDisplayString(unref(u)("toolbar.toolbarGroup.redaction")),11,_hoisted_11)):we.element==="compare"&&!we.hidden?(openBlock(),createElementBlock("div",{key:6,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="compare"}]),onClick:I[7]||(I[7]=$e=>M("compare"))},toDisplayString(unref(u)("toolbar.toolbarGroup.compare")),11,_hoisted_12)):we.element==="editor"&&!we.hidden?(openBlock(),createElementBlock("div",{key:7,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="editor"}]),onClick:I[8]||(I[8]=$e=>M("editor"))},toDisplayString(unref(u)("toolbar.toolbarGroup.editor")),11,_hoisted_13)):we.element==="document"&&!we.hidden?(openBlock(),createElementBlock("div",{key:8,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="document"}]),onClick:I[9]||(I[9]=$e=>M("document"))},toDisplayString(unref(u)("toolbar.toolbarGroup.documentEditor")),11,_hoisted_14)):we.element==="separation"&&!we.hidden?(openBlock(),createElementBlock("div",{key:9,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="separation"}]),onClick:I[10]||(I[10]=$e=>M("separation"))},toDisplayString(unref(u)("toolbar.toolbarGroup.separation")),11,_hoisted_15)):we.element==="measurement"&&!we.hidden?(openBlock(),createElementBlock("div",{key:10,"data-element":we.dataElement,class:normalizeClass(["drop-item",{active:e.toolMode==="measurement"}]),onClick:I[11]||(I[11]=$e=>M("measurement"))},toDisplayString(unref(u)("toolbar.toolbarGroup.measurement")),11,_hoisted_16)):createCommentVNode("",!0)],64))),128))])]),_:1},512)):createCommentVNode("",!0)],2),createBaseVNode("div",{class:normalizeClass(["tool-container pc",{"events-none":!g.value}])},[D(d.value)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_17,[(openBlock(!0),createElementBlock(Fragment,null,renderList(d.value,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.dataElement||Ae}`},[we.element==="view"&&!we.hidden?(openBlock(),createElementBlock("div",{key:0,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="view"}]),onClick:I[12]||(I[12]=$e=>M("view"))},toDisplayString(unref(u)("toolbar.toolbarGroup.viewer")),11,_hoisted_18)):we.element==="annotation"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:1,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="annotation"}]),onClick:I[13]||(I[13]=$e=>M("annotation"))},toDisplayString(unref(u)("toolbar.toolbarGroup.annotations")),11,_hoisted_19)):we.element==="form"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:2,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="form"}]),onClick:I[14]||(I[14]=$e=>M("form"))},toDisplayString(unref(u)("toolbar.toolbarGroup.forms")),11,_hoisted_20)):we.element==="sign"&&!we.hidden&&x.value==="Standalone"&&!f.value?(openBlock(),createElementBlock("div",{key:3,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="sign"}]),onClick:I[15]||(I[15]=$e=>M("sign"))},toDisplayString(unref(u)("toolbar.toolbarGroup.signatures")),11,_hoisted_21)):we.element==="security"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:4,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="security"}]),onClick:I[16]||(I[16]=$e=>M("security"))},toDisplayString(unref(u)("toolbar.toolbarGroup.security")),11,_hoisted_22)):we.element==="redaction"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:5,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="redaction"}]),onClick:I[17]||(I[17]=$e=>M("redaction"))},toDisplayString(unref(u)("toolbar.toolbarGroup.redaction")),11,_hoisted_23)):we.element==="compare"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:6,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="compare"}]),onClick:I[18]||(I[18]=$e=>M("compare"))},toDisplayString(unref(u)("toolbar.toolbarGroup.compare")),11,_hoisted_24)):we.element==="editor"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:7,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="editor"}]),onClick:I[19]||(I[19]=$e=>M("editor"))},toDisplayString(unref(u)("toolbar.toolbarGroup.editor")),11,_hoisted_25)):we.element==="document"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:8,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="document"}]),onClick:I[20]||(I[20]=$e=>M("document"))},toDisplayString(unref(u)("toolbar.toolbarGroup.documentEditor")),11,_hoisted_26)):we.element==="separation"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:9,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="separation"}]),onClick:I[21]||(I[21]=$e=>M("separation"))},toDisplayString(unref(u)("toolbar.toolbarGroup.separation")),11,_hoisted_27)):we.element==="measurement"&&!we.hidden&&!f.value?(openBlock(),createElementBlock("div",{key:10,"data-element":we.dataElement,class:normalizeClass(["item",{active:e.toolMode==="measurement"}]),onClick:I[22]||(I[22]=$e=>M("measurement"))},toDisplayString(unref(u)("toolbar.toolbarGroup.measurement")),11,_hoisted_28)):createCommentVNode("",!0)],64))),128))]))],2),createBaseVNode("div",_hoisted_29,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rightItems,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.type}-${we.dataElement||Ae}`},[we.name==="customButton"&&!we.hidden&&!we.dropItem?(openBlock(),createBlock(O,{key:0,item:we,"data-element":we.dataElement},null,8,["item","data-element"])):we.type==="searchButton"&&!we.hidden?(openBlock(),createBlock(U,{key:1,item:we,"data-element":we.dataElement},null,8,["item","data-element"])):["spacer","divider"].includes(we.type)?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(we.type)},null,2)):createCommentVNode("",!0)],64))),128)),createVNode(te,{rightItems:e.rightItems},null,8,["rightItems"])])],2)):e.toolMode==="compare"?(openBlock(),createElementBlock("div",_hoisted_30,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.type}-${we.dataElement||Ae}`},[we.type==="fullScreenButton"&&!we.hidden?(openBlock(),createBlock(Y,{key:0,item:we,class:normalizeClass({disabled:v.value!=="finished"}),"data-element":we.dataElement},null,8,["item","class","data-element"])):createCommentVNode("",!0)],64))),128)),_hoisted_31,createVNode(Q),createBaseVNode("div",_hoisted_32,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rightItems,(we,Ae)=>(openBlock(),createElementBlock(Fragment,{key:`${we.type}-${we.dataElement||Ae}`},[we.type==="downloadButton"&&!we.hidden?(openBlock(),createBlock(re,{key:0,item:we,class:normalizeClass({disabled:v.value!=="finished"&&v.value!=="next"}),"data-element":we.dataElement},null,8,["item","class","data-element"])):createCommentVNode("",!0),we.type==="printButton"&&!we.hidden?(openBlock(),createBlock(Pe,{key:1,item:we,class:normalizeClass({disabled:v.value!=="finished"&&v.value!=="next"}),"data-element":we.dataElement},null,8,["item","class","data-element"])):createCommentVNode("",!0)],64))),128))])])):e.toolMode==="document"?(openBlock(),createBlock(be,{key:2})):createCommentVNode("",!0)}}},Header_vue_vue_type_style_index_0_lang="",_hoisted_1$1={key:1,class:"click-tip"},_sfc_main$2={__name:"Header",setup(e){const n=useViewerStore(),o=useDocumentStore(),r=n.getActiveHeaderItems,u=n.getActiveRightHeaderItems,s=computed(()=>n.getToolMode),w=computed(()=>n.getSignatureVerify),m=computed(()=>n.getDisabledHeader),v=computed(()=>o.getActiveTool),g=computed(()=>n.isShowCompareTip),d=computed(()=>n.getCompareStatus),f=computed(()=>o.getCompareFile("oldFile")&&o.getCompareFile("newFile")&&d.value!=="finished");return(y,x)=>{const k=_sfc_main$3,P=__unplugin_components_1,S=_sfc_main$14,E=__unplugin_components_3$4,M=_sfc_main$18;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["header",{disabled:m.value||["redaction","remove"].includes(v.value)}]),"data-element":"header"},[createVNode(k,{items:unref(r),rightItems:unref(u),toolMode:s.value},null,8,["items","rightItems","toolMode"])],2),createVNode(P),createVNode(S),w.value&&s.value==="sign"?(openBlock(),createBlock(E,{key:0})):createCommentVNode("",!0),withDirectives(createVNode(M,null,null,512),[[vShow,["redaction","remove"].includes(v.value)]]),s.value==="compare"&&f.value&&g.value?(openBlock(),createElementBlock("div",_hoisted_1$1,toDisplayString(y.$t("toolbar.compareTip")),1)):createCommentVNode("",!0)],64)}}},loadScript=(e,n)=>new Promise(o=>{e||o();const r=document.createElement("script");r.type="text/javascript",r.onload=function(){o()},r.onerror=function(){n&&console.warn(n),o()},r.src=e,document.querySelector("head").appendChild(r)}),loadConfig=e=>new Promise(async n=>{window.parent===window?n():(window.addEventListener("message",async function o(r){if(r.data.type==="responseConfig"){const{value:u,options:s}=r.data;try{u&&(await loadScript(r.data.value,"Config script could not be loaded"),window.removeEventListener("message",o))}finally{await e(s),n()}}}),window.parent.postMessage({type:"requestConfig",docId:parseInt(getHashParameters("docId"),10)},"*"))}),initDocument=(e={})=>{const n=new ComPDFKitViewer(e);core.setDocumentViewer(1,n)};function createEncapsulatedStore(e){return{dispatch(o){if(typeof e.dispatch=="function")return e.dispatch(o);throw new Error("Original store does not have a dispatch method.")},getState(o){if(typeof e.getState=="function")return JSON.parse(JSON.stringify(e.getState(o)));throw new Error("Original store does not have a getState method.")}}}const disableElements=e=>n=>{var r;const o=[...e.getActiveHeaderItems,...e.getTools,...e.getActiveRightHeaderItems,...e.getToolItems.annotation,...e.getToolItems.form,...e.getToolItems.security,...e.getToolItems.editor,...e.getToolItems.measurement,...e.getPopupItems("textPopup"),...e.getPopupItems("cropPagePopup")];if(Array.isArray(n))for(let u=0;u<o.length;u++)n.forEach(s=>{e.getDisabledElementsObj[s]?e.setDisabledElements(s):o[u].dataElement===s&&(o[u].hidden=!0)});else if(typeof n=="string"){if(e.getDisabledElementsObj[n]){e.setDisabledElements(n);return}const u=o.find(s=>s.dataElement===n);u?(u.hidden=!0,e.toolMode===u.element&&e.setActiveToolMode((r=e.tools[0])==null?void 0:r.element)):console.warn("DataElement not found.")}else console.error("Wrong dataElements type.")},enableElements=e=>n=>{const o=[...e.getActiveHeaderItems,...e.getTools,...e.getActiveRightHeaderItems,...e.getToolItems.annotation,...e.getToolItems.form,...e.getToolItems.security,...e.getToolItems.editor,...e.getToolItems.measurement,...e.getPopupItems("textPopup"),...e.getPopupItems("cropPagePopup")];if(Array.isArray(n))for(let r=0;r<o.length;r++)n.forEach(u=>{e.getDisabledElementsObj[u]?e.setEnabledElements(u):o[r].dataElement===u&&(o[r].hidden=!1)});else if(typeof n=="string"){if(e.getDisabledElementsObj[n]){e.setEnabledElements(n);return}const r=o.find(u=>u.dataElement===n);r?r.hidden=!1:console.warn("DataElement not found.")}else console.error("Wrong dataElements type.")},setHeaderItems=e=>n=>{const o={headers:e.headers,rightHeaders:e.rightHeaders,tools:e.tools,toolItems:e.toolItems},r=Object.create(Header).initialize(e,o);n(r),Object.keys(o).forEach(u=>{const s=o[u];e[u]=s})},Header={initialize(e){return this.headers={headers:e.headers,rightHeaders:e.rightHeaders,tools:e.tools,toolItems:e.toolItems,documentEditorHeaders:e.documentEditorHeaders},this.toolButtonObjects=e.toolItems,this.headerGroup="headers",this.index=-1,this},get(e){if(this.index!==-1){const n=this.headers[this.headerGroup][this.index];Object.keys(n).forEach(o=>{delete this[o]})}if(this._setIndex(e),this.index===-1)console.warn(`${e} does not exist in ${this.headerGroup} header`);else{const n=this.headers[this.headerGroup][this.index];Object.keys(n).forEach(o=>{this[o]=n[o]})}return this},getItems(){return this.headers[this.headerGroup]},getHeader(e){const n=Object.keys(this.headers);return n.includes(e)?(this.headerGroup=e,this._resetIndex()):console.warn(`Header must be one of: ${n.join(" or ")}.`),this},insertBefore(e){return this.index===-1?console.warn("Please use .get(dataElement) first before using insertBefore"):this.headers[this.headerGroup].splice(this.index,0,e),this},insertAfter(e){return this.index===-1?console.warn("Please use .get(dataElement) first before using insertAfter"):(this.index++,this.headers[this.headerGroup].splice(this.index,0,e)),this},delete(e){let n;return typeof e=="number"?n=e:typeof e=="string"?this._getIndexOfElement(e)===-1?console.warn(`${e} does not exist in ${this.headerGroup} header`):n=this._getIndexOfElement(e):typeof e>"u"?this.index===-1?console.warn("Please use .get(dataElement) first before using delete()"):n=this.index:Array.isArray(e)?e.forEach(o=>{(typeof o=="number"||typeof o=="string")&&this.delete(o)}):console.warn("Argument must be empty, a number, a string or an array"),n!==void 0&&n!==-1&&(this.headers[this.headerGroup].splice(n,1),this._resetIndex()),this},shift(){return this.headers[this.headerGroup].shift(),this},unshift(...e){return this.headers[this.headerGroup].unshift(...e),this},push(...e){return this.headers[this.headerGroup].push(...e),this},pop(){return this.headers[this.headerGroup].pop(),this},update(e){return Array.isArray(e)?this._updateItems(e):console.warn("Argument must be an array"),this},_updateItems(e){return this.headers[this.headerGroup].length=0,this.headers[this.headerGroup].push(...e),this},_setIndex(e){this.index=this._getIndexOfElement(e)},_getIndexOfElement(e){return this.headers[this.headerGroup].findIndex(n=>{let o;return n.type==="toolButton"?o=this.toolButtonObjects[n.toolName].dataElement:o=n.dataElement,o===e})},_resetIndex(){this.index=-1}},setActiveToolMode=e=>n=>{const o=e.tools.find(r=>r.dataElement===n);o?(o.hidden&&(o.hidden=!1),e.setActiveToolMode(o.element)):console.warn("DataElement not found.")},setActiveTool=(e,n)=>o=>{const r=e.getToolMode;if(r){if(!o){n.setToolState();return}const s=e.getToolItems[r].find(w=>w.dataElement===o);if(!s){console.warn("DataElement not match toolMode.");return}s.hidden&&(s.hidden=!1),n.setToolState(s.type)}else console.warn("DataElement not found.")},setLanguage=e=>async n=>{await instance$1.changeLanguage(n),e.setLanguage(n),window.localStorage.setItem("language",n)},getPassword=e=>()=>e.dispatch("getPassword"),createPopupAPI=(e,n)=>Object.create(PopupAPI).initialize(e,n),PopupAPI={initialize(e,n){return this.store=e,this.popupDataElement=n,this},add(e,n){Array.isArray(e)||(e=[e]);const o=this._getIndexByDataElement(n);this.getItems().splice(o+1,0,...e)},update(e){e||(e=[]),Array.isArray(e)||(e=[e]);const n=this.getItems();n.length=0,n.push(...e)},getItems(){return this.store.dispatch("getPopupItems")(this.popupDataElement)},_getIndexByDataElement(e){let n;return typeof e>"u"?n=-1:n=this.store.dispatch("getPopupItems")(this.popupDataElement).findIndex(o=>o.dataElement===e),n}},textPopup=e=>createPopupAPI(e,"textPopup"),openElement=e=>n=>{if(["rightPanel","contentEditorPanel","measurePanel","freetextPanel"].includes(n)&&e.getRightPanelButtonDisabled)return!1;e.dispatch("openElement")(n)},closeElement=e=>n=>e.dispatch("closeElement")(n),isElementOpen=e=>n=>e.dispatch("isElementOpen")(n),setActiveElementTab=e=>(n,o)=>{e.activeElementsTab.hasOwnProperty(n)?e.setActiveElementTab(n,o):console.warn("DataElement not found.")},setCustomFonts=e=>n=>{Array.isArray(n)?e.setCustomFonts(n):console.error("setCustomFonts: fonts must be an array")},setAnnotator=e=>n=>{e.setAnnotator(n||"Guest")},getToolColor=e=>n=>e[n].color,getTool=e=>n=>({...e[n]}),getActiveTool=e=>()=>e.getActiveTool,cropPagePopup=e=>createPopupAPI(e,"cropPagePopup"),setAutoJumpNextSign=e=>n=>{e.setAutoJumpNextSign(!!n)},setSignatureDialogTabs=e=>n=>{e.setSignatureDialogTabs(n)},setSignatureDialogProperties=e=>(n,o)=>{e.setSignatureDialogProperties(n,o)},setCustomLoading=e=>n=>{e.setCustomLoading(n)},disableAnnotationExport=e=>()=>{e.setAnnotationExport(!1)},disableAnnotationImport=e=>()=>{e.setAnnotationImport(!1)},enableAnnotationExport=e=>()=>{e.setAnnotationExport(!0)},enableAnnotationImport=e=>()=>{e.setAnnotationImport(!0)},enableSignatureTool=e=>()=>{e.setDisableSignatureTool(!1)},disableSignatureTool=e=>()=>{e.setDisableSignatureTool(!0)},setCustomStyle=e=>{const n=document.createElement("style");n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n)},setThemeMode=e=>n=>{e.setThemeMode(n)},disableDocumentEditorSave=e=>()=>{e.setDocumentEditorSaveStatus(!1)},disableDocumentEditorSaveAs=e=>()=>{e.setDocumentEditorSaveAsStatus(!1)},enableDocumentEditorSave=e=>()=>{e.setDocumentEditorSaveStatus(!0)},enableDocumentEditorSaveAs=e=>()=>{e.setDocumentEditorSaveAsStatus(!0)},saveDocumentEditor=(e,n,o)=>async()=>{const r=await o.saveDocumentEdit();if(!r)return;n.resetSetting(),n.setToolState(""),e.setActiveToolMode("view"),e.setUpload(!0),e.setUploadLoading(!0);const u=e.getScale,s=n.getPassword;await o.loadDocument(r,{password:s}),n.setCurrentPdfData(r);const w=o.getPagesCount();n.setTotalPages(w),n.setOutline(o.getOutlines()),e.setCurrentPage(1);const m=e.getScrollMode,v=e.getPageMode;o.switchScrollMode(m==="Vertical"?0:1),o.switchSpreadMode(v),e.setCurrentScale(u/100),o.scaleChanged(u/100),e.setUploadLoading(!1)},setAuthor=e=>n=>{e.setAuthor(n||"")},setHighlightForm=e=>n=>{e.setHighlightForm(n)},setHighlightLink=e=>n=>{e.setHighlightLink(n)},setEnableSignatureTemplates=e=>n=>{e.setEnableSignatureTemplates(n)},addLanguage=e=>n=>{e.addLanguage(n)},removeLanguage=e=>n=>{e.removeLanguage(n)},setLanguages=e=>n=>{e.setLanguages(n)},defineWebViewerInstanceUIAPIs=()=>{const e=useViewerStore(),n=useDocumentStore(),o=createEncapsulatedStore(e),r=createEncapsulatedStore(n);e.setLanguage(instance$1.language);const u="Core",s="UI",w={...core},m={disableElements:disableElements(e),enableElements:enableElements(e),setHeaderItems:setHeaderItems(e),setActiveToolMode:setActiveToolMode(e),setActiceToolMode:setActiveToolMode(e),setActiveTool:setActiveTool(e,n),setLanguage:setLanguage(e),getPassword:getPassword(r),textPopup:textPopup(o),openElement:openElement(e),closeElement:closeElement(e),isElementOpen:isElementOpen(e),setActiveElementTab:setActiveElementTab(e),setCustomFonts:setCustomFonts(e),setAnnotator:setAnnotator(n),getActiveTool:getActiveTool(n),getToolColor:getToolColor(n),getTool:getTool(n),cropPagePopup:cropPagePopup(o),setAutoJumpNextSign:setAutoJumpNextSign(n),setSignatureDialogTabs:setSignatureDialogTabs(e),setSignatureDialogProperties:setSignatureDialogProperties(e),setCustomLoading:setCustomLoading(e),disableAnnotationExport:disableAnnotationExport(e),disableAnnotationImport:disableAnnotationImport(e),enableAnnotationExport:enableAnnotationExport(e),enableAnnotationImport:enableAnnotationImport(e),enableSignatureTool:enableSignatureTool(e),disableSignatureTool:disableSignatureTool(e),setCustomStyle,setThemeMode:setThemeMode(e),disableDocumentEditorSave:disableDocumentEditorSave(e),disableDocumentEditorSaveAs:disableDocumentEditorSaveAs(e),enableDocumentEditorSave:enableDocumentEditorSave(e),enableDocumentEditorSaveAs:enableDocumentEditorSaveAs(e),saveDocumentEditor:saveDocumentEditor(e,n,core),setAuthor:setAuthor(n),setHighlightForm:setHighlightForm(n),setHighlightLink:setHighlightLink(n),setEnableSignatureTemplates:setEnableSignatureTemplates(e),addLanguage:addLanguage(e),removeLanguage:removeLanguage(e),setLanguages:setLanguages(e)};window.instance={docViewer:core.getDocumentViewer(),[u]:w,[s]:m}};/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ownKeys(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),o.push.apply(o,r)}return o}function _objectSpread2(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?ownKeys(Object(o),!0).forEach(function(r){_defineProperty(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function _typeof(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(n){return typeof n}:_typeof=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(e)}function _defineProperty(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function _extends(){return _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(e,n){if(e==null)return{};var o={},r=Object.keys(e),u,s;for(s=0;s<r.length;s++)u=r[s],!(n.indexOf(u)>=0)&&(o[u]=e[u]);return o}function _objectWithoutProperties(e,n){if(e==null)return{};var o=_objectWithoutPropertiesLoose(e,n),r,u;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(u=0;u<s.length;u++)r=s[u],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(o[r]=e[r]))}return o}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _unsupportedIterableToArray(e,n){if(!!e){if(typeof e=="string")return _arrayLikeToArray(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(e,n)}}function _arrayLikeToArray(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=e[o];return r}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var version="1.15.2";function userAgent(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var IE11OrLess=userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Edge=userAgent(/Edge/i),FireFox=userAgent(/firefox/i),Safari=userAgent(/safari/i)&&!userAgent(/chrome/i)&&!userAgent(/android/i),IOS=userAgent(/iP(ad|od|hone)/i),ChromeForAndroid=userAgent(/chrome/i)&&userAgent(/android/i),captureMode={capture:!1,passive:!1};function on(e,n,o){e.addEventListener(n,o,!IE11OrLess&&captureMode)}function off(e,n,o){e.removeEventListener(n,o,!IE11OrLess&&captureMode)}function matches(e,n){if(!!n){if(n[0]===">"&&(n=n.substring(1)),e)try{if(e.matches)return e.matches(n);if(e.msMatchesSelector)return e.msMatchesSelector(n);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(n)}catch{return!1}return!1}}function getParentOrHost(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function closest(e,n,o,r){if(e){o=o||document;do{if(n!=null&&(n[0]===">"?e.parentNode===o&&matches(e,n):matches(e,n))||r&&e===o)return e;if(e===o)break}while(e=getParentOrHost(e))}return null}var R_SPACE=/\s+/g;function toggleClass(e,n,o){if(e&&n)if(e.classList)e.classList[o?"add":"remove"](n);else{var r=(" "+e.className+" ").replace(R_SPACE," ").replace(" "+n+" "," ");e.className=(r+(o?" "+n:"")).replace(R_SPACE," ")}}function css(e,n,o){var r=e&&e.style;if(r){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),n===void 0?o:o[n];!(n in r)&&n.indexOf("webkit")===-1&&(n="-webkit-"+n),r[n]=o+(typeof o=="string"?"":"px")}}function matrix(e,n){var o="";if(typeof e=="string")o=e;else do{var r=css(e,"transform");r&&r!=="none"&&(o=r+" "+o)}while(!n&&(e=e.parentNode));var u=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return u&&new u(o)}function find(e,n,o){if(e){var r=e.getElementsByTagName(n),u=0,s=r.length;if(o)for(;u<s;u++)o(r[u],u);return r}return[]}function getWindowScrollingElement(){var e=document.scrollingElement;return e||document.documentElement}function getRect(e,n,o,r,u){if(!(!e.getBoundingClientRect&&e!==window)){var s,w,m,v,g,d,f;if(e!==window&&e.parentNode&&e!==getWindowScrollingElement()?(s=e.getBoundingClientRect(),w=s.top,m=s.left,v=s.bottom,g=s.right,d=s.height,f=s.width):(w=0,m=0,v=window.innerHeight,g=window.innerWidth,d=window.innerHeight,f=window.innerWidth),(n||o)&&e!==window&&(u=u||e.parentNode,!IE11OrLess))do if(u&&u.getBoundingClientRect&&(css(u,"transform")!=="none"||o&&css(u,"position")!=="static")){var y=u.getBoundingClientRect();w-=y.top+parseInt(css(u,"border-top-width")),m-=y.left+parseInt(css(u,"border-left-width")),v=w+s.height,g=m+s.width;break}while(u=u.parentNode);if(r&&e!==window){var x=matrix(u||e),k=x&&x.a,P=x&&x.d;x&&(w/=P,m/=k,f/=k,d/=P,v=w+d,g=m+f)}return{top:w,left:m,bottom:v,right:g,width:f,height:d}}}function isScrolledPast(e,n,o){for(var r=getParentAutoScrollElement(e,!0),u=getRect(e)[n];r;){var s=getRect(r)[o],w=void 0;if(o==="top"||o==="left"?w=u>=s:w=u<=s,!w)return r;if(r===getWindowScrollingElement())break;r=getParentAutoScrollElement(r,!1)}return!1}function getChild(e,n,o,r){for(var u=0,s=0,w=e.children;s<w.length;){if(w[s].style.display!=="none"&&w[s]!==Sortable.ghost&&(r||w[s]!==Sortable.dragged)&&closest(w[s],o.draggable,e,!1)){if(u===n)return w[s];u++}s++}return null}function lastChild(e,n){for(var o=e.lastElementChild;o&&(o===Sortable.ghost||css(o,"display")==="none"||n&&!matches(o,n));)o=o.previousElementSibling;return o||null}function index(e,n){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==Sortable.clone&&(!n||matches(e,n))&&o++;return o}function getRelativeScrollOffset(e){var n=0,o=0,r=getWindowScrollingElement();if(e)do{var u=matrix(e),s=u.a,w=u.d;n+=e.scrollLeft*s,o+=e.scrollTop*w}while(e!==r&&(e=e.parentNode));return[n,o]}function indexOfObject(e,n){for(var o in e)if(!!e.hasOwnProperty(o)){for(var r in n)if(n.hasOwnProperty(r)&&n[r]===e[o][r])return Number(o)}return-1}function getParentAutoScrollElement(e,n){if(!e||!e.getBoundingClientRect)return getWindowScrollingElement();var o=e,r=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var u=css(o);if(o.clientWidth<o.scrollWidth&&(u.overflowX=="auto"||u.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(u.overflowY=="auto"||u.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return getWindowScrollingElement();if(r||n)return o;r=!0}}while(o=o.parentNode);return getWindowScrollingElement()}function extend(e,n){if(e&&n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o]);return e}function isRectEqual(e,n){return Math.round(e.top)===Math.round(n.top)&&Math.round(e.left)===Math.round(n.left)&&Math.round(e.height)===Math.round(n.height)&&Math.round(e.width)===Math.round(n.width)}var _throttleTimeout;function throttle(e,n){return function(){if(!_throttleTimeout){var o=arguments,r=this;o.length===1?e.call(r,o[0]):e.apply(r,o),_throttleTimeout=setTimeout(function(){_throttleTimeout=void 0},n)}}}function cancelThrottle(){clearTimeout(_throttleTimeout),_throttleTimeout=void 0}function scrollBy(e,n,o){e.scrollLeft+=n,e.scrollTop+=o}function clone(e){var n=window.Polymer,o=window.jQuery||window.Zepto;return n&&n.dom?n.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function setRect(e,n){css(e,"position","absolute"),css(e,"top",n.top),css(e,"left",n.left),css(e,"width",n.width),css(e,"height",n.height)}function unsetRect(e){css(e,"position",""),css(e,"top",""),css(e,"left",""),css(e,"width",""),css(e,"height","")}function getChildContainingRectFromElement(e,n,o){var r={};return Array.from(e.children).forEach(function(u){var s,w,m,v;if(!(!closest(u,n.draggable,e,!1)||u.animated||u===o)){var g=getRect(u);r.left=Math.min((s=r.left)!==null&&s!==void 0?s:1/0,g.left),r.top=Math.min((w=r.top)!==null&&w!==void 0?w:1/0,g.top),r.right=Math.max((m=r.right)!==null&&m!==void 0?m:-1/0,g.right),r.bottom=Math.max((v=r.bottom)!==null&&v!==void 0?v:-1/0,g.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var expando="Sortable"+new Date().getTime();function AnimationStateManager(){var e=[],n;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(u){if(!(css(u,"display")==="none"||u===Sortable.ghost)){e.push({target:u,rect:getRect(u)});var s=_objectSpread2({},e[e.length-1].rect);if(u.thisAnimationDuration){var w=matrix(u,!0);w&&(s.top-=w.f,s.left-=w.e)}u.fromRect=s}})}},addAnimationState:function(r){e.push(r)},removeAnimationState:function(r){e.splice(indexOfObject(e,{target:r}),1)},animateAll:function(r){var u=this;if(!this.options.animation){clearTimeout(n),typeof r=="function"&&r();return}var s=!1,w=0;e.forEach(function(m){var v=0,g=m.target,d=g.fromRect,f=getRect(g),y=g.prevFromRect,x=g.prevToRect,k=m.rect,P=matrix(g,!0);P&&(f.top-=P.f,f.left-=P.e),g.toRect=f,g.thisAnimationDuration&&isRectEqual(y,f)&&!isRectEqual(d,f)&&(k.top-f.top)/(k.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(v=calculateRealTime(k,y,x,u.options)),isRectEqual(f,d)||(g.prevFromRect=d,g.prevToRect=f,v||(v=u.options.animation),u.animate(g,k,f,v)),v&&(s=!0,w=Math.max(w,v),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},v),g.thisAnimationDuration=v)}),clearTimeout(n),s?n=setTimeout(function(){typeof r=="function"&&r()},w):typeof r=="function"&&r(),e=[]},animate:function(r,u,s,w){if(w){css(r,"transition",""),css(r,"transform","");var m=matrix(this.el),v=m&&m.a,g=m&&m.d,d=(u.left-s.left)/(v||1),f=(u.top-s.top)/(g||1);r.animatingX=!!d,r.animatingY=!!f,css(r,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=repaint(r),css(r,"transition","transform "+w+"ms"+(this.options.easing?" "+this.options.easing:"")),css(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){css(r,"transition",""),css(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},w)}}}}function repaint(e){return e.offsetWidth}function calculateRealTime(e,n,o,r){return Math.sqrt(Math.pow(n.top-e.top,2)+Math.pow(n.left-e.left,2))/Math.sqrt(Math.pow(n.top-o.top,2)+Math.pow(n.left-o.left,2))*r.animation}var plugins=[],defaults={initializeByDefault:!0},PluginManager={mount:function e(n){for(var o in defaults)defaults.hasOwnProperty(o)&&!(o in n)&&(n[o]=defaults[o]);plugins.forEach(function(r){if(r.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),plugins.push(n)},pluginEvent:function e(n,o,r){var u=this;this.eventCanceled=!1,r.cancel=function(){u.eventCanceled=!0};var s=n+"Global";plugins.forEach(function(w){!o[w.pluginName]||(o[w.pluginName][s]&&o[w.pluginName][s](_objectSpread2({sortable:o},r)),o.options[w.pluginName]&&o[w.pluginName][n]&&o[w.pluginName][n](_objectSpread2({sortable:o},r)))})},initializePlugins:function e(n,o,r,u){plugins.forEach(function(m){var v=m.pluginName;if(!(!n.options[v]&&!m.initializeByDefault)){var g=new m(n,o,n.options);g.sortable=n,g.options=n.options,n[v]=g,_extends(r,g.defaults)}});for(var s in n.options)if(!!n.options.hasOwnProperty(s)){var w=this.modifyOption(n,s,n.options[s]);typeof w<"u"&&(n.options[s]=w)}},getEventProperties:function e(n,o){var r={};return plugins.forEach(function(u){typeof u.eventProperties=="function"&&_extends(r,u.eventProperties.call(o[u.pluginName],n))}),r},modifyOption:function e(n,o,r){var u;return plugins.forEach(function(s){!n[s.pluginName]||s.optionListeners&&typeof s.optionListeners[o]=="function"&&(u=s.optionListeners[o].call(n[s.pluginName],r))}),u}};function dispatchEvent(e){var n=e.sortable,o=e.rootEl,r=e.name,u=e.targetEl,s=e.cloneEl,w=e.toEl,m=e.fromEl,v=e.oldIndex,g=e.newIndex,d=e.oldDraggableIndex,f=e.newDraggableIndex,y=e.originalEvent,x=e.putSortable,k=e.extraEventProperties;if(n=n||o&&o[expando],!!n){var P,S=n.options,E="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!IE11OrLess&&!Edge?P=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(P=document.createEvent("Event"),P.initEvent(r,!0,!0)),P.to=w||o,P.from=m||o,P.item=u||o,P.clone=s,P.oldIndex=v,P.newIndex=g,P.oldDraggableIndex=d,P.newDraggableIndex=f,P.originalEvent=y,P.pullMode=x?x.lastPutMode:void 0;var M=_objectSpread2(_objectSpread2({},k),PluginManager.getEventProperties(r,n));for(var T in M)P[T]=M[T];o&&o.dispatchEvent(P),S[E]&&S[E].call(n,P)}}var _excluded=["evt"],pluginEvent=function e(n,o){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=r.evt,s=_objectWithoutProperties(r,_excluded);PluginManager.pluginEvent.bind(Sortable)(n,o,_objectSpread2({dragEl,parentEl,ghostEl,rootEl,nextEl,lastDownEl,cloneEl,cloneHidden,dragStarted:moved,putSortable,activeSortable:Sortable.active,originalEvent:u,oldIndex,oldDraggableIndex,newIndex,newDraggableIndex,hideGhostForTarget:_hideGhostForTarget,unhideGhostForTarget:_unhideGhostForTarget,cloneNowHidden:function(){cloneHidden=!0},cloneNowShown:function(){cloneHidden=!1},dispatchSortableEvent:function(m){_dispatchEvent({sortable:o,name:m,originalEvent:u})}},s))};function _dispatchEvent(e){dispatchEvent(_objectSpread2({putSortable,cloneEl,targetEl:dragEl,rootEl,oldIndex,oldDraggableIndex,newIndex,newDraggableIndex},e))}var dragEl,parentEl,ghostEl,rootEl,nextEl,lastDownEl,cloneEl,cloneHidden,oldIndex,newIndex,oldDraggableIndex,newDraggableIndex,activeGroup,putSortable,awaitingDragStarted=!1,ignoreNextClick=!1,sortables=[],tapEvt,touchEvt,lastDx,lastDy,tapDistanceLeft,tapDistanceTop,moved,lastTarget,lastDirection,pastFirstInvertThresh=!1,isCircumstantialInvert=!1,targetMoveDistance,ghostRelativeParent,ghostRelativeParentInitialScroll=[],_silent=!1,savedInputChecked=[],documentExists=typeof document<"u",PositionGhostAbsolutely=IOS,CSSFloatProperty=Edge||IE11OrLess?"cssFloat":"float",supportDraggable=documentExists&&!ChromeForAndroid&&!IOS&&"draggable"in document.createElement("div"),supportCssPointerEvents=function(){if(!!documentExists){if(IE11OrLess)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),_detectDirection=function e(n,o){var r=css(n),u=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),s=getChild(n,0,o),w=getChild(n,1,o),m=s&&css(s),v=w&&css(w),g=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+getRect(s).width,d=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+getRect(w).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&m.float&&m.float!=="none"){var f=m.float==="left"?"left":"right";return w&&(v.clear==="both"||v.clear===f)?"vertical":"horizontal"}return s&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||g>=u&&r[CSSFloatProperty]==="none"||w&&r[CSSFloatProperty]==="none"&&g+d>u)?"vertical":"horizontal"},_dragElInRowColumn=function e(n,o,r){var u=r?n.left:n.top,s=r?n.right:n.bottom,w=r?n.width:n.height,m=r?o.left:o.top,v=r?o.right:o.bottom,g=r?o.width:o.height;return u===m||s===v||u+w/2===m+g/2},_detectNearestEmptySortable=function e(n,o){var r;return sortables.some(function(u){var s=u[expando].options.emptyInsertThreshold;if(!(!s||lastChild(u))){var w=getRect(u),m=n>=w.left-s&&n<=w.right+s,v=o>=w.top-s&&o<=w.bottom+s;if(m&&v)return r=u}}),r},_prepareGroup=function e(n){function o(s,w){return function(m,v,g,d){var f=m.options.group.name&&v.options.group.name&&m.options.group.name===v.options.group.name;if(s==null&&(w||f))return!0;if(s==null||s===!1)return!1;if(w&&s==="clone")return s;if(typeof s=="function")return o(s(m,v,g,d),w)(m,v,g,d);var y=(w?m:v).options.group.name;return s===!0||typeof s=="string"&&s===y||s.join&&s.indexOf(y)>-1}}var r={},u=n.group;(!u||_typeof(u)!="object")&&(u={name:u}),r.name=u.name,r.checkPull=o(u.pull,!0),r.checkPut=o(u.put),r.revertClone=u.revertClone,n.group=r},_hideGhostForTarget=function e(){!supportCssPointerEvents&&ghostEl&&css(ghostEl,"display","none")},_unhideGhostForTarget=function e(){!supportCssPointerEvents&&ghostEl&&css(ghostEl,"display","")};documentExists&&!ChromeForAndroid&&document.addEventListener("click",function(e){if(ignoreNextClick)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ignoreNextClick=!1,!1},!0);var nearestEmptyInsertDetectEvent=function e(n){if(dragEl){n=n.touches?n.touches[0]:n;var o=_detectNearestEmptySortable(n.clientX,n.clientY);if(o){var r={};for(var u in n)n.hasOwnProperty(u)&&(r[u]=n[u]);r.target=r.rootEl=o,r.preventDefault=void 0,r.stopPropagation=void 0,o[expando]._onDragOver(r)}}},_checkOutsideTargetEl=function e(n){dragEl&&dragEl.parentNode[expando]._isOutsideThisEl(n.target)};function Sortable(e,n){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=n=_extends({},n),e[expando]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return _detectDirection(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(w,m){w.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Sortable.supportPointer!==!1&&"PointerEvent"in window&&!Safari,emptyInsertThreshold:5};PluginManager.initializePlugins(this,e,o);for(var r in o)!(r in n)&&(n[r]=o[r]);_prepareGroup(n);for(var u in this)u.charAt(0)==="_"&&typeof this[u]=="function"&&(this[u]=this[u].bind(this));this.nativeDraggable=n.forceFallback?!1:supportDraggable,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?on(e,"pointerdown",this._onTapStart):(on(e,"mousedown",this._onTapStart),on(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(on(e,"dragover",this),on(e,"dragenter",this)),sortables.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),_extends(this,AnimationStateManager())}Sortable.prototype={constructor:Sortable,_isOutsideThisEl:function e(n){!this.el.contains(n)&&n!==this.el&&(lastTarget=null)},_getDirection:function e(n,o){return typeof this.options.direction=="function"?this.options.direction.call(this,n,o,dragEl):this.options.direction},_onTapStart:function e(n){if(!!n.cancelable){var o=this,r=this.el,u=this.options,s=u.preventOnFilter,w=n.type,m=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,v=(m||n).target,g=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||v,d=u.filter;if(_saveInputCheckedState(r),!dragEl&&!(/mousedown|pointerdown/.test(w)&&n.button!==0||u.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&Safari&&v&&v.tagName.toUpperCase()==="SELECT")&&(v=closest(v,u.draggable,r,!1),!(v&&v.animated)&&lastDownEl!==v)){if(oldIndex=index(v),oldDraggableIndex=index(v,u.draggable),typeof d=="function"){if(d.call(this,n,v,this)){_dispatchEvent({sortable:o,rootEl:g,name:"filter",targetEl:v,toEl:r,fromEl:r}),pluginEvent("filter",o,{evt:n}),s&&n.cancelable&&n.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=closest(g,f.trim(),r,!1),f)return _dispatchEvent({sortable:o,rootEl:f,name:"filter",targetEl:v,fromEl:r,toEl:r}),pluginEvent("filter",o,{evt:n}),!0}),d)){s&&n.cancelable&&n.preventDefault();return}u.handle&&!closest(g,u.handle,r,!1)||this._prepareDragStart(n,m,v)}}},_prepareDragStart:function e(n,o,r){var u=this,s=u.el,w=u.options,m=s.ownerDocument,v;if(r&&!dragEl&&r.parentNode===s){var g=getRect(r);if(rootEl=s,dragEl=r,parentEl=dragEl.parentNode,nextEl=dragEl.nextSibling,lastDownEl=r,activeGroup=w.group,Sortable.dragged=dragEl,tapEvt={target:dragEl,clientX:(o||n).clientX,clientY:(o||n).clientY},tapDistanceLeft=tapEvt.clientX-g.left,tapDistanceTop=tapEvt.clientY-g.top,this._lastX=(o||n).clientX,this._lastY=(o||n).clientY,dragEl.style["will-change"]="all",v=function(){if(pluginEvent("delayEnded",u,{evt:n}),Sortable.eventCanceled){u._onDrop();return}u._disableDelayedDragEvents(),!FireFox&&u.nativeDraggable&&(dragEl.draggable=!0),u._triggerDragStart(n,o),_dispatchEvent({sortable:u,name:"choose",originalEvent:n}),toggleClass(dragEl,w.chosenClass,!0)},w.ignore.split(",").forEach(function(d){find(dragEl,d.trim(),_disableDraggable)}),on(m,"dragover",nearestEmptyInsertDetectEvent),on(m,"mousemove",nearestEmptyInsertDetectEvent),on(m,"touchmove",nearestEmptyInsertDetectEvent),on(m,"mouseup",u._onDrop),on(m,"touchend",u._onDrop),on(m,"touchcancel",u._onDrop),FireFox&&this.nativeDraggable&&(this.options.touchStartThreshold=4,dragEl.draggable=!0),pluginEvent("delayStart",this,{evt:n}),w.delay&&(!w.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(Edge||IE11OrLess))){if(Sortable.eventCanceled){this._onDrop();return}on(m,"mouseup",u._disableDelayedDrag),on(m,"touchend",u._disableDelayedDrag),on(m,"touchcancel",u._disableDelayedDrag),on(m,"mousemove",u._delayedDragTouchMoveHandler),on(m,"touchmove",u._delayedDragTouchMoveHandler),w.supportPointer&&on(m,"pointermove",u._delayedDragTouchMoveHandler),u._dragStartTimer=setTimeout(v,w.delay)}else v()}},_delayedDragTouchMoveHandler:function e(n){var o=n.touches?n.touches[0]:n;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function e(){dragEl&&_disableDraggable(dragEl),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function e(){var n=this.el.ownerDocument;off(n,"mouseup",this._disableDelayedDrag),off(n,"touchend",this._disableDelayedDrag),off(n,"touchcancel",this._disableDelayedDrag),off(n,"mousemove",this._delayedDragTouchMoveHandler),off(n,"touchmove",this._delayedDragTouchMoveHandler),off(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function e(n,o){o=o||n.pointerType=="touch"&&n,!this.nativeDraggable||o?this.options.supportPointer?on(document,"pointermove",this._onTouchMove):o?on(document,"touchmove",this._onTouchMove):on(document,"mousemove",this._onTouchMove):(on(dragEl,"dragend",this),on(rootEl,"dragstart",this._onDragStart));try{document.selection?_nextTick(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function e(n,o){if(awaitingDragStarted=!1,rootEl&&dragEl){pluginEvent("dragStarted",this,{evt:o}),this.nativeDraggable&&on(document,"dragover",_checkOutsideTargetEl);var r=this.options;!n&&toggleClass(dragEl,r.dragClass,!1),toggleClass(dragEl,r.ghostClass,!0),Sortable.active=this,n&&this._appendGhost(),_dispatchEvent({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function e(){if(touchEvt){this._lastX=touchEvt.clientX,this._lastY=touchEvt.clientY,_hideGhostForTarget();for(var n=document.elementFromPoint(touchEvt.clientX,touchEvt.clientY),o=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(touchEvt.clientX,touchEvt.clientY),n!==o);)o=n;if(dragEl.parentNode[expando]._isOutsideThisEl(n),o)do{if(o[expando]){var r=void 0;if(r=o[expando]._onDragOver({clientX:touchEvt.clientX,clientY:touchEvt.clientY,target:n,rootEl:o}),r&&!this.options.dragoverBubble)break}n=o}while(o=o.parentNode);_unhideGhostForTarget()}},_onTouchMove:function e(n){if(tapEvt){var o=this.options,r=o.fallbackTolerance,u=o.fallbackOffset,s=n.touches?n.touches[0]:n,w=ghostEl&&matrix(ghostEl,!0),m=ghostEl&&w&&w.a,v=ghostEl&&w&&w.d,g=PositionGhostAbsolutely&&ghostRelativeParent&&getRelativeScrollOffset(ghostRelativeParent),d=(s.clientX-tapEvt.clientX+u.x)/(m||1)+(g?g[0]-ghostRelativeParentInitialScroll[0]:0)/(m||1),f=(s.clientY-tapEvt.clientY+u.y)/(v||1)+(g?g[1]-ghostRelativeParentInitialScroll[1]:0)/(v||1);if(!Sortable.active&&!awaitingDragStarted){if(r&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<r)return;this._onDragStart(n,!0)}if(ghostEl){w?(w.e+=d-(lastDx||0),w.f+=f-(lastDy||0)):w={a:1,b:0,c:0,d:1,e:d,f};var y="matrix(".concat(w.a,",").concat(w.b,",").concat(w.c,",").concat(w.d,",").concat(w.e,",").concat(w.f,")");css(ghostEl,"webkitTransform",y),css(ghostEl,"mozTransform",y),css(ghostEl,"msTransform",y),css(ghostEl,"transform",y),lastDx=d,lastDy=f,touchEvt=s}n.cancelable&&n.preventDefault()}},_appendGhost:function e(){if(!ghostEl){var n=this.options.fallbackOnBody?document.body:rootEl,o=getRect(dragEl,!0,PositionGhostAbsolutely,!0,n),r=this.options;if(PositionGhostAbsolutely){for(ghostRelativeParent=n;css(ghostRelativeParent,"position")==="static"&&css(ghostRelativeParent,"transform")==="none"&&ghostRelativeParent!==document;)ghostRelativeParent=ghostRelativeParent.parentNode;ghostRelativeParent!==document.body&&ghostRelativeParent!==document.documentElement?(ghostRelativeParent===document&&(ghostRelativeParent=getWindowScrollingElement()),o.top+=ghostRelativeParent.scrollTop,o.left+=ghostRelativeParent.scrollLeft):ghostRelativeParent=getWindowScrollingElement(),ghostRelativeParentInitialScroll=getRelativeScrollOffset(ghostRelativeParent)}ghostEl=dragEl.cloneNode(!0),toggleClass(ghostEl,r.ghostClass,!1),toggleClass(ghostEl,r.fallbackClass,!0),toggleClass(ghostEl,r.dragClass,!0),css(ghostEl,"transition",""),css(ghostEl,"transform",""),css(ghostEl,"box-sizing","border-box"),css(ghostEl,"margin",0),css(ghostEl,"top",o.top),css(ghostEl,"left",o.left),css(ghostEl,"width",o.width),css(ghostEl,"height",o.height),css(ghostEl,"opacity","0.8"),css(ghostEl,"position",PositionGhostAbsolutely?"absolute":"fixed"),css(ghostEl,"zIndex","100000"),css(ghostEl,"pointerEvents","none"),Sortable.ghost=ghostEl,n.appendChild(ghostEl),css(ghostEl,"transform-origin",tapDistanceLeft/parseInt(ghostEl.style.width)*100+"% "+tapDistanceTop/parseInt(ghostEl.style.height)*100+"%")}},_onDragStart:function e(n,o){var r=this,u=n.dataTransfer,s=r.options;if(pluginEvent("dragStart",this,{evt:n}),Sortable.eventCanceled){this._onDrop();return}pluginEvent("setupClone",this),Sortable.eventCanceled||(cloneEl=clone(dragEl),cloneEl.removeAttribute("id"),cloneEl.draggable=!1,cloneEl.style["will-change"]="",this._hideClone(),toggleClass(cloneEl,this.options.chosenClass,!1),Sortable.clone=cloneEl),r.cloneId=_nextTick(function(){pluginEvent("clone",r),!Sortable.eventCanceled&&(r.options.removeCloneOnHide||rootEl.insertBefore(cloneEl,dragEl),r._hideClone(),_dispatchEvent({sortable:r,name:"clone"}))}),!o&&toggleClass(dragEl,s.dragClass,!0),o?(ignoreNextClick=!0,r._loopId=setInterval(r._emulateDragOver,50)):(off(document,"mouseup",r._onDrop),off(document,"touchend",r._onDrop),off(document,"touchcancel",r._onDrop),u&&(u.effectAllowed="move",s.setData&&s.setData.call(r,u,dragEl)),on(document,"drop",r),css(dragEl,"transform","translateZ(0)")),awaitingDragStarted=!0,r._dragStartId=_nextTick(r._dragStarted.bind(r,o,n)),on(document,"selectstart",r),moved=!0,Safari&&css(document.body,"user-select","none")},_onDragOver:function e(n){var o=this.el,r=n.target,u,s,w,m=this.options,v=m.group,g=Sortable.active,d=activeGroup===v,f=m.sort,y=putSortable||g,x,k=this,P=!1;if(_silent)return;function S(X,H){pluginEvent(X,k,_objectSpread2({evt:n,isOwner:d,axis:x?"vertical":"horizontal",revert:w,dragRect:u,targetRect:s,canSort:f,fromSortable:y,target:r,completed:M,onMove:function(te,Q){return _onMove(rootEl,o,dragEl,u,te,getRect(te),n,Q)},changed:T},H))}function E(){S("dragOverAnimationCapture"),k.captureAnimationState(),k!==y&&y.captureAnimationState()}function M(X){return S("dragOverCompleted",{insertion:X}),X&&(d?g._hideClone():g._showClone(k),k!==y&&(toggleClass(dragEl,putSortable?putSortable.options.ghostClass:g.options.ghostClass,!1),toggleClass(dragEl,m.ghostClass,!0)),putSortable!==k&&k!==Sortable.active?putSortable=k:k===Sortable.active&&putSortable&&(putSortable=null),y===k&&(k._ignoreWhileAnimating=r),k.animateAll(function(){S("dragOverAnimationComplete"),k._ignoreWhileAnimating=null}),k!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(r===dragEl&&!dragEl.animated||r===o&&!r.animated)&&(lastTarget=null),!m.dragoverBubble&&!n.rootEl&&r!==document&&(dragEl.parentNode[expando]._isOutsideThisEl(n.target),!X&&nearestEmptyInsertDetectEvent(n)),!m.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),P=!0}function T(){newIndex=index(dragEl),newDraggableIndex=index(dragEl,m.draggable),_dispatchEvent({sortable:k,name:"change",toEl:o,newIndex,newDraggableIndex,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),r=closest(r,m.draggable,o,!0),S("dragOver"),Sortable.eventCanceled)return P;if(dragEl.contains(n.target)||r.animated&&r.animatingX&&r.animatingY||k._ignoreWhileAnimating===r)return M(!1);if(ignoreNextClick=!1,g&&!m.disabled&&(d?f||(w=parentEl!==rootEl):putSortable===this||(this.lastPutMode=activeGroup.checkPull(this,g,dragEl,n))&&v.checkPut(this,g,dragEl,n))){if(x=this._getDirection(n,r)==="vertical",u=getRect(dragEl),S("dragOverValid"),Sortable.eventCanceled)return P;if(w)return parentEl=rootEl,E(),this._hideClone(),S("revert"),Sortable.eventCanceled||(nextEl?rootEl.insertBefore(dragEl,nextEl):rootEl.appendChild(dragEl)),M(!0);var D=lastChild(o,m.draggable);if(!D||_ghostIsLast(n,x,this)&&!D.animated){if(D===dragEl)return M(!1);if(D&&o===n.target&&(r=D),r&&(s=getRect(r)),_onMove(rootEl,o,dragEl,u,r,s,n,!!r)!==!1)return E(),D&&D.nextSibling?o.insertBefore(dragEl,D.nextSibling):o.appendChild(dragEl),parentEl=o,T(),M(!0)}else if(D&&_ghostIsFirst(n,x,this)){var N=getChild(o,0,m,!0);if(N===dragEl)return M(!1);if(r=N,s=getRect(r),_onMove(rootEl,o,dragEl,u,r,s,n,!1)!==!1)return E(),o.insertBefore(dragEl,N),parentEl=o,T(),M(!0)}else if(r.parentNode===o){s=getRect(r);var I=0,O,F=dragEl.parentNode!==o,q=!_dragElInRowColumn(dragEl.animated&&dragEl.toRect||u,r.animated&&r.toRect||s,x),Y=x?"top":"left",_e=isScrolledPast(r,"top","top")||isScrolledPast(dragEl,"top","top"),ne=_e?_e.scrollTop:void 0;lastTarget!==r&&(O=s[Y],pastFirstInvertThresh=!1,isCircumstantialInvert=!q&&m.invertSwap||F),I=_getSwapDirection(n,r,s,x,q?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,isCircumstantialInvert,lastTarget===r);var ve;if(I!==0){var J=index(dragEl);do J-=I,ve=parentEl.children[J];while(ve&&(css(ve,"display")==="none"||ve===ghostEl))}if(I===0||ve===r)return M(!1);lastTarget=r,lastDirection=I;var fe=r.nextElementSibling,Z=!1;Z=I===1;var j=_onMove(rootEl,o,dragEl,u,r,s,n,Z);if(j!==!1)return(j===1||j===-1)&&(Z=j===1),_silent=!0,setTimeout(_unsilent,30),E(),Z&&!fe?o.appendChild(dragEl):r.parentNode.insertBefore(dragEl,Z?fe:r),_e&&scrollBy(_e,0,ne-_e.scrollTop),parentEl=dragEl.parentNode,O!==void 0&&!isCircumstantialInvert&&(targetMoveDistance=Math.abs(O-getRect(r)[Y])),T(),M(!0)}if(o.contains(dragEl))return M(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function e(){off(document,"mousemove",this._onTouchMove),off(document,"touchmove",this._onTouchMove),off(document,"pointermove",this._onTouchMove),off(document,"dragover",nearestEmptyInsertDetectEvent),off(document,"mousemove",nearestEmptyInsertDetectEvent),off(document,"touchmove",nearestEmptyInsertDetectEvent)},_offUpEvents:function e(){var n=this.el.ownerDocument;off(n,"mouseup",this._onDrop),off(n,"touchend",this._onDrop),off(n,"pointerup",this._onDrop),off(n,"touchcancel",this._onDrop),off(document,"selectstart",this)},_onDrop:function e(n){var o=this.el,r=this.options;if(newIndex=index(dragEl),newDraggableIndex=index(dragEl,r.draggable),pluginEvent("drop",this,{evt:n}),parentEl=dragEl&&dragEl.parentNode,newIndex=index(dragEl),newDraggableIndex=index(dragEl,r.draggable),Sortable.eventCanceled){this._nulling();return}awaitingDragStarted=!1,isCircumstantialInvert=!1,pastFirstInvertThresh=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_cancelNextTick(this.cloneId),_cancelNextTick(this._dragStartId),this.nativeDraggable&&(off(document,"drop",this),off(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Safari&&css(document.body,"user-select",""),css(dragEl,"transform",""),n&&(moved&&(n.cancelable&&n.preventDefault(),!r.dropBubble&&n.stopPropagation()),ghostEl&&ghostEl.parentNode&&ghostEl.parentNode.removeChild(ghostEl),(rootEl===parentEl||putSortable&&putSortable.lastPutMode!=="clone")&&cloneEl&&cloneEl.parentNode&&cloneEl.parentNode.removeChild(cloneEl),dragEl&&(this.nativeDraggable&&off(dragEl,"dragend",this),_disableDraggable(dragEl),dragEl.style["will-change"]="",moved&&!awaitingDragStarted&&toggleClass(dragEl,putSortable?putSortable.options.ghostClass:this.options.ghostClass,!1),toggleClass(dragEl,this.options.chosenClass,!1),_dispatchEvent({sortable:this,name:"unchoose",toEl:parentEl,newIndex:null,newDraggableIndex:null,originalEvent:n}),rootEl!==parentEl?(newIndex>=0&&(_dispatchEvent({rootEl:parentEl,name:"add",toEl:parentEl,fromEl:rootEl,originalEvent:n}),_dispatchEvent({sortable:this,name:"remove",toEl:parentEl,originalEvent:n}),_dispatchEvent({rootEl:parentEl,name:"sort",toEl:parentEl,fromEl:rootEl,originalEvent:n}),_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:n})),putSortable&&putSortable.save()):newIndex!==oldIndex&&newIndex>=0&&(_dispatchEvent({sortable:this,name:"update",toEl:parentEl,originalEvent:n}),_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:n})),Sortable.active&&((newIndex==null||newIndex===-1)&&(newIndex=oldIndex,newDraggableIndex=oldDraggableIndex),_dispatchEvent({sortable:this,name:"end",toEl:parentEl,originalEvent:n}),this.save()))),this._nulling()},_nulling:function e(){pluginEvent("nulling",this),rootEl=dragEl=parentEl=ghostEl=nextEl=cloneEl=lastDownEl=cloneHidden=tapEvt=touchEvt=moved=newIndex=newDraggableIndex=oldIndex=oldDraggableIndex=lastTarget=lastDirection=putSortable=activeGroup=Sortable.dragged=Sortable.ghost=Sortable.clone=Sortable.active=null,savedInputChecked.forEach(function(n){n.checked=!0}),savedInputChecked.length=lastDx=lastDy=0},handleEvent:function e(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":dragEl&&(this._onDragOver(n),_globalDragOver(n));break;case"selectstart":n.preventDefault();break}},toArray:function e(){for(var n=[],o,r=this.el.children,u=0,s=r.length,w=this.options;u<s;u++)o=r[u],closest(o,w.draggable,this.el,!1)&&n.push(o.getAttribute(w.dataIdAttr)||_generateId(o));return n},sort:function e(n,o){var r={},u=this.el;this.toArray().forEach(function(s,w){var m=u.children[w];closest(m,this.options.draggable,u,!1)&&(r[s]=m)},this),o&&this.captureAnimationState(),n.forEach(function(s){r[s]&&(u.removeChild(r[s]),u.appendChild(r[s]))}),o&&this.animateAll()},save:function e(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function e(n,o){return closest(n,o||this.options.draggable,this.el,!1)},option:function e(n,o){var r=this.options;if(o===void 0)return r[n];var u=PluginManager.modifyOption(this,n,o);typeof u<"u"?r[n]=u:r[n]=o,n==="group"&&_prepareGroup(r)},destroy:function e(){pluginEvent("destroy",this);var n=this.el;n[expando]=null,off(n,"mousedown",this._onTapStart),off(n,"touchstart",this._onTapStart),off(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(off(n,"dragover",this),off(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),sortables.splice(sortables.indexOf(this.el),1),this.el=n=null},_hideClone:function e(){if(!cloneHidden){if(pluginEvent("hideClone",this),Sortable.eventCanceled)return;css(cloneEl,"display","none"),this.options.removeCloneOnHide&&cloneEl.parentNode&&cloneEl.parentNode.removeChild(cloneEl),cloneHidden=!0}},_showClone:function e(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(cloneHidden){if(pluginEvent("showClone",this),Sortable.eventCanceled)return;dragEl.parentNode==rootEl&&!this.options.group.revertClone?rootEl.insertBefore(cloneEl,dragEl):nextEl?rootEl.insertBefore(cloneEl,nextEl):rootEl.appendChild(cloneEl),this.options.group.revertClone&&this.animate(dragEl,cloneEl),css(cloneEl,"display",""),cloneHidden=!1}}};function _globalDragOver(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function _onMove(e,n,o,r,u,s,w,m){var v,g=e[expando],d=g.options.onMove,f;return window.CustomEvent&&!IE11OrLess&&!Edge?v=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent("move",!0,!0)),v.to=n,v.from=e,v.dragged=o,v.draggedRect=r,v.related=u||n,v.relatedRect=s||getRect(n),v.willInsertAfter=m,v.originalEvent=w,e.dispatchEvent(v),d&&(f=d.call(g,v,w)),f}function _disableDraggable(e){e.draggable=!1}function _unsilent(){_silent=!1}function _ghostIsFirst(e,n,o){var r=getRect(getChild(o.el,0,o.options,!0)),u=getChildContainingRectFromElement(o.el,o.options,ghostEl),s=10;return n?e.clientX<u.left-s||e.clientY<r.top&&e.clientX<r.right:e.clientY<u.top-s||e.clientY<r.bottom&&e.clientX<r.left}function _ghostIsLast(e,n,o){var r=getRect(lastChild(o.el,o.options.draggable)),u=getChildContainingRectFromElement(o.el,o.options,ghostEl),s=10;return n?e.clientX>u.right+s||e.clientY>r.bottom&&e.clientX>r.left:e.clientY>u.bottom+s||e.clientX>r.right&&e.clientY>r.top}function _getSwapDirection(e,n,o,r,u,s,w,m){var v=r?e.clientY:e.clientX,g=r?o.height:o.width,d=r?o.top:o.left,f=r?o.bottom:o.right,y=!1;if(!w){if(m&&targetMoveDistance<g*u){if(!pastFirstInvertThresh&&(lastDirection===1?v>d+g*s/2:v<f-g*s/2)&&(pastFirstInvertThresh=!0),pastFirstInvertThresh)y=!0;else if(lastDirection===1?v<d+targetMoveDistance:v>f-targetMoveDistance)return-lastDirection}else if(v>d+g*(1-u)/2&&v<f-g*(1-u)/2)return _getInsertDirection(n)}return y=y||w,y&&(v<d+g*s/2||v>f-g*s/2)?v>d+g/2?1:-1:0}function _getInsertDirection(e){return index(dragEl)<index(e)?1:-1}function _generateId(e){for(var n=e.tagName+e.className+e.src+e.href+e.textContent,o=n.length,r=0;o--;)r+=n.charCodeAt(o);return r.toString(36)}function _saveInputCheckedState(e){savedInputChecked.length=0;for(var n=e.getElementsByTagName("input"),o=n.length;o--;){var r=n[o];r.checked&&savedInputChecked.push(r)}}function _nextTick(e){return setTimeout(e,0)}function _cancelNextTick(e){return clearTimeout(e)}documentExists&&on(document,"touchmove",function(e){(Sortable.active||awaitingDragStarted)&&e.cancelable&&e.preventDefault()});Sortable.utils={on,off,css,find,is:function e(n,o){return!!closest(n,o,n,!1)},extend,throttle,closest,toggleClass,clone,index,nextTick:_nextTick,cancelNextTick:_cancelNextTick,detectDirection:_detectDirection,getChild};Sortable.get=function(e){return e[expando]};Sortable.mount=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];n[0].constructor===Array&&(n=n[0]),n.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Sortable.utils=_objectSpread2(_objectSpread2({},Sortable.utils),r.utils)),PluginManager.mount(r)})};Sortable.create=function(e,n){return new Sortable(e,n)};Sortable.version=version;var autoScrolls=[],scrollEl,scrollRootEl,scrolling=!1,lastAutoScrollX,lastAutoScrollY,touchEvt$1,pointerElemChangedInterval;function AutoScrollPlugin(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this))}return e.prototype={dragStarted:function(o){var r=o.originalEvent;this.sortable.nativeDraggable?on(document,"dragover",this._handleAutoScroll):this.options.supportPointer?on(document,"pointermove",this._handleFallbackAutoScroll):r.touches?on(document,"touchmove",this._handleFallbackAutoScroll):on(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var r=o.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?off(document,"dragover",this._handleAutoScroll):(off(document,"pointermove",this._handleFallbackAutoScroll),off(document,"touchmove",this._handleFallbackAutoScroll),off(document,"mousemove",this._handleFallbackAutoScroll)),clearPointerElemChangedInterval(),clearAutoScrolls(),cancelThrottle()},nulling:function(){touchEvt$1=scrollRootEl=scrollEl=scrolling=pointerElemChangedInterval=lastAutoScrollX=lastAutoScrollY=null,autoScrolls.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,r){var u=this,s=(o.touches?o.touches[0]:o).clientX,w=(o.touches?o.touches[0]:o).clientY,m=document.elementFromPoint(s,w);if(touchEvt$1=o,r||this.options.forceAutoScrollFallback||Edge||IE11OrLess||Safari){autoScroll(o,this.options,m,r);var v=getParentAutoScrollElement(m,!0);scrolling&&(!pointerElemChangedInterval||s!==lastAutoScrollX||w!==lastAutoScrollY)&&(pointerElemChangedInterval&&clearPointerElemChangedInterval(),pointerElemChangedInterval=setInterval(function(){var g=getParentAutoScrollElement(document.elementFromPoint(s,w),!0);g!==v&&(v=g,clearAutoScrolls()),autoScroll(o,u.options,g,r)},10),lastAutoScrollX=s,lastAutoScrollY=w)}else{if(!this.options.bubbleScroll||getParentAutoScrollElement(m,!0)===getWindowScrollingElement()){clearAutoScrolls();return}autoScroll(o,this.options,getParentAutoScrollElement(m,!1),!1)}}},_extends(e,{pluginName:"scroll",initializeByDefault:!0})}function clearAutoScrolls(){autoScrolls.forEach(function(e){clearInterval(e.pid)}),autoScrolls=[]}function clearPointerElemChangedInterval(){clearInterval(pointerElemChangedInterval)}var autoScroll=throttle(function(e,n,o,r){if(!!n.scroll){var u=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,w=n.scrollSensitivity,m=n.scrollSpeed,v=getWindowScrollingElement(),g=!1,d;scrollRootEl!==o&&(scrollRootEl=o,clearAutoScrolls(),scrollEl=n.scroll,d=n.scrollFn,scrollEl===!0&&(scrollEl=getParentAutoScrollElement(o,!0)));var f=0,y=scrollEl;do{var x=y,k=getRect(x),P=k.top,S=k.bottom,E=k.left,M=k.right,T=k.width,D=k.height,N=void 0,I=void 0,O=x.scrollWidth,F=x.scrollHeight,q=css(x),Y=x.scrollLeft,_e=x.scrollTop;x===v?(N=T<O&&(q.overflowX==="auto"||q.overflowX==="scroll"||q.overflowX==="visible"),I=D<F&&(q.overflowY==="auto"||q.overflowY==="scroll"||q.overflowY==="visible")):(N=T<O&&(q.overflowX==="auto"||q.overflowX==="scroll"),I=D<F&&(q.overflowY==="auto"||q.overflowY==="scroll"));var ne=N&&(Math.abs(M-u)<=w&&Y+T<O)-(Math.abs(E-u)<=w&&!!Y),ve=I&&(Math.abs(S-s)<=w&&_e+D<F)-(Math.abs(P-s)<=w&&!!_e);if(!autoScrolls[f])for(var J=0;J<=f;J++)autoScrolls[J]||(autoScrolls[J]={});(autoScrolls[f].vx!=ne||autoScrolls[f].vy!=ve||autoScrolls[f].el!==x)&&(autoScrolls[f].el=x,autoScrolls[f].vx=ne,autoScrolls[f].vy=ve,clearInterval(autoScrolls[f].pid),(ne!=0||ve!=0)&&(g=!0,autoScrolls[f].pid=setInterval(function(){r&&this.layer===0&&Sortable.active._onTouchMove(touchEvt$1);var fe=autoScrolls[this.layer].vy?autoScrolls[this.layer].vy*m:0,Z=autoScrolls[this.layer].vx?autoScrolls[this.layer].vx*m:0;typeof d=="function"&&d.call(Sortable.dragged.parentNode[expando],Z,fe,e,touchEvt$1,autoScrolls[this.layer].el)!=="continue"||scrollBy(autoScrolls[this.layer].el,Z,fe)}.bind({layer:f}),24))),f++}while(n.bubbleScroll&&y!==v&&(y=getParentAutoScrollElement(y,!1)));scrolling=g}},30),drop=function e(n){var o=n.originalEvent,r=n.putSortable,u=n.dragEl,s=n.activeSortable,w=n.dispatchSortableEvent,m=n.hideGhostForTarget,v=n.unhideGhostForTarget;if(!!o){var g=r||s;m();var d=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,f=document.elementFromPoint(d.clientX,d.clientY);v(),g&&!g.el.contains(f)&&(w("spill"),this.onSpill({dragEl:u,putSortable:r}))}};function Revert(){}Revert.prototype={startIndex:null,dragStart:function e(n){var o=n.oldDraggableIndex;this.startIndex=o},onSpill:function e(n){var o=n.dragEl,r=n.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var u=getChild(this.sortable.el,this.startIndex,this.options);u?this.sortable.el.insertBefore(o,u):this.sortable.el.appendChild(o),this.sortable.animateAll(),r&&r.animateAll()},drop};_extends(Revert,{pluginName:"revertOnSpill"});function Remove(){}Remove.prototype={onSpill:function e(n){var o=n.dragEl,r=n.putSortable,u=r||this.sortable;u.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),u.animateAll()},drop};_extends(Remove,{pluginName:"removeOnSpill"});var multiDragElements=[],multiDragClones=[],lastMultiDragSelect,multiDragSortable,initialFolding=!1,folding=!1,dragStarted=!1,dragEl$1,clonesFromRect,clonesHidden;function MultiDragPlugin(){function e(n){for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));n.options.avoidImplicitDeselect||(n.options.supportPointer?on(document,"pointerup",this._deselectMultiDrag):(on(document,"mouseup",this._deselectMultiDrag),on(document,"touchend",this._deselectMultiDrag))),on(document,"keydown",this._checkKeyDown),on(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(u,s){var w="";multiDragElements.length&&multiDragSortable===n?multiDragElements.forEach(function(m,v){w+=(v?", ":"")+m.textContent}):w=s.textContent,u.setData("Text",w)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(o){var r=o.dragEl;dragEl$1=r},delayEnded:function(){this.isMultiDrag=~multiDragElements.indexOf(dragEl$1)},setupClone:function(o){var r=o.sortable,u=o.cancel;if(!!this.isMultiDrag){for(var s=0;s<multiDragElements.length;s++)multiDragClones.push(clone(multiDragElements[s])),multiDragClones[s].sortableIndex=multiDragElements[s].sortableIndex,multiDragClones[s].draggable=!1,multiDragClones[s].style["will-change"]="",toggleClass(multiDragClones[s],this.options.selectedClass,!1),multiDragElements[s]===dragEl$1&&toggleClass(multiDragClones[s],this.options.chosenClass,!1);r._hideClone(),u()}},clone:function(o){var r=o.sortable,u=o.rootEl,s=o.dispatchSortableEvent,w=o.cancel;!this.isMultiDrag||this.options.removeCloneOnHide||multiDragElements.length&&multiDragSortable===r&&(insertMultiDragClones(!0,u),s("clone"),w())},showClone:function(o){var r=o.cloneNowShown,u=o.rootEl,s=o.cancel;!this.isMultiDrag||(insertMultiDragClones(!1,u),multiDragClones.forEach(function(w){css(w,"display","")}),r(),clonesHidden=!1,s())},hideClone:function(o){var r=this;o.sortable;var u=o.cloneNowHidden,s=o.cancel;!this.isMultiDrag||(multiDragClones.forEach(function(w){css(w,"display","none"),r.options.removeCloneOnHide&&w.parentNode&&w.parentNode.removeChild(w)}),u(),clonesHidden=!0,s())},dragStartGlobal:function(o){o.sortable,!this.isMultiDrag&&multiDragSortable&&multiDragSortable.multiDrag._deselectMultiDrag(),multiDragElements.forEach(function(r){r.sortableIndex=index(r)}),multiDragElements=multiDragElements.sort(function(r,u){return r.sortableIndex-u.sortableIndex}),dragStarted=!0},dragStarted:function(o){var r=this,u=o.sortable;if(!!this.isMultiDrag){if(this.options.sort&&(u.captureAnimationState(),this.options.animation)){multiDragElements.forEach(function(w){w!==dragEl$1&&css(w,"position","absolute")});var s=getRect(dragEl$1,!1,!0,!0);multiDragElements.forEach(function(w){w!==dragEl$1&&setRect(w,s)}),folding=!0,initialFolding=!0}u.animateAll(function(){folding=!1,initialFolding=!1,r.options.animation&&multiDragElements.forEach(function(w){unsetRect(w)}),r.options.sort&&removeMultiDragElements()})}},dragOver:function(o){var r=o.target,u=o.completed,s=o.cancel;folding&&~multiDragElements.indexOf(r)&&(u(!1),s())},revert:function(o){var r=o.fromSortable,u=o.rootEl,s=o.sortable,w=o.dragRect;multiDragElements.length>1&&(multiDragElements.forEach(function(m){s.addAnimationState({target:m,rect:folding?getRect(m):w}),unsetRect(m),m.fromRect=w,r.removeAnimationState(m)}),folding=!1,insertMultiDragElements(!this.options.removeCloneOnHide,u))},dragOverCompleted:function(o){var r=o.sortable,u=o.isOwner,s=o.insertion,w=o.activeSortable,m=o.parentEl,v=o.putSortable,g=this.options;if(s){if(u&&w._hideClone(),initialFolding=!1,g.animation&&multiDragElements.length>1&&(folding||!u&&!w.options.sort&&!v)){var d=getRect(dragEl$1,!1,!0,!0);multiDragElements.forEach(function(y){y!==dragEl$1&&(setRect(y,d),m.appendChild(y))}),folding=!0}if(!u)if(folding||removeMultiDragElements(),multiDragElements.length>1){var f=clonesHidden;w._showClone(r),w.options.animation&&!clonesHidden&&f&&multiDragClones.forEach(function(y){w.addAnimationState({target:y,rect:clonesFromRect}),y.fromRect=clonesFromRect,y.thisAnimationDuration=null})}else w._showClone(r)}},dragOverAnimationCapture:function(o){var r=o.dragRect,u=o.isOwner,s=o.activeSortable;if(multiDragElements.forEach(function(m){m.thisAnimationDuration=null}),s.options.animation&&!u&&s.multiDrag.isMultiDrag){clonesFromRect=_extends({},r);var w=matrix(dragEl$1,!0);clonesFromRect.top-=w.f,clonesFromRect.left-=w.e}},dragOverAnimationComplete:function(){folding&&(folding=!1,removeMultiDragElements())},drop:function(o){var r=o.originalEvent,u=o.rootEl,s=o.parentEl,w=o.sortable,m=o.dispatchSortableEvent,v=o.oldIndex,g=o.putSortable,d=g||this.sortable;if(!!r){var f=this.options,y=s.children;if(!dragStarted)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),toggleClass(dragEl$1,f.selectedClass,!~multiDragElements.indexOf(dragEl$1)),~multiDragElements.indexOf(dragEl$1))multiDragElements.splice(multiDragElements.indexOf(dragEl$1),1),lastMultiDragSelect=null,dispatchEvent({sortable:w,rootEl:u,name:"deselect",targetEl:dragEl$1,originalEvent:r});else{if(multiDragElements.push(dragEl$1),dispatchEvent({sortable:w,rootEl:u,name:"select",targetEl:dragEl$1,originalEvent:r}),r.shiftKey&&lastMultiDragSelect&&w.el.contains(lastMultiDragSelect)){var x=index(lastMultiDragSelect),k=index(dragEl$1);if(~x&&~k&&x!==k){var P,S;for(k>x?(S=x,P=k):(S=k,P=x+1);S<P;S++)~multiDragElements.indexOf(y[S])||(toggleClass(y[S],f.selectedClass,!0),multiDragElements.push(y[S]),dispatchEvent({sortable:w,rootEl:u,name:"select",targetEl:y[S],originalEvent:r}))}}else lastMultiDragSelect=dragEl$1;multiDragSortable=d}if(dragStarted&&this.isMultiDrag){if(folding=!1,(s[expando].options.sort||s!==u)&&multiDragElements.length>1){var E=getRect(dragEl$1),M=index(dragEl$1,":not(."+this.options.selectedClass+")");if(!initialFolding&&f.animation&&(dragEl$1.thisAnimationDuration=null),d.captureAnimationState(),!initialFolding&&(f.animation&&(dragEl$1.fromRect=E,multiDragElements.forEach(function(D){if(D.thisAnimationDuration=null,D!==dragEl$1){var N=folding?getRect(D):E;D.fromRect=N,d.addAnimationState({target:D,rect:N})}})),removeMultiDragElements(),multiDragElements.forEach(function(D){y[M]?s.insertBefore(D,y[M]):s.appendChild(D),M++}),v===index(dragEl$1))){var T=!1;multiDragElements.forEach(function(D){if(D.sortableIndex!==index(D)){T=!0;return}}),T&&(m("update"),m("sort"))}multiDragElements.forEach(function(D){unsetRect(D)}),d.animateAll()}multiDragSortable=d}(u===s||g&&g.lastPutMode!=="clone")&&multiDragClones.forEach(function(D){D.parentNode&&D.parentNode.removeChild(D)})}},nullingGlobal:function(){this.isMultiDrag=dragStarted=!1,multiDragClones.length=0},destroyGlobal:function(){this._deselectMultiDrag(),off(document,"pointerup",this._deselectMultiDrag),off(document,"mouseup",this._deselectMultiDrag),off(document,"touchend",this._deselectMultiDrag),off(document,"keydown",this._checkKeyDown),off(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(o){if(!(typeof dragStarted<"u"&&dragStarted)&&multiDragSortable===this.sortable&&!(o&&closest(o.target,this.options.draggable,this.sortable.el,!1))&&!(o&&o.button!==0))for(;multiDragElements.length;){var r=multiDragElements[0];toggleClass(r,this.options.selectedClass,!1),multiDragElements.shift(),dispatchEvent({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r,originalEvent:o})}},_checkKeyDown:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},_extends(e,{pluginName:"multiDrag",utils:{select:function(o){var r=o.parentNode[expando];!r||!r.options.multiDrag||~multiDragElements.indexOf(o)||(multiDragSortable&&multiDragSortable!==r&&(multiDragSortable.multiDrag._deselectMultiDrag(),multiDragSortable=r),toggleClass(o,r.options.selectedClass,!0),multiDragElements.push(o))},deselect:function(o){var r=o.parentNode[expando],u=multiDragElements.indexOf(o);!r||!r.options.multiDrag||!~u||(toggleClass(o,r.options.selectedClass,!1),multiDragElements.splice(u,1))}},eventProperties:function(){var o=this,r=[],u=[];return multiDragElements.forEach(function(s){r.push({multiDragElement:s,index:s.sortableIndex});var w;folding&&s!==dragEl$1?w=-1:folding?w=index(s,":not(."+o.options.selectedClass+")"):w=index(s),u.push({multiDragElement:s,index:w})}),{items:_toConsumableArray(multiDragElements),clones:[].concat(multiDragClones),oldIndicies:r,newIndicies:u}},optionListeners:{multiDragKey:function(o){return o=o.toLowerCase(),o==="ctrl"?o="Control":o.length>1&&(o=o.charAt(0).toUpperCase()+o.substr(1)),o}}})}function insertMultiDragElements(e,n){multiDragElements.forEach(function(o,r){var u=n.children[o.sortableIndex+(e?Number(r):0)];u?n.insertBefore(o,u):n.appendChild(o)})}function insertMultiDragClones(e,n){multiDragClones.forEach(function(o,r){var u=n.children[o.sortableIndex+(e?Number(r):0)];u?n.insertBefore(o,u):n.appendChild(o)})}function removeMultiDragElements(){multiDragElements.forEach(function(e){e!==dragEl$1&&e.parentNode&&e.parentNode.removeChild(e)})}Sortable.mount(new AutoScrollPlugin);Sortable.mount(Remove,Revert);const index_vue_vue_type_style_index_0_lang="",_hoisted_1={class:"loading"},_hoisted_2={class:"error-dialog"},_hoisted_3={class:"close-btn"},_hoisted_4={class:"fail-logo"},_hoisted_5={class:"text"},_hoisted_6={class:"mask active"},_hoisted_7=createBaseVNode("div",{id:"printContainer"},null,-1),_sfc_main$1={__name:"index",async setup(e){let n,o;[n,o]=withAsyncContext(()=>i18nextPromise),await n,o(),Sortable.mount(new MultiDragPlugin);const r=useViewerStore(),u=useDocumentStore(),s=computed(()=>r.getThemeMode),w=computed(()=>r.getDownloading),m=computed(()=>r.getDownloadError),v=computed(()=>r.isElementOpen("signCreatePanel")),g=computed(()=>r.isElementOpen("digitalSignCreatePanel")),d=computed(()=>r.getPopoverChanged),f=computed(()=>r.getToolMode);computed(()=>r.getScale);const y=computed(()=>r.isElementOpen("createCustomStampDialog"));computed(()=>r.getActiveElementTab("leftPanel"));const x=getCurrentInstance().appContext.app.config.globalProperties;provide("themeMode",s),initDocument({$t:x.$t}),defineWebViewerInstanceUIAPIs();const k=async D=>{if(!D)return;D.autoJumpNextSign=!0,"isAnnotationPopup"in D&&r.toggleAnnotationPopup(D.isAnnotationPopup),r.setUpload(!0),r.setUploadLoading(!0),await core.initConfig(D),D.renderLayerPermission||r.setDisabledElements("layers");const N=D&&D.webviewerServer?D.webviewerServer:"Standalone";r.setWebviewerMode(N),D.autoJumpNextSign&&u.setAutoJumpNextSign(!0),D.disableDigitalSignature&&u.setDisableDigitalSignature(D.disableDigitalSignature),D.disableElectronicSignature&&u.setDisableElectronicSignature(D.disableElectronicSignature)};[n,o]=withAsyncContext(()=>loadConfig(k)),await n,o();const P=!getHashParameters("header",!0),S=getHashParameters("css",null);if(S){const D=document.createElement("link");D.rel="stylesheet",D.type="text/css",D.href=S,document.getElementsByTagName("head")[0].appendChild(D)}P&&r.setDisabledElements("header");const E=computed(()=>r.getDisabledElements("header"));window.instance.changeFile=()=>{document.getElementById("fileInput").click(),(v.value||g.value)&&(r.closeElement("signCreatePanel"),r.closeElement("digitalSignCreatePanel"),r.setActiveToolMode("view")),d.value||r.setPopoverChanged(!0),f.value==="document"&&core.saveDocumentEdit("common.actions.cancel")};const M=()=>{r.setDownloadError("")},T=ref();return ref(1),onMounted(()=>{window.parent.postMessage({type:"viewerLoaded",docId:parseInt(getHashParameters("docId"),10)},"*")}),(D,N)=>{const I=_sfc_main$2,O=_sfc_main$19,F=_sfc_main$1K,q=_sfc_main$35,Y=_sfc_main$3d,_e=_sfc_main$3w,ne=_sfc_main$3D,ve=_sfc_main$3L,J=_sfc_main$3M,fe=_sfc_main$3O,Z=__unplugin_components_10$6,j=_sfc_main$3$,X=_sfc_main$4k,H=__unplugin_components_13$2,U=__unplugin_components_14$2,te=_sfc_main$4C,Q=__unplugin_components_16$1,re=_sfc_main$4o,Pe=_sfc_main$4z,be=__unplugin_components_19$1;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{id:"outerContainer",class:normalizeClass(["app",{dark:s.value==="dark"}])},[withDirectives(createBaseVNode("div",null,[createVNode(I)],512),[[vShow,!E.value]]),createBaseVNode("div",{class:"content",ref_key:"contentRef",ref:T},[createVNode(O,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(F,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(q),f.value==="document"?(openBlock(),createBlock(Y,{key:0,Sortable:unref(Sortable)},null,8,["Sortable"])):createCommentVNode("",!0),createVNode(_e,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(ne,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(ve,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(J,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(fe,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(Z,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(j,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"]),createVNode(X,{isHeaderDisabled:E.value},null,8,["isHeaderDisabled"])],512),createBaseVNode("div",{class:normalizeClass(["mask",{active:w.value||m.value!==""}])},[withDirectives(createBaseVNode("div",_hoisted_1,[createVNode(H)],512),[[vShow,w.value]]),withDirectives(createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(te,{onClick:M},{default:withCtx(()=>[createVNode(U)]),_:1})]),createBaseVNode("div",_hoisted_4,[createVNode(Q)]),createBaseVNode("div",_hoisted_5,toDisplayString(m.value)+" failed",1),createBaseVNode("div",{class:"confirm-btn",onClick:M},"OK")],512),[[vShow,m.value!==""]])],2),withDirectives(createBaseVNode("div",_hoisted_6,[createVNode(re)],512),[[vShow,v.value]]),y.value?(openBlock(),createBlock(Pe,{key:0})):createCommentVNode("",!0)],2),_hoisted_7,createVNode(be)],64)}}},_sfc_main={__name:"Suspenser",setup(e){return(n,o)=>(openBlock(),createBlock(Suspense,null,{default:withCtx(()=>[createVNode(_sfc_main$1)]),_:1}))}},store=createPinia();function setupStore(e){e.use(store)}const main="",app=createApp(_sfc_main);setupStore(app);i18n(createApp(_sfc_main)).mount("#app");export{commonjsGlobal as c};
