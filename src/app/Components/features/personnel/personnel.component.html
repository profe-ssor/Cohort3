  <div class="personnel">
      <div class="personnel-header">
        <div class="header-content">
          <h1 class="page-title">NSS Personnel Management</h1>
          <p class="page-subtitle">Manage and monitor your assigned National Service personnel</p>
        </div>
        <div class="header-actions">
          <button class="btn btn-secondary">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"></path>
            </svg>
            Filter
          </button>
          <button class="btn btn-secondary">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            Export List
          </button>
          <button class="btn btn-primary">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
            </svg>
            Send Group Message
          </button>
        </div>
      </div>

      <div class="personnel-stats">
        <div class="stat-card active">
          <div class="stat-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
          </div>
          <div class="stat-content">
            <div class="stat-value">{{ activeCount }}</div>
            <div class="stat-label">Active Personnel</div>
          </div>
        </div>

        <div class="stat-card excellent">
          <div class="stat-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
            </svg>
          </div>
          <div class="stat-content">
            <div class="stat-value">{{ excellentPerformers }}</div>
            <div class="stat-label">Excellent Performers</div>
          </div>
        </div>

        <div class="stat-card pending">
          <div class="stat-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <div class="stat-content">
            <div class="stat-value">{{ totalPendingSubmissions }}</div>
            <div class="stat-label">Pending Submissions</div>
          </div>
        </div>

        <div class="stat-card needs-attention">
          <div class="stat-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
          <div class="stat-content">
            <div class="stat-value">{{ needsAttentionCount }}</div>
            <div class="stat-label">Needs Attention</div>
          </div>
        </div>
      </div>

      <div class="personnel-content">
        <div class="filters-section">
          <div class="filters-row">
            <div class="filter-group">
              <label class="filter-label">Status</label>
              <select class="form-control" [ngModel]="selectedStatus()" (ngModelChange)="selectedStatus.set($event); applyFilters()">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
                <option value="on_leave">On Leave</option>
                <option value="completed">Completed</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">Department</label>
              <select class="form-control" [ngModel]="selectedDepartment()" (ngModelChange)="selectedDepartment.set($event); applyFilters()">
                <option value="">All Departments</option>
                <option *ngFor="let dept of departments" [value]="dept.value">{{ dept.label }}</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">Performance</label>
              <select class="form-control" [ngModel]="selectedPerformance()" (ngModelChange)="selectedPerformance.set($event); applyFilters()">
                <option value="">All Performance</option>
                <option *ngFor="let perf of performances" [value]="perf.value">{{ perf.label }}</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">Search</label>
              <div class="search-input-wrapper">
                <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input
                  type="text"
                  placeholder="Search personnel..."
                  class="form-control search-input"
                  [ngModel]="searchQuery()"
                  (ngModelChange)="searchQuery.set($event); applyFilters()"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="view-toggle">
          <button
            class="toggle-btn"
            [class.active]="viewMode() === 'grid'"
            (click)="setViewMode('grid')"
          >
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
            </svg>
            Grid
          </button>
          <button
            class="toggle-btn"
            [class.active]="viewMode() === 'list'"
            (click)="setViewMode('list')"
          >
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
            </svg>
            List
          </button>
        </div>

        @if (viewMode() === 'grid') {
          <div class="personnel-grid">
            @for (person of filteredPersonnel(); track person.id) {
              <div class="personnel-card" [class]="'status-' + person.status">
                <div class="card-header">
                  <div class="avatar-section">
                    <div class="avatar">
                      <span class="avatar-text">{{ getInitials(person.name) }}</span>
                    </div>
                    <div class="status-indicator" [class]="person.status"></div>
                  </div>
                  <div class="performance-badge" [class]="'performance-' + person.performance">
                    {{ getPerformanceLabel(person.performance) }}
                  </div>
                </div>

                <div class="card-content">
                  <h3 class="personnel-name">{{ person.name }}</h3>
                  <div class="personnel-info">
                    <div class="info-item">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2V6"></path>
                      </svg>
                      <span>{{ person.department }}</span>
                    </div>
                    <div class="info-item">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      </svg>
                      <span>{{ person.region }}</span>
                    </div>
                    <div class="info-item">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                      </svg>
                      <span>{{ person.position }}</span>
                    </div>
                  </div>

                  <div class="submission-stats">
                    <div class="stat-item">
                      <span class="stat-value">{{ person.totalSubmissions }}</span>
                      <span class="stat-label">Total</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-value pending">{{ person.pendingSubmissions }}</span>
                      <span class="stat-label">Pending</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-value approved">{{ person.approvedSubmissions }}</span>
                      <span class="stat-label">Approved</span>
                    </div>
                  </div>

                  <div class="last-activity">
                    <span class="activity-label">Last activity:</span>
                    <span class="activity-time">{{ person.lastActivity ? getRelativeTime(person.lastActivity) : 'N/A' }}</span>
                  </div>
                </div>

                <div class="card-actions">
                  <button class="btn btn-primary btn-sm" [routerLink]="['/personnel', person.id]">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                    </svg>
                    View Details
                  </button>
                  <button class="btn btn-secondary btn-sm" [routerLink]="['/supervisor-dashboard/messages']" [queryParams]="{ user: person.user_id }">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    Message
                  </button>
                </div>
              </div>
            }
          </div>
        }

        @if (viewMode() === 'list') {
          <div class="personnel-list">
            <div class="list-header">
              <div class="header-cell name">Name</div>
              <div class="header-cell department">Department</div>
              <div class="header-cell region">Region</div>
              <div class="header-cell status">Status</div>
              <div class="header-cell performance">Performance</div>
              <div class="header-cell submissions">Submissions</div>
              <div class="header-cell actions">Actions</div>
            </div>

            @for (person of filteredPersonnel(); track person.id) {
              <div class="list-row" [class]="'status-' + person.status">
                <div class="list-cell name">
                  <div class="name-cell">
                    <div class="avatar small">
                      <span class="avatar-text">{{ getInitials(person.name) }}</span>
                    </div>
                    <div class="name-info">
                      <div class="person-name">{{ person.name }}</div>
                      <div class="person-position">{{ person.position }}</div>
                    </div>
                  </div>
                </div>
                <div class="list-cell department">{{ person.department }}</div>
                <div class="list-cell region">{{ person.region }}</div>
                <div class="list-cell status">
                  <span class="badge" [class]="'badge-' + getStatusClass(person.status)">
                    {{ getStatusLabel(person.status) }}
                  </span>
                </div>
                <div class="list-cell performance">
                  <span class="badge" [class]="'badge-performance-' + person.performance">
                    {{ getPerformanceLabel(person.performance) }}
                  </span>
                </div>
                <div class="list-cell submissions">
                  <div class="submission-summary">
                    <span class="total">{{ person.totalSubmissions }}</span>
                    <span class="pending">({{ person.pendingSubmissions }} pending)</span>
                  </div>
                </div>
                <div class="list-cell actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-sm" [routerLink]="['/personnel', person.id]">
                      View
                    </button>
                    <button class="btn btn-secondary btn-sm" [routerLink]="['/supervisor-dashboard/messages']" [queryParams]="{ user: person.user_id }">
                      Message
                    </button>
                  </div>
                </div>
              </div>
            }
          </div>
        }

        @if (filteredPersonnel().length === 0) {
          <div class="empty-state">
            <div class="empty-icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
              </svg>
            </div>
            <h3 class="empty-title">No personnel found</h3>
            <p class="empty-description">
              No personnel match your current filter criteria. Try adjusting your filters or search terms.
            </p>
          </div>
        }
      </div>
    </div>
